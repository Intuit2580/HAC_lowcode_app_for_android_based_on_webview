var GC;!function(){"use strict";var i,r,t;function e(t){var n,n,n=r[t];return void 0!==n||(n=r[t]={exports:{}},i[t].call(n.exports,n,n.exports,e)),n.exports}i={"./dist/plugins/cellState/cellStateManager.js":function(t,n,i){var o,s,r,b,j,i,c,r,m,e,u,n,a;function f(t){var n=t.row,i=t.col,r=t.rowCount,t=t.colCount;return new b.Range(n,i,r,t)}function h(t,n){this.Mf=t,this.Kh=n,this.cE=[];for(var i=1;i<=3;i++)this.PP(i)}function v(t){this.Mf=t,this.GP={}}function l(n,t,i){var r=[],e=n.getRowCount(3),o=n.getColumnCount(3);return t.forEach(function(t){r=r.concat(C(n,t.style,t.range,i,e,o))}),r}function d(t){for(var n,i,r,e,o,i,s,u,a,f,i,n=[],r=0,e=t.length;r<e;r++)o=(i=t[r]).style,i={range:{row:s=(i=i.range).row,col:u=i.col,colCount:a=i.colCount,rowCount:f=i.rowCount},style:o.toJSON()},n.push(i);return n}function g(t,n,i,r){for(var e,e,o,s,u,a,f,c,u,e,h,o=0,s=n.length;o<s;o++)a=(u=(e=n[o]).range).row,f=u.col,c=u.rowCount,u=u.colCount,e=e.style,(h=new b.Style).fromJSON(e,i,r),e={style:h,range:new b.Range(a,f,c,u)},t.push(e)}function C(t,n,i,r,e,o){var s;return t.BR(i,r,e,o).map(function(t){return{range:t,style:n}})}function w(t,n,i){return i.contains(t,n)}function y(t){var n=t.range,i=t.style;return n.constructor.name===Object&&((n=new b.Range(0,0,1,1)).fromJSON(t.range),(i=new b.Style).fromJSON(t.style)),{range:n,style:i}}o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},s=this&&this.__rest||function(t,n){var i,r,e,i={};for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(e=0,r=Object.getOwnPropertySymbols(t);e<r.length;e++)n.indexOf(r[e])<0&&Object.prototype.propertyIsEnumerable.call(t,r[e])&&(i[r[e]]=t[r[e]]);return i},Object.defineProperty(n,"__esModule",{value:!0}),n.CellStateManager=void 0,r=i("Common"),b=i("Core"),j=r.Common.lt.ht,i=b.GC$.extend,c=void 0,r="cellState",m=[b.CellStatesType.readonly,b.CellStatesType.invalid,b.CellStatesType.dirty,b.CellStatesType.invalidFormula,b.CellStatesType.selected,b.CellStatesType.active,b.CellStatesType.hover,b.CellStatesType.edit],h.prototype.PP=function(t){this.cE[t]=[]},h.prototype.UP=function(t){return this.cE[t]},h.prototype.HP=function(t,n){this.cE[n]=t},h.prototype.zP=function(t,n){for(var i,r,e,i=0,r=t.length;i<r;i++)if((e=t[i]).range.equals(n))return i;return-1},h.prototype.VP=function(t,n){var i,r,t,e,i=this,r=i.UP(n),t=this.zP(r,t);-1<t&&(e=r[t],i.YP(t,e.range,e.style,r,n),r.splice(t,1))},h.prototype.ZP=function(t,n,i){var r,e,o,s,r=this,e=r.UP(i),o=r.zP(e,t),s={range:t,style:n};r.WP({index:o,cache:e,range:t,style:n,sheetArea:i}),-1===o?e.push(s):e[o]=s},h.prototype.QP=function(t){var t=this.UP(t),i=this.Kh;return t.map(function(t){var n=t.range,t=t.style;return{range:f(n),style:t.clone(),state:i}})},h.prototype.ML=function(t,n,i){for(var r,e,o,s,u,r=this.UP(i),o=[],s=r.length,u=0;u<s;u++)w(t,n,(e=r[u]).range)&&o.push(e);return 0<o.length?o:null},h.prototype.KP=function(t,n,i){var r,i,e,o,s,r,i=this.UP(i);if(i&&0<i.length)for(e=0,o=i;e<o.length;e++)if(w(t,n,s=o[e].range))return!0;return!1},h.prototype.JP=function(t,n,i,r,e,o){var s,u,a,f,c,h,v,s=this,u=s.Mf,a=s.UP(e);if(a&&0===a.length)return!1;if(s.Kh===b.CellStatesType.dirty&&(j(r)||0<(r&s.Kh)))return u.reportSheet&&u.reportSheet.internalIsDirtyCell?!!u.reportSheet.internalIsDirtyCell(n,i,e):u.XP(n,i,e);if(s.Kh===b.CellStatesType.selected&&(j(r)||0<(r&s.Kh))){for(c=0,h=f=s.Mf.getSelections();c<h.length;c++)if(w(n,i,v=h[c]))return!0;return!1}return s.Kh===b.CellStatesType.invalid?!(!u.isValid||!(j(r)||0<(r&s.Kh))||u.isValid(n,i,u.getValue(n,i,e))):s.Kh===b.CellStatesType.readonly?o&&s.Mf.isActualProtected():0<(s.Kh&t)},h.prototype.qP=function(t,n){var i=this,r=this.UP(n);this.$P({cache:r,sheetArea:n,collection:i,state:i.Kh,range:t}),this.HP(l(this.Mf,r,t),n)},h.prototype.toJSON=function(){for(var t,n,i,r,t=this,n={},r=0;r<=3;r++)(i=t.UP(r))&&0<i.length&&(n[r]=d(i));return n},h.prototype.fromJSON=function(t,n,i){var r,e,o,s,r=this;for(r.cE=[],o=1;o<=3;o++)r.PP(o);for(s in t)t.hasOwnProperty(s)&&g(e=r.UP(s),t[s],n,i)},h.prototype.tG=function(t){var t,n,i,t=s(t,[]),n=this,i;n.Mf.Ut.nG(o({type:"rangeChange",state:n.Kh},t))},h.prototype.WP=function(t){var n,i,r,e,t,o,s,n=t.index,i=t.cache,r=t.range,e=t.style,t=t.sheetArea,o=this,s=o.Mf.Ut;-1!==n&&(e=i[n].style),s.nG({type:"add",index:n,cache:i,state:o.Kh,range:r,style:e,sheetArea:t})},h.prototype.YP=function(t,n,i,r,e){var o=this,s;o.Mf.Ut.nG({type:"remove",index:t,range:n,style:i,cache:r,state:o.Kh,sheetArea:e})},h.prototype.$P=function(t){var t,n,i,t=s(t,[]),n=this,i;n.Mf.Ut.nG(o({type:"clear",state:n.Kh},t))},h.prototype.JO=function(o,s){for(var u,a,t,n,u=this,t=function(e){(a=u.UP(e))&&0<a.length&&a.forEach(function(t,n){var t,i,r,t=t.range,i=t.row,r=t.rowCount;o<=i?(t.row=i+s,u.tG({cache:a,range:t,row:i,index:n,sheetArea:e})):i<o&&o<i+r&&(t.rowCount=t.rowCount+s,u.tG({cache:a,range:t,rowCount:r,index:n,sheetArea:e}))})},n=0;n<=3;n++)t(n)},h.prototype.xP=function(s,u){for(var a,f,t,n,a=this,t=function(o){(f=a.UP(o))&&0<f.length&&f.forEach(function(t,n){var t,i,r,e,t=t.range,i=t.row,r=t.rowCount;s<i?((e=s+u-i)<=0?i-=u:(i-=e,t.rowCount-=e),i<0&&(t.rowCount=r+i,i=0),t.row=i,a.tG({cache:f,range:t,row:i,rowCount:r,index:n,sheetArea:o})):i<=s&&s<i+r&&(t.rowCount=t.rowCount-Math.min(u,i+r-s),a.tG({cache:f,range:t,rowCount:r,index:n,sheetArea:o}))})},n=0;n<=3;n++)t(n)},h.prototype.qO=function(o,s){for(var u,a,t,n,u=this,t=function(e){(a=u.UP(e))&&0<a.length&&a.forEach(function(t,n){var t,i,r,t=t.range,i=t.col,r=t.colCount;o<=i?(t.col=i+s,u.tG({cache:a,range:t,col:i,index:n,sheetArea:e})):i<o&&o<i+t.colCount&&(t.colCount=r+s,u.tG({cache:a,range:t,colCount:r,index:n,sheetArea:e}))})},n=0;n<=3;n++)t(n)},h.prototype.NP=function(s,u){for(var a,f,t,n,a=this,t=function(o){(f=a.UP(o))&&0<f.length&&f.forEach(function(t,n){var t,i,r,e,t=t.range,i=t.col,r=t.colCount;s<i?((e=s+u-i)<=0?i-=u:(i-=e,t.colCount-=e),i<0&&(t.colCount+=i,i=0),t.col=i,a.tG({cache:f,range:t,col:i,colCount:r,index:n,sheetArea:o})):i<=s&&s<i+r&&(t.colCount-=Math.min(u,i+r-s),a.tG({cache:f,range:t,colCount:r,index:n,sheetArea:o}))})},n=0;n<=3;n++)t(n)},h.prototype.eG=function(){this.cE=[],this.Mf=null},e=h,v.prototype.getCollection=function(t,n){var i=this;return!i.GP[t]&&n&&(i.GP[t]=new e(i.Mf,t)),i.GP[t]},v.prototype.hasIntersectInSelectionState=function(t,n,i,r){var e,o,o,s,u,a,e,o=this.GP[b.CellStatesType.selected];if(o&&(o=o.UP(b.SheetArea.viewport))&&0<o.length)for(s=0,u=o;s<u.length;s++)if((a=u[s].range).intersect(t,n,i,r))return!0;return!1},v.prototype.getState=function(t,n,i){var r;return this.Mf.Ut.W_(i).getCellState(t,n)||0},v.prototype.remove=function(t,n,i){var r;void 0===i&&(i=b.SheetArea.viewport),this.GP[n].VP(t,i)},v.prototype.all=function(t,n){var i,r;if(void 0===n&&(n=b.SheetArea.viewport),i=[],j(t))for(r in this.GP)this.GP.hasOwnProperty(r)&&(i=i.concat(this.GP[r].QP(n)));else i=this.GP[t].QP(n);return i},v.prototype.add=function(t,n,i,r){var e,n,i;if(b.CellStatesType[n]===c)throw new Error("Unmatched Cell State Type");j(r)&&(r=3),(e=this.getCollection(n,!0)).ZP(f(t),i,r),n=this.Mf,r===b.SheetArea.viewport?n.repaint(n.j1(t)):(i=n.Fi(),r===b.SheetArea.colHeader&&n.repaint(new b.Rect(i.Py,i.LA,n.Gy(i),i.qC)),r===b.SheetArea.rowHeader&&n.repaint(new b.Rect(i.BA,i.Cy,i.XC,n.Sy(i))))},v.prototype.clear=function(t,n){this.iG(t,n)},v.prototype.iG=function(t,n){for(var i in this.GP)this.GP.hasOwnProperty(i)&&this.GP[i].qP(t,n)},v.prototype.rG=function(t,n,i,r,e,o){var s=this,u=s.Mf,s=s.GP[t];s&&s.KP(n,i,r)&&-1!==e&&-1!==o&&u.repaint(u.XL(u,n,i,e,o))},v.prototype.getStyle=function(t,n,i,r,e){var o,s,u,u,a,f,c,h,v,l,d,g,C,w;if(j(i)&&(i=3),o=new b.Style,s=[],h=(c=(f=(a=this).Mf).Ut).getSpan(t,n,i),j(h)||(t=h.row,n=h.col),v=j(r)?a.getState(t,n,i):a.getState(t,n,i)&r,!j(v)){for(l=0,d=m;l<d.length;l++)(u=a.GP[g=d[l]])&&u.JP(v,t,n,r,i,e)&&(u=u.ML(t,n,i))&&0<u.length&&(s=s.concat(u));if(0<s.length){for(w=(C=s.length)-1;0<=w;w--)o.h5(s[w].style);return o}}return null},v.prototype.destroy=function(){for(var t in this.GP)this.GP.hasOwnProperty(t)&&this.GP[t].eG();delete this.GP,delete this.Mf},v.prototype.toJSON=function(){var t,n,i,t={};for(i in this.GP)this.GP.hasOwnProperty(i)&&(n=this.GP[i],t[i]=n.toJSON());return t},v.prototype.fromJSON=function(t,n,i){var r,e,o,s,r=this;for(o in t)t.hasOwnProperty(o)&&(s=parseInt(o,10),(e=r.getCollection(s,!0)).fromJSON(t[s],n,i))},v.prototype.JO=function(t,n){for(var i in this.GP)this.GP.hasOwnProperty(i)&&this.GP[i].JO(t,n)},v.prototype.xP=function(t,n){for(var i in this.GP)this.GP.hasOwnProperty(i)&&this.GP[i].xP(t,n)},v.prototype.qO=function(t,n){for(var i in this.GP)this.GP.hasOwnProperty(i)&&this.GP[i].qO(t,n)},v.prototype.NP=function(t,n){for(var i in this.GP)this.GP.hasOwnProperty(i)&&this.GP[i].NP(t,n)},u=v,n.CellStateManager=u,n={init:function(){this.cellStates=new u(this)},dispose:function(t){var n=this;n.cellStates&&!1!==t.clearCache&&(n.cellStates.destroy(),n.cellStates=null)},onLayoutChanged:function(t){var n,i,r,e,o,s,u,a,f,n=t.changeType,i=t.row,r=t.rowCount,e=t.col,o=t.colCount,s=t.sheetArea;if(j(s)||s===b.SheetArea.viewport)if(u=this.cellStates,"addRows"===n)u.JO(i,r);else if("deleteRows"===n)u.xP(i,r);else if("addColumns"===n)u.qO(e,o);else if("deleteColumns"===n)u.NP(e,o);else if("clear"===n&&(3===s&&2==(2&t.type)&&u.iG(new b.Range(i,e,r,o),s),3===s)&&1==(1&t.type))for(a=i;a<i+r;a++)for(f=e;f<e+o;f++)this.Ut.W_(s).setCellState(a,f,b.CellStatesType.invalid,!1)},toJson:function(t,n){n&&n.ignoreStyle||(t.cellStates=this.cellStates.toJSON())},fromJson:function(t,n,i){var r,e,r=this,e=i&&!i.ignoreStyle||!i;t&&t.cellStates&&e&&(r.cellStates=new u(r),r.cellStates.fromJSON(t.cellStates,n,i))},wh:function(t,n,i){var r;i&&!1===i.includeStyles||(t.lossless.cellStates=this.cellStates.toJSON())},yh:function(t,n,i){var r;i&&!1===i.includeStyles||!t.lossless||!t.lossless.cellStates||this.cellStates.fromJSON(t.lossless.cellStates,c,i)}},i(b.Worksheet.prototype,a={k_:function(t,n,i,r,e,o){r&&r<=3&&0<r&&this.cellStates.rG(t,n,i,r,e,o)},XP:function(t,n,i){var r,i=this.Ut.Fj(i);return i&&i[t]&&i[t][n]}}),b.Worksheet.ch(r,n),i(b.Y8.prototype,{nG:function(t){var n,i,r,n,i=this.G8;i&&(r=void 0,(r=i.originalCellStates||[]).push(t),i.originalCellStates=r)},oG:function(t,r){var e=this;t&&0<t.length&&t.forEach(function(t){var n=t.type,i=s(t,["type"]);switch(n){case"rangeChange":e.aG(o({},i),r);break;case"add":e.uG(o({},i),r);break;case"clear":e.sG(o({},i),r);break;case"remove":e.cG(o({},i),r)}})},sG:function(t,n){var i=t.cache,r=t.sheetArea,e=t.collection,o=t.state,t=t.range;"Object"===e.constructor.name&&(e=this.Mf.cellStates.getCollection(o,!0),i=i.map(y)),n?e.HP(l(this.Mf,i,t),r):e.HP(i,r)},cG:function(t,n){var i=t.cache,r=t.range,e=t.sheetArea,o=t.state,s=t.style,t=t.index;"Object"===r.constructor.name&&(i=this.Mf.cellStates.getCollection(o,!0).UP(e)),n?i.splice(t,1):i.splice(t,0,y({range:r,style:s}))},uG:function(t,n){var i,r,e,o,s,t,u,a,i=t.cache,r=t.range,e=t.sheetArea,o=t.state,s=t.style,t=t.index;"Object"===r.constructor.name&&(i=this.Mf.cellStates.getCollection(o,!0).UP(e)),u=y({range:r,style:s}),n?-1===t?i.push(u):i[t]=u:-1===t?(i.forEach(function(t,n){var i=t.range,t=t.style;i===u.range&&t===u.style&&(a=n)}),i.splice(a,1)):i[t].style=u.style},aG:function(t,n){var i,r,e,o,s,u,a,f,t,e,i=t.cache,r=t.range,e=t.state,o=t.sheetArea,s=t.index,u=t.row,a=t.col,f=t.rowCount,t=t.colCount;"Object"===r.constructor.name&&(i=this.Mf.cellStates.getCollection(e,!0).UP(o),(e=new b.Range(0,0,0,0)).fromJSON(r),r=e),n?i[s].range=r:(r=i[s].range,u!==c&&(r.row=u),a!==c&&(r.col=a),f!==c&&(r.rowCount=f),t!==c&&(r.colCount=t))}}),b.Y8.ch(r,{applyChanges:function(t){var n,t,n,n=t.changes,t=t.isUndo,n=n&&n.originalCellStates;n&&this.oG(n,!t)},undo:function(t){var t=t.originalCellStates;t&&this.oG(t)}})},"./dist/plugins/cellState/cellstate.entry.js":function(t,n,i){var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/plugins/cellState/cellStateManager.js"),n),e(i("./dist/plugins/cellState/stateManager.js"),n)},"./dist/plugins/cellState/stateManager.js":function(t,n,i){var r,r,b,e,h,o,i,s,u,a;function f(t){this.fG={},this.getStateMethods={},this.context=t,o(this.getStateMethods,s)}function c(t,n){var t;if(n)return(t=new u(t)).fromJSON(n),t}Object.defineProperty(n,"__esModule",{value:!0}),n.lG=void 0,r=i("Common"),b=i("Core"),e=r.Common.lt.ht,h=r.Common.lt.q8,o=b.GC$.extend,i="states",(r={})[b.RowColumnStates.hover]=function(t,n,i,r){var e,o,s,u,e=this,o;return(i?t===e.A_:n===e.I_)&&(s=e.zO(e.A_,e.I_,b.SheetArea.viewport),!!(u=r&&r.some(function(t){return!(!t.contains(e.A_,e.I_)||!s)})))},r[b.RowColumnStates.active]=function(t,n,i,r){var e,o,s,e=this,o;return(i?t===e.ui:n===e.ci)&&!!(s=h(e.ui)&&h(e.ci)&&r&&r.some(function(t){return!!t.contains(e.ui,e.ci)}))},r[b.RowColumnStates.selected]=function(t,n,i,r){var e,o,s,u,a,f,c,h,v,l,d,d,g,C,w,e=this,o=!this.parent||this.parent.options.hideSelection;if(o&&!(s=b.hi.ai()===this))return!1;for(a=!1,f=0,c=u=e.getSelections();f<c.length;f++)for(h=c[f],v=0,l=r;v<l.length;v++)d=l[v],h.intersect(d.row,d.col,d.rowCount,d.colCount)&&(d=-1===h.row?0:h.row,g=-1===h.rowCount?e.getRowCount():h.rowCount,C=-1===h.col?0:h.col,w=-1===h.colCount?e.getColumnCount():h.colCount,i&&d<=t&&t<d+g||!i&&C<=n&&n<C+w)&&(a=!0);return a},r[4]=function(t,n,i,r){return!1},r[b.RowColumnStates.edit]=function(t,n,i,r){var e,o,s,u,a,f,c,e=this,o=e.ui,s=e.ci,u;return(i?t===o:n===s)&&(f=((a=e.cellStates).getState(o,s,b.SheetArea.viewport)&b.RowColumnStates.edit)===b.RowColumnStates.edit)&&!!(c=h(o)&&h(s)&&r&&r.some(function(t){return!!t.contains(o,s)}))},r[b.RowColumnStates.invalid]=function(t,n,i,r){var e,o,s,u,a,f,c,h,v,l,d,g,e=this,o=i?e.hG(t,-1):e.hG(-1,n);if(o&&0<o.length&&r)for(s=0,u=r;s<u.length;s++)if(a=u[s],i){for(f=-1===a.col?0:a.col,c=-1===a.colCount?e.getColumnCount():a.colCount,h=f;h<f+c;h++)if(!(v=e.isValid(t,h,e.getValue(t,h,b.SheetArea.viewport))))return!0}else for(l=-1===a.row?0:a.row,d=-1===a.rowCount?e.getRowCount():a.rowCount,g=l;g<l+d;g++)if(!(v=e.isValid(g,n,e.getValue(g,n,b.SheetArea.viewport))))return!0;return!1},r[b.RowColumnStates.dirty]=function(t,n,i,r){var e,o,s,u,a,f,c,h,v,l,d,g,C,w,e;if(r&&0!==r.length)for(o=this.Ut.Fj(),s=0,u=r;s<u.length;s++)for(f in a=u[s],o)if(o[f])for(v in c=Number(f),h=o[f])if(h[v]&&(l=Number(v),d=-1===a.row?0:a.row,g=-1===a.rowCount?this.getRowCount(b.SheetArea.viewport):a.rowCount,C=-1===a.col?0:a.col,w=-1===a.colCount?this.getColumnCount(b.SheetArea.viewport):a.colCount,i&&c===t&&(C<=l&&l<C+w||"n"===h[v])||!i&&l===n&&(d<=c&&c<d+g||"n"===h[v])))return!0;return!1},r[b.RowColumnStates.inserted]=function(t){for(var n,i,r,e,n,i=0,r=this.getInsertRows();i<r.length;i++)if((e=r[i]).row===t)return!0},r[256]=function(t){return!1},r[b.RowColumnStates.invalidFormula]=function(r,e,o,t){var n,s,i,u,a,f,n=this;if(t&&0!==t.length)for(s=n.cellStates,i=function(t,n,i){return!!((o?r===n:e===i)&&s.getState(n,i)&b.CellStatesType.invalidFormula)},u=0;u<t.length;u++)if(a=t[u],f=n.findSpecialNonNullCellInRange(a,i))return!0;return!1},s=r,f.prototype.enableState=function(t,n){var i=this.fG;e(i[t])&&(i[t]={row:!1,column:!1}),n?i[t].row=!0:i[t].column=!0},f.prototype.disableState=function(t,n){var i=this.fG;e(i[t])||(n?i[t].row=!1:i[t].column=!1)},f.prototype.isEnable=function(t,n){var i=this.fG;return!e(i[t])&&(n?i[t].row:i[t].column)},f.prototype.getState=function(t,n,i,r,e,o){var s,u,s=this.context,u=this.getStateMethods[i];if("function"==typeof u)return u.call(s,t,n,r,e,o)?i:0},f.prototype.destroy=function(){delete this.context,delete this.fG},f.prototype.fromJSON=function(t){this.fG=o({},t)},f.prototype.toJSON=function(){return o({},this.fG)},u=f,n.lG=u,b.Worksheet.ch(i,a={init:function(){this._1=new u(this)},dispose:function(t){var n=this;n._1&&!1!==t.clearCache&&(n._1.destroy(),n._1=null)},toJson:function(t){t.states=this._1.toJSON()},fromJson:function(t){var t=c(this,t&&t.states);t&&(this._1=t)},yh:function(t){var t=c(this,t&&t.lossless&&t.lossless.states);t&&(this._1=t)},wh:function(t){t.lossless||(t.lossless={}),t.lossless.states=this._1.toJSON()}})},Common:function(t){t.exports=GC.Spread},Core:function(t){t.exports=GC.Spread.Sheets}},r={},t=e("./dist/plugins/cellState/cellstate.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).CellState=t}();
;var GC;!function(){"use strict";var n,e,t;function s(t){var i,i,i=e[t];return void 0!==i||(i=e[t]={exports:{}},n[t].call(i.exports,i,i.exports,s)),i.exports}n={"./dist/plugins/celltype/buttoncelltype.js":function(t,i,n){var e,s,d,c,u,l,o,a,D,n,s,r,h,g,M,I,v,w,f,N,b,A,y;function j(t,i,n,e){var t,s,t=t.Ut;t&&(t.do("setValueForKey",i,n,M,g,e),s=t.getValueForKey(i,n,I,e))&&(clearTimeout(s),t.do("setValueForKey",i,n,I,g,e))}function C(){var t,n,t=y.call(this)||this;return t.typeName="6",n=t,r(N,function(t,i){n["_"+t]=i}),t}e=this&&this.__extends||(A=function(t,i){return(A=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}A(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.Button=void 0,s=n("Common"),d=n("Core"),c=n("./dist/plugins/celltype/cellbuttons.js"),u=d.Events.SelectionChanged,l=s.Common.lt.ht,o=d.mt.vi,a=d.CellTypes.Context,D=d.CellTypes.Text,n=d.CellTypes.Base,s=d.GC$,r=s.each,g=void 0,M="_isFirstMouseUp",I="_mouseupToken",v="#707070",w="#34B4E3",f=".buttonCellType",N={marginTop:2,marginRight:2,marginBottom:2,marginLeft:2,text:"",buttonBackColor:h=null,buttonClickColor:h,buttonState:0},e(C,y=n),C.prototype.paintValue=function(t,i,n,e,s,o,r,c){var u,a,l,h,g,M,I,f,a,l,a,N;t&&(a=(u=this)._marginLeft,l=u._marginTop,h=n+a,g=e+l,M=s-a-u._marginRight,I=o-l-u._marginBottom,0<M-2)&&0<I-2&&(f=n<h+M&&h<n+s&&e<g+I&&g<e+o)&&(t.save(),(h<n||n+s<h+M||g<e||e+o<g+I)&&(t.rect(n,e,s,o),t.clip()),t.beginPath(),t.strokeStyle!==(a=v)&&(t.strokeStyle=a),t.strokeRect(h+.5,g+.5,M-1,I-1),l=void 0,a=u._buttonState,N=u._text,l=2===a?u._buttonClickColor||w:(l=u._buttonBackColor)||{degree:90,stops:[{position:0,color:"#F6FAFB"},{position:.125,color:"#F6FAFB"},{position:1,color:"#D2DBEB"}]},t.fillStyle!==l&&(t.fillStyle=l),d.W.setFillStyle(t,l,n,e,s,o,function(){t.fillRect(h+1,g+1,M-2,I-2)}),t.restore(),N)&&D.prototype.paintValue.call(u,t,N,h,g,M,I,r,c)},C.prototype.getText=function(t,i){return t},C.prototype.j3=function(t,i,n,e){var s=t.parent;s&&s.j3(t,i,n,e)},C.prototype.getHitInfo=function(t,i,n,e,s){var o,r,c,u,a,o,e,o=this;return s&&(r=s.sheetArea,l(r)||3===r)&&e?(c=e.x+o._marginLeft,u=e.x+e.width-o._marginRight,a=e.y+o._marginTop,o=e.y+e.height-o._marginBottom,e={x:t,y:i,row:s.row,col:s.col,cellRect:e,sheetArea:r,sheet:s.sheet,cellStyle:n},c<=t&&t<=u&&a<=i&&i<=o&&(e.isReservedLocation=!0),e):h},C.prototype.processMouseDown=function(t){var i,n,i=this,n=t&&t.sheet;return!(!n||!t.isReservedLocation||i.pG||(i.pG=!0,i._buttonState=2,(0,c.XCe)(n,t.cellRect),0))},C.prototype.processMouseUp=function(t){var i,n,e,s,o,r,t,i=this,n=t&&t.sheet;if(i.pG&&n&&t.isReservedLocation){if((i._buttonState=0,c.XCe)(n,t.cellRect),i.pG=!1,e=t.row,s=t.col,o=t.sheetArea,!(r=n.Ut.getValueForKey(e,s,M,o)))return i.j3(n,e,s,o),n.Ut.do("setValueForKey",e,s,M,!0,o),t=setTimeout(function(){j(n,e,s,o)},250),n.Ut.do("setValueForKey",e,s,I,t,o),!0;j(n,e,s,o)}return!1},C.prototype.processMouseLeave=function(t){var i,n,i=this,n=t&&t.sheet;n&&i.pG&&((i._buttonState=0,c.XCe)(n,t.cellRect),i.pG=!1)},C.prototype.processKeyDown=function(t,i){var n,e,s,n=i.sheet,e=this;return!(!n||e.bG)&&(s=n.getCellRect(i.row,i.col),e._buttonState=2,n.repaint(s),n.D3(u+f,function(){n._3(u+f),e.bG=!1,e._buttonState=0,n.repaint(s)}),e.bG=!0)},C.prototype.processKeyUp=function(t,i){var n,e,s,o,r,n=i.sheet,e=this;return!(!n||!e.bG||(s=i.row,o=i.col,r=n.getCellRect(s,o),e._buttonState=0,n.repaint(r),n._3(u+f),e.j3(n,s,o,i.sheetArea),e.bG=!1))},C.prototype.isReservedKey=function(t,i){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},C.prototype.getAutoFitWidth=function(t,i,n,e,s){var o,r,o=this,r;return a.Bt(t,o._text,n,e,s)+o._marginLeft+o._marginRight},C.prototype.getAutoFitHeight=function(t,i,n,e,s){var o,r,o=this,r;return a.tn(t,o._text,n,e,s)+o._marginTop+o._marginBottom},C.prototype.QD=function(t){this.isReservedKey(t)&&o(t)},C.prototype.isImeAware=function(t){return!1},C.prototype.toJSON=function(){var n,e,s,n=this,e={typeName:n.typeName};return r(N,function(t,i){"buttonState"!==t&&(s=n["_"+t])!==i&&(e[t]=s)}),e},C.prototype.fromJSON=function(n){var e=this;r(N,function(t){var i=n[t];l(i)||(e["_"+t]=i)})},C.prototype.jn=function(t){},C.prototype.Ke=function(){},b=C,i.Button=b,r(N,function(i){b.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:(this["_"+i]=t,this)}}),d.CellTypes.ti[6]=b},"./dist/plugins/celltype/cellbuttons.js":function(n,o,t){var j,i,t,A,r,u,H,y,C,I,a,W,V,J,X,F,N,d,g,_,z,M,K,m,q,T,$,s,D,v,w,b,p,x,L,S,l,f,h,k,i,tt,O,e,t;function it(t){switch(t){case p:return j.ButtonPosition.left;case x:return j.ButtonPosition.right;case L:return j.ButtonPosition.leftOfText;case S:return j.ButtonPosition.rightOfText}}function nt(t){switch(t){case j.ButtonPosition.left:return p;case j.ButtonPosition.right:return x;case j.ButtonPosition.leftOfText:return L;case j.ButtonPosition.rightOfText:return S}}function et(t){for(var i,n,e,i=t.split(" "),e=0;e<i.length;e++)if(0<=i[e].indexOf(s)){n=i[e];break}switch(n){case D:return p;case v:return x;case w:return L;case b:return S}}function st(t){switch(t){case p:return D;case x:return v;case L:return w;case S:return b}}function ot(t,i,n,e){var t,s,t=t.Ut;t&&(t.do("setValueForKey",i,n,N,y,e),s=t.getValueForKey(i,n,d,e))&&(clearTimeout(s),t.do("setValueForKey",i,n,d,y,e))}function rt(t,i,n){var e,s;switch(n){case O.topLeft:return new j.Rect(t.x,t.y,Math.min(i.width,t.width),Math.min(i.height,t.height));case O.topCenter:return e=(t.width-i.width)/2,e=Math.max(0,e),new j.Rect(t.x+e,t.y,Math.min(i.width,t.width),Math.min(i.height,t.height));case O.topRight:return e=t.width-i.width,e=Math.max(0,e),new j.Rect(t.x+e,t.y,Math.min(i.width,t.width),Math.min(i.height,t.height));case O.MiddleLeft:return s=(t.height-i.height)/2,s=Math.max(0,s),new j.Rect(t.x,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case O.MiddleCenter:return e=(t.width-i.width)/2,e=Math.max(0,e),s=(t.height-i.height)/2,s=Math.max(0,s),new j.Rect(t.x+e,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case O.MiddleRight:return e=t.width-i.width,e=Math.max(0,e),s=(t.height-i.height)/2,s=Math.max(0,s),new j.Rect(t.x+e,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case O.bottomLeft:return s=t.height-i.height,s=Math.max(0,s),new j.Rect(t.x,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case O.bottomCenter:return e=(t.width-i.width)/2,e=Math.max(0,e),s=t.height-i.height,s=Math.max(0,s),new j.Rect(t.x+e,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case O.bottomRight:return e=t.width-i.width,e=Math.max(0,e),s=t.height-i.height,s=Math.max(0,s),new j.Rect(t.x+e,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height))}}function ct(t,i,n){for(var e,s,e=[],s=0;s<t.length;s++)e.push({width:Q(t[s].button,i,n),height:jt(t[s].button,n),isStick:t[s].button.v_i});return e}function Z(t,i,n,e,s,o){for(var r,c,u,a,l,h,g,r=[],c=[],u=0;u<t.length;u++)a=i[t[u].index],A(a)?c.push(t[u]):r.push(a);for(l=lt(r),u=0;u<c.length;u++)h=Q(c[u].button,n,e),(g=!o||l.width+h<=o.width)&&(l.width+=h);return l.height=l.height||(o?o.height:0),l}function ut(t,i,n,e,s,o,r,c,u,a,l,h){var n,g,c,i,r,M,n,a,s,I,f,N,n=R(i,n,r,c,!0,[t]);if(0<n.length){switch(U(n,i,r),t){case j.ButtonPosition.left:g=D;break;case j.ButtonPosition.right:g=v;break;case j.ButtonPosition.leftOfText:g=w;break;case j.ButtonPosition.rightOfText:g=b;break;default:return}switch(c=Z(n,a,s,e,!0,o),i="0",r=H(),((M=j.mt.Tt).mozilla||1<r)&&(i="1px"),n=c.width,a=c.height,s=nt(t),A(u.canvasSizes)&&(u.canvasSizes={}),(I=u.canvasSizes)[s]={width:n,height:a},N=at(g,n,a,f={width:n+"px",height:a+"px",display:"block",position:"absolute",bottom:i,overflow:"hidden",paddingTop:"0"}),t){case j.ButtonPosition.left:N.style.left="0";break;case j.ButtonPosition.right:N.style.right="0";break;case j.ButtonPosition.leftOfText:N.style.left="0";break;case j.ButtonPosition.rightOfText:N.style.right="0";break;default:return}l.appendChild(N)}}function at(t,i,n,e){var s,o,s=document.createElement("canvas");for(o in s.className=t+" "+$,e)e.hasOwnProperty(o)&&(s.style[o]=e[o]);return s.width=i,s.height=n,s}function lt(t){var i,n,e,s,o;if(t.length<=0)return new j.Rect(0,0,0,0);for(i=t[0].x,n=t[0].y,e=t[0].x+t[0].width,s=t[0].y+t[0].height,o=1;o<t.length;o++)i=Math.min(i,t[o].x),n=Math.min(n,t[o].y),e=Math.max(e,t[o].x+t[o].width),s=Math.max(s,t[o].y+t[o].height);return new j.Rect(i,n,e-i,s-n)}function ht(t){var i,n,i=j.mt.Tt,n=H();if(1!==n)return i.mozilla?Math.ceil(t*n):Math.round(t*n)}function G(t,i,n,e,s,o,r,c){var u,r,a,l,h,g,M;if(!A(t))for(A(c[n])&&(c[n]={}),U(i,e.sheet,e.row),u=t.getContext("2d"),r=Z(i,r,s,e,!0),u.setTransform(parseFloat(t.style.width)/r.width,0,0,parseFloat(t.style.height)/r.height,0,0),h=new j.Rect(l=a=0,0,parseFloat(t.style.width),parseFloat(t.style.height)),g=0;g<i.length&&(M=B(u,a,0,Q(i[g].button,s,e),e.sheet.getRowHeight(e.row),i[g].button,s,e,o,c[n],i[g].index,h),!A(M));g++)a+=M.width}function gt(n,e,s,o,r,t){var t,i,i,i,i;A(t.eventListeners)&&(t.eventListeners={}),A(t.eventListeners[e])&&(t.eventListeners[e]={}),i=(t=t.eventListeners[e]).mouseDownListener=function(t){var i;Tt(c({x:t.offsetX,y:t.offsetY,context:s,cellRect:r,cellStyle:o,buttonArea:e},!0),!0,n)},n.addEventListener("mousedown",i),i=t.mouseUpListener=function(t){var i;pt(c({x:t.offsetX,y:t.offsetY,context:s,cellRect:r,cellStyle:o,buttonArea:e},!0),!0,n)},n.addEventListener("mouseup",i),i=t.mouseMoveListener=function(t){var i;xt(c({x:t.offsetX,y:t.offsetY,context:s,cellRect:r,cellStyle:o,buttonArea:e},!0),!0,n)},n.addEventListener("mousemove",i),i=t.mouseLeaveListener=function(t){var t={x:t.offsetX,y:t.offsetY,context:s,cellRect:r,cellStyle:o,buttonArea:e};t.x<0&&(t.x=0),t.x>=parseFloat(n.style.width)&&(t.x=parseFloat(n.style.width)-1),Lt(c(t,!0),!0,n)},n.addEventListener("mouseleave",i)}function Mt(t,i,n,e,s,o,r,c,u,a,l,h){var i,g,M,n,I,f,N,d,i=R(i,n,r,c,!0,[t]);if(0<i.length){switch(M=g=void 0,t){case j.ButtonPosition.left:g=D,M=p;break;case j.ButtonPosition.right:g=v,M=x;break;case j.ButtonPosition.leftOfText:g=w,M=L;break;case j.ButtonPosition.rightOfText:g=b,M=S;break;default:return}if(n=h.querySelector("."+g),!A(n)){switch(I=parseFloat(n.style.width),f=o.options.contentRect,N=o.options.leftExternalRect,d=o.options.rightExternalRect,t){case j.ButtonPosition.left:f.x+=I,f.width-=I;break;case j.ButtonPosition.right:f.width-=I;break;case j.ButtonPosition.leftOfText:N.width+=I;break;case j.ButtonPosition.rightOfText:d.width+=I}G(n,i,M,e,s,u,a,l),gt(n,M,e,s,o.options.cellRect,u)}}}function It(t,i,n,e,s,o,r){var i,n,c,u,a,l,h,i=R(i,n,e,s,!0,[t]);if(i&&0<i.length)switch(n=nt(t),c=o&&o[n]&&o[n].width||0,u=r.contentContainer,a=r.contentRect,l=r.leftExternalRect,h=r.rightExternalRect,t){case j.ButtonPosition.left:Nt(u,"left",c),a.x+=c,a.width-=c;break;case j.ButtonPosition.leftOfText:Nt(u,"left",c),l.width+=c;break;case j.ButtonPosition.right:a.width-=c;break;case j.ButtonPosition.rightOfText:h.width+=c}}function ft(t){return+t.replace("px","")||0}function Nt(t,i,n){var e=0;t.style[i]&&(e=ft(t.style[i])),t.style[i]="".concat((e+=n)-1,"px")}function dt(t,i){A(i.mouseDownListener)||t.removeEventListener("mousedown",i.mouseDownListener),A(i.mouseUpListener)||t.removeEventListener("mouseup",i.mouseUpListener),A(i.mouseMoveListener)||t.removeEventListener("mousemove",i.mouseMoveListener),A(i.mouseLeaveListener)||t.removeEventListener("mouseleave",i.mouseLeaveListener)}function U(t,i,n){for(var e,s,o,e=i.BO(),s=0;s<t.length;s++)(o=Gt(t[s].button,n))&&e.addImage(o)}function E(t){var i=t.isPrinting,t=t.printZoomFactor;return i&&"number"==typeof t&&1!==t}function Dt(t,i){return 2===i.columnHeaderFitMode&&i.cornerX&&(t.width=i.cornerX-t.x,t.height=t.height-(i.cornerY-t.y)-1,t.y=i.cornerY-1),t}function vt(t,i,n){switch(n){case j.ButtonPosition.leftOfText:return new j.Rect(t.x,t.y,i.x-t.x,t.height);case j.ButtonPosition.rightOfText:return new j.Rect(i.x+i.width,t.y,t.x+t.width-i.x-i.width,t.height)}}function wt(t,i,n,e,s,o,r){var c,u,a,l,h,g,M,I,f;if(t&&!(i.length<=0)){if(s=kt(s),U(i,c=o.sheet,o.row),2===o.columnHeaderFitMode&&o.cornerX&&(u=o.cellRect.x+o.cellRect.width-(n.x+n.width),(n=n.clone()).width=o.cornerX-n.x-u,n.height=n.height-(o.cornerY-n.y)-1,n.y=o.cornerY-1),a=vt(n,e,r?j.ButtonPosition.leftOfText:j.ButtonPosition.rightOfText),t.save(),t.rect(a.x,a.y,a.width,a.height),t.clip(),t.beginPath(),l=P(c,o.row,o.col,o.sheetArea),h=kt(s),A(l.layout)&&(l.layout={}),r){for(g=a.x+a.width,M=i.length-1;0<=M&&(f=B(t,g-=I=Q(i[M].button,h,o),n.y,Q(i[M].button,h,o),a.height,i[M].button,h,o,l,l.layout,i[M].index,n),!A(f));M--);e.x=g}else{for(g=a.x,M=0;M<i.length&&(f=B(t,g,n.y,Q(i[M].button,h,o),a.height,i[M].button,h,o,l,l.layout,i[M].index,n),!A(f));M++)g+=f.width;e.width=g-e.x}t.restore()}}function bt(t,i,n,e,s){if(!(t+n<s.x||t>s.x+s.width||i+e<s.y||i>s.y+s.height))return t+n>s.x+s.width&&(n=s.x+s.width-t),i+e>s.y+s.height&&(e=s.y+s.height-i),t<s.x&&(t=s.x),i<s.y&&(i=s.y),new j.Rect(t,i,n,e)}function B(t,i,n,e,s,o,r,c,u,a,l,h){var g,u,g=M;if(u.buttonDownIndex===l?g=K:u.buttonHoverIndex===l&&(g=m),u=bt(i,n,e,s=r.vAlign===j.VerticalAlign.center?h.height:s,h),!A(u))return At(t,u.x,u.y,u.width,u.height,o,r,c,g,h),a[l]=new j.Rect(u.x,u.y,u.width,u.height),a[l].offsetX=u.x-h.x,a[l].offsetY=u.y-h.y,c.cornerY&&(a[l].offsetY+=c.cornerY),a[l]}function At(t,i,n,e,s,o,r,c,u,a){var l,h,g,g,M,M,I,M,f,l,l,u,I,l,f,N,d,D,v,D,i,D,w,n,e,b;t.save(),t.beginPath(),l=o.useButtonStyle,h=E(c),g=c.printZoomFactor,g=h?g:c.sheet.zoom(),i+=M=l?z*g:0,n+=M,e-=2*M,s-=2*M,M=W,I=o.hoverBackColor||X,M&&t.strokeStyle!==M&&(t.strokeStyle=M),l&&t.strokeRect(i+.5,n+.5,e-1,s-1),M=Ut(o.enabled,c.row),l?f=!1===o.enabled?o.buttonBackColor||J:u===K?V:u===m||c.visualState===j.VisualState.hover?I:((l=t.createLinearGradient(i+e/2,n,i+e/2,n+s)).addColorStop(.125,"#F6FAFB"),l.addColorStop(1,"#D2DBEB"),o.buttonBackColor||l):(f=o.buttonBackColor||"white",u===m&&(o.enabled||A(o.enabled))&&(f=I)),(l=r.font)&&t.font!==l&&(t.font=l),t.fillStyle!==f&&(t.fillStyle=f),t.rect(i+=1,n+=1,e-=2,s-=2),t.clip(),t.beginPath(),t.fillRect(i,n,e,s),u=new j.Rect(i,n,e,s),I=new j.Rect(i,n,e,s),l=_*g,f=Gt(o,c.row),o.caption&&f&&(N=(T.Bt(C,o.caption,r,g,c)+2*z)*g,d=Ct(o)*g,D=new j.Rect(0,0,N+d+l,s),D=rt(v=new j.Rect(i,n,e,s),D,O.MiddleCenter),o.captionAlign===j.CaptionAlignment.left?(I=new j.Rect(D.x,n,N,s),u=D.x+N+l<i+e-2?new j.Rect(D.x+N+l,n,Math.max(0,d),s):new j.Rect(0,0,0,0)):(u=new j.Rect(D.x,n,Math.min(d,e),s),I=D.x+d+l<i+e-2?new j.Rect(D.x+d+l,n,Math.min(e-2-d-l,N),s):new j.Rect(0,0,0,0))),o.caption&&(i=(T.Bt(C,o.caption,r,g,c)+2*z)*g,D=(T.tn(C,o.caption,r,g,c)+2*z)*g,n=rt(I,w=new j.Rect(0,0,i,D),O.MiddleCenter),e=new q,r=r.clone(),!1===M&&(r.foreColor=F),r.cellButtons=y,r.decoration=y,e.paintValue(t,o.caption,n.x,n.y-(b=h?0:2),n.width,n.height,r,c)),f&&yt(t,o,u.x,u.y,u.width,u.height,f,c,a),t.restore()}function yt(t,i,n,e,s,o,r,c,u){var a,l,a,n,s,o,h,g,c,c,h,e,n,M;t.save(),t.rect(n+2,e+2,s-4,o-4),t.clip(),t.beginPath(),(l=(a=c.sheet).BO()).getState(r)?l.qh(r)&&(a=E(c)?c.printZoomFactor:a.zoom(),n=new j.Rect(n,e,s,o),s=Ct(i)-2,o=zt(i)-2,g=rt(n,h=new j.Rect(0,0,s*a,o*a),O.MiddleCenter),i.position!==j.ButtonPosition.leftOfText&&i.position!==j.ButtonPosition.rightOfText||((c=c.textRect)&&(g.y=I(c.y-c.height/2-h.height/2,e+4)),g.y+g.height>n.y+n.height&&(g.y=I(g.y-(g.y+g.height-n.y-n.height),n.y))),h=(c=l.getImage(r)).width,e=c.height,j.mt.Tt.msie&&i.imageType&&(e=i.imageType===j.ButtonImageType.custom?(f[r]||(c.style.position="absolute",c.style.left="-10000px",c.style.top="-100000px",document.body.appendChild(c),f[r]={width:c.width,height:c.height},document.body.removeChild(c)),h=f[r].width,f[r].height):h=12),u&&j.mt.Tt.msie&&g.x+g.width>u.x+u.width?0<(n=u.x+u.width-g.x)&&t.drawImage(c,0,0,n*(M=h/(s*a)),e,g.x,g.y,n,o*a):t.drawImage(c,0,0,h,e,g.x,g.y,s*a,o*a)):l.addImage(r),t.restore()}function Q(t,i,n,e){var s,o,i,r,c,n;return void 0===e&&(e=!0),s=E(n)?n.printZoomFactor:n.sheet.zoom(),o=2*z+3,A(t.width)?(i=T.Bt(C,t.caption,i,s,n),r=t.useButtonStyle,(c=Gt(t,n.row))&&(i=Ct(t)+i,o=(r?o:0)+_),e?(i+o+7)*s:i+o+7):(n=I(1,t.width),isNaN(n)&&(n=1),e?n*s:n)}function jt(t,i,n){var e,s,e,i,t;return void 0===n&&(n=!0),e=i.sheet,s=E(i)?i.printZoomFactor:e.zoom(),e=e.getRowHeight(i.row),i=t.imageSize?t.imageSize.height:C,t=I(1,i||e),isNaN(t)&&(t=1),n?t*s:t}function R(t,i,n,e,s,o){var r,c,u,a,l,h,r=[];if(!i||0===i.length)return[];for(c=!1,u=t.Ut.getValueForKey(n,e,g),t.getActiveRowIndex()===n&&t.getActiveColumnIndex()===e&&!0!==u&&(c=!0),a=0;a<i.length;a++)if(l=i[a].visible,!s||!i[a].i4i)for(h=0;h<o.length;h++)(i[a].position===o[h]||A(i[a].position)&&o[h]===j.ButtonPosition.right)&&(l&&"function"==typeof l&&l(n)||i[a].visibility===j.ButtonVisibility.onEditing&&s||i[a].visibility!==j.ButtonVisibility.onEditing&&c||i[a].visibility===j.ButtonVisibility.always||A(i[a].visibility))&&r.push({index:a,button:i[a]});return r}function Ct(t){var i;return i=(i=t.imageSize&&("string"==typeof t.imageSize.width&&(i=a(t.imageSize.width)),"number"==typeof t.imageSize.width)?t.imageSize.width:i)===C||isNaN(i)||i<0?16:i}function zt(t){var i;return i=(i=t.imageSize&&("string"==typeof t.imageSize.height&&(i=a(t.imageSize.height)),"number"==typeof t.imageSize.height)?t.imageSize.height:i)===C||isNaN(i)||i<0?16:i}function P(t,i,n,e,s){var o,r,o={isMouseDownReservedLocation:!1};return e===j.SheetArea.corner?o:((r=t.Ut.getValueForKey(i,n,l,e))||s||mt(t,i,n,e,r=o),r)}function mt(t,i,n,e,s){t.Ut.setValueForKey(i,n,l,s,e)}function c(t,i){var n,e,s,o,r,c,u,a,a,l,h,g,M,I,f,N,d,D,v,w,b,A,y,a,t,l,t,l;if(void 0===i&&(i=!1),n=t.context.row,e=t.context.col,s=t.cellRect,o=t.cellStyle,r=t.context,u=(c={x:t.x,y:t.y,row:n,col:e,cellRect:s,cellStyle:o,sheetArea:t.context.sheetArea,sheet:t.context.sheet,context:r}).sheet,!1!==t.cellStyle.locked&&u.isActualProtected()&&!u.NMi&&(a={row:n,col:e,sheetArea:t.context.sheetArea,isLocked:!0},j.Worksheet.et(u,"getCellActualLockedInfo",a),a.isLocked))return null;if(a=P(u,c.row,c.col,c.sheetArea,!0),l=t.cellStyle.cellButtons,!a||!l||l.length<=0)return null;if(h=a.layout,!(h=i?a.editorLayout[t.buttonArea]:h))return null;for(f in g=-1,M=c.x,I=c.y,h)if(h.hasOwnProperty(f)){if(N=void 0,d=h[f],i)N=new j.Rect(d.x,d.y,d.width,d.height);else{if(D=d.offsetX,u.parent&&!u.parent.options.scrollByPixel&&0<(v=u.frozenColumnCount())&&v<(w=u.getViewportLeftColumn(1))&&(b=u.getSpan(n,e,c.sheetArea))&&b.col<=w&&w<b.col+b.colCount)for(A=w-v,y=0;y<A;y++)D-=u.getColumnWidth(v+y+1,c.sheetArea);N=new j.Rect(s.x+D,s.y+d.offsetY,d.width,d.height)}if(N&&N.contains(M,I)){g=+f;break}}return-1!==g?c.cellButtonHitInfo={hitButtonIndex:g,buttonConfig:l[g],buttonArea:t.buttonArea}:(a=u.getCellType(c.row,c.col))&&(t=Z(R(u,l,n,e,i,[j.ButtonPosition.left]),h,o,r,!1),l=Z(R(u,l,n,e,i,[j.ButtonPosition.right]),h,o,r,!1),t=new j.Rect(s.x+t.width,s.y,s.width-t.width-l.width,s.height),l=a.getHitInfo(c.x,c.y,o,t,r))&&l.isReservedLocation&&(c.isReservedLocation=!0),c}function Tt(t,i,n){var e,s,o,r,c,c,u,a,l,s,u,l,a,i,h,g;return void 0===i&&(i=!1),t&&t.cellButtonHitInfo&&(e=t.sheet,o=t.row,r=t.col,c=t.sheetArea,o===e.ui&&r===e.ci||c!==j.SheetArea.viewport||e.endEdit())&&(t.cellButtonHitInfo.buttonConfig&&(s=t.cellButtonHitInfo.buttonConfig.hasOverLay),c=P(e,o,r,t.sheetArea),t.cellButtonHitInfo&&(a=t.cellButtonHitInfo.hitButtonIndex,u=t.cellButtonHitInfo.buttonConfig),l=Ut(u&&u.enabled,t.row),e)&&(!c.isMouseDownReservedLocation||s)&&u&&(l||A(l))&&0<=a&&(c.buttonDownIndex=a,c.isMouseDownReservedLocation=!0,i&&n?(s=t.cellStyle,u=c.layout,l=t.context,a=c.editorLayout,i=t.cellButtonHitInfo&&t.cellButtonHitInfo.buttonArea,h=s.cellButtons,i&&G(n,g=R(e,h,o,r,!0,[it(i)]),i,l,s,c,u,a)):Y(e,t.cellRect),1)}function pt(t,i,n){var e,s,o,r,c,u,u,a,l,h,c,g,M,I,f,n;if(void 0===i&&(i=!1),t&&(e=t&&t.sheet,s=t.row,o=t.col,r=P(e,t.row,t.col,t.sheetArea),c=t.cellButtonHitInfo,r.isMouseDownReservedLocation)&&e){if(c&&0<=c.hitButtonIndex&&c.buttonConfig.command&&(u=c.buttonConfig.command,i||e.getActiveRowIndex()===s&&e.getActiveColumnIndex()===o||e.eR(s,o,1,1,2),"string"==typeof u?e.getParent().commandManager().execute({cmd:u,row:s,col:o,sheetName:e.name(),sheetArea:t.sheetArea}):"function"==typeof u&&u.call(C,e,s,o,t.sheetArea)),i&&0<=r.buttonDownIndex&&n&&(r.buttonDownIndex=-1,u=t.cellStyle,a=r.layout,l=t.context,h=r.editorLayout,c=c&&c.buttonArea,g=u.cellButtons,c)&&G(n,M=R(e,g,s,o,!0,[it(c)]),c,l,u,r,a,h),r.buttonDownIndex=-1,i||Y(e,t.cellRect),r.isMouseDownReservedLocation=!1,I=t.sheetArea,!(f=e.Ut.getValueForKey(s,o,N,I)))return Ot(e,s,o,I),e.Ut.do("setValueForKey",s,o,N,!0,I),n=setTimeout(function(){ot(e,s,o,I)},250),void e.Ut.do("setValueForKey",s,o,d,n,I);ot(e,s,o,I)}}function xt(t,i,n){var e,s,o,o,i,r,c,u,a,l,h;void 0===i&&(i=!1),t&&(s=P(e=t&&t.sheet,t.row,t.col,t.sheetArea),o=-1,(o=t.cellButtonHitInfo?t.cellButtonHitInfo.hitButtonIndex:o)!==(A(s.buttonHoverIndex)?-1:s.buttonHoverIndex))&&(s.buttonHoverIndex=o,i?(o=t.cellStyle,i=s.layout,r=t.context,c=s.editorLayout,u=o.cellButtons,a=t.row,l=t.col,n&&St(u,e,a,l,h=n.parentElement,r,o,s,i,c)):Y(e,t.cellRect))}function Y(t,i){var n,e,s,i,n,n=i.x-(0<i.x?2:0),e=i.y-(0<i.y?2:0),s=i.width+4,i=i.height+4,n=new j.Rect(n,e,s,i);t.repaint(n)}function Lt(t,i,n){var e,s,i,o,r,c,u,a,l,h;void 0===i&&(i=!1),t&&t.cellButtonHitInfo&&(s=P(e=t&&t.sheet,t.row,t.col,t.sheetArea),i?(s.buttonHoverIndex=-1,0<=t.cellButtonHitInfo.hitButtonIndex&&(i=t.cellStyle,o=s.layout,r=t.context,c=s.editorLayout,u=i.cellButtons,a=t.row,l=t.col,n)&&St(u,e,a,l,h=n.parentElement,r,i,s,o,c)):(e&&(s.buttonHoverIndex=-1,s.buttonDownIndex=-1,s.isMouseDownReservedLocation=!1),Y(e,t.cellRect)))}function St(t,i,n,e,s,o,r,c,u,a){for(var l,h,g,M,l=0;l<k.length;l++)h=nt(k[l]),G(g=s.querySelector("."+st(h)),M=R(i,t,n,e,!0,[it(h)]),h,o,r,c,u,a)}function kt(t){var t=t.clone(!0);return t.hAlign=j.HorizontalAlign.left,t.vAlign=j.VerticalAlign.center,t.wordWrap=!1,t.isVerticalText=!1,t.shrinkToFit=!1,t.formatter="General",t.textIndent=0,t}function Ot(t,i,n,e){var s=t.parent;s&&s.j3(t,i,n,e)}function Zt(t,i,n,e,s){var o,r,c,o=t.Il(i,n,s);if(o&&o.cellButtons&&0<o.cellButtons.length&&0<(r=o.cellButtons.filter(function(t){return 1===t.visibility})).length){e&&t.Ut.do("setValueForKey",i,n,g,!0,s);try{c=t.getCellRect(i,n,1===s?-1:void 0,2===s?-1:void 0),t.repaint(c)}finally{e&&t.Ut.do("setValueForKey",i,n,g,y,s)}}}function Gt(t,i){var n,e,i,s,n=null,e=t.imageType;if(A(t.imageType))return null;switch(s=(i=Ut(t.enabled,i))||A(i),e){case j.ButtonImageType.dropdown:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case j.ButtonImageType.left:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case j.ButtonImageType.right:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case j.ButtonImageType.clear:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case 3:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case j.ButtonImageType.ok:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case j.ButtonImageType.plus:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiM2RTZFNkUiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiNDQUNBQ0EiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case j.ButtonImageType.minus:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiM2RTZFNkUiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiNDQUNBQ0EiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+";break;case j.ButtonImageType.redo:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case j.ButtonImageType.undo:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case j.ButtonImageType.search:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case j.ButtonImageType.separator:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case j.ButtonImageType.spinLeft:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case j.ButtonImageType.spinRight:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iIzZFNkU2RSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iI0NBQ0FDQSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case j.ButtonImageType.ellipsis:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case j.ButtonImageType.expand:n=s?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==";break;case j.ButtonImageType.collapse:n=s?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=":"data:image/svg+xml;PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=";break;case j.ButtonImageType.custom:n=t.imageSrc}return n}function Ut(t,i){return"function"==typeof t?t(i):t}Object.defineProperty(o,"__esModule",{value:!0}),o.XCe=void 0,j=t("Core"),i=t("Common"),t=t("./dist/plugins/celltype/celltypes.ns.js"),A=i.Common.lt.ht,r=j.W.V,u=j.mt.vt,H=j.Bf.Zl,y=void 0,C=null,I=Math.max,a=parseInt,W="#707070",V="#34B4E3",J="#e6e6e6",X="lightgray",F="#CACACA",N="_isFirstMouseUp",d="_mouseupToken",g="_leaveCell",M=_=0,K=z=2,m=3,q=j.CellTypes.Base,T=j.CellTypes.Context,$="gc-cell-button-canvas",D=(s="gc-editor-")+"left-cellbuttons",v=s+"right-cellbuttons",w=s+"left-of-text-cellbuttons",b=s+"right-of-text-cellbuttons",p="leftButtonArea",x="rightButtonArea",L="leftOfTextButtonArea",S="rightOfTextButtonArea",l="_cellButtonParam",f={},h=j.GC$,k=[j.ButtonPosition.left,j.ButtonPosition.right,j.ButtonPosition.leftOfText,j.ButtonPosition.rightOfText],i=new i.Common.ResourceManager(t.SR,"CellTypes"),tt=i.getResource.bind(i),(t=O=O||{})[t.topLeft=0]="topLeft",t[t.topCenter=1]="topCenter",t[t.topRight=2]="topRight",t[t.MiddleLeft=3]="MiddleLeft",t[t.MiddleCenter=4]="MiddleCenter",t[t.MiddleRight=5]="MiddleRight",t[t.bottomLeft=6]="bottomLeft",t[t.bottomCenter=7]="bottomCenter",t[t.bottomRight=8]="bottomRight",j.CellTypes.Base.ch("cellButton",{beforePaintLabel:function(t){var i,n,e,s,o,r,c,u,a,l,r,h,g,M,I,f,N,d,D,i=t.options.context,n=t.options.style;if(!i.cellOverflowLayout&&n.cellButtons&&0<n.cellButtons.length&&(e=t.options.context.sheet,s=i.row,o=i.col,r=R(e,n.cellButtons,s,o,!1,[j.ButtonPosition.left,j.ButtonPosition.right]))&&0<r.length&&(c=kt(n),U(r,e,t.options.context.row),u=t.ctx)){for(a=Dt(t.options.rect.clone(),i),u.save(),u.rect(a.x,a.y,a.width,a.height),u.clip(),u.beginPath(),l=a.x,r=a.x+a.width,h=P(e,i.row,i.col,i.sheetArea),A(h.layout)&&(h.layout={}),g=h.layout,M=R(e,n.cellButtons,s,o,!1,[j.ButtonPosition.left]),I=0;I<M.length&&(f=B(u,l,a.y,Q(M[I].button,c,i),a.height,M[I].button,c,i,h,g,M[I].index,a),!A(f));I++)l+=f.width;for(N=l,l=r,I=(d=R(e,n.cellButtons,s,o,!1,[j.ButtonPosition.right])).length-1;0<=I&&(f=B(u,l-=D=Q(d[I].button,c,i),a.y,D,a.height,d[I].button,c,i,h,g,d[I].index,a),!A(f));I--);u.restore(),(a=t.options.rect).width=a.x+a.width-(r-l)-N,a.x=N}},beforePaintText:function(t){var i,n,e,s,o,t,i=t.context,n=t.style;!i.cellOverflowLayout&&n.cellButtons&&0<n.cellButtons.length&&(e=t.context.sheet,s=i.row,o=i.col,(t=t.externals).left=t.left.concat(ct(R(e,n.cellButtons,s,o,!1,[j.ButtonPosition.leftOfText]),n,i)),t.right=t.right.concat(ct(R(e,n.cellButtons,s,o,!1,[j.ButtonPosition.rightOfText]),n,i)))},beforeFillTextArea:function(t){var i,n,e,s,o,e,r,c,u,a,i=t.style,n=i.cellButtons;i.cellButtons&&0<i.cellButtons.length&&(e=t.ctx,s=t.availRect,o=t.textRect,wt(e,a=R(r=(e=t.context).sheet,n,c=e.row,u=e.col,!1,[j.ButtonPosition.leftOfText]),s,o,i,e,!0))},afterFillTextArea:function(t){var i,n,e,s,o,e,r,c,u,a,i=t.style,n=i.cellButtons;i.cellButtons&&0<i.cellButtons.length&&(e=t.ctx,s=t.availRect,o=t.textRect,wt(e,a=R(r=(e=t.context).sheet,n,c=e.row,u=e.col,!1,[j.ButtonPosition.rightOfText]),s,o,i,e,!1))},onCreateCellEditor:function(t){var i,n,e,s,o,r,c,u,a,t,l,h,g,M,I,i=t.options.dom;if(i&&i.children&&(n=i.children[0])&&n.children&&(e=n.children[0])&&(o=(s=t.context).sheet,r=s.row,c=s.col,u=t.options.cellStyle,a=(u=A(u)?o.getActualStyle(r,c):u).cellButtons,!(A(a)||a&&a.length<=0))){for(t=t.options.cellRect,l=new j.Rect(t.x,t.y,t.width,t.height),h=P(o,r,c,s.sheetArea),A(h.layout)&&(h.layout={}),g=h.layout,M=!1,I=0;I<a.length;I++)a[I].position!==j.ButtonPosition.leftOfText&&a[I].position!==j.ButtonPosition.rightOfText||(M=!0);for(M&&(n.style.overflow="hidden"),I=0;I<k.length;I++)ut(k[I],o,a,s,u,l,r,c,h,g,i,n)}},onActivateCellEditor:function(t){var i,n,e,s,o,r,c,u,a,l,h,g,i=t.context,n=i.sheet,e=i.row,s=i.col,o=t.options.cellStyle,r=o.cellButtons;if(!(A(r)||r.length<=0))for(c=P(n,e,s,i.sheetArea),A(c.editorLayout)&&(c.editorLayout={}),u=c.layout,a=c.editorLayout,l=kt(o),h=t.options.dom,g=0;g<k.length;g++)Mt(k[g],n,r,i,l,t,e,s,c,u,a,h)},onDeactivateCellEditor:function(t){var i,n,e,s,o,n,r,c,u,a,l,h,g,i=t.context,n=i.sheet,e=i.row,s=i.col,o,n=n.getActualStyle(e,s,i.sheetArea).cellButtons;if(n&&0<n.length)for(c=(r=P(i.sheet,e,s,i.sheetArea,!0))&&r.eventListeners,a=(u=t.options.dom).querySelectorAll("."+$),l=0;l<a.length;l++)g=et((h=a[l]).className),A(g)||A(c)||A(c[g])||(dt(h,c[g]),delete r.eventListeners[g])},onUpdateContainer:function(t){var i,n,e,s,i,o,r,c,i=t.context,n=i.sheet,e=i.row,s=i.col,i=P(i.sheet,e,s,i.sheetArea,!0),o=i&&i.canvasSizes,r=t.cellStyle.cellButtons;if(!(A(r)||r.length<=0))for(t.context.preventOverflow=!r.every(function(t){return t.i4i}),c=0;c<k.length;c++)It(k[c],n,r,e,s,o,t)},getCellButtonHitInfo:function(t){t.paddingHitInfo=c(t)},processMouseDownOnCellPadding:function(t){Tt(t)},processMouseUpOnCellPadding:function(t){pt(t)},processMouseMoveOnCellPadding:function(t){xt(t)},processMouseLeaveOnCellPadding:function(t){Lt(t)},getCellButtonAutoHeight:function(e){var s,o,t,r,t,c,s=e.context.sheet,o=e.context.row,t=e.context.col,r=e.cellStyle;r.cellButtons&&0!==r.cellButtons.length&&(t=R(s,r.cellButtons,o,t,!1,[j.ButtonPosition.left,j.ButtonPosition.right]),c=0,t.forEach(function(t){var i,n,i=T.tn(C,t.button.caption,r,s.zoom(),e.context)-2,n;Gt(t.button,o)&&(i=I(i,Ct(t.button))),c=I(i,c)}),e.value=c+ +z)},getCellButtonAutoWidth:function(i){var t,n,e,s,t,o,t=i.context.sheet,n=i.context.row,e=i.context.col,s=i.cellStyle;s.cellButtons&&0!==s.cellButtons.length&&(t=R(t,s.cellButtons,n,e,!1,[j.ButtonPosition.left,j.ButtonPosition.right,j.ButtonPosition.leftOfText,j.ButtonPosition.rightOfText]),o=0,t.forEach(function(t){o+=Q(t.button,s,i.context,!1)}),i.value=o)}}),o.XCe=Y,j.Worksheet.ch(e="cellButtons",{setHost:function(){var n=this;n.bind(j.Events.EnterCell+"."+e,function(t,i){Zt(n,i.row,i.col,!1,i.sheetArea)}),n.bind(j.Events.LeaveCell+"."+e,function(t,i){Zt(n,i.row,i.col,!0,i.sheetArea)}),n.bind(j.Events.TopRowChanged+"."+e,function(t,i){Zt(n,i.row,i.col,!0,i.sheetArea)})},dispose:function(t){var i=this;i.unbind(j.Events.EnterCell+"."+e),i.unbind(j.Events.LeaveCell+"."+e),i.unbind(j.Events.TopRowChanged+"."+e)},processMouseDown:function(t){var i=t.hitInfo.cellTypeHitInfo;i&&i.cellButtonHitInfo&&Tt(i)&&(t.r=!0)}}),j.Workbook.ch(e,{onCultureChanged:function(){tt()}})},"./dist/plugins/celltype/celltypes.entry.js":function(t,i,n){var e,s,o,r,c,u,a,e=this&&this.__createBinding||(Object.create?function(t,i,n,e){void 0===e&&(e=n);var s=Object.getOwnPropertyDescriptor(i,n);s&&("get"in s?i.__esModule:!s.writable&&!s.configurable)||(s={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(t,e,s)}:function(t,i,n,e){t[e=void 0===e?n:e]=i[n]}),s=this&&this.__exportStar||function(t,i){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||e(i,t,n)};Object.defineProperty(i,"__esModule",{value:!0}),i.ti=i.EditorType=i.Context=i.Base=void 0,r=(o=n("Core")).CellTypes.Base,c=o.CellTypes.Context,u=o.CellTypes.EditorType,a=o.CellTypes.ti,i.Base=r,i.Context=c,i.EditorType=u,i.ti=a,i.Hi=o.CellTypes.Hi,i.zi=o.CellTypes.zi,Object.defineProperty(i,"Corner",{set:function(t){t!==i.Hi.Corner&&(i.Hi.Corner=t)},get:function(){return i.Hi.Corner}}),Object.defineProperty(i,"ColumnHeader",{set:function(t){t!==i.Hi.ColumnHeader&&(i.Hi.ColumnHeader=t)},get:function(){return i.Hi.ColumnHeader}}),Object.defineProperty(i,"RowHeader",{set:function(t){t!==i.Hi.RowHeader&&(i.Hi.RowHeader=t)},get:function(){return i.Hi.RowHeader}}),Object.defineProperty(i,"Text",{set:function(t){t!==i.zi.Text&&(i.zi.Text=t)},get:function(){return i.zi.Text}}),s(n("./dist/plugins/celltype/checkboxcelltype.js"),i),s(n("./dist/plugins/celltype/buttoncelltype.js"),i),s(n("./dist/plugins/celltype/hyperlinkcelltype.js"),i),s(n("./dist/plugins/celltype/comboboxcelltype.js"),i),n("./dist/plugins/celltype/cellbuttons.js"),s(n("./dist/plugins/celltype/editor/colorpicker.js"),i),s(n("./dist/plugins/celltype/editor/timepicker.js"),i),s(n("./dist/plugins/celltype/editor/calendar.js"),i),s(n("./dist/plugins/celltype/editor/calculator.js"),i),s(n("./dist/plugins/celltype/editor/monthPicker.js"),i),s(n("./dist/plugins/celltype/editor/listControl.js"),i),s(n("./dist/plugins/celltype/dropdown-action.js"),i),s(n("./dist/plugins/celltype/radiochecklistcelltype.js"),i),s(n("./dist/plugins/celltype/celltypes.ns.js"),i),s(n("./dist/plugins/celltype/rangecelltype.js"),i),s(n("./dist/plugins/celltype/dataobjectcelltype.js"),i),s(n("./dist/plugins/celltype/editor/popupControl.js"),i)},"./dist/plugins/celltype/celltypes.ns.js":function(t,i,n){Object.defineProperty(i,"__esModule",{value:!0}),i.SR=void 0;var n=n("./dist/plugins/celltype/celltypes.res.en.js");i.SR={en:n}},"./dist/plugins/celltype/celltypes.res.en.js":function(t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Calendar_BuiltIn_Yesterday=i.Calendar_BuiltIn_Today=i.Calendar_Today=i.Calendar_FirstYear=i.Calendar_EraName_4=i.Calendar_EraName_3=i.Calendar_EraName_2=i.Calendar_EraName_1=i.Calendar_Time_PM=i.Calendar_Time_AM=i.Calendar_Months_12=i.Calendar_Months_11=i.Calendar_Months_10=i.Calendar_Months_9=i.Calendar_Months_8=i.Calendar_Months_7=i.Calendar_Months_6=i.Calendar_Months_5=i.Calendar_Months_4=i.Calendar_Months_3=i.Calendar_Months_2=i.Calendar_Months_1=i.Calendar_ShortMonths_12=i.Calendar_ShortMonths_11=i.Calendar_ShortMonths_10=i.Calendar_ShortMonths_9=i.Calendar_ShortMonths_8=i.Calendar_ShortMonths_7=i.Calendar_ShortMonths_6=i.Calendar_ShortMonths_5=i.Calendar_ShortMonths_4=i.Calendar_ShortMonths_3=i.Calendar_ShortMonths_2=i.Calendar_ShortMonths_1=i.Calendar_Weeks_7=i.Calendar_Weeks_6=i.Calendar_Weeks_5=i.Calendar_Weeks_4=i.Calendar_Weeks_3=i.Calendar_Weeks_2=i.Calendar_Weeks_1=i.Calendar_ShortWeeks_7=i.Calendar_ShortWeeks_6=i.Calendar_ShortWeeks_5=i.Calendar_ShortWeeks_4=i.Calendar_ShortWeeks_3=i.Calendar_ShortWeeks_2=i.Calendar_ShortWeeks_1=i.Cancel=i.OK=void 0,i.DataObject_MeetTable=i.DataObject_MeetSpan=i.DataObject_MeetLock=i.MultiColumn_InvalidDataSource=i.Calculator_OverFlowInfo=i.Calculator_SqrtParameterException=i.Calculator_InvalidInputInfo=i.Calculator_DivideByZeroInfo=i.StandardColor=i.ThemeColor=i.Quarter_Format_4=i.Quarter_Format_3=i.Quarter_Format_2=i.Quarter_Format_1=i.Calendar_NextTenYear=i.Calendar_LastTenYear=i.Calendar_NextYear=i.Calendar_LastYear=i.Calendar_NextMonth=i.Calendar_LastMonth=i.Calendar_BuiltIn_LastMonth=i.Calendar_BuiltIn_ThisMonth=i.Calendar_BuiltIn_Last7Days=void 0,i.OK="OK",i.Cancel="Cancel",i.Calendar_ShortWeeks_1="MON",i.Calendar_ShortWeeks_2="TUE",i.Calendar_ShortWeeks_3="WED",i.Calendar_ShortWeeks_4="THU",i.Calendar_ShortWeeks_5="FRI",i.Calendar_ShortWeeks_6="SAT",i.Calendar_ShortWeeks_7="SUN",i.Calendar_Weeks_1="Monday",i.Calendar_Weeks_2="Tuesday",i.Calendar_Weeks_3="Wednesday",i.Calendar_Weeks_4="Thursday",i.Calendar_Weeks_5="Friday",i.Calendar_Weeks_6="Saturday",i.Calendar_Weeks_7="Sunday",i.Calendar_ShortMonths_1="JAN",i.Calendar_ShortMonths_2="FEB",i.Calendar_ShortMonths_3="MAR",i.Calendar_ShortMonths_4="APR",i.Calendar_ShortMonths_5="MAY",i.Calendar_ShortMonths_6="JUN",i.Calendar_ShortMonths_7="JUL",i.Calendar_ShortMonths_8="AUG",i.Calendar_ShortMonths_9="SEP",i.Calendar_ShortMonths_10="OCT",i.Calendar_ShortMonths_11="NOV",i.Calendar_ShortMonths_12="DEC",i.Calendar_Months_1="JANUARY",i.Calendar_Months_2="FEBRUARY",i.Calendar_Months_3="MARCH",i.Calendar_Months_4="APRIL",i.Calendar_Months_5="MAY",i.Calendar_Months_6="JUNE",i.Calendar_Months_7="JULY",i.Calendar_Months_8="AUGUST",i.Calendar_Months_9="SEPTEMBER",i.Calendar_Months_10="OCTOBER",i.Calendar_Months_11="NOVEMBER",i.Calendar_Months_12="DECEMBER",i.Calendar_Time_AM="AM",i.Calendar_Time_PM="PM",i.Calendar_EraName_1="M",i.Calendar_EraName_2="T",i.Calendar_EraName_3="S",i.Calendar_EraName_4="H",i.Calendar_FirstYear="1",i.Calendar_Today="Today",i.Calendar_BuiltIn_Today="Today",i.Calendar_BuiltIn_Yesterday="Yesterday",i.Calendar_BuiltIn_Last7Days="Last 7 Days",i.Calendar_BuiltIn_ThisMonth="This Month",i.Calendar_BuiltIn_LastMonth="Last Month",i.Calendar_LastMonth="Go to previous month",i.Calendar_NextMonth="Go to next month",i.Calendar_LastYear="Go to previous year",i.Calendar_NextYear="Go to next year",i.Calendar_LastTenYear="Go to previous ten years",i.Calendar_NextTenYear="Go to next ten years",i.Quarter_Format_1="Q1",i.Quarter_Format_2="Q2",i.Quarter_Format_3="Q3",i.Quarter_Format_4="Q4",i.ThemeColor="Theme Colors",i.StandardColor="Standard Colors",i.Calculator_DivideByZeroInfo="Cannot divide by zero.",i.Calculator_InvalidInputInfo="Invalid Input.",i.Calculator_SqrtParameterException="Invalid input for function.",i.Calculator_OverFlowInfo="Arithmetic operation resulted in an overflow.",i.MultiColumn_InvalidDataSource="Invalid data source. The formula should return an array.",i.DataObject_MeetLock="Cannot insert data because there's a locked cell in the way.",i.DataObject_MeetSpan="Cannot insert data because there's a merged cell in the way.",i.DataObject_MeetTable="Cannot insert data because a table in the way."},"./dist/plugins/celltype/checkboxcelltype.js":function(G,t,i){var n,e,C,s,a,v,r,u,i,D,o,w,c,l,h,z,g,M,b,A,y,j,m,I,f,U,N,E,d,B,Q,T,p,x,R,L,S,k,O,e,P;function Y(t,i,n,e){var t,s,t=t.Ut;t&&(t.do("setValueForKey",i,n,p,l,e),s=t.getValueForKey(i,n,x,e))&&(clearTimeout(s),t.do("setValueForKey",i,n,x,l,e))}function Z(){var t,n,t=P.call(this)||this;return t.typeName="5",t._boxSize=L,n=t,o(S,function(t,i){n["_"+t]=i}),t}function H(t){return 5*t}function W(t,i,n,e,s,o,r,c){var u,a,l,h,g,M,I,f,n,N,d,D,v,w,b,A,r,y,a,e,j,i,u=5*r,a=i.hAlign,l=n.x,h=n.width,g=0,M=0,I=i.vAlign,f=n.y,n=n.height,N=0,d=0,D=1<e.split("\n").length,v=l,w=f,b=h,A=n,r=L*r;return 0===t||1===t?(1===a?M=l+h/2-r/2:b=2===a?(M=l+h-u-r,h-u+2):(v=(M=l+u)-1,h-u+1),A=(a=C.q.un(e,y=b-3-1,i.font)).length*o,D=D||1<a.length,N=r+A,w=0===t?(1===I?(d=f+n/2-N/2+A-3,A+=6):d=2===I?f+n-u-N+A:f+u+A,d-A):(1===I?(d=f+n/2-N/2-3,A+=6):d=2===I?f+n-u-N:f+u,d+r)):(d=1===I?f+n/2-r/2:2===I?f+n-u-r:f+u,i=o/2-(e=z(c.fontInfo.fontSize))/2+(j=8<e?Math.floor((e-8)/5+2):1)-1,D=D||h-r-u-4<s,b=h-r-u,2===I?A=n+i+2-u:0===I&&(A=n-((w=f-(2+i)+u)-f)),2===t?(M=l+h-u-r,b=h-r):v=(M=l+u)+r+1),{multiLine:D,startX:M,startY:d,textX:v,textY:w,textW:b,textH:A}}function V(t,i,n,e,s){var o,i,r,n,c,u,o=5*s,i=i.hAlign,r=n.x-1,n=n.width+1,c=0,u=0;return 0===t||1===t?(u=r+o,1===i?u=r+n/2-L*s/2:2===i&&(u=r+n-o-L*s)):2===t?(c=L*s+e,u=r+o+e,1===i?u=r+n/2-c/2+e:2===i&&(u=r+n-o-c+e)):(c=L*s+e,u=r+o,1===i?u=r+n/2-c/2:2===i&&(u=r+n-o-c)),u-r}function J(t,i,n,e,s){var o,i,r,n,c,u,o=5*s,i=i.vAlign,r=n.y-1,n=n.height+1,c=0,u=0;return 0===t?(c=L*s+e,u=r+o+e,1===i?u=r+n/2-c/2+e:2===i&&(u=r+n-o-c+e)):1===t?(c=L*s+e,u=r+o,1===i?u=r+n/2-c/2:2===i&&(u=r+n-o-c)):(u=r+o,1===i?u=r+n/2-L*s/2:2===i&&(u=r+n-o-L*s)),u-r}function X(t,i,n,e,s){var o,o,o,o=i.getValue(n,e,s),o=t.wG(o),o={cmd:"editCell",sheetName:i.name(),row:n,col:e,newValue:o,autoFormat:!0};i.Qy().execute(o),t.j3(i,n,e,s)}function F(t,i,n,e,s){var o,r,o=s&&s.sheet,r=t.getEditorValue(i,s);t.setEditorValue(i,r,s),t.updateEditor(i,n,e,s),t.j3(o,o.ui,o.ci,s.sheetArea)}n=this&&this.__extends||(O=function(t,i){return(O=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}O(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.CheckBox=t.CheckBoxTextAlign=void 0,e=i("Common"),C=i("Core"),s=C.mt.En,a=e.Common.lt.ht,v=C.mt.vt,r=C.mt.vi,u=C.CellTypes.Context,i=C.CellTypes.Base,D=C.GC$,o=D.each,w=C.mt.yt,c=null,l=void 0,h=Math.max,z=parseInt,g="position",M="absolute",b="font",A="left",y="right",j="top",m="alphabetic",I=".gcEditingInput",f="background-color",U="white",N="green",E="div",d="normal 11pt calibri",B="width",Q="height",T="white-space",p="_isFirstMouseUp",x="_mouseupToken",(e=R=t.CheckBoxTextAlign||(t.CheckBoxTextAlign={}))[e.top=0]="top",e[e.bottom=1]="bottom",e[e.left=2]="left",e[e.right=3]="right",S={caption:"",textTrue:"",textIndeterminate:"",textFalse:"",textAlign:3,isThreeState:!(L=12),boxSize:L},n(Z,P=i),Z.prototype.Poe=function(t,i,n,e,s,o,r,c){var u=this,a=z(n.startX),l=z(n.startY),h=z(n.textX),g=z(n.textY),M=z(n.textW),n=z(n.textH);u.Goe(t,a,l,s,o,r),u.paintText(t,i,h,g,M,n,c,e,i,null)},Z.prototype.Goe=function(t,i,n,e,s,o){t.save(),t.strokeStyle="black",t.strokeRect(i+.5,n+.5,2*e+.05,2*e+.05),t.fillStyle=U,t.fillRect(i+1,n+1,2*e-1,2*e-1),this._isThreeState&&a(o)?(t.beginPath(),t.fillStyle=N,t.rect(i+3*s,n+3*s,2*(e-2.5*s),2*(e-2.5*s)),t.fill()):!0==!!o&&(t.beginPath(),t.lineWidth=2.5*s,t.moveTo(i+3*s,n+e),t.lineTo(i+e,n+2*e-3.5*s),t.lineTo(i+2*e-1.5*s,n+3*s),t.stroke()),t.restore()},Z.prototype.paintValue=function(t,i,n,e,s,o,r,c){var u,a,l,h,g,M,I,f,N,N,d,D,d,D,d,s,o,o,s,d,n,o,e,s,u,a,r;t&&(t.save(),t.rect(n,e,s,o),t.clip(),t.beginPath(),u=r.hAlign,a=r.font,l=r.foreColor,g=(h=this)._textAlign,M=h.getText(i,c),f=I=0,(N=c.sheet)&&(I=N.Qt(M,a),f=v(a)),N=N.zoom(),d=c.isPrinting,D=c.printZoomFactor,++n,++e,--s,--o,D=(d=this.CG(f,N=d&&"number"==typeof D&&1!==D?D:N)).radius,d=d.scaleFactor,s=new C.Rect(n,e,s,o),r.wordWrap&&(o=W(g,r,s,M,I,f,N*d,c)).multiLine?h.Poe(t,M,o,c,D,N,i,r):(o=V(g,r,s,I,N*d),s=J(g,r,s,f,N*d),d=z((n+o).toString()),n=z((e+s).toString()),o=A,e=d+1,1===u?(o="center",e+=D):2===u&&(o=y,e+=2*D),a&&t.font!==a&&C.mt.bt(t,a),l&&(t.fillStyle=l),s=r.textDecoration,r=f/2-(u=parseInt(c.fontInfo.fontSize,10))/2+(a=8<u?Math.floor((u-8)/5+2):1)-1,t.textBaseline!==m&&(t.textBaseline=m),2===g?(t.textAlign=y,t.fillText(M,d+1-2,n+D+f/2-r),s&&h.le(t,s,d+1-2,n+D+f/2-r,I,u,a)):0===g&&(t.textAlign=o,t.fillText(M,e,n-2-r),s)&&h.le(t,s,e,n-2-r,I,f),h.Goe(t,d,n,D,N,i),l&&(t.fillStyle=l),3===g?(t.textAlign=A,t.fillText(M,d+1+2*D+2,n+D+f/2-r),s&&h.le(t,s,d+1+2*D+2,n+D+f/2-r,I,u,a)):1===g&&(t.textAlign=o,t.fillText(M,e,n+2*D+2+f-r),s)&&h.le(t,s,e,n+2*D+2+f-r,I,u,a)),t.restore())},Z.prototype.CG=function(t,i){var n,e,s,o,n,e=this._boxSize,s=L/2,o=1;return"auto"===e&&(s=t/4,o=t/2/L),"number"==typeof e&&0<e&&(s=i*e/2,o=e/L),{radius:s,scaleFactor:o}},Z.prototype.bi=function(t,i,n){var e,i,t,s,o,r,e,i=i.font,t=this.getText(t,n),s=0,o;return n.sheet&&(s=v(i),t)&&(s*=(r=t.split(/\r\n|\r|\n/)).length),s},Z.prototype.getText=function(t,i){return this.SG(t)},Z.prototype.focus=function(t,i){t&&t.parentNode.focus()},Z.prototype.createEditorElement=function(t,i){var n,n,n,i,t,e,e,i,n=t&&t.sheet&&t.sheet.parent&&t.sheet.parent.Ti,n=C.mt.gi(n)+1e3;return D(i).css("z-index",n).attr("tabindex",1).attr("gcUIElement","gcEditingInput"),(n=D(i.firstChild)).css("overflow","hidden"),(i=D(s("input"))).attr("type","checkbox"),i.attr("class","gc-checkbox-cell-type-input"),e=(t=this.TG(t))/L,i.css("transform","scale("+e+")"),n.append(i),(e=D(s("span"))).css(g,M).css(b,w(d)).css("cursor","default").css(T,"nowrap").css("word-break","break-all"),n.append(e),(i=D(s(E))).css(g,M).css(f,N).css("width",2*(t/2-2.5)).css("height",2*(t/2-2.5)),n.append(i),c},Z.prototype.TG=function(t){var i,n,i,e,i=t.sheet,n=i.zoom();return"number"==typeof this._boxSize&&0<this._boxSize?this._boxSize*n:"auto"===this._boxSize?(e="",e=(i=i.Z_(t.row,t.col))&&i.font?i.font:d,n*v(e)/2):L/2},Z.prototype.wG=function(t){var t,t=this._isThreeState?!a(t)&&(!0!=!!t||c):!t;return t},Z.prototype.setEditorValue=function(t,i,n){var t,e,s,t,o,n,r,c,u;t&&(e=(t=t.parentNode.children)[0],s=t[1],t=t[2],e)&&s&&t&&(o=this,u=c=void 0,(r=(n=n&&n.sheet)&&n.Ai)||(u=o.wG(i)),o._isThreeState?a(u)?(c=!1,D(t).show()):(c=!!u,D(t).hide()):c=!!u,e.checked=c,D(s).text(o.SG(u)))},Z.prototype.getEditorValue=function(t,i){if(t){var t=t.parentNode.children,n=t[0],e=t[1],t=t[2];if(n&&e&&t&&(!this._isThreeState||!D(t).isVisible()))return n.checked}return c},Z.prototype.j3=function(t,i,n,e){var s=t.parent;s&&s.j3(t,i,n,e)},Z.prototype.activateEditor=function(i,n,e,s){var t,t,o,t=s&&s.sheet;i&&t&&(t=D(i.parentNode.parentNode),o=this,t.bind("mousedown"+I,function(t){r(t)}),t.bind("mouseup"+I,function(){F(o,i,n,e,s)}),t.bind("keydown"+I,function(t){var i=t.keyCode;if(!t.ctrlKey&&!t.shiftKey&&!t.altKey){if(32===i)return o.AG=!0,r(t),!1;8===i&&r(t)}}),t.bind("keyup"+I,function(t){!o.AG||32!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||(o.AG=!1,F(o,i,n,e,s))}),D(i).bind("click",function(t){r(t)}))},Z.prototype.updateEditor=function(t,i,n,e){var s,o,t,r,c,u,r,t,u,a,l,h,g,a,l,o,s,M,a,u,e,I,f,n,l,f,n,c,N,d,h,u,s=e&&e.sheet;t&&s&&(o=s.Dn,c=(r=(t=t.parentNode).children)[0],u=r[1],r=r[2],c)&&u&&r&&(D(t).width(n.width).height(n.height),u=(t=D(u)).text(),a=i.foreColor,l=i.font,h=i.hAlign,g=i.textDecoration,a&&t.css("color",a),a=void 0,a=l||o.Nn(),1<(l=s.zoom())&&(a=o._n(a)),t.css(b,w(a)),o=s.Gi(u,a),s=v(a),u&&(s*=(M=u.split(/\r\n|\r|\n/)).length),f=V(u=(a=this)._textAlign,i,n,o,l*(I=(e=this.TG(e))/L)),n=J(u,i,n,s,l*I),D(c).css("margin-left",f).css("margin-top",n),l=c.offsetLeft,f=c.offsetTop,n=c.offsetWidth,c=c.offsetHeight,(d=N=0)===u?(N=l,1===h?N=l+e/2-o/2:2===h&&(N=l+e-o),d=f-s,N-=(I-1)*L/2,d-=(I-1)*L/2):1===u?(N=l,1===h?N=l+e/2-o/2:2===h&&(N=l+e-o),d=f+c,N-=(I-1)*L/2,d+=(I-1)*L/2):(2===u?(N=l-o-2,d=f+e/2-s/2,N-=(I-1)*L/2):(N=l+n+2,d=f+e/2-s/2,N+=(I-1)*L/2),d-=(I-1)*L/2),t.css(A,N).css(j,d),i.wordWrap?t.css(T,"normal"):t.css(T,"nowrap"),a._isThreeState?(h=l+(n-r.offsetWidth)/2,u=f+(c-r.offsetHeight)/2,D(r).css(A,h).css(j,u).toggle().toggle()):D(r).hide(),g)&&a.Qe(t,g)},Z.prototype.SG=function(t){var i=this,n=i._caption;return i._isThreeState&&a(t)?i._textIndeterminate||n:!0==!!t?i._textTrue||n:i._textFalse||n},Z.prototype.getHitInfo=function(t,i,n,e,s){if(s){var o=s.sheetArea;if(a(o)||3===o)return{x:t,y:i,row:s.row,col:s.col,cellRect:e,sheetArea:3,isReservedLocation:!0,sheet:s.sheet,cellStyle:n}}return c},Z.prototype.processMouseDown=function(t){if(!t)return!1;t.isReservedLocation&&(this.pG=!0)},Z.prototype.processMouseUp=function(t){var i,n,e,s,o,r,t,i=this,n=t&&t.sheet;if(n&&i.pG&&t.isReservedLocation){if(i.pG=!1,e=t.row,s=t.col,o=t.sheetArea,!(r=n.Ut.getValueForKey(e,s,p,o)))return X(i,n,e,s,o),n.Ut.do("setValueForKey",e,s,p,!0,o),t=setTimeout(function(){Y(n,e,s,o)},250),n.Ut.do("setValueForKey",e,s,x,t,o),!0;Y(n,e,s,o)}return!1},Z.prototype.processMouseLeave=function(t){if(!t)return!1;this.pG=!1},Z.prototype.isReservedKey=function(t,i){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},Z.prototype.processKeyUp=function(t,i){return X(this,i.sheet,i.row,i.col,i.sheetArea),!0},Z.prototype.getAutoFitWidth=function(t,i,n,e,s){var o,r,c,t,n,o=this,r=o._textAlign,c=u.Bt(t,o.SG(t),n,e,s),t=o.bi(t,n,s),n=2*o.CG(t,e).radius;return 0===r||1===r?c=h(c,n):c+=n,c+5+2},Z.prototype.getAutoFitHeight=function(t,i,n,e,s){var o,r,c,c,t,n,o=this,r=o._textAlign,c=o.SG(t),c=u.tn(c,c,n,e,s),t=o.bi(t,n,s),n=2*o.CG(t,e).radius;return 0===r||1===r?c+=n:c=h(c,n),c+5},Z.prototype.QD=function(t){this.isReservedKey(t)&&r(t)},Z.prototype.isImeAware=function(t){return!1},Z.prototype.Ke=function(){},Z.prototype.Je=function(t){var t={caption:t.caption,textTrue:t.textTrue,textIndeterminate:t.textIndeterminate,textFalse:t.textFalse,textAlign:t.textAlign&&R[t.textAlign],isThreeState:t.isThreeState,boxSize:t.boxSize};this.fromJSON(t)},Z.prototype.toJSON=function(){var n,e,s,n=this,e={typeName:n.typeName};return o(S,function(t,i){(s=n["_"+t])!==i&&(e[t]=s)}),e},Z.prototype.fromJSON=function(n){var e=this;o(S,function(t){var i=n[t];a(i)||(e["_"+t]=i)})},Z.prototype.Tfe=function(t){var i,n=this._textAlign;return 2===n||3===n?L*t+5*t:0},k=Z,t.CheckBox=k,o(S,function(i){k.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:("boxSize"===i&&("number"==typeof t&&0<t&&(this["_"+i]=t),"auto"!==t)||(this["_"+i]=t),this)}}),C.CellTypes.ti[5]=k},"./dist/plugins/celltype/comboboxcelltype.js":function(s,t,i){var o,E,D,B,l,h,Q,a,c,g,r,R,P,Y,H,M,I,v,u,f,N,d,w,W,V,J,X,b,A,y,j,F,C,z,m,_,K,T,p,q,$,tt,x,it,nt,L,et,S,st,ot,rt,k,ct,ut,at,lt,ht,gt,Mt,It,ft,O,Nt,dt,Dt,vt,wt,bt,At,i,yt;function Z(t,i){t.appendChild(i)}function jt(t,i){t.removeChild(i)}function G(t){return t&&t.parentNode.parentNode.comboBox}function n(t,i,n,e,s,o,r,c,u){var a,i,u,t,n,e,n,t,u,a=this;a.xG=t,a.sfe=i,a.dfe=u,i=t.firstChild,g(t).bind(N,function(t){a.NG(t)}).css([q,A,y,z,m,"overflow"],[r||0,n,e,s,o,"visible"]).attr([j],["gcComboBox"]),u=v(0,s-17),a._editable=!1,a.DG=t=l(L),a._G=n=l("textarea"),Z(i,a.EG=t),Ct(t),Ct(n),g(n).bind("keyup",function(){var t,i,t=a.EG.value;a._text=t,i=a.jG(t),a.editorValue(i),a.OG(t,!0,i),a.RG()}).bind(d,function(){a.BG()}).bind(w,function(){a.RG()}),g(t).bind(f,function(){a.LG?a.ki(O,{isMouse:!0}):a.PG()}).bind(d,function(){a.BG()}).bind(w,function(){a.RG()}),a.GG(0,0,u,o),Z(i,e=a.UG=l(L)),g(e).css([ot,J,p,K],[C,X,x,tt]).attr(j,"gcDropDownButton").bind(f,function(){var t,i;!h(a.HG)&&(t=a.HG,a.HG=I,(i=(new Date).valueOf())-t<100)||(a.LG?a.ki(O,{isMouse:!0}):a.PG())}),n=l("canvas"),a.fg=n,a.zG(u,0,s-u,o),Z(e,n),Z(i,t=a.VG=l(L)),a.YG=!1,a.ZG=c||s,g(t).css([J,ot,p,q,_,$,"cursor",K,m,rt],[X,"1px solid",x,r||0,C,C,"default",tt,o,a.ZG+k]),g(t).attr(j,"gcDropDownWindow").attr(F,-1),a.WG(0,+o),a.QG=0,Z(t,u=a.KG=l(L)),a.JG=new D.x4(t,u),a._itemHeight=22,a.qG=20,a.$G=-1,a._editorValueType=0,a._items=[],a.eU=dt,a.iU=""}function Ct(t){g(t).css(["margin","overflow","resize",J,"padding",_,p,"white-space",K,ot],[0,"hidden",C,X,Mt+"px 0px 0px "+gt+k,C,x,"nowrap",tt,C]).attr(j,"gcComboBoxEditor").attr(F,-1)}function e(){var t,n,t=yt.call(this)||this;return t.typeName="7",t.v6=!1,t.rU=!1,n=t,r(vt,function(t,i){n["_"+t]=i="items"===t?[]:i}),t}function zt(t){var i,t,n,e,s,i=["0","0","0","0"];return typeof t===W&&(s=e=void 0,1===(n=(t=t.split(" ",4)).length)?i=[e=t[0],e,e,e]:2===n?i=[e=t[0],s=t[1],e,s]:3===n?(s=t[1],i=[t[0],s,t[2],s]):4===n&&(i=[t[0],t[1],t[2],t[3]])),i}function U(t,i){return t.hasOwnProperty(i)}o=this&&this.__extends||(At=function(t,i){return(At=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}At(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.ComboBox=t.EditorValueType=void 0,E=i("Common"),D=i("Core"),B=D.CellTypes.Base,l=D.mt.En,h=E.Common.lt.ht,Q=E.Common.ft,a=D.mt,c=a.vi,g=D.GC$,r=g.each,R=a.yt,P=a.Ct,Y=a.M0,H=document,M=null,I=void 0,v=Math.max,u=parseInt,f="click",N="keydown",d="mouseover",w="mouseout",W="string",V="number",J="position",X="absolute",b="font",A="left",y="top",j="gcUIElement",F="tabindex",C="none",z="width",m="height",_="outline",K="box-sizing",T="color",p="background-color",q="z-index",$="display",tt="content-box",x="white",it="black",nt="title",L="div",et="span",S="text",st="value",ot="border",rt="min-width",k="px",ct=a.wt,(i=ut=t.EditorValueType||(t.EditorValueType={}))[i.text=0]="text",i[i.index=1]="index",i[i.value=2]="value",at=17,Mt=gt=1,It=gt,O="EndEdit.gcEditingInput",Nt=ft=18,dt="lightgrey",vt={editorValueType:ht=0,items:M,itemHeight:22,editable:!(Dt="#1E90FF"),maxDropDownItems:lt=20,allowFloat:!0},n.prototype.getComboBox=function(){return this.xG},n.prototype.dispose=function(){var t=this;g(t.xG).unbind(N),g(t._G).unbind("keyup").unbind(d).unbind(w),g(t.DG).unbind(f).unbind(d).unbind(w),g(t.UG).unbind(f),g(t.KG).find("div").forEach(function(t){g(t).unbind(d).unbind(w).unbind(f)}),t.JG.dispose()},n.prototype.updateLocationAndSize=function(t,i,n,e){var s,o,s=this,o=v(0,n-17);s.GG(0,0,o,e),s.zG(o,0,n-o,e),s.WG(0,+e)},n.prototype.updateStyle=function(t,i,n){var e=this;n=R(n),t=t||I,g(e.EG).css(p,t).css(T,i).css(b,n),g(e.UG).css(p,t).css(T,i).css(b,n),g(e.VG).css(p,t).css(T,i).css(b,n),e.iU=i,g(e.xG).css(p,"transparent"),e.eU=Q.Tv(Q._(t),Q._(dt))?x:dt},n.prototype.updateImeMode=function(t){g(this.EG).css("ime-mode",t)},n.prototype.editorValueType=function(t){return 0===arguments.length?this._editorValueType:(this._editorValueType=t,this)},n.prototype.editorValue=function(t){var i,n,i=this;return 0===arguments.length?i.oU:(t!==i.oU&&(i.oU=t,n=i.aU(t),i.text(n),i.OG(n,!0,t)),i)},n.prototype.aU=function(t){var i,n=this,e=n._items,s=e.length,o=n._editorValueType,r,c,u;if(n.uU=!0,1===o)(i=(r=e[t])&&U(r,S)?r.text:r)===I&&(i=t,n.uU=!1);else if(0===o){for(i=t,u=0;u<s&&!((r=e[u])&&U(r,S)&&r.text===t||r===t);u++);s<=u&&(n.uU=!1)}else if(2===o){for(c=0;c<s;c++)if((r=e[c])&&U(r,st)&&r.value===t){i=r.text;break}s<=c&&(i=t,n.uU=!1)}return i=h(t)?"":i},n.prototype.jG=function(t){var i,n,e,i,s,o,r,c,i=this,n=i._items,e=n.length,i=i._editorValueType,s=t;if(1===i)for(r=0;r<e;r++)((o=n[r])&&U(o,S)&&o.text===t||o===t)&&(s=r);else if(2===i)for(c=0;c<e;c++)(o=n[c])&&U(o,S)&&o.text===t?s=o.value:o===t&&(s=I);return s},n.prototype.OG=function(t,i,n){var e,s,o,r,c,u,a,l,s=-1;if(!h(t)&&""!==t)for(r=(o=this._items).length,e=0;e<r;e++)if(a=u=void 0,u=U(c=o[e],S)?c.text:c,U(c,st)&&(a=c.value),(l=i?u:u.toString().substr(0,t.length))===t){if(s=e,h(n))break;if(!h(a)&&a===n)break}this.sU(s)},n.prototype.RG=function(){g(this.EG).removeAttr(nt)},n.prototype.BG=function(){var t,i,n,e,t=this,i=t.Wt(t._text),n=g(t.EG),e;n.width()+gt<i?n.attr(nt,t._text):n.removeAttr(nt)},n.prototype.GG=function(t,i,n,e){n-=0,e-=0,g(this.EG).css(A,t).css(y,i).css(z,n-gt).css(m,e-Mt)},n.prototype.editable=function(t){var i,n,e,s,o,s,i=this;return 0===arguments.length?i._editable:i._editable!==t?(i._editable=t,n=i.xG.firstChild,e=i.EG,s=g(e),o={left:u(s.css(A)),top:u(s.css(y)),width:u(s.css(z)),height:u(s.css(m))},s={backColor:s.css(p),foreColor:s.css(T),font:e.style.font},jt(n,e),i.EG=t?i._G:i.DG,Z(n,i.EG),g(i.EG).css(p,s.backColor).css(T,s.foreColor).css(b,s.font),i.GG(o.left,o.top,o.width,o.height),i):void 0},n.prototype.text=function(t){var i=this,n=i.EG;if(0===arguments.length)return i._text;t!==i._text&&(i._text=t,i._editable?n.value=t:n.textContent=t)},n.prototype.focus=function(){var t=this,i=t.EG;i.focus(),t._editable&&(i.selectionStart=i.value.length)},n.prototype.selectAll=function(){var t=this;t._editable&&t.EG.select()},n.prototype.zG=function(t,i,n,e){var s,o,s,t,i;n-=0,e-=0,o=(s=this).fg,g(s.UG).css(A,t).css(y,i).css(z,n).css(m,e),g(o).attr(z,n).attr(m,e),s=o.width,t=o.height,(i=o.getContext("2d")).beginPath(),i.lineWidth=2,i.fillStyle=it,i.moveTo(s-17+4,(t-2)/2-2.5),i.lineTo(s-17+7,(t-2)/2+3.5),i.lineTo(s-17+10,(t-2)/2-2.5),i.fill()},n.prototype.showDropDownList=function(){var i=this,t=i.JG;i.YG=!0,g(i.VG).bind(N,function(t){i.NG(t)}).show(),i.cU=!1,i.fU(),this.adjustPosition(),i.cU&&t.pS(g(i.KG.children).height()),t.w4(!1),i.lU(Dt,x),i.hU(i.$G),i.focus()},n.prototype.adjustPosition=function(){var t,i,n,e,s,o,r,c,u,a,l,a,h,h,h,a,t=this,i=g(t.VG);i&&(n=parseInt(i.css("left"),10),e=parseInt(i.css("top"),10),s=i.width(),o=i.height(),isNaN(n)||isNaN(e)||isNaN(s)||isNaN(o)||(c=r=0,!(u=.8)!==this.dfe?(l=(a=H.documentElement).clientWidth,a=a.clientHeight,h=i[0].getBoundingClientRect(),a<o&&(i.css("max-height",Math.round(.8*a)+k),o=Math.round(.8*a)),l<s&&(i.css("max-width",Math.round(.8*l)+k),s=Math.round(.8*l)),h.left+s>l&&(c=h.left+s-l),h.top+o>a&&(r=h.top+o-a)):(a=(h=t.sfe).clientHeight,l=h.clientWidth,a<o&&(o=Math.round(.8*a),i.css("max-height",o+k)),l<s&&(s=Math.round(.8*l),i.css("max-width",s+k)),h=i[0].getBoundingClientRect(),a=t.sfe.getBoundingClientRect(),r=v(0,h.bottom-a.bottom),c=v(0,h.right-a.right)),(n<0||e<0||0<r||0<c)&&((n-=c)<0&&(n-=22),i.css({left:n+k,top:(e-=r+5)+k}))))},n.prototype.shiftPadding=function(t,i){var n=this.xG.firstChild;t===A?g(n).css({left:(+g(n).css(A).replace(k,"")||0)-i}):t===y&&g(n).css({top:(+g(n).css(y).replace(k,"")||0)-i})},n.prototype.closeDropDownList=function(){var t=this;t.YG=!1,g(t.VG).unbind(N).hide(),t.lU("",t.iU),t.focus()},n.prototype.PG=function(){this.YG?this.closeDropDownList():this.showDropDownList()},n.prototype.listHeight=function(t){var i=this,n=g(i.VG);if(0===arguments.length)return n.height();0<t&&(n.height(t),i.JG.w4(!1))},n.prototype.WG=function(t,i){g(this.VG).css(A,t).css(y,i)},n.prototype.items=function(t){var i,n,e,s,o,r,i=this;if(0===arguments.length)return i._items;if(t){for(i._items=t,n=i.KG,e=void 0,g(n).find("div").forEach(function(t){g(t).unbind(d).unbind(w).unbind(f)}),e=n.firstChild;e;)jt(n,e),e=n.firstChild;for(s=i.QG=0,o=t.length;s<o;s++)r=t[s],i.dU(U(r,S)?r.text:r);return i}},n.prototype.dU=function(t){var i,n,e,i=this,n=l(L),e=l(et);e.textContent=t.toString(),e.style.padding="0 18px 0 "+It+k,e.style.textOverflow="ellipsis",e.style.whiteSpace="nowrap",Z(n,e),Z(i.KG,n),i.QG++,g(n).bind(f,function(){var t=g(n).index();i.selectedIndex(t),i.closeDropDownList(),i.ki(O,{isMouse:!0})}).bind(d,function(){var t=g(n);n.oldBackColor=t.css(p),t.css(p,i.eU)}).bind(w,function(){g(n).css(p,n.oldBackColor||"")}).css(rt,i.ZG+"px")},n.prototype.vU=function(){var t=this;t.S5=l(et),g(t.S5).css([$,b],[C,t.VG.style.font]).appendTo(H.body)},n.prototype.mU=function(){jt(H.body,this.S5)},n.prototype.Mt=function(t){return this.S5.textContent=t,g(this.S5).width()+2+It},n.prototype.lU=function(t,i){var n=this,e=n.$G;0<=e&&e<n.QG&&g(n.KG.children[e]).css([p,T],[t,i])},n.prototype.NG=function(t){var i,n,e,s,o,r,i=this,n=t.keyCode,e=t.which;(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey||37===e||39===e)&&9!==e&&i.editable()||(s=i.QG,o=i.$G,r=0,38===e||40===e?(0<=(r=0<=o&&o<s?o+(38===e?-1:1):r)&&r<s&&i.selectedIndex(r),i.YG&&i.hU(r),c(t)):13===e||37===e||39===e||9===e?(i.selectedIndex(i.$G),(i.YG||i.editable())&&i.closeDropDownList(),i.ki(O,{keyCode:n,shiftKey:t.shiftKey}),(i.YG||i.editable())&&c(t)):27===e?(i.closeDropDownList(),i.ki(O,{keyCode:n}),c(t)):i.editable()||32!==e||c(t))},n.prototype.getSelectedValue=function(t,i,n){var i,e,i=i[t];return h(i)||(1===n?e=t:0===n?e=U(i,S)?i.text:i:2===n&&U(i,st)&&(e=i.value)),e},n.prototype.sU=function(t){var i=this;i.lU("",i.iU),i.$G=t,i.lU(Dt,x),i.hU(t)},n.prototype.selectedIndex=function(t){var i,t,i=this;if(0===arguments.length)return i.$G;0<=t&&t<i.QG&&(i.sU(t),t=i.getSelectedValue(i.$G,i._items,i._editorValueType),h(t)||i.editorValue(t))},n.prototype.itemCountPerPage=function(t){if(0===arguments.length)return this.qG;0<t&&(this.qG=t)},n.prototype.allowFloat=function(t){var i=this;if(0===arguments.length)return i.dfe;i.dfe=t},n.prototype.Wt=function(t){this.vU();var t=this.Mt(t);return this.mU(),t},n.prototype.itemHeight=function(t){if(0===arguments.length)return this._itemHeight;0<t&&(this._itemHeight=t)},n.prototype.fU=function(){var t,i,i,n,e,s,t=this;t.vU(),i=t._items[0],i=v(t._itemHeight,g(t.S5).text(h(i)?"":i).height()),g(t.KG.children).css(m,i),(e=t.QG)<=(s=t.qG)?n=e*i:(n=s*i,t.cU=!0),t.listHeight(n),t.mU()},n.prototype.hU=function(t){var t;0<=t&&t<this.QG&&(t=this.KG.children[t],this.JG.xS(t))},n.prototype.bind=function(t,i,n){g(this.xG).bind(t,i,n)},n.prototype.unbind=function(t,i){g(this.xG).unbind(t,i)},n.prototype.ki=function(t,i){g(this.xG).trigger(t,i)},wt=n,o(e,yt=B),e.prototype.isReservedKey=function(t,i){return this.rU},e.prototype.paintValue=function(t,i,n,e,s,o,r,c){var u,a,a,l,h,g,M,g,M,I,f,N,d,I,f,N,I,f,u=this,a=c.sheet,a=a.zoom?a.zoom():1,l=17,h=v(0,s-17-1);3===r.hAlign&&(r.hAlign=0),r.wordWrap&&(r.wordWrap=!1),g=c.isPrinting,M=c.printZoomFactor,g&&"number"==typeof M&&1!==M&&(a=M),0<h&&0<o&&(g={},M=void 0,c.quotePrefix=r.quotePrefix,I=r.formatter&&"General"!==r.formatter,f=r._autoFormatter&&r._autoFormatter.formatCached&&"General"!==r._autoFormatter.formatCached,N=void 0,d=this.getItemValue(i),N=I?r.formatter:f?r._autoFormatter:D.CellTypes.Context.Nt(t,d,h+1,r,a),M=this.format(ct(i),N,g,c),M=(I=u.getText(i,c))!==i?M||(i=I):M)&&(f=new D.Rect(n,e,s,o),yt.prototype.adjustRectForIconSet.call(this,r.hAlign,c.sheet,c.row,c.col,c.sheetArea,f,g.content&&yt.prototype.hasInfilling.call(this,g.content)),n=f.x,s=f.width,N=r.isVerticalText,P(d)&&!N&&!0!==r.shrinkToFit&&(M!==(I=D.CellTypes.Context.Et(t,M,h+1,r,a))&&(delete g.content,r.textIndent=0),M=I),f=u.Pn(t,M,r,c,n,e,s,o),this.paintText(t,i,n,e,h,o,r,c,M,g,void 0,f.externals)),t.save(),(s<17||o<17)&&(t.rect(n,e,s,o),t.clip()),t.beginPath(),t.lineWidth=2,t.fillStyle=it,t.moveTo(n+s-17+3,e+(o-2)/2-2.5),t.lineTo(n+s-17+6,e+(o-2)/2+3.5),t.lineTo(n+s-17+9,e+(o-2)/2-2.5),t.fill(),t.restore()},e.prototype.getText=function(t,i){return t},e.prototype.createEditorElement=function(t,i){var n,e,e,e,s,o,r,c,r,u,u,t,n=t&&t.sheet,e=n&&n.parent,e=e&&e.Ti,e=a.gi(e)+1e3,s=n.defaults,o=this,r=n.getActualStyle(t.row,t.col).cellPadding,c=0;return r&&(c=parseFloat(zt(r)[3])||0),r=0,r=(u=n.getSpan(t.row,t.col))?Y(n,u.col,u.col+u.colCount,!1):n.nn(t.col)-c,(u=new wt(i,n.qc(),0,0,s.colWidth,s.rowHeight,e,r)).editorValueType(o._editorValueType),u.items(o._items),u.itemHeight(o._itemHeight),u.itemCountPerPage(o._maxDropDownItems),u.editable(o._editable),u.allowFloat(o.allowFloat()),t=u.getComboBox(),Object.defineProperty(t,"comboBox",{get:function(){return this.gU},set:function(t){this.gU!==t&&(this.gU&&this.gU.dispose(),this.gU=t)}}),t.comboBox=u,M},e.prototype.getEditorValue=function(t,i){var t=G(t);return t&&(this.v6=!t.uU),t&&t.editorValue()},e.prototype.setEditorValue=function(t,i,n){var t=G(t);t&&t.editorValue(i)},e.prototype.focus=function(t,i){var t=G(t);t&&t.focus()},e.prototype.selectAll=function(t,i){var t=G(t);t&&t.selectAll()},e.prototype.activateEditor=function(t,i,n,e){var s,u,a,s=this,u=e.sheet,a=G(t);a&&(a.editorValueType(s._editorValueType),a.items(s._items),a.itemHeight(s._itemHeight),a.itemCountPerPage(s._maxDropDownItems),a.editable(s._editable),a.bind(O,function(t,i){var n,e,s,n,o,r,c,n=i.keyCode,e=i.shiftKey;if(n){if(n=(s=u.Qy()).getShortcutKey(n,!1,e||!1,!1,!1),o=s.getCommands(n))for(r=0,c=o.length;r<c;r++)if("navigationLeft"!==o[r].Zc&&"navigationRight"!==o[r].Zc||(u.Di=1),o[r].execute(u.parent,{sheetName:u.name()}))return!0}else i.isMouse&&a.LG&&u.endEdit()})),s.rU=!0},e.prototype.deactivateEditor=function(t,i){var n,e,s,o,r,c;if(t&&(n=G(t))){if(e=i.sheet.getActualStyle(i.row,i.col,i.sheetArea).cellPadding)for(s=[A,y],o=[3,0],r=0;r<s.length;r++)c=parseInt(zt(e)[o[r]],10),n.shiftPadding(s[r],c=typeof c==V&&0<c?c:0);n.unbind(O),n.closeDropDownList(),n.LG=!1}this.rU=!1},e.prototype.updateImeMode=function(t,i){var t;this.isImeAware()&&(t=G(t))&&t.updateImeMode(i)},e.prototype.updateEditor=function(t,i,n,e){var e,t,e,e=t&&e&&e.sheet;e&&(t=G(t),i&&t&&(e=e.Dn,t.updateStyle(i.backColor,i.foreColor||it,e._n(i.font||e.Nn()))),n)&&t&&t.updateLocationAndSize(n.x,n.y,n.width,n.height)},e.prototype.format=function(t,i,n,e){var s,t;return h(t)?"":(t=(s=this).getItemValue(t),B.prototype.format.call(s,t,i,n))},e.prototype.getItemValue=function(t){var i,n,e,s,o,r,i,c,i=this,n=i._editorValueType,e=i._items;if(e)if(r=e.length,1===n){if(0<=(i=u(t))&&i<r&&(s=e[i])!==I&&s!==M)return o=U(s,S)?s.text:s}else if(2===n)for(c=0;c<r;c++)if((s=e[c])&&U(s,st)&&s.value===t)return o=s.text;return t},e.prototype.parse=function(t,i,n){var e,s,o,r,c,u,a,e=this,s=e._editorValueType,o=e._items,u=B.prototype.parse.call(e,t,i);if(o){if(a=o.length,0===s)return u;if(1===s){for(c=0;c<a;c++)if((r=o[c])&&U(r,S)&&r.text===u||r===u)return c}else if(2===s)for(c=0;c<a;c++)if((r=o[c])&&U(r,S)&&r.text===u)return r.value}return u},e.prototype.getHitInfo=function(t,i,n,e,s){var o,r,c,c,c,i;return s&&(o=s.sheetArea,r=s.sheet,h(o)||3===o)&&e&&(c=zt(n.cellPadding),c=parseInt(c[1],10)||0,c=e.x+e.width-c,i={x:t,y:i,row:s.row,col:s.col,cellStyle:n,cellRect:e,sheetArea:o,sheet:r},c-17<=t)&&t<c?(i.isReservedLocation=!0,i):M},e.prototype.processMouseDown=function(t){var i,n,n,i=t.sheet,n=t.sheetArea;(h(n)||3===n)&&t.isReservedLocation&&i&&(t.row===i.ui&&t.col===i.ci||i.setActiveCell(t.row,t.col),i.startEdit(),n=G(i.li))&&(a.Tt.mozilla&&(n.HG=(new Date).valueOf()),n.showDropDownList(),n.LG=!0)},e.prototype.getAutoFitWidth=function(t,i,n,e,s){var o;return n&&n.wordWrap&&(n.wordWrap=!1),D.CellTypes.Context.Bt(t,i,n,e,s)+17},e.prototype.getAutoFitHeight=function(t,i,n,e,s){return n&&n.wordWrap&&(n.wordWrap=!1),D.CellTypes.Context.tn(t,i,n,e,s)},e.prototype.isImeAware=function(t){return!0},e.prototype.lfe=function(t,i){var i=yt.prototype.lfe.call(this,t,i);return t.readonly||this._editable||(i.readonly=!0),i},e.prototype.Ke=function(){},e.prototype.Je=function(t){var t={editorValueType:t.editorValueType&&ut[t.editorValueType],items:t.items,itemHeight:t.itemHeight,maxDropDownItems:t.maxDropDownItems,editable:t.editable};this.fromJSON(t)},e.prototype.toJSON=function(){var e,s,o,e=this,s={typeName:e.typeName};return r(vt,function(t,i){var n;o=e["_"+t],("items"===t?o&&0<o.length:o!==i)&&(s[t]=o)}),s},e.prototype.fromJSON=function(n){var e=this;r(vt,function(t){var i=n[t];h(i)||(e["_"+t]=i)})},bt=e,t.ComboBox=bt,r(vt,function(i){bt.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:(this["_"+i]=t,this)}}),D.CellTypes.ti[7]=bt},"./dist/plugins/celltype/dataobjectcelltype.js":function(t,i,l){var n,e,s,h,o,o,g,u,o,M,I,s,r,a;function f(t){return t&&"object"==typeof t&&!(t instanceof e.CalcError)&&!(t instanceof Date)&&!Array.isArray(t)}function c(t){return f(t)?N(t,""):[]}function N(t,i){for(var n,e,s,o,r,c,u,a,n=[],e,s=0,o=Object.keys(t);s<o.length;s++)r=o[s],u=i?i+"."+r:r,"function"!=typeof(c=t[r])&&(f(c)?(a=N(c,u),n.push({text:r,value:c,path:u,layout:{displayAs:h.LayoutDisplayAs.popup},items:a})):n.push({text:r,value:c,path:u}));return n}function d(t){var i=a.call(this)||this;return i.typeName="18",i.pU=t,i}n=this&&this.__extends||(r=function(t,i){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.DataObject=void 0,e=l("CalcEngine"),s=l("Common"),h=l("Core"),o=l("./dist/plugins/celltype/celltypes.ns.js"),o=new s.Common.ResourceManager(o.SR,"CellTypes"),g=o.getResource.bind(o),u="vc",o=h.CellTypes.Text,M=s.Common.lt.ht,I=void 0,n(d,a=o),d.prototype.Xe=function(t,i,n,e,s){var o=t.Z_(i,n,s,!0);o||((o=new h.Style).cellType=this),t.Ut.do("setStyle",i,n,o,s)},d.prototype.qe=function(u,a,t,i,n){var e,n,e,n=c(u.getValue(a,t,n));0<n.length?(i.formatter=this.pU,i.cellButtons=[{command:"openList",imageType:h.ButtonImageType.custom,imageSrc:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+RGF0YSBvYmplY3QgY2VsbCB0eXBlPC90aXRsZT4KICAgIDxnIGlkPSJEYXRhLW9iamVjdC1jZWxsLXR5cGUiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0xMyw4LjcxNDI4NTcxIEwxMywxMS41NzE0Mjg2IEMxMywxMi4zNjA0OTExIDEwLjk4NTgxNzMsMTMgOC41LDEzIEM2LjAxNDE4MjY5LDEzIDQsMTIuMzYwNDkxMSA0LDExLjU3MTQyODYgTDQsOC43MTQyODU3MSBDNCw5LjUwMzM0ODIxIDYuMDE0MTgyNjksMTAuMTQyODU3MSA4LjUsMTAuMTQyODU3MSBDMTAuOTg1ODE3MywxMC4xNDI4NTcxIDEzLDkuNTAzMzQ4MjEgMTMsOC43MTQyODU3MSBaIE0xMyw1LjE0Mjg1NzE0IEwxMyw4IEMxMyw4Ljc4OTA2MjUgMTAuOTg1ODE3Myw5LjQyODU3MTQzIDguNSw5LjQyODU3MTQzIEM2LjAxNDE4MjY5LDkuNDI4NTcxNDMgNCw4Ljc4OTA2MjUgNCw4IEw0LDUuMTQyODU3MTQgQzQsNS45MzE5MTk2NCA2LjAxNDE4MjY5LDYuNTcxNDI4NTcgOC41LDYuNTcxNDI4NTcgQzEwLjk4NTgxNzMsNi41NzE0Mjg1NyAxMyw1LjkzMTkxOTY0IDEzLDUuMTQyODU3MTQgWiBNOC41LDMgQzEwLjk4NTgxNzMsMyAxMywzLjYzOTUwODkzIDEzLDQuNDI4NTcxNDMgQzEzLDUuMjE3NjMzOTMgMTAuOTg1ODE3Myw1Ljg1NzE0Mjg2IDguNSw1Ljg1NzE0Mjg2IEM2LjAxNDE4MjY5LDUuODU3MTQyODYgNCw1LjIxNzYzMzkzIDQsNC40Mjg1NzE0MyBDNCwzLjYzOTUwODkzIDYuMDE0MTgyNjksMyA4LjUsMyBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjMzY3RkNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+"}],i.dropDowns=[{type:h.DropDownType.list,option:{items:n,dropDownAlignment:0,dropDownDirection:3},submitCommand:function(t,i,n){for(var e,s,o,r,c,e=l("SheetsCalc"),s=n.sheetArea,o=n.col+1;o<t.getColumnCount(s);o++){if(t.isActualProtected()&&t.getCell(n.row,o,s).locked()){t.jT(16,g().DataObject_MeetLock);break}if(t.Ut.findSpan(n.row,o,s)){t.jT(16,g().DataObject_MeetSpan);break}if(3===s&&t.tables&&t.tables.find(n.row,o)||t.pivotTables&&t.pivotTables.findPivotTable(n.row,o)){t.jT(16,g().DataObject_MeetTable);break}if(M(t.getValue(n.row,o,s))){r=e.rangesToFormula([new h.Range(n.row,n.col,1,1)],a,o,15,1===u.parent.options.referenceStyle),c=n.path,t.Qy().execute({cmd:"editCell",sheetName:t.name(),row:n.row,col:o,sheetArea:s,newValue:"="+r+'."'+c+'"',autoFormat:!1});break}}}}]):(i.cellButtons=I,i.dropDowns=I),i.formatter&&h.util.St(i.formatter)&&u.SL(a,t,i.formatter)},d.prototype.paint=function(t,i,n,e,s,o,r,c){this.pU!==r.formatter||this.bU?(this.Xe(c.sheet,c.row,c.col,i,c.sheetArea),this.bU=!1):c.sheet.Ut.W_(c.sheetArea).getValueForKey(c.row,c.col,u)&&(this.Xe(c.sheet,c.row,c.col,i,c.sheetArea),c.sheet.Ut.W_(c.sheetArea).setValueForKey(c.row,c.col,u,I)),a.prototype.paint.call(this,t,i,n,e,s,o,r,c)},d.prototype.toJSON=function(){return{typeName:this.typeName,format:this.pU}},d.prototype.fromJSON=function(t){this.pU=t.format,this.bU=!0},i.DataObject=s=d,h.CellTypes.ti[18]=s},"./dist/plugins/celltype/dropdown-action.js":function(a,t,i){var y,j,C,z,m,T,p,N,x,t,d,L,S,k,e,s,o,O,i,D,Z,G,U,E,B,Q,R,P,Y,n,r,v,c;function H(t,i){return n.createElement(t,i)}function u(A){return{canUndo:!1,execute:function(t,i,n){var e,t,s,o,r,c,u,a,l,h,g,M,I,l,f,N,d,D,v,l,h,t,w,s,b,l,h,e=(0,y._f)(t,i.sheetName);if(!e||t.jg().name()!==i.sheetName)return!1;if(t=i.row,s=i.col,(k(t)||k(s))&&(t=e.getActiveRowIndex(),s=e.getActiveColumnIndex()),o=i.sheetArea,k(o)&&(o=3),t<0||t>=e.getRowCount(o)||s<0||s>=e.getColumnCount(o))return!1;if(e.showCell(t,s,y.VerticalPosition.nearest,y.HorizontalPosition.nearest),u=e.getCellRect(t,s,r=1===o?-1:void 0,c=2===o?-1:void 0),e.parent&&!e.parent.options.scrollByPixel&&!e.isEditing()){if(0<(a=e.frozenColumnCount())&&a<(l=e.getViewportLeftColumn(1))&&(h=e.getSpan(t,s,o))&&h.col<=l&&l<h.col+h.colCount&&0<(g=l-a))for(M=0;M<g;M++)u.width=u.width-e.getColumnWidth(a+M+1,o);if(0<(I=e.frozenRowCount())&&I<(l=e.getViewportTopRow(1))&&(h=e.getSpan(t,s,o))&&h.row<=l&&0<(f=(l<h.row+h.rowCount?l:h.rowCount)-I))for(M=0;M<f;M++)u.height=u.height-e.getRowHeight(I+M+1,o)}switch(N=H("div"),d=V(e,t,s,o),(k(i.row)||k(i.col))&&(i.row=e.getActiveRowIndex(),i.col=e.getActiveColumnIndex()),l=i.row,h=i.col,t=e.Il(l,h,o),w=J(A),(l=(s=t.dropDowns)&&0<s.length)&&(h=s.filter(function(t){return t.type===w})[0])&&(void 0!==h.option&&null!==h.option&&(v=h.option),b=h),A){case Z:D=new p.ColorPicker(N);break;case G:D=v&&v.showDateRange?(d=W(d,"dateRange"),new x.RangeCalendar(N,v)):(d=W(d,"date"),new x.Calendar(N));break;case U:d=W(d,"date"),D=new m.TimePicker(N);break;case E:d=(d=W(d,"number")).toString(),D=new j.Calculator(N);break;case B:d=W(d,"date"),D=new T.MonthPicker(N);break;case Q:(D=new C.List(N)).formula=e.getFormula(i.row,i.col);break;case R:d=v&&v.showNumberRange?W(d,"numberRange"):W(d,"number"),D=new z.Slider(N);break;case P:D=new L.WorkFlow(N),"string"!=typeof d&&d!==O&&(d=d.toString());break;case Y:D=new S.MultiColumn(N,O,e)}return X(D,d,u,e,i,t,l,b,v),!0}}}function V(t,i,n,e){var s,o;return t.isEditing()?(s=t.getCellType(i,n)).getEditorValue(t.li,o={sheet:t,row:i,col:n,sheetArea:e}):t.getValue(i,n,e)}function W(t,i){var i,n;return"date"===i?"string"==typeof t?(t=s.yU(t))===O&&(t=new Date):t instanceof Date||(t=new Date):"dateRange"===i?t&&"object"==typeof t&&(t={start:o(t.start),end:o(t.end)}):"number"===i?"string"==typeof t?t=e.yU(t):"number"!=typeof t&&(t=0):"numberRange"===i&&(n=i=0,t&&"object"==typeof t&&("string"===t.start?i=e.yU(t.start):isNaN(t.start)||(i=t.start),"string"===t.end?n=e.yU(t.end):isNaN(t.end)||(n=t.end)),t={start:i,end:n}),t}function w(t,i,n,e){var s,o,r,c,n,i,c,r,s=n.row,o=n.col;(k(s)||k(o))&&(s=t.getActiveRowIndex(),o=t.getActiveColumnIndex()),r=n.sheetArea,k(r)&&(r=3),i&&i.submitCommand?"string"==typeof i.submitCommand?t.getParent().commandManager().execute({cmd:i.submitCommand,sheetName:t.name(),row:s,col:o,newValue:e.value}):"function"==typeof i.submitCommand&&((c={}).row=n.row,c.col=n.col,c.sheetArea=r,c.path=e.path,i.submitCommand.call(null,t,e.value,c)):(t.getParent().commandManager().execute({cmd:"editCell",sheetName:t.name(),row:s,col:o,newValue:e.text,autoFormat:!e.noAutoFormat,sheetArea:r,isUndo:!1}),t.isEditing()&&t.ci===o&&t.ui===s&&(n=t.getCellType(s,o),i={sheet:t,row:s,col:o,sheetArea:y.SheetArea.viewport},c=t.Il(s,o,r),r=t.getCellRect(s,o),t.li.Li=e.value,n.updateEditor(t.li,c,r,i),n.setEditorValue(t.li,e.text,i)))}function J(t){var i=-1;switch(t){case Z:i=y.DropDownType.colorPicker;break;case G:i=y.DropDownType.dateTimePicker;break;case U:i=y.DropDownType.timePicker;break;case E:i=y.DropDownType.calculator;break;case B:i=y.DropDownType.monthPicker;break;case Q:i=y.DropDownType.list;break;case R:i=y.DropDownType.slider;break;case P:i=y.DropDownType.workflowList;break;case Y:i=y.DropDownType.multiColumn}return i}function b(t,i,n,e,s){var i,i,i=i.cellButtons;t&&i&&0<i.length&&(i=t.Ut.getValueForKey(n,e,r,s))&&i.isMouseDownReservedLocation&&(i.buttonDownIndex=-1,i.isMouseDownReservedLocation=!1,t.repaint(t.getCellRect(n,e)))}function X(i,t,n,e,s,o,r,c,u){var a,l,h,g,M,u,t,u,I,I,t,u,n,f;D.ef(),a=e.parent,l=e.qc(),h=s.row,g=s.col,M=s.sheetArea,u&&(u.row=h,u.col=g),i.setOptions(u),i.setValue(t),u=l.getBoundingClientRect(),t=n.x+u.left,u=n.y+u.top,(I=A(a))&&(t+=I.x,u+=I.y),I=new N.Rectangle(t,u,n.width,n.height),u=(t=i.getOptions())&&!k(t.dropDownAlignment)?t.dropDownAlignment:y.DropDownAlignment.Far,n=t&&!k(t.dropDownDirection)?t.dropDownDirection:void 0,f=new N.PopupControl(i.getContainer(),I,{align:u,hostElement:l,direction:n}),v+=1,r&&i.wU(),f.open(),i.scrollToSelect(),r&&i.refresh(),i.on(d.BaseDropdown.Event_ValueChanged,function(t){t.notCloseDropDown||f.close(),F(s,t)&&w(e,c,s,t)}),a&&(a.CC=a.CC||[],a.CC.push(f)),i.getContainer().addEventListener("contextmenu",function(t){t.stopPropagation(),t.preventDefault()}),f.on("close",function(){b(e,o,h,g,M),i&&i.dispose(),--v,f=null;var t=a.CC.indexOf(f);a.CC.splice(t,1),D.cf()})}function A(t){var i,n,e,s;if(t&&(i=t.options.tabStripVisible)&&0!==(n=t.options.tabStripPosition)){switch(e={x:0,y:0},s=t.w2.kg,n){case 1:e.y=s.height;break;case 2:e.x=s.width}return e}}function F(t,i){return!0!==i.notSubmit&&(3===t.sheetArea||t.cmd!==E||!isNaN(i.value))}Object.defineProperty(t,"__esModule",{value:!0}),t.commands=void 0,y=i("Core"),Object.defineProperty(t,"commands",{enumerable:!0,get:function(){return y.Commands}}),j=i("./dist/plugins/celltype/editor/calculator.js"),C=i("./dist/plugins/celltype/editor/listControl.js"),z=i("./dist/plugins/celltype/editor/slider.js"),m=i("./dist/plugins/celltype/editor/timepicker.js"),T=i("./dist/plugins/celltype/editor/monthPicker.js"),p=i("./dist/plugins/celltype/editor/colorpicker.js"),N=i("./dist/plugins/celltype/editor/popupControl.js"),x=i("./dist/plugins/celltype/editor/calendar.js"),t=i("Common"),d=i("./dist/plugins/celltype/editor/baseControl.js"),L=i("./dist/plugins/celltype/editor/workflowPicker.js"),S=i("./dist/plugins/celltype/editor/multiColumnPicker.js"),k=t.Common.lt.ht,e=t.Common.st,s=t.Common.ct,o=y.mt.Eve,O=null,i=window,D=i.gcGlobal,Z="openColorPicker",G="openDateTimePicker",U="openTimePicker",E="openCalculator",B="openMonthPicker",Q="openList",R="openSlider",P="openWorkflowList",Y="openMultiColumn",n=document,r="_cellButtonParam",y.Commands[Z]=u(Z),y.Commands[G]=u(G),y.Commands[U]=u(U),y.Commands[E]=u(E),y.Commands[B]=u(B),y.Commands[Q]=u(Q),y.Commands[R]=u(R),y.Commands[P]=u(P),y.Commands[Y]=u(Y),v=0,y.Workbook.ch("registerOpendropdownCommand",c={init:function(){this.commandManager().register(Z,y.Commands[Z]),this.commandManager().register(G,y.Commands[G]),this.commandManager().register(U,y.Commands[U]),this.commandManager().register(E,y.Commands[E]),this.commandManager().register(B,y.Commands[B]),this.commandManager().register(Q,y.Commands[Q]),this.commandManager().register(R,y.Commands[R]),this.commandManager().register(P,y.Commands[P]),this.commandManager().register(Y,y.Commands[Y])}}),y.Worksheet.ch("registerOpendropdownCommand",{preProcessMouseWheel:function(t){0<v&&!this.RD&&(t.r=!0)}})},"./dist/plugins/celltype/editor/baseControl.js":function(t,i,n){var e,n,s,o,r,c,u;function a(t){var i=c.call(this)||this;return i.Wc=t,i}function l(t){var i=u.call(this)||this;return i.Ti=t,i}e=this&&this.__extends||(r=function(t,i){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.BaseDropdown=i.BaseControl=void 0,n=n("./dist/plugins/celltype/editor/eventbase.js"),c=n.EventBase,e(a,c),a.prototype.init=function(t,i,n){this.Ti=this.Wc.querySelector("."+i),this.Ti?this.RemoveChilds(this.Ti):(this.Ti=this.CreateElement(t,i,n),this.Wc.appendChild(this.Ti))},a.prototype.GetContainer=function(){return this.Wc},a.prototype.RemoveChilds=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},a.prototype.CreateElement=function(t,i,n,e){var s,o,s=document.createElement(t);if(i&&(s.className=i),n)for(o in n)n[o]&&s.setAttribute(o,n[o]);return e&&e.appendChild(s),s},i.BaseControl=a,u=n.EventBase,e(l,u),l.prototype.getOptions=function(){return this.MU},l.prototype.updateStyle=function(t,i,n){},l.prototype.scrollToSelect=function(){},l.prototype.getContainer=function(){return this.Ti},l.prototype.refresh=function(){},l.prototype.wU=function(){},l.prototype.dispose=function(){},l.Event_ValueChanged="ValueChangedEvent",i.BaseDropdown=l},"./dist/plugins/celltype/editor/baseSpreadPicker.js":function(t,i,n){var e,s,u,n,h,g,M,o,r,I,f,N,c,a,l;function d(t,i,n){var t=l.call(this,t)||this;return t.setOptions(i),t.CU=n,t}function D(t,i,n){var e={sheet:t};h(n)||(e.isEsc=n),t.ki(i,e)}e=this&&this.__extends||(a=function(t,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}a(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.BaseSpreadPicker=void 0,s=n("./dist/plugins/celltype/editor/baseControl.js"),u=n("Core"),n=n("Common"),h=n.Common.lt.ht,g=Math.min,M=Math.max,o=null,r=".baseSpreadNS",I=800,f=400,N=100,l=s.BaseDropdown,e(d,l),d.prototype.setOptions=function(t){var i,t,i,i=this;(i.MU=t)&&(t=i.Ti,(i=document.createElement("div")).setAttribute("class","gc-base-spread-div"),t.appendChild(i),this.SU=i,this.TU=this.AU(i))},d.prototype.setValue=function(t){var i,n,i=this;i.MU&&(n=i.TU,setTimeout(function(){var t;window.gcGlobal.cf(),n&&n.focus(!0)},1e3))},d.prototype.wU=function(){var t,i,n,e,s,n,t=this;t.SU&&(i=t.Ti,(n=t.MU)&&(e=n.width,s=n.height),n=t.IU(e,s),h(e)&&(e=n.width),h(s)&&(s=n.height),(0,u.GC$)(i).width(e).height(s))},d.prototype.refresh=function(){this.TU&&this.TU.refresh()},d.prototype.dispose=function(){var t=this;t.CU&&(t.CU.Zg(),t.CU=o),t.SU&&(t.SU=o),t.TU&&(t.TU.unbind(u.Events.DropdownSpreadMouseClick+r),t.TU.unbind(u.Events.DropdownSpreadKeyboardEnter+r),t.TU.L0(),t.TU=o)},d.prototype.IU=function(t,i){for(var n,e,s,o,r,c,u,a,a,t,t,i,l,n,e=this.TU,s=e.getActiveSheet(),o=s.getColumnCount(),r=0,c=0;c<o;c++)r+=s.getColumnWidth(c,3);return u=r,a=s.getRowCount(3)+s.getRowCount(1),a=s.getRowHeight(0,3)*a,u<I&&h(t)||u<=t?e.options.showHorizontalScrollbar=!1:(t=0,a+=t=e.zb?e.zb.ZC():t),a<f&&h(i)||a<i?e.options.showVerticalScrollbar=!1:(t=0,u+=t=(i=e.Xb)?(l=i.lS(!1))||e.NC():t),{width:g(u,I),height:g(M(a,N),f)}},d.prototype.AU=function(t){var t,i,n,e,t=new u.Workbook(t,{sheetCount:1});return t.xU=!0,(i=t.options).allowUserDragDrop=!1,i.allowUserDragFill=!1,i.allowUserResize=!1,i.allowUserZoom=!1,i.tabStripVisible=!1,i.allowContextMenu=!1,i.allowUserDeselect=!1,i.scrollbarMaxAlign=!0,(n=t.getActiveSheet()).RD=!0,e=this,t.bind(u.Events.DropdownSpreadMouseClick+r,function(t,i){e.submitData(i)}),t.bind(u.Events.DropdownSpreadKeyboardEnter+r,function(t,i){e.submitData(i)}),t},d.prototype.submitData=function(t){},i.BaseSpreadPicker=d,u.GC$.extend(u.Worksheet.prototype,{BD:function(){D(this,u.Events.DropdownSpreadMouseClick)},GD:function(t){D(this,u.Events.DropdownSpreadKeyboardEnter,t)},Lpe:function(t,i,n){var c,e,e,c=this,e=c.Rpe(),e=e&&e[t]&&e[t][i];e&&(c.suspendPaint(),e.forEach(function(t){var i,n,e,s,o,r,s,o,i=t.row,n=t.col,e=t.dataSource,s=t.dependSheetName,o=t.targetSheetName;s===c.name()&&(s=(s=(r=c.getParent()).Gm(o))._gi===u.SheetType.reportSheet&&s.getSheet?s.getSheet():s)&&(o=s.getStyle(i,n))&&o.dropDowns&&o.dropDowns.some(function(t){return t.type===u.DropDownType.multiColumn&&t.option.dataSource===e})&&s.YI(t.row,t.col,null)}),c.resumePaint())},Rpe:function(){var t,i,t=this,i=t.Fpe;return i=i||(t.Fpe=[])}})},"./dist/plugins/celltype/editor/calculator.js":function(t,i,n){var e,o,s,r,c,n,u,a,l,h,g,M,I,f,N,d,D,v,w,b,A,y;function j(t){var t=parseInt(window.getComputedStyle(t)["font-size"].replace("px",""),0);return t=isNaN(t)?0:t}function C(){}function z(){}function m(){}function T(t,i,n,e,s,o,r,c,u,a,l){var h=this;h.Y6=t,h._x=i,h._y=n,h.NU=e,h.kU=s,h.DU=o,h._U=r,h.EU=c,h.jU=u,h.OU=a,h.RU=l,h.BU=N}function p(t){var i,n,e,i=y.call(this,t)||this,n=i;return n.Ti=document.createElement("div"),n.Ti.classList.add("gc-calculator-container"),n.Ti.innerHTML=a,(e=n.Ti.querySelector(".okbtn")).textContent=u().OK,t.appendChild(i.Ti),n.LU(),n.FU(),n.PU(),n.GU(),n.UU("0"),i}e=this&&this.__extends||(A=function(t,i){return(A=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}A(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.Calculator=i.CalculatorErrorInfo=void 0,o=n("./dist/plugins/celltype/editor/baseControl.js"),s=n("./dist/plugins/celltype/celltypes.ns.js"),r=n("Common"),c=n("Core"),n=new r.Common.ResourceManager(s.SR,"CellTypes"),u=n.getResource.bind(n),a='\n<div class="gc-calculator">\n    <header class="gc-top-part">\n        <div class="gc-screen">\n            <div class="gc-main-screen">\n                <input class="gc-main" value="" type="text" disabled readonly="readonly"></div>\n        </div>\n    </header>\n    <section class="gc-bottom-part">\n        <div class="gc-features">\n            <div class="gc-sub-menu">\n                <div class="gc-row">\n                    <div class="percentage button image icon-group1" data-value="%" role="button">\n                        <img class="icon icons8-Percentage" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABK0lEQVRYR+2WYQ3CMBCFvznAAgrAAeAAHOAACYADHCABJIACcAA4wAHkkpYM6K7XZs3+rAnZYNf169u7Nyo6HlXH69MD9ArEFJgDK2AKnICtO2re3bk5D2AMPLViDUAWPwQmzxQIWfDi5iyAY6zLNIArMHK73gDyWQNnp0jo3qLSJFLzNU8DeLnKek3oN3/DJbB3X4bAPbZ7ud4WwAC4AXIUn4haptEWQJLx6mRtACQbzwrgTShyellDJkw2nhXA0oZZxrMCSJ0EkCjgW0vOZccyso2XApCTeEnpGYviJoAm41kemzmItN03GS85PXMU0IyXmp7J/4hixisOEEu8ogCWxCsKYEk8a3p+DG41oTXxirRhzHi/7aql519rWxUwvdtzinqAXoHOFXgD+J9gIZOwvCMAAAAASUVORK5CYII="></div>\n                    <div class="sqrt button image icon-group1" data-value="sqrt" role="button">\n                        <img class="icon icons8-Square-Root" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABP0lEQVRYR+3V4S0FQRQF4O9VgApQATrQASpABXSAClABOqCCRwWoABWgAnKTnWSzeV5mdkf2z55fm83sPWfPuXfuzMiYjcxvEjA5UNuBd6z/0dgLuWoK2MV8yVT9u4BbHOIC57njXcuBVXw2pJuIKLJQS8ARbvCA/Szm5lAtAS/YwjEiimzUELCNZ3wjoihCDQFXOME1TovYqbILvrCCHUQURRjqQGq+V0QUxVgm4KdVLcYqxquLe+z1ab5UKFdAnO92+AbemkJriCiKkRNBsrnrQjTcJe4QZ3ohR0AUTkum7UJ6d4CIohdyBXRdSIvnAxFFb+QKaLsQfxzXbfHiWaSyREBy4bEZubj1ihbPUAFBGLnHpRN4QkQxCCUOBFHs+bOGsXjxDHUgvk8upOdBfx8flzowmLBbYBIwOTC6A7+1/zEhMa617wAAAABJRU5ErkJggg=="></div>\n                    <div class="sqr button icon-group1" data-value="pow" role="button">\n                        <span class="x-sign">\n                            <sub>x</sub></span>\n                        <span>\n                            <sup>2</sup></span>\n                    </div>\n                    <div class="fraction button icon-group1" data-value="1/x" role="button">\n                        <span>\n                            <sup>1</sup></span>\n                        <span>&frasl;</span>\n                        <span class="x-sign">\n                            <sub>\n                                <em>x</em></sub>\n                        </span>\n                    </div>\n                </div>\n            </div>\n            <div class="gc-main-menu">\n                <div class="gc-row">\n                    <div class="clear-entry button icon-group1" data-value="CE" role="button">CE</div>\n                    <div class="clear button icon-group1" data-value="C" role="button">C</div>\n                    <div class="clear-element button image icon-group1" data-value="BS" role="button">BS</div>\n                    <div class="divide button image operation icon-group1" data-value="/" role="button">\n                        <img class="icon icons8-Divide" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAo0lEQVRYR+2VSxGDMBRFTxTUAkioklrAQSVAHSChjmqhdYCDMm8mCz7DIp/yurisQ+6Zk5u8gPMXnPMRgAyUGBiBWyzxE3jkFDoXwMLvm0ADGFIhcgEm4AJcY+ALeAOtJ8AHaM4CMNW95xFYtkF0ixImn7/9m9uBVNOH6wVwZOBbzfF6o13e3wL8SMB+W5WwxICmoaahpmGVx6rkGgpABqoYmAH2Lh4hfK3KfwAAAABJRU5ErkJggg=="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="7">7</div>\n                    <div class="button number icon-group2" role="button" data-value="8">8</div>\n                    <div class="button number icon-group2" role="button" data-value="9">9</div>\n                    <div class="multiply button image operation icon-group1" data-value="*" role="button">\n                        <img class="icon icons8-Multiply" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABBUlEQVRYR+2W6w3CMAyErxuwCYwAG7AJjAATMQKMUDZhBHQSQaFqYp8DqpDSn2nj+3J+NAMWfoaF9dEBugN/4cAewA3AQ+yYFYADgHNtn+UAxS8ARgA7AYLiVwCbF8CpBGEBMBBPvxYgcvE7gG0N3AIguAIhiTO4B8ALIYsrABZESFwFKEFwPRWcmfNpMXpTkO+b1gTfsdpl8YgDCSSH4FpIvBUg2c446px4OxpNQZ5zBlPmxEcZqABz1c6A6rAKOVBrNWVYhRzw9HkIwpMCj/hcd7gK0wJQxEMQFkD6Hat9nqeD94Hw75inarmQHGviLYNIvByVP7dS8DWh6I2oA3QHfu7AEzfHWCF+OOmJAAAAAElFTkSuQmCC"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="4">4</div>\n                    <div class="button number icon-group2" role="button" data-value="5">5</div>\n                    <div class="button number icon-group2" role="button" data-value="6">6</div>\n                    <div class="minus button image operation icon-group1" data-value="-" role="button">\n                        <img class="icon icons8-Minus-Math-" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAARElEQVRYR+3V0Q0AMAQFQPYfuh1A+ql8nAF4LhIZw5XD80MAAgQIECCwVuA0fcmy8EtgPEATQG279gYIECBAgACBbwIXi38CITaYSB4AAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="1">1</div>\n                    <div class="button number icon-group2" role="button" data-value="2">2</div>\n                    <div class="button number icon-group2" role="button" data-value="3">3</div>\n                    <div class="plus button image operation icon-group1" data-value="+" role="button">\n                        <img class="icon icons8-Plus-Math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAWUlEQVRYR+2WMQoAIAgA9f+PrsWmEMQSEa7Z8rzEUmle2pxfABhvYFkPpQtJb7TEAGAAAxgoM3AO/v1YXoPPm4TtANHKy64AAAxgAANjDERB3bjXXzEA8w1s3k4WIU0YaEoAAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="plus-minus button image icon-group1" data-value="+/-" role="button">\n                        <img class="icon icons8-Plus-Minus" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAYUlEQVRYR+2VMQ4AIAgD4f+P1gUdCakx1VB3pL0UcCM/J/c3CfiewIgMwUbgwmgsASLQg8ByiW7tdNIqY0gXkDnvkQEREIGnCaDLaddVFtFxk+wDCagQoN8CugCFUASuEpjXIBIhP3OSdgAAAABJRU5ErkJggg=="></div>\n                    <div class="button number icon-group2" role="button" data-value="0">0</div>\n                    <div class="dot button icon-group1" data-value="." role="button">.</div>\n                    <div class="equal button image operation icon-group1" data-value="=" role="button">\n                        <img class="icon icons8-Equal-Sign" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAQ0lEQVRYR+3U0Q0AMAQFQPYfuh1A+ikkPQMgF0/GcOXw/LAAAQIECLwETtOLLvPWLtAEUNs6wrUCUiAFBAgQIPCPwAX8vwQhcNJI5wAAAABJRU5ErkJggg==" width="32" height="32"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button okbtn icon-group1" role="button">OK</div>\n                </div>\n            </div>\n        </div>\n    </section>\n</div>\n',l=Math.floor,h=Math.abs,g=Math.pow,M=Math.round,I=Math.sqrt,f=Math.max,N=new Array("0","1","2","3","4","5","6","7","8","9","+/-",".","+","-","*","/","SQRT","%","1/x","=","MC","MR","MS","M+","BS","CE","C","POW"),C.Init=function(){var t;C.GetBrowserType(),C.IsIE=void 0!==C.ie||void 0!==C.edge},C.GetBrowserType=function(){try{var t=navigator.userAgent.toLowerCase();window.ActiveXObject?C.ie=t.match(/msie ([\d.]+)/)[1]:-1!==t.indexOf("edge")?C.edge=t.match(/edge\/([\d.]+)/)[1]:-1!==t.indexOf("firefox")&&(C.firefox=t.match(/firefox\/([\d.]+)/)[1]),-1!==t.indexOf("rv:")&&-1===t.indexOf("firefox")&&(C.ie=t.match(/rv:([\d.]+)/)[1])}catch(t){}},(d=C).Init(),z.IsErrorText=function(t){return t===u().Calculator_DivideByZeroInfo||t===u().Calculator_InvalidInputInfo||t===u().Calculator_SqrtParameterException||t===u().Calculator_OverFlowInfo},D=z,i.CalculatorErrorInfo=D,m.IsDotContained=function(t){var i;return-1!==(t+"").indexOf(".")},m.GetDotPosition=function(t){var i,n,e,i=t+"",n=0,e=0;for(e=i.length;0<e;e--){if("."===i.substring(e-1,e))return n;n++}return 0===e?0:n},m.FormatOutput=function(t){var i,n,e;if(null==t)return null;if(n=0,e=(i=t+"").length,m.IsDotContained(i))for(;"0"===i.substring(e-1,e)&&""!==i&&-1===i.indexOf("e");)i=i.substring(0,e-1),e--;return i},m.FormatResult=function(t){var i,n,t,e,s,o,s,i=(t=isNaN(t)?0:t)+"",n="";return t<0&&(n="-",i=i.substring(1,i.length)),t=i.length,e="",-1!==(s=i.indexOf("e"))&&(e=i.substring(s,t),t=(i=i.substring(0,s)).length),m.IsDotContained(i)&&16<t&&(o=0,i=1<parseFloat(i)?(o=m.GetDotPosition(i)-(t-16),i.toString().substring(0,17)):(o=m.GetDotPosition(i)-(t-17),i.toString().substring(0,18)),i=(0<o?M(parseFloat(i)*g(10,o))/g(10,o):M(parseFloat(i))).toString()),t=i.length,!m.IsDotContained(i)&&15<t&&(o=t-15,i=(M(parseFloat(i)/g(10,o))*g(10,o)).toString()),i=n+i+e,s=parseFloat(i),m.IsOverFlow(s.toString())?u().Calculator_OverFlowInfo:s},m.SingleMathOperation=function(t,i){var t,i,t=parseFloat(t);if(isNaN(t)&&(t=0),"SQRT"===i){if(t<0)return u().Calculator_InvalidInputInfo;t=I(t)}if("POW"===i&&(t=g(t,2)),"1/x"===i){if(0===t)return u().Calculator_DivideByZeroInfo;i=m.GetDotPosition(t.toString()),t=g(10,i)/(g(10,i)*t)}return m.FormatResult(t)},m.DoubleMathOperation=function(t,i,n){var t,i,e,s,o,r,t=parseFloat(t),i=parseFloat(i);if(m.IsDotContained(t.toString())||m.IsDotContained(i.toString())){if(o=s=0,m.IsDotContained(t.toString())&&(s=m.GetDotPosition(t.toString())),m.IsDotContained(i.toString())&&(o=m.GetDotPosition(i.toString())),r=f(s,o),"+"===n&&(e=((t*=g(10,r))+(i*=g(10,r)))/g(10,r)),"-"===n&&(e=((t*=g(10,r))-(i*=g(10,r)))/g(10,r)),"*"===n&&(e=(t*=g(10,s))*(i*=g(10,o))/g(10,s+o)),"/"===n){if(t*=g(10,r),0===(i*=g(10,r)))return u().Calculator_DivideByZeroInfo;e=t/i}"%"===n&&(e=(t*=g(10,s))*(i*=g(10,o))/g(10,s+o+2))}else{if("+"===n&&(e=t+i),"-"===n&&(e=t-i),"*"===n&&(e=t*i),"/"===n){if(0===i)return u().Calculator_DivideByZeroInfo;e=t/i}"%"===n&&(e=t*i/100)}return m.FormatResult(e)},m.IsOverFlow=function(t){var t=parseFloat(t);if(0!==t){if(79e27<t)return!0;if(t<1e-28&&-1e-28<t)return!0;if(t<-79e27)return!0}return!1},v=m,T.prototype.HU=function(){var t=this;t.Y6="",t._x=null,t._y=null,t.NU=null,t.kU=0,t.EU=!1,t.jU=!1},T.prototype.Click=function(t){var i,t,i=this;return 0<=t&&t<=11&&(i.OU&&(i.zU(t),i.OU=!1),i.VU(t),10!==t)&&(i.RU="ClickNumericButton"),(12<=t&&t<=19||27===t)&&(i.OU?(i.zU(t),i.OU=!1):(i.YU(t),i.RU="ClickMathButton")),24===t&&(i.OU&&(i.zU(t),i.OU=!1),i.ZU()),25!==t&&26!==t||(i.zU(t),i.OU=!1),i.OU?null:((t={}).outputText=i.WU(),D.IsErrorText(i.Y6)&&(i.OU=!0),t.result=void 0===i.Y6||null===i.Y6?"":i.Y6,t.x=i._x,t.y=i._y,t.operation=i.NU,t.token=i.kU,t.count=i.DU,t.memoryNumber=i._U,t.isBSCanUse=i.EU,t.isEqualClicked=i.jU,t.isOperationInvalid=i.OU,t.lastOperation=i.RU,t)},T.prototype.VU=function(t){var i=this;if(null!==i.Y6&&void 0!==i.Y6||(i.Y6=""),!(14<i.DU&&10!==t))switch(11!==t&&10!==t&&(0!==t||i.Y6+""!="0"&&""!==i.Y6)&&i.DU++,10!==t&&(i.EU=!0),i.kU){case 0:0<=t&&t<=9&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0"),"0"===i.Y6&&0!==t?i.Y6=""+t:"0"!==i.Y6&&(i.Y6=i.Y6+""+t)),10===t&&(-1===i.Y6.toString().indexOf("e")?""!==i.Y6&&"0"!==i.Y6&&(-1===i.Y6.toString().indexOf("-")?i.Y6="-"+i.Y6:i.Y6=i.Y6.toString().substring(1,i.Y6.toString().length)):0<+i.Y6?i.Y6="-"+i.Y6:i.Y6=i.Y6.substring(1,i.Y6.length)),11===t&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0."),""===i.Y6||v.IsDotContained(i.Y6)?""!==i.Y6&&v.IsDotContained(i.Y6)||(i.Y6="0."):i.Y6=i.Y6+"."),i.kU=1;break;case 1:0<=t&&t<=9&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0"),"0"===i.Y6&&0===t||("0"===i.Y6&&0!==t?i.Y6=""+t:i.Y6=i.Y6+""+t)),10===t&&(-1===i.Y6.toString().indexOf("e")?""!==i.Y6&&"0"!==i.Y6&&(-1===i.Y6.toString().indexOf("-")?i.Y6="-"+i.Y6:i.Y6=i.Y6.toString().substring(1,i.Y6.toString().length)):0<+i.Y6?i.Y6="-"+i.Y6:i.Y6=i.Y6.substring(1,i.Y6.length)),11===t&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU?i.Y6="0.":v.IsDotContained(i.Y6)||(""===i.Y6?i.Y6="0.":i.Y6=i.Y6+".")),i.jU||(i._y=i.Y6);break;case 2:0<=t&&t<=9&&(i.Y6="",i.Y6=i.Y6+t),11===t&&(i.Y6="0."),10===t&&(i.Y6="0"),i.kU=3,i._y=i.Y6;break;case 3:0<=t&&t<=9&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0"),"0"===i.Y6&&0===t||("0"===i.Y6&&0!==t?i.Y6=""+t:i.Y6=i.Y6+""+t)),10===t&&(-1===i.Y6.toString().indexOf("e")?""!==i.Y6&&"0"!==i.Y6&&(-1===i.Y6.toString().indexOf("-")?i.Y6="-"+i.Y6:i.Y6=i.Y6.toString().substring(1,i.Y6.toString().length)):0<+i.Y6?i.Y6="-"+i.Y6:i.Y6=i.Y6.substring(1,i.Y6.length)),11===t&&("ClickNumericButton"!==i.RU&&null!==i.RU?i.Y6="0.":v.IsDotContained(i.Y6)||(""===i.Y6?i.Y6="0.":i.Y6=i.Y6+".")),i._y=i.Y6}},T.prototype.YU=function(t){var i=this;switch(i.DU=0,i.EU=!1,i.jU&&(i.jU=!1),i.Y6=v.FormatOutput(i.Y6),i.kU){case 0:""===i.Y6&&(i.Y6=0),(16<=t&&t<=18&&17!==t||27===t)&&(i.Y6=v.SingleMathOperation(i.Y6,i.BU[t]).toString(),D.IsErrorText(i.Y6)||(i._x=i.Y6),i.kU=1),12<=t&&t<=15&&(i.NU=t,i._x=i.Y6,i.kU=2),17===t&&i.HU();break;case 1:(16<=t&&t<=18&&17!==t||27===t)&&(i.Y6=v.SingleMathOperation(i.Y6,i.BU[t]).toString(),D.IsErrorText(i.Y6)||(null!==i.NU&&void 0!==i.NU&&null!==i._y&&void 0!==i._y?i._y=i.Y6:i._x=i.Y6)),19===t&&(null!==i.NU&&void 0!==i.NU&&null!==i._y&&void 0!==i._y?(i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[i.NU]).toString(),D.IsErrorText(i.Y6)||(i._x=i.Y6)):"-0."===i.Y6&&(i.Y6="0."),i.jU=!0,i.EU=!1),12<=t&&t<=15&&(i.NU=t,i._x=i.Y6,i.kU=2),17===t&&(null!==i.NU&&void 0!==i.NU?(i._y=i.Y6,i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[17]).toString(),i._y=i.Y6):i.HU());break;case 2:(16<=t&&t<=18&&17!==t||27===t)&&(i.Y6=v.SingleMathOperation(i.Y6,i.BU[t]).toString(),D.IsErrorText(i.Y6)||(i.kU=3,i._y=i.Y6)),19===t&&(i._y=i._x,i.Y6=v.DoubleMathOperation(i._x.toString(),i._x.toString(),i.BU[i.NU]).toString(),D.IsErrorText(i.Y6)||(i._x=i.Y6,i.kU=1,i.EU=!1),i.jU=!0),12<=t&&t<=15&&(i.NU=t,i._y=i.Y6),17===t&&(i.Y6=v.DoubleMathOperation(i._x.toString(),i._x.toString(),i.BU[17]),D.IsErrorText(i.Y6)||(i._y=i.Y6,i.kU=3));break;case 3:16<=t&&t<=18&&17!==t&&(i.Y6=v.SingleMathOperation(i.Y6,i.BU[t]).toString(),D.IsErrorText(i.Y6)||(i._y=i.Y6)),12<=t&&t<=15&&(i._y=i.Y6,i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[i.NU]).toString(),D.IsErrorText(i.Y6)||(i._x=i.Y6,i._y=null,i.NU=t,i.kU=2)),17===t&&(i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[17]),D.IsErrorText(i.Y6)||(i._y=i.Y6)),19===t&&(i._y=i.Y6,i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[i.NU]).toString(),D.IsErrorText(i.Y6)||(i._x=i.Y6,i.kU=1,i.EU=!1),i.jU=!0)}i.Y6+=""},T.prototype.ZU=function(){var t,i,n,t=this;if(0<t.DU&&t.DU--,(0===t.kU||1===t.kU||3===t.kU)&&!0===t.EU)switch(t.Y6+="",(i=0)<(n=t.Y6.length)&&(t.Y6=t.Y6.substring(0,n-1)),"-0"===t.Y6&&(t.Y6="0"),"-"===t.Y6&&(t.Y6=""),""===t.Y6&&(t.EU=!1),t.kU){case 0:case 1:t._x=t.Y6;break;case 3:t._y=t.Y6}},T.prototype.zU=function(t){var i=this;i.DU=0,i.EU=!1,i.Y6="",25===t&&(1!==i.kU||null===i.NU||void 0===i.NU||i.jU||(i._y=0),2===i.kU)&&(i.kU=3),26===t&&i.HU()},T.prototype.WU=function(){var t,i,t=this,i="";return i=""===t.Y6||null===t.Y6||void 0===t.Y6?"0":t.Y6},T.prototype.mf=function(t){var i=t.keyCode;switch(t.shiftKey&&(i|=65536),t.ctrlKey&&(i|=131072),t.altKey&&(i|=262144),i){case 131138:case 131140:case 131141:case 131144:case 131145:case 131148:case 131150:case 131154:case 131159:case 131188:case 262181:case 262183:case 117:case 65657:case 131081:case 196617:case 9:case 65545:case 121:case 123:return null;case 48:case 96:return 0;case 49:case 97:return 1;case 50:case 98:return 2;case 51:case 99:return 3;case 52:case 100:return 4;case 53:case 101:return 5;case 54:case 102:return 6;case 55:case 103:return 7;case 56:case 104:return 8;case 57:case 105:return 9;case 120:return 10;case 190:case 188:case 110:return 11;case 65723:case 107:return 12;case 65643:if(d.IsIE)break;return 12;case 189:case 109:return 13;case 65592:case 106:case 65722:return 14;case 191:case 111:return 15;case 65586:case 192:return 16;case 65589:return 17;case 82:return 18;case 13:return 19;case 393292:return 20;case 393298:return 21;case 393293:return 22;case 393296:return 23;case 8:return 24;case 46:return 25;case 27:case 131118:return 26;default:return 61===i&&d.firefox||187===i&&!d.firefox?19:-1}},w=T,y=o.BaseDropdown,e(p,y),p.prototype.setValue=function(t){var i,t,i=this;t=i.QU(t);try{if(!i.q8(t))throw new Error(u().Calculator_InvalidInputInfo);t=""===t?"0":t,i.Y6=i.KU(t),i._text=i.JU(t),i._x=parseFloat(i.Y6),i._y=null,i.NU=null,i.kU=0,i.DU=i.XU(parseFloat(i.Y6)),0<i.DU?i.EU=!0:i.EU=!1,i.jU=!1,i.OU=!1,i.RU=null}catch(t){i._text=u().Calculator_InvalidInputInfo,i.Y6="",i._x=null,i._y=null,i.OU=!0}return i.qU(i.OU),i.UU(i._text),(t={}).outputText=i._text,t.result=i.Y6,t.x=i._x,t.y=i._y,t.operation=i.NU,t.token=i.kU,t.count=i.DU,t.memoryNumber=i._U,t.isBSCanUse=i.EU,t.isEqualClicked=i.jU,t.isOperationInvalid=i.OU,t.lastOperation=i.RU,i.$U=new w(i.Y6,i._x,i._y,i.NU,i.kU,i.DU,i._U,i.EU,i.jU,i.OU,i.RU),i},p.prototype.setOptions=function(){},p.prototype.scrollToSelect=function(){var t=this.Ti.querySelector(".gc-main-screen .gc-main");this.tH(t)},p.prototype.LU=function(){var t=this;t.nH="0",t._text=t.nH,t.Y6="",t._x=0,t._y=0,t.NU=null,t.kU=0,t.DU=0,t._U=null,t.EU=!1,t.jU=!1,t.OU=!1,t.RU=null},p.prototype.FU=function(){var t=this;t.$U=new w(this.Y6,t._x,t._y,t.NU,t.kU,t.DU,t._U,t.EU,t.jU,t.OU,t.RU)},p.prototype.PU=function(){var t=this;t.qU(t.OU)},p.prototype.GU=function(){var n,e,s,t,i,n=this,e=this,s=e.Ti,t,i=function(t){!0!==e.mf(t)&&(t.preventDefault(),t.stopPropagation())};s.addEventListener("click",function(t){for(var i,t,t,i=t.srcElement||t.target;i&&!i.classList.contains("button");)i=i.parentElement;i&&(i.getAttribute("data-value")?(t=i.getAttribute("data-value"),t=p.eH(t),s.focus(),-1!==t&&e.iH(t)):i.classList.contains("okbtn")&&("ClickNumericButton"===e.RU&&e.iH(19),n.fire(o.BaseDropdown.Event_ValueChanged,{value:e._text,text:e._text})))}),s.addEventListener("keydown",i),s.addEventListener("contextmenu",function(t){t.preventDefault(),t.stopPropagation()})},p.prototype.UU=function(t){var i,n,i=this.Ti.querySelector(".gc-main-screen .gc-main"),n=i.value;null!=n&&n.toString().replace(/\r\n/g,"\n")!==t.toString().replace(/\r\n/g,"\n")&&(i.value=t,this.tH(i))},p.prototype.tH=function(t){var i=this;if(null!==i.rH&&void 0!==i.rH||(i.rH=j(t)),i.oH(t))for(;i.oH(t);)i.aH(t);else i.uH(t)},p.prototype.oH=function(t){var i,n,e,i,s,o;return 1<t.scrollWidth-t.clientWidth||!(!c.mt.Tt.edge&&!c.mt.Tt.msie||t.clientWidth<=0)&&(n=(i=window.getComputedStyle(t)).fontWeight,e=i.fontSize,i=i.fontFamily,(o=c.q.Wt(t.value,s=n+" "+e+" "+i))+40>t.clientWidth)},p.prototype.aH=function(t){var i=j(t);t.style.fontSize="".concat(i-1,"px")},p.prototype.uH=function(t){for(var i,n,i=this,n=j(t);!i.oH(t)&&n<i.rH;)if(t.style.fontSize="".concat(++n,"px"),i.oH(t)){for(;i.oH(t);)i.aH(t);break}},p.prototype.QU=function(t){if(void 0!==t&&("string"==typeof t||t instanceof String))return(t=null==t?"":t).toString();throw new Error(t+" type is not a string.")},p.prototype.sH=function(t,i){var n,e,s,o;if(0===i.length)return"";for(n="",s=e=0;e<i.length;e++){for(o=!1,s=0;s<t.length;s++)i.substring(e,e+1)===t.substring(s,s+1)&&(o=!0);!0===o&&(n+=i.substring(e,e+1))}return n},p.prototype.q8=function(t){var i;return this.sH("-.0123456789",t)===t&&(-1===(i=t.indexOf("-"))||0===i)&&t.indexOf("-")===t.lastIndexOf("-")&&t.indexOf(".")===t.lastIndexOf(".")},p.prototype.KU=function(t){var t,i,t,n,e,s,o,t=parseFloat(t),i=t<0?!0:!1,t=h(t),n=l(t),e=v.GetDotPosition(t.toString()),s=(t*g(10,e)-n*g(10,e))/g(10,e);if(999999999999999<n)throw new Error(u().Calculator_InvalidInputInfo);return 999999999999999!==n?(o=0===n?15:15-n.toString().length,s=M(s*g(10,o))/g(10,o),e=v.GetDotPosition(s.toString()),t=(n*g(10,e)+s*g(10,e))/g(10,e),n=l(t),e=v.GetDotPosition(t.toString()),0===(s=(t*g(10,e)-n*g(10,e))/g(10,e))&&(t=n),i?"-"+t:""+t):0===s?n:void 0},p.prototype.JU=function(t){var t=t.toString();return t=""===t?"0":t},p.prototype.XU=function(t){var t,i,n,t,e,s,t=h(t),i=l(t),n=v.GetDotPosition(t.toString()),t=(t*g(10,n)-i*g(10,n))/g(10,n),e,s;return(0===i?0:i.toString().length)+(0==t?0:n)},p.prototype.qU=function(t){for(var i=10;i<=18;i++)this.cH(i,t);this.cH(27,t)},p.prototype.cH=function(t,i){var t,t,t=N[t],t=this.Ti.querySelector('[data-value="'+t.toLowerCase()+'"]');t&&(i?t.classList.add("disabled"):t.classList.remove("disabled"))},p.eH=function(t){var i=-1;switch(t){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":i=parseInt(t,10);break;case"+/-":i=10;break;case".":i=11;break;case"+":i=12;break;case"-":i=13;break;case"*":i=14;break;case"/":i=15;break;case"sqrt":i=16;break;case"%":i=17;break;case"1/x":i=18;break;case"=":i=19;break;case"MC":i=20;break;case"MR":i=21;break;case"MS":i=22;break;case"M+":i=23;break;case"BS":i=24;break;case"CE":i=25;break;case"C":i=26;break;case"pow":i=27;break;default:i=-1}return i},p.prototype.iH=function(t){var i,t,i=this,t=i.$U.Click(t);null!=t&&(null!==t.result&&void 0!==t.result&&(i.Y6=t.result),null!==t.outputText&&void 0!==t.outputText&&(i.nH=t.outputText,i._text=i.nH,i.UU(i.nH)),null!==t.isOperationInvalid&&void 0!==t.isOperationInvalid&&t.isOperationInvalid!==i.OU&&(i.OU=t.isOperationInvalid,i.qU(i.OU)),t.memoryNumber!==i._U&&(i._U=t.memoryNumber),t.lastOperation!==i.RU)&&(i.RU=t.lastOperation)},p.prototype.mf=function(t){var t=this.$U.mf(t);return null==t||-1!==t&&void this.iH(t)},i.Calculator=p},"./dist/plugins/celltype/editor/calendar.js":function(G,t,i){var n,U,E,o,e,r,c,i,f,e,u,B,a,Q,R,P,Y,H,W,V,J,X,F,l,N,_,K,q,$,tt,it,nt,et,st,d,D,h,g,ot,M,I,rt,s,ct,ut,v,w,at,b,A,y,lt,ht,gt,Mt,It,ft,Nt,dt,Dt,vt,wt,bt,At,j,yt,C,jt,Ct,zt,mt,z,Tt,m,T,pt,xt,Lt,St,p,kt,Ot,Zt,Gt,Ut,Et,Bt,Qt,i,Rt,Pt,Yt;function x(t){return B.createElement(t)}function Ht(){}function Wt(){this.yearTds=[]}function Vt(){this.monthTds=[]}function Jt(){this.weekThs=[],this.dayTds=[]}function Xt(){this.calendarYearSection=new pt,this.calendarMonthSection=new xt,this.calendarDaySection=new Lt,this.timeItemLIs=[]}function L(){}function Ft(t,i,n,e){this.year=t,this.selected=!!i,this.disabled=!!n,this.focused=!!e}function _t(t,i,n,e){this.month=t,this.selected=!!i,this.disabled=!!n,this.focused=!!e}function Kt(t,i,n,e){this.date=t,this.selected=!!i,this.disabled=!!n,this.focused=!!e}function S(t){this.owner=t,this.calendarPage=c.CalendarPage.month,this.oldSelectedData=null,this.S1e=null,this.T1e={start:p.getDefaultDate(),end:p.getDefaultDate()},this.selectedDate=new Date,this.updateDayFocusDate(),this.focusDateTimeIndex=-1,T.initResource()}function k(t){var i=Rt.call(this)||this;return i.fH=40,i.lH=100,i.hH=!1,i.jS=t,i}function O(t,i,n,e){var s=Pt.call(this,t)||this;return s.dH=7,s.HG=!0,n&&(s.parent=n,s.A1e=!0,s.HG=!1,s.N1e=e),s._data=new Gt(s),s.Dn=new Ut(s),s.Dn.on(o.BaseDropdown.Event_ValueChanged,function(t){var i,i,i=r.Common.CultureManager.getCultureInfo().DateTimeFormat,i=new r.Formatter.GeneralFormatter(i.defaultDatePattern).format(t.newValue);s.fire(o.BaseDropdown.Event_ValueChanged,{text:i,value:t.newValue})}),s.Dn.on(Ut.Event_GetHost,function(t){t.host=s.Ti}),s.A1e||(s.Ti.innerHTML=""),s.Ti.appendChild(s.Dn.createCalendarDom()),s.Dn.attachEvent(),s.A1e||s.setValue(new Date),s.Dn.showCalendarPage(c.CalendarPage.day),s.Dn.setCalendarActivePart(m.Date),i&&s.setOptions(i),s}function Z(t,i){var t=Yt.call(this,t)||this;return t.D1e=0,t.S1e=null,t.T1e={start:p.getDefaultDate(),end:p.getDefaultDate()},t._1e(i),t.aY(),t}n=this&&this.__extends||(Qt=function(t,i){return(Qt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}Qt(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.RangeCalendar=t.Calendar=void 0,U=i("./dist/plugins/celltype/editor/eventbase.js"),E=i("./dist/plugins/celltype/editor/timepicker.js"),o=i("./dist/plugins/celltype/editor/baseControl.js"),e=i("./dist/plugins/celltype/celltypes.ns.js"),r=i("Common"),c=i("Core"),i=new r.Common.ResourceManager(e.SR,"CellTypes"),f=i.getResource.bind(i),e=r.Common.lt,u=e.ht,B=document,a="gc-calendar-container",Q="gc-date-ranges-calendar",R="gc-range-calendar-container",P="gc-date-range-container",Y="gc-date-time-container",H="gc-date-part-container",W="gc-time-part-container",V="gc-ok-button-container",J="gc-date-container",X="gc-week-container",F="gc-today-container",l="gc-content-container",N="gc-header-container",_="gc-header-title",K="gc-content-td-date",q="gc-content-td-time",$="gc-date-time-vertical-partline",tt="gc-date-time-horizontal-partline",it="gc-year-page",nt="gc-year-select-div",et="gc-month-page",st="gc-day-page",d="gc-left-arrow",D="gc-right-arrow",h="gc-arrow-disable",g="gc-is-focused",ot="gc-cl-select",M="gc-cl-is-selected",I="gc-cl-disabled-text",rt="gc-cl-select-container",s="gc-focus-part-indicator",ct="gc-cl-datepicker",ut="gc-cl-dropdown",v="gc-cl-datepicker-filter",w="gc-cl-datepicker-filter-month",at="gc-cl-grid-align-spread",b="gc-cl-align-middle",A="gc-cl-button-icon-container",y="gc-cl-datepicker-month",lt="gc-cl-day",ht="gc-cl-week",gt="gc-cl-show-inline-block",Mt="gc-builtIn-date-Range-child-div",It="gc-builtIn-date-ranges-div",ft="gc-date-ranges-result-div",Nt="gc-date-ranges-result-button",dt="gc-builtIn-date-range-childDiv-select",Dt="gc-date-ranges-result-buttonDiv",vt="gc-date-ranges-result-input",wt="gc-cl-p-bottom-x-small",bt="gc-cl-shrink-none",At="gc-cl-grow",j="gc-cl-grid",yt="gc-uiButton",C="gc-cl-button",jt="gc-cl-button-brand",Ct="year-index",zt="month-index",mt="week-index",z="day-index",Tt="dateRange-index",(i=m=m||{})[i.Date=1]="Date",i[i.Time=2]="Time",Ht.initResource=function(){Ht.resource={shortWeeks:[f().Calendar_ShortWeeks_1,f().Calendar_ShortWeeks_2,f().Calendar_ShortWeeks_3,f().Calendar_ShortWeeks_4,f().Calendar_ShortWeeks_5,f().Calendar_ShortWeeks_6,f().Calendar_ShortWeeks_7],shortMonths:[f().Calendar_ShortMonths_1,f().Calendar_ShortMonths_2,f().Calendar_ShortMonths_3,f().Calendar_ShortMonths_4,f().Calendar_ShortMonths_5,f().Calendar_ShortMonths_6,f().Calendar_ShortMonths_7,f().Calendar_ShortMonths_8,f().Calendar_ShortMonths_9,f().Calendar_ShortMonths_10,f().Calendar_ShortMonths_11,f().Calendar_ShortMonths_12],weeks:[f().Calendar_Weeks_7,f().Calendar_Weeks_1,f().Calendar_Weeks_2,f().Calendar_Weeks_3,f().Calendar_Weeks_4,f().Calendar_Weeks_5,f().Calendar_Weeks_6],months:[f().Calendar_Months_1,f().Calendar_Months_2,f().Calendar_Months_3,f().Calendar_Months_4,f().Calendar_Months_5,f().Calendar_Months_6,f().Calendar_Months_7,f().Calendar_Months_8,f().Calendar_Months_9,f().Calendar_Months_10,f().Calendar_Months_11,f().Calendar_Months_12],timePrefix:[f().Calendar_Time_AM,f().Calendar_Time_PM],eraNames:[f().Calendar_EraName_1,f().Calendar_EraName_2,f().Calendar_EraName_3,f().Calendar_EraName_4],earFirstYear:f().Calendar_FirstYear,today:f().Calendar_Today,lastMonth:f().Calendar_LastMonth,nextMonth:f().Calendar_NextMonth,lastYear:f().Calendar_LastYear,nextYear:f().Calendar_NextYear,lastTenYears:f().Calendar_LastTenYear,nextTenYears:f().Calendar_NextTenYear}},Ht.resource={shortWeeks:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],shortMonths:["Jan","Feb","Mar","Api","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weeks:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],months:["January","February","March","Apirl","May","June","July","August","September","October","November","December"],timePrefix:["AM","PM"],eraNames:["M","T","S","H"],earFirstYear:"1",today:"Today",lastMonth:"Go to previous month",nextMonth:"Go to next month",lastYear:"Go to previous year",nextYear:"Go to next year",lastTenYears:"Go to previous ten years",nextTenYears:"Go to next ten years"},T=Ht,pt=Wt,xt=Vt,Lt=Jt,St=Xt,L.dateEqual=function(t,i,n){if(!t&&!i)return!0;if(!t)return!1;if(!i)return!1;try{return n?t.getFullYear()===i.getFullYear()&&t.getMonth()===i.getMonth()&&t.getDate()===i.getDate()&&t.getHours()===i.getHours()&&t.getMinutes()===i.getMinutes()&&t.getSeconds()===i.getSeconds():t.getFullYear()===i.getFullYear()&&t.getMonth()===i.getMonth()&&t.getDate()===i.getDate()}catch(t){return!1}},L.getMonthMaxDay=function(t,i){return-1!==[1,3,5,7,8,10,12].indexOf(i)?31:-1!==[4,6,9,11].indexOf(i)?30:t%4==0&&t%100!=0?29:28},L.isValidEraDate=function(t){return!(t<this.eraMin||t>this.eraMax)},L.addMilliseconds=function(t,i){var t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return t.setMilliseconds(t.getMilliseconds()+i),new Date(t.valueOf())},L.getEraDate=function(t){var i,n,e,i={era:-1,eraYear:-1};if(L.isValidEraDate(t))for(n=0;n<L.eraCount;n++)if(t<(e=n+1!==L.eraCount?L.eraDates[n+1]:L.addMilliseconds(L.eraMax,1))){i.era=n,i.eraYear=t.getFullYear()-L.eraDates[n].getFullYear()+1;break}return i},L.getEraYearString=function(t){var i,i,i=new Date(t,5,30),i=L.getEraDate(i);return-1===i.era||-1===i.eraYear?t.toString():t.toString()+"\u5e74"},L.getShortEraYearString=function(t){var t,t,i,t=new Date(t,11,31),t=L.getEraDate(t);return-1===t.era||-1===t.eraYear?"":(i=1===t.eraYear?T.resource.earFirstYear:t.eraYear,T.resource.eraNames[t.era]+i+"\u5e74")},L.getDateLocaleLabel=function(t){var i,t,n,e,s,i=t.getHours(),t=t.getMinutes(),n,e,s;return(i<12?T.resource.timePrefix[0]:T.resource.timePrefix[1])+" "+(0===i||12===i?"12":(i%12).toString())+":"+(t<10?"0"+t.toString():t.toString())},L.getBuiltInDateRanges=function(){var t,i,n,e,s,o,r,e,t=new Date,i=new Date(t.getFullYear(),t.getMonth(),t.getDate());return i.setDate(t.getDate()-1),(n=new Date(t)).setDate(t.getDate()-6),e=t.getFullYear(),s=t.getMonth(),o=new Date(e,s,1),r=new Date(e,s-1,1),e=new Date(e,s+1,0),[[f().Calendar_BuiltIn_Today,{start:new Date(t.getFullYear(),t.getMonth(),t.getDate()),end:new Date(t.getFullYear(),t.getMonth(),t.getDate())}],[f().Calendar_BuiltIn_Yesterday,{start:new Date(i.getFullYear(),i.getMonth(),i.getDate()),end:i}],[f().Calendar_BuiltIn_Last7Days,{start:new Date(n.getFullYear(),n.getMonth(),n.getDate()),end:new Date(t.getFullYear(),t.getMonth(),t.getDate())}],[f().Calendar_BuiltIn_ThisMonth,{start:new Date(o.getFullYear(),o.getMonth(),1),end:new Date(o.getFullYear(),o.getMonth(),e.getDate())}],[f().Calendar_BuiltIn_LastMonth,{start:new Date(r.getFullYear(),r.getMonth(),1),end:new Date(o.getFullYear(),o.getMonth(),0)}]]},L.getDefaultDate=function(){var t=new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())},L.getNextMonth=function(t){var i,t,n,i=t.getFullYear(),t=t.getMonth()+1,n=new Date(i,t,1);return 12===t&&(n.setFullYear(i+1),n.setMonth(0)),n},L.getPreviousMonth=function(t){var i,t,n,i=t.getFullYear(),t=t.getMonth()-1,n=new Date(i,t,1);return-1==t&&(n.setFullYear(i-1),n.setMonth(11)),n},L.getFirstDayOfMonth=function(t){var i,t,i=t.getFullYear(),t=t.getMonth();return new Date(i,t,1)},L.getShortDate=function(t){var i,t;return u(t)?t:(i=t.start,t=t.end,{start:new Date(i.getFullYear(),i.getMonth(),i.getDate()),end:new Date(t.getFullYear(),t.getMonth(),t.getDate())})},L.eraCount=4,L.eraMax=new Date(2087,11,31,23,59,59),L.eraMin=new Date(1868,8,8),L.eraDates=new Array(new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)),p=L,Ft.prototype.getLabel=function(){return this.year.toString()},kt=Ft,_t.prototype.getLabel=function(){return T.resource.shortMonths[this.month]},Ot=_t,Kt.prototype.getLabel=function(){return this.date.getDate().toString()},Zt=Kt,S.getMonthName=function(t){return T.resource.months[t]},S.getShortMonthName=function(t){return T.resource.shortMonths[t]},Object.defineProperty(S.prototype,"RangeCalendar",{get:function(){return this.owner&&this.owner.parent},enumerable:!1,configurable:!0}),S.prototype.updateDayFocusDate=function(){var t,i;this.owner.A1e?(t=this.T1e,1===this.owner.N1e?this.focusDate=p.getFirstDayOfMonth(t.start):2===this.owner.N1e&&(i=void 0,i=t.end.getMonth()===t.start.getMonth()?p.getNextMonth(t.start):p.getFirstDayOfMonth(t.end),this.focusDate=i)):this.focusDate=new Date(this.selectedDate.valueOf())},S.prototype.updateDayItems=function(){var t,i,n,e,s,o,r,c,u,a,l;for(this.dayItems=[],t=this.focusDate.getFullYear(),i=this.focusDate.getMonth(),c=r=((o=(e=(n=new Date(t,i,1)).getDay())-(s=this.owner.dH))<0?7+o:o)%7;0<c;c--)(u=new Date(t,i,1)).setDate(u.getDate()-c),a=new Zt(u,!1,!0,!1),this.dayItems.push(a);for(c=1;c<=42-r;c++)u=new Date(t,i,c),a=new Zt(u),u.getMonth()!==i&&(a.disabled=!0),this.owner.A1e?(l=this.T1e,(p.dateEqual(u,l.start)||p.dateEqual(u,l.end))&&(a.selected=!0),u>l.start&&(u<l.end||this.E1e&&u<=this.E1e)&&!a.disabled&&(a.focused=!0)):(p.dateEqual(u,this.selectedDate)&&(a.selected=!0),p.dateEqual(u,this.focusDate)&&(a.focused=!0)),this.dayItems.push(a)},S.prototype.updateMonthItems=function(){var t,i,n,n,e;for(this.monthItems=[],t=0;t<12;t++)i=new Ot(t),this.owner.A1e?(n=this.T1e,i.selected=n.start.getMonth()===t||n.end.getMonth()===t,i.focused=n.start.getMonth()<t&&n.end.getMonth()>t):(n=this.selectedDate,e=this.focusDate,i.selected=n&&n.getMonth()===t&&n.getFullYear()===e.getFullYear(),i.focused=e&&e.getMonth()===t),this.monthItems.push(i)},S.prototype.updateYearItems=function(){var t,i,n;for(this.yearItems=[],t=this.focusDateYearRangeStart-1;t<=this.focusDateYearRangeEnd+1;t++)i=new kt(t),this.owner.A1e?(n=this.T1e,i.selected=n.start.getFullYear()===t||n.end.getFullYear()===t,i.focused=n.start.getFullYear()<t&&n.end.getFullYear()>t):(i.selected=this.selectedDate&&this.selectedDate.getFullYear()===t,i.focused=this.focusDate&&this.focusDate.getFullYear()===t,i.disabled=t<this.focusDateYearRangeStart||t>this.focusDateYearRangeEnd),this.yearItems.push(i)},S.prototype.updateYearRange=function(){this.focusDateYearRangeStart=10*Math.floor(this.focusDate.getFullYear()/10),this.focusDateYearRangeEnd=this.focusDateYearRangeStart+9},S.prototype.getShortWeekName=function(t){var i,n,i,n;return T.resource.shortWeeks[t=(this.owner.dH+t-1)%7]},S.prototype.getCurrentMonthName=function(){var t=this.focusDate.getMonth();return S.getMonthName(t)},S.prototype.updateCalendarData=function(t){t?(this.T1e=t.selectedDateRange,this.S1e=t.oldSelectedDateRange,this.E1e=t.hoverDate):this.RangeCalendar.notifyCalendarData({selectedDateRange:this.T1e,oldSelectedDateRange:this.S1e,hoverDate:this.E1e})},Gt=S,Rt=U.EventBase,n(k,Rt),Object.defineProperty(k.prototype,"host",{get:function(){return this.jS.getContainer()},enumerable:!1,configurable:!0}),k.prototype.createCalendarDom=function(){var t,i,n,e,s,e,t,t=this.jS;return this.mH=new St,i=x("div"),this.jS.A1e?i.className=a+" "+P:i.classList.add(a),t.HG?i.classList.add(Y):i.classList.add(J),n=x("table"),e=x("tr"),(s=x("td")).classList.add(K),t.HG&&s.classList.add(q),s.appendChild(this.gH()),e.appendChild(s),n.appendChild(e),i.appendChild(n),t.HG&&(e=x("tr"),t=x("td"),s.appendChild(this.pH()),s.appendChild(this.bH()),t.appendChild(this.yH()),t.appendChild(this.wH()),e.appendChild(t),n.appendChild(e)),this.mH.outerContainerDiv=i},k.prototype.wH=function(){var t,i,t=x("div");return t.classList.add(V),(i=x("button")).textContent=f().OK,i.className=C+" "+jt+" "+yt,t.appendChild(i),this.mH.okButton=i,t},k.prototype.pH=function(){var t=x("div");return t.classList.add($),t},k.prototype.yH=function(){var t=x("div");return t.classList.add(tt),t},k.prototype.gH=function(){var t=x("div");return t.className=H+" "+ct+" "+ut,t.tabIndex=0,t.appendChild(this.MH()),t.appendChild(this.CH()),t.appendChild(this.SH()),this.mH.dateContainerDiv=t},k.prototype.MH=function(){var t=x("div");return t.classList.add(it),t.appendChild(this.TH()),t.appendChild(this.AH()),t},k.prototype.TH=function(){var t,i,n,e,s,s,o,r,r,t=x("div");return t.className=N+" "+v+" "+j,(i=x("div")).className=w+" "+j+" "+at+" "+At,(n=x("div")).classList.add(b),(e=x("button")).className=C+" "+A,e.title=f().Calendar_LastTenYear,e.setAttribute("type","button"),(s=x("div")).classList.add(d),e.appendChild(s),(s=x("span")).classList.add(b),(o=x("button")).className=C+" "+A,o.title=f().Calendar_NextTenYear,o.setAttribute("type","button"),(r=x("div")).classList.add(D),o.appendChild(r),i.appendChild(e),i.appendChild(s),i.appendChild(o),(r=this.mH.calendarYearSection).headerDiv=t,r.lastYearRangeButton=e,r.focusDateYearRangeName=s,r.nextYearRangeButton=o,t.appendChild(i),t},k.prototype.AH=function(){var t,i,t=x("table");return t.className=l+" "+y,(i=x("div")).appendChild(t),this.mH.calendarYearSection.currentYearRangeTable=t,this.IH(),i},k.prototype.IH=function(){for(var t,i,n,e,s,o,r,t=this.mH.calendarYearSection,i=x("tbody"),n=0;n<3;n++){for(e=x("tr"),s=0;s<4;s++)(o=x("td")).setAttribute(Ct,(4*n+s).toString()),(r=x("span")).classList.add(lt),r.setAttribute(Ct,(4*n+s).toString()),r.innerText=(4*n+s+1).toString(),o.appendChild(r),e.appendChild(o),t.yearTds.push(o);i.appendChild(e)}t.currentYearRangeTable.appendChild(i)},k.prototype.CH=function(){var t=x("div");return t.classList.add(et),t.appendChild(this.xH()),t.appendChild(this.NH()),t},k.prototype.xH=function(){var t,i,n,e,s,s,o,r,r,t=x("div");return t.className=N+" "+v+" "+j,(i=x("div")).className=w+" "+j+" "+at+" "+At,(n=x("div")).classList.add(b),(e=x("button")).className=C+" "+A,e.title=f().Calendar_LastYear,e.setAttribute("type","button"),(s=x("div")).classList.add(d),e.appendChild(s),(s=x("span")).className=_+" "+b,(o=x("button")).className=C+" "+A,o.title=f().Calendar_NextYear,o.setAttribute("type","button"),(r=x("div")).classList.add(D),o.appendChild(r),i.appendChild(e),i.appendChild(s),i.appendChild(o),(r=this.mH.calendarMonthSection).headerDiv=t,r.lastYearButton=e,r.currentYearName=s,r.nextYearButton=o,t.appendChild(i),t},k.prototype.NH=function(){var t,i,t=x("table");return t.className=l+" "+y,(i=x("div")).appendChild(t),this.mH.calendarMonthSection.currentYearTable=t,this.kH(),i},k.prototype.kH=function(){for(var t,i,n,e,s,o,r,t=this.mH.calendarMonthSection,i=x("tbody"),n=0;n<3;n++){for(e=x("tr"),s=0;s<4;s++)(o=x("td")).setAttribute(zt,(4*n+s+1).toString()),(r=x("span")).classList.add(lt),r.setAttribute(zt,(4*n+s+1).toString()),r.innerText=(4*n+s+1).toString(),o.appendChild(r),e.appendChild(o),t.monthTds.push(o);i.appendChild(e)}t.currentYearTable.appendChild(i)},k.prototype.SH=function(){var t=x("div");return t.classList.add(st),t.appendChild(this._H()),t.appendChild(this.EH()),t.appendChild(this.jH()),this.jS.A1e||t.appendChild(this.OH()),t},k.prototype._H=function(){var t,i,n,e,s,s,o,r,r,c,u,a,l,h,g,M,I,a,t=x("div");for(t.className=N+" "+v+" "+j,(i=x("div")).className=w+" "+j+" "+at+" "+At,(n=x("div")).classList.add(b),(e=x("button")).className=C+" "+A,e.title=f().Calendar_LastMonth,e.setAttribute("type","button"),(s=x("div")).classList.add(d),e.appendChild(s),(s=x("span")).className=_+" "+b,(o=x("button")).className=C+" "+A,o.title=f().Calendar_NextMonth,o.setAttribute("type","button"),(r=x("div")).classList.add(D),o.appendChild(r),i.appendChild(e),i.appendChild(s),i.appendChild(o),(r=x("div")).className=nt+" "+bt,(c=x("div")).classList.add(rt),(u=x("select")).classList.add(ot),l=(a=new Date).getFullYear()-this.lH,h=a.getFullYear()+this.fH,g=l;g<=h;g++)(M=x("option")).text=g.toString(),M.value=g.toString(),u.options.add(M);return(I=x("div")).classList.add(rt),c.appendChild(u),r.appendChild(c),t.appendChild(r),t.appendChild(i),(a=this.mH.calendarDaySection).headerDiv=t,a.lastMonthButton=e,a.currentMonthName=s,a.nextMonthButton=o,a.yearSelect=u,t},k.prototype.EH=function(){var t,i,n,e,s,o,r,t=x("div");for(t.className=X+" "+v+" "+j,(i=x("table")).className=l+" "+y,n=x("thead"),e=x("tr"),s=0;s<7;s++)(o=x("th")).setAttribute(mt,s.toString()),(r=x("span")).classList.add(ht),r.setAttribute(mt,s.toString()),r.innerText=this.jS._data.getShortWeekName(s),o.appendChild(r),e.appendChild(o),this.mH.calendarDaySection.weekThs.push(o);return n.appendChild(e),i.appendChild(n),t.appendChild(i),t},k.prototype.jH=function(){var t,i,n,e,s,o,r,c,u,a,t=this.mH.calendarDaySection,i=x("div"),n=x("div"),e=x("table");for(e.className=l+" "+y,s=x("tbody"),o=0;o<6;o++){for(r=x("tr"),c=0;c<7;c++)(u=x("td")).setAttribute(z,(7*o+c).toString()),(a=x("span")).classList.add(lt),a.setAttribute(z,(7*o+c).toString()),u.appendChild(a),r.appendChild(u),t.dayTds.push(u);s.appendChild(r)}return e.appendChild(s),n.appendChild(e),i.appendChild(n),t.dayContentTable=e,i},k.prototype.OH=function(){var t,i,n,e,s,o,t=x("div");return t.classList.add(F),(i=x("table")).classList.add(l),n=x("tbody"),e=x("tr"),s=x("td"),(o=x("i")).className=gt+" "+wt,o.innerText=T.resource.today,s.appendChild(o),e.appendChild(s),n.appendChild(e),i.appendChild(n),t.appendChild(i),this.mH.calendarDaySection.todayTd=s,this.mH.calendarDaySection.todayTable=i,t},k.prototype.bH=function(){var i,t,i=this,t=x("div");return t.className=W+" "+ct+" "+ut,t.tabIndex=0,this.mH.timeContainerDiv=t,this.RH=new E.TimePicker(t),this.RH.setOptions({step:{minute:30},height:260}),this.RH.on(o.BaseDropdown.Event_ValueChanged,function(t){i.BH(t)}),t},k.prototype.updateCalendarDom=function(){this.LH(),this.jS.HG&&this.FH()},k.prototype.LH=function(){switch(this.jS._data.calendarPage){case c.CalendarPage.year:this.PH();break;case c.CalendarPage.month:this.GH();break;case c.CalendarPage.day:this.UH()}},k.prototype.HH=function(){var t,i,n,e,s,o,t,r,c,r,t,i,u,a,l,t=this.jS._data,i=this.mH.calendarDaySection,n=!1;for(i.currentMonthName.innerText=t.getCurrentMonthName(),e=t.focusDate.getFullYear(),s=i.yearSelect,o=0;o<s.options.length;o++)if(e.toString()===s.options[o].value){s.selectedIndex=o,n=!0;break}if(t=this.fH+this.lH+1,n?s.options[t]&&s.selectedIndex<=t-1&&s.options[t].remove():((r=x("option")).text=e.toString(),r.value=e.toString(),s.options[t]=r,s.selectedIndex=t),this.jS.A1e&&(c=this.jS.parent).R1e&&c.B1e)if(r=i.lastMonthButton,t=i.nextMonthButton,i=this.jS.N1e,u=c.R1e._data.focusDate,a=c.B1e._data.focusDate,1===i){for(o=0;o<s.options.length;o++)(l=parseInt(s.options[o].value,10))>a.getFullYear()?s.options[o].disabled=!0:s.options[o].disabled=!1;u.getFullYear()===a.getFullYear()&&u.getMonth()>=a.getMonth()-1?(t.disabled=!0,t.classList.add(h)):(t.disabled=!1,t.classList.remove(h))}else if(2===i){for(o=0;o<s.options.length;o++)(l=parseInt(s.options[o].value,10))<u.getFullYear()?s.options[o].disabled=!0:s.options[o].disabled=!1;u.getFullYear()===a.getFullYear()&&a.getMonth()<=u.getMonth()+1?(r.disabled=!0,r.classList.add(h)):(r.disabled=!1,r.classList.remove(h))}},k.prototype.PH=function(){var t,i,n,e,s,o,r,c,r,u,t=this.jS._data,i=this.mH.calendarYearSection;if(t.updateYearItems(),i.focusDateYearRangeName.innerText=t.focusDateYearRangeStart.toString()+" - "+t.focusDateYearRangeEnd.toString(),n=i.yearTds,0!==(e=t.yearItems).length)for(s=0;s<3;s++)for(o=0;o<4;o++)c=e[r=4*s+o],(u=(r=n[r]).querySelector("span")).innerText=c.getLabel(),c.disabled?r.classList.add(I):r.classList.remove(I),c.selected?r.classList.add(M):r.classList.remove(M),c.focused?u.classList.add(g):u.classList.remove(g)},k.prototype.GH=function(){var t,i,n,e,s,o,r,c,u,c,a,t=this.jS._data,i=this.mH.calendarMonthSection;for(t.updateMonthItems(),n=t.focusDate.getFullYear(),e=t.monthItems,s=i.monthTds,i.currentYearName.innerText=n.toString(),o=0;o<3;o++)for(r=0;r<4;r++)u=e[c=4*o+r],(a=(c=s[c]).querySelector("span")).innerText=u.getLabel(),u.selected?c.classList.add(M):c.classList.remove(M),u.focused?a.classList.add(g):a.classList.remove(g)},k.prototype.UH=function(){this.HH(),this.zH()},Object.defineProperty(k.prototype,"RangeCalendar",{get:function(){return this.jS&&this.jS.parent},enumerable:!1,configurable:!0}),k.prototype.zH=function(){var t,i,n,e,s,o,r,o,c,t=this.jS._data;if(t.updateDayItems(),0!==(i=t.dayItems).length)for(n=this.mH.calendarDaySection.dayTds,e=0;e<6;e++)for(s=0;s<7;s++)r=i[o=7*e+s],(c=(o=n[o]).querySelector("span")).innerText=r.getLabel(),r.disabled?o.classList.add(I):o.classList.remove(I),r.focused?c.classList.add(g):c.classList.remove(g),r.selected?o.classList.add(M):o.classList.remove(M)},k.prototype.FH=function(){this.RH.setValue(this.jS._data.selectedDate)},k.prototype.attachEvent=function(){this.VH(),this.attachDateEvent(),this.jS.HG&&this.attachTimeEvent()},k.prototype.VH=function(){var i=this;this.mH.outerContainerDiv.addEventListener("keydown",function(t){i.YH(t)})},k.prototype.YH=function(t){9===t.keyCode?(this.jS.HG&&(this.jS._data.calendarActivePart===m.Date?this.setCalendarActivePart(m.Time):this.setCalendarActivePart(m.Date)),t.preventDefault()):this.jS._data.calendarActivePart!==m.Date||this.jS.A1e||this.ZH(t)},k.prototype.ZH=function(t){switch(this.jS._data.calendarPage){case c.CalendarPage.year:this.WH(t);break;case c.CalendarPage.month:this.QH(t);break;case c.CalendarPage.day:this.KH(t)}},k.prototype.WH=function(t){var i,n,i=this.jS._data,n=i.focusDate;switch(t.keyCode){case 13:i.selectedDate=new Date(n.valueOf()),this.showCalendarPage(c.CalendarPage.month);break;case 32:i.selectedDate=new Date(n.valueOf());break;case 37:this.JH();break;case 39:this.XH();break;case 38:this.JH(4);break;case 40:t.ctrlKey||t.metaKey?this.qH():this.XH(4);break;case 36:n.setFullYear(i.focusDateYearRangeStart);break;case 35:n.setFullYear(i.focusDateYearRangeEnd);break;case 33:this.$H();break;case 34:this.tz()}i.updateYearRange(),this.LH()},k.prototype.QH=function(t){var i,n,i=this.jS._data,n=i.focusDate;switch(t.keyCode){case 13:i.selectedDate=new Date(n.valueOf()),this.showCalendarPage(c.CalendarPage.day);break;case 32:i.selectedDate=new Date(n.valueOf());break;case 37:this.nz();break;case 39:this.ez();break;case 38:t.ctrlKey||t.metaKey?this.iz():this.nz(4);break;case 40:t.ctrlKey||t.metaKey?this.rz():this.ez(4);break;case 36:n.setMonth(0);break;case 35:n.setMonth(11);break;case 33:this.JH();break;case 34:this.XH()}this.LH()},k.prototype.KH=function(t){var i,n,e,s,o,r,i=this.jS._data,n=i.focusDate,e=n.getFullYear(),s=n.getMonth(),o=n.getDate(),r=p.getMonthMaxDay(e,s+1);switch(t.keyCode){case 13:return i.selectedDate=new Date(n.valueOf()),void this.oz();case 32:i.selectedDate=new Date(n.valueOf());break;case 37:n.setDate(o-1);break;case 39:n.setDate(o+1);break;case 38:n.setDate(o-7);break;case 40:n.setDate(o+7);break;case 36:n.setDate(1);break;case 35:n.setDate(r);break;case 33:t.shiftKey?this.nz(12):this.nz();break;case 34:t.shiftKey?this.ez(12):this.ez()}i.selectedDate=new Date(n.valueOf()),this.LH()},k.prototype.attachDateEvent=function(){var i=this;this.mH.dateContainerDiv.addEventListener("click",function(t){var t=t.target;t&&(t===i.mH.calendarDaySection.yearSelect||t.parentElement===i.mH.calendarDaySection.yearSelect)||i.setCalendarActivePart(m.Date)}),this.attachYearEvent(),this.attachMonthEvent(),this.attachDayEvent()},k.prototype.attachYearEvent=function(){var i=this;this.mH.calendarYearSection.lastYearRangeButton.addEventListener("click",function(t){i.$H(),i.LH()}),this.mH.calendarYearSection.nextYearRangeButton.addEventListener("click",function(t){i.tz(),i.LH()}),this.mH.calendarYearSection.currentYearRangeTable.addEventListener("click",function(t){i.az(t)})},k.prototype.$H=function(){var t=this.jS._data;t.focusDateYearRangeStart-=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()-10)},k.prototype.tz=function(){var t=this.jS._data;t.focusDateYearRangeStart+=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()+10)},k.prototype.qH=function(){this.showCalendarPage(c.CalendarPage.month)},k.prototype.az=function(t){var t,t,i,i,t=t.srcElement||t.target;t&&(t=+t.getAttribute(Ct),0!==(i=this.jS._data.yearItems).length)&&(i=i[t],this.jS._data.focusDate.setFullYear(i.year),this.qH())},k.prototype.attachMonthEvent=function(){var i=this;this.mH.calendarMonthSection.lastYearButton.addEventListener("click",function(t){i.JH(),i.LH()}),this.mH.calendarMonthSection.nextYearButton.addEventListener("click",function(t){i.XH(),i.LH()}),this.jS.A1e||this.mH.calendarMonthSection.currentYearName.addEventListener("click",function(t){i.iz()}),this.mH.calendarMonthSection.currentYearTable.addEventListener("click",function(t){i.uz(t)})},k.prototype.JH=function(t){var t,t,t=t||1,t=Math.max(this.jS._data.focusDate.getFullYear()-t,0);this.jS._data.focusDate.setFullYear(t)},k.prototype.XH=function(t){var t,t,t=t||1,t=Math.min(this.jS._data.focusDate.getFullYear()+t,9999);this.jS._data.focusDate.setFullYear(t)},k.prototype.iz=function(){this.jS._data.updateYearRange(),this.showCalendarPage(c.CalendarPage.year)},k.prototype.rz=function(){this.showCalendarPage(c.CalendarPage.day)},k.prototype.uz=function(t){var t,t,t=t.srcElement||t.target;t&&(t=+t.getAttribute(zt),this.jS._data.focusDate.setMonth(t-1),this.rz())},k.prototype.attachDayEvent=function(){var i,t,i=this,t=this.mH.calendarDaySection;t.lastMonthButton.addEventListener("click",function(t){i.nz(),i.hH||(i.jS.A1e?(i.RangeCalendar.checkFocusDateValid(),i.RangeCalendar.updateRangeCalendarDom()):i.LH())}),t.nextMonthButton.addEventListener("click",function(t){i.ez(),i.hH||(i.jS.A1e?(i.RangeCalendar.checkFocusDateValid(),i.RangeCalendar.updateRangeCalendarDom()):i.LH())}),t.todayTable&&t.todayTable.addEventListener("click",function(t){i.fz()}),this.jS.A1e?t.dayContentTable.addEventListener("mouseover",function(t){i.j1e(t)}):t.currentMonthName.addEventListener("click",function(t){i.cz()}),t.dayContentTable.addEventListener("click",function(t){i.jS.A1e?i.O1e(t):i.lz(t)}),t.yearSelect.addEventListener("change",function(t){i.hz(t)}),this.mH.calendarDaySection.yearSelect.addEventListener("keydown",function(t){t.stopPropagation()})},k.prototype.nz=function(t){var i,t,n,t,e,s,n,i=this.jS._data,t=t||1,n=i.focusDate.getFullYear(),t=i.focusDate.getMonth()-t,e=i.focusDate.getDate();t<0&&(t+=12,--n),s=p.getMonthMaxDay(n,t+1),n=new Date(n,t,Math.min(e,s)),i.focusDate=n},k.prototype.ez=function(t){var i,t,n,t,e,s,n,i=this.jS._data,t=t||1,n=i.focusDate.getFullYear(),t=i.focusDate.getMonth()+t,e=i.focusDate.getDate();11<t&&(t-=12,n+=1),s=p.getMonthMaxDay(n,t+1),n=new Date(n,t,Math.min(e,s),i.focusDate.getHours(),i.focusDate.getMinutes(),i.focusDate.getSeconds()),i.focusDate=n},k.prototype.cz=function(){this.showCalendarPage(c.CalendarPage.month)},k.prototype.lz=function(t){var i,t,t,n,e,n,t,t,i=this.jS._data,t=t.srcElement||t.target;if(t){if(t=t.getAttribute(z),u(t))return;if(0===(n=i.dayItems).length)return;n=(e=n[+t]).date,t=(t=i.selectedDate)?new Date(t.valueOf()):new Date,i.selectedDate=new Date(n.getFullYear(),n.getMonth(),n.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),i.focusDate=new Date(i.selectedDate.valueOf()),this.LH(),this.jS.HG||this.oz()}this.mH.dateContainerDiv.focus()},k.prototype.O1e=function(t){var i,t,t,n,n,t,n,e,s,s,e,s,i,n,i=this.jS._data,t=t.srcElement||t.target;t&&(t=t.getAttribute(z),u(t)||0!==(n=i.dayItems).length&&(t=(n=n[+t]).date,n=n.disabled,s=(e=i.T1e)?new Date(e.start.valueOf()):p.getDefaultDate(),0===this.RangeCalendar.D1e?(e.start=new Date(t.getFullYear(),t.getMonth(),t.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()),e.end=e.start,this.RangeCalendar.D1e++):1===this.RangeCalendar.D1e&&(s=new Date(t.getFullYear(),t.getMonth(),t.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()),e.start<=s?(e.end=s,this.RangeCalendar.D1e=0):(e.end=e.start=s,this.RangeCalendar.D1e=1)),i.updateCalendarData(),n&&(e=this.jS._data.focusDate,s=this.jS.parent,i=p.getFirstDayOfMonth(t),1===this.jS.N1e?e<t?s.B1e._data.focusDate=i:t<this.jS._data.focusDate&&(this.jS._data.focusDate=i):2===this.jS.N1e&&(n=s.R1e,e<t?(n._data.focusDate=p.getPreviousMonth(t),this.jS._data.focusDate=i):t<this.jS._data.focusDate&&(n._data.focusDate=i))),this.RangeCalendar.updateRangeCalendarDom()))},k.prototype.j1e=function(t){var i,t,t,n,e,n,t,s,n,i=this.jS._data,t=t.srcElement||t.target;t&&(t=t.getAttribute(z),u(t)||0!==(n=i.dayItems).length&&(n=(e=n[+t]).date,t=i.T1e,i.E1e=null,t.start&&1===this.RangeCalendar.D1e&&(s=t?new Date(t.start.valueOf()):p.getDefaultDate(),(n=new Date(n.getFullYear(),n.getMonth(),n.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()))>t.start)&&(i.E1e=n),i.updateCalendarData(),this.RangeCalendar.updateRangeCalendarDom()))},k.prototype.fz=function(){var t,i,i,n,t=this.jS,i=t._data.selectedDate,i=i?new Date(i.valueOf()):null,n=new Date;i&&(n.setHours(i.getHours()),n.setMinutes(i.getMinutes()),n.setSeconds(0)),t._data.selectedDate=n,t._data.focusDate=new Date(n.valueOf()),this.LH(),t.HG||this.oz()},k.prototype.hz=function(t){var t=t.srcElement||t.target;t&&(this.jS._data.focusDate.setFullYear(+t.value),this.jS.A1e?(this.RangeCalendar.checkFocusDateValid(),this.RangeCalendar.updateRangeCalendarDom()):this.LH())},k.prototype.attachTimeEvent=function(){var i=this;this.mH.timeContainerDiv.addEventListener("click",function(t){i.setCalendarActivePart(m.Time)}),this.mH.okButton.addEventListener("click",function(t){i.oz()})},k.prototype.BH=function(t){var i,n,t,i=this.jS._data,n=i.selectedDate?new Date(i.selectedDate.valueOf()):new Date,t=t.value;n.setHours(t.getHours()),n.setMinutes(t.getMinutes()),n.setSeconds(t.getSeconds()),i.selectedDate=n,i.focusDate=new Date(n.valueOf())},k.prototype.oz=function(){var t=this.jS._data;this.fire(o.BaseDropdown.Event_ValueChanged,{oldValue:t.oldSelectedData,newValue:t.selectedDate}),t.oldSelectedData=t.selectedDate},k.prototype.showCalendarPage=function(t){var i,n,e,i=this.host.querySelector("."+it),n=this.host.querySelector("."+et),e=this.host.querySelector("."+st);switch(i.style.display="none",n.style.display="none",e.style.display="none",t){case c.CalendarPage.year:i.style.display="";break;case c.CalendarPage.month:n.style.display="";break;case c.CalendarPage.day:e.style.display=""}this.jS._data.calendarPage=t,this.updateCalendarDom()},k.prototype.setCalendarActivePart=function(t){switch(this.jS._data.calendarActivePart=t,this.mH.dateContainerDiv.classList.remove(s),this.jS.HG&&this.mH.timeContainerDiv.classList.remove(s),t){case m.Date:this.jS.HG&&this.mH.dateContainerDiv.classList.add(s),this.mH.outerContainerDiv.focus();break;case m.Time:this.jS.HG&&this.mH.timeContainerDiv.classList.add(s),this.mH.outerContainerDiv.focus()}},k.Event_GetHost="GetHost",Ut=k,Pt=o.BaseDropdown,n(O,Pt),O.prototype.setOptions=function(t){var i,t;t&&(t.showTime||this.A1e||(this.HG=t.showTime,this.Ti.innerHTML="",this.Ti.appendChild(this.Dn.createCalendarDom()),this.Dn.attachEvent()),i=t&&t.calendarPage?t.calendarPage:c.CalendarPage.day,(t=t&&t.startDay?t.startDay:c.CalendarStartDay.saturday)!==this.dH&&(this.dH=t,this.Ti.innerHTML="",this.Ti.appendChild(this.Dn.createCalendarDom()),this.Dn.attachEvent()),this.Dn.showCalendarPage(i),this.Dn.setCalendarActivePart(m.Date))},O.prototype.setValue=function(t){var i=this._data;if(t){if(this.A1e&&t instanceof Object){if(!t.start||!t.end)return;i.S1e={start:t.start,end:t.end},i.T1e={start:t.start,end:t.end},i.updateCalendarData()}else t instanceof Date&&(i.selectedDate=t,i.oldSelectedData=new Date(t.valueOf()),i.focusDate=new Date(t.valueOf()),i.updateYearRange());i.updateDayFocusDate()}},O.prototype.scrollToSelect=function(){this.Dn.updateCalendarDom()},Et=O,t.Calendar=Et,Yt=o.BaseDropdown,n(Z,Yt),Z.prototype.setOptions=function(t){u(t.showBuiltInDateRange)&&(t.showBuiltInDateRange=!0),t.showTime=!1,t.calendarPage=c.CalendarPage.day,this.R1e.setOptions(t),this.B1e.setOptions(t)},Z.prototype.setValue=function(t){this.R1e.setValue(t),this.B1e.setValue(t),this.updateRangeCalendarDom()},Z.prototype.updateRangeCalendarDom=function(){this.R1e.Dn.updateCalendarDom(),this.B1e.Dn.updateCalendarDom(),this.updateDataRangeResult(this.T1e)},Z.prototype.L1e=function(){var t,e,t=p.getBuiltInDateRanges(),e=x("div");return e.className=a+" "+It,t.forEach(function(t,i){var n,i,n=x("div");n.className=Mt,n.setAttribute(Tt,i+""),i=B.createTextNode(t[0]),n.appendChild(i),e.appendChild(n)}),this.P1e=e},Z.prototype._1e=function(t){var i,n,n;this.Ti.innerHTML="",(i=x("div")).className=a+" "+R,t&&!1===t.showBuiltInDateRange||i.appendChild(this.L1e()),(n=x("div")).classList.add(Q),this.R1e=new Et(n,t,this,1),i.appendChild(n),(n=x("div")).classList.add(Q),this.B1e=new Et(n,t,this,2),i.appendChild(n),this.Ti.appendChild(i),this.Ti.appendChild(this.G1e())},Z.prototype.aY=function(){var i=this;this.P1e&&this.P1e.addEventListener("click",function(t){i.U1e(t)}),this.H1e.addEventListener("click",function(t){i.onOkButtonClick(t)}),this.z1e.addEventListener("click",function(t){i.onCancelButtonClick(t)}),this.on(Ut.Event_GetHost,function(t){t.host=i.Ti})},Z.prototype.G1e=function(){var t,i,i,n,i,n,t=x("div");return t.className=ft,(i=x("div")).classList.add(vt),t.appendChild(i),this.V1e=i,this.updateDataRangeResult(this.T1e),(i=x("div")).className=Dt,(n=x("button")).textContent=f().Cancel,n.className=Nt,i.appendChild(n),t.appendChild(i),this.z1e=n,(i=x("div")).className=Dt,(n=x("button")).textContent=f().OK,n.className=Nt,i.appendChild(n),t.appendChild(i),this.H1e=n,t},Z.prototype.U1e=function(t){var t,t,i,t,t=t.srcElement||t.target;t&&(t=t.getAttribute(Tt),u(t)||(t=(i=p.getBuiltInDateRanges())[t],this.T1e={start:t[1].start,end:t[1].end},this.notifyCalendarData(),this.fire(o.BaseDropdown.Event_ValueChanged,{text:p.getShortDate(this.T1e)})))},Z.prototype.updateDataRangeResult=function(t){var i,n,e,s,s;if(t&&t.start instanceof Date&&t.end instanceof Date&&(this.V1e.innerHTML="".concat(t.start.toLocaleDateString("en-US"),"-").concat(t.end.toLocaleDateString("en-US"))),this.P1e)for(i=p.getBuiltInDateRanges(),n=0;n<this.P1e.children.length;n++)e=this.P1e.children[n],s=parseInt(e.getAttribute(Tt),10),e.className=Mt,s=i[s]&&i[s][1],p.dateEqual(s.start,t.start)&&p.dateEqual(s.end,t.end)&&(e.className=Mt+" "+dt)},Z.prototype.onOkButtonClick=function(t){this.fire(o.BaseDropdown.Event_ValueChanged,{text:p.getShortDate(this.T1e)})},Z.prototype.onCancelButtonClick=function(t){this.fire(o.BaseDropdown.Event_ValueChanged,{text:p.getShortDate(this.S1e)})},Z.prototype.checkFocusDateValid=function(){var t,i,t,t=this.R1e._data.focusDate,i;this.B1e._data.focusDate<=t&&(t=p.getNextMonth(t),this.B1e._data.focusDate=t)},Z.prototype.notifyCalendarData=function(t){t?(this.T1e=t.selectedDateRange,this.S1e=t.oldSelectedDateRange,this.E1e=t.hoverDate):t={selectedDateRange:this.T1e,oldSelectedDateRange:this.S1e,hoverDate:this.E1e},this.R1e&&this.R1e._data.updateCalendarData(t),this.B1e&&this.B1e._data.updateCalendarData(t)},t.RangeCalendar=Z},"./dist/plugins/celltype/editor/colorpicker.js":function(t,i,n){var e,s,o,r,c,n,u,l,n,a,h,g,M;function I(t,i){var t=M.call(this,t)||this;return t.Hc(),t.setOptions(i),t}e=this&&this.__extends||(g=function(t,i){return(g=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}g(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.ColorPicker=void 0,s=n("./dist/plugins/celltype/editor/listControl.js"),o=n("Core"),r=n("./dist/plugins/celltype/editor/baseControl.js"),c=n("./dist/plugins/celltype/celltypes.ns.js"),n=n("Common"),u=n.Common.lt.ht,l="group-name",n=new n.Common.ResourceManager(c.SR,"CellTypes"),a=n.getResource.bind(n),M=r.BaseDropdown,e(I,M),I.prototype.setOptions=function(t){var i;t&&(this.options=this.options||{},u(t.colorBlockSize)||(i=parseInt(t.colorBlockSize,10),!isNaN(i)&&0<=i&&(this.options.colorBlockSize=t.colorBlockSize)),u(t.groups)||(this.options.groups=t.groups)),this._6()},I.prototype.setValue=function(t){u(t)||(this.vz=t,this.mz=null,this._6())},I.prototype.Hc=function(){for(var i,t,n,e,i=this,t=I.DefaultColorGroup(),n=[],e=0;e<t.length;e++)n.push({name:t[e].name,colors:t[e].colors,needScaleColor:t[e].needScaleColor});this.options={colorBlockSize:I.DefaultCellWidth,groups:n},this.gz=document.createElement("div"),this.gz.classList.add("gc-color-picker-outer-div"),this.gz.addEventListener("click",function(t){i.pz(t)}),this.Ti.appendChild(this.gz)},I.prototype._6=function(){this.gz.innerHTML="",new s.List(this.gz,this.bz()),this.yz()},I.prototype.yz=function(){var t,i,n,e,t=this.gz.querySelectorAll(".gc-color-picker-color-cell");if(0<t.length)for(i=0;i<t.length;i++)t[i].classList.remove("selected"),n=t[i].getAttribute("color"),e=t[i].getAttribute(l),this.vz===n&&(!this.mz||this.mz&&this.mz===e)&&t[i].classList.add("selected")},I.prototype.wz=function(){for(var t,i,n,e,s,o,t=0,i=this.options.groups,n=0;n<i.length;n++)for(e=i[n],s=0;s<e.colors.length;s++)o=e.colors[s],t=Math.max(t,o.length);return t},I.prototype.bz=function(){for(var t,i,n,e,s,o,o,t=[],i=this.options.colorBlockSize||I.DefaultCellWidth,n=this.wz(),e=this.options.groups,s=0;s<e.length;s++)o=this.Mz(e[s],i,n),t.push(o),e[s].needScaleColor&&(o=this.Cz(e[s].colors[0]),t.push(this.Mz(o,i,n)));return{items:t}},I.prototype.Cz=function(t){var i,n,e,s,o,r,c,u,a,l,h,g,M,I,f,N,i={},n=[],s=[-(e=n.length=5),-15,-25,-35,-50],o=[-10,-25,-50,-75,-90],r=[80,60,40,-25,-50],c=document.createElement("span"),u=t.length;c.style.display="none",document.body.appendChild(c);try{for(a=0;a<u;a++)for(h=(l=this.Sz(t[a],c))[0],g=l[1],M=l[2],I=this.Tz(h,g,M),f=0;f<5;f++)n[f]||((N=[]).length=u,n[f]=N),n[f][a]=1===I?this.Az(h,g,M,s[f]):.8<=I?this.Az(h,g,M,o[f]):0===I?this.Az(h,g,M,Math.abs(s[5-f-1])):I<=.2?this.Az(h,g,M,Math.abs(o[5-f-1])):this.Az(h,g,M,r[f]);i.colors=n}finally{document.body.removeChild(c)}return i},I.prototype.Sz=function(t,i){var n,e,s,o,t;return i.style.color=t,t=(o=window.getComputedStyle(i).color).replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(","),[n=parseInt(t[0],10),e=parseInt(t[1],10),s=parseInt(t[2],10)]},I.prototype.Az=function(t,i,n,e){var t,i,n;return e/=100,t=this.Iz(t,i,n),i=parseInt((0<e?(240-t.luminosity)*e:t.luminosity*e).toString(),10),n=this.xz(t.hue,t.luminosity+i,t.saturation),this.Nz(n.r,n.g,n.b)},I.prototype.kz=function(t){var t=t.toString(16);return 1===t.length?"0"+t:t},I.prototype.Nz=function(t,i,n){return"#"+this.kz(t)+this.kz(i)+this.kz(n)},I.prototype.xz=function(t,i,n){var e,s,o,r,c;return 0===n?e=s=o=parseInt((255*i/240).toString(),10):(c=r=void 0,r=2*i-(c=i<=120?(i*(240+n)+120)/240:i+n-(i*n+120)/240),e=parseInt(((255*this.Dz(r,c,t+80)+120)/240).toString(),10),s=parseInt(((255*this.Dz(r,c,t)+120)/240).toString(),10),o=parseInt(((255*this.Dz(r,c,t-80)+120)/240).toString(),10)),{a:255,r:e,g:s,b:o}},I.prototype.Dz=function(t,i,n){return n<0&&(n+=240),240<n&&(n-=240),n<40?t+((i-t)*n+20)/40:n<120?i:n<160?t+((i-t)*(160-n)+20)/40:t},I.prototype.Tz=function(t,i,n){var e;return this.Iz(t,i,n).luminosity/240},I.prototype.Iz=function(t,i,n){var e,s,o,r,c,u,c,u,a,n,r=Math.max(Math.max(t,i),n),c=Math.min(Math.min(t,i),n),u=r+c,e=parseInt(((240*u+255)/510).toString(),10),c=r-c;return 0==c?(s=0,o=160):(s=e<=120?parseInt(((240*c+u/2)/u).toString(),10):parseInt(((240*c+(510-u)/2)/(510-u)).toString(),10),u=(40*(r-t)+c/2)/c,a=(40*(r-i)+c/2)/c,n=(40*(r-n)+c/2)/c,(o=t===r?parseInt((n-a).toString(),10):i===r?parseInt((80+u-n).toString(),10):parseInt((160+a-u).toString(),10))<0&&(o+=240),240<o&&(o-=240)),{luminosity:e,saturation:s,hue:o}},I.prototype.Mz=function(r,c,u){var a,t,a=this,t={items:function(){var t,i,n,e,s,o,t=document.createElement("div");for(t.classList.add("gc-color-picker-group-row"),t.style.width=(c+7)*u+"px",i=0;i<r.colors.length;i++){for((n=document.createElement("div")).classList.add("gc-color-picker-color-row"),e=r.colors[i],s=0;s<e.length;s++)(o=document.createElement("div")).setAttribute(l,r.name),o.setAttribute("color",e[s]),o.style.backgroundColor=e[s],o.style.width=c+"px",o.style.height=c+"px",o.classList.add("gc-color-picker-color-cell"),a.vz===e[s]&&a.mz===r.name&&o.classList.add("selected"),n.appendChild(o);t.appendChild(n)}return t},layout:{direction:o.LayoutDirection.horizontal,displayAs:o.LayoutDisplayAs.inline}};return r.name&&(t.text=r.name),t},I.prototype.pz=function(t){var t,i,t,t=t.srcElement||t.target;t&&(i=t.getAttribute("color"),t=t.getAttribute(l),i)&&t&&(this.vz=i,this.mz=t,this._z(i),this.yz())},I.prototype._z=function(t){this.fire(r.BaseDropdown.Event_ValueChanged,{value:t,text:t})},I.DefaultCellWidth=10,I.DefaultColorGroup=function(){return[{name:a().ThemeColor,colors:[["#ffffff","#000000","#e7e6e6","#44546a","#5b9bd5","#ed7d31","#a5a5a5","#ffc000","#4472c4","#70ad47"]],needScaleColor:!0},{name:a().StandardColor,colors:[["#C00000","#FF0000","#FFC000","#FFFF00","#92D050","#00B050","#00B0F0","#0070C0","#002060","#7030A0"]]}]},i.ColorPicker=I},"./dist/plugins/celltype/editor/eventbase.js":function(t,i){var n;function e(){this.Ez={}}Object.defineProperty(i,"__esModule",{value:!0}),i.EventBase=void 0,e.prototype.on=function(t,i){var n=this.Ez[t];(n=null==n?this.Ez[t]=[]:n).push(i)},e.prototype.off=function(t,i){var n,i;t?null!=(n=this.Ez[t])&&(i?(i=n.indexOf(i),n.splice(i,1)):n=[],this.Ez[t]=n):this.Ez={}},e.prototype.fire=function(t,i){var n,t,n=this,t=this.Ez[t];null!=t&&t.forEach(function(t){try{t.call(n,i)}catch(t){}})},i.EventBase=e},"./dist/plugins/celltype/editor/listControl.js":function(G,t,i){var n,c,u,o,h,g,r,e,s,a,l,M,I,f,N,d,D,v,w,b,A,y,j,C,U,z,m,E,B,T,Q,R,p,P,x,L;function S(t){return e.createElement(t)}function Y(t,i){return t.substring(0,i)+t.substring(i+1,t.length)}function H(t,i){if(o.Common.Uf.OS(t,i))return 1;if(o.Common.ct.W0(i))for(var n=0;n<t.length;n++)if(t[n]-i==0)return 1}function W(t,i){for(var n,e,n=o.Common.ct.W0(i),e=t.length-1;0<=e;e--)(t[e]===i||n&&t[e]-i==0)&&t.splice(e,1)}function V(t){var i,n,e,s,o;if(g(t)||0===t.length)return[];for(i=[],e=n=0;e<t.length;e++)"\\"===(s=t.charAt(e))?","!==(o=t.charAt(e+1))&&"\\"!==o||(t=Y(t,e)):","===s&&(i.push(t.substring(n,e)),n=e+1);return i.push(t.substring(n,t.length)),i}function J(t){for(var i,n,e,i=[],n=0;n<t.length;n++)(e=t[n])&&"string"==typeof e&&(e=e.replace(/\\/g,"\\\\").replace(/,/g,"\\,")),i[n]=e;return i.join(",")}function k(){this.jz=new WeakMap}function O(t,i,n){var e=L.call(this,t)||this;return e.Ti=S("div"),e.Ti.classList.add(a),t.appendChild(e.Ti),e.cE=new s,e.Oz=n&&n.Oz||{y4:void 0},e.Rz={items:[],doms:[]},e.setOptions(i),e}function Z(t){if(t.hasOwnProperty("items"))Z(t.items);else if(Array.isArray(t))for(var i=0;i<t.length;i++)t[i].hasOwnProperty("items")?Z(t[i]):t[i].hasOwnProperty("text")&&!t[i].hasOwnProperty("value")&&(t[i].value=t[i].text);return t}n=this&&this.__extends||(x=function(t,i){return(x=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}x(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.List=void 0,c=i("./dist/plugins/celltype/editor/popupControl.js"),u=i("./dist/plugins/celltype/editor/baseControl.js"),o=i("Common"),h=i("Core"),g=o.Common.lt.ht,r=o.Common.Uf.hD,e=document,k.prototype.set=function(t,i,n){var e=this.jz.get(t);e||this.jz.set(t,e={}),e[i]=n},k.prototype.get=function(t,i){var t=this.jz.get(t);return t&&t[i]},k.prototype.clear=function(){this.jz=new WeakMap},s=k,a="gc-list-control",l="gc-list-control-container",M="gc-list-control-group",I="gc-list-control-group-text",f="gc-list-control-item",N="gc-list-control-hassubitem",d="gc-list-control-selected-item",D="gc-list-control-item-text",v="gc-list-control-item-text-ellipsis",w="gc-list-control-item-ellipsis",b="gc-list-control-item-icon",A="gc-list-control-emptyicon",y="gc-list-control-subitem",j="gc-list-alignment-horizontal",C="gc-list-alignment-vertical",U="gc-list-control-item-wrap",z="gc-list-control-noitem",m="gc-list-control-listseparator",E="gc-list-control-item-bigicon",B="gc-list-control-item-bigtext",T="hide-children",Q="gc-list-control-tree",R="gc-list-control-tree-text",p="gc-list-control-tree-content",L=u.BaseDropdown,n(O,L),O.prototype.setOptions=function(t){g(t)||(this.MU=Z(t),this.Ti.innerHTML="",this.Dn())},O.prototype.setValue=function(t){if(this.MU&&this.MU.multiSelect)if("string"==typeof t)t=V(t);else if(g(t))t=[];else if(o.Common.lt.Nh(t)){if(1!==this.MU.valueType){t=t.slice(0);for(var i=0;i<t.length;i++)t[i]=""+t[i]}}else t=[t];this.Oz.y4=t,this.Bz()},O.prototype.scrollToSelect=function(){},O.prototype.updateStyle=function(t,i,n){this.Ti.style.font=n},O.prototype.Dn=function(){var t=S("div");t.classList.add(l),this.MU.Oue&&(t.setAttribute("role","listbox"),t.setAttribute("tabindex","-1")),this.Lz(t,this.MU),this.Ti.appendChild(t),this.Fz()},O.prototype.Lz=function(t,i){var n;i&&(this.Pz(t,i.layout),i.items)&&(Array.isArray(i.items)?this.Gz(t,i.items):(n=i.items())instanceof HTMLElement&&(t.appendChild(n),t.classList.add(f),this.Pz(n,i.layout)))},O.prototype.Pz=function(t,i){i&&i.direction===h.LayoutDirection.horizontal?t.classList.add(j):t.classList.add(C)},O.prototype.Gz=function(t,i){for(var n,e,s,o,r,c,u,o,a,l,l,n=i.some(function(t){return!!t.icon}),e=0;e<i.length;e++)i[e].items?(s=i[e]).layout&&s.layout.displayAs===h.LayoutDisplayAs.inline?((o=S("div")).classList.add(M),(r=S("span")).innerText=s.text,!g(s.text)&&""!==s.text||r.classList.add(T),r.classList.add(I),o.appendChild(r),Array.isArray(s.items)?this.Lz(o,s):(c=s.items())instanceof HTMLElement&&((u=S("div")).classList.add(f),this.Pz(c,s.layout),u.appendChild(c),o.appendChild(u)),t.appendChild(o)):s.layout&&s.layout.displayAs===h.LayoutDisplayAs.tree?((o=S("div")).classList.add(Q),(a=S("div")).classList.add(f),a.classList.add(N),(r=S("span")).innerText=s.text,r.classList.add(R),a.appendChild(r),s.layout.collapsible&&((l=S("span")).classList.add(y),a.appendChild(l),this.Uz(a)),o.appendChild(a),(l=S("div")).classList.add(p),Array.isArray(s.items)?this.Lz(l,s):(c=s.items())instanceof HTMLElement&&((u=S("div")).classList.add(f),this.Pz(c,s.layout),u.appendChild(c),l.appendChild(u)),o.appendChild(l),t.appendChild(o)):this.Hz(t,i[e],!1,!0):this.Hz(t,i[e],n)},O.prototype.Hz=function(t,i,n,e){var s,o,o,n,o,n,o,n,o;void 0===e&&(e=!1),(s=S("div")).classList.add(f),this.MU.textEllipsis&&s.classList.add(w),"-"===i.text?(s.classList.add(z),(o=S("div")).classList.add(m),s.appendChild(o)):(n&&((o=S("div")).classList.add(b),i.icon?o.style.backgroundImage="url(".concat(i.icon,")"):o.classList.add(A),s.appendChild(o)),(n=S("span")).classList.add(D),this.MU.textEllipsis&&n.classList.add(v),o=i.text,g(i.text)&&(o=g(i.value)?"":i.value),n.innerText=o,s.appendChild(n),s.setAttribute("text",o),n=g(i.value)?null:i.value,(o=r(this.Rz.items,n))<0&&(o=this.Rz.items.length,this.Rz.doms.push([]),this.Rz.items.push(n)),this.Rz.doms[o].push(s),this.cE.set(s,"items",i),e&&((n=S("span")).classList.add(y),s.classList.add(N),this.cE.set(s,"sub-items",i),s.appendChild(n),this.zz(s))),this.MU.Oue&&(s.setAttribute("role","option"),s.setAttribute("tabindex","0"),o=i.text||i.value,g(o)||s.setAttribute("aria-label",o)),t.appendChild(s)},O.prototype.qj=function(t,i){var n,e,n=this.Rz.doms[t];if(i)for(e=0;e<n.length;e++)n[e].classList.contains(N)||n[e].classList.add(d);else for(e=0;e<n.length;e++)n[e].classList.contains(d)&&n[e].classList.remove(d)},O.prototype.Bz=function(){for(var t,i,n,e,s,o,i=this,n=i.MU,t=g(i.formula)?n&&n.multiSelect?e=i.Oz.y4:[i.Oz.y4]:["="+i.formula],s=0;s<i.Rz.items.length;s++)o=i.Rz.items[s],H(t,o=n&&n.multiSelect&&1!==n.valueType?""+o:o)?i.qj(s,!0):i.qj(s,!1)},O.prototype.Fz=function(){var s=this;this.Ti.querySelector("."+l).addEventListener("click",function(t){var i,i,n,t,i,e,i=s.Vz(t.target,".".concat(f));i&&(i.classList.contains(N)?s.Yz(t):(i=s.cE.get(i,"items"),n=s.MU,!i&&o.Common.lt.Eh(n&&n.onItemSelected)&&(i={value:n.onItemSelected(t)}),g(i)||(t=i.value,i=i.path,n&&n.multiSelect&&(H(e=(e=s.Oz.y4).slice(0),t=n.multiSelect&&1!==n.valueType?""+t:t)?W(e,t):o.Common.Uf.ZP(e,t),s.Oz.y4=t=e,s.Bz(),1!==n.valueType)&&(t=J(t)),s.fire(u.BaseDropdown.Event_ValueChanged,{path:i,value:t,text:t,notCloseDropDown:n&&n.multiSelect,noAutoFormat:!0}))))})},O.prototype.Vz=function(t,i){Element.prototype.matches||(Element.prototype.matches=Element.prototype.webkitMatchesSelector||function(t){for(var i=(this.document||this.ownerDocument).querySelectorAll(t),n=i.length;0<=n&&i.item(n)!==this;)--n;return-1<n});for(var n=t;n&&!n.matches(i);)n=n.parentElement;return n},O.prototype.Yz=function(t){var i,n,e,s,o,o,r,i=this,n=this.Vz(t.target,".".concat(f));n.classList.contains(N)&&(e=this.cE.get(n,"sub-items"))&&e.items&&(s=S("div"),o=this.MU,e.multiSelect=o&&o.multiSelect,e.valueType=o&&o.valueType,e.onItemSelected=o&&o.onItemSelected,(o=new O(s,e,this)).Bz(),(r=new c.PopupControl(s,n,{align:h.DropDownAlignment.Near,hostElement:n,direction:h.DropDownDirection.Right})).open(),o.on(u.BaseDropdown.Event_ValueChanged,function(t){i.fire(u.BaseDropdown.Event_ValueChanged,t),i.MU&&i.MU.multiSelect?i.Bz():r.close()}),this.cE.set(n,"sub-items-popup",r),t.stopPropagation(),t.preventDefault())},O.prototype.zz=function(t){var n=this;t.addEventListener("mouseenter",function(t){n.Yz(t)}),t.addEventListener("mouseleave",function(t){var t,i,t=t.target;t.classList.contains(N)&&(i=n.cE.get(t,"sub-items-popup"))&&(i.close(),n.cE.set(t,"sub-items-pop",void 0))})},O.prototype.Uz=function(t){var e=this;t.addEventListener("click",function(t){var i,i,n,i=t.target,i=e.Vz(i,".".concat(N));i&&(n=i.parentElement.querySelector("."+p))&&(i.parentElement.classList.contains(T)?i.parentElement.classList.remove(T):i.parentElement.classList.add(T),t.stopPropagation(),t.preventDefault())})},t.List=O},"./dist/plugins/celltype/editor/monthPicker.js":function(t,i,n){var e,u,s,a,o,n,l,r,c,h,g,M,I,f,N,d,D,v;function w(t){return r.createElement(t)}function b(t,i){var t=v.call(this,t)||this;return t.setOptions(i),t.Fz(),t}e=this&&this.__extends||(D=function(t,i){return(D=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}D(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.MonthPicker=void 0,u=n("./dist/plugins/celltype/editor/baseControl.js"),s=n("./dist/plugins/celltype/celltypes.ns.js"),a=n("Common"),o=a.Common.lt.ht,n=new a.Common.ResourceManager(s.SR,"CellTypes"),l=n.getResource.bind(n),r=document,c="gc-month-picker-separator",h="gc-month-picker-year-item",g="gc-month-picker-month-item",M="gc-month-picker-qtr-item",I="selected",f="data-month",N="data-qtr",v=u.BaseDropdown,e(b,v),b.prototype.setOptions=function(t){var i,n,n,e,e,e,i=this,n=new Date,n={startYear:n.getFullYear()-10,stopYear:n.getFullYear(),height:300};t&&(o(t.startYear)||(e=parseInt(t.startYear,10),isNaN(e))||(n.startYear=e),!o(t.stopYear)&&0<t.stopYear&&(e=parseInt(t.stopYear,10),isNaN(e)||(n.stopYear=e)),n.stopYear<n.startYear&&(n.stopYear=t.startYear),o(t.height)||(e=parseInt(t.height,10),isNaN(e))||(n.height=e)),n.height=Math.max(1,n.height),i.MU=n,i.Ti.innerHTML="",i.Zz()},b.prototype.setValue=function(t){var i,n,e,s,t,o,i=this;t&&(n=t.getMonth()+1,e=t.getFullYear()),this.MU.startYear&&this.MU.stopYear&&this.MU.startYear<this.MU.stopYear&&e>this.MU.stopYear&&(e=this.MU.stopYear),"number"==typeof n&&(t=i.Ti.querySelector("[".concat(f,"='").concat(e,"-").concat(n,"']")))&&(t.classList.add(I),i.Wz&&i.Wz.classList.remove(I),i.Wz=t)},b.prototype.scrollToSelect=function(){var t,t,t=this.Wz;t&&(t=t.offsetTop,this.Ti.scrollTop=t)},b.prototype.Qz=function(t,i){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var i=(this.document||this.ownerDocument).querySelectorAll(t),n=i.length;0<=n&&i.item(n)!==this;)--n;return-1<n});for(var n=t;n&&!n.matches(i);)n=n.parentElement;return n},b.prototype.Fz=function(){var c=this;this.Ti.addEventListener("click",function(t){var i,t,n,e,s,o,t,t,s,r,n,i=c,t=i.Qz(t.target,".".concat(g,",.").concat(M));t&&!t.getAttribute(N)&&(t.classList.add(I),i.Wz&&i.Wz.classList.remove(I),s=e=n=null,(i.Wz=t).getAttribute(f)&&(n=+(t=(o=t.getAttribute(f)).split("-"))[1],s=+t[0]),t=new Date(s,n-1,1,0,0,0,0),s=a.Common.CultureManager.Fe().DateTimeFormat,n=(r=new a.Formatter.GeneralFormatter(s.shortDatePattern)).format(t),i.fire(u.BaseDropdown.Event_ValueChanged,{text:n,value:t}))})},b.prototype.Zz=function(){var t,i,n,e,s,t=this;for(0<=this.MU.height?t.Ti.style.maxHeight=this.MU.height+"px":t.Ti.style.height="auto",t.Ti.classList.add("gc-month-picker-container"),i=t.MU.startYear;i<=t.MU.stopYear;i++)n=document.createElement("div"),t.Jz(n),(e=document.createElement("div")).classList.add("gc-month-picker-year-container"),t.Xz(i,e),(s=document.createElement("div")).classList.add("gc-month-picker-month-container"),t.qz(i,1,s),t.qz(i,2,s),t.qz(i,3,s),t.qz(i,4,s),n.appendChild(e),n.appendChild(s),this.Ti.appendChild(n)},b.prototype.Jz=function(t){var i=w("div");i.classList.add(c),t.appendChild(i)},b.prototype.Xz=function(t,i){var n=w("div");n.classList.add(h),n.innerText="".concat(t),i.appendChild(n)},b.prototype.qz=function(t,i,n){var e,s,o,r,c,e=document.createElement("div"),s=w("div"),o=w("div"),r=w("div"),c=w("div");switch(s.classList.add(g),o.classList.add(g),r.classList.add(g),c.classList.add(M),i){case 1:s.innerText=l().Calendar_ShortMonths_1,s.setAttribute(f,"".concat(t,"-").concat(1)),o.innerText=l().Calendar_ShortMonths_2,o.setAttribute(f,"".concat(t,"-").concat(2)),r.innerText=l().Calendar_ShortMonths_3,r.setAttribute(f,"".concat(t,"-").concat(3)),c.innerText=l().Quarter_Format_1,c.setAttribute(N,"".concat(t,"-").concat(1));break;case 2:s.innerText=l().Calendar_ShortMonths_4,s.setAttribute(f,"".concat(t,"-").concat(4)),o.innerText=l().Calendar_ShortMonths_5,o.setAttribute(f,"".concat(t,"-").concat(5)),r.innerText=l().Calendar_ShortMonths_6,r.setAttribute(f,"".concat(t,"-").concat(6)),c.innerText=l().Quarter_Format_2,c.setAttribute(N,"".concat(t,"-").concat(2));break;case 3:s.innerText=l().Calendar_ShortMonths_7,s.setAttribute(f,"".concat(t,"-").concat(7)),o.innerText=l().Calendar_ShortMonths_8,o.setAttribute(f,"".concat(t,"-").concat(8)),r.innerText=l().Calendar_ShortMonths_9,r.setAttribute(f,"".concat(t,"-").concat(9)),c.innerText=l().Quarter_Format_3,c.setAttribute(N,"".concat(t,"-").concat(3));break;case 4:s.innerText=l().Calendar_ShortMonths_10,s.setAttribute(f,"".concat(t,"-").concat(10)),o.innerText=l().Calendar_ShortMonths_11,o.setAttribute(f,"".concat(t,"-").concat(11)),r.innerText=l().Calendar_ShortMonths_12,r.setAttribute(f,"".concat(t,"-").concat(12)),c.innerText=l().Quarter_Format_4,c.setAttribute(N,"".concat(t,"-").concat(4))}e.appendChild(s),e.appendChild(o),e.appendChild(r),e.appendChild(c),n.appendChild(e),i<4&&this.Jz(n)},i.MonthPicker=b},"./dist/plugins/celltype/editor/multiColumnPicker.js":function(t,i,n){var e,a,l,s,h,o,r,c,n,D,o,g,M,u,I,f,N;function d(t){return Array.isArray(t)}function v(t){return"string"==typeof t}function w(t){t.suspendPaint(),t.suspendEvent(),t.suspendCalcService()}function b(t){t.resumeCalcService(!1),t.resumeEvent(),t.resumePaint()}function A(t,i){var n,s,o,r,e,c,u,n=t[0],s=[];if(d(n))for(r=y(o=t,i),e=function(t,i){var n=o[t],e={};r.forEach(function(t,i){e[t]=n[i]}),s.push(e)},c=0,u=o.length;c<u;c++)e(c,u);else s=t;return s}function y(t,i){var n=[];return i&&0<i.length?i.forEach(function(t){n.push(t.name)}):n=t.shift(),n}function j(t,i,n){return N.call(this,t,i,n)||this}function C(t,i){var n=[];return t.yMt(i,0,0,n),n=z(n)}function z(t){for(var i,n,e,s,o,i=[],n=[],e=0;e<t.length;e++)o=""+(s=t[e]).row+s.col+s.rowCount+s.colCount+s.sheetName,i.indexOf(o)<0&&(i.push(o),n.push(s));return n}function m(s,t,o,r,c,u){var a={row:o,col:r,dataSource:c,dependSheetName:void 0,targetSheetName:u.name()};t.forEach(function(t){var t,i,n,e,i=t.row,n=t.col,e=null!=(t=t.sheetName)?t:u.name();void 0===s[i]&&(s[i]=[]),void 0===s[i][n]&&(s[i][n]=[]),s[i][n].some(function(t){return t.row===o&&t.col===r&&t.dataSource===c&&t.dependSheetName===e})||(a.dependSheetName=e,s[i][n].push(a))})}function T(t,i,n){var e,s,o,r,c,u,a;if(t)for(e in t)if(t.hasOwnProperty(e)&&(s=t[e]))for(o in s)if(s.hasOwnProperty(o)&&(r=s[o]))for(c=0,u=r;c<u.length;c++)(a=u[c]).row>=i&&(a.row+=n)}function p(t,i,n){var e,s,o,r,c,u,a,l;if(t)for(e in t)if(t.hasOwnProperty(e)&&(s=t[e]))for(o in s)if(s.hasOwnProperty(o)&&(r=s[o])){for(c=[],u=0,a=r;u<a.length;u++)(l=a[u]).row<i?c.push(l):l.row<i+n||(l.row-=n,c.push(l));s[o]=c}}function x(t,i,n){var e,s,o,r,c,u,a;if(t)for(e in t)if(t.hasOwnProperty(e)&&(s=t[e]))for(o in s)if(s.hasOwnProperty(o)&&(r=s[o]))for(c=0,u=r;c<u.length;c++)(a=u[c]).col>=i&&(a.col+=n)}function L(t,i,n){var e,s,o,r,c,u,a,l;if(t)for(e in t)if(t.hasOwnProperty(e)&&(s=t[e]))for(o in s)if(s.hasOwnProperty(o)&&(r=s[o])){for(c=[],u=0,a=r;u<a.length;u++)(l=a[u]).col<i?c.push(l):l.col<i+n||(l.col-=n,c.push(l));s[o]=c}}e=this&&this.__extends||(f=function(t,i){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}f(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.MultiColumn=void 0,a=n("Core"),l=n("SheetsCalc"),s=n("CalcEngine"),h=n("CalcEngine"),o=n("Common"),r=n("./dist/plugins/celltype/editor/baseControl.js"),c=n("./dist/plugins/celltype/editor/baseSpreadPicker.js"),n=n("./dist/plugins/celltype/celltypes.ns.js"),D=o.Common.lt.ht,o=new o.Common.ResourceManager(n.SR,"CellTypes"),g=o.getResource.bind(o),M=!!s,u=".multiColumnNS",N=c.BaseSpreadPicker,e(j,N),j.prototype.setOptions=function(t){var i,n,e,s,t,o,n,r,e;if(N.prototype.setOptions.call(this,t),(i=this).MU=t){if(n=i.TU,e=t.dataSource,s=t.bindingInfos,t=t.border,o=i.SU,n=n.getActiveSheet(),e){r=!0,w(n),n.options.isProtected=!0,n.options.rowHeaderVisible=!1,n.selectionPolicy(a.SelectionPolicy.single),n.selectionUnit(a.SelectionUnit.row);try{i.$z(n,e,s)}catch(t){r=!1,i.dispose()}finally{r&&n&&((e=new a.Style).hv=!1,n.setStyle(-1,-1,e,a.SheetArea.viewport),b(n))}}D(t)||(o.style.border=t)}},j.prototype.setValue=function(t){var i,n,e,n,i,i=this;i.MU&&(N.prototype.setValue.call(this,t),n=i.TU,e=n.getActiveSheet(),n=i.tV(t),e.suspendPaint(),-1!==n?(e.clear(0,-1,-1,-1,a.SheetArea.colHeader,a.StorageType.style),e.setSelection(n,-1,1,-1)):(e.clearSelection(),(i=new a.Style).backColor="rgb(225, 225, 225)",i.foreColor="rgb(33, 115, 70)",i.font="bold 11pt Calibri",i.borderBottom=new a.LineBorder("rgb(33, 115, 70)",a.LineStyle.medium),e.setStyle(0,-1,i,a.SheetArea.colHeader),e.D3(a.Events.ActiveCellChanged+u,function(t,i){e.setSelection(0,-1,1,-1),e._3(a.Events.ActiveCellChanged+u)})),e.resumePaint())},j.prototype.dispose=function(){var t,i,n,t,i,n;this.TU.getActiveSheet()._3(a.Events.ActiveCellChanged+u),N.prototype.dispose.call(this)},j.prototype.$z=function(t,i,n){var e,i;i&&(i=this.nV(i))&&(t.setDataSource(A(i,n)),n)&&t.bindColumns(n)},j.prototype.nV=function(t){var t,i,n,e,s,e,n,o,r,c,s,u,e,o,s,e,o,t=t,i=this.CU;if(v(t)){if(M){if(s=(e=this.MU).row,e=e.col,n=(0,l.formulaToExpression)(i,t),o=void 0,i.reportDataModel?(o=i.reportDataModel.xCi.POt)&&o.setContext&&o.setContext({row:s,col:e,formula:t,triggerUpdatePrecedents:!0}):(o=i.Uw(),m(r=i.Rpe(),c=C(i,n),s,e,t,i)),s=i.getCalcService().evaluateParsedFormula(o,n,(0,h.eV)(0,0),!0),e=!1,o=void 0,!(e=!(u=h.Convert.LE(s)||h.Convert.Nh(s))||(o=h.Convert.iV(s,0,!1,!1,!1)).isError||o.isConvertError?e:!0))throw new Error(g().MultiColumn_InvalidDataSource);n=o}}else t instanceof a.Range?n=i.getArray(t.row,t.col,t.rowCount,t.colCount):d(t)?n=t:t.viewName&&(n=(o=(e=(s=i.parent)&&s.dataManager().rV)&&e[t.viewName])&&o.oV());return n},j.prototype.tV=function(t){var i,n,e,s,o,r,c,u,a,l,h,g,M,I,f,N,d,i=this,n=-1;if(t)if(s=(e=i.TU).getActiveSheet(),r=(o=Object.keys(t)).length,u=(c=s.getDataSource()).length,a=!1,l=i.MU.valuePath,D(l))for(h=0;h<u;h++){for(g=c[h],a=!0,M=0;M<r;M++)if(g[l=o[M]]!==t[l]&&void 0!==g[l]){a=!1;break}if(a){n=h;break}}else for(f=(I=t instanceof Date)?t+"":t,h=0;h<u;h++)if(N=c[h][l],(d=I&&N instanceof Date?N+"":N)===f){n=h;break}return n},j.prototype.submitData=function(t){var i,n,e,s,o,t,n,t,i=this,n=t.sheet,e;t.isEsc?s={notSubmit:!0}:-1<(t=(o=n.getSelections()[0]).row)&&(n=n.getDataItem(t),t=i.MU.valuePath,s={value:n=D(t)?n:n[t],text:n}),D(s)||i.fire(r.BaseDropdown.Event_ValueChanged,s)},i.MultiColumn=j,a.Worksheet.ch("dropDowns",{onLayoutChanged:function(t){var i,n,e,s,o,r,t;!D(t.sheetArea)&&3!==t.sheetArea||(n=(i=this).Rpe(),e=t.changeType,s=t.row,o=t.rowCount,r=t.col,t=t.colCount,"addRows"===e?T(n,s,o):"deletingRows"===e?p(n,s,o):"addColumns"===e?x(n,r,t):"deletingColumns"===e&&L(n,r,t))},updatePrecedents:function(t){var i,n,e,s,o,r,t,i=this,n=i.Rpe(),e=t.row,s=t.col,o=t.cells,r=t.formula,t=i.getStyle(e,s);t&&t.dropDowns&&t.dropDowns.some(function(t){return t.type===a.DropDownType.multiColumn&&t.option.dataSource===r})&&m(n,o,e,s,r,i)}})},"./dist/plugins/celltype/editor/popupControl.js":function(t,i,n){var e,w,n,b,A,s,o,r,c,u;function a(t,i,n,e){this._x=t,this._y=i,this.YC=n,this.ZC=e}function l(t,i,n){var e=u.call(this,null)||this;return e.sourceElement=t,e.target=i,e.defaultOption={closeAfterResize:!0,closeAfterClickOutside:!0,direction:w.DropDownDirection.Down,align:w.DropDownAlignment.Near,horAdj:b.Flip|b.Slide,verAdj:b.Flip|b.Slide},e.globalMousedownEventHandler=function(t){var i,n;if(e.rf){for(n=i=t.target;n&&n!==e.sourceElement;)n=n.parentElement;n||(e.close(),t.stopPropagation(),t.preventDefault())}},e.windowResizeEventHandler=function(){e.rf&&e.close()},e.MU=e.defaultOption,e.rf=!1,n&&e.mergeOption(n),e.aV=null===e.MU.hostElement||void 0===e.MU.hostElement||!(e.MU.hostElement instanceof HTMLElement),e}e=this&&this.__extends||(r=function(t,i){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PopupControl=i.Rectangle=i.DropDownAdjustment=void 0,w=n("Core"),n=n("./dist/plugins/celltype/editor/baseControl.js"),(c=b=i.DropDownAdjustment||(i.DropDownAdjustment={}))[c.None=0]="None",c[c.Flip=1]="Flip",c[c.Slide=2]="Slide",a.CreateFromDom=function(t){return new a(t.left,t.top,t.width,t.height)},Object.defineProperty(a.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"width",{get:function(){return this.YC},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.ZC},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"left",{get:function(){return this._x},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"right",{get:function(){return this._x+this.YC},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"top",{get:function(){return this._y},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"bottom",{get:function(){return this._y+this.ZC},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"Location",{get:function(){return{X:this._x,Y:this._y}},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"Size",{get:function(){return{width:this.YC,height:this.ZC}},enumerable:!1,configurable:!0}),a.prototype.Offset=function(){for(var t,i,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];1===t.length&&"number"==typeof t[0].X&&"number"==typeof t[0].X?(this._x+=t[0].X,this._y+=t[0].Y):2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&(this._x+=t[0],this._y+=t[1])},A=a,i.Rectangle=A,s="ribbon-dropdowngroup-popup",u=n.BaseControl,e(l,u),l.prototype.open=function(){this.rf||(this.MU.Oue&&this.target.setAttribute&&this.target.setAttribute("aria-expanded","true"),this.beforeOpen(),this.render(),this.clearPosition(),this.calcPosition(),this.rf=!0,this.sourceElement.tabIndex=-1,this.sourceElement.style.cssText+="outline:none",this.sourceElement.focus())},l.prototype.beforeOpen=function(){this.bindEvent()},l.prototype.dispose=function(){var i=this;this.MU.closeAfterResize&&document.removeEventListener("resize",this.windowResizeEventHandler),this.MU.closeAfterClickOutside&&(document.removeEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){document.removeEventListener(t,i.globalMousedownEventHandler,!0)})),this.aV?(this.sourceElement.classList.remove(s),this.sourceElement.style.display=this.uV,this.sourceElement.style.position=this.Z3):this.sV&&this.sV.parentNode&&(this.MU.hostElement.removeChild(this.sV),this.sV=null)},l.prototype.close=function(){var t;this.rf&&(this.rf=!1,this.MU.Oue&&(t=this.target).setAttribute&&(t.setAttribute("aria-expanded","false"),setTimeout(function(){t.focus()})),this.dispose(),this.fire("close"))},l.prototype.mergeOption=function(t){for(var i in t)void 0!==t[i]&&(this.MU[i]=t[i])},l.prototype.clearPosition=function(){this.cV.style.top=this.cV.style.bottom=this.cV.style.left=this.cV.style.right=""},l.prototype.calcPosition=function(){var t,i,n,n,t,e,s,o,r,o,r,n,i=this.target instanceof A,t=i?this.target:A.CreateFromDom(this.target.getBoundingClientRect()),n=new A(0,0,window.innerWidth,window.innerHeight),n=this.calculateDropDownLocation(n,t,{width:this.sourceElement.offsetWidth,height:this.sourceElement.offsetHeight},this.MU.direction,this.MU.align,this.MU.horAdj,this.MU.verAdj),t=this.cV.offsetParent,e=t.getBoundingClientRect(),s=t===document.body,o=document.documentElement,r=(window.pageXOffset||o.scrollLeft)-(o.clientLeft||0),o=(window.pageYOffset||o.scrollTop)-(o.clientTop||0),r=n.X-(s?-r:e.left-t.scrollLeft),n=n.Y-(s?-o:e.top-t.scrollTop);i&&(r<0&&(r=0),n<0)&&(n=0),this.cV.style.left="".concat(r,"px"),this.cV.style.top="".concat(n,"px")},l.prototype.calculateDropDownLocation=function(t,i,n,e,s,o,r){var c,u,a,l,h,g,M,I,f,N,d,r,o,D,v,i,c={X:t.x,Y:t.y};switch(t.Offset(-c.X,-c.Y),i.Offset(-c.X,-c.Y),u=i.left,a=i.right,l=i.top,h=i.bottom,g=l,M=t.height-h,I=u,f=t.width-a,N=(r&b.Flip)===b.Flip,d=(o&b.Flip)===b.Flip,r=(r&b.Slide)===b.Slide,o=(o&b.Slide)===b.Slide,e){case w.DropDownDirection.Up:n.height>g&&N&&(e=w.DropDownDirection.Down);break;case w.DropDownDirection.Down:n.height>M&&N&&(e=w.DropDownDirection.Up);break;case w.DropDownDirection.Left:n.width>I&&d&&(e=w.DropDownDirection.Right);break;case w.DropDownDirection.Right:n.width>f&&d&&(e=w.DropDownDirection.Left)}switch(v=D=0,e){case w.DropDownDirection.Up:v=l-n.height;break;case w.DropDownDirection.Down:v=h;break;case w.DropDownDirection.Left:D=u-n.width;break;case w.DropDownDirection.Right:D=a}return e===w.DropDownDirection.Up||e===w.DropDownDirection.Down?s===w.DropDownAlignment.Near?D=u:s===w.DropDownAlignment.Center?D=u-(n.width-i.width)/2:s===w.DropDownAlignment.Far&&(D=a-n.width):e!==w.DropDownDirection.Right&&e!==w.DropDownDirection.Left||(s===w.DropDownAlignment.Near?v=l:s===w.DropDownAlignment.Center?v=l-(n.height-i.height)/2:s===w.DropDownAlignment.Far&&(v=h-n.height)),i=new A(D,v,n.width,n.height),o&&(i.width>t.width?i.x=0:(i.x=Math.max(i.x,0),i.x=Math.min(i.x,t.width-i.width))),r&&(i.height>t.height?i.y=0:(i.y=Math.max(i.y,0),i.y=Math.min(i.y,t.height-i.height))),i.Offset(c),i.Location},l.prototype.render=function(){var i=this;this.aV?(this.Z3=this.sourceElement.style.position,this.sourceElement.style.position="absolute",this.uV=this.sourceElement.style.display,this.sourceElement.style.display="",this.sourceElement.style.zIndex="10000",this.sourceElement.classList.add(s),this.cV=this.sourceElement):(this.sV=document.createElement("div"),this.sV.style.cssText="position:absolute; z-index:10000; box-shadow:rgba(0, 0, 0, 0.4) 2px 4px 5px; outline:none",this.sV.classList.add(s),this.sV.appendChild(this.sourceElement),this.MU.hostElement.appendChild(this.sV),this.cV=this.sV),this.MU.Oue&&setTimeout(function(){var t;i.cV&&(t=i.cV.querySelector("[role=menu],[role=listbox]"))&&t.focus()},500)},l.prototype.bindEvent=function(){var i=this;this.MU.closeAfterClickOutside&&(document.addEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){document.addEventListener(t,i.globalMousedownEventHandler,!0)})),this.MU.closeAfterResize&&document.addEventListener("resize",this.windowResizeEventHandler)},i.PopupControl=l},"./dist/plugins/celltype/editor/slider.js":function(t,i,n){var e,s,o,r,c,u,a,l,h,g,M,I,f,N,d,D,v,w,b,A;function y(t){return document.createElement(t)}function j(t){var i=t.toExponential().match(/\d(?:\.(\d*))?e([+-]\d+)/);return t.toFixed(l(0,(i[1]||"").length-parseInt(i[2],10)))}function C(t){var t,i,t=j(t||0),i=0;return i=0<=t.indexOf(".")?t.length-t.indexOf(".")-1:i}function z(){}function m(t,i){this.Wc=i,this.fV={},this.fV=M.extend(this.fV,t)}function T(t,i){this.Wc=i,this.lV={},this.lV=M.extend(this.lV,t)}function p(t,i){this.Wc=t,this.hV={},this.dV="",this.hV=M.extend(this.hV,i),this.dV='\n        <div class="'.concat(this.hV.prefixCls,"-tooltip ").concat(this.hV.prefixCls,'-tooltip-placement-top">\n            <div class="').concat(this.hV.prefixCls,'-tooltip-content">\n                <div class="').concat(this.hV.prefixCls,'-tooltip-arrow"></div>\n                <div class="').concat(this.hV.prefixCls,'-tooltip-inner">{{value}}</div>\n            </div>\n        </div>\n        ')}function x(t,i){this.Wc=i,this.vV={},this.mV=!1,this.gV=a,this.isSelected=!1,this.yme=a,this.vV=M.extend(this.vV,t),this.gV=new N(this.Wc,this.pV())}function L(t,i){this.Wc=i,this.bV={},this.bV=M.extend(this.bV,t)}function S(t,i,n,e,s){this.Wc=t,this.yV=i,this.wV=n,this.endHandle=e,this.MU=s,this.MV=a,this.CV=a,this.MV=new f(this.SV(),this.Wc),this.CV=new D(this.TV(),this.Wc)}function k(t,i){var e=A.call(this,t)||this;return e.yV=a,e.wV=a,e.Y1e=a,e.Z1e=a,e.AV=a,e.Mme=function(t){var t,t,t;M.pauseEvent(t),t=e.AV.getKeyboardValueMutator(t),M.isEmpty(t)||(t=t(e._V.value),(t=e.AV.trimAlignValue(t))!==e._V.value&&(e.setValue(t),e._V.onChange(t),e._V.onAfterChange(t),e.fire(s.BaseDropdown.Event_ValueChanged,{value:t,text:t.toString(),notCloseDropDown:!0})))},e.IV=function(t){0===t.button&&(document.addEventListener("mouseup",e.xV,!1),document.addEventListener("pointerup",e.xV,!1),document.addEventListener("MSPointerUp",e.xV,!1),document.addEventListener("mousemove",e.NV,!1),document.addEventListener("pointermove",e.NV,!1),document.addEventListener("MSPointerMove",e.NV,!1),e.NV(t))},e.NV=function(t){var t,i,t=e.kV(t,!0),i=e.AV.trimAlignValue(t);e._V.showNumberRange?e.Cme(i,t):e.DV!==i&&(e.setValue(i),e._V.onChange(i))},e.xV=function(t){var i,n;e.NV(t),document.removeEventListener("mousemove",e.NV),document.removeEventListener("mouseup",e.xV),document.removeEventListener("pointermove",e.NV),document.removeEventListener("pointerup",e.xV),document.removeEventListener("MSPointerMove",e.NV),document.removeEventListener("MSPointerUp",e.xV),i=e.kV(t,!0),n=e.AV.trimAlignValue(i),e._V.showNumberRange?(e.Cme(n,i),e._V.onAfterChange(e._V.numberRange),e.fire(s.BaseDropdown.Event_ValueChanged,{value:e._V.numberRange,text:e._V.numberRange,notCloseDropDown:!0})):(e.DV=n,e._V.onAfterChange(e._V.value),e.fire(s.BaseDropdown.Event_ValueChanged,{value:n,text:n.toString(),notCloseDropDown:!0})),M.pauseEvent(t)},e.EV=function(t){var i=t.target||t.srcElement;document.addEventListener("touchend",e.jV,!1),i.classList.contains("".concat(e._V.prefixCls,"-handle"))?document.addEventListener("touchmove",e.OV,!1):e.OV(t)},e.OV=function(t){var t,t,i,t=t.targetTouches[0],t=e.kV(t,!0),i=e.AV.trimAlignValue(t);e._V.showNumberRange?e.Cme(i,t):e.DV!==i&&(e.setValue(i),e._V.onChange(i))},e.jV=function(t){var i,i,n;document.removeEventListener("touchmove",e.OV),document.removeEventListener("touchend",e.jV),i=t.changedTouches[0],i=e.kV(i,!0),n=e.AV.trimAlignValue(i),e._V.showNumberRange?(e.Cme(n,i),e._V.onAfterChange(e._V.numberRange),e.fire(s.BaseDropdown.Event_ValueChanged,{value:e._V.numberRange,text:e._V.numberRange,notCloseDropDown:!0})):(e.DV=n,e._V.onAfterChange(e._V.value),e.fire(s.BaseDropdown.Event_ValueChanged,{value:n,text:n.toString(),notCloseDropDown:!0})),M.pauseEvent(t)},e.init(i),e}e=this&&this.__extends||(b=function(t,i){return(b=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}b(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.Slider=void 0,s=n("./dist/plugins/celltype/editor/baseControl.js"),o=n("Common"),r=n("Core"),c=o.Common.lt.ht,u=o.Common.zf.j0,a=null,l=Math.max,h=Math.min,g=Math.abs,z.isEmpty=function(t){return void 0===t||t===a||""===t||Array.isArray(t)&&0===t.length},z.isEmptyObject=function(t){var i,n,i=!0;for(n in t)if(n){i=!1;break}return i},z.pauseEvent=function(t){t.stopPropagation(),t.preventDefault()},z.isObject=function(t){var i=typeof t;return"function"==i||"object"==i&&!!t},z.allKeys=function(t){var i,n,i=[];if(!z.isObject(t))return[];for(n in t)t.hasOwnProperty(n)&&i.push(n);return i},z.parseStyleObject=function(t){var i,n,e,s,o,r,o;if(!z.isObject(t))return"";for(i="",e=0,s=(n=z.allKeys(t)).length;e<s;e++)r=t[o=n[e]],o=o.replace(/([A-Z])/g,"-$1"),i+="".concat(o.toLowerCase(),": ").concat(r,"; ");return i.trim()},z.extend=function(t,i,n){var e,s,o,r,c;for(void 0===n&&(n={}),e=z.allKeys(t),o=0,r=(s=z.allKeys(i)).length;o<r;o++)n[c=s[o]]=i[c];for(o=0,r=e.length;o<r;o++)void 0===n[c=e[o]]&&(n[c]=t[c]);return n},z.noop=function(){},z.measureWidth=function(t,i){var n,e,n=0,e=y("span");e.classList.add(i);try{e.innerText=t,e.style.display="none",document.body.appendChild(e),n=(0,r.GC$)(e).width()}finally{document.body.removeChild(e)}return n},M=z,m.prototype.render=function(){var t,i;if(!this.fV.included)return a;t=this.RV(),(i=this.Wc.querySelector(".".concat(this.fV.className)))===a&&((i=y("div")).classList.add("".concat(this.fV.className)),this.Wc.appendChild(i)),i.setAttribute("style",M.parseStyleObject(t))},m.prototype.setLength=function(t,i){this.fV.length=t,c(i)||(this.fV.offset=i),this.render()},m.prototype.RV=function(){return this.fV.direction===r.LayoutDirection.vertical?{bottom:"".concat(this.fV.offset,"%"),height:"".concat(this.fV.length,"%")}:{left:"".concat(this.fV.offset,"%"),width:"".concat(this.fV.length,"%")}},I=m,T.prototype.render=function(){var t,i,n,e,s,t=this.Wc.querySelector(".".concat(this.lV.className));if(t===a){for((t=y("div")).className="".concat(this.lV.className),n=0,e=(i=this.BV()).length;n<e;n++)s=this.LV(i[n]),t.appendChild(s);this.Wc.appendChild(t)}},T.prototype.LV=function(t){var i,n,n,n,i=y("span"),n=this.lV.max-this.lV.min,n=g(t-this.lV.min)/n*100+"%",n=this.lV.direction===r.LayoutDirection.vertical?{bottom:n}:{left:n};return i.classList.add("".concat(this.lV.prefixCls,"-dot")),i.setAttribute("style",M.parseStyleObject(n)),i.setAttribute("key",t.toString()),i},T.prototype.BV=function(){var t,i,n,t=Object.keys(this.lV.marks).map(function(t){return Number(t)});if(t.sort(function(t,i){return t-i}),i=t,this.lV.dots)for(n=this.lV.min;n<=this.lV.max;n+=this.lV.step)-1===i.indexOf(n)&&i.push(n);return i},f=T,p.prototype.render=function(t,i){var t,i,n,n,e,n;this.hV.offset=t,t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip")),i=new o.Formatter.GeneralFormatter(this.hV.formatString).format(i),M.isEmpty(t)&&(n=u(i),this.dV=this.dV.replace(/{{value}}/,n),(n=y("div")).innerHTML=this.dV,this.Wc.appendChild(n.firstElementChild),t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"))),(e=t.querySelector(".".concat(this.hV.prefixCls,"-tooltip-inner"))).textContent=i,n=this.GV(i),t.setAttribute("style",M.parseStyleObject(n)),this.hV.tooltipVisible?this.show():this.hide()},p.prototype.show=function(){var t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"));M.isEmpty(t)||(t.style.display="inline-block")},p.prototype.hide=function(){var t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"));M.isEmpty(t)||(t.style.display="none")},p.prototype.GV=function(t){var t,t=0===(t=M.measureWidth(t,"".concat(this.hV.prefixCls,"-tooltip")))?12:t/2+4;return this.hV.direction===r.LayoutDirection.vertical?{left:"-".concat(t,"px"),bottom:"calc(".concat(this.hV.offset,"% + 10px)")}:{top:"-28px",left:"calc(".concat(this.hV.offset,"% - ").concat(t+4,"px)")}},N=p,x.prototype.render=function(){var t,i,n,e,t=this.UV(),i=this.GV(),n=this.vV.tabIndex||0;!this.vV.disabled&&n!==a||(n=a),(e=this.Wc.querySelector(".".concat(this.vV.className)))===a&&((e=y("div")).className=t,this.Wc.appendChild(e),e.setAttribute("role","slider"),e.setAttribute("aria-valuemin",this.vV.min.toString()),e.setAttribute("aria-valuemax",this.vV.max.toString()),e.setAttribute("aria-valuenow",this.vV.value.toString()),e.setAttribute("aria-disabled",String(this.vV.disabled)),e.addEventListener("blur",this.Sme.bind(this)),e.addEventListener("mouseenter",this.Tme.bind(this)),e.addEventListener("keydown",this.Sme.bind(this)),e.addEventListener("mousedown",this.Ame.bind(this)),e.addEventListener("touchstart",this.Ame.bind(this)),document.addEventListener("touchend",this.Ime.bind(this)),document.addEventListener("mouseup",this.Ime.bind(this))),e.tabIndex=n,e.setAttribute("style",M.parseStyleObject(i)),this.yme=e},x.prototype.Ame=function(t){this.yme.focus(),this.isSelected=!0,this.gV.show()},x.prototype.Ime=function(t){var i=this.yme;document.activeElement===i&&(this.HV(!1),i.blur(),this.isSelected=!1)},x.prototype.Sme=function(){this.HV(!1)},x.prototype.Tme=function(){this.gV.show()},x.prototype.isSelectedByMouse=function(t){return c(t)||(this.isSelected=t),this.isSelected},x.prototype.setOffset=function(t,i){this.vV.offset=t,this.render(),this.gV.render(t,i)},x.prototype.HV=function(t){this.mV=t},x.prototype.UV=function(){return this.mV?"".concat(this.vV.className," ").concat(this.vV.prefixCls,"-handle-click-focused"):"".concat(this.vV.className)},x.prototype.GV=function(){return this.vV.direction===r.LayoutDirection.vertical?{bottom:"".concat(this.vV.offset,"%")}:{left:"".concat(this.vV.offset,"%")}},x.prototype.pV=function(){return{prefixCls:"gc-slider",tooltipVisible:this.vV.tooltipVisible,direction:this.vV.direction,offset:this.vV.offset,formatString:this.vV.formatString}},x.prototype.dispose=function(){this.yme&&(this.yme.removeEventListener("blur",this.Sme.bind(this)),this.yme.removeEventListener("mouseenter",this.Tme.bind(this)),this.yme.removeEventListener("keydown",this.Sme.bind(this)),this.yme.removeEventListener("mousedown",this.Ame.bind(this)),this.yme.removeEventListener("touchstart",this.Ame.bind(this))),this.yme=a,document.removeEventListener("touchend",this.Ime.bind(this)),document.removeEventListener("mouseup",this.Ime.bind(this))},d=x,L.prototype.render=function(){var t,i,n,e,s,s,t=this.Wc.querySelector(".".concat(this.bV.className));if(t===a){for((t=y("div")).className="".concat(this.bV.className),i=this.zV(),this.VV(i),n=0,e=i.length;n<e;n++)s=i[n],(s=this.YV(s))!==a&&t.appendChild(s);this.Wc.appendChild(t)}},L.prototype.VV=function(t){var i,n,e,e;for(this.ZV=0,i=1,n=t.length;i<n;i++)(e=this.bV.marks[t[0]])&&(e=M.measureWidth(e.label,"".concat(this.bV.className,"-text")),!this.ZV||this.ZV<e)&&(this.ZV=e)},Object.defineProperty(L.prototype,"maxWidth",{get:function(){return this.ZV},enumerable:!1,configurable:!0}),L.prototype.zV=function(){var t;return M.allKeys(this.bV.marks).sort(function(t,i){return t-i})},L.prototype.YV=function(i){var n,t,e,s,o,o,t,n=this,t=this.bV.marks[i],e=M.isObject(t)?t.label:t;return M.isEmptyObject(e)?a:(s="".concat(this.bV.className,"-text"),o=this.WV(i),o=M.extend(o,t.style),(t=y("span")).classList.add(s),t.setAttribute("style",M.parseStyleObject(o)),t.setAttribute("key",i.toString()),t.addEventListener("mousedown",function(t){n.bV.onClickLabel(t,i)}),t.innerHTML=u(e),t)},L.prototype.WV=function(t){var i=this.bV.max-this.bV.min;return this.bV.direction===r.LayoutDirection.vertical?{"margin-bottom":"-50%",bottom:(t-this.bV.min)/i*100+"%"}:{left:(t-this.bV.min)/i*100+"%",transform:"translateX(-50%)"}},D=L,S.prototype.render=function(){var t=y("div");t.className="".concat(this.MU.prefixCls,"-rail"),this.Wc.appendChild(t),this.yV.render(),this.MV.render(),this.wV.render(),this.endHandle&&this.endHandle.render(),this.CV.render(),this.CV.maxWidth&&this.MU.direction===r.LayoutDirection.vertical&&(this.Wc.style.paddingRight=this.CV.maxWidth+"px")},S.prototype.calcValueByPosition=function(t,i){var t,t,t=t-this.QV(),t=this.KV(t);return i?t:this.trimAlignValue(t)},S.prototype.trimAlignValue=function(t){return M.isEmpty(t)?a:this.JV(t)},S.prototype.calcOffset=function(){var t;return 100*(l(this.MU.value-this.MU.min,0)/(this.MU.max-this.MU.min))},S.prototype.getKeyboardValueMutator=function(t){var i=this;switch(t.keyCode){case 38:case 39:return function(t){return i.calculateNextValue("increase",t)};case 40:case 37:return function(t){return i.calculateNextValue("decrease",t)};case 35:return function(t){return i.MU.max};case 36:return function(t){return i.MU.min}}},S.prototype.calculateNextValue=function(t,i){var n,e,e,e,n={increase:function t(i,n){return i+n},decrease:function t(i,n){return i-n}},e=Object.keys(this.MU.marks).indexOf(String(i)),e=n[t](e,1),e=Object.keys(this.MU.marks)[e];return this.MU.step?n[t](i,this.MU.step):!M.isEmptyObject(this.MU.marks)&&this.MU.marks[e]?this.MU.marks[e]:i},S.prototype.JV=function(t){var t=isFinite(this.XV(t))?this.XV(t):0;return this.MU.step===a?t:parseFloat(t.toFixed(this.qV()))},S.prototype.qV=function(){var t,i;if(c(this.MU.precision)){for(i in t=l(C(this.MU.max),C(this.MU.min),C(this.MU.step)),this.MU.marks)t=l(C(parseFloat(i)),t);this.MU.precision=t}return this.MU.precision},S.prototype.XV=function(i){var t,n,n,n,n,t=Object.keys(this.MU.marks).map(parseFloat);return this.MU.step!==a&&(n=Math.ceil((this.MU.max-this.MU.min)/this.MU.step),n=h((i-this.MU.min)/this.MU.step,n),n=Math.round(n)*this.MU.step+this.MU.min,t.push(h(n,this.MU.max))),n=t.map(function(t){return g(i-t)}),t[n.indexOf(h.apply(void 0,n))]},S.prototype.SV=function(){return{prefixCls:this.MU.prefixCls,className:"".concat(this.MU.prefixCls,"-step"),direction:this.MU.direction,marks:this.MU.marks,dots:this.MU.dots,step:this.MU.step,included:this.MU.included,max:this.MU.max,min:this.MU.min}},S.prototype.TV=function(){var n=this;return{className:"".concat(this.MU.prefixCls,"-mark"),onClickLabel:this.MU.disabled?M.noop:function(t,i){n.$V(t,i)},direction:this.MU.direction,marks:this.MU.marks,included:this.MU.included,max:this.MU.max,min:this.MU.min}},S.prototype.$V=function(t,i){},S.prototype.QV=function(){var t=this.Wc.getBoundingClientRect();return this.MU.direction===r.LayoutDirection.vertical?t.top:t.left},S.prototype.tY=function(){var t=this.Wc.getBoundingClientRect();return this.MU.direction===r.LayoutDirection.vertical?t.height:t.width},S.prototype.KV=function(t){var i,n,t,i=this.MU.min,n=this.MU.max,t=g(l(t,0)/this.tY());return(t=this.MU.direction===r.LayoutDirection.vertical?l(1-t,0):t)*(n-i)+i},v=S,A=s.BaseDropdown,e(k,A),k.prototype.setValue=function(t){var i,n,i;this._V.disabled||(this._V.showNumberRange?(c(this.W1e)&&(this.W1e={}),i=t.start,n=t.end,i=parseFloat(i),i=isNaN(i)?this._V.min:(i=l(this._V.min,i),h(this._V.max,i)),this._V.numberRange.start=i,this.W1e.start=i,this.Y1e.setOffset(this.calcOffset(i),i),n=parseFloat(n),n=isNaN(n)?this._V.max:(n=l(this._V.min,n),h(this._V.max,n)),n=l(i,n),this._V.numberRange.end=n,this.W1e.end=n,this.yV.setLength(this.calcRangeOffset(),this.calcOffset(i)),this.Z1e.setOffset(this.calcOffset(n),n)):(i=parseFloat(t),i=isNaN(i)?this._V.min:(i=l(this._V.min,i),h(this._V.max,i)),this._V.value=i,this.DV=this._V.value,this.yV.setLength(this.calcOffset()),this.wV.setOffset(this.calcOffset(),i)))},k.prototype.calcOffset=function(t){var t,t,t=c(t)?this._V.value:t,t=l(t-this._V.min,0)/(this._V.max-this._V.min);return 100*(t=h(t,1))},k.prototype.calcRangeOffset=function(){var t,t,t=this._V.numberRange.end-this._V.numberRange.start,t=l(t,0)/(this._V.max-this._V.min);return 100*(t=h(t,1))},k.prototype.setOptions=function(t){this.init(t)},k.prototype.init=function(t){var t,i,t,n,n;this.nY(t),this.eY(),this.Ti.innerHTML="",(t=y("div")).className="gc-slider-container",this.Ti.appendChild(t),this._V.direction===r.LayoutDirection.vertical?(t.classList.add("".concat(this._V.prefixCls,"-vertical")),t.style.height=this._V.height+"px"):t.style.width=this._V.width+"px",(i=y("div")).className=this.UV(),t.appendChild(i),this.yV=new I(this.iY(),i),this._V.showNumberRange?((t=this.rY()).value=this._V.numberRange.start,n=y("div"),i.appendChild(n),this.Y1e=new d(t,n),t.tabIndex++,t.value=this._V.numberRange.end,n=y("div"),i.appendChild(n),this.Z1e=new d(t,n),this.AV=new v(i,this.yV,this.Y1e,this.Z1e,this.oY())):(this.wV=new d(this.rY(),i),this.AV=new v(i,this.yV,this.wV,a,this.oY())),this.AV.render(),this.aY(i)},k.prototype.aY=function(t){this._V.disabled||(t.addEventListener("mousedown",this.IV),t.addEventListener("pointerdown",this.IV),t.addEventListener("MSPointerDown",this.IV),t.addEventListener("touchstart",this.EV),t.addEventListener("keyup",this.Mme))},k.prototype.Cme=function(t,i){var n,e,n,s,i,o,r,o,r,n=this._V.numberRange,e=n.start,n=n.end,s=g(i-e),i=g(n-i),o=this.Y1e,r=this.Z1e;e===n?(n<t?(this.setValue({start:e,end:t}),this._V.onChange({start:e,end:t})):t<e&&(this.setValue({start:t,end:n}),this._V.onChange({start:t,end:n})),o.isSelectedByMouse(!1),r.isSelectedByMouse(!1)):(o=this.Z1e.isSelectedByMouse(),r=this.Y1e.isSelectedByMouse(),(o&&s<i||i<s&&!r)&&n!==t&&(this.setValue({start:e,end:t}),this._V.onChange({start:e,end:t})),(r&&i<s||s<i&&!o)&&e!==t&&(this.setValue({start:t,end:n}),this._V.onChange({start:t,end:n})))},k.prototype.kV=function(t,i){var n=0,n;return n=this._V.direction===r.LayoutDirection.vertical?this.AV.calcValueByPosition(t.clientY,i):this.AV.calcValueByPosition(t.clientX,i)},k.prototype.uY=function(){var t=function(t){};return{prefixCls:"gc-slider",dots:!1,range:!1,disabled:!1,max:100,min:0,step:1,value:0,direction:r.LayoutDirection.horizontal,included:!0,width:350,height:350,marks:{},tooltipVisible:!1,onChange:t,onAfterChange:t,formatString:"General",showNumberRange:!1,numberRange:{start:0,end:100}}},k.prototype.eY=function(){(M.isEmpty(this._V)||M.isEmptyObject(this._V))&&(this._V={}),this._V=M.extend(this.uY(),this._V)},k.prototype.nY=function(t){var n=this;t&&(c(t.scaleVisible)||(this._V.dots=t.scaleVisible),c(t.direction)||(this._V.direction=t.direction),c(t.formatString)||(this._V.formatString=t.formatString),this.sY(t.min,"min"),this.sY(t.max,"max"),this.sY(t.step,"step"),this.sY(t.width,"width"),this.sY(t.height,"height"),this._V.step<=0&&(this._V.step=1),this._V.min>this._V.max&&(this._V.max=this._V.min),c(t.tooltipVisible)||(this._V.tooltipVisible=t.tooltipVisible),c(t.showNumberRange)||(this._V.showNumberRange=!!t.showNumberRange),this._V.marks={},t.marks)&&t.marks.forEach(function(t){var t,i,t=parseFloat(t);isNaN(t)||t>=n._V.min&&t<=n._V.max&&(i=new o.Formatter.GeneralFormatter(n._V.formatString),n._V.marks[t]={label:i.format(t)})})},k.prototype.sY=function(t,i){var t;c(t)||(t=parseFloat(t),isNaN(t))||(this._V[i]=t)},k.prototype.iY=function(){return{className:"".concat(this._V.prefixCls,"-track"),included:this._V.included,direction:this._V.direction,offset:0,length:0}},k.prototype.rY=function(){return{prefixCls:this._V.prefixCls,className:"".concat(this._V.prefixCls,"-handle"),direction:this._V.direction,disabled:this._V.disabled,min:this._V.min,max:this._V.max,value:this._V.value,offset:0,tabIndex:0,tooltipVisible:this._V.tooltipVisible,formatString:this._V.formatString,showNumberRange:this._V.showNumberRange,numberRange:this._V.numberRange}},k.prototype.oY=function(){return{prefixCls:this._V.prefixCls,min:this._V.min,max:this._V.max,value:this._V.value,disabled:this._V.disabled,direction:this._V.direction,dots:this._V.dots,step:this._V.step,included:this._V.included,marks:this._V.marks,showNumberRange:this._V.showNumberRange}},k.prototype.UV=function(){var t="".concat(this._V.prefixCls);return this._V.direction===r.LayoutDirection.vertical&&(t+="  ".concat(this._V.prefixCls,"-vertical")),M.isEmptyObject(this._V.marks)||(t+=" ".concat(this._V.prefixCls,"-with-marks")),this._V.disabled&&(t+=" ".concat(this._V.prefixCls,"-disabled")),t},k.prototype.dispose=function(){var t=this.yV.Wc;t&&(t.removeEventListener("mousedown",this.IV),t.removeEventListener("pointerdown",this.IV),t.removeEventListener("MSPointerDown",this.IV),t.removeEventListener("touchstart",this.EV),t.removeEventListener("keyup",this.Mme)),this.yV.Wc=a,this.wV&&this.wV.dispose(),this.wV=a,this.Y1e&&this.Y1e.dispose(),this.Y1e=a,this.Z1e&&this.Z1e.dispose(),this.Z1e=a,A.prototype.dispose.call(this)},i.Slider=k},"./dist/plugins/celltype/editor/timepicker.js":function(t,i,n){var e,s,o,r,c,u,a,l,h;function g(t,i){var t=h.call(this,t)||this;return t.Hc(),t.setOptions(i),t}e=this&&this.__extends||(l=function(t,i){return(l=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}l(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.TimePicker=void 0,s=n("./dist/plugins/celltype/editor/listControl.js"),o=n("./dist/plugins/celltype/editor/baseControl.js"),r="undefined",c=n("Common"),u=c.Common.lt.ht,h=o.BaseDropdown,e(g,h),g.prototype.setOptions=function(t){var i,i,i,i;t&&(null!==(i=this.cY(t.min))&&(this.MU.min=i),null!==(i=this.cY(t.max))&&(this.MU.max=i),null!==(i=this.cY(t.step))&&(this.MU.step=i),u(t.formatString)||(this.MU.formatString=t.formatString),u(t.height)||(i=parseInt(t.height,10),isNaN(i))||(this.MU.height=i),this.MU.height=Math.max(1,this.MU.height)),this._6()},g.prototype.setValue=function(t){void 0!==t&&(this.Bz={hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()},this.fY=t,this.yz(),this.scrollToSelect())},g.prototype.scrollToSelect=function(){var t,t,t=this.gz.querySelector(".selected");null!==t&&(t=t.offsetTop,this.Wc.scrollTop=t)},g.prototype.Hc=function(){var i=this;this.MU={min:{},max:{hour:23,minute:59,second:59},step:{hour:1},formatString:"hh:mm",height:200},this.gz=document.createElement("div"),this.gz.classList.add("gc-time-picker-outer-div"),this.gz.addEventListener("click",function(t){i.pz(t)}),this.Ti.appendChild(this.gz)},g.prototype.cY=function(t){var i,n,n,n,i=null;return u(t)||(i={},u(t.hour)||(n=parseInt(t.hour,10),isNaN(n))||(i.hour=n),u(t.minute)||(n=parseInt(t.minute,10),isNaN(n))||(i.minute=n),u(t.second))||(n=parseInt(t.second,10),isNaN(n))||(i.second=n),i},g.prototype._6=function(){this.gz.innerHTML="",new s.List(this.gz,this.lY()),this.yz()},g.prototype.yz=function(){var t,i,n,e,s,t=this.gz.querySelectorAll(".gc-time-picker-li");if(0<t.length)for(i=0;i<t.length;i++)t[i].classList.remove("selected"),n=+t[i].getAttribute("hour"),e=+t[i].getAttribute("minute"),s=+t[i].getAttribute("second"),this.hY(this.Bz,{hour:n,minute:e,second:s})&&t[i].classList.add("selected")},g.prototype.lY=function(){var s=this;return{items:function(){var t,i,n,e,t=s.dY(),i=document.createElement("div");for(i.classList.add("gc-time-picker-container"),s.Wc=i,s.MU.height<0?i.style.height="auto":i.style.maxHeight=s.MU.height+"px",(n=document.createElement("ul")).classList.add("gc-time-picker-ul"),e=0;e<t.length;e++)n.appendChild(s.vY(t[e]));return 24*t.length>s.MU.height&&0<=s.MU.height?i.style.overflowY="scroll":i.style.overflowY="hidden",i.appendChild(n),i}}},g.prototype.vY=function(t){var i=document.createElement("li");return i.classList.add("gc-time-picker-li"),i.setAttribute("hour",t.hour.toString()),i.setAttribute("minute",t.minute.toString()),i.setAttribute("second",t.second.toString()),i.innerText=this.mY(t),i},g.prototype.dY=function(){for(var t,i,n,t=this.gY(this.MU.min),i=this.gY(this.MU.max),n=[];t<=i;)n.push({hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()}),t=this.pY(t,this.MU.step);return n},g.prototype.pY=function(t,i){return typeof i.hour!=r&&t.setHours(t.getHours()+i.hour),typeof i.minute!=r&&t.setMinutes(t.getMinutes()+i.minute),typeof i.second!=r&&t.setSeconds(t.getSeconds()+i.second),t},g.prototype.mY=function(t){var i,n,t,i=new Date;return i.setHours(t.hour),i.setMinutes(t.minute),i.setSeconds(t.second),(t=(n=new c.Formatter.GeneralFormatter(this.MU.formatString)).format(i))&&""!==t&&null!==t?t:this.bY(i)},g.prototype.bY=function(t){var i,t,n,e,s,i=t.getHours(),t=t.getMinutes(),n,e,s;return(i<12?"AM":"PM")+" "+(0===i||12===i?"12":(i%12).toString())+":"+(t<10?"0"+t.toString():t.toString())},g.prototype.gY=function(t){var i=new Date;return i.setHours(t.hour||0),i.setMinutes(t.minute||0),i.setSeconds(t.second||0),i},g.prototype.hY=function(t,i){return!(!t||!i)&&(t=this.yY(t),i=this.yY(i),t.hour===i.hour)&&t.minute===i.minute&&t.second===i.second},g.prototype.yY=function(t){return{hour:t.hour||0,minute:t.minute||0,second:t.second||0}},g.prototype.pz=function(t){var t,i,n,t,e,s,s,t=t.target;t&&(i=+t.getAttribute("hour"),n=+t.getAttribute("minute"),t=+t.getAttribute("second"),(e=this.fY||new Date).setHours(i),e.setMinutes(n),e.setSeconds(t),e.setMilliseconds(0),s=(new c.Common.CultureInfo).DateTimeFormat,s=new c.Formatter.GeneralFormatter(s.defaultDatePattern).format(e),this.fire(o.BaseDropdown.Event_ValueChanged,{value:e,text:s}),this.Bz={hour:i,minute:n,second:t},this.yz())},i.TimePicker=g},"./dist/plugins/celltype/editor/workflowPicker.js":function(t,i,n){var e,s,o,n,u,r,c,a;function l(t,i){var n=a.call(this,t)||this;return n.wY=new o.List(t),n.wY.on(s.BaseDropdown.Event_ValueChanged,function(t){n.fire(s.BaseDropdown.Event_ValueChanged,t)}),n.setOptions(i),n}function h(t,i){var e,s,o,n,r,c,e={items:[]},s=t.items,o=s.filter(function(t){return t.value===i})[0];if(u(o)&&s&&0<s.length)(n=e.items).push({text:s[0].value,value:s[0].value});else if(o&&o.transitions&&0<o.transitions.length)for(r=function(t){var i,t,n,i=o.transitions[t];"number"==typeof i&&s[i]&&(i=s[i].value),(t=s.filter(function(t){return t.value===i})[0])&&(n=e.items).push({text:t.value,value:t.value})},c=0;c<o.transitions.length;c++)r(c);return e}e=this&&this.__extends||(c=function(t,i){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}c(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.WorkFlow=void 0,s=n("./dist/plugins/celltype/editor/baseControl.js"),o=n("./dist/plugins/celltype/editor/listControl.js"),n=n("Common"),u=n.Common.lt.ht,a=s.BaseDropdown,e(l,a),l.prototype.setOptions=function(t){this.MU=t},l.prototype.setValue=function(t){var t;this.MU&&(t=h(this.MU,t),this.wY.setOptions(t))},l.prototype.updateStyle=function(t,i,n){this.wY.updateStyle(t,i,n)},i.WorkFlow=l},"./dist/plugins/celltype/hyperlinkcelltype.js":function(G,t,i){var n,e,b,i,N,i,s,v,o,c,y,j,r,u,a,A,d,C,l,h,g,M,I,z,f,D,w,m,U,E,T,B,Q,p,R,x,L,S,e,k;function P(t,i){t.removeChild(i)}function O(){var t,n,t=k.call(this)||this;return t.typeName="8",(n=t)._id=t.MY(),u(x,function(t,i){n["_"+t]=i}),t._onAction=function(t){var i,n,e,t,i,n,i=t&&t.sheet,n=t.row,e=t.col,t=t.sheetArea,i=i.getValue(n,e,t),n=Y(this._target);i&&l(o(i),n)},t}function Y(t){return["_blank","_self","_parent","_top"][t]}function H(t,i,n,e,s,o){var r,c,u,t,r=0,c=0,u=t.width,t=t.height;return r=o=o||0,1===e?r=(u-i)/2:2===e?r=u-i-o:5===e&&(r=(u-i)/2),1===s?c=(t-n)/2:2===s&&(c=t-n),{x:r,y:c}}function W(t,i,n,e){var t,n,t=F(t,n,i),n=t.width;return n+=!0==(1!==i.hAlign&&!v(e))?e:0,t.width=n,t}function V(t,i,n,e,s){var t,n,t=F(t,n,i,e.width),n=H(e,t.width,t.height,i.hAlign,i.vAlign,s);return t.x=n.x,t.y=n.y,t}function J(t,i){var n,t,n=Z(i),t=t-3-n;return 5===i.hAlign&&(t-=n),--t}function X(t,i,n,e){var i,n,i=J(i,n),n=b.q.Gge(t);return 1===n.length&&0===n[0].prefixSpaceCount?A(0,b.q.Wt(n[0].word,e,!0)):i}function F(t,i,n,e){var s,o,r,s=c(i),o,r;return{x:0,y:0,width:5===n.hAlign&&e?X(t,e,n,i):Math.max(0,b.q.Wt(t,i,!0)),height:t.split(/\r\n|\r|\n/).length*s}}function _(t,i,n,e,s,o){var r,c,s,u,a,l,s,r,h,g,M,I,f,N,r=s.sheet,c=r.Dn;if(!v(n)&&(o=o||(s=r.getValue(s.row,s.col,s.sheetArea),v(s))?o:s+""))for(e=n.cellType.An(e,n,r.zoom()),o=o.replace(/\s+/g," "),u=n&&n.font?n.font:c.Nn(),u=c._n(u),a=[o],l=Z(n),!n.wordWrap&&5!==n.hAlign||(s=e.width-3-l,5===n.hAlign&&(s-=l),o=(a=b.q.un(o,s,u)).join("\r\n")),r=V(o,n,u,e,l),h=e.y+r.y,g=0;g<a.length;g++)if(M=V(a[g],n,u,e,l),I=e.x+M.x,f=d(I+M.width,e.x+e.width),h=d((N=h)+M.height,e.y+e.height),I<=t&&t<f&&N<=i&&i<h)return!0;return!1}function Z(t){return 8*(t.textIndent||0)}function K(t,i,n,e,s){var o,e,r,r,c,n,r,u,a,l,h,g,M,I,f,r,o=e&&e.sheet;if(o){if(r=o.Dn,c=i.font||r.Nn(),1<n&&(c=r._n(c)),n=Z(i),i.wordWrap||s){if(i.wordWrap){if(r=e.row,u=e.col,a=e.sheetArea,l=0,h=o.Ut.findSpan(r,u,a)){if(h.row>=r&&h.rowCount<=1&&h.col>=u&&u===h.col&&(l=o.nn(u,a),1<h.colCount))for(g=u+1;g<u+h.colCount;g++)l+=o.nn(g,a)}else l=o.nn(u,a);if(e=N(i,1),0<(r=N(i,3))&&(l-=r),0<e&&(l-=e),M=b.q.un(t,l-3-n,c),s&&1<t.split(/\r\n|\r|\n/).length){for(f=I=0;f<M.length;f++)I=Math.max(I,W(M[f],i,c,Z(i)).width);return I}s||(t=M.join("\r\n"))}}else t=t.replace(/\s+/g," ");return r=W(t,i,c,Z(i)),s?r.width:r.height}return 0}n=this&&this.__extends||(S=function(t,i){return(S=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}S(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.HyperLink=t.HyperLinkTargetType=void 0,e=i("Common"),i=(b=i("Core")).CellTypes.Context,N=i.gn,i=b.CellTypes.Base,s=b.mt.En,v=e.Common.lt.ht,o=e.Common.zf.TY,c=b.mt.vt,y=b.mt.Tt,j=y.mozilla,r=b.GC$,u=r.each,a=null,A=Math.max,d=Math.min,C=Math.floor,l=window.open,h="position",g="absolute",M="margin",I="font",z="left",f="top",D="padding",w="border",m="box-sizing",U="background-color",E="content-box",T="default",B="white",Q="div",p="hyperlinkInfo",(e=R=t.HyperLinkTargetType||(t.HyperLinkTargetType={}))[e.blank=0]="blank",e[e.self=1]="self",e[e.parent=2]="parent",e[e.top=3]="top",x={linkColor:"#0066cc",visitedLinkColor:"#3399ff",text:"",linkToolTip:"",target:0,activeOnClick:!0},n(O,k=i),O.prototype.MY=function(){var t,i;return v(this._id)&&(this._id="0"),i="id_"+(t=parseInt(this._id,10)),this._id=++t+"",i},O.prototype.AY=function(t,i,n,e,s,o,r,c,u,a){var l,h,g,M,l,I,f,g,N,d,D,c,v,o,w,b,A,h=1,g=z,M=r.hAlign,l=r.vAlign,I=c.lineHeight,f=u.length;if(h+=i,1===M?(h=s/2,g="center"):2===M&&(h=s-1,h-=i,g="right"),t.textAlign!==g&&(t.textAlign=g),g=1,N="alphabetic",g+=I-(c=I/2-(d=parseInt(c.fontInfo.fontSize,10))/2+(D=8<d?C((d-8)/5+2):1)-1),1===l?I<o&&(g=j?(o-a)/2+1:y.msie?(o-a)/2+.5:(o-a)/2,C(g)!==g&&(g+=.5),g+=I/2-c):2===l&&(g=o-a-2.5-c),t.textBaseline!==N&&(t.textBaseline=N),v=e+g,5===M)r.textDecoration=null!=(l=r.textDecoration)?l:1,o=s-3-2*i,k.prototype.Pge.call(this,t,u,n,v,--o,s/2,1+i,I,r,d,D);else for(w=0;w<f;w++)t.fillText(u[w],n+h,v),b=t.measureText(u[w]).width,(A=r.textDecoration)&&this.le(t,A,n+h,v,b,d,D),v+=I},O.prototype.IY=function(t,i,n,e,s,o,r,c,u){var a,l,h,g,M,I,g,f,N,d,D,v,r,c,w,a=r.hAlign,l=r.vAlign,h=c.lineHeight,M=u.length,f=0,N=0,D=0,v=0;for(2!==a&&(D=1),2===r.vAlign&&(v=-2.5),v-=A(0,Math.round(h/9)-1),t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),r=c.fontInfo.fontSize,c=C((r-12)/21+1),t.lineWidth=c,t.beginPath(),w=0;w<M;w++)g=t.measureText(u[w]).width,g=(I=D+n+(d=H(new b.Rect(n,e,s,o),g,h*M,a,l,i)).x)+g,f=v+e+d.y+h,C(f)===f&&(f+=.5),N=f,t.moveTo(I,f),t.lineTo(g,N),t.stroke(),v+=h},O.prototype.paintValue=function(t,i,n,e,s,o,r,c){var u,i,a,l,h,g,M,I,f,N,N,g,M,d,I,f,h,N,D,u=this;if(t&&(i=u.getText(i,c),!v(i))){for(a=(i+="").split(/\r\n|\r|\n/),l=0;l<a.length;)a[l]=a[l].replace(/\s+/g," "),l++;i=a.join("\r\n"),h=!1,g=c.sheet.Ut,M=c.row,I=c.col,f=c.sheetArea,(N=g.getValueForKey(M,I,p,f))&&(u._id===N.id?h=N.visited:g.do("setValueForKey",M,I,p,void 0,f)),t.save(),t.beginPath(),(N=h?u._visitedLinkColor:u._linkColor)&&t.fillStyle!==N&&(t.fillStyle=N),(g=r.font)&&t.font!==g&&b.mt.bt(t,g),M=Z(r),c.sheet.outlineColumn&&c.sheet.outlineColumn.Un(c.col)&&(M=0),I=[],h=f=0,(d=r.wordWrap)||5===r.hAlign?(N=s-3-M,5===r.hAlign&&(N-=M),1<(f=(I=b.q.un(i,--N,g)).length)&&0!==r.vAlign&&(h=(f-1)*(D=c.lineHeight))):I.push(i),t.rect(n,e,s,o),t.clip(),t.beginPath(),u.AY(t,M,n,e,s,o,r,c,I,h),5!==r.hAlign&&u.IY(t,M,n,e,s,o,r,c,I),t.restore()}},O.prototype.getText=function(t,i){var n=this._text||t;return n=(v(n)||""===n)&&i.sheet&&i.sheet.getActualText?i.sheet.getActualText(t,i):n},O.prototype.j3=function(t,i,n,e){var s;t.Ai||(s=t.parent)&&s.j3(t,i,n,e)},O.prototype.getHitInfo=function(t,i,n,e,s){var o,r,o=this;return s&&(r=s.sheetArea,v(r)&&(r=3),n)&&e?{x:t,y:i,row:s.row,col:s.col,cellStyle:n,cellRect:e,sheetArea:r,isFocusAware:!0,sheet:s.sheet,isReservedLocation:_(t,i,n,e,s,o._text)}:a},O.prototype.processMouseDown=function(t){var i=t&&t.sheet,n=this;i&&!i.isEditing()&&t.isReservedLocation&&(n.xY=!0)},O.prototype.processMouseUp=function(t){var i,i,i=t&&t.sheet;i&&!i.isEditing()&&(i=this,t.isReservedLocation&&i.xY&&i.NY(t),i.xY=!1)},O.prototype.processMouseMove=function(t){var i,n,e,s,i,i=t.row,n=t.col,e=t.sheet,s=this;!e||e.isEditing()&&e.getActiveRowIndex()===i&&e.getActiveColumnIndex()===n||(i=e.Dg(),t.isReservedLocation?i&&(s.kY(e,t),i.style.cursor="pointer"):(s.DY(e),i&&(i.style.cursor=T)))},O.prototype.processMouseLeave=function(t){var t,i,i,t=t.sheet,i=this;i.xY=!1,i.DY(t),t&&(i=t.Dg())&&(i.style.cursor=T)},O.prototype.kY=function(t,i){var n,e,s,n,o,n,i,n=this;n._linkToolTip&&((e=n._Y()).className="gc-spread-hyperlink-celltype-tooltip",(s=r(e)).text(n._linkToolTip),o=(n=t.rt.it()).left+i.x,n=n.top+i.y+20,0===s.parent().length)&&((i=t&&t.qc())&&i.insertBefore(e,a),s.css(f,n).css(z,o))},O.prototype.DY=function(t){var i,t,i=this;i.EY&&((t=t&&t.qc())&&i.EY.parentElement===t&&P(t,i.EY),i.EY=a)},O.prototype._Y=function(){var t,i,t=this;return t.EY||(i=s(Q),r(i).css(h,g).css(M,0).css(D,2).css(w,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(m,E).css(U,B).css(I,"9pt Arial"),t.EY=i),t.EY},O.prototype.isReservedKey=function(t,i){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},O.prototype.processKeyUp=function(t,i){var n,e;return!!i.sheet&&(this.NY(i),!0)},O.prototype.getAutoFitWidth=function(t,i,n,e,s){return K(this._text||t,n,e,s,!0)},O.prototype.getAutoFitHeight=function(t,i,n,e,s){return K(this._text||t,n,e,s)},O.prototype.isImeAware=function(t){return!1},O.prototype.NY=function(t){var i,n,e,s,o,r,i=t&&t.sheet,n=this,e=t.row,s=t.col,o=t.sheetArea,r;n.onClickAction().call(this,t),i.Ut.do("setValueForKey",e,s,p,{id:n._id,visited:!0},o),i.repaint(i.getCellRect(e,s,1===o?-1:a,2===o?-1:a)),n.j3(i,e,s,o)},O.prototype.onClickAction=function(t){return 0===arguments.length?this._onAction:(t&&(this._onAction=t),this)},O.prototype.Je=function(t){var t={linkColor:t.linkColor,visitedLinkColor:t.visitedLinkColor,text:t.text,linkToolTip:t.linkToolTip,target:t.target&&R[t.target],activeOnClick:t.activeOnClick};this.fromJSON(t)},O.prototype.toJSON=function(){var n,e,s,n=this,e={typeName:n.typeName};return u(x,function(t,i){(s=n["_"+t])!==i&&(e[t]=s)}),e},O.prototype.fromJSON=function(n){var e=this;u(x,function(t){var i=n[t];v(i)||(e["_"+t]=i)})},O.prototype.jn=function(t){},O.prototype.Ke=function(){var n,e,s,n=this,s=new O;return u(x,function(t,i){(e=n["_"+t])!==i&&(s["_"+t]=e)}),s._onAction=n._onAction,s},L=O,t.HyperLink=L,u(x,function(i){L.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:(this["_"+i]=t,this)}}),b.CellTypes.ti[8]=L},"./dist/plugins/celltype/radiochecklistcelltype.js":function(b,t,i){var n,Q,i,A,y,R,P,a,it,h,l,g,M,nt,i,e,r,Y,H,v,j,o,W,V,J,c,s,e,i,C,u,I,z,e,e,m,T,p,f,N;function X(t,i){return t.hasOwnProperty(i)}function d(t,i){return t instanceof Date&&i instanceof Date?y(t)===y(i):!M(t)&&!M(i)&&t.toString&&i.toString?t.toString()===i.toString():t===i}function x(t){var i,t,n,e,s,i=["0","0","0","0"];return typeof t===j&&(s=e=void 0,1===(n=(t=t.split(" ",4)).length)?i=[e=t[0],e,e,e]:2===n?i=[e=t[0],s=t[1],e,s]:3===n?(s=t[1],i=[t[0],s,t[2],s]):4===n&&(i=[t[0],t[1],t[2],t[3]])),i}function D(){var t,n,t=m.call(this)||this;return t.typeName="11",t.defaultPadding=5,n=t,r(c,function(t,i){n["_"+t]=i="items"===t?[]:i}),t}function L(){return null!==T&&T.apply(this,arguments)||this}function S(){var t=null!==p&&p.apply(this,arguments)||this;return t.typeName="12",t}function w(){var t,n,t=N.call(this)||this;return t.typeName="13",t.defaultPadding=0,n=t,r(u,function(t,i){n["_"+t]=i="items"===t?[]:i}),n._boxSize=0,delete n.boxSize,t}function k(t,i,n,e,s,o){var r,r,s,r=i.getValue(n,e,o),r=t.wG(r,s),s={cmd:"editCell",sheetName:i.name(),row:n,col:e,newValue:r,autoFormat:!1};i.Qy().execute(s),t.triggerButtonClicked(i,n,e,o)}function F(t,i,n,e,s){var i,o,n,r,c,i=i.zoom(),o=K(t._boxSize,n.font,i),n=st(t,n),r,c=e;return P(n,o)*(c=t._items.length<e?t._items.length:c)+t._itemSpacing.vertical*i*(c-1)}function _(t,i,n,e,s){var o,r,c,i,u,o=i.zoom(),r=K(t._boxSize,n.font,o),c=t.defaultPadding*o,i=et(t,i,n,e,s),u=0;return i.forEach(function(t){u+=t}),u+=s*(r+c)+(s-1)*t._itemSpacing.horizontal*o}function et(t,i,n,e,s){for(var o,r,c,c,u,u,o=[],r=0;r<t._items.length;r++)c=X(t._items[r],H)?t._items[r].text:t._items[r],c=i.Qt(c,n.font),(u=t.jY()).hasMargin&&(c=c+u.paddingLeft+u.paddingRight),u=R(r%s),o[u=t._direction===V.vertical?R(r/e):u]=o[u]===g?c:Math.max(o[u],c);return o}function K(t,i,n){var e=W*n;return"number"==typeof t&&0<=t?e=t*n:"auto"===t&&(e=Y(i)/2),e}function st(t,i){var i,t,i=Y(i.font),t=t.jY();return i=t.hasMargin?i+t.paddingTop+t.paddingBottom:i}function q(t,i,n,e){var n,s,n=O(t)*n,s=n;return 1===t.hAlign?s=(i.width-e)/2:2===t.hAlign&&(s=i.width-n-e),s}function $(t,i,n,e){var n,s,n=2*n,s=n;return 1===t.vAlign?i.height-n>e&&(s=(i.height-e-n)/2+n):2===t.vAlign&&(s=i.height-e-n),s}function tt(t,i,n,e,s){var o,r,c,u;if(t._direction===V.vertical){if(t._isFlowLayout){if(s!==g)for(o=t._items.length;0<o;){if(!(s<(r=F(t,i,n,o,a(t._items.length/o)))))return[o=P(o,1),a(t._items.length/o)];o-=1}return[t._items.length,1]}return[o=P(1,t._maxRowCount),a(t._items.length/o)]}if(t._isFlowLayout){if(e!==g)for(c=t._items.length;0<c;){if(!(e<(u=_(t,i,n,a(t._items.length/c),c))))return c=P(c,1),[a(t._items.length/c),c];c-=1}return[1,t._items.length]}return c=P(1,t._maxColumnCount),[a(t._items.length/c),c]}function O(t){var i=t.textIndent;return 1===t.hAlign||0===i||i===l||i===g?2:8*i}function Z(c,u){for(var t,i,a,l,n,n,t,h,g,M,I,f,N,i,t,d,D,e,s,o,t=u.cellRect.width,i=u.cellRect.height,a=u.sheet,l=a.zoom(),n=a.Z_(u.row,u.col),n=n&&n.font,t=tt(c,a,u.cellStyle,t-1,i),h=t[0],g=t[1],M=et(c,a,u.cellStyle,h,g),I=K(c._boxSize,n,l),f=c.defaultPadding*l,N=P(st(c,u.cellStyle),I),i=_(c,a,u.cellStyle,h,g),t=F(c,a,u.cellStyle,h,g),d=q(u.cellStyle,u.cellRect,l,i),D=$(u.cellStyle,u.cellRect,l,t),e=function(t){var i,i,n,e,s,o,r,n,n,i,i=X(c._items[t],H)?c._items[t].text:c._items[t],i=a.Qt(i,u.cellStyle.font),n=R(t/g),e=t%g;if(c._direction===V.vertical&&(n=t%h,e=R(t/h)),s=new Q.Rect,o=0,(r=M.filter(function(t,i){return i<e})).forEach(function(t){o+=t}),s.x=d+o+e*(I+f+c._itemSpacing.horizontal*l),s.y=D+n*N+c._itemSpacing.vertical*l*n,n=c.jY(),s.width=(c._textAlign!==J.right||n.hasMargin?M[e]:i)+I+f,s.height=N,n=u.x-u.cellRect.x,i=u.y-u.cellRect.y,s&&s.contains(n,i))return{value:{value:X(c._items[t],v)?c._items[t].value:c._items[t]}}},s=0;s<c._items.length;s++)if("object"==typeof(o=e(s)))return o.value}function G(t,i){var n,e,s,n=!1,e=X(t,v)?t.value:t;if(i!==l)if(Array.isArray(i)){for(s=0;s<i.length;s++)if(d(i[s],e)){n=!0;break}}else n=d(i,e);return n}function U(t,i,n,e){var s,o,r,c,u;if(e)return i;for(t===l&&(t=[]),Array.isArray(t)||(t=[t]),s={},n.forEach(function(t){s[X(t,v)?t.value:t]=!0}),o=t.length-1;0<=o;o--)s[t[o]]||t.splice(o,1);if(-1===(c=(r=t.slice()).indexOf(i)))r.push(i);else for(o=r.length-1;0<=o;o--)d(r[o],i)&&r.splice(o,1);return u=[],n.forEach(function(t){-1!==r.indexOf(t.value)&&u.push(t.value)}),u}n=this&&this.__extends||(z=function(t,i){return(z=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}z(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonList=t.CheckBoxList=t.RadioButtonList=t.SelectionMode=t.TextAlign=t.Direction=void 0,Q=i("Core"),i=i("Common"),A=i.Common.lt.tv,y=i.Common.ct.o0,R=Math.floor,P=Math.max,a=Math.ceil,it="left",h="alphabetic",l=null,g=void 0,M=i.Common.lt.ht,nt=Q.mt.bt,i=Q.CellTypes.Base,e=Q.GC$,r=e.each,Y=Q.mt.vt,H="text",v="value",j="string",o="number",W=12,(e=V=t.Direction||(t.Direction={}))[e.horizontal=0]="horizontal",e[e.vertical=1]="vertical",(e=J=t.TextAlign||(t.TextAlign={}))[e.left=2]="left",e[e.right=3]="right",c={items:l,direction:V.horizontal,maxColumnCount:1,maxRowCount:1,isFlowLayout:!0,itemSpacing:{horizontal:20,vertical:5},textAlign:J.right,boxSize:W},n(D,m=i),D.prototype.paintValue=function(t,i,n,e,s,o,r,c){var u,a,G,l,h,g,M,I,f,N,d,D,g,v,w,b,A,y,j,C,z,M,m,T,U,p,x,L,S,k,O,Z,Z,E,B,u=this;if(t){for(t.save(),t.rect(n+1,e+1,s-2,o-2),t.clip(),t.beginPath(),G=a=0,h=(l=c.sheet).zoom(),g=r.font,M=c.isPrinting,I=c.printZoomFactor,f=K(u._boxSize,g,h=M&&"number"==typeof I&&1!==I?I:h),N=u.defaultPadding*h,d=f/2,D=new Q.Rect(n+1,e+1,s-2,o-2),b=_(u,l,r,v=(g=tt(u,l,r,s-2,o-2))[0],w=g[1]),A=F(u,l,r,v,w),y=et(u,l,r,v,w),j=st(u,r),C=n+q(r,D,h,b),z=e+$(r,D,h,A),(M=r.font)&&t.font!==M&&nt(t,c.fontInfo.font),r.foreColor&&(t.fillStyle=r.foreColor),m=r.textDecoration,U=8<(T=c.fontInfo.fontSize)?R((T-8)/5+2):1,p=0,p=(G=Y(r.font))/2-T/2+U-1,x=C,L=z,k=S=0,f<T&&(S=u.OY(f),k=(j-p-W)/2+1),O=0;O<u._items.length;O++)n+s<C||e+o<z||(Z=X(u._items[O],H)?u._items[O].text:u._items[O],a=l.Qt(Z,r.font),t.textAlign=it,Z=u._direction===V.vertical?y[R(O/v)]:y[O%w],E=0,E=u._textAlign===J.left?(u.RY(t,u._items[O],i,a,C,z+S,Z,j,p),C=C+Z+N,t.save(),u.BY(t,i,u._items[O],C,z+k,d),t.restore(),f):(t.save(),u.BY(t,i,u._items[O],C,z+k,d),C=C+f+N,t.restore(),u.RY(t,u._items[O],i,a,C,z+S,Z,j,p),Z),m&&(B=this.jY(),u.le(t,m,C-(u._textAlign===J.right?0:Z+N)+B.paddingLeft,z+j-p-B.paddingBottom,a,T,U)),u._direction===V.vertical?(z+=P(j,f)+u._itemSpacing.vertical*h,(O+1)%v==0&&(x=x+Z+f+N+u._itemSpacing.horizontal*h,z=e+$(r,D,h,A)),C=x):(C=C+E+u._itemSpacing.horizontal*h,(O+1)%w==0&&(C=n+q(r,D,h,b),L=L+P(j,f)+u._itemSpacing.vertical*h),z=L));t.restore()}},D.prototype.OY=function(t){return(t-W)/2},D.prototype.getText=function(t,i){return t},D.prototype.RY=function(t,i,n,e,s,o,r,c,u){var i=X(i,H)?i.text:i;t.textBaseline!==h&&(t.textBaseline=h),t.fillText(i,s,o+c-u)},D.prototype.getItemsBound=function(c,t,i,n){var u,a,l,e,s,o,r,h,t,i,n,g,M,I,f,N,d,t,i,D,v,w,b,A,u=this,a=c.zoom(),l=c.getActualStyle(t,i,n),e,s=Q.W.V("11pt "+c.currentTheme().bodyFont(),a);for(l.font&&(s=Q.W.Lge(l,a)),l.font=s.font,t=(h=c.getCellRect(t,i,o=1===n?-1:void 0,r=2===n?-1:void 0)).width,i=h.height,n=tt(u,c,l,t-1,i),g=n[0],M=n[1],I=et(u,c,l,g,M),f=K(u._boxSize,s.font,a),N=u.defaultPadding*a,d=P(st(u,l),f),t=_(u,c,l,g,M),i=F(u,c,l,g,M),D=q(l,h,a,t),v=$(l,h,a,i),w=[],b=function(t){var i,i,n,e,s,o,r,n,i=X(u._items[t],H)?u._items[t].text:u._items[t],i=c.Qt(i,l.font),n=R(t/M),e=t%M;u._direction===V.vertical&&(n=t%g,e=R(t/g)),s=new Q.Rect,o=0,(r=I.filter(function(t,i){return i<e})).forEach(function(t){o+=t}),s.x=D+o+e*(f+N+u._itemSpacing.horizontal*a)+h.x,s.y=v+n*d+u._itemSpacing.vertical*a*n+h.y,n=u.jY(),s.width=(u._textAlign!==J.right||n.hasMargin?I[e]:i)+f+N,s.height=d,s.x>h.x+h.width||s.y>h.y+h.height?w[t]=null:w[t]=s},A=0;A<u._items.length;A++)b(A);return w},D.prototype.BY=function(t,i,n,e,s,o){},D.prototype.jY=function(){return{hasMargin:!1,paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}},D.prototype.getAutoFitWidth=function(t,i,n,e,s){var s,o,r,c,u,s=s&&s.sheet,o=O(n),r=tt(this,s,n),c,u;return(_(this,s,n,r[0],r[1])+o)/e},D.prototype.getAutoFitHeight=function(t,i,n,e,s){var o,s,r,c,o=s&&s.sheet,s=tt(this,o,n,+o.getColumnWidth(s.col)*e),r,c;return F(this,o,n,s[0],s[1])/e},D.prototype.getHitInfo=function(t,i,n,e,s){var o,r,c,t,i,s,r,s,u,o,c,r,a,o=this;return s&&(r=s.sheetArea,c=s.sheet,e=n.cellType.An(e,n,c.zoom()),M(r)||3===r)&&e?(t={x:t,y:i,row:s.row,col:s.col,cellStyle:n,cellRect:e,sheetArea:r,sheet:c},i=c.zoom(),n.font&&(n.font=Q.W.Lge(n,i).font),u=_(o,c,n,r=(s=tt(o,c,n,e.width-1,e.height-2))[0],s=s[1]),o=F(o,c,n,r,s),c=e.x+q(n,e,i,u),r=e.y+$(n,e,i,o),(a=new Q.Rect(c,r,u,o)).contains(t.x,t.y)&&(t.isReservedLocation=!0),t):l},D.prototype.processMouseDown=function(t){if(!t)return!1;t.isReservedLocation&&(this.pG=!0)},D.prototype.processMouseLeave=function(t){if(m.prototype.processMouseLeave.call(this,t),!t)return!1;this.pG=!1},D.prototype.processMouseUp=function(t){var i,n,e,s,o,r;return!!t&&(n=t.sheet,!!((i=this).pG&&n&&t.isReservedLocation&&(i.pG=!1,e=t.row,s=t.col,o=t.sheetArea,r=Z(i,t))))&&(k(i,n,e,s,r.value,o),!0)},D.prototype.wG=function(t,i){return U(t,i,this._items,!0)},D.prototype.triggerButtonClicked=function(t,i,n,e){var s=t.parent;s&&s.j3(t,i,n,e)},D.prototype.Je=function(t){var t={items:t.items,direction:t.direction&&V[t.direction],maxColumnCount:t.maxColumnCount,maxRowCount:t.maxRowCount,isFlowLayout:t.isFlowLayout,itemSpacing:t.itemSpacing,textAlign:t.textAlign&&J[t.textAlign],boxSize:t.boxSize};this.fromJSON(t)},D.prototype.toJSON=function(){var e,s,o,e=this,s={typeName:e.typeName};return r(c,function(t,i){var n;o=e["_"+t],("items"===t?o&&0<o.length:o!==i)&&(s[t]="object"==typeof o?A(o,!1):o)}),s},D.prototype.fromJSON=function(n){var e=this;r(c,function(t){var i=n[t];M(i)||(e["_"+t]=i)})},n(L,T=s=D),L.prototype.BY=function(t,i,n,e,s,o){var n=X(n,v)?n.value:n;t.beginPath(),t.fillStyle="white",t.arc(e+o,s+o,o,0,2*Math.PI),t.fill(),t.beginPath(),t.strokeStyle="black",t.arc(e+o,s+o,o,0,2*Math.PI),t.stroke(),i!==l&&d(i,n)&&(t.beginPath(),t.strokeStyle="black",t.arc(e+o,s+o,.5*o,0,2*Math.PI),t.fillStyle="black",t.fill(),t.stroke())},t.RadioButtonList=e=L,n(S,p=s),S.prototype.BY=function(t,i,n,e,s,o){t.strokeStyle="black",t.strokeRect(e+.5,s+.5,2*o+.05,2*o+.05),t.fillStyle="white",t.fillRect(e+1,s+1,2*o-1,2*o-1);var n=G(n,i);i!==l&&n&&(t.beginPath(),t.lineWidth=2.5,t.moveTo(e+3,s+o),t.lineTo(e+o,s+2*o-3.5),t.lineTo(e+2*o-1.5,s+3),t.stroke())},S.prototype.wG=function(t,i){return U(t,i,this._items,!1)},t.CheckBoxList=i=S,(f=C=t.SelectionMode||(t.SelectionMode={}))[f.single=0]="single",f[f.multiple=1]="multiple",u={selectedBackColor:"rgb(227,119,0)",selectedForeColor:"white",padding:"5",items:l,itemSpacing:{horizontal:5,vertical:5},selectionMode:C.multiple},n(w,N=s),w.prototype.RY=function(t,i,n,e,s,o,r,c,u){var n,i,a,l,n;t.save(),t.beginPath(),n=G(i,n),i=X(i,H)?i.text:i,a=this._selectedBackColor,l=this._selectedForeColor,n&&(t.fillStyle=a,t.fillRect(s+1,o+1,r-1,c-1),t.fillStyle=l),t.textAlign="center",t.textBaseline!==h&&(t.textBaseline=h),n=this.jY(),t.fillText(i,s+n.paddingLeft+(r-n.paddingLeft-n.paddingRight)/2,o+n.paddingTop+c-n.paddingTop-n.paddingBottom-u),t.restore()},w.prototype.wG=function(t,i){return U(t,i,this._items,this._selectionMode===C.single)},w.prototype.jY=function(){var t,i,n,e,s,t=0,i=0,n=0,e=0;return this._padding&&(s=x(this._padding),t=typeof(t=parseInt(s[0],10))==o&&0<t?t:0,e=typeof(e=parseInt(s[1],10))==o&&0<e?e:0,i=typeof(i=parseInt(s[2],10))==o&&0<i?i:0,n=typeof(n=parseInt(s[3],10))==o&&0<n?n:0),{hasMargin:!0,paddingTop:t,paddingBottom:i,paddingLeft:n,paddingRight:e}},w.prototype.OY=function(t){return 0},w.prototype.toJSON=function(){var e,s,o,e=this,o=N.prototype.toJSON.call(this);return r(u,function(t,i){var n;s=e["_"+t],("items"===t?s&&0<s.length:s!==i)&&(o[t]="object"==typeof s?A(s):s)}),o},w.prototype.fromJSON=function(n){N.prototype.fromJSON.call(this,n);var e=this;r(u,function(t){var i=n[t];M(i)||(e["_"+t]=i)})},I=w,t.ButtonList=I,r(c,function(c){s.prototype[c]=function(t){var i,n,e,s,o,r,r,r,i="_"+c,n=this;if(0===arguments.length)return n[i];if("items"===c){for(e=[],s=0;s<t.length;s++)o=t[s],M(o.text)||M(o.value)?M(o.text)?M(o.value)?M(o)||"object"==typeof o||e.push({text:o,value:o}):(o.text=o.value,e.push(o)):(o.value=o.text,e.push(o)):e.push(o);t=e}if("itemSpacing"===c)r=n[i],n[i]={horizontal:r.horizontal,vertical:r.vertical},M(t.horizontal)||(r=parseInt(t.horizontal,10),isNaN(r))||(n[i].horizontal=r),M(t.vertical)||(r=parseInt(t.vertical,10),isNaN(r))||(n[i].vertical=r);else if("boxSize"===c){if(M(t))return n[i];"number"==typeof t&&0<=t&&(n[i]=t),"auto"===t&&(n[i]=t)}else n[i]=t;return n}}),Q.CellTypes.ti[11]=e,Q.CellTypes.ti[12]=i,r(u,function(c){I.prototype[c]=function(t){var i,n,e,s,o,r,r,r,i="_"+c,n=this;if(0===arguments.length)return n[i];if("items"===c){for(e=[],s=0;s<t.length;s++)o=t[s],M(o.text)||M(o.value)?M(o.text)?M(o.value)?M(o)||"object"==typeof o||e.push({text:o,value:o}):(o.text=o.value,e.push(o)):(o.value=o.text,e.push(o)):e.push(o);t=e}return"itemSpacing"===c?(r=n[i],n[i]={horizontal:r.horizontal,vertical:r.vertical},M(t.horizontal)||(r=parseInt(t.horizontal,10),isNaN(r))||(n[i].horizontal=r),M(t.vertical)||(r=parseInt(t.vertical,10),isNaN(r))||(n[i].vertical=r)):n[i]=t,n}}),Q.CellTypes.ti[13]=I},"./dist/plugins/celltype/rangecelltype.js":function(t,i,n){var e,dt,s,u,Dt,vt,n,wt,bt,At,r,c,e,o,a;function g(t){return t.map(function(t){return{start:t.start,size:t.size}})}function l(){this.FY=0,this.PY=0,this.Sx=0,this.Tx=0}function h(){}function M(t,i,n,e,s){var o,i,o=a.call(this)||this;return o.allowOverflow=!1,o.typeName="16",i=1===arguments.length?new dt.Range(0,0,t.getRowCount(),t.getColumnCount()):new dt.Range(i,n,e,s),t&&i&&(o.GY=(new r).yN(t,i),o.UY=(new c).yN(t,i)),o}function I(t,i,G,n,e,s,U){var o,r,c,u,a,E,l,B,Q,h,g,M,R,I,P,Y,H,f,N,d,W,i,D,V,v,J,X,F,_,K,q,w,$,tt,b,A,y,j,A,it,C,z,m,T,p,x,L,A,T,p,nt,et,st,S,k,ot,rt,ct,ut,at,lt,O,j,p,ht,p,j,Z,gt,Mt,It,ft,Nt,Z;for(void 0===U&&(U=1),o=i.x,r=i.y,c=i.width,u=i.height,a=n.sheet,E=n.sheetArea,l=n.isPrinting,B=n.needTopGridline,Q=n.needLeftGridline,h=[],g=[],M=[],R=!0,I=[],P=a.BO(),Y=s.rowCount,H=s.colCount,f=s.rowSize,N=s.colSize,d=s.cellStyleList,W=s.sparklines,e.HY(G),D=(i=e.zY()).baseRow,V=i.baseCol,J=(v=e.VY).hl,v.cg(new dt.Rect(0,0,c,u)),(X=new dt.Yx(v,v._y(1,3),v.Yy(1,3),3)).JCe.oTe(!0),F=e.YY(!0),r+=1,--u,o+=1,--c,K=_=0,f=f.map(function(t){var i=t.size*u,n=At(i);return 1<=(K+=i-n)&&(n++,K--),{start:At(t.start*u),size:n}}),N=N.map(function(t){var i=t.size*c,n=At(i);return 1<=(_+=i-n)&&(n++,_--),{start:At(t.start*c),size:n}}),q=v.conditionalFormats,w=0;w<Y;w++){for($={row:w+D,y:r,height:u},tt=[],b=0;b<H;b++)if(d[w][b]&&(y=(A=d[w][b]).style,j=A.isSpan,A=A.span,it=!1,C=F[w][b],!j||A)){if(y=y.clone(!0),z=At(o+N[b].start),m=At(r+f[w].start),p=T=void 0,x=j?A.colCount:1,L=j?A.rowCount:1,T=N[b+x]?N[b+x].start:c,A=At(T-N[b].start),p=f[w+L]?f[w+L].start:u,T=At(p-f[w].start),$.y=m,$.height=T,C.formatStyle&&(C.formatStyle.h5(y),y=C.formatStyle),y.v5(J),p=bt,j){for(p={row:w,col:b,x:At(z),y:At(m),width:At(A),height:At(T),rowCount:L,colCount:x},nt={},et={},st=[],k=S=void 0,S=rt=ot=0;S<x-1;S++)ut=(ct=N[b+S])?ct.size:0,ot+=et[S]=ut;for(et[S]=At(A)-ot,k=0;k<L-1;k++)ut=(at=f[w+k])?at.size:0,rt+=nt[k]=ut;for(nt[k]=At(T)-rt,k=0;k<L;k++){for(lt=[],O=0;O<x;O++)d[k+w]&&d[k+w][b+O]&&lt.push(d[k+w][b+O].style);st.push(lt)}p.spanSizeInfo={styleList:st,rowSizes:nt,colSizes:et}}X.PN(w,b,At(z),At(m),At(A),At(T),y,p,B&&0===w,Q&&0===b),(j=y.formatter)&&dt.util.St(j)&&(!(p=a.parent&&a.parent.xO(j))||!(ht=p.getExpression())||(p=(0,vt.evaluateFormula)(a,j.replace("@",JSON.stringify(C.value))))instanceof Dt.CalcError||(C.value=p)),j=null,W[w][b]&&(j=W[w][b].clone())&&(j.ZY=v.name(),j.WY=j.QY(v),j.KY=j.JY(v),j.XY=v),C&&C.value&&"SparklineExValue"===C.value.typeName&&(I.push({value:C.value,x:z,y:m,width:A,height:T,option:n}),it=!0),C.validStyle&&g.push({style:C.validStyle,x:z,y:m,width:A,height:T}),tt.push({col:b+V,x:z,y:m,width:A,height:T}),h.push({data:it?null:C.value,row:w,col:b,x:z,y:m,width:A,height:T,style:y,sparkline:j,baseRow:w+D,baseCol:b+V,conditionalFormats:q,imageLoader:P,cellLayout:{row:w,col:b,x:z,y:m,width:A,height:T}}),y&&y.decoration&&y.decoration.icons&&0<y.decoration.icons.length&&M.push({style:y,x:z,y:m,width:A,height:T})}0<tt.length&&v.Dn.mfe(M,tt,$,l,a,E)}for(t.save(),B&&(r-=2,u+=4),Q&&(o-=2,c+=4),t.rect(o,r,c,u),t.clip(),0<h.length&&v.Dn.eO(t,h,E,l,1,a,D,V,U),X.paint(t),0<g.length&&v.Dn.EO(t,g),0<M.length&&v.Dn.que(t,M,{isPrinting:l,printZoomFactor:1,sheet:a,imageLoader:P}),t.restore(),w=0;w<I.length;w++)gt=(Z=I[w]).value,Mt=Z.x,It=Z.y,ft=Z.width,Nt=Z.height,Z=Z.option,wt.dn(t,gt,Mt,It,ft,Nt,Z)}e=this&&this.__extends||(o=function(t,i){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}o(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.paintRangeTemplate=i.RangeTemplate=i.qY=i.$Y=void 0,dt=n("Core"),s=n("Bindings"),u=n("Sparkline"),Dt=n("CalcEngine"),vt=n("SheetsCalc"),n=dt.CellTypes.Base,wt=dt.CellTypes.Context,bt=null,At=Math.floor,l.prototype.yN=function(t,i){var n=this,e=i.row,s=i.col,o=i.rowCount,r=i.colCount;return n.FY=e,n.PY=s,n.Sx=o,n.Tx=r,n.TP=n.ZF(t,i),n.tZ=n.nZ(t,i),n},l.prototype.eZ=function(){return this.tZ},l.prototype.nZ=function(t,i){for(var n,e,s,o,r,c,u,a,l,h,g,M,I,f,e,s,N,d,D,n=this,e=i.row,s=i.col,o=i.rowCount,r=i.colCount,c=0,u=[],a=0,l=[],h=0,g=e+o,M=s+r,I=e;I<g;I++)h=t.getRowHeight(I),a+=h,l.push(h);for(f=s;f<M;f++)h=t.getColumnWidth(f),c+=h,u.push(h);return h=0,e=l.map(function(t){var i=h/a,n;return h+=t,{start:i,size:t/a}}),h=0,s=u.map(function(t){var i=h/c,n;return h+=t,{start:i,size:t/c}}),N=n.ZF(t,i),{rowCount:o,colCount:r,rowSize:e,colSize:s,cellStyleList:d=n.iZ(t,i,N,e,s),sparklines:D=n.rZ(t,i),totalHeight:a,totalWidth:c}},l.prototype.oZ=function(t,i,n,e,s){for(var o,r,c,u,a,l,h,g,M,o=null,r=0,c=s;r<c.length;r++)if(a=(u=c[r]).rowOffset,l=u.colOffset,h=u.rowCount,g=u.colCount,(M=new dt.Range(a+n,l+e,h,g)).contains(t,i)){o=u;break}return o},l.prototype.aZ=function(t,i,n){for(var e,s,o,e,r,c,u,a,l,h,e=[0,0],s=e[0],o=e[1],e=t.rowOffset,r=t.colOffset,c,u,a=e+t.rowCount,l=r+t.colCount,h=e;h<a;h++)o+=i[h]?i[h].size:0;for(h=r;h<l;h++)s+=n[h]?n[h].size:0;return{width:s,height:o}},l.prototype.iZ=function(t,i,n,e,s){for(var o,r,c,u,a,l,h,g,M,I,o=i.row,r=i.col,c=i.rowCount,u=i.colCount,a=[],l=o;l<o+c;l++){for(h=[],g=r;g<r+u;g++)(M=this.oZ(l,g,o,r,n))&&M.rowOffset+o===l&&M.colOffset+r===g?(I=this.aZ(M,e,s),h.push({style:t.getActualStyle(l,g,3,!0),spanWidth:I.width,spanHeight:I.height,isSpan:!0,span:M})):h.push(M?{style:t.getActualStyle(l,g,3,!0),isSpan:!0}:{style:t.getActualStyle(l,g,3,!0)});a.push(h)}return a},l.prototype.ZF=function(t,i){for(var t,n,e,s,o,r,c,u,a,t=t.Ut.getSpans(),n=[],e=i.row,s=i.col,o=i.rowCount,r=i.colCount,c=0,u=t;c<u.length;c++)(a=u[c]).intersect(e,s,o,r)&&n.push({rowOffset:a.row-e,colOffset:a.col-s,rowCount:a.rowCount,colCount:a.colCount});return n},l.prototype.rZ=function(t,i){for(var n,e,s,o,r,c,u,a,l,n=i.row,e=i.col,s=i.colCount,o=i.rowCount,r=[],c=n;c<n+o;c++){for(u=[],a=e;a<e+s;a++)l=t.getSparkline(c,a),u.push(l?l.clone():null);r.push(u)}return r},l.prototype.toJSON=function(){var t,i,n,e,s,o,r,c,t,u,a,l,h,t=this.eZ(),i=t.rowCount,n=t.colCount,e=t.rowSize,s=t.colSize,o=t.cellStyleList,r=t.sparklines,c=t.totalWidth,t=t.totalHeight,u,a,l,h;return{rowCount:i,colCount:n,rowSize:g(e),colSize:g(s),cellStyleList:o.map(function(t){return t.map(function(t){var i,n,e,s,t;return t?(i=t.style,n=t.spanWidth,e=t.spanHeight,s=t.isSpan,t=t.span,{style:i.toJSON(),spanWidth:n,spanHeight:e,isSpan:s,span:t}):null})}),sparklines:r.map(function(t){return t.map(function(t){if(t)return{sparklineType:t.sparklineType(),sp:t.toJSON(),setting:t.setting().toJSON()}})}),totalWidth:c,totalHeight:t}},l.prototype.fromJSON=function(t){var i,n,e,s,o,r,c,t,e,s,o,r;t&&(i=t.rowCount,n=t.colCount,e=t.rowSize,s=t.colSize,o=t.cellStyleList,r=t.sparklines,c=t.totalWidth,t=t.totalHeight,e=g(e),s=g(s),o=o.map(function(t){return t.map(function(t){var i,n,e,s,t,o;return t?(i=t.style,n=t.spanWidth,e=t.spanHeight,s=t.isSpan,t=t.span,o=null,i&&(o=new dt.Style).fromJSON(i),{style:o,spanWidth:n,spanHeight:e,span:t,isSpan:s}):null})}),r=r.map(function(t){return t.map(function(t){var i,n;if(t&&u.SparklineSetting)return i=new u.Sparkline,n=new u.SparklineSetting(t.setting),i.fromJSON(t.sp),i.setting(n),i.sparklineType(t.sparklineType),i})}),this.tZ={rowCount:i,colCount:n,rowSize:e,colSize:s,cellStyleList:o,sparklines:r,totalWidth:c,totalHeight:t})},l.prototype.L0=function(){this.tZ=null},r=l,i.$Y=r,h.prototype.yN=function(t,i,n){var e=this;return e.Z5=i,e.VY=new dt.Worksheet,e.uZ=t.parent&&t.parent.options.allowDynamicArray,e.VY.getCalcService&&(e.VY.getCalcService().allowDynamicArray=e.uZ,e.sZ=e.cZ(t)),e.fZ(t,n),e},h.prototype.cZ=function(t){for(var i,n,e,s,o,r,c,u,a,l,h,g,M,I,h,i=this.Z5,n=i.row,e=i.col,s=i.colCount,o=i.rowCount,r=[],c=t.b3&&t.b3(),u=n;u<n+o;u++)for(a=e;a<e+s;a++)(l=t.getFormula(u,a))&&(h=c&&c.sT(u,a))&&h.isDynamicArray&&(g=h.row,M=h.col,I=h.rowCount,h=h.colCount,1<I&&r.push({row:g+1,col:M,rowCount:I-1,colCount:h}),1<h)&&r.push({row:g,col:M+1,rowCount:1,colCount:h-1});return r},h.prototype.lZ=function(){var t,i,n,e,s,o,r,c,u,o,t,i=this.sZ,n=this.VY;if(i)for(e=0,s=i;e<s.length;e++)r=(o=s[e]).row,c=o.col,u=o.rowCount,o=o.colCount,n.clear(r,c,u,o,3,1)},h.prototype.HY=function(t){var i,t;s.CellBindingSource&&((i=this.VY).suspendEvent(),t=new s.CellBindingSource(t),this.lZ(),i.setDataSource(t),i.resumeEvent())},h.prototype.fZ=function(t,i){var n,e,t,n,e=this.VY,t=t.toJSON({includeBindingSource:!0,ignoreFormula:!!i});delete t.charts,delete t.shapes,e.suspendCalcService(),e.fromJSON(JSON.parse(JSON.stringify(t))),e.resumeCalcService(),this.hZ()},h.prototype.hZ=function(){for(var t,i,n,e,s,o,r,c,u,a,l,t=this,i=t.Z5,n=i.row,e=i.col,s=i.colCount,o=i.rowCount,r=[],c=[],u=[],a=n;a<n+o;a++){for(u=[],l=e;l<e+s;l++)u.push(t.dZ(a,l,3));c.push(u)}this.vZ=c},h.prototype.zY=function(){var t=this.Z5,i,n;return{baseRow:t.row,baseCol:t.col}},h.prototype.YY=function(t){for(var i,n,e,s,o,r,c,u,a,l,h,g,M,I,f,N,i=this.VY,n=this.Z5,e=n.row,s=n.col,o=n.colCount,r=n.rowCount,c=[],u=e;u<e+r;u++){for(a=[],h=l=void 0,g=s;g<s+o;g++)M=i.getText(u,g),I=i.getValue(u,g,3,1),f=i.Jt.$t(u,g,3,1),N=i.getBindingPath(u,g),l=this.mZ(u,g,3),h=this.gZ(i,u,g,I,t),a.push({value:f,formatStyle:l,text:M,validStyle:h,bindingPath:N});c.push(a)}return c},h.prototype.dZ=function(t,i,n){var e,t,e;return this.VY.b8&&(t=this.VY.getDataValidator(t,i,n))?t.highlightStyle():null},h.prototype.gZ=function(t,i,n,e,s){var s,t,e;return s&&t.isValid&&!t.isValid(i,n,e)?(t=(s=this.Z5).row,e=s.col,this.vZ[i-t][n-e]):null},h.prototype.mZ=function(t,i,n){var e=this.VY.conditionalFormats;return e?e.bL(new dt.Style,t,i,n):null},h.prototype.getCellValueInfo=function(t){for(var i,n,e,s,o,r,c,u,a,l,i=this.Z5,n=i.row,e=i.col,s=i.colCount,o=i.rowCount,r=[],c=t.Ut,u=n;u<n+o;u++){for(a=[],l=e;l<e+s;l++)a.push({bindPath:t.getBindingPath(u,l),formula:t.getFormula(u,l),value:c.getValue(u,l,3,bt,1)});r.push(a)}return r},h.prototype.setValueToDataStruct=function(t,i,n,e){e[t]||(e[t]={}),e[t][i]=n},h.prototype.toJSON=function(){var t,i,n,e,s,o,r,c,t=this.VY,i=this.uZ,n=this.sZ.map(function(t){var i,n,e,s;return{row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount}}),e=this.Z5,s,o,r,c;return{spillRanges:n,allowDynamicArray:i,range:{row:e.row,col:e.col,rowCount:e.rowCount,colCount:e.colCount},templatejson:JSON.stringify(t.toJSON({includeBindingSource:!0}))}},h.prototype.fromJSON=function(t){var i,n,t,e,s,o,t;t&&((n=(i=this).VY=new dt.Worksheet).suspendCalcService&&n.suspendCalcService(),i.sZ=t.spillRanges||t.spillRangs,i.uZ=t.allowDynamicArray,n.getCalcService&&(n.getCalcService().allowDynamicArray=i.uZ),n.fromJSON(JSON.parse(t.templatejson)),i.lZ(),e=(t=t.range).row,s=t.col,o=t.rowCount,t=t.colCount,i.Z5=new dt.Range(e,s,o,t),this.hZ(),n.resumeCalcService)&&n.resumeCalcService()},h.prototype.L0=function(){this.VY.L0(),this.VY=null,this.Z5=null},c=h,i.qY=c,e(M,a=n),M.prototype.getAutoFitWidth=function(){return this.GY.tZ.totalWidth},M.prototype.getAutoFitHeight=function(){return this.GY.tZ.totalHeight},M.prototype.updateTemplate=function(t,i){t&&i&&(this.GY.yN(t,i),this.UY.yN(t,i))},M.prototype.paintContent=function(t,i,n,e,s,o,r,c){var u,a,a,u=this.UY,a=this.GY;u&&a&&(a=this.GY.eZ(),r.cellPadding&&(c.needTopGridline=!0,c.needLeftGridline=!0),I(t,{x:n,y:e,width:s,height:o},i,c,u,a))},M.prototype.toJSON=function(){return{typeName:this.typeName,layout:this.GY.toJSON(),resolver:this.UY.toJSON()}},M.prototype.fromJSON=function(t){t.layout&&(this.GY=new r,this.GY.fromJSON(t.layout)),t.resolver&&(this.UY=new c,this.UY.fromJSON(t.resolver))},i.RangeTemplate=e=M,dt.CellTypes.ti[16]=e,i.paintRangeTemplate=I},Common:function(t){t.exports=GC.Spread},CalcEngine:function(t){t.exports=GC.Spread.CalcEngine},Core:function(t){t.exports=GC.Spread.Sheets},Bindings:function(t){t.exports=GC.Spread.Sheets.Bindings},SheetsCalc:function(t){t.exports=GC.Spread.Sheets.CalcEngine},Sparkline:function(t){t.exports=GC.Spread.Sheets.Sparklines}},e={},t=s("./dist/plugins/celltype/celltypes.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).CellTypes=t}();
;var GC;!function(){"use strict";var t,o,e;function r(e){var n,n,n=o[e];return void 0!==n||(n=o[e]={exports:{}},t[e].call(n.exports,n,n.exports,r)),n.exports}t={"./dist/plugins/contextMenu/context-menu-dialog.js":function(e,n,t){var o,t,r,a,i,u,c,s,l,m,f;function d(e,n){var e,t,e=f.call(this,e,r(e))||this,t;return e.zX=n,e}o=this&&this.__extends||(m=function(e,n){return(m=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,n){e.__proto__=n}:function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}))(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function t(){this.constructor=e}m(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}),Object.defineProperty(n,"__esModule",{value:!0}),n.ContextMenuViewDialog=void 0,t=t("Core"),r=t.mt.gi,a=t.zc,i=t.GC$,u="gc.command.executed",c="left",s="top",o(d,f=a),d.prototype.VX=function(e,n,t){var o,e,o=this,e=e[0];o.YX&&o.YX.ZX&&o.YX.ZX(e,n,t,o.zX)},d.prototype.rQ=function(e,n,t,o,r){var a,t,a=this,t=a.WX(t,o);a.YX=e,a.VX(t,n,r)},d.prototype.WX=function(e,n){var t,o,t=this,o=t.Xc();return o.css([c,s],[e,n]),o.empty(),f.prototype.$c.call(this),t.aY(),o},d.prototype.QX=function(e){var n,t,o,r,e,n,t=this.Xc();return"block"!==t.css("display")||((o=t.offset()).top+=document.body.clientTop||0,o.left+=document.body.clientLeft||0,r=e.x,e=e.y,r<o.left)||r>t.width()+o.left||e<o.top||e>t.height()+o.top},d.prototype.aY=function(){var e=this;e.zX.bind(u,function(){e.close()})},d.prototype.KX=function(){var e;this.zX.unbind(u)},d.prototype.close=function(){var e,n,t,t,e=this,n=e.YX;n&&n.DJ&&((t=n.JX)&&t.menuItemData.needKeepFocus||(t=n.DJ.getActiveSheet())&&t.rt&&!t.il&&t.rt.aA(),e.YX.L0()),e.KX(),e.Yc(e.Zc)&&i("#"+e.Zc).remove(),f.prototype.close.call(this)},n.ContextMenuViewDialog=d},"./dist/plugins/contextMenu/context-menu.entry.js":function(e,n,t){var o,r,r,o=this&&this.__createBinding||(Object.create?function(e,n,t,o){void 0===o&&(o=t);var r=Object.getOwnPropertyDescriptor(n,t);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(e,o,r)}:function(e,n,t,o){e[o=void 0===o?t:o]=n[t]}),r=this&&this.__exportStar||function(e,n){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(n,t)||o(n,e,t)};Object.defineProperty(n,"__esModule",{value:!0}),n.XX=void 0,r(t("./dist/plugins/contextMenu/context-menu.js"),n),r(t("./dist/plugins/contextMenu/menu-view.js"),n),r(t("./dist/plugins/contextMenu/context-menu.ns.js"),n),r=t("./dist/plugins/contextMenu/context-menu-dialog.js"),n.XX=r.ContextMenuViewDialog},"./dist/plugins/contextMenu/context-menu.js":function(v,h,e){var x,C,k,A,oe,S,T,m,re,Ce,y,ae,w,n,g,F,t,ie,ue,o,M,O,r,V,R,a,N,U,I,D,L,E,P,j,H,G,_,B,W,K,Z,z,J,q,i,Q,X,Y,$,ee,ne,te,ke,Ae,Se,Te,ye,Fe,Me,Oe,Ve,Re,Ne,Ue,Ie,De,Le,Ee,Pe,je,He,Ge,_e,Be,We,Ke,Ze,ze,Je,u,qe,Qe,Xe,Ye,$e,en,nn,ce,se,tn,on,rn,an,un,cn,sn,ln,mn,fn,dn,pn,vn,hn,xn,wn,gn,bn,Cn,kn,An,Sn,Tn,yn,Fn,Mn,On,Vn,le,me,Rn,Nn,Un,fe,In,Dn,Ln,En,de,Pn,jn,Hn,Gn,_n,Bn,c,Wn,pe,Kn,Zn,zn,Jn,qn,Qn,Xn,f,Yn,$n,et,nt,tt,ot,rt,at,it,ut,ct,st,lt,mt,ve,he,xe,we,ft,dt,pt,vt,ht,xt,wt,gt,bt,Ct,kt,At,St,Tt,yt,Ft,Mt,Ot,Vt,Rt,Nt,ge,Ut,s,It,Dt,l,d,Lt,e,b,Et,Pt,jt;function Ht(e){var n,t;if(e.slicers&&(n=e.slicers.all())&&!Ce(n))for(t in n)if(n[t].isSelected())return 1}function Gt(e,n,t){for(var o,r,a,i,u,o=n===Rt?"rowCount":"colCount",r=0;r<e.length;r++)for(i=-1===(a=e[r])[n]?0:a[n],u=0;u<a[o];u++)t(i+u)}function _t(e,n){for(var t=[],o=-1,r,r=e.row;r<e.row+e.rowCount;r++)!1!==n[r]&&-1===o&&(o=r),!1===n[r]&&-1!==o&&(t.push([o,r-o]),o=-1);return-1!==o&&t.push([o,r-o]),t}function Bt(e,n){var t,t,t,n;if(1===n.colCount&&-1===n.row){if((t=n.col)===e.k9()&&0<=(t=t-1)&&!e.getColumnVisible(t))return!0}else if(1===n.rowCount&&-1===n.col&&(t=n.row)===e.N9()&&0<=(n=t-1)&&!e.getRowVisible(n))return!0}function Wt(e){var n,t,o;if(e.slicers){if(!(n=e.slicers.all())||Ce(n))return null;for(o in t=[],n)n[o].isSelected()&&t.push(n[o]);return t}}function Kt(e,n){var t,n,o,t=n.name,n=n.group;if(!([w+qn,w+Jn,w+c].indexOf(t)<0&&w+c!==n&&t!==d(Ut))){if((o=(0,oe.jf)(e))&&o.NMi&&(w+c===t||w+c===n))return!1;if(t===d(Ut)&&!oe.mt.isEnablePasteSpecial(o))return!1;switch(t){case w+Zn:case w+Wn:case w+Xn:case w+pe:case w+Qn:if(o&&!0===o.ST().ES)return!1}}return!0}function Zt(e,n){var n;return[w+Gn].indexOf(n.name)<0||!(n=(0,oe.jf)(e))||!n.NMi}function zt(e,n){var n;return[w+Pn,w+Hn,w+de,w+jn].indexOf(n.name)<0||!(n=(0,oe.jf)(e))||!n.NMi}function Jt(e,n){var n,e,n=n.name;return[w+Vn,w+an,w+un,w+rn].indexOf(n)<0||!(e=(0,oe.jf)(e))||!e.NMi||n!==w+un&&n!==w+rn}function qt(e,n){var t,n,o,t,e,r,a,i,u,t=[w+fe,w+se,w+nn,w+ce],n=n.name;if(t.indexOf(n)<0)return!0;if(t=(o=(0,oe.jf)(e)).getActiveRowIndex(),e=o.getActiveColumnIndex(),o&&o.comments){if(r=o.comments.get(t,e))return n!==w+fe;if(n!==w+se&&n!==w+nn){if(n===w+fe)return!0;for(a=o.getSelections(),i=0;i<a.length;i++)if(Xt(u=a[i],o))return!0}return!1}}function Qt(e,n){var t,o,r,a,i,u;if(n.comments)for(t=n.comments.all(),r=o=void 0,a=0;a<e.length;a++)for(i=e[a],u=0;u<t.length;u++)if(!t[u].locked()&&(r=t[u].bZ,o=t[u].yZ,r>=i.row)&&r<i.row+i.rowCount&&o>=i.col&&o<i.col+i.colCount)return 1}function Xt(e,n){var t,o,r,a;if(n.comments)for(t=n.comments.all(),r=o=void 0,a=0;a<t.length;a++)if(r=t[a].bZ,o=t[a].yZ,r>=e.row&&r<e.row+e.rowCount&&o>=e.col&&o<e.col+e.colCount)return 1}function Yt(e,n){var n,e,n,e,e;return[w+Nn,w+Un].indexOf(n.name)<0||!((n=(0,oe.jf)(e))&&n.NMi||!(e=n.getSelections())||1!==e.length||(e=uo(n,n=e[0]))&&(e=e.range(),n.row<e.row||n.col<e.col||n.row+n.rowCount>e.row+e.rowCount||n.col+n.colCount>e.col+e.colCount))}function $t(e,n){var n,e;return[w+ve].indexOf(n.name)<0||(e=(n=(0,oe.jf)(e))&&n.ST())&&!e.ES&&e._S&&1===e._S.length&&1===n.getSelections().length&&no(n)}function eo(e,n){var n,e;return[w+he].indexOf(n.name)<0||(e=(n=(0,oe.jf)(e))&&n.ST())&&e.ES&&e._S&&1===e._S.length&&1===n.getSelections().length&&no(n)}function no(e){var n,t,o,r,a,i;if(e.NMi)return!1;if(n=e.getActiveRowIndex(),t=e.getActiveColumnIndex(),!(o=e.ST()).TT)return!1;if(e.tables&&e.tables.find(n,t))return!1;for(r=e.Ut.getSpans(),a=0;a<r.length;a++)if(n>=(i=r[a]).row&&n<i.row+i.rowCount&&t>=i.col&&t<i.col+i.colCount)return!1;return!0}function to(e,n){var e,t,n,o,r,e,a,i,u,i,e=(0,oe.jf)(e),t=[w+ue+ln,w+ue+mn].indexOf(n.name),n=[w+ue+pn,w+ue+fn,w+ue+dn,w+ue+vn,w+ue+hn,w+ue+xn].indexOf(n.name),o=-1<t,r=-1<n;return e&&e.NMi&&(e=e.NMi,o||r)?!(a=e.qNi())||(u=[(i=e.options.menuItemVisibility).promoteMenuItemVisible,i.demoteMenuItemVisible],i=[i.addAboveMenuItemVisible,i.addAfterMenuItemVisible,i.addBeforeMenuItemVisible,i.addBelowMenuItemVisible,i.moveUpMenuItemVisible,i.moveDownMenuItemVisible],a=o&&u[t])||!e.qX()?a:r&&i[n]:!(o||r)}function oo(e,n,t){var e,o,r,a,i,u,c,e,s,l,t,m,e=(0,oe.jf)(e),o=9,r=w+ie,a=[wn,gn].map(function(e){return r+e}).indexOf(n.name),i,u=-1<a,c=-1<ro(9,function(e){return r+bn+(e+1)}).indexOf(n.name);return e&&e.NMi&&(e=e.NMi).qNi()&&(c||u)?(l=[(s=e.options.menuItemVisibility).expandAllLevelMenuItemVisible,s.collapseAllLevelMenuItemVisible],c?(t=t.$X=t.$X||e.MDi()+1,(m=parseInt(n.name.charAt((r+bn).length),10))<=Math.min(9,t)&&s.expandToLevelMenuItemVisible):u&&l[a]):!(c||u)}function ro(e,n){for(var t,o,t=[],o=0;o<e;o++)t.push(n(o,t));return t}function ao(e,n){var e,t,o,r,a,i,u,c,s;if([w+ue+ve,w+ue+he].indexOf(n.name)<0)return!0;if(!(e=(0,oe.jf)(e))||!e.NMi){if(t=e.ST(),o=e.getActiveRowIndex(),r=!1,e.tables)for(a=e.tables.all(),i=0;i<a.length;i++)if(o>=(u=a[i]).Ky&&o<u.Ky+u.Sx){r=!0;break}for(c=e.Ut.getSpans(),i=0;i<c.length;i++)if(o>(s=c[i]).row&&o<s.row+s.rowCount)return!1;if(t.TT&&(!t._S||1===t._S.length)&&1===e.getSelections().length)if(n.name===w+ue+he){if(t.ES&&(r||t._S&&e.getColumnCount()%t._S[0].colCount==0))return!0}else if(n.name===w+ue+ve&&!t.ES&&(r||t._S&&e.getColumnCount()%t._S[0].colCount==0))return!0}return!1}function io(e,n){var e,t,o,r,a,i,u,c,s;if([w+ie+ve,w+ie+he].indexOf(n.name)<0)return!0;if(!(e=(0,oe.jf)(e))||!e.NMi){if(t=e.ST(),o=e.getActiveColumnIndex(),r=!1,e.tables)for(a=e.tables.all(),i=0;i<a.length;i++)if(o>=(u=a[i]).iw&&o<u.iw+u.Tx){r=!0;break}for(c=e.Ut.getSpans(),i=0;i<c.length;i++)if(o>(s=c[i]).col&&o<s.col+s.colCount)return!1;if(t.TT&&(!t._S||1===t._S.length)&&1===e.getSelections().length)if(n.name===w+ie+ve){if(!t.ES&&(r||t._S&&e.getRowCount()%t._S[0].rowCount==0))return!0}else if(n.name===w+ie+he&&t.ES&&(r||t._S&&e.getRowCount()%t._S[0].rowCount==0))return!0}return!1}function uo(e,n){var t,o,r;if(n)for(oe.mt.J0(n,e.getRowCount(),e.getColumnCount()),t=n.row;t<n.row+n.rowCount;t++)for(o=n.col;o<n.col+n.colCount;o++)if(e.tables&&(r=e.tables.find(t,o)))return r;return null}function co(e,n,t,o){for(var r,a,r=0;r<n.length;r++)(a=n[r]).jj(t,o,!0,ge,a.tq())}function so(e){for(var n,t,o,r,n=e,t=0;t<n.length-1;t++)for(o=t+1;o<n.length;o++)n[t].row<n[o].row&&(r=n[t],n[t]=n[o],n[o]=r);return n}function lo(e){for(var n,t,o,r,n=e,t=0;t<n.length-1;t++)for(o=t+1;o<n.length;o++)n[t].col<n[o].col&&(r=n[t],n[t]=n[o],n[o]=r);return n}function mo(e,n,t,o){var r=e.Ut.getSpans(ge,3);0<=n?(vo(e,r,n,o,3),vo(e,e.Ut.getSpans(ge,2),n,o,2)):0<=t&&(fo(e,r,t,o,3),fo(e,e.Ut.getSpans(ge,1),t,o,1))}function fo(e,n,t,o,r){for(var a,i,u,c,s,l,a=0,i=n.length;a<i;a++)if(t>(u=n[a]).col&&t<u.col+u.colCount)for(c=u.row;c<u.row+u.rowCount;c++)if(s=ho(e,c,t,o,r,!0))for(l=t;l<t+o;l++)e.setStyle(c,l,s,r)}function po(e,n){return e.style===n.style&&e.color===n.color}function vo(e,n,t,o,r){for(var a,i,u,c,s,l,a=0,i=n.length;a<i;a++)if(t>(u=n[a]).row&&t<u.row+u.rowCount)for(c=u.col;c<u.col+u.colCount;c++)if(s=ho(e,t,c,o,r,!1))for(l=t;l<t+o;l++)e.setStyle(l,c,s,r)}function ho(e,n,t,o,r,a){var i,u,c,s,l,m,f,d,p,v,l=["borderLeft","borderTop","borderRight","borderBottom","diagonalDown","diagonalUp"];if(a){if(i=e.Z_(n,t-1,r),(u=e.Z_(n,t+o,r))&&i){for(i=i.clone(),m=0,f=l;m<f.length;m++)i[d=f[m]]&&u[d]&&po(i[d],u[d])||(i[d]=void 0);return i}}else if(c=e.Z_(n-1,t,r),s=e.Z_(n+o,t,r),c&&s){for(c=c.clone(),p=0,v=l;p<v.length;p++)c[d=v[p]]&&s[d]&&po(c[d],s[d])||(c[d]=void 0);return c}}function be(e,n,t,o,r,a){var i,u,c,s,l,t,r,i=(0,oe._f)(e,n.sheetName);return!!i&&(u=n.considerAllSheets,c=e.i4(),i.suspendPaint(),s=oe.Commands.TI(i.name()),t?(t=void 0,(t=r?r(i,n):t)&&t.cancel||(u?oe.Commands.NI(c,n):i.Ut.undo(n[s]),a&&a(i,n,t))):(u?oe.Commands.II(c):i.Ut.startTransaction(),l=o(i,n),u?oe.Commands.xI(c,n):n[s]=i.Ut.endTransaction()),i.resumePaint(),u&&(r=(0,oe.jf)(e))&&i!==r&&r.repaint(),l)}function xo(e,n,t){var o;if(0<t){for(o=n+1;o<e.getRowCount();o++)if((t-=e.getRowHeight(o))<=0)return o-n}else if(t<0)for(o=n-1;0<=o;o--)if(0<=(t+=e.getRowHeight(o)))return o-n;return 0}function wo(e,n,t){var o;if(0<t){for(o=n+1;o<e.getColumnCount();o++)if((t-=e.getColumnWidth(o))<=0)return o-n}else if(t<0)for(o=n-1;0<=o;o--)if(0<=(t+=e.getColumnWidth(o)))return o-n;return 0}function go(e,n,t,o,r){var e=(0,oe._f)(e,n.sheetName);e&&t.execute({cmd:_n,sheetName:e.name(),pasteOption:o,pasteSpecialOptions:r})}function bo(o,r,e,a){return be(o,r,e,function(e){var n,t,n=Wt(e);if(n&&0!==n.length){for(t in n)n.hasOwnProperty(t)&&n[t].sortState(a);o.changeSelectionInCommandExecuting(r,null,null,[],n)}})}function Co(e){e.jT(8,b().hideSheetFailureInfo)}function ko(e,n){var t,o,r,t=n.name(),o=e.Ese(t),r={sheetName:t,propertyName:"isVisible",cancel:!1,sheetIndex:o,sheetPosition:e.getSheetPosition(t),oldValue:!1,newValue:!0};if(e.ki(oe.Events.SheetChanging,r),r.cancel)return!1;n.visible(!0),e.ki(oe.Events.SheetChanged,{sheetName:t,propertyName:"isVisible",sheetIndex:o,sheetPosition:e.getSheetPosition(t),oldValue:!1,newValue:!0})}function Ao(e,n,t){var o,o,o={oldSheet:n,newSheet:t,cancel:!1};return e.ki(oe.Events.ActiveSheetChanging,o),!o.cancel&&(o={oldValue:!0,newValue:!1,sheetName:n.name(),propertyName:"isSelected",cancel:!1,sheetIndex:e.Ese(n.name()),sheetPosition:e.getSheetPosition(n.name())},e.ki(oe.Events.SheetChanging,o),!o.cancel)&&(o={oldValue:!1,newValue:!0,sheetName:t.name(),propertyName:"isSelected",cancel:!1,sheetIndex:e.Ese(t.name()),sheetPosition:e.getSheetPosition(t.name())},e.ki(oe.Events.SheetChanging,o),!o.cancel)&&void 0}function So(e,n){var t,n,t=(0,oe.jf)(e);e.ki(oe.Events.ActiveSheetChanged,{oldSheet:n,newSheet:t}),n={oldValue:!0,newValue:!1,sheetName:n.name(),propertyName:"isSelected",sheetIndex:e.Ese(n.name()),sheetPosition:e.getSheetPosition(n.name())},e.ki(oe.Events.SheetChanged,n),n={oldValue:!1,newValue:!0,sheetName:t.name(),propertyName:"isSelected",sheetIndex:e.Ese(t.name()),sheetPosition:e.getSheetPosition(t.name())},e.ki(oe.Events.SheetChanged,n)}function To(e,n,t){var e,o,n,r,a,i,u,e,c,s;if(void 0===t&&(t=!1),0<(e=e.selections).length&&(o=n.NMi,r=(n=e[0]).col,a=n.colCount,e=(u=(i=o.getDataView()).getColumnInfos()).filter(function(e){return!e.isFreeColumn}).length,!(r<0||e<=r||(a=Math.min(a,e-r))<=0))){for(c=r;c<r+a;c++)(s=u[c]).visible=t;try{i.setColumnInfos(u),o.setDataView(i)}catch(e){return!1}}}function yo(e){var e=e.slice(e.lastIndexOf(".")+1);return e===ue+he||e===ue+ve||e===ie+he||e===ie+ve}function Fo(a){var e=function(o,r){return{canUndo:!1,execute:function(e,n,t){go(e,n,a,o,r)}}};a.register(l.pasteFormulaAndNumberFormat,e(oe.ClipboardPasteOptions.formulasAndNumberFormatting),null,!1,!1,!1,!1),a.register(l.pasteKeepSourceFormatting,e(oe.ClipboardPasteOptions.usingSourceTheme),null,!1,!1,!1,!1),a.register(l.pasteNoBorders,e(oe.ClipboardPasteOptions.noBorder),null,!1,!1,!1,!1),a.register(l.pasteColumnWidth,e(oe.ClipboardPasteOptions.allAndColumnWidth),null,!1,!1,!1,!1),a.register(l.pasteTranspose,e(oe.ClipboardPasteOptions.all,{transpose:!0}),null,!1,!1,!1,!1),a.register(l.pasteValueAndNumberFormats,e(oe.ClipboardPasteOptions.valuesAndNumberFormatting),null,!1,!1,!1,!1),a.register(l.pasteValueAndSourceFormats,e(oe.ClipboardPasteOptions.valuesAndSourceFormatting),null,!1,!1,!1,!1),a.register(l.pasteLink,e(oe.ClipboardPasteOptions.all,{pasteLink:!0}),null,!1,!1,!1,!1)}function p(){var e=this;e.menuView=new A.MenuView,e.menuData=e.nq()}x=this&&this.__spreadArray||function(e,n,t){if(t||2===arguments.length)for(var o=0,r=n.length,a;o<r;o++)!a&&o in n||((a=a||Array.prototype.slice.call(n,0,o))[o]=n[o]);return e.concat(a||Array.prototype.slice.call(n))},Object.defineProperty(h,"__esModule",{value:!0}),h.ContextMenu=void 0,C=e("Common"),k=e("./dist/plugins/contextMenu/context-menu-dialog.js"),A=e("./dist/plugins/contextMenu/menu-view.js"),oe=e("Core"),S=e("./dist/plugins/contextMenu/context-menu.ns.js"),T=e("./dist/plugins/contextMenu/menuItems/index.js"),m=oe.GC$,re=C.Common.lt.ht,Ce=C.Common.lt._h,y=oe.mt.vi,n="gc-spread-",g="gc.spread.pivot",F="gc-spread-pivot-selected",t="viewport",ie="colHeader",ue="rowHeader",o="slicer",M="timeline",O="sheetTab",r="corner",V="pivotPageFilter",R="pivotTopLeft",a="pivotHeader",N="pivotEmptyLabel",U="pivotContent",I="pivotGrandTotal",D="FieldName",L="SortType",E="pivotSummarizeValuesBy",P="pivotExpandOrCollapse",j="pivotTableGroup",H="OpenPivotGroupDialog",G="pivotTableUnGroup",_="pivotShowValueAs",B="pivotShowDetails",W="pivotRefresh",K="removeField",Z="pivotTable",z="removePivotGrandTotal",J="openValueFieldSettingDialogCmd",q="pivotSum",i="UpdatePivotValueFieldCmd",Q="pivotCount",X="pivotAverage",Y="pivotMax",$="pivotMin",ee="pivotProduct",ne="pivotNoCalculation",te="pivotGrandtotal",ke="pivotColumnTotal",Ae="pivotRowTotal",Se="pivotOf",Te="pivotParentRowTotal",ye="pivotDifferenceFrom",Fe="pivotPercentDifferenceFro",Me="pivotRunningTotalIn",Oe="pivotPercentRunningTotalIn",Ve="pivotRankSmallestToLargest",Re="pivotOfParentTotal",Ne="pivotParentColumnTotal",Ue="pivotRankLargestToSmallest",Ie="pivotIndex",De="pivotMoreOptions",Le="pivotFilter",Ee="pivotClearFilterFrom",Pe="pivotKeepOnlySelectedItems",je="pivotHideSelectedItems",He="pivotTop10",Ge="pivotLabelFilters",_e="pivotValueFilters",Be="pivotExpand",We="pivotCollapse",Ke="pivotExpandEntireField",Ze="pivotCollapseEntireField",ze="createDialogForValueFilter",Je="createDialogForLabelFilter",u="OpenPivotShowValueAsDialog",qe="filterFieldLabelValue",Qe="ClearCommand",Xe="pivotSort",Ye="createDialogForPivotSort",$e="openPasteSpecialDialog",en="removeSlicer",nn="toggleComment",ce="deleteComment",se="editComment",tn="unhideSheet",on="hideSheet",rn="unhideRows",an="unhideColumns",un="hideRows",cn="pinRows",sn="pinColumns",ln="promote",mn="demote",fn="addAfter",dn="addBefore",pn="addAbove",vn="addBelow",hn="moveUp",xn="moveDown",wn="expandAllLevels",gn="collapseAllLevels",bn="expandLevel",Cn="expandLevel1",kn="expandLevel2",An="expandLevel3",Sn="expandLevel4",Tn="expandLevel5",yn="expandLevel6",Fn="expandLevel7",Mn="expandLevel8",On="expandLevel9",Vn="hideColumns",le="sortAscend",me="sortDescend",Rn="sortMoreOptions",Nn="sort",Un="filter",fe="insertComment",In="deleteSheet",Dn="insertNote",Ln="replyComment",En="insertSheet",de="insertRows",Pn="insertColumns",jn="deleteRows",Hn="deleteColumns",Gn="clearContents",_n="paste",Bn="ganttSheetPaste",c="pasteOptions",Wn="pasteFormatting",pe="pasteValues",Kn="pasteGanttValues",Zn="pasteFormula",zn="pasteAll",Jn="cut",qn="copy",Qn="pasteValuesFormatting",Xn="pasteFormulaFormatting",f="separator",Yn="groupHeader",$n="slicerSortAscend",et="slicerSortDescend",nt="table",tt="tableInsert",ot="tableDelete",rt="tableInsertRowsAbove",at="tableInsertRowsBelow",it="tableInsertColumnsLeft",ut="tableInsertColumnsRight",ct="tableDeleteRows",st="tableDeleteEntireSheetRows",lt="tableInsertEntireSheetRows",mt="tableDeleteColumns",ve="insertCopiedCells",he="insertCutCells",xe="shiftCellsDown",we="shiftCellsRight",ft="allSheets",dt="tableInsertRowsAboveForContextMenu",pt="tableInsertRowsBelowForContextMenu",vt="tableDeleteRowsForContextMenu",ht="tableInsertColumnsLeftForContextMenu",xt="tableInsertColumnsRightForContextMenu",wt="tableDeleteColumnsForContextMenu",gt="GanttRowHeader",bt="GanttField",Ct="insertTask",kt="deleteTask",At="scrollToTask",St="manuallySchedule",Tt="autoSchedule",yt="GanttColumn",Ft="hideGanttColumn",Mt="unHideGanttColumn",Ot="indentGanttTask",Vt="outdentGanttTask",Rt="row",Nt="col",ge=void 0,Ut="pasteSpecial",s=(w="gc.spread.")+"pasteSpecialPasteGroup",It=w+"pasteSpecialPasteValueGroup",Dt=w+"pasteSpecialOtherOptionsGroup",l={pasteFormulaAndNumberFormat:(ae="gc.spread.contextMenu.")+"pasteFormulaAndNumberFormat",pasteKeepSourceFormatting:ae+"pasteKeepSourceFormatting",pasteNoBorders:ae+"pasteNoBorders",pasteColumnWidth:ae+"pasteColumnWidth",pasteTranspose:ae+"pasteTranspose",pasteValueAndNumberFormats:ae+"pasteValueAndNumberFormats",pasteValueAndSourceFormats:ae+"pasteValueAndSourceFormats",pasteLink:ae+"pasteLink"},d=function(e){return w+e},Lt=function(e){return n+e},e=new C.Common.ResourceManager(S.SR,"GanttSheet"),b=e.getResource.bind(e),Et={sheetTab:function(e,n,t){return new RegExp("sheetTab","i").test(t.workArea)&&e.tabStripHitInfo&&e.tabStripHitInfo.sheetTab&&"newSheet"!==e.tabStripHitInfo.sheetTab.sheetName&&"allSheets"!==e.tabStripHitInfo.sheetTab.sheetName},outline:function(e,n,t){return!!(new RegExp("outline","i").test(t.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.outlineHitInfo)},viewport:function(e,n,t){if(new RegExp("viewport","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&!e.worksheetHitInfo.floatingObjectHitInfo&&!e.worksheetHitInfo.shapeHitInfo&&!e.worksheetHitInfo.pivotTableInfo&&!e.worksheetHitInfo.commentHitInfo)return Kt(n,t)&&Zt(n,t)&&qt(n,t)&&Yt(n,t)&&$t(n,t)&&eo(n,t)},rowHeader:function(e,n,t){if(new RegExp("rowHeader","i").test(t.workArea)&&e.worksheetHitInfo&&2===e.worksheetHitInfo.hitTestType)return Kt(n,t)&&Zt(n,t)&&zt(n,t)&&Jt(n,t)&&ao(n,t)&&to(n,t)},colHeader:function(e,n,t){var o,r,r,a,o=e.worksheetHitInfo;if(new RegExp("colHeader","i").test(t.workArea)&&o&&1===o.hitTestType&&(r=(r=(0,oe.jf)(n))&&r.Ut.getFreeAreaRowCount(1),!(a=o.row<r)))return Kt(n,t)&&Zt(n,t)&&zt(n,t)&&Jt(n,t)&&io(n,t)&&oo(n,t,e)},corner:function(e,n,t){if(new RegExp("corner","i").test(t.workArea)&&e.worksheetHitInfo&&0===e.worksheetHitInfo.hitTestType)return Kt(n,t)&&Zt(n,t)&&qt(n,t)&&Yt(n,t)},slicer:function(e,n,t){return new RegExp("slicer","i").test(t.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.shapeHitInfo&&e.worksheetHitInfo.shapeHitInfo.shape&&"Slicer"===e.worksheetHitInfo.shapeHitInfo.shape.drawingType},timeline:function(e,n,t){var t,e,t=new RegExp("timeline","i").test(t.workArea),e=e.worksheetHitInfo&&e.worksheetHitInfo.shapeHitInfo&&e.worksheetHitInfo.shapeHitInfo.shape&&"Timeline"===e.worksheetHitInfo.shapeHitInfo.shape.drawingType;return t&&e},chart:function(e,n,t){return new RegExp("chart","i").test(t.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.floatingObjectHitInfo&&e.worksheetHitInfo.floatingObjectHitInfo.floatingObject&&"2"===e.worksheetHitInfo.floatingObjectHitInfo.floatingObject.typeName},shape:function(e,n,t){return new RegExp("shape","i").test(t.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.shapeHitInfo},table:function(e,n,t){var n=(0,oe.jf)(n),n=n&&n.tables;return new RegExp("table","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&!e.worksheetHitInfo.floatingObjectHitInfo&&!e.worksheetHitInfo.shapeHitInfo&&!e.worksheetHitInfo.pivotTableInfo&&!e.worksheetHitInfo.commentHitInfo&&n&&n.eq()},vpWithoutTb:function(e,n,t){var o,e,r;if(new RegExp("vpWithoutTb","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&!e.worksheetHitInfo.floatingObjectHitInfo&&!e.worksheetHitInfo.shapeHitInfo&&!e.worksheetHitInfo.pivotTableInfo&&!e.worksheetHitInfo.commentHitInfo)return!((e=(0,oe.jf)(n).tables)&&e.eq())&&Kt(n,t)&&Zt(n,t)&&qt(n,t)&&Yt(n,t)},pivotTablePageFilterArea:function(e,n,t){var n=(0,oe.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotPageFilter","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&n&&e.worksheetHitInfo.pivotTableCellInfo&&0===e.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableCornerArea:function(e,n,t){var n=(0,oe.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotTopLeft","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&n&&e.worksheetHitInfo.pivotTableCellInfo&&1===e.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableEmptyLabelArea:function(e,n,t){var n=(0,oe.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotEmptyLabel","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&n&&e.worksheetHitInfo.pivotTableCellInfo&&3===e.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableHeaderArea:function(e,n,t){var n=(0,oe.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotHeader","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&n&&e.worksheetHitInfo.pivotTableCellInfo&&2===e.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableGrandTotalArea:function(e,n,t){var n=(0,oe.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotGrandTotal","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&n&&e.worksheetHitInfo.pivotTableCellInfo&&5===e.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableContentArea:function(e,n,t){var n=(0,oe.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotContent","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&n&&e.worksheetHitInfo.pivotTableCellInfo&&4===e.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTable:function(e,n,t){var n=(0,oe.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotTable","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&n&&e.worksheetHitInfo.pivotTableCellInfo}},Pt=[],p.prototype.nq=function(){var e=b();return x(x([],(0,T.createReportSheetMenuItems)(e),!0),[{text:b().copy,name:w+qn,command:ae+qn,iconClass:n+qn,workArea:t+ie+ue+o+r+Z+M},{text:b().cut,name:w+Jn,command:ae+Jn,iconClass:n+Jn,workArea:t+ie+ue+o+r+M},{text:b().pasteOptions,name:w+c,iconClass:n+c,type:Yn,workArea:t+ie+ue+o+r+M},{command:ae+zn,name:w+zn,iconClass:n+zn,group:w+c,text:b().pasteAll,workArea:t+ie+ue+o+r+M},{command:ae+Zn,name:w+Zn,iconClass:n+Zn,group:w+c,text:b().pasteFormula,workArea:t+ie+ue+r},{command:ae+pe,name:w+pe,iconClass:n+pe,group:w+c,text:b().pasteValues,workArea:t+ie+ue+r},{command:ae+Wn,name:w+Wn,iconClass:n+Wn,group:w+c,text:b().pasteFormatting,workArea:t+ie+ue+r},{command:ae+Qn,name:w+Qn,iconClass:n+Qn,group:w+c,text:b().pasteValuesFormatting,workArea:t+ie+ue+r},{command:ae+Xn,name:w+Xn,iconClass:n+Xn,group:w+c,text:b().pasteFormulaFormatting,workArea:t+ie+ue+r},{text:b().pasteSpecial.title,name:d(Ut),command:$e,workArea:t+ie+ue+r,type:"splitSubMenu",subMenu:[{text:b().paste,name:s,type:"groupHeader"},{command:ae+zn,name:d("pasteSpecial.pasteAll"),iconClass:n+zn,group:s,text:b().pasteAll},{command:ae+Zn,name:d("pasteSpecial.pasteFormula"),iconClass:n+"pasteFormula",group:s,text:b().pasteFormula},{command:l.pasteFormulaAndNumberFormat,name:d("formulaAndNumberFormat"),iconClass:n+"pasteFormulaAndNumberFormat",group:s,text:b().pasteSpecial.formulaAndNumberFormat},{command:l.pasteKeepSourceFormatting,name:d("keepSourceFormatting"),iconClass:n+"pasteKeepSourceFormat",group:s,text:b().pasteSpecial.keepSourceFormatting},{command:l.pasteNoBorders,name:d("noBorders"),iconClass:n+"pasteNoBorders",group:s,text:b().pasteSpecial.noBorders},{command:l.pasteColumnWidth,name:d("keepSourceColumnWidth"),iconClass:n+"pasteColumnWidth",group:s,text:b().pasteSpecial.columnWidth},{command:l.pasteTranspose,name:d("transpose"),iconClass:n+"pasteTranspose",group:s,text:b().pasteSpecial.transpose},{text:b().pasteValues,name:It,type:"groupHeader"},{command:ae+pe,name:d("pasteSpecial.pasteValues"),iconClass:n+"pasteValues",group:It,text:b().pasteValues},{command:l.pasteValueAndNumberFormats,name:d("pasteValueAndNumberFormat"),iconClass:n+"pasteValueAndNumberFormats",group:It,text:b().pasteSpecial.valuesAndNumberFormat},{command:l.pasteValueAndSourceFormats,name:d("pasteValueAndSourceFormat"),iconClass:n+"valueAndSourceFormats",group:It,text:b().pasteSpecial.valueAndSourceFormat},{text:b().pasteSpecial.otherPasteOptions,name:Dt,type:"groupHeader"},{command:ae+Wn,name:d("pasteSpecial.pasteFormatting"),iconClass:n+"pasteValuesFormatting",group:Dt,text:b().pasteFormatting},{command:l.pasteLink,name:d("pasteLink"),iconClass:n+"pasteLink",group:Dt,text:b().pasteSpecial.pasteLink},{type:"separator"},{command:$e,name:d("pasteSpecial.pasteSpecial"),text:b().pasteSpecial.title}]},{text:b().paste,name:w+_n,command:ae+pe,iconClass:n+c,workArea:t+ie+ue+r},{text:b().paste,name:w+Bn,command:ae+Kn,iconClass:n+c,workArea:t+ie+ue+r},{type:f},{text:b().pinRows,name:w+cn,command:ae+cn,workArea:ue},{text:b().pinColumns,name:w+sn,command:ae+sn,workArea:ie},{type:f},{text:b().scrollToTasks,name:w+At,command:ae+At,workArea:gt+bt},{type:f},{text:b().insertTasks,name:w+Ct,command:ae+Ct,workArea:gt+bt},{text:b().deleteTasks,name:w+kt,command:ae+kt,workArea:gt+bt},{type:f},{text:b().indentTasks,name:w+Ot,command:ae+Ot,workArea:gt+bt},{text:b().outdentTasks,name:w+Vt,command:ae+Vt,workArea:gt+bt},{type:f},{text:b().manuallySchedule,name:w+St,command:ae+St,workArea:gt+bt},{text:b().autoSchedule,name:w+Tt,command:ae+Tt,workArea:gt+bt},{type:f},{text:b().hideColumn,name:w+Ft,command:ae+Ft,workArea:yt},{text:b().unhideColumn,name:w+Mt,command:ae+Mt,workArea:yt},{type:f},{text:b().promote,name:w+ue+ln,command:ae+ln,workArea:ue},{text:b().demote,name:w+ue+mn,command:ae+mn,workArea:ue},{type:f},{text:b().moveUp,name:w+ue+hn,command:ae+hn,workArea:ue},{text:b().moveDown,name:w+ue+xn,command:ae+xn,workArea:ue},{type:f},{text:b().addAfter,name:w+ue+fn,command:ae+fn,workArea:ue},{text:b().addBefore,name:w+ue+dn,command:ae+dn,workArea:ue},{text:b().addAbove,name:w+ue+pn,command:ae+pn,workArea:ue},{text:b().addBelow,name:w+ue+vn,command:ae+vn,workArea:ue},{type:f},{text:b().expandAllLevels,name:w+ie+wn,command:ae+wn,workArea:ie},{text:b().collapseAllLevels,name:w+ie+gn,command:ae+gn,workArea:ie},{text:b().expandLevel1,name:w+ie+Cn,command:ae+Cn,workArea:ie},{text:b().expandLevel2,name:w+ie+kn,command:ae+kn,workArea:ie},{text:b().expandLevel3,name:w+ie+An,command:ae+An,workArea:ie},{text:b().expandLevel4,name:w+ie+Sn,command:ae+Sn,workArea:ie},{text:b().expandLevel5,name:w+ie+Tn,command:ae+Tn,workArea:ie},{text:b().expandLevel6,name:w+ie+yn,command:ae+yn,workArea:ie},{text:b().expandLevel7,name:w+ie+Fn,command:ae+Fn,workArea:ie},{text:b().expandLevel8,name:w+ie+Mn,command:ae+Mn,workArea:ie},{text:b().expandLevel9,name:w+ie+On,command:ae+On,workArea:ie},{type:f},{text:b().clearContents,command:ae+Gn,name:w+Gn,workArea:t+ie+ue+r},{type:f},{text:b().headerInsertCopiedCells,name:w+ue+ve,command:ae+ue+ve,workArea:ue},{text:b().headerInsertCutCells,name:w+ue+he,command:ae+ue+he,workArea:ue},{text:b().headerInsertCopiedCells,name:w+ie+ve,command:ae+ie+ve,workArea:ie},{text:b().headerInsertCutCells,name:w+ie+he,command:ae+ie+he,workArea:ie},{text:b().insertCopiedCells,name:w+ve,subMenu:[{text:b().shiftCellsRight,name:w+ve+we,command:ae+ve+we,iconClass:n+we},{text:b().shiftCellsDown,name:w+ve+xe,command:ae+ve+xe,iconClass:n+xe}],workArea:t},{text:b().insertCutCells,name:w+he,subMenu:[{text:b().shiftCellsRight,name:w+he+we,command:ae+he+we,iconClass:n+we},{text:b().shiftCellsDown,name:w+he+xe,command:ae+he+xe,iconClass:n+xe}],workArea:t},{text:b().insertRows,name:w+de,command:ae+de,workArea:ue},{text:b().insertColumns,name:w+Pn,command:ae+Pn,workArea:ie},{text:b().deleteRows,name:w+jn,command:ae+jn,workArea:ue},{text:b().deleteColumns,name:w+Hn,command:ae+Hn,workArea:ie},{type:f},{text:b().tableInsert,name:w+tt,subMenu:[{text:b().tableInsertColumnsLeft,name:w+it,command:ht,iconClass:n+it},{text:b().tableInsertColumnsRight,name:w+ut,command:xt,iconClass:n+ut},{text:b().tableInsertRowsAbove,name:w+rt,command:dt,iconClass:n+rt},{text:b().tableInsertRowsBelow,name:w+at,command:pt,iconClass:n+at},{text:b().tableDeleteOrInsertEntireSheetRow,name:w+lt,command:ae+de,iconClass:n+rt}],workArea:nt},{text:b().tableDelete,name:w+ot,subMenu:[{text:b().tableDeleteColumns,name:w+mt,command:wt,iconClass:n+mt},{text:b().tableDeleteRows,name:w+ct,command:vt,iconClass:n+ct},{text:b().tableDeleteOrInsertEntireSheetRow,name:w+st,command:ae+jn,iconClass:n+ct}],workArea:nt},{type:f},{text:b().insertSheet,name:w+En,command:ae+En,workArea:O},{text:b().deleteSheet,name:w+In,command:ae+In,workArea:O},{type:f},{text:b().filter,name:w+Un,command:ae+Un,workArea:t+r},{text:b().sort,name:w+Nn,subMenu:[{text:b().sortAscend,name:w+le,command:ae+le,iconClass:n+le},{text:b().sortDescend,name:w+me,command:ae+me,iconClass:n+me}],workArea:t+r},{text:b().slicerSortAscend,name:w+$n,command:ae+$n,iconClass:n+le,workArea:o},{text:b().slicerSortDescend,name:w+et,command:ae+et,iconClass:n+me,workArea:o},{type:f},{text:b().insertComment,name:w+fe,command:ae+fe,iconClass:n+fe,workArea:t+r,needKeepFocus:!0},{text:b().editComment,name:w+se,command:ae+se,iconClass:n+se,workArea:t+r,needKeepFocus:!0},{text:b().deleteComment,name:w+ce,command:ae+ce,iconClass:n+ce,workArea:t+r},{text:b().toggleComment,name:w+nn,command:ae+nn,workArea:t+r},{type:f},{text:b().hideRows,name:w+un,command:ae+un,workArea:ue},{text:b().unhideRows,name:w+rn,command:ae+rn,workArea:ue},{text:b().hideColumns,name:w+Vn,command:ae+Vn,workArea:ie},{text:b().unhideColumns,name:w+an,command:ae+an,workArea:ie},{type:f},{text:b().hideSheet,name:w+on,command:ae+on,workArea:O},{text:b().unhideSheet,name:w+tn,command:ae+tn,workArea:O},{type:f},{text:b().removeSlicer,name:w+en,command:ae+en,workArea:o+M},{type:f},{text:b().sort,name:w+Nn,subMenu:[{text:b().sortAscend,name:w+le,command:Xe,iconClass:n+le,commandOptions:{subType:0},placeholder:L},{text:b().sortDescend,name:w+me,command:Xe,iconClass:n+me,commandOptions:{subType:1},placeholder:L},{text:b().pivotTableSortMoreOptions,name:w+Rn,command:Ye}],workArea:a+U},{text:b().pivotTableRefresh,name:g+W,command:W,iconClass:n+W,workArea:V+R+U+a+I+N},{text:b().pivotTableRemove_,name:g+K,command:K,iconClass:n+K,workArea:V+R+U+a,placeholder:D},{text:b().pivotTableRemoveGrandTotal,name:g+z,command:z,workArea:I},{text:b().pivotTableSummarizeValuesBy,name:g+E,subMenu:[{text:b().pivotTableSum,name:w+q,command:i,commandOptions:{subTotalType:8}},{text:b().pivotTableCount,name:w+Q,command:i,commandOptions:{subTotalType:1}},{text:b().pivotTableAverage,name:w+X,command:i,commandOptions:{subTotalType:0}},{text:b().pivotTableMax,name:w+Y,command:i,commandOptions:{subTotalType:3}},{text:b().pivotTableMin,name:w+$,command:i,commandOptions:{subTotalType:4}},{text:b().pivotTableProduct,name:w+ee,command:i,commandOptions:{subTotalType:5}}],workArea:R+U+I},{text:b().pivotTableShowValueAs,name:g+_,subMenu:[{text:b().pivotTableNoCalculation,name:w+ne,command:i,commandOptions:{showValueAsType:0}},{text:b().pivotTableGrandTotal,name:w+te,command:i,commandOptions:{showValueAsType:1}},{text:b().pivotTableColumnTotal,name:w+ke,command:i,commandOptions:{showValueAsType:3}},{text:b().pivotTableRowTotal,name:w+Ae,command:i,commandOptions:{showValueAsType:2}},{text:b().pivotTableOf,name:w+Se,command:u,commandOptions:{showValueAsType:4}},{text:b().pivotTableParentRowTotal,name:w+Te,command:i,commandOptions:{showValueAsType:5}},{text:b().pivotTableParentColumnTotal,name:w+Ne,command:i,commandOptions:{showValueAsType:6}},{text:b().pivotTableOfParentTotal,name:w+Re,command:u,commandOptions:{showValueAsType:7}},{text:b().pivotTableDifferenceFrom,name:w+ye,command:u,commandOptions:{showValueAsType:8}},{text:b().pivotTablePercentDifferenceFrom,name:w+Fe,command:u,commandOptions:{showValueAsType:9}},{text:b().pivotTableRunningTotalIN,name:w+Me,command:u,commandOptions:{showValueAsType:10}},{text:b().pivotTablePercentRunningTotalIn,name:w+Oe,command:u,commandOptions:{showValueAsType:11}},{text:b().pivotTableRankSmallestToLargest,name:w+Ve,command:u,commandOptions:{showValueAsType:12}},{text:b().pivotTableRankLargestToSmallest,name:w+Ue,command:u,commandOptions:{showValueAsType:13}},{text:b().pivotTableIndex,name:w+Ie,command:i,commandOptions:{showValueAsType:14}}],workArea:R+U},{text:b().pivotTableFilter,name:g+Le,iconClass:n+Le,subMenu:[{text:b().pivotTableClearFilterFrom_,name:w+Ee,command:Qe,iconClass:n+Ee,placeholder:D,commandOptions:{clearType:0}},{text:b().pivotTableKeepOnlySelectedItems,name:w+Pe,command:qe,commandOptions:{subType:1}},{text:b().pivotTableHideSelectedItems,name:w+je,command:qe,commandOptions:{subType:2}},{text:b().pivotTableTop10,name:w+He,command:ze,commandOptions:{isTop10:!0}},{text:b().pivotTableLabelFilters,name:w+Ge,command:Je},{text:b().pivotTableValueFilters,name:w+_e,command:ze}],workArea:a},{text:b().pivotTableExpandOrCollapse,name:g+P,subMenu:[{text:b().pivotTableExpand,name:w+Be,command:Be,iconClass:n+Be},{text:b().pivotTableCollapse,name:w+We,command:We,iconClass:n+We},{text:b().pivotTableExpandEntireField,name:w+Ke,command:Ke,iconClass:n+Ke},{text:b().pivotTableCollapseEntireField,name:w+Ze,command:Ze,iconClass:n+Ze}],workArea:a},{text:b().pivotTableGroup,name:g+j,command:H,iconClass:n+j,workArea:a},{text:b().pivotTableUnGroup,name:g+G,command:G,iconClass:n+G,workArea:a},{text:b().pivotTableShowDetails,name:g+B,command:B,iconClass:n+B,workArea:U},{text:b().pivotTableValueFieldSettings,name:g+J,command:J,iconClass:n+J,workArea:R+U+I}],!1)},p.prototype.Hc=function(e){var n=this;n.iq||(n.Qy=e.commandManager(),re(n.rq)&&(n.rq=new k.ContextMenuViewDialog(e.j2(),m(e.oM))),n.oq(e),n.aq={filter:{menuDataDict:[w+Un],checkFunction:function(e){if(e&&e.rowFilter)return!0}},comments:{menuDataDict:[w+fe,w+se,w+ce,w+nn],checkFunction:function(e){if(e&&e.comments)return!0}},slicer:{menuDataDict:[w+$n,w+et,w+en],checkFunction:function(e){if(e&&e.slicers)return!0}},floatingObject:{menuDataDict:[w+pe,w+Wn,w+Zn],checkFunction:function(e){var n,e,t;return!(e&&e.uq&&(e=(n=e.uq()).fromSheet)&&e.dP)||void 0}},table:{menuDataDict:[w+tt,w+ot],checkFunction:function(e){if(e&&e.tables)return!0}},tableSheet:{menuDataDict:[w+_n,w+cn,w+sn,w+ln,w+mn,w+pn,w+fn,w+dn,w+vn,w+hn,w+xn,w+wn,w+gn,w+Cn,w+kn,w+An,w+Sn,w+Tn,w+yn,w+Fn,w+Mn,w+On],checkFunction:function(e){if(e&&e.NMi&&0===e.NMi._gi)return!0}},ganttSheet:{menuDataDict:[w+Bn,w+Ct,w+kt,w+Ot,w+Vt,w+At,w+St,w+Tt],checkFunction:function(e){if(e&&e.NMi&&1===e.NMi._gi)return!0}}},n.iq=!0)},p.prototype.cq=function(e,n){var t,o,r,a,i,u,c,c,u,i,u,i,r,s,t=this;if(n.focus(),o=t.fq(e,n),re(o))y(e);else if((r=(0,oe.jf)(n))&&r.options.disableContextMenu&&o.worksheetHitInfo)y(e);else{if(r){if(i=r.getActiveRowIndex(),u=r.getActiveColumnIndex(),oe.Worksheet.et(r,"preProcessContextMenu",c={r:!1,hitInfo:o}),c.r)return;if(r.isEditing()&&o.worksheetHitInfo&&o.worksheetHitInfo.col===u&&o.worksheetHitInfo.row===i||n.getTab()&&n.getTab().Og)return}t.Hc(n),t.lq(o,n),(r=(0,oe.jf)(n))&&(c=r.getSelections()[0],re(c)||re(r.pivotTables)||(u=r.floatingObjects&&r.floatingObjects.all().some(function(e){return e.isSelected()}),i=r.shapes&&r.shapes.all().some(function(e){return e.isSelected()}),u)||i||(u=r.pivotTables.findPivotTable(c.row,c.col),!re(u)&&o.worksheetHitInfo&&(i=(o.worksheetHitInfo.pivotTableInfo=u).getPivotInfoImp(c.row,c.col,!1,!1,!0),re(i)||(o.worksheetHitInfo.pivotTableCellInfo=i)))),r=t.hq(t.menuData,o,n),(s=t.onOpenMenu(t.menuData,r,o,n))||(y(e),r.length&&t.dq(r,o,n),t.onMenuOpened())}},p.prototype.lq=function(e,n){var t=this;t.rq.QX(e)&&t.vq(e,n)},p.prototype.vq=function(e,n){var t,o,t=this,o=(0,oe.jf)(n);o&&o.isEditing()&&o.endEdit(void 0,!1),t.mq(e)?t.gq(e,n):t.pq(e)&&t.bq(e,n)},p.prototype.pq=function(e){return!!e.worksheetHitInfo},p.prototype.yq=function(e,n,t,o){var r=!0,a,i;if(1===o){for(a=0;a<e.length;a++)-1===(i=e[a]).row&&t>=i.col&&t<i.col+i.colCount&&(r=!1);return r}if(2===o){for(a=0;a<e.length;a++)-1===(i=e[a]).col&&n>=i.row&&n<i.row+i.rowCount&&(r=!1);return r}for(a=0;a<e.length;a++)if((i=e[a]).contains(n,t))return!1;return!0},p.prototype.mq=function(e){return!(!e.tabStripHitInfo||!e.tabStripHitInfo.sheetTab)},p.prototype.wq=function(e){return e.tabStripHitInfo.sheetTab.sheetName},p.prototype.Mq=function(e){return e.tabStripHitInfo.sheetTab.sheetIndex},p.prototype.bq=function(e,n){var t,n,e,t=this,n=(0,oe.jf)(n),e=e.worksheetHitInfo;e.floatingObjectHitInfo||e.commentHitInfo||e.shapeHitInfo||(t.kk(n,e),t.Cq(n))},p.prototype.Cq=function(e){var n,t,e,n,n=e.getActiveRowIndex(),t=e.getActiveColumnIndex(),e=e.comments;e&&(n=e.get(n,t))&&e.PW===n&&e.NK(n)},p.prototype.Sq=function(e){return 3===e.hitTestType},p.prototype.PA=function(e,n,t){e.PA&&e.PA(n,t)},p.prototype.kk=function(e,n){var t,o,r,a,i,u,t,o,t=this,o=e.Ut.getSelections(),r=n.row,a=n.col;e.JA(n.rowViewportIndex<0?-1:n.row,n.colViewportIndex<0?-1:n.col)&&(i=!1,t.yq(o,r,a,n.hitTestType)?i=!0:0<(t=(u=e.shapes&&e.shapes.all()||[]).filter(function(e){return e.isSelected()})).length&&(t.forEach(function(e){return e.isSelected(!1)}),i=!0),i)&&((o=e.rt).kk(e,n,r,a),o.X9())},p.prototype.gq=function(e,n){var t,o,r,a,i,u,c,s,l,m,f,t=this.Mq(e),o=n.e2(t);if(o){if(o.b2()){for(i=[],u=a=0,c=(r=n.qv()).length;u<c;u++)(s=r[u]).b2()&&(a++,re(s._gi)||i.push(s));if(1<a)for(l=0,m=i.length;l<m;l++)(f=i[l]).b2(!1,!0)}else(r=n.qv()).forEach(function(e){e.b2()&&e.b2(!1,!0)}),o.b2(!0,!0);n.I2(t,2,!1,!0),this.Tq(this.menuData,e,n)}},p.prototype.fq=function(e,n){var t,o,e,t=n.wM(),o=e.pageX-t.left,e=e.pageY-t.top;return n.hitTest(o=0<=o?o:1,e=0<=e?e:1,!0)},p.prototype.onOpenMenu=function(e,n,t,o){},p.prototype.onMenuOpened=function(){},p.prototype.dq=function(e,n,t){var o=this;o.rq.QX(n)&&(o.Aq(),t.iy(),o.Iq(e,n,t))},p.prototype.Aq=function(){this.rq.close()},p.prototype.Iq=function(e,n,t){var o,r,a,n,o=this,r=t.uC(),a=n.x,n=n.y;a-=r.left,n-=r.top,o.rq.rQ(o.menuView,e,a,n,t)},p.prototype.hq=function(e,n,t){var o,r,e,o=this,r={};return m.extend(!0,r,e),e=o.xq(r,n,t),o.Nq(e,n),o.kq(e,t),o.Dq(e,t),o._q(e,t),o.Eq(e),o.Oq(e),e=(0,T.filterReportSheetMenuItems)(e,t,n),e=o.jq(e)},p.prototype.xq=function(e,i,u){var c,s,l,c=this,s=[],l=Object.keys(Et);return m.each(e,function(e,n){var t,o,r,a;if(!re(n))for(n.type===f&&s.push(n),t=0;t<l.length;t++)if(o=l[t],(r=Et[o])(i,u,n)&&(a=c.Rq(n,i)))return void s.push(n)}),s},p.prototype.Bq=function(e,n,t){var o,r,a,i,u,c,s,l,m,f,d,p,v,h,r,h,x,o=t.placeholder,r=t.name,a=n.area,i=n.value,u=n.menuArea,c=n.colHeadFieldInfo,s=n.rowInfos,l=n.colInfos,m=n.cornerFieldInfo,f=n.activeRowFieldInfo,d=n.activeColFieldInfo;if(re(o))r===w+Ge&&(r=f&&f.name||d&&d.name||c&&c.fieldName||m&&m.fieldName,h=e.dh,x=r&&h.getFieldInfoByName(r)&&2===h.getFieldInfoByName(r).W5)&&(t.text=b().pivotTableLabelFilters_Date);else if(o===D){if(p=void 0,0===u)p=n.pageFieldInfo.fieldName;else if(2===a&&2===u){if(c)p=c.fieldName;else if(p=d&&d.name,re(p)){for(v=d.index;0<=v&&l[v]&&re(l[v].itemName);)v-=1;p=l[v].fieldName}}else if(3===a&&2===u){if(p=f&&f.name,re(p)){for(v=f.index;0<=v&&s[v]&&re(s[v].itemName);)v-=1;p=s[v].fieldName}}else 1===a?1===u?p=n.value:2===u&&m&&(p=m.fieldName):4===u&&(p=n.valueFieldName,2===a?p=d&&d.name||i:3===a&&(p=f&&f.name||i));t.text=t.text.replace("{0}",'"'+p+'"')}else o===L&&4===u&&(p=void 0,0===(h=t.commandOptions.subType)?p=b().pivotTableSortAscend:1===h&&(p=b().pivotTableSortDescend),t.text=p);re(t.commandOptions)&&(t.commandOptions={}),t.commandOptions.pivotTableName=e.name(),t.commandOptions.pivotTableCellInfo=n},p.prototype.Oq=function(e){for(var n,t,o,r,n=0,t=!1,o=0;o<e.length&&((r=e[o].name)!==w+ue+ve&&r!==w+ue+he&&r!==w+ie+ve&&r!==w+ie+he||(t=!0),r!==w+de&&r!==w+Pn||(n=o,!t));o++);t&&e.splice(n,1)},p.prototype.Nq=function(e,n){var n,t,n=n.worksheetHitInfo,t;!n||n.row!==ge&&n.col!==ge||e.splice(0,e.length)},p.prototype.kq=function(a,e){var i,u,e,i=this,u=(0,oe.jf)(e),e=i.aq;return m.each(e,function(e,n){var t,o,r;if(!n.checkFunction(u))for(o=0,r=(t=n.menuDataDict).length;o<r;o++)i.Lq(a,t[o],function(e,n){e[n]=null})}),a},p.prototype.Rq=function(e,n){var t,o,r,n,a,i,u,c,s,l,m,f,d,p,v,h,x,t=this,o=n.worksheetHitInfo&&n.worksheetHitInfo.pivotTableInfo;if(o&&(r=n.worksheetHitInfo&&n.worksheetHitInfo.pivotTableCellInfo)){if(n=o.options.subtotalsPosition,a=r.value,i=r.area,u=r.menuArea,c=r.cornerFieldInfo,s=r.colHeadFieldInfo,l=r.activeRowFieldInfo,m=r.activeColFieldInfo,f=r.rowInfos,d=r.colInfos,p=r.valueFieldName,-1<(v=[g+P,g+Le,g+B]).indexOf(e.name)&&((2===i||3===i)&&4===u||(!re(c)||!re(s))&&a===b().sigmaValueTemp||3===i&&l&&f[l.index].isSubtotal&&void 0===f[l.index].collapseIndex&&1!==n||2===i&&m&&d[m.index].isSubtotal&&void 0===d[m.index].collapseIndex&&1!==n))return!1;if(-1<(h=[g+j,g+G]).indexOf(e.name)&&(!re(c)||!re(s)))return!1;if(-1<(x=[g+J,g+K,g+E,g+_]).indexOf(e.name)&&re(p)&&4===u&&4===i)return!1;e&&e.subMenu?e.subMenu.forEach(function(e){t.Bq(o,r,e),t.Fq(o,r,e)}):t.Bq(o,r,e)}return!0},p.prototype.Fq=function(e,n,t){var o,r,a,i,n,o,r,u,c,n,e,s,l,m,f,m,o=n.activeRowFieldInfo,r=n.activeColFieldInfo,a=n.cornerFieldInfo,i=n.colHeadFieldInfo,n=n.valueFieldName,o=o&&o.name||r&&r.name||i&&i.fieldName||a&&a.fieldName||n,r=e.dh,u=o&&r.getFieldInfoByName(o),c=r.K;switch(t.commandOptions&&u&&(n=t.commandOptions.showValueAsType,e=t.commandOptions.subTotalType,re(n)||(s=u.Or&&u.Or.showDataAs||0)===n&&(t.iconClass=F),re(e)||(l=u.getSubTotalType())===e&&(t.iconClass=F)),t.name){case w+Ee:f=!1,(m=c.Pq[u.a])&&m.C()&&(f=!0),m=!!m&&m.on(),f||m||(t.disable=!0);break;case w+Pe:case w+je:re(a)&&re(i)||(t.disable=!0)}},p.prototype.Dq=function(e,n){var n,t,r,a,i,n=(0,oe.jf)(n),t=n&&n.getSelections();t&&0<t.length&&(r=uo(n,t[0]),a=n.getActiveRowIndex(),i=n.getActiveColumnIndex(),r)&&m.each(e,function(e,n){var t,o;re(n)||(n.name===w+tt?(t=n.subMenu,(o=r.rowFilter()).isFiltered()?r.checkTableLastRow(a)?t.splice(2,2):t.splice(2,1):(t.splice(4,1),r.checkTableLastRow(a)&&t.splice(3,1)),r.checkTableLastCol(i)&&t.splice(1,1)):n.name===w+ot&&(t=n.subMenu,(o=r.rowFilter()).isFiltered()?t.splice(1,1):t.splice(2,1)))})},p.prototype.Eq=function(e){for(var n,t,o,n=this,o,t=e.length-1;0<=t;t--)e[t]?e[t].subMenu&&n.Eq(e[t].subMenu):e.splice(t,1);return e},p.prototype.jq=function(e){for(var n,t,o,r,a,i,u,n=[],o=e.length,t=0;t<o;t++)e[t]&&e[t].type===f&&e[t+1]&&e[t+1].type===f||n.push(e[t]);for(o=n.length,u=i=!(a=r=0),t=0;t<o&&(i&&n[t].type===f?r++:i=!1,u&&n[o-1-t].type===f?a++:u=!1,i||u);t++);return n.splice(o-a,a),n.splice(0,r),n},p.prototype._q=function(e,n){var t=this;t.Gq(e,n),t.Uq(e,n)},p.prototype.Gq=function(e,n){for(var t,o,r,a,i,t=this,o=(0,oe.jf)(n),r=o&&o.tables,a=o&&o.NMi,i=0;i<e.length;i++)if(e[i]){switch(e[i].name){case w+de:o.rR()||(e[i].disable=!0),o.isActualProtected()&&!o.options.protectionOptions.allowInsertRows&&(e[i].disable=!0);break;case w+jn:o.rR()||(e[i].disable=!0),o.isActualProtected()&&!o.options.protectionOptions.allowDeleteRows&&(e[i].disable=!0),r&&r.containTableHeaderTotalRowForSheet()&&(e[i].disable=!0);break;case w+Pn:o.oR()||(e[i].disable=!0),o.isActualProtected()&&!o.options.protectionOptions.allowInsertColumns&&(e[i].disable=!0);break;case w+Hn:o.oR()||(e[i].disable=!0),o.isActualProtected()&&!o.options.protectionOptions.allowDeleteColumns&&(e[i].disable=!0);break;case w+rt:r&&(r.isAcrossTables()||r.containTableHeader()||r.noRoomToInsertRow())&&(e[i].disable=!0);break;case w+at:r&&(r.isAcrossTables()||r.noRoomToInsertRow())&&(e[i].disable=!0);break;case w+ct:r&&(r.checkTableRow()||r.isAcrossTables()||r.containTableHeaderTotalRow())&&(e[i].disable=!0);break;case w+it:case w+ut:r&&(r.isAcrossTables()||r.noRoomToInsertColumn())&&(e[i].disable=!0);break;case w+mt:r&&(r.checkTableCol()||r.isAcrossTables()||r.isWholeTableCol())&&(e[i].disable=!0);break;case w+sn:a&&(e[i].disable=!a.enablePinColumn());break;case w+cn:a&&(e[i].disable=!a.enablePinRow())}e[i]&&e[i].subMenu&&t.Gq(e[i].subMenu,n)}},p.prototype.Uq=function(e,n){var t,o,r,a,i,u,c,c,t=this,o=(0,oe.jf)(n),r=o&&o.isActualProtected(),a=o&&o.options.protectionOptions;if(r&&a)for(i=void 0,u=0;u<e.length;u++)if(e[u]){switch(e[u].name){case w+de:a.allowInsertRows||(e[u].disable=!0);break;case w+Pn:a.allowInsertColumns||(e[u].disable=!0);break;case w+jn:a.allowDeleteRows||(e[u].disable=!0);break;case w+Hn:a.allowDeleteColumns||(e[u].disable=!0);break;case w+Un:a.allowFilter||(e[u].disable=!0);break;case w+le:case w+me:a.allowSort||(e[u].disable=!0);break;case w+un:case w+rn:case w+Vn:case w+an:o.NMi||(e[u].disable=!0);break;case w+$n:case w+et:a.allowEditObjects||e.splice(0,e.length);break;case w+fe:a.allowEditObjects||(e[u]=null);break;case w+se:c=void 0,o.comments&&(c=(i=o.comments.get(o.getActiveRowIndex(),o.getActiveColumnIndex()))&&i.lockText()),!a.allowEditObjects&&c&&(e[u]=null);break;case w+ce:c=void 0,o.comments&&(c=!Qt(o.getSelections(),o)),!a.allowEditObjects&&c&&(e[u]=null);break;case w+rt:case w+at:case w+it:case w+ut:case w+ct:case w+mt:e[u].disable=!0}e[u]&&e[u].subMenu&&t.Uq(e[u].subMenu,n)}},p.prototype.Tq=function(e,n,t){var n,o,r,a;if(n.tabStripHitInfo&&(n=this,o=t.qv(),r=n.Hq(w+tn))){for(a=0;a<o.length;a++)if(o[a].visible()===oe.SheetTabVisible.hidden)return void(r.disable=!1);r.disable=!0}},p.prototype.Hq=function(e){var n=this;return n.zq(n.menuData,e)},p.prototype.zq=function(e,n){var t,o,t;return this.Lq(e,n,function(e,n){o=e[n]}),o},p.prototype.Lq=function(e,n,t){for(var o,r,a,o=this,r=e.length,a=0;a<r;a++)if(!re(e[a])){if(n===e[a].name)return void t(e,a);e[a].subMenu&&o.Lq(e[a].subMenu,n,t)}},p.prototype.Vq=function(e,n){for(var t,o,r,a,t=this,o=e.length,r=0;r<o;r++)a=e[r],re(a)||(n(a),a.subMenu&&t.Vq(a.subMenu,n))},p.prototype.oq=function(d){var s,e,n,t,o,o,r,a,i,u,c,l,m,f,p,v,h,o,x,o,w,g,b,C,k,A,S,T,y,F,M,O,V,R,N,U,L,E,P,j,H,G,_,B,W,K,Z,z,J,I,q,Q,X,Y,$,ee,ne,te;function D(e,n,t){for(var o,r,o=0;o<t;o++)-1===e.indexOf(r=n+o)&&e.push(r)}this.Yq||((s=d.commandManager()).register(ae+qn,e={canUndo:!1,execute:function(e,n){var e=(0,oe._f)(e,n.sheetName);e&&(Ht(e)?s.execute({cmd:"copyShapes",sheetName:e.name()}):s.execute({cmd:qn,sheetName:e.name(),ignoreClipboard:!0}))}},null,!1,!1,!1,!1),s.register(ae+Jn,n={canUndo:!1,execute:function(e,n){var e=(0,oe._f)(e,n.sheetName);e&&(Ht(e)?s.execute({cmd:"cutShapes",sheetName:e.name()}):s.execute({cmd:Jn,sheetName:e.name(),ignoreClipboard:!0}))}},null,!1,!1,!1,!1),s.register(ae+zn,t={canUndo:!1,execute:function(e,n){var e=(0,oe._f)(e,n.sheetName);e&&(e.isPasteFloatingObject&&e.isPasteFloatingObject()?s.execute({cmd:"pasteFloatingObjects",sheetName:e.name()}):e.isPasteShapes&&e.isPasteShapes()?s.execute({cmd:"pasteShapes",sheetName:e.name()}):s.execute({cmd:_n,sheetName:e.name(),pasteOption:0}))}},null,!1,!1,!1,!1),s.register(ae+ve+we,o={canUndo:!1,execute:function(e,n){var e=(0,oe._f)(e,n.sheetName);e&&s.execute({cmd:_n,sheetName:e.name(),pasteOption:0,shiftCells:oe.InsertShiftCell.right,isHeaderPaste:yo(n.itemName)})}},null,!1,!1,!1,!1),s.register(ae+he+we,o,null,!1,!1,!1,!1),s.register(ae+ie+ve,o,null,!1,!1,!1,!1),s.register(ae+ie+he,o,null,!1,!1,!1,!1),s.register(ae+ve+xe,o={canUndo:!1,execute:function(e,n){var e=(0,oe._f)(e,n.sheetName);e&&s.execute({cmd:_n,sheetName:e.name(),pasteOption:0,shiftCells:oe.InsertShiftCell.down,isHeaderPaste:yo(n.itemName)})}},null,!1,!1,!1,!1),s.register(ae+he+xe,o,null,!1,!1,!1,!1),s.register(ae+ue+ve,o,null,!1,!1,!1,!1),s.register(ae+ue+he,o,null,!1,!1,!1,!1),s.register(ae+Zn,r={canUndo:!1,execute:function(e,n){var t=3;go(e,n,s,3)}},null,!1,!1,!1,!1),s.register(ae+pe,a={canUndo:!1,execute:function(e,n){var t=1;go(e,n,s,1)}},null,!1,!1,!1,!1),s.register(ae+Kn,i={canUndo:!1,execute:function(e,n){var t=1;go(e,n,s,1)}},null,!1,!1,!1,!1),s.register(ae+Wn,u={canUndo:!1,execute:function(e,n){var e=(0,oe._f)(e,n.sheetName);e&&s.execute({cmd:_n,sheetName:e.name(),pasteOption:2})}},null,!1,!1,!1,!1),s.register(ae+Qn,c={canUndo:!1,execute:function(e,n){var t=4;go(e,n,s,4)}},null,!1,!1,!1,!1),s.register(ae+Xn,l={canUndo:!1,execute:function(e,n){var t=5;go(e,n,s,5)}},null,!1,!1,!1,!1),s.register(ae+Gn,m={canUndo:!1,execute:function(e,n){var e=(0,oe._f)(e,n.sheetName);e&&s.execute({cmd:"clear",sheetName:e.name()})}},null,!1,!1,!1,!1),s.register(ae+fe,f={canUndo:!0,execute:function(p,e,n){return be(p,e,n,function(e,n){var t,o,r,n,a,t,o,i,u,t,o,c,a,s,l,m,f,d,t=n.commentState||2,o=n.displayMode,r=n.activeRow,n=n.activeCol,a=e.comments.add(r,n,"");a&&(a.commentState(t),o&&a.displayMode(o),t=e.C0(r),o=e.S0(n),i=e.getCellRect(r,n,t,o),t=(u=e.Fi()).c9(t,o),o=a.location(),c=a.width(),a=a.height(),f=m=l=s=void 0,d=p.ib,i.y+o.y<t.y?(m=xo(e,r,i.y+o.y-t.y),s=d.Jy(e,m),d.yy(e,s.Ky,0),e.tw()):i.y+o.y+a>t.y+t.height&&(m=xo(e,r,i.y+o.y+a-(t.y+t.height)),s=d.Jy(e,m),d.yy(e,s.Ky,0),e.tw()),i.x+o.x+c>t.x+t.width)&&(f=wo(e,n,i.x+o.x+c-(t.x+t.width)),l=d.rw(e,f),d.wy(e,l.iw,0),e.ow())},function(e,n){var t,o,t,o,t=n.activeRow,o=n.activeCol,t=e.comments.get(t,o);if(t)return n.displayMode=t.displayMode(),n.commentState=t.commentState(),o={sheet:e,sheetName:e.name(),comment:t,cancel:!1},e.ki(oe.Events.CommentRemoving,o),{cancel:o.cancel,comment:t}},function(e,n,t){e.ki(oe.Events.CommentRemoved,{sheet:e,sheetName:e.name(),comment:t.comment})})}},null,!1,!1,!1,!1),s.register(ae+se,p={canUndo:!1,execute:function(e,n){var e,t,n,e,e=(0,oe._f)(e,n.sheetName);e&&(t=n.activeRow,n=n.activeCol,e=e.comments.get(t,n))&&e.commentState(2,!0)}},null,!1,!1,!1,!1),s.register(ae+ce,v={canUndo:!0,execute:function(e,c,n){return be(e,c,n,function(e){var n,t,o,r,a,i,u,n=c.selections,t=n.length;if(!(t<=0))for(o=0;o<t;o++)for(a=(r=n[o]).row;a<r.row+r.rowCount;a++)for(i=r.col;i<r.col+r.colCount;i++)!(u=e.comments.get(a,i))||e.isActualProtected()&&!e.options.protectionOptions.allowEditObjects&&u.locked()||s.execute({cmd:ce,sheetName:e.name(),row:u.bZ,col:u.yZ})})}},null,!1,!1,!1,!1),s.register(ae+nn,h={canUndo:!1,execute:function(e,n){var e,t,n,e,e=(0,oe._f)(e,n.sheetName);e&&(t=n.activeRow,n=n.activeCol,e=e.comments.get(t,n))&&(2===e.displayMode()?e.displayMode(1):e.displayMode(2))}},null,!1,!1,!1,!1),s.register(ae+de,o={canUndo:!0,execute:function(e,p,n){return p.considerAllSheets=!0,be(e,p,n,function(e){for(var n,t,o,r,a,i,u,c,s,l,m,f,d,n=so(p.selections),o=0;o<n.length;o++){for(t=n[o],r=e.getRange(t.row-1,0,1,t.colCount),a=[],i=0;i<r.colCount;i++)e.getCell(r.row,i).locked()||a.push(i);for(u=t.row,c=t.rowCount,e.addRows(u,c),s=0;s<a.length;s++)for(l=n[o].row;l<n[o].row+n[o].rowCount;l++)e.getCell(l,a[s]).locked(!1);if(e.tables&&0<c)for(m=e.tables.AB(u,-1,c,-1),f=0;f<m.length;f++)(d=m[f]).jj(u,c,!1,!1);mo(e,u,-1,c)}})}},null,!1,!1,!1,!1),s.register(ae+"insertEntireSheetRows",o,null,!1,!1,!1,!1),s.register(ae+Pn,x={canUndo:!0,execute:function(e,p,n){return p.considerAllSheets=!0,be(e,p,n,function(e){for(var n,t,o,r,a,i,u,c,s,l,m,f,d,n=lo(p.selections),o=0;o<n.length;o++){for(t=n[o],r=e.getRange(0,t.col-1,t.rowCount,1),a=[],i=0;i<r.rowCount;i++)e.getCell(i,r.col).locked()||a.push(i);for(u=t.col,c=t.colCount,e.addColumns(u,c),s=0;s<a.length;s++)for(l=u;l<u+c;l++)e.getCell(a[s],l).locked(!1);if(e.tables&&0<c)for(m=e.tables.AB(-1,u,-1,c),f=0;f<m.length;f++)(d=m[f]).Ej(u,c,!1,!1);mo(e,-1,u,c)}})}},null,!1,!1,!1,!1),s.register(ae+jn,o={canUndo:!0,execute:function(e,f,n){if(!n){var t=(0,oe._f)(e,f.sheetName);if(t.isActualProtected()&&oe.mt.wme(t))return t.jT(oe.InvalidOperationType.editProtected,t.FT()),!1}return f.considerAllSheets=!0,be(e,f,n,function(e){for(var n,t,o,r,a,i,u,c,s,l,m,n=so(f.selections),t=e.filterRowsVisibleInfo&&e.filterRowsVisibleInfo.rowsVisibleInfo,o=t&&0<Object.keys(t).length,r=0;r<n.length;r++)if(i=(a=n[r]).row,u=a.rowCount,c=e.getRowCount(),o)for(l=(s=_t(a,t)).length-1;0<=l;l--)i=s[l][0],u=s[l][1],m=e.tables&&e.tables.AB(i,-1,u,-1),e.deleteRows(i,u),0<m.length&&0<c-e.getRowCount()&&(c=e.getRowCount(),co(e,m,i,u));else m=e.tables&&e.tables.AB(i,-1,u,-1),e.deleteRows(i,u),0<m.length&&0<c-e.getRowCount()&&co(e,m,i,u)})}},null,!1,!1,!1,!1),s.register(ae+"deleteEntireSheetRows",o,null,!1,!1,!1,!1),s.register(ae+Hn,w={canUndo:!0,execute:function(e,s,n){if(!n){var t=(0,oe._f)(e,s.sheetName);if(t.isActualProtected()&&oe.mt.wme(t))return t.jT(oe.InvalidOperationType.editProtected,t.FT()),!1}return s.considerAllSheets=!0,be(e,s,n,function(e){for(var n,t,o,r,a,i,u,c,n=lo(s.selections),t=0;t<n.length;t++)if(o=e.getColumnCount(),r=n[t].col,a=n[t].colCount,i=void 0,e.tables&&(i=e.tables.AB(-1,r,-1,a)),e.deleteColumns(r,a),e.tables&&0<o-e.getColumnCount())for(u=0;u<i.length;u++)(c=i[u]).Ej(r,a,!0)})}},null,!1,!1,!1,!1),s.register(ae+En,g={canUndo:!1,execute:function(e){var n,t,o,r,a,i,u,c,n=e.getActiveSheetIndex(),t=e.getActiveSheetTabIndex(),o=[],r=(0,oe.jf)(e),a=0<=t?e.bb("",oe.SheetType.tableSheet):e.S2(e.T2(n)),i;e.qv().forEach(function(e){e.b2()&&o.push(e)}),o.forEach(function(e){e.b2(!1,!0)}),u={sheetName:a.name(),propertyName:"insertSheet",cancel:!1,sheetIndex:-1!==n?n:t,sheetPosition:e.getSheetPosition(a.name())},e.ki(oe.Events.SheetChanging,u),u.cancel||(e.ki(oe.Events.ActiveSheetChanging,c={oldSheet:r,newSheet:a}),0<=t?e.yb(t,2,a):e.A2(Math.max(0,n),2,a),a.b2(!0,!0),e.ki(oe.Events.SheetChanged,{sheetName:a.name(),propertyName:"insertSheet",sheetIndex:-1!==n?n:t,sheetPosition:e.getSheetPosition(a.name())}),e.ki(oe.Events.ActiveSheetChanged,{oldSheet:r,newSheet:a}))}},null,!1,!1,!1,!1),s.register(ae+In,b={canUndo:!1,execute:function(r,e){var a,n,t,i,u,n,c,n,a=(0,oe.jf)(r),n=r.qv();1<n.length&&(t=[],i=[],n.forEach(function(e,n){var e,e;e.b2()&&(e=e.name(),t.push(e),e=r.Ese(e),i.push(e))}),t.length!==n.length)?1<=t.length&&(r.suspendPaint(),r.suspendCalcService(),u={oldSheet:a,cancel:!1},n=r.sheets,r.options&&r.options.saveChangesForSheet&&oe.Commands.II(n),c=[],t.forEach(function(e,n){var n,t,o,o,o,n=i[n],t=(0,oe._f)(r,e),o={sheetName:e,propertyName:"deleteSheet",cancel:!1,sheetIndex:n,sheetPosition:r.getSheetPosition(e)};t===a&&r.ki(oe.Events.ActiveSheetChanging,u),r.ki(oe.Events.SheetChanging,o),u.cancel||o.cancel||(o=r.getSheetIndex(e),!re(o)&&0<=o?(r.m3(o,2),-1===r.getActiveSheetIndex()&&r.setActiveSheetTab(0)):(o=r.getSheetTabIndex(e),!re(o)&&0<=o&&(r.g3(o,2),-1===r.getActiveSheetTabIndex())&&r.setActiveSheetIndex(0)),c.push(e),r.ki(oe.Events.SheetChanged,{sheetName:e,propertyName:"deleteSheet",sheetIndex:n,sheetPosition:r.getSheetPosition(e)}),o=(0,oe.jf)(r),t===a&&r.ki(oe.Events.ActiveSheetChanged,{oldSheet:t,newSheet:o}))}),e.deletedSheets=c,r.options&&r.options.saveChangesForSheet&&oe.Commands.xI(n,e),(n=(0,oe.jf)(r))&&!n.isSelected()&&n.b2(!0,!0),r.resumeCalcService(!1),r.resumePaint()):Co(a),r.undoManager().clear()}},null,!1,!1,!1,!1),s.register(ae+Un,C={canUndo:!0,execute:function(e,u,n){return be(e,u,n,function(e){var n,t,o,r,a,i,o,n,t=u.selections[0],o=uo(e,t),r=u.activeRow,a=u.activeCol;o?(i=o.range()).contains(r,a,1,1)&&(o=o.name(),s.execute({cmd:"contextmenuFilterForTable",sheetName:e.name(),cmdOption:{tableName:o,activeRow:r,activeCol:a,expectedText:e.getText(r,a)}})):e.rowFilter&&s.execute({cmd:"contextmenuFilterForSheet",sheetName:e.name(),cmdOption:{activeRow:r,activeCol:a,selection:t,expectedText:e.getText(r,a)}})})}},null,!1,!1,!1,!1),s.register(ae+le,k={canUndo:!0,execute:function(e,a,n){if(!n){var t=(0,oe._f)(e,a.sheetName);if(t.isActualProtected()&&oe.mt.wme(t))return t.jT(oe.InvalidOperationType.sort,t.FT()),!1}return be(e,a,n,function(e){var n,t,o,t,r,r,n=a.activeCol,t=a.selections,o=uo(e,t[0]),t=o?o.dataRange():t[0],r=e.TB(t,!0,null),r={sheet:e,sheetName:e.name(),col:n,ascending:!0,range:t,compareFunction:ge,groupSort:r.groupSort,ignoreHidden:r.ignoreHidden,cancel:!1};e.ki(oe.Events.RangeSorting,r),!1===r.cancel&&(e.sortRange(t.row,t.col,t.rowCount,t.colCount,!0,[{index:n,ascending:!0,compareFunction:r.compareFunction}],{groupSort:r.groupSort,ignoreHidden:r.ignoreHidden},ge,!!o),e.ki(oe.Events.RangeSorted,r))})}},null,!1,!1,!1,!1),s.register(ae+me,A={canUndo:!0,execute:function(e,a,n){if(!n){var t=(0,oe._f)(e,a.sheetName);if(t.isActualProtected()&&oe.mt.wme(t))return t.jT(oe.InvalidOperationType.sort,t.FT()),!1}return be(e,a,n,function(e){var n,t,o,t,r,r,n=a.activeCol,t=a.selections,o=uo(e,t[0]),t=o?o.dataRange():t[0],r=e.TB(t,!0,null),r={sheet:e,sheetName:e.name(),col:n,ascending:!1,range:t,compareFunction:ge,groupSort:r.groupSort,ignoreHidden:r.ignoreHidden,cancel:!1};e.ki(oe.Events.RangeSorting,r),!1===r.cancel&&(e.sortRange(t.row,t.col,t.rowCount,t.colCount,!0,[{index:n,ascending:!1,compareFunction:r.compareFunction}],{groupSort:r.groupSort,ignoreHidden:r.ignoreHidden},ge,!!o),e.ki(oe.Events.RangeSorted,r))})}},null,!1,!1,!1,!1),s.register(ae+$n,S={canUndo:!0,execute:function(e,n,t){return bo(e,n,t,1)}},null,!1,!1,!1,!1),s.register(ae+et,T={canUndo:!0,execute:function(e,n,t){return bo(e,n,t,2)}},null,!1,!1,!1,!1),s.register(ae+cn,y={canUndo:!0,execute:function(e,i,n){return be(e,i,n,function(e){var n,t,o,r,a,n=i.selections;if(0<n.length){for(t=[],o=0,r=n;o<r.length;o++)D(t,(a=r[o]).row,a.rowCount);try{e.NMi.togglePinnedRows(t)}catch(e){return!1}}})}},null,!1,!1,!1,!1),s.register(ae+sn,F={canUndo:!0,execute:function(e,i,n){return be(e,i,n,function(e){var n,t,o,r,a,n=i.selections;if(0<n.length){for(t=[],o=0,r=n;o<r.length;o++)D(t,(a=r[o]).col,a.colCount);try{e.NMi.togglePinnedColumns(t)}catch(e){return!1}}})}},null,!1,!1,!1,!1),s.register(ae+Ct,M={canUndo:!0,execute:function(e,n,t){return be(e,n,t,function(e){s.execute({cmd:"ganttSheetInsertTask"})})}},null,!1,!1,!1,!1),s.register(ae+kt,O={canUndo:!0,execute:function(e,n,t){return be(e,n,t,function(){return be(e,n,t,function(){s.execute({cmd:"ganttSheetDeleteTask"})})})}},null,!1,!1,!1,!1),s.register(ae+At,V={canUndo:!0,execute:function(e,n,t){return be(e,n,t,function(e){s.execute({cmd:"ganttSheetScrollToTask"})})}},null,!1,!1,!1,!1),s.register(ae+St,R={canUndo:!0,execute:function(e,n,t){return be(e,n,t,function(e){s.execute({cmd:"ganttSheetChangeTaskMode",taskMode:"Manual"})})}},null,!1,!1,!1,!1),s.register(ae+Tt,N={canUndo:!0,execute:function(e,n,t){return be(e,n,t,function(e){s.execute({cmd:"ganttSheetChangeTaskMode",taskMode:"Auto"})})}},null,!1,!1,!1,!1),s.register(ae+Ft,U={canUndo:!0,execute:function(e,n,t){return be(e,n,t,function(e){return To(n,e)})}},null,!1,!1,!1,!1),s.register(ae+Mt,L={canUndo:!0,execute:function(e,n,t){return be(e,n,t,function(e){return To(n,e,!0)})}},null,!1,!1,!1,!1),s.register(ae+Ot,E={canUndo:!0,execute:function(e,n,t){return be(e,n,t,function(e){s.execute({cmd:"ganttSheetIndentTasks"})})}},null,!1,!1,!1,!1),s.register(ae+Vt,P={canUndo:!0,execute:function(e,n,t){return be(e,n,t,function(e){s.execute({cmd:"ganttSheetOutdentTasks"})})}},null,!1,!1,!1,!1),s.register(ae+ln,j={canUndo:!0,execute:function(e,n,t){return be(e,n,t,function(e){try{e.NMi.promoteHierarchyLevel(n.activeRow)}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(ae+mn,H={canUndo:!0,execute:function(e,n,t){return be(e,n,t,function(e){try{e.NMi.demoteHierarchyLevel(n.activeRow)}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(ae+fn,G={canUndo:!0,execute:function(e,n,t){return be(e,n,t,function(e){try{e.NMi.addHierarchyItemAfter(n.activeRow)}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(ae+dn,_={canUndo:!0,execute:function(e,n,t){return be(e,n,t,function(e){try{e.NMi.addHierarchyItemBefore(n.activeRow)}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(ae+pn,B={canUndo:!0,execute:function(e,n,t){return be(e,n,t,function(e){try{e.NMi.addHierarchyItemAbove(n.activeRow)}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(ae+vn,W={canUndo:!0,execute:function(e,n,t){return be(e,n,t,function(e){try{e.NMi.addHierarchyItemBelow(n.activeRow)}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(ae+hn,K={canUndo:!0,execute:function(e,n,t){return be(e,n,t,function(e){try{e.NMi.moveUp(n.activeRow)}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(ae+xn,Z={canUndo:!0,execute:function(e,n,t){return be(e,n,t,function(e){try{e.NMi.moveDown(n.activeRow)}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(ae+wn,z={canUndo:!0,execute:function(e,n,t){return be(e,n,t,function(e){try{e.NMi.expandAllHierarchyLevels()}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(ae+gn,J={canUndo:!0,execute:function(e,n,t){return be(e,n,t,function(e){try{e.NMi.collapseAllHierarchyLevels()}catch(e){return!1}})}},null,!1,!1,!1,!1),I={canUndo:!0,execute:function(e,t,n){return be(e,t,n,function(e){try{var n=parseInt(t.cmd.charAt((ae+bn).length),10)-1;e.NMi.expandHierarchyLevel(n)}catch(e){return!1}})}},ro(9,function(e){s.register(ae+bn+(e+1),I,null,!1,!1,!1,!1)}),s.register(ae+ft,q={canUndo:!1,execute:function(e,n){var n,t,n,o,n=n.itemName.substr(10),t=e.ep(),n=e.getSheetPosition(n);e.w2.g2(n),(o=e.getTab()).scrollTabToActive(t,n)}},null,!1,!1,!1,!1),s.register(ae+un,Q={canUndo:!0,execute:function(e,t,n){return be(e,t,n,function(n){e.suspendCalcService(),Gt(t.selections,Rt,function(e){n.setRowVisible(e,!1)}),e.resumeCalcService(!1)})}},null,!1,!1,!1,!1),s.register(ae+Vn,X={canUndo:!0,execute:function(e,t,n){return be(e,t,n,function(n){e.suspendCalcService(),Gt(t.selections,Nt,function(e){n.setColumnVisible(e,!1)}),e.resumeCalcService(!1)})}},null,!1,!1,!1,!1),s.register(ae+on,Y={canUndo:!1,execute:function(e){var n,t,o,r,a,i,u,c,s,l,m,l,m,t,f,f,n=0,t=e.qv();if(t.forEach(function(e){e.visible()===oe.SheetTabVisible.visible&&(n+=1)}),o=(0,oe.jf)(e),n<=1)Co(o);else{if(a=[],t.forEach(function(e){e.b2()&&a.push(e)}),n!==a.length){for(i=0;i<a.length;i++)l={sheetName:c=(u=a[i]).name(),propertyName:"isVisible",cancel:!1,sheetIndex:s=e.Ese(c),sheetPosition:e.getSheetPosition(c),oldValue:!0,newValue:!1},e.ki(oe.Events.SheetChanging,l),m={cancel:!1,oldSheet:u},c===o.name()&&e.ki(oe.Events.ActiveSheetChanging,m),l.cancel||m.cancel||(u.b2(!1,!0),Pt.push(u),u.visible(!1),l=(0,oe.jf)(e),i===a.length-1&&l&&!l.isSelected()&&(r={oldValue:!1,newValue:!0,sheetName:m=l.name(),propertyName:"isSelected",cancel:!1,sheetIndex:e.Ese(m),sheetPosition:d.getSheetPosition(m)},e.ki(oe.Events.SheetChanging,r)),e.ki(oe.Events.SheetChanged,{sheetName:c,propertyName:"isVisible",sheetIndex:s,sheetPosition:e.getSheetPosition(c),oldValue:!0,newValue:!1}));f=(t=(0,oe.jf)(e))&&t.name(),r&&(r.cancel?t.Ut.qj(!1):(t.Ut.qj(!0),e&&e.w2&&e.w2.repaint(),f={oldValue:!1,newValue:!0,sheetName:f,propertyName:"isSelected",sheetIndex:e.Ese(f),sheetPosition:e.getSheetPosition(f)},e.ki(oe.Events.SheetChanged,f))),o!==t&&e.ki(oe.Events.ActiveSheetChanged,{oldSheet:o,newSheet:t})}else Co(o);e.undoManager().clear()}}},null,!1,!1,!1,!1),s.register(ae+rn,$={canUndo:!0,execute:function(o,r,e){return be(o,r,e,function(n){var e,t,e=r.selections,t=r.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;re(t)&&(t=r.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=Bt(n,e[0])),1===e.length&&t?(n.setRowVisible(e[0].row-1,!0),n.$A(e[0].row-1)):(o.suspendCalcService(),Gt(e,Rt,function(e){n.setRowVisible(e,!0),e===n.pw()&&(n.Tb=0,n.tw())}),o.resumeCalcService(!1))})}},null,!1,!1,!1,!1),s.register(ae+an,ee={canUndo:!0,execute:function(o,r,e){return be(o,r,e,function(n){var e,t,e=r.selections,t=r.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;re(t)&&(t=r.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=Bt(n,e[0])),1===e.length&&t?(n.setColumnVisible(e[0].col-1,!0),n.o9(e[0].col-1)):(o.suspendCalcService(),Gt(e,Nt,function(e){n.setColumnVisible(e,!0),e===n.Sw()&&(n.Ab=0,n.ow())}),o.resumeCalcService(!1))})}},null,!1,!1,!1,!1),s.register(ae+tn,ne={canUndo:!1,execute:function(t,e){var o,n,r,a,i,u,e,c,o=t.qv();if(0===Pt.length)for(n=0;n<o.length;n++)o[n].visible()===oe.SheetTabVisible.hidden&&(Pt.push(o[n]),o[n].b2(!1));if(r=(0,oe.jf)(t),0<Pt.length){if(o.forEach(function(e){e!==r&&e.b2(!1,!0)}),i=a=void 0,e&&!re(e.activeSheetIndex)&&(a=o[e.activeSheetIndex]),e&&e.unhideSheetIndexes&&0<e.unhideSheetIndexes.length&&((e=e.unhideSheetIndexes).forEach(function(e){var n,n,n=o[e];!1!==(u=ko(t,n))&&-1<(n=Pt.indexOf(o[e]))&&Pt.splice(n,1)}),a=a||o[e[e.length-1]]),!a){if(!(a=Pt.pop()))return;if(!1===(u=ko(t,a)))return}if(!a)return;if(!1===(c=Ao(t,r,a)))return;t.setActiveSheet(a.name())}(0,oe.jf)(t)!==r&&So(t,r)}},null,!1,!1,!1,!1),s.register(ae+en,te={canUndo:!1,execute:function(e,n){var n,t,o,r,a,n=(0,oe._f)(e,n.sheetName);if(n&&(e.suspendPaint(),t=[],o=n.slicers.all())&&!Ce(o)){for(r in o)o.hasOwnProperty(r)&&(a=o[r]).isSelected()&&t.push(a.name());s.execute({cmd:"deleteSlicers",sheetName:n.name(),slicerNames:t}),e.resumePaint()}}},null,!1,!1,!1,!1),Fo(s),this.Yq=!0)},p.prototype.openAllSheetsListContextMenu=function(e,n,t,o){var r,t,r=this.menuView.maxHeight();!re(r)&&-1!==r||this.menuView.maxHeight(400),t=this.Zq(n,t),this.Hc(n),this.lq(t,n),this.dq(e,t,n),re(r)?this.menuView.maxHeight(-1):this.menuView.maxHeight(r),this.menuView.Wq&&this.menuView.Wq.hU(o)},p.prototype.Zq=function(e,n){var n,t,n=this.fq(n,e),t=2;return 0===e.options.tabStripPosition&&(n.x=n.x+2,n.y=n.y-2),n},jt=p,h.ContextMenu=jt,oe.Workbook.ch("contextmenu",{init:function(){var e=this;e.contextMenu||(e.contextMenu=new jt),e.contextMenu.oq(this)},setHost:function(){var n,e,n=this,e=n.Ti;n.contextMenu||(n.contextMenu=new jt),m(e).bind("contextmenu.gcSheet",function(e){if(n.options.allowContextMenu)return n.contextMenu.cq(e,n)})},dispose:function(){m(this.Ti).unbind("contextmenu.gcSheet")},onCultureChanged:function(){var e,n,t,o,e=this.contextMenu;e&&(n=e.menuData,t=e.nq(),o={},e.Vq(t,function(e){re(e.name)||(o[e.name]=e.text)}),e.Vq(n,function(e){re(e.name)||re(o[e.name])||(e.text=o[e.name])}))},fromJson:function(e){var n=this.contextMenu&&this.contextMenu.menuView,t=e.contextMenu;n&&!re(t)&&(n.Qq=e.scrollable,n.Kq=e.maxHeight)},toJson:function(e){var n=this.contextMenu&&this.contextMenu.menuView;!n||re(n.Qq)&&re(n.Kq)||(e.contextMenu={},e.contextMenu.scrollable=n.Qq,e.contextMenu.maxHeight=n.Kq)}})},"./dist/plugins/contextMenu/context-menu.ns.js":function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var t=t("./dist/plugins/contextMenu/context-menu.res.en.js");n.SR={en:t}},"./dist/plugins/contextMenu/context-menu.res.en.js":function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.tableDeleteColumns=n.tableDeleteOrInsertEntireSheetRow=n.tableDeleteRows=n.tableDelete=n.tableInsertColumnsRight=n.tableInsertColumnsLeft=n.tableInsertRowsBelow=n.tableInsertRowsAbove=n.tableInsert=n.removeFloatingObject=n.removeSlicer=n.toggleComment=n.deleteComment=n.editComment=n.unhideRows=n.unhideColumns=n.unhideSheet=n.hideSheet=n.hideColumns=n.hideRows=n.sortDescend=n.sortAscend=n.slicerSortDescend=n.slicerSortAscend=n.headerInsertCutCells=n.headerInsertCopiedCells=n.shiftCellsDown=n.shiftCellsRight=n.insertCutCells=n.insertCopiedCells=n.sort=n.filter=n.insertComment=n.deleteSheet=n.insertSheet=n.deleteColumns=n.deleteRows=n.insertColumns=n.insertRows=n.clearContents=n.pasteSpecial=n.pasteFormulaFormatting=n.pasteValuesFormatting=n.pasteFormatting=n.pasteValues=n.pasteFormula=n.pasteAll=n.pasteOptions=n.cut=n.copy=void 0,n.pivotTableExpand=n.pivotTableValueFilters=n.pivotTableLabelFilters_Date=n.pivotTableLabelFilters=n.pivotTableTop10=n.pivotTableHideSelectedItems=n.pivotTableKeepOnlySelectedItems=n.pivotTableClearFilterFrom_=n.pivotTableFieldSettings=n.pivotTableHideFieldList=n.pivotTableSubtotal_=n.pivotTableFilter=n.pivotTableExpandOrCollapse=n.pivotTableUnGroup=n.pivotTableGroup=n.pivotTableShowDetails=n.pivotTableIndex=n.pivotTableRankLargestToSmallest=n.pivotTableRankSmallestToLargest=n.pivotTablePercentRunningTotalIn=n.pivotTableRunningTotalIN=n.pivotTablePercentDifferenceFrom=n.pivotTableDifferenceFrom=n.pivotTableOfParentTotal=n.pivotTableParentColumnTotal=n.pivotTableParentRowTotal=n.pivotTableOf=n.pivotTableRowTotal=n.pivotTableColumnTotal=n.pivotTableGrandTotal=n.pivotTableNoCalculation=n.pivotTableShowValueAs=n.pivotTableMoreOptions=n.pivotTableDistinctCount=n.pivotTableProduct=n.pivotTableMin=n.pivotTableMax=n.pivotTableAverage=n.pivotTableCount=n.pivotTableSum=n.pivotTableSummarizeValuesBy=n.pivotTableSort=n.pivotTableNumberFormat=n.pivotTableOptions=n.pivotTableValueFieldSettings=n.pivotTableRemoveGrandTotal=n.pivotTableRemove_=n.pivotTableMove=n.pivotTableRefresh=n.hideSheetFailureInfo=void 0,n.autoSchedule=n.manuallySchedule=n.outdentTasks=n.indentTasks=n.deleteTasks=n.insertTasks=n.scrollToTasks=n.reportSheetResetCellValue=n.reportSheetSubmit=n.reportSheetDeleteRecord=n.reportSheetAddRecord=n.paste=n.expandLevel9=n.expandLevel8=n.expandLevel7=n.expandLevel6=n.expandLevel5=n.expandLevel4=n.expandLevel3=n.expandLevel2=n.expandLevel1=n.collapseAllLevels=n.expandAllLevels=n.addBelow=n.addAbove=n.addBefore=n.addAfter=n.moveDown=n.moveUp=n.demote=n.promote=n.pinColumns=n.pinRows=n.pivotTableSortMoreOptions=n.pivotTableSortDescend=n.pivotTableSortAscend=n.sigmaValueTemp=n.sigmaValue=n.pivotTableMove_ToColumns=n.pivotTableMove_ToRight=n.pivotTableMove_ToLeft=n.pivotTableMove_ToEnd=n.pivotTableMove_Down=n.pivotTableMove_Up=n.pivotTableMove_ToBeginning=n.pivotTableExpandTo_=n.pivotTableCollapseTo_=n.pivotTableCollapseEntireField=n.pivotTableExpandEntireField=n.pivotTableCollapse=void 0,n.unhideColumn=n.hideColumn=void 0,n.copy="Copy",n.cut="Cut",n.pasteOptions="Paste Options:",n.pasteAll="All",n.pasteFormula="Formulas",n.pasteValues="Values",n.pasteFormatting="Formatting",n.pasteValuesFormatting="Values&Formatting",n.pasteFormulaFormatting="Formula&Formatting",n.pasteSpecial={title:"Paste Special...",formulaAndNumberFormat:"Formula & Number Formatting",keepSourceFormatting:"Keep Source Formatting",noBorders:"No Borders",columnWidth:"Keep Source Column Widths",transpose:"Transpose",valuesAndNumberFormat:"Values & Number Formatting",valueAndSourceFormat:"Values & Source Formatting",pasteLink:"Paste Link",otherPasteOptions:"Other Paste Options"},n.clearContents="Clear Contents",n.insertRows="Insert",n.insertColumns="Insert",n.deleteRows="Delete",n.deleteColumns="Delete",n.insertSheet="Insert",n.deleteSheet="Delete",n.insertComment="Insert Comment",n.filter="Filter",n.sort="Sort",n.insertCopiedCells="Insert Copied Cells...",n.insertCutCells="Insert Cut Cells...",n.shiftCellsRight="Shift Cells Right",n.shiftCellsDown="Shift Cells Down",n.headerInsertCopiedCells="Insert Copied Cells",n.headerInsertCutCells="Insert Cut Cells",n.slicerSortAscend="Sort A to Z",n.slicerSortDescend="Sort Z to A",n.sortAscend="Sort A to Z",n.sortDescend="Sort Z to A",n.hideRows="Hide",n.hideColumns="Hide",n.hideSheet="Hide",n.unhideSheet="Unhide",n.unhideColumns="Unhide",n.unhideRows="Unhide",n.editComment="Edit Comment",n.deleteComment="Delete Comment",n.toggleComment="Show/Hide Comment",n.removeSlicer="Remove",n.removeFloatingObject="Remove",n.tableInsert="Insert",n.tableInsertRowsAbove="Table Rows Above",n.tableInsertRowsBelow="Table Row Below",n.tableInsertColumnsLeft="Table Columns to the Left",n.tableInsertColumnsRight="Table Columns to the Right",n.tableDelete="Delete",n.tableDeleteRows="Table Rows",n.tableDeleteOrInsertEntireSheetRow="Entire Sheet Row",n.tableDeleteColumns="Table Columns",n.hideSheetFailureInfo="A workbook must contain at least one visible worksheet.\nTo hide, delete or move the selected sheet(s), you must first insert a new sheet or unhide a sheet that is already hidden.",n.pivotTableRefresh="Refresh",n.pivotTableMove="Move",n.pivotTableRemove_="Remove {0}",n.pivotTableRemoveGrandTotal="Remove GrandTotal",n.pivotTableValueFieldSettings="Value Field Settings...",n.pivotTableOptions="PivotTable Options...",n.pivotTableNumberFormat="Number Format...",n.pivotTableSort="Sort",n.pivotTableSummarizeValuesBy="Summarize Values By",n.pivotTableSum="Sum",n.pivotTableCount="Count",n.pivotTableAverage="Average",n.pivotTableMax="Max",n.pivotTableMin="Min",n.pivotTableProduct="Product",n.pivotTableDistinctCount="Distinct Count",n.pivotTableMoreOptions="More Options",n.pivotTableShowValueAs="Show Value As",n.pivotTableNoCalculation="No Calculation",n.pivotTableGrandTotal="% of Grand Total",n.pivotTableColumnTotal="% of Column Total",n.pivotTableRowTotal="% of Row Total",n.pivotTableOf="% Of...",n.pivotTableParentRowTotal="% of Parent Row Total",n.pivotTableParentColumnTotal="% of Parent Column Total",n.pivotTableOfParentTotal="% of Parent Total...",n.pivotTableDifferenceFrom="Difference From...",n.pivotTablePercentDifferenceFrom="% Difference From...",n.pivotTableRunningTotalIN="Running Total In...",n.pivotTablePercentRunningTotalIn="% Running Total In...",n.pivotTableRankSmallestToLargest="Rank Smallest to Largest...",n.pivotTableRankLargestToSmallest="Rank Largest to Smallest...",n.pivotTableIndex="Index",n.pivotTableShowDetails="Show Details",n.pivotTableGroup="Group...",n.pivotTableUnGroup="Ungroup...",n.pivotTableExpandOrCollapse="Expand/Collapse",n.pivotTableFilter="Filter",n.pivotTableSubtotal_="Subtotal {0}",n.pivotTableHideFieldList="Hide Field List",n.pivotTableFieldSettings="Field Settings...",n.pivotTableClearFilterFrom_="Clear Filter From {0}",n.pivotTableKeepOnlySelectedItems="Keep Only Selected Items",n.pivotTableHideSelectedItems="Hide Selected Items",n.pivotTableTop10="Top 10...",n.pivotTableLabelFilters="Label Filters...",n.pivotTableLabelFilters_Date="Date Filters...",n.pivotTableValueFilters="Value Filters...",n.pivotTableExpand="Expand",n.pivotTableCollapse="Collapse",n.pivotTableExpandEntireField="Expand Entire Field",n.pivotTableCollapseEntireField="Collapse Entire Field",n.pivotTableCollapseTo_="Collapse to {0}",n.pivotTableExpandTo_="Expand to {0}",n.pivotTableMove_ToBeginning="Move {0} to Beginning",n.pivotTableMove_Up="Move {0} Up",n.pivotTableMove_Down="Move {0} Down",n.pivotTableMove_ToEnd="Move {0} to end",n.pivotTableMove_ToLeft="Move {0} to left",n.pivotTableMove_ToRight="Move {0} to Right",n.pivotTableMove_ToColumns="Move {0} to columns",n.sigmaValue="\u2211 Values",n.sigmaValueTemp="Values",n.pivotTableSortAscend="Sort Smallest to Largest",n.pivotTableSortDescend="Sort Largest to Smallest",n.pivotTableSortMoreOptions="More Sort Options...",n.pinRows="Pin/Unpin Rows",n.pinColumns="Pin/Unpin Columns",n.promote="Promote",n.demote="Demote",n.moveUp="Move Up",n.moveDown="Move Down",n.addAfter="Add After",n.addBefore="Add Before",n.addAbove="Add Above",n.addBelow="Add Below",n.expandAllLevels="Expand All Levels",n.collapseAllLevels="Collapse All Levels",n.expandLevel1="Expand to Level 1",n.expandLevel2="Expand to Level 2",n.expandLevel3="Expand to Level 3",n.expandLevel4="Expand to Level 4",n.expandLevel5="Expand to Level 5",n.expandLevel6="Expand to Level 6",n.expandLevel7="Expand to Level 7",n.expandLevel8="Expand to Level 8",n.expandLevel9="Expand to Level 9",n.paste="Paste",n.reportSheetAddRecord="Add Record",n.reportSheetDeleteRecord="Delete Record",n.reportSheetSubmit="Submit",n.reportSheetResetCellValue="Reset Current Cell",n.scrollToTasks="Scroll To Task",n.insertTasks="Insert Task",n.deleteTasks="Delete Task",n.indentTasks="Indent Task",n.outdentTasks="Outdent Task",n.manuallySchedule="Manually Schedule",n.autoSchedule="Auto Schedule",n.hideColumn="Hide Column",n.unhideColumn="Unhide Column"},"./dist/plugins/contextMenu/menu-view.js":function(L,e,n){var o,l,C,m,n,w,E,P,u,g,t,i,j,k,H,G,c,s,f,_,B,W,r,K,d,a,Z,z,J,p,v,n,q,Q,X,Y,$,ee,ne,te,oe,re,ae,ie,ue,ce,se,le,h,me,x,fe,b,A,S,de,pe,ve,T,y,F,M,he,xe,O,V,R,we,ge,be,Ce,ke,Ae,Se,Te,ye,Fe,N,U,Me,Oe,n;function Ve(e){return e instanceof Object}function I(e,n,t){var o=this;o.Ti=e,o.Jq=n,o.Xq(e,n,t)}function D(){}function Re(e,n,t,o,r){var a,i,t;w(n.pivotTableName)&&(n.pivotTableName=e.name()),w(n.pivotTableCellInfo)&&(n.pivotTableCellInfo=e.getPivotInfoImp(t,o,!1,!1,!0)),"gc.spread.sortAscend"!==r&&"gc.spread.sortDescend"!==r||!e.isSortValueField(n.pivotTableCellInfo)||(a="gc.spread.sortAscend"===r?0:1,(t=(i=e.dh).Q.map(function(e){return e.Zc})).sort(function(e,n){var e=e.localeCompare(n);return 1==a?-1*e:e}),n.sortValueInfo={sortedFieldNames:t,sortType:a})}Object.defineProperty(e,"__esModule",{value:!0}),e.MenuView=void 0,o=n("Common"),l=n("Core"),C=l.GC$,m=l.mt.En,n=o.Common.lt,w=n.ht,E=n.Eh,P=n.tv,u=void 0,g=null,t=document,i=window,j=Math.max,k=Math.min,H=Math.floor,c="mouseenter",s="mouseleave",f="click",_="mousewheel",B="DOMMouseScroll",W="gc.command.executed",r=".",K="gc-ui-contextmenu",d=".gcScrollWrapper",a="-",Z="container",J="disable-hover",p="text",v="icon",n="menuitem",q="nonselective-menuitem",Q="menuitem-content",X="sup-container",Y="separator",$="sup-indicator",ee="subitems-container",ne="group-container",te="title",oe="group-header",re="groupitems-container",ae="groupitem",ie="nonexecutable",ue="executable",ce="disable",se="gcUIElement",le="gcContextMenu",h="gc-statusbar-contextmenu",me=" ui-widget",x=" ui-state-hover",fe=" ui-icon ui-icon-triangle-1-e",b="DIV",A="SPAN",S="keydown.ctx.gcSheet",pe="inline-block",ve="visible",T="hidden",y="block",F=de="none",M="overflow",he="split-item-container",xe="splitMenu-content",V=(O=function(e){return K+a+e})(z="hover"),R=O(n),we=O(q),ge=O(Q),be=O(ue),Ce=O(X),ke=O(ee),Ae=h+a+"check",Se=h+a+"check-container",Te=h+a+"content",ye=h+a+"status",Fe=12,N="splitSubMenu",(n=U=U||{})[n.up=0]="up",n[n.down=1]="down",I.prototype.Xq=function(e,n,t){var o,r,a,i,o=this,r=o.qq=C(document.createElement("DIV")),a=o.$q=document.createElement("DIV"),i=o.t$=document.createElement("DIV");r[0].className="gc-ui-contextmenu-scroll-wrapper",a.className="gc-ui-contextmenu-scroll-indicator",a.innerText=String.fromCharCode(708),i.className="gc-ui-contextmenu-scroll-indicator",i.innerText=String.fromCharCode(709),e.append(C(a)),e.append(r),r.append(n),r.height(t.height-12),e.append(C(i)),o.n$=r.height()+12,o.e$=o.i$(n),o.NK(U.up),o.aY()},I.prototype.i$=function(e){var n=0;return e[0].childNodes.forEach(function(e){n+=e.offsetHeight}),n},I.prototype.r$=function(){return this.qq},I.prototype.o$=function(e){var n=this;if(w(e))return n.qq.scrollTop();n.qq.scrollTop(e),n.a$(e)},I.prototype.hU=function(e){for(var n,t,o,r,n,t=this.Jq[0].childNodes,o=0,r=0;r<e;r++)o+=t[r].offsetHeight;this.o$(o-12)},I.prototype.aY=function(){var t=this,e=t.$q,n=t.t$,o=t.qq,r=t.n$,a=t.e$;C(e).bind(c+d,function(){t.u$=i.setInterval(function(){var e,n,e=o.scrollTop(),n;t.o$(H(e<=10?0:e-10))},100)}),C(e).bind(s+d,function(){i.clearInterval(t.u$)}),C(e).bind(f+d,function(){t.o$(0)}),C(n).bind(c+d,function(){t.u$=i.setInterval(function(){var e,n,e=o.scrollTop(),n;t.o$(a-r-10<=e?a-r+2:e+10)},100)}),C(n).bind(s+d,function(){i.clearInterval(t.u$)}),C(n).bind(f+d,function(){t.o$(a-r)}),o.bind(_+d,function(e){t.a$(o.scrollTop()+(e.deltaY||-e.wheelDelta||0))}).bind(B+d,function(e){t.a$(o.scrollTop()+(e.deltaY||-e.wheelDelta||0))})},I.prototype.KX=function(){var e=this,n=e.$q,t=e.t$,e=e.qq;C(n).unbind(d),C(t).unbind(d),e.unbind(d)},I.prototype.eG=function(){var e=this;e.KX(),e.Ti.append(e.Jq),C(e.qq).remove(),C(e.$q).remove(),C(e.t$).remove(),e.Ti=u,e.Jq=u,e.qq=u,e.$q=u,e.t$=u},I.prototype.$c=function(e){switch(e){case U.up:this.$q.style.display=y;break;case U.down:this.t$.style.display=y}},I.prototype.NK=function(e){switch(e){case U.up:this.$q.style.display=F;break;case U.down:this.t$.style.display=F}},I.prototype.a$=function(e){var n=this,t=n.n$,o=n.e$;e<1?(n.$c(U.down),n.NK(U.up),n.s$(!0)):o-t-1<e?(n.$c(U.up),n.NK(U.down),n.s$(!1)):(n.$c(U.up),n.$c(U.down),n.s$(!0))},I.prototype.s$=function(e){var n=this,t=n.qq,n=n.n$;e&&(n-=12),t.height(n)},Me=I,D.prototype.ZX=function(e,n,t,o){var r=this;r.Ti=C(e),r.c$=P(n),r.Qy=t.commandManager(),r.DJ=t,r.zX=o,r.f$=[],r.l$={},r.h$=[],r.d$={},r.JX=g,r.v$()},D.prototype.m$=function(){var e,n,t,o,r,a,i,u,c,s,l,c,s,n,m,c,f,d,p,v,h,d,f,v,p,v,x,d,e=this,n=e.g$,t=e.Ti,o=e.hostInfo;n[0].style.maxHeight="",r=parseInt(t.css("left"),10),a=parseInt(t.css("top"),10),i=t.width(),u=t.height(),(c=e.U2(u))&&(s=e.Wq=e.p$(t,n),u=e.b$()),"number"==typeof e.Kq&&(c?((l=s.r$())[0].style.maxHeight=e.Kq+"px",n.css(M,g)):(n[0].style.maxHeight=e.Kq+"px",n.css(M,T),u=n.height()+2)),s=(c=e.y$()).windowTop,n=c.windowLeft,m=c.windowWidth,c=c.windowHeight,w(o)?(h=(v=e.w$()).contextTop,d=v.contextLeft,f=v.contextWidth,v=v.contextHeight,p=h+a-Math.max(s,h),v=k(s+c,h+v)-(h+a),x=s+c-h+a,d=k(n+m,d+f)-(d+r),f<r+i?t.css("left",r=0<r-i?r-i:r):d<i&&t.css("left",r-i),v<u&&(u<=p?t.css("top",a-u):u<=p+v?t.css("top",a+v-u):x<u?t.css("top",s+c-h-u):t.css("top",s<h?0:s-h))):(o.left+r+i>n+m&&t.css("left",r=0<r-i?r-i:r),d=((f=e.DJ&&e.DJ.getHost())&&f.getBoundingClientRect().top)<o.top,p=o.top,d?u<=p+a?t.css("top",a-u):t.css("top",-p):c-p-a<u&&t.css("top",c-p-u))},D.prototype.y$=function(){return{windowTop:i.scrollY||i.pageYOffset,windowLeft:i.scrollX||i.pageXOffset,windowWidth:i.clientWidth||i.innerWidth,windowHeight:i.clientHeight||i.innerHeight}},D.prototype.w$=function(){var e,n,t,o,r,e,t,e=this;return e.DJ&&(n=(t=(e=C(e.DJ.getHost())).offset()).top,t=t.left,o=e.width(),r=e.height()),{contextTop:n,contextLeft:t,contextWidth:o,contextHeight:r}},D.prototype.p$=function(e,n){return new Me(e,n,{height:this.b$()})},D.prototype.M$=function(){var e=this,n=e.g$;"number"==typeof e.Kq&&(n[0].style.maxHeight=e.Kq+"px",n.css(M,T))},D.prototype.v$=function(){var e,n,t,n,o,e=this,n=e.c$;w(n)||!Ve(n)||n.length<1||(n instanceof Array||(n=[n]),n=e.S$(t="menuView",n),e.l$.menuView=n,o=e.A$(e.c$),e.g$=o,e.M$(),o.appendTo(e.Ti),this.Gpe(n),e.m$(),e.aY(),e.h$.push({name:t,menuView:o}))},D.prototype.Gpe=function(e){e.forEach(function(e){e.menuItemData.type===N&&(e.host=e.host.find("."+O(xe)))})},D.prototype.S$=function(e,n){for(var t,o,r,a,i,u,t=this,o=n.length,r=[],a=0;a<o;a++)i=n[a],w(i)||"separator"===i.type||(i.type===N?(u=this.convertSplitSubMenuIconData(i),t.l$[u.name]=t.S$(u.name,u.subMenu),t.l$[u.name].push(t.x$(e,u))):i.subMenu?t.l$[i.name]=t.S$(i.name,i.subMenu):"groupHeader"===i.type&&(t.I$(i,n),t.l$[i.name]=t.S$(e,i.groups)),r.push(t.x$(e,i)));return r},D.prototype.convertSplitSubMenuIconData=function(e){var n={name:e.name+"-sub",subMenu:e.subMenu,type:"splitSubMenuIcon"};return e.subMenuIcon=n,e.subMenu=void 0,n},D.prototype.x$=function(e,n){var t,o,r,r,t=this,o="groupHeader"===n.type||n.type===N?t.N$():t.k$(),r=t.createMenuItemElement(n);if(!w(r))return r instanceof HTMLElement&&(r=C(r)),w(n.itemClass)||o.addClass(n.itemClass),w(n.title)||o.attr("title",n.title),r.appendTo(o),r={name:n.name,host:o,menuItemData:n,menuName:e},this.SpreadJSDesignerAutoTest&&this.SpreadJSDesignerAutoTest(r.host,r.menuItemData),t.f$.push(r),r},D.prototype.k$=function(){var e=C(m(b));return e.addClass(R),e},D.prototype.N$=function(){var e=C(m(b));return e.addClass(we),e},D.prototype.createMenuItemElement=function(e){var n=this;switch(e.type){case"groupHeader":return n.D$(e);case"groupItem":return n._$(e);case"statusBar":return n.E$(e);case N:return n.Upe(e);case"splitSubMenuIcon":return this.Hpe(e)}return e.subMenu?n.j$(e):n.O$(e)},D.prototype.O$=function(e){var n,t,t,n=C(m(b)).addClass(ge);return e.command?e.disable?n.addClass(O(ce)):n.addClass(be):n.addClass(O(ie)),t=C(m(A)).addClass(O(v)),e.iconClass&&t.addClass(e.iconClass),t.appendTo(n),e.text&&((t=C(m(A)).addClass(O(p)))[0].innerHTML=o.Common.zf.j0(e.text),t.appendTo(n)),n},D.prototype.B$=function(e){return C(m(b)).addClass(O(Y))},D.prototype.D$=function(e){var n,t,o,r,a,i,u,c,s,n=this,t=C(m(b)).addClass(O(ne));if(!(e.groups.length<=0)){for((o=n.O$(e)).addClass(O(oe)),o.appendTo(t),r=C(m(b)).addClass(O(re)),i=(a=e.groups).length,u=0;u<i;u++)(s=(c=n.L$("name",a[u].name)).host).addClass(O(ae)),s.appendTo(r);r.appendTo(t)}return t},D.prototype._$=function(e){var n,t,o,n,t=this.O$(e),o;return t.find(r+O(p)).remove(),t.attr(te,e.text),t},D.prototype.E$=function(e){var n,t,o,r,e,a,i,a,o,n=m("div"),t=C(n).addClass(ge),o=e.visible,r=e.menuContent,e=e.status,a=m("div");return C(a).addClass(Ae),i=m("div"),C(i).addClass(Se),i.appendChild(a),i.style.visibility=o?ve:T,(a=m("div")).innerText=r,C(a).addClass(Te),o=m("div"),C(o).addClass(ye),e?(o.innerText=e,o.style.display=pe):o.style.display=de,n.appendChild(i),n.appendChild(a),n.appendChild(o),t},D.prototype.j$=function(e,n){var t,o,r,a,i,u,t=this,o=C(m(b)).addClass(Ce),r=t.O$(e);return 0<e.subMenu.length&&((a=C(m(A)).addClass(O($+fe))).appendTo(r),i=t.A$(e.subMenu),u=C(m(b)).addClass(ke),n&&u.addClass(n),i.appendTo(u),u.appendTo(t.Ti),t.d$[e.name]=u),r.appendTo(o),o},D.prototype.Hpe=function(e){var n,e,n,e=this.j$(e,O("split-sub-menu"));return e.addClass(O("splitMenu-icon")),e.find("."+O(v)).remove(),e},D.prototype.Upe=function(e){var n,t,o,r,n=this,t=C(m(b)).addClass(O("splitMenu-container"));return e.subMenuIcon&&((o=n.O$(e)).addClass(O(xe)).addClass(R),o.appendTo(t),(r=n.L$("name",e.subMenuIcon.name)).host.appendTo(t)),t},D.prototype.A$=function(e){for(var n,t,o,r,a,i,i,u,n=this,t=C(m(b)).addClass(O(Z+me)),o=e.length,r=0;r<o;r++)w(e[r])||(a=e[r].name,w(a)?"separator"===e[r].type&&(i=n.N$(),(u=n.B$(e[r])).appendTo(i),i.appendTo(t)):(i=n.L$("name",a),w(i)||i.host.appendTo(t)));return t},D.prototype.L$=function(e,n){for(var t,o,r,a,t,o=this.f$,r=o.length,a=0;a<r;a++)if(n instanceof C?n[0]===o[a][e][0]:o[a][e]===n)return o[a]},D.prototype.I$=function(e,n){var t,o,r;for(e.groups=[],t=n.length,o=0;o<t;o++)(r=n[o])&&r.group&&r.group===e.name&&(r.type="groupItem",e.groups.push(r),n.splice(o,1),o--)},D.prototype.aY=function(){var a=this;C(r+R).bind(c,function(){var e,n,t,o,r,e=C(this),n=a.L$("host",e);for(a.JX=n,o=0,r=(t=a.h$).length;o<r&&n.menuName!==a.h$[r-o-1].name;o++)a.F$();a.P$(),a.G$(!1)}).bind(s,function(){a.JX=g,a.P$()}).bind(f,function(e){var n,n,t,n=C(this),n=a.L$("host",n);a.JX=n,(t=a.U$(!1,e))&&a.lQ()}),C(t).bind(S,function(e){var n,t,t;if(!e.target||C(e.target).attr(se)!==le){switch(e.keyCode){case 27:(n=a.F$())||a.lQ();break;case 32:case 13:(n=a.U$(!0,e))&&a.lQ();break;case 9:e.shiftKey?a.H$(!1,!0):a.H$(!0,!0);break;case 37:t=a.F$(),(t=a.L$("name",t))&&(a.JX=t),a.JX&&a.JX.menuItemData.group&&a.H$(!1,!0);break;case 38:a.H$(!1,!1);break;case 39:a.JX&&a.JX.menuItemData.group&&a.H$(!0,!0),a.G$(!0);break;case 40:a.H$(!0,!1)}e.preventDefault?e.preventDefault():e.returnValue=!1}})},D.prototype.z$=function(e,n){var t,o,r,a,i,o,u,c,s,l,u,m,f,d,n,f,p,v,h,x,v,w,d,s,l,g,a,b,t=this,o=t.w$(),r=o.contextTop,a=o.contextLeft,i=o.contextWidth,o=o.contextHeight,u=t.y$(),c=u.windowTop,s=u.windowLeft,l=u.windowWidth,u=u.windowHeight,m=n.parentRelatedLeft,f=n.parentRelatedTop,d=n.parentAbsoluteLeft,n=n.parentWidth;return e.css("top",f+2),f=e.width(),p=e.height(),v=e.position(),x=(h=e.offset()).top,v=v.top,d+n+f>k(s+l,a+i)?e.css("left",m-f-1):e.css("left",m+n),d=t.V$(),(s=t.U2(p))&&(l=C(e[0].firstChild),w=t.p$(e,l),p=t.b$()),"number"==typeof t.Kq&&(s?(g=w.r$())[0].style.maxHeight=t.Kq+"px":(e[0].style.maxHeight=t.Kq+"px",e.css(M,T),p=e.height())),(b=(a=k(c+u,r+o))-x)<p&&(d<p?e.css("top",c<r?0:c-r):e.css("top",v+a-x-p)),w},D.prototype.Y$=function(e){return e.command},D.prototype.getCommandOptions=function(e,n,t){},D.prototype.U$=function(e,n){var t,o,o,t=this,o=t.JX;if(o&&!o.menuItemData.disable){if(!(o=o.menuItemData).subMenu)return t.zA(n),!0;0<o.subMenu.length&&t.G$(e)}},D.prototype.zA=function(e){var n,t,o,e,r,n,a,i,u,c,s,e,n=this,t=n.JX,o=n.Y$(t.menuItemData);w(o)||(e=n.getCommandOptions(t.menuItemData,t.host[0],e),r=n.Qy,E(o)?o(n.DJ,e):(a=(n=(0,l.jf)(n.DJ))&&n.getActiveColumnIndex(),i=n&&n.getActiveRowIndex(),u=n&&n.tables&&n.tables.find(i,a),c=n&&n.pivotTables&&n.pivotTables.findPivotTable(i,a),s=t.menuItemData.name,w(c)?r.execute({cmd:o,sheetName:n&&n.name(),selections:n&&n.getSelections(),activeRow:i,activeCol:a,commandOptions:e,tableName:u?u.name():"",itemName:s}):(e=t.menuItemData.commandOptions,Re(c,e=w(e)?{}:e,i,a,s),r.execute({cmd:o,sheetName:n.name(),selections:n.getSelections(),activeRow:i,activeCol:a,commandOptions:e,itemName:s}))))},D.prototype.KX=function(){C(r+R).unbind(c).unbind(s).unbind(f),C(t).unbind(S)},D.prototype.L0=function(){var e=this;e.Ti=g,e.c$=g,e.Qy=g,e.DJ=g,e.zX=g,e.f$=g,e.l$=g,e.JX=g,e.g$=g,e.d$=g,e.Wq&&(e.Wq.eG(),e.Wq=u),e.KX()},D.prototype.F$=function(){var e,e,n,t,e=this;if(1<e.h$.length)return(t=(n=(e=e.h$.pop()).menuView).find(r+R)).removeClass(V+x),e.menuView.hide(),e.subMenuWrapper&&(e.subMenuWrapper.eG(),e.subMenuWrapper=u),e.name},D.prototype.P$=function(){var e,n,t,o,r,e=this,n=e.Z$(!0);if(n){for(t=0,o=n.length;t<o;t++)n[t].host.removeClass(V+x);e.JX&&((r=e.JX.menuItemData).disable?e.JX.host.addClass(O(J+x)):e.JX.host.addClass(V+x))}},D.prototype.lQ=function(){var e=this;e.zX.trigger(W),e.L0()},D.prototype.H$=function(e,n){var t,n,o,r,r,r,e,r,a,t,n,i,t=this,n=t.Z$(n);t.JX&&!(o=t.W$(t.JX,n))&&(r=t.l$[t.JX.menuItemData.group])&&(r=r[0],o=t.W$(r,n)),o=e?"number"==typeof(o=o!==u&&o!==n.length-1?o:-1)?o+1:0:"number"==typeof(o=o!==u&&0!==o?o:n.length)?o-1:0,t.JX=n[o],t.P$(),r=t.h$[t.h$.length-1],e=n.length,(r=r&&("menuView"===r.name?t.Wq:r.subMenuWrapper))&&(n=(t=(a=r.o$())+t.JX.host.position().top)+n[o].host.height()+2,i=r.r$().height(),t<a+12?0===o?r.o$(0):r.o$(t-12):a+i<n&&(o===e-1?r.o$(r.r$().height()):r.o$(t-12),r.o$(n-i)))},D.prototype.Z$=function(e){for(var n,t,o,r,a,i,u,n=this,t=n.h$[n.h$.length-1].name,o=n.l$[t],r=[],a=0;a<o.length;a++)if("groupHeader"===o[a].menuItemData.type)if(i=n.l$[o[a].menuItemData.name],e)for(u=0;u<i.length;u++)r.push(i[u]);else r.push(i[0]);else r.push(o[a]);return r},D.prototype.W$=function(e,n){for(var t,o,t=n.length,o=0;o<t;o++)if(e.name===n[o].name)return o},D.prototype.G$=function(e){var n,t,o,r,a,t,i,u,c,c,n=this,t=n.JX;t&&(o=t.menuItemData).subMenu&&0<o.subMenu.length&&(o.name!==n.h$[n.h$.length-1].name&&((r=n.d$[o.name]).show(),a=t.host,t=n.d$[t.menuName],i=a.offset(),u=a.position(),c=t&&t.position(),c=n.z$(r,{parentRelatedLeft:(c||u).left,parentRelatedTop:c?u.top+c.top:u.top,parentAbsoluteLeft:i.left,parentWidth:t?t.width():a.width()+3}),n.h$.push({name:o.name,menuView:r,subMenuWrapper:c})),n.JX=g,e)&&n.H$(!0,!1)},D.prototype.b$=function(){var e=this,n=e.V$();return n="number"==typeof e.Kq&&!1!==e.Qq?k(n,e.Kq):n},D.prototype.V$=function(){var e,n,t,o,t,e,r,e,e=this,n=e.hostInfo,t=e.w$(),o=t.contextTop,t=t.contextHeight,e=e.y$(),r=e.windowTop,e=e.windowHeight;return n?e:k(r+e,o+t)-j(r,o)},D.prototype.U2=function(e){var n,t,n=this;return!1!==n.Qq&&((t=n.b$())<e||void 0)},D.prototype.scrollable=function(e){var n=this;if(w(e))return n.Qq;n.Qq=e},D.prototype.maxHeight=function(e){var n=this;if(w(e))return n.Kq;(n.Kq=e)<0&&(n.Kq=void 0)},D.prototype.getHost=function(){return this.Ti},e.MenuView=D},"./dist/plugins/contextMenu/menuItems/helpers/utils.js":function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.VIEWPORT=n.ICON_CLASS_PREFIX=void 0,n.ICON_CLASS_PREFIX="gc-spread-",n.VIEWPORT="viewport"},"./dist/plugins/contextMenu/menuItems/index.js":function(e,n,t){var o,r,o=this&&this.__createBinding||(Object.create?function(e,n,t,o){void 0===o&&(o=t);var r=Object.getOwnPropertyDescriptor(n,t);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(e,o,r)}:function(e,n,t,o){e[o=void 0===o?t:o]=n[t]}),r=this&&this.__exportStar||function(e,n){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(n,t)||o(n,e,t)};Object.defineProperty(n,"__esModule",{value:!0}),r(t("./dist/plugins/contextMenu/menuItems/report-sheet.js"),n)},"./dist/plugins/contextMenu/menuItems/report-sheet.js":function(e,n,t){var u,o,c;function r(n){return["".concat(c,"AddRecord"),"".concat(c,"DeleteRecord"),"".concat(c,"Submit"),"".concat(c,"ResetCellValue")].map(function(e){return{text:n[e],name:e,command:e,iconClass:o.ICON_CLASS_PREFIX+e,workArea:o.VIEWPORT}})}function a(e,n,t){var n,o,r,a,n,i,n=n.getActiveSheetTab(),o;return n&&n._gi===u.SheetType.reportSheet?(a=r=void 0,t.worksheetHitInfo&&(r=n.isExpandable(t.worksheetHitInfo.row,t.worksheetHitInfo.col),a=n.internalIsDirtyCell(t.worksheetHitInfo.row,t.worksheetHitInfo.col)),r||(e=e.filter(function(n){return!n.name||!["AddRecord","DeleteRecord"].find(function(e){return n.name==="".concat(c).concat(e)})})),a||(n=e.find(function(e){return e.name==="".concat(c,"ResetCellValue")}))&&(n.disable=!0),i=["gc.spread.filter","gc.spread.sort","gc.spread.insertComment"],e.filter(function(e){return!e.name||!i.includes(e.name)})):e.filter(function(e){return!e.name||0!==e.name.indexOf(c)})}Object.defineProperty(n,"__esModule",{value:!0}),n.filterReportSheetMenuItems=n.createReportSheetMenuItems=void 0,u=t("Core"),o=t("./dist/plugins/contextMenu/menuItems/helpers/utils.js"),c="reportSheet",n.createReportSheetMenuItems=r,n.filterReportSheetMenuItems=a},Common:function(e){e.exports=GC.Spread},Core:function(e){e.exports=GC.Spread.Sheets}},o={},e=r("./dist/plugins/contextMenu/context-menu.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).ContextMenu=e}();
;var GC;!function(){"use strict";var i,r,n;function e(n){var t,t,t=r[n];return void 0!==t||(t=r[n]={exports:{}},i[n].call(t.exports,t,t.exports,e)),t.exports}i={"./dist/plugins/data/binding.js":function(n,t,i){var r,e,a,e,i,f,s,v,l,c,u,h,g,u,d,o,m,b;function p(n){this.rT=n}function j(n){this.Hc(n)}function w(n){var t=n&&n.H3;t&&t.Q$()&&r.Worksheet.et(n,"resetBinding",{sheet:n})}function C(n,t){var i=n&&n.H3;return!(!i||!i.Q$(t)||(n.clearPendingChanges(),r.Worksheet.et(n,"initBinding",{sheet:n,data:t}),0))}function y(n,t,i){var r,e,u,o,a,f,s,c,c,c,r,n,a,r=n,e=r._dataSource,u={value:v,hasBinding:!1};if(e)if(o=r.Mf,(a=r.K$)===g){if((c=o?o.getBindingPath(t,i):v)&&"object"!=typeof c)return{value:e.getValue(c),hasBinding:!0}}else{if(t<0||n.getRowCount()<=t)return u;if(c=(o||n).getColumnCount(),i<0||c<=i)return u;if(o?(r.J$||r.gTe(o.Ut.EE(!1,3)),(f=r.J$[i])&&(s=f.name)):n.Pq&&(r.J$?(f=r.J$[i])&&(s=f.dataField):s=n.Pq[i]),a)return c=h[a],n=V(r=f&&f.value)?r:v,a=o&&o.onItemGotten?o.onItemGotten.bind(o):l,c.getValue(e,n,s,t,i,a)}return u}function B(n,t,i,r){var e,u,o,a,f,s,c,d,d,d,a,e,e=n,u=e._dataSource,o=!1;if(u)if(a=e.Mf,(f=e.K$)===g)(d=a?a.getBindingPath(t,i):v)&&"object"!=typeof d&&(u.setValue(d,r),o=!0);else{if(t<0||n.getRowCount()<=t)return o;if(d=(a||n).getColumnCount(),i<0||d<=i)return o;a?(e.J$||e.gTe(a.Ut.EE(!1,3)),(s=e.J$[i])&&(c=s.name)):n.Pq&&(e.J$?(s=e.J$[i])&&(c=s.dataField):c=n.Pq[i]),f&&(d=h[f],e=V(a=s&&s.value)?a:v,o=d.setValue(u,e,c,t,i,r,l))}return o}function _(i){var r=v;return i&&(I(i)?r=g:a.each(h,function(n,t){if(t.isDataSource(i))return r=n,!1})),r}function O(n,t){return n&&t&&t!==g?h[t].getProperties(n):v}function I(n){return o&&n instanceof o}function V(n){return"function"==typeof n}function M(n,t,i){var r,e,u,o,a;if(n&&t)if(r=n[t],s(r))for(u=(e=t.split(".")).length,o=0;o<u&&(a=e[o],n);o++)o===u-1?V(n[a])?n[a](i):n[a]=i:n=V(n[a])?(s(n[a]())&&n[a]({}),n[a]()):(s(n[a])&&(n[a]={}),n[a]);else V(r)?n[t](i):n[t]=i}function S(n,t,i){var r,e,u,o,a;if(!n||!t)return v;if(r=n[t],!s(r))return V(r)?r():r;e=null,i?(e=i[t])||(e=t.split("."),i[t]=e):e=t.split("."),u=e.length,o=0;do{if(n=V(n[a=e[o]])?n[a]():n[a],s(n))return v}while(++o<u);return n}function G(){this.pathCache={}}Object.defineProperty(t,"__esModule",{value:!0}),t.X$=t.q$=t.setValueByPath=t.$$=t.CellBindingSource=void 0,r=i("Core"),e=i("Core"),a=e.GC$,e=i("Common"),i=i("./dist/plugins/data/data.ns.js"),f=a.isNumeric,s=e.Common.lt.ht,v=null,l=void 0,c="string",t.X$=u,h=t.X$=u={},g="cellBinding",u=new e.Common.ResourceManager(i.SR,"Bindings"),d=u.getResource.bind(u),r.Workbook.ch("binding",{onCultureChanged:function(){d()}}),p.prototype.setValue=function(n,t){M(this.rT,n,t)},p.prototype.getValue=function(n){return S(this.rT,n)},p.prototype.getSource=function(){return this.rT},o=p,t.CellBindingSource=o,j.prototype.bind=function(e,n){var t,i,r,n,r,u,o,t=this,i=t.Mf,r=t._dataSource;if(n&&t.ttt(n,{type:"bind",oldDataSource:r}),r&&(r.ntt&&(r.subscribe=r.ntt,delete r.ett,delete r.ntt),V(r.dispose))&&r.dispose(),t.itt(t.rtt),t.itt(t.ott),t.Hc(i),t._dataSource=e){if(!(n=t.K$=_(e)))throw new Error(d().Exp_NotSupportedDataSource);t.att=t.utt(),i&&(r=t.rtt,u=e.currentPosition,e.subscribe&&r.push(e.subscribe(t.stt,t)),u&&u.subscribe&&r.push(u.subscribe(t.ctt,t)),V(e.subscribe)&&!e.ntt&&(o=e.ntt=e.subscribe,e.ett=!1,e.subscribe=function(n,t){var i,r,i=[].concat.apply([],arguments),r;return i[0]=function(){if(!e.ett&&V(n))return n.apply(t,arguments)},o.apply(e,i)}),t.RA(),t.Mf.Ut.Spe()),t.Pq=O(e,n)}return C(i,e)},j.prototype.RA=function(){var n,t,i,r,e,r,u,o,n=this,t=n.Mf,i=n._dataSource;if(t&&i&&(r=n.K$,n.itt(n.ott),e=v,r!==g&&(r=t.getActiveRowIndex(),e=i.currentPosition?(-1<=r&&r<i.count()&&i.currentPosition(r),i.currentItem()):n.ftt(r)),e))for(o in u=function(){t&&t.repaint()},e)e[o]&&V(e[o].subscribe)&&n.ott.push(e[o].subscribe(u,v,v))},j.prototype.itt=function(n){var t,i;if(n)for(t=0;t<n.length;t++)(i=n[t])&&V(i.dispose)&&i.dispose()},j.prototype.getRowCount=function(){var n,t,n,i,n=this,t=n._dataSource,n=n.K$,i=0;return i=t&&n&&n!==g?h[n].getDataLength(t):i},j.prototype.getColumnCount=function(){var n,n,n,n,n=this.Pq;return n?n.length:(n=this._dataSource)&&(n=n[0],"null"===(n=a.getType(n))||n===c||"number"===n)?1:0},j.prototype.getSource=function(){return this._dataSource},j.prototype.ltt=function(){return this.Pq},j.prototype.htt=function(n){this.Pq=n},j.prototype.ftt=function(n){var t=this._dataSource,i=this.K$,r=v;return r=t&&i&&i!==g?h[i].getDataItem(t,n):r},j.prototype.utt=function(){var n,t,i,r,n=this;if(!n.att)for(t=n.getRowCount(),i=0;i<t;i++)if(r=n.ftt(i)){n.att=r.entityAspect&&r.entityType||r.constructor;break}return n.att},j.prototype.getValue=function(n,t){return y(this,n,t)},j.prototype.setValue=function(n,t,i,r){var e,u,e=this;return r&&(u=y(e,n,t).value,e.ttt(r,{type:"setValue",row:n,col:t,oldValue:u})),B(e,n,t,i)},j.prototype.pTe=function(){return this.J$},j.prototype.gTe=function(n,t){var i,r,i=this;t&&(r=i.J$,i.ttt(t,{type:"setColumnBindingInfo",oldColumnBindingInfo:r,columnBindingInfo:n})),i.J$=n},j.prototype.dtt=function(){var n=h[this.K$];return n&&n.canAdd&&n.canAdd()},j.prototype.vtt=function(){var n=h[this.K$];return n&&n.canInsert&&n.canInsert()},j.prototype.mtt=function(){var n=h[this.K$];return n&&n.canRemove&&n.canRemove()},j.prototype.allowSetCount=function(){var n,n,n=this.K$;return n===g||(n=h[n])&&n.allowSetCount&&n.allowSetCount()},j.prototype.kE=function(n,t,i){var r,e,u,o,r=this,e=r._dataSource;!e||n>r.getRowCount()||(u=r.K$,o=r.utt(),u&&u!==g&&!r.gtt&&(r.ptt=!0,i&&r.ttt(i,{type:"addItems",row:n,rowCount:t}),h[u].addItems(e,n,t,o,l),r.ptt=!1))},j.prototype.btt=function(n,t,i){var r,e,u,o,u,u,e,r=this,e=r.K$,u=r.getRowCount(),o=r._dataSource;!o||u<=n||e&&e!==g&&!r.gtt&&(r.ptt=!0,u=(u=r.Mf)&&u.onItemRemoved?u.onItemRemoved.bind(u):l,e=h[e].removeItems(o,n,t,u),i&&e&&0<e.length&&r.ttt(i,{type:"removeItems",row:n,removedItems:e}),r.ptt=!1)},j.prototype.ytt=function(n,t){var i,r,i,i=this,r=i._dataSource,i=i.K$;h[i].undoRemoveItems(r,n,t)},j.prototype.Q$=function(n){return I(n||this._dataSource)},j.prototype.Hc=function(n){var t=this;t._dataSource=v,t.K$="",t.att=v,t.Pq=v,t.rtt=[],t.ott=[],t.J$=v,w(t.Mf=n)},j.prototype.stt=function(n){var t,i,r,e,u,o,t=this,i=t.Mf;if(i&&!t.ptt){if(n){if(t.gtt=!0,!isNaN(n.length)&&(i.setRowCountCore(n.length),r=i.Ut,s(t.Pq))&&0===r._E(!1,3)&&(t.Pq=O(t._dataSource),i.setColumnCount(t.getColumnCount()),e=t.ltt()))for(u=0,o=e.length;u<o;u++)r.do("setItem",!1,3,u,{name:e[u]});t.gtt=!1}i.zw()}},j.prototype.ctt=function(){var n,t,n,n,n=this,t=n.Mf,n=n._dataSource;t&&n&&n.currentPosition&&(n=n.currentPosition(),t.ui!==n)&&(t.t4(n,t.ci,l,l,2),t.zw())},j.prototype.ttt=function(n,t){var i,i;this.Mf&&this.Mf.Ut&&!s(this.Mf.Ut.P8)&&this.Mf.Ut.P8<=0||(i=(i=n.bindingChanges)||(n.bindingChanges=[]),t.bindingManager=this,i.push(t))},j.prototype.wtt=function(n){var t,i,r,t=this,i=n.type,r=n.row;"bind"===i?t.bind(n.dataSource):"setValue"===i?t.setValue(r,n.col,n.value):"addItems"===i?t.kE(r,n.rowCount):"removeItems"===i?t.btt(r,n.rowCount):"setColumnBindingInfo"===i&&t.gTe(n.columnBindingInfo)},j.prototype.Mtt=function(n){var t,i,r,t=this,i=n.type,r=n.row;"bind"===i?t.bind(n.oldDataSource):"setValue"===i?t.setValue(r,n.col,n.oldValue):"addItems"===i?t.btt(r,n.rowCount):"removeItems"===i?t.ytt(r,n.removedItems):"setColumnBindingInfo"===i&&t.gTe(n.oldColumnBindingInfo)},j.prototype.toJSON=function(){var n,t,n=this._dataSource;return n?{type:t=this.K$,source:n=t===g?n.getSource():h[t].toJSON(n)}:v},j.prototype.fromJSON=function(n){var t,n,i,t=n&&n.source;t&&(i=void 0,i=(n=n.type)===g?new o(t):h[n].fromJSON(t))&&this.bind(i)},t.$$=j,t.setValueByPath=M,t.q$=S,G.prototype.isDataSource=function(n){return a.isArray(n)},G.prototype.getDataLength=function(n){return n.length},G.prototype.getDataItem=function(n,t){return n[t]},G.prototype.addItems=function(n,t,i,r){for(var e,u,e=0;e<i;e++)u={},r&&(u=r.createEntity?r.createEntity():new r),n.splice(t,0,u)},G.prototype.removeItems=function(n,t,i){var r=this.getDataLength(n);if(t<r)return n.splice(t,Math.min(i,r-t))},G.prototype.undoRemoveItems=function(n,t,i){for(var r=0,e=i.length;r<e;r++)n.splice(t+r,0,i[r])},G.prototype.getProperties=function(n){var t,i,r,e,t=n.length,i=v;if(0<t)for(e in i=[],r=n[0])V(r[e])||i.push(e);return i},G.prototype.getValue=function(n,t,i,r,e){var u=v,o=!1,n=this.getDataItem(n,r);return s(n)||(t?a.isEmptyObject(n)||(u=t(n),o=!0):i?(u=S(n,i,this.pathCache),o=!0):typeof n!=c&&!f(n)||0!==e||(u=n,o=!0)),{value:u,hasBinding:o}},G.prototype.setValue=function(n,t,i,r,e,u){var o=!1,a=this.getDataItem(n,r);return s(a)||(t?(a[i]=u,t(a,u),o=!0):i?(M(a,i,u),o=!0):typeof a!=c&&!f(a)||0!==e||(n[r]=u,o=!0)),o},G.prototype.fromJSON=function(n){return n},G.prototype.toJSON=function(n){return n},h.defaultBindingSource=new G},"./dist/plugins/data/data.dataview.js":function(n,t,i){var r,e,a,f,u;function o(){}Object.defineProperty(t,"__esModule",{value:!0}),t.X$=void 0,r=i("Common"),e=i("./dist/plugins/data/binding.js"),Object.defineProperty(t,"X$",{enumerable:!0,get:function(){return e.X$}}),a=r.Common.lt.ht,f=null,o.prototype.isDataSource=function(n){var t=window.wijmo;return t&&t.data&&t.data.isDataView&&t.data.isDataView(n)},o.prototype.getDataLength=function(n){return n.count()},o.prototype.getDataItem=function(n,t){return n.item(t)},o.prototype.addItems=function(n,t,i,r){if(r)for(var e=0;e<i;e++)n.ett=!0,n.add(r.createEntity?r.createEntity():new r),n.ett=!1,n.commitEdit()},o.prototype.removeItems=function(n,t,i){var r,e,u,o,a,r=this.getDataLength(n);if(t<r){for(e=[],u=Math.min(i,r-t),o=0;o<u;o++)a=n.item(t),n.remove(a),e.push(a);return e}},o.prototype.undoRemoveItems=function(n,t,i){for(var r,e,u,r=n.getSource(),e=0,u=i.length;e<u;e++)r.splice(t+e,0,i[e]);n.refresh()},o.prototype.getProperties=function(n){var t,i,r,e,t=0,i=f,r=n.getProperties();if(r&&0<r.length)for(t=r.length,i=[],e=0;e<t;e++)i.push(r[e].name);return i},o.prototype.canInsert=function(){return!1},o.prototype.getValue=function(n,t,i,r,e){var u=f,o=!1,r=this.getDataItem(n,r);return a(r)||(t?(u=t(r),o=!0):i&&(u=n.getProperty(r,i),o=!0)),{value:u,hasBinding:o}},o.prototype.setValue=function(n,t,i,r,e,u){var o=!1,r=this.getDataItem(n,r);return a(r)||(t?(t(r,u),o=!0):i&&(n.setProperty(r,i,u),o=!0)),o},o.prototype.fromJSON=function(n){return n},o.prototype.toJSON=function(n){return n.local},e.X$.dataViewBinding=new o},"./dist/plugins/data/data.entry.js":function(n,t,i){var r,e,u,r=this&&this.__createBinding||(Object.create?function(n,t,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(t,i);e&&("get"in e?t.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,r,e)}:function(n,t,i,r){n[r=void 0===r?i:r]=t[i]}),e=this&&this.__exportStar||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),t.q$=t.setValueByPath=t.$$=t.CellBindingSource=void 0,i("./dist/plugins/data/worksheet-databind.js"),u=i("./dist/plugins/data/binding.js"),Object.defineProperty(t,"CellBindingSource",{enumerable:!0,get:function(){return u.CellBindingSource}}),Object.defineProperty(t,"$$",{enumerable:!0,get:function(){return u.$$}}),Object.defineProperty(t,"setValueByPath",{enumerable:!0,get:function(){return u.setValueByPath}}),Object.defineProperty(t,"q$",{enumerable:!0,get:function(){return u.q$}}),e(i("./dist/plugins/data/data.ko.js"),t),e(i("./dist/plugins/data/data.dataview.js"),t),e(i("./dist/plugins/data/data.ns.js"),t)},"./dist/plugins/data/data.ko.js":function(n,t,i){var g,r,f,s,m,u,c,d,a,b,o,e,i;function v(){}Object.defineProperty(t,"__esModule",{value:!0}),t.X$=void 0,g=i("Core"),r=i("Common"),f=i("./dist/plugins/data/binding.js"),Object.defineProperty(t,"X$",{enumerable:!0,get:function(){return f.X$}}),s=r.Common.lt.ht,m=g.GC$,u=m.isFunction,c=m.getType,d=m.isNumeric,a=null,b="string",o=window.ko,v.prototype.isDataSource=function(n){return o&&o.isObservable(n)},v.prototype.getDataLength=function(n){return n().length},v.prototype.getDataItem=function(n,t){return n()[t]},v.prototype.addItems=function(n,t,i,r){for(var e,u,e=0;e<i;e++)u={},r&&(u=r.createEntity?r.createEntity():new r),n.splice(t,0,u)},v.prototype.removeItems=function(n,t,i){var r=this.getDataLength(n);if(t<r)return n.splice(t,Math.min(i,r-t))},v.prototype.undoRemoveItems=function(n,t,i){for(var r=0,e=i.length;r<e;r++)n.splice(t+r,0,i[r])},v.prototype.getProperties=function(n){var n,t,i,r,e,n=n(),t,i=[];if(0<n.length)for(e in r=n[0])(!u(r[e])||o&&o.isObservable(r[e]))&&i.push(e);return i},v.prototype.getValue=function(n,t,i,r,e){var u=a,o=!1,n=this.getDataItem(n,r);return s(n)||(t?(u=t(n),o=!0):i?(u=(0,f.q$)(n,i),o=!0):c(n)!==b&&!d(n)||0!==e||(u=n,o=!0)),{value:u,hasBinding:o}},v.prototype.setValue=function(n,t,i,r,e,u){var o=!1,a=this.getDataItem(n,r);return s(a)||(t?(t(a,u),o=!0):i?((0,f.setValueByPath)(a,i,u),o=!0):c(a)!==b&&!d(a)||0!==e||(n()[r]=u,o=!0)),o},v.prototype.fromJSON=function(n){return o?o.observableArray(n):a},v.prototype.toJSON=function(n){return n()},f.X$.koBinding=new v,o&&((i=o.bindingHandlers)["gc-spread-sheets"]=i["gcspread-sheets"]=i.wijspread={init:function(n,t,i,r){var t,e,u,o,a,f,s,c,d,v,l,h;if(!m(n).data("workbook")&&(e=(t=t())&&t.sheets,u=new g.Workbook(m("#"+n.id)[0],t),e)){for(a=o=void 0,f=e.length,s=u.getSheetCount();s<f;)o=u.S2(u.T2(s)),u.A2(s,0,o),s=u.getSheetCount();for(c=0;c<f;c++)o=u.getSheet(c),d=(a=e[c]).name,v=a.autoGenerateColumns,l=a.data,h=a.columns,typeof d==b&&0<d.length&&o.ub(d),"boolean"==typeof v&&(o.autoGenerateColumns=v),l&&o.setDataSource(l),h&&0<h.length&&(o.autoGenerateColumns=!1,o.bindColumns(h))}},update:function(n,t,i,r){}})},"./dist/plugins/data/data.ns.js":function(n,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.SR=void 0;var i=i("./dist/plugins/data/data.res.en.js");t.SR={en:i}},"./dist/plugins/data/data.res.en.js":function(n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Exp_NotSupportedDataSource=void 0,t.Exp_NotSupportedDataSource="The data source is not supported!"},"./dist/plugins/data/worksheet-databind.js":function(n,t,i){var h,t,s,v,f,i,r,l,u,o,g,e;function a(n,t,i){n.Ut.do("setItem",!1,3,t,i="string"==typeof i?{name:i}:i);var r=i&&i.formatter,e=i&&i.cellType;r&&n.setFormatter&&n.setFormatter(-1,t,r),e&&n.setCellType(-1,t,e),i&&!v(i.width)&&n.setColumnWidth(t,i.width)}function c(n,t,i,r,e,u){var o,a,f,s,c,d,v,l,v,o=n.H3,a="dataManagerBindingSource"===o.K$,f=n.NMi;if(f&&f._gi===h.SheetType.ganttSheet){for(s=0;s<i;s++)if(!f.zDi(s))for(c=0;c<r;c++)d=f.Rpi(s,c),u?n.c8(t,s,c,d,e):n.s8(t,s,c,d,a)}else for(s=0;s<i;s++)for(c=0;c<r;c++)l=(v=o.getValue(s,c)).value,v&&v.hasBinding&&(g.W0(v=l)&&(v=g.Q0(l)),u?n.c8(t,s,c,v,e):n.s8(t,s,c,v,a))}function d(n,t,i,r){var n=n.getSpan(t,i,r);return!(!n||n.row===t&&n.col===i)}function m(n,t,i,r){for(var e,u,o,a,f,a,e=n.options.colHeaderAutoTextIndex,u=0;u<i;u++)if(0<=e&&u===e||-1===e&&u===i-1)for(o=0;o<r;o++)a=t[u]&&t[u][o]&&t[u][o].value,f=n.Ut.q_(!1,3,o),v(a)&&f&&!d(n,u,o,1)&&(a=f.displayName||f.name)&&n.s8(t,u,o,a)}function b(n,t){var n,i;return"Object"===t.constructor.name&&(n=n.findByName(t.tableName))&&(n.H3?t=n.H3:((i=new s.$$).fromJSON(t),n.H3=t=i)),t}Object.defineProperty(t,"__esModule",{value:!0}),h=i("Core"),t=i("Common"),s=i("./dist/plugins/data/binding.js"),v=t.Common.lt.ht,f=h.GC$.isEmptyObject,i=h.GC$.extend,r=h.Worksheet.prototype,l=null,u="bindingPath",o=new RegExp("^\\d*(\\.\\d+)?\\*$"),g=t.Common.ct,i(r,e={getDataSource:function(){var n=this.H3;return n?n.getSource():l},setDataSource:function(n,t){var i,r,e,u,o,a,f,t,n,i=this,r=i.H3;if(r&&(r.getSource()!==n||i.NMi)){if(i.suspendPaint(),t&&i.sF(),i.suspendCalcService&&i.suspendCalcService(),n){if(e=i.Ut,(r=i.H3).Ctt=!0,!(u=r.bind(n,e.G8))){if(i.setRowCountCore(r.getRowCount()),i.autoGenerateColumns&&(i.setColumnCount(r.getColumnCount()),o=r.ltt()))for(a=0,f=o.length;a<f;a++)e.do("setItem",!1,3,a,{name:o[a]});e.yge(0,0,i.getRowCount(),i.getColumnCount())}}else i.H3=new s.$$(i);i.clearPendingChanges(),t=!1,r&&r.Ctt&&(t=r.Stt,delete r.Stt,delete r.Ctt),i.recalcAll&&i.recalcAll(t),i.resumeCalcService&&i.resumeCalcService(t),(n=i.ST())&&n.DS===i&&n.c5(),i.resumePaint()}},bindColumn:function(n,t){var i=this;i.suspendPaint();try{a(i,n,t)}finally{i.resumePaint()}},bindColumns:function(n){var t,i,r,e,u,t=this;t.suspendPaint();try{if(n)for(i=n.length,isNaN(i)||t.setColumnCount(i),r=0;r<i;r++)u=(e=n[r]).size,o.test(u)&&(e.starSize=u),a(t,r,e)}finally{t.resumePaint()}},getDataItem:function(n){var t,i,r,e,u,o,a,f,t=this,i=t.H3;if(!i||0===i.getRowCount())return l;if(r=t.getColumnCount(),e={},u=i.ftt(n))for(o in u)u.hasOwnProperty(o)&&"function"!=typeof o&&(e[o]=u[o]);for(a=0;a<r;a++)(f=t.Ut.q_(!1,3,a))&&f.name&&0<f.name.length&&v(e[f.name])&&(e[f.name]=t.getValue(n,a));return e},getDataColumnName:function(n){var t,t,t=this;return 0<=n&&n<t.getColumnCount()&&t.getDataSource()?(t=t.Ut.q_(!1,3,n))&&(t.displayName||t.name):l},getBindingPath:function(n,t){return this.Ut.getValueForKey(n,t,u)},setBindingPath:function(n,t,i){var r=this,e=r.Ut;return e.do("setValueForKey",n,t,u,i),e.gge(n,t,!i),r.ki(h.Events.WorksheetDataChanged,{type:"bindingPath"}),r.zw(),r}}),h.CellRange.prototype.bindingPath=h.CellRange.p0(r.getBindingPath,r.setBindingPath),h.Worksheet.ch("binding",{init:function(){var n=this;n.autoGenerateColumns=!0,n.H3=new s.$$(n)},dispose:function(n){var t;!1!==n.clearCache&&(this.H3=l)},onLayoutChanged:function(n){var t,i,r,e,u,o,a,f,s,c,d,t=this,i=n.changeType,r=n.row,e=n.rowCount,u=n.sheetArea;if(v(u)||3===u||2===u)if(o=t.H3,"addingRows"===i)o&&!1===o.dtt()?n.canAdd=!1:o&&!1===o.vtt()&&(n.newRow=t.getRowCount());else if("addRows"===i)o&&o.kE(r,e,t.Ut.G8);else if("deletingRows"===i){if(o)if(!1===o.mtt())n.canDelete=!1;else for(t.aj||(t.aj=[]),a=t.aj,f=t.Ut,s=o.getRowCount(),c=0;c<e&&r+c<f.getRowCount();c++)d=l,r+c<s&&(d=o.ftt(r+c)),a.push({row:r+c,data:d})}else"deleteRows"===i?o&&o.btt(r,e,t.Ut.G8):"settingRowCount"!==i||!o.getSource()||o.allowSetCount()||3!==u&&2!==u||(n.canSet=!1)},toJson:function(n,t){var i,r,e,t,e,u,i=this,r=i.getColumnCount(),e=i.getDataSource();t&&t.includeBindingSource&&e&&(c(i,t=n.data.dataTable||{},i.getRowCount(),r),f(t)||(n.data.dataTable=t),m(i,e=n.colHeaderData.dataTable||{},i.getRowCount(1),r),f(e)||(n.colHeaderData.dataTable=e)),!0!==(u=i.autoGenerateColumns)&&(n.autoGenerateColumns=i.autoGenerateColumns)},fromJson:function(n,t){var i,r,e,u,e,i=this;i.H3=new s.$$(i),t&&(r=i.H3,e=n.dataSource,u=n.dataBinding,e&&r.bind(e),u)&&r.fromJSON(u,t),e=n.autoGenerateColumns,v(e)||(i.autoGenerateColumns=e)},preFromJson:function(){this.H3=new s.$$(this)},wh:function(n,t,i){var r,e,u,o,i,a,r=this,e=r.getColumnCount(),u=r.getDataSource(),o=n.lossless;o=o||(n.lossless={}),i&&i.includeBindingSource&&u&&(c(r,n,r.getRowCount(),e,t.sharedStrings,!0),m(r,i=o.colHeaderData.dataTable||{},r.getRowCount(1),e),f(i)||(o.colHeaderData.dataTable=i)),!0!==(a=r.autoGenerateColumns)&&(o.autoGenerateColumns=r.autoGenerateColumns)},yh:function(n){var t,n,t=this;t.H3=new s.$$(t),n=n.lossless&&n.lossless.autoGenerateColumns,v(n)||(t.autoGenerateColumns=n)}}),h.Y8.ch("binding",{priority:6e3,isValid:function(n){var t,n,t,n=-1<["getValue","setValue"].indexOf(n),t=null==(t=this.Mf.H3)?void 0:t._dataSource;return!n||t},getValue:function(n){var t,i,r,e,r,e,t=n.row,i=n.col,r=n.sheetArea,e=this.Mf.H3;3===r&&e&&e._dataSource&&(r=e.getValue(t,i),n.isValueGet=r.hasBinding,e=r.value,1!==n.valueType&&(e=h.mt.wt(e)),n.value=e)},setValue:function(n){var t,i,r,e,u,o,a,a,f,t=n.row,i=n.col,r=n.value,e=n.sheetArea,u=this.Mf,o=u.H3;3===e&&o&&o._dataSource&&(a=o.getValue(t,i)).hasBinding&&(r!==(a=a.value)?(u.isDirtySuspended()||(f=u.getDataItem(t),this.dE(t,i,{gE:f,d6:a},e)),n.isValueSet=o.setValue(t,i,r,u.Ut.G8)):n.isValueSet="dataManagerBindingSource"!==o.K$)},applyChanges:function(n){var t,n,i,r,e,u,t=n.changes,n=n.isUndo,i=t&&t._bindingChanges;if(i)if(n)for(r=i.length-1;0<=r;r--)(e=i[r]).bindingManager&&(u=b(this.Mf.tables,e.bindingManager)).Mtt(e);else for(r=0;r<i.length;r++)e=i[r],(u=b(this.Mf.tables,e.bindingManager)).wtt&&u.wtt(e)},undoValue:function(n){var t,i,r,t=n.bindingChanges;if(t)for(i=t.length-1;0<=i;i--)(r=t[i]).bindingManager.Mtt(r)}})},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets}},r={},n=e("./dist/plugins/data/data.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Bindings=n}();
;var GC;!function(){"use strict";var i,r,t,n,e;function o(t){var n,n,n=r[t];return void 0!==n||(n=r[t]={exports:{}},i[t](n,n.exports,o)),n.exports}i={"./dist/plugins/validation/datavalidation-event.js":function(r,t,n){var t,i,T,U,q,R,Q,Y,J,P,W,X,G,Z,H,N,K,_,z,$,tt,nt,it,rt,et,ot,at,ut,st,ft,ct,lt,ht,vt,dt,gt,mt,At;Object.defineProperty(t,"__esModule",{value:!0}),t=n("Core"),i=n("Common"),T=n("CalcEngine"),U=n("./dist/plugins/validation/datavalidation.js"),q=i.Common.lt.ht,R=i.Common.ct,Q=i.Common.zf,Y=t.mt,J=t.Ec,P=Y.pi(),W=Y.Tt,X=t.GC$,G=Y.En,Z=Y.yt,H=Y.vi,N=document,K=Math.max,_=Math.min,z="position",$="absolute",tt="border",nt="padding",it="box-shadow",rt="font",et="background-color",ot="top",at="left",ut="z-index",st="outline",ft="auto",ct="white",lt="none",ht="size",vt="gcUIElement",dt="min-height",gt="min-width",mt="max-width",At="word-wrap",X.extend(t.nk.prototype,{PA:function(n,i){var r,e,t,o,a,u,s,f,c,l,h,u,a,t,u,a,v,d,g,m,A,p,b,w,C,O,k,M,t,u,a,t,s,u,t,s,B,V,S,s,y,D,j,x,F,F,a,x,L,E,s,j;function I(t,n){if(t&&t[n])return"function"==typeof t[n]?t[n]():t[n]}if((t=(e=(r=this).Mf)&&e.parent)&&(o=e.G1())&&((a=t.getActiveSheet())||(u=t.getActiveSheetTab())&&(a=u.Mf),a)&&e.name()===a.name()&&(s=e.getDataValidator(n,i))&&(f=e.getCellRect(n,i),!r.Ek(f))&&(c=t.j2(),l=t.getHost(),h=Y.gi(l),I(s,"showInputMessage")&&I(s,"inputMessage")&&(t=(u=Q.Vi)((a=Q.j0)(I(s,"inputTitle")),"\n","<br/>"),u=u(a(I(s,"inputMessage")),"\n","<br/>"),a=G("span"),X(a).css(z,$).css(tt,"1px #C0C0C0 solid").css(nt,"3px 8px 3px 8px").css(et,"#FFFFFF").css(it,"1px 2px 5px rgba(0,0,0,0.4)").css(rt,"normal normal normal 12px/normal Arial").width(ft).height(ft).css(ot,f.y+f.height+5).css(at,f.x+f.width/2).css(dt,"15px").css(gt,"20px").css(mt,"200px").css(At,"break-word").css(ut,h).html((q(t)||""===t?"":"<b>"+t+"</b><br/>")+u).attr(vt,"gcValidationInputMessage").appendTo(c),e.KD=a),s)&&3===I(s,"type")&&I(s,"inCellDropdown")&&I(s,"condition")){for(v=I(s,"condition").getValidListImp(e,n,i),d=I(s,"condition").KJ(),g=v.length,m=G("select"),A=e.getText(n,i),p=-1,b=N.createDocumentFragment(),w=new RegExp(String.fromCharCode(32),"g"),C=String.fromCharCode(160),O=0;O<g;O++)k=v[O].text,q(k)||T&&k instanceof T.CalcError||(p<0&&k===A&&(p=O),k instanceof Date&&(k=R.Pe(k,"M/d/yyyy h:mm:ss")),(M=G("option")).value=k,M.text=k.replace(w,C),b.appendChild(M));m.appendChild(b),m.selectedIndex=0<p?p:0,t=e.getActualStyle(n,i),u=e.Dn,a=t&&t.font?t.font:u.Nn(),1<e.zoom()&&(a=u._n(a)),(t=e.Ut.getSpans(J(n,i,s=1,1)))&&0<t.length&&t[0]&&(s=t[0].colCount),u=i+s-1==e.getColumnCount()-1,t=e.Gt(n),s=e.parent&&e.parent.options.useTouchLayout,t=_(s?50:15,t),V=W.safari&&(P.ipad||P.iphone),S=P.android,x=j=D=y=s=void 0,x=V?(s=f.width+3,y=f.height+3,D=f.y-1.5,j=f.x-1.5,ct):(s=K(f.width+(u?0:t),e.defaults.colWidth),y=8<g?140:ft,D=f.y+f.height,j=(F=f.x+f.width+(u?0:t)-s)<e.uw().left?f.x:F,""),F=X(m).css(st,lt).css(z,$).css(rt,Z(a)).css(ut,h).css(et,x).width(s).height(y).css(at,j).attr(vt,"gcValidationSelect").appendTo(c).attr(ht,2<g?g:2).hide().bind("click",function(){S||(r.jk(m,n,i,v,d),V&&X(e.a6t).show())}).bind("keydown",function(t){13!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey?27!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||X(m).hide():r.jk(m,n,i,v,d),V&&X(e.a6t).show()}).bind("change",function(){S&&r.jk(m,n,i,v,d)}),a=X(l).height(),y=F.outerHeight()+1,V||(a<y+D&&y<D?D=f.y-y:(x=l.getBoundingClientRect(),(s=(L=window.innerHeight)-((E=x.y)+D))<y&&F.height(s))),F.css(ot,D),V&&F.bind("blur",function(){r.jk(m,n,i,v,d),X(e.a6t).show()}),e.gf=m,(j=G("input")).type="image",j.src=(0,U.Hrt)(),j.alt="v",X(j).css(z,$).width(t).height(t).css(ot,f.y+f.height-(t+3)).css(at,f.x+f.width-(u?t:0)).css(ut,h).css(et,ct).css(tt,"1px solid gray").attr(vt,"gcValidationButton").appendTo(c).bind("click",function(t){var n,n;e.isEditing()&&!e.endEdit()||(n=e.gf,X(n).toggle().focus(),n=n.options[n.selectedIndex],q(n)||n.scrollIntoView({behavior:"instant",block:"nearest",inline:"start"}),V&&X(e.a6t).toggle(),H(t))}),e.a6t=j}}})},"./dist/plugins/validation/datavalidation.js":function(V,t,n){var i,y,r,d,n,e,c,S,D,j,x,F,o,h,v,L,a,q,s,g,E,n,e,R,Q,Y,I,J,B,l,P,W,X,G,T,Z,U,H,N,K,_,z,$,m,A,p,tt,u,n,nt,it,rt,et,ot,at,ut,st,ft,i,f,ct,lt,ht,vt,dt,b,n,gt,i,n,n,n,n,n,n;function mt(t){if(L(t))return 0;if("number"==typeof t)return t;if("string"==typeof t){var n=parseFloat(t);if(!isNaN(n)&&n.toString()===t)return n}return g}function At(t){return!L(t)&&t instanceof Date?q(t):t}function pt(t,n){var i,r,e;if(!L(t))return 1===t||2===t?i=Ct(n.operator,n.value1,n.value2,1===t):3===t?n.value?i=Dt(n.value):n.formula&&(i=yt(n.formula)):4===t||5===t?(r=n.value1,e=n.value2,r&&"/OADate("===r.substr(0,8)&&(r=tt.dJ(r)),e&&"/OADate("===e.substr(0,8)&&(e=tt.dJ(e)),i=(5===t?Mt:kt)(n.operator,r,e)):6===t?i=Vt(n.operator,n.value1,n.value2):7===t&&void 0!==n.formula&&(i=St(n.formula)),i?i.condition():void 0}function bt(t,n,i,r,e,o){var a,u,s,f,c,l,h,v,o,o,s,f,u,d,v,n,r,i,e,e,l,a;return t.intersect(n,i,r,e)?(a=t.rowCount,u=t.colCount,s=p(0,t.row),f=p(0,t.col),h=l=c=!1,n=p(0,n),i=p(0,i),v=(o=o||[-1,-1])[0],o=o[1],-1===a&&(a=v-s,l=!0),-1===u&&(u=o-f,c=!0),-1===e&&(e=o-i,h=!0),s=(o=s)+a-1,u=(f=f)+u-1,v=(d=n)+(r=-1===r?v-n:r)-1,r=(n=i)+e-1,i=[],-1!==o&&-1!==f&&-1!==d&&-1!==n&&(0<n-f&&(e=m(o,f,l?-1:a,n-f),i.push(e)),0<u-r&&(e=m(o,1+r,l?-1:a,u-r),i.push(e)),0<d-o&&(l=m(o,p(n,f),d-o,c&&h?-1:A(r,u)-p(n,f)+1),i.push(l)),0<s-v)&&(a=m(1+v,p(n,f),s-v,c&&h?-1:A(r,u)-p(n,f)+1),i.push(a)),i.c6t=!0,i):[t]}function w(t,n){var n;if(!L(t))return"string"==typeof t&&(t=G(t)),t=3===n||!(t=4!==n&&5!==n||(n=parseFloat(t),isNaN(n))?t:_(t))||t instanceof Date?t:P(t)}function C(t){var n=this;n.id=C.f6t,C.f6t++,n.l6t=a(rt),t&&(n.condition(t),n.condition().ignoreBlank(n.ignoreBlank())),n._S=[]}function wt(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMOSURBVHjaXJNdaJRHFIbfM7PfGremUTfkpxgpiheiBOmFtYUgRXNRqNnd75sEhBoIKhrwQpFUUSsihhIQ41+FNrUGqYhRY43STZqgARNRTIzRaFqz6xJTtals3K8xRQ3x7UV215+LB2bOxTNn3jMDs+mEIgmS+LwQiqSQ9JG03FHX54666pn7TLmJEZVIjCCRGMkYGxvNiI9FvaENZzLw/PmqtCDFV/4WkERw8TI03K6XqqrNWLBgPoafDmNwMCbd3TestpMDHpJAuIcWSZjSUrnS0SFOWamXJLpuDYAkAiYAkioYDCIej0+Lx12QrervFxOemjWfCvIyIcmTVeLVC1986OkUklhRtlgutLYrkpnOKlt1dl0BSfTHmnCnm5oTm0AS6I0xLaDLrK1PusTp/cb7/rUAyH8kSL+Vqt0ebpuGP699LCRROAdqf/suGforCpLi4DMpAOQQLAEgfE2sRDZIv5cknGxi74HDFnZ/32olk9f//vOTPIj05ZnKZpp14QlnfZgpTOXvNGsvjrvuH9MnOwAOYlhQ/UPYmxRkJVvzPHw8JF8EdrKoZEeapSt2cHDo4Sxn7R0hiV8/hEQe3Ad21jZNJQnbDklSBBas0ddvRj2Fi4qZIhaL+Q3ni8N0ZohGe4Dv6sKZfFP0kvkSWLZdGvLpiUTuTS9cVMxI5H5+fz+UfXyOto/Ns5bUL7dyjsBjTsKDbbVnM0iqYNHXYi9ZLiSlaRbFn089zlzvwN1IzkDlmDhfdiin5KgOBY5qO9iojX1K9+VRcOCXnlySsFkOkjj/WGschtR0Kt/Ga9D2aYj5DWKaIeYSxTlFMS2T66udBDbXHS94Z97ZUB8Ayt7+iVVddlkzl5LCvrklvQ9dr1fnF0IQbng5O/VQsmAJSfnxSLuqCG3Rxxpfz3xbXv0IEkzm5YR7lXOCGs6+PVNJYjaQnoKwSgBIDSqkjjPUuv3QLP9ImW+hG1/lKJtzp5jaCmW2nrNAUpOUkqrWrJUb23T5rhZf0eoWhbeEKX7O4eTPHe8DSTjF59T/AwCfnhbaDaIICgAAAABJRU5ErkJggg=="}function O(t){return o&&t&&"="===t[0]}function Ct(t,n,i,r){var e,o,a,u,n,s,f,i,e=g,o=g,a=g,u=g;return O(n)?e=v(n,"="):o=n,O(i)?a=v(i,"="):u=i,n=g,6===t&&((s=h(1,3,o,e)).integerValue(r),(f=h(1,5,u,a)).integerValue(r),n=h(0,1,g,g,g,g,g,s,f)),7===t&&((s=h(1,4,o,e)).integerValue(r),(f=h(1,2,u,a)).integerValue(r),n=h(0,0,g,g,g,g,g,s,f)),0<=t&&t<=5&&(n=h(1,t,o,e)).integerValue(r),(i=new b(n)).type(r?1:2),i.comparisonOperator(t),i}function Ot(t,n,i,r,e){var o,a,u,s,n,f,c,l,i,o=g,a=g,u=g,s=g;if(O(n)?o=v(n,"="):a=n,O(i)?u=v(i,"="):s=i,n=g,6===t&&(f=h(r,5,a,o),c=h(r,3,s,u),n=h(0,1,g,g,g,g,g,f,c)),7===t&&(f=h(r,2,a,o),c=h(r,4,s,u),n=h(0,0,g,g,g,g,g,f,c)),0<=t&&t<=5){switch(t){case 0:l=0;break;case 1:l=1;break;case 2:l=4;break;case 3:l=5;break;case 4:l=2;break;case 5:l=3}n=h(r,l,a,o)}return(i=new b(n)).type(e),i.comparisonOperator(t),i}function kt(t,n,i){return Ot(t,n,i,5,4)}function Mt(t,n,i){return Ot(t,n,i,13,5)}function Vt(t,n,i){var r,e,o,a,n,u,s,i,r=g,e=g,o=g,a=g;return O(n)?r=v(n,"="):e=n,O(i)?o=v(i,"="):a=i,n=g,6===t&&(u=h(7,3,e,r),s=h(7,5,a,o),n=h(0,1,g,g,g,g,g,u,s)),7===t&&(u=h(7,4,e,r),s=h(7,2,a,o),n=h(0,0,g,g,g,g,g,u,s)),0<=t&&t<=5&&(n=h(7,t,e,r)),(i=new b(n)).type(6),i.comparisonOperator(t),i}function St(t){var t;return o?((t=new b(h(4,g,g,v(t,"="),4))).type(7),t):g}function yt(t){var t;return o?((t=new b(r.Condition.fromFormula(t))).type(3),t):g}function Dt(t){var t=new b(r.Condition.fromSource(t));return t.type(3),t}function jt(t){return t&&t.getExpressions&&0<t.getExpressions().length}function xt(t){return this.JS(t)}function Ft(t,n){if(t&&n&&n.length)return n.map(xt.bind(t))}function Lt(t,n,i){var r,e,o,r=t.rowCount,e=t.colCount,o=m(t.row,t.col,r,e);return 0===t.row&&r===n&&(o.row=-1),0===t.col&&e===i&&(o.col=-1),o}function Et(t,n){var i=t.getRowCount(),r=t.getColumnCount();return n.map(function(t){return Lt(t,i,r)})}function It(t,n){var i,t,i=t.cellCache;return i||(t.cellCache=i={}),(t=i[n])||(i[n]=t={}),t}function Bt(e,t,n,o,a,u,s){var f,c,l,h,v,i,r,d,g,m,A,p,b,w,C,f=o.h6t,c=e.row,l=e.col,h=e.rowCount,v=e.colCount,i=c+h,r=l+v;if(t<=i-1&&(h=t-c),n<=r-1&&(v=n-l),i===t)for(d=function(t,n){var i,r,i,i=f.colCache;i||(f.colCache=i={}),(r=i[n])||(i[n]=r={}),(i=r.dv)&&i!==a&&i.FX(e,o),r.dv=a,r.cacheStartRowIndex=c,(L(r.cacheRowCount)||!0===s&&a.smt().some(function(t){return t.intersect(u,n,1,1)}))&&(r.cacheRowCount=h)},g=0,m=l;g<v;g++,m++)d(g,m);else if(r===n)for(A=function(t,n){var i,r,i,i=f.rowCache;i||(f.rowCache=i={}),(r=i[n])||(i[n]=r={}),(i=r.dv)&&i!==a&&i.FX(e,o),r.dv=a,r.cacheStartColIndex=l,(L(r.cacheColCount)||!1===s&&a.smt().some(function(t){return t.intersect(n,u,1,1)}))&&(r.cacheColCount=v)},p=0,b=c;p<h;p++,b++)A(p,b);else for(p=0,b=c;p<h;p++,b++)for(w=It(f,b),g=0,m=l;g<v;g++,m++)(C=w[m])&&C!==a&&C.FX(e,o),w[m]=a}function Tt(t,n){var i,r,e,o,a,u,s,f,c,l,h,v,d,g,m,A,p,b,g,m,w,C,O,k,M,V,O,k,S,y,D,j,i=n.h6t,r=t.row,e=t.col,o=t.rowCount,a=t.colCount,u=n.eJ,s=u.getRowCount(),f=u.getColumnCount(),c=i.colCache,l=i.rowCache,h=i.cellCache;if(c)for(v=e;v<e+a;v++)if(g=(d=c[v])&&d.cacheStartRowIndex,m=d&&d.cacheRowCount,d&&(g<=r&&r<g+m||g<=r+o&&r+o<=g+m)){if(A=!1,r<s){for(p=g;p<=r;p++)b=It(i,p),p<r&&(b[v]=d.dv);(m=r+o)-(g=d.cacheStartRowIndex)===d.cacheRowCount?c[v]=E:(d.cacheStartRowIndex=m,d.cacheRowCount-=m-g),A=!0}else r+o===s&&(A=!(c[v]=E));A&&(w=d.dv)&&w.FX(t,n)}if(l)for(C=r;C<r+o;C++)if(O=(b=l[C])&&b.cacheStartColIndex,k=b&&b.cacheColCount,b&&(O<=e&&e<O+k||O<=e+a&&e+a<=O+k)){if(A=!1,e<f){for(M=O;M<=e;M++)V=It(i,C),M<e&&(V[M]=b.dv);(k=e+a)-(O=b.cacheStartColIndex)===b.cacheColCount?l[C]=E:(b.cacheStartColIndex=k,b.cacheColCount-=k-O),A=!0}else e+a===f&&(A=!(l[C]=E));A&&(w=b.dv)&&w.FX(t,n)}if(h)for(C=0,S=r,y=o;C<y;C++,S++)if(b=h[S])for(v=0,D=e,j=a;v<j;v++,D++)(w=b[D])&&w.FX(t,n),b[D]=E}function Ut(t){switch(t){case"none":return f.anyValue;case"whole":return f.wholeNumber;case"decimal":return f.decimalValues;case"list":return f.list;case"date":return f.date;case"time":return f.time;case"textLength":return f.textLength;case"custom":return f.custom}}function qt(t){var n,i,r,n=[];if(t)for(i in t)(r=t[i])&&n.push(r);return n}function Rt(t,n,i){var r,e,o;if(t)for(e=(r=Object.keys(t)).length-1;0<=e&&n<=(o=+r[e]);e--)t[o+i]=t[o],delete t[o]}function k(t){this.eJ=t,this.YB={},this.h6t={},this.d6t=[]}function Qt(t){return t="string"==typeof t?'"'+t+'"':t}function Yt(t){var n=t.D5;return L(n)?(n=t.expected(),Qt(J(n))):n}function Jt(t){var n,i,r;return L(t)?g:0===(n=t.conType())?Pt(t):1===n||7===n?(r=t.formula(),{firstFormula:r=L(r)?t.expected():r}):4===n?{firstFormula:L(t.formula())?t.expected():t.formula()}:12===n||5===n||13===n?{firstFormula:Yt(t)}:{firstFormula:g}}function Pt(t){var n,i;return L(t)?g:(i=n=g,{firstFormula:n=t.item1()?(0===t.item1().conType()?Pt:Jt)(t.item1()).firstFormula:n,secondFormula:i=t.item2()?(0===t.item2.conType?Pt:Jt)(t.item2()).firstFormula:i})}function Wt(t){var n,n,n=typeof t;return"string"==n||"number"==n?Y(t.toString()):L(t)||L((n=t).item1)?"":Wt(n.item1)}function M(t,n){var i,n;if(!L(t))return i=t,n=+(i=n&&O(t)?t.substr(1):i),isNaN(n)?t:n}function Xt(t){var n=t.row,i=t.col,r=t.rowCount,t=t.colCount;return-1===n&&-1===i?i=0:(-1!==n&&-1!==r&&n+r>y.MAX_ROW_COUNT&&(r=y.MAX_ROW_COUNT-n),-1!==i&&-1!==t&&i+t>y.MAX_COLUMN_COUNT&&(t=y.MAX_COLUMN_COUNT-i)),m(n,i,r,t)}function Gt(t){var t=t.map(Xt);return d.rangesToFormula(t,0,0,15,!1).split(", ").join(" ")}Object.defineProperty(t,"__esModule",{value:!0}),t.createListValidator=t.createFormulaListValidator=t.createFormulaValidator=t.createTextLengthValidator=t.createTimeValidator=t.createDateValidator=t.createNumberValidator=t.kf=t.Hrt=t.DefaultDataValidator=t.HighlightPosition=t.HighlightType=t.ErrorStyle=t.DataValidationResult=t.CriteriaType=void 0,i=n("Common"),y=n("Core"),r=n("ConditionalFormatting"),d=n("SheetsCalc"),n=n("CalcEngine"),e=i.Common.ct,c=y.UsedRangeUtil.vh,S=y.UsedRangeUtil.hh,D=y.XFileConstants.Au,j=y.XFileConstants.Ou,x=y.XFileConstants.Ru,F="1",o=!!n,h=r.aJ,v=i.Common.zf.cJ,L=i.Common.lt.ht,a=i.Common.lt.tv,q=e.o0,s=y.GC$,g=null,E=void 0,e=(n=y.mt).p0,R=n.T1,Q=n.G0,Y=n.t1,I=n.e1,J=n.i1,B=n.vo,l=n.n1,P=n.g1,W=n.b1,X=n.p1,G=y.Util.mr,T=y.Util.addXLFNPrefix,Z=y.Util.pr,U=n.xr,H=n.C1,N=n.Hue,K=n.c1,_=n.Eve,z=y.range_parser.Dc,$=y.range_parser.Oc,m=y.Ec,A=Math.min,p=Math.max,tt=i.Common.ct,u=".validator",rt={type:0,color:n="red"},et={type:nt=1,color:n,position:1},ot={type:2,color:n,position:it=5,image:null},(i=at=at||{})[i.none=0]="none",i[i.whole=1]="whole",i[i.decimal=2]="decimal",i[i.list=3]="list",i[i.date=4]="date",i[i.time=5]="time",i[i.textLength=6]="textLength",i[i.custom=7]="custom",(n=ut=ut||{})[n.stop=0]="stop",n[n.warning=1]="warning",n[n.information=2]="information",st={0:"equal",1:"notEqual",2:"greaterThan",4:"lessThan",3:"greaterThanOrEqual",5:"lessThanOrEqual",6:"between",7:"notBetween"},ft={equal:0,notEqual:1,greaterThan:2,greaterThanOrEqual:3,lessThan:4,lessThanOrEqual:5,between:6,notBetween:7},i=window,(n=f=t.CriteriaType||(t.CriteriaType={}))[n.anyValue=0]="anyValue",n[n.wholeNumber=1]="wholeNumber",n[n.decimalValues=2]="decimalValues",n[n.list=3]="list",n[n.date=4]="date",n[n.time=5]="time",n[n.textLength=6]="textLength",n[n.custom=7]="custom",(n=ct=t.DataValidationResult||(t.DataValidationResult={}))[n.forceApply=0]="forceApply",n[n.discard=1]="discard",n[n.retry=2]="retry",(n=lt=t.ErrorStyle||(t.ErrorStyle={}))[n.stop=0]="stop",n[n.warning=1]="warning",n[n.information=2]="information",(n=ht=t.HighlightType||(t.HighlightType={}))[n.circle=0]="circle",n[n.dogEar=1]="dogEar",n[n.icon=2]="icon",(n=vt=t.HighlightPosition||(t.HighlightPosition={}))[n.topLeft=0]="topLeft",n[n.topRight=1]="topRight",n[n.bottomRight=2]="bottomRight",n[n.bottomLeft=3]="bottomLeft",n[n.outsideLeft=4]="outsideLeft",n[n.outsideRight=5]="outsideRight",dt=["errorStyle","ignoreBlank","preciseCompareDate","inCellDropdown","showInputMessage","showErrorMessage","inputTitle","errorTitle","inputMessage","errorMessage","comparisonOperator","type","condition"],C.prototype.value1=function(t,n){var i,i,t,i=this.condition(),i=i&&i.item1()?i.item1():i;return i?(t=i.formula(t,n))&&0<t.length?"="+v(s.trim(t.toString()),"="):i.expected():g},C.prototype.value2=function(t,n){var i,i,t,i=this.condition(),i=i&&i.item2()?i.item2():i;return i?(t=i.formula(t,n))&&0<t.length?"="+v(s.trim(t.toString()),"="):i.expected():g},C.prototype.isValid=function(t,n,i,r,e){var o,a,u,s,f,e,o=this,a=o.condition(),u=L(e)||!0===e;if(a){if(o.ignoreBlank()&&(L(r)||""===r))return!0;if(f=void 0,!L(s=r))switch(o.type()){case 0:return!0;case 2:case 1:f=u?mt(r):r,L(f)||(s=f);break;case 4:case 5:f=u?_(r):r,L(f)||(s=f)}t&&(t.EJ=!0),e=void 0;try{e=a.evaluate(t,n,i,s,s)}catch(t){e=!0}finally{t&&(t.EJ=!1)}return e}return!0},C.prototype.reset=function(){var t=this;t.errorStyle(0),t.ignoreBlank(!0),t.preciseCompareDate(!1),t.inCellDropdown(!0),t.showInputMessage(!0),t.showErrorMessage(!0),t.inputTitle(""),t.errorTitle(""),t.inputMessage(""),t.errorMessage(""),t.comparisonOperator(6),t.type(0),t.condition(g),t._S.length=0},C.prototype.getValidList=function(t,n,i){var r=this.condition();return r!==g&&3===this.type()&&12===r.conType()?r.getValidList(t,n,i):g},C.prototype.highlightStyle=function(t){var n,i,r,e,n=this;if(0===arguments.length)return n.l6t;if(!L(t)){if(n.l6t.type!==t.type)switch(i=t.type){case 1:n.l6t=a(et);break;case 2:n.l6t=a(ot);break;default:n.l6t=a(rt)}for(e in r=n.l6t)r.hasOwnProperty(e)&&t.hasOwnProperty(e)&&(r[e]=t[e]);return n.Mf&&n.Mf.repaint(),n}},C.prototype.toJSON=function(i){var r,e,t,r=this,e={};return dt.forEach(function(t){var n=r[t]();r[t].isDefault(n)||(e[t]=n&&n.toJSON?n.toJSON(i):n)}),t=r._S.map(Xt),e.ranges=d.rangesToFormula(t,0,0,15,!1),e.highlightStyle=JSON.stringify(r.l6t),s.isEmptyObject(e)?E:e},C.prototype.fromJSON=function(e,o,a){var u,t,n,i,t;e&&!s.isEmptyObject(e)&&(u=this,e.ranges&&(u._S=d.formulaToRanges(a,e.ranges,0,0,!0)[0].ranges),e.highlightStyle&&(u.l6t=JSON.parse(e.highlightStyle)),dt.forEach(function(t){var n,i,r,n=e[t];R(n)&&("condition"===t?((i=h()).fromJSON(e.condition,a,o),u.condition(i,!1),(r=i.ranges())&&r.length?u._S=r:i.ranges(u._S),i.context(a)):u[t](n,!1))}),t=e.validatorInfo)&&(n=a.Lp.useR1C1,i=pt(e.type,t),t=t.operator,i&&(i.ranges(u._S),i.ignoreBlank(u.ignoreBlank()),i.context(a),n&&Q(i),u.condition(i)),L(t)||u.comparisonOperator(t))},C.prototype.clone=function(t){var n,n;return this.ZB?((n=this.condition())&&n.initExpression(),this):((n=new C).fromJSON(this.toJSON(t),!1,t||this.Mf),n._S=[],n)},C.prototype.context=function(t){var n;return t&&(this.DJ=t,n=this.condition())&&(n.ranges(this._S),n.context(t)),this.DJ},C.prototype.v6t=function(t){var n,i;if(t){for(n=this._S,i=0;i<n.length;i++)if(n[i].containsRange(t))return;n.push(t)}},C.prototype.FX=function(t,n){var i,r,e,o,a,u,s,f,t,c,i=this,r=i._S;t&&r.length&&(e=t.row,o=t.col,a=t.rowCount,u=t.colCount,f=!(s=[]),t=i.Mf,c=t&&[t.getRowCount(),t.getColumnCount()],r.forEach(function(t){var t=bt(t,e,o,a,u,c);t.c6t&&(f=!0),s.push(t)}),i._S=[].concat.apply([],s),f)&&n.m6t(i)},C.prototype.smt=function(){return this._S},C.prototype.XJ=function(){var t=this;t.condition()&&t.condition().initExpression()},C.prototype.g6t=function(t){this.condition()&&this.condition().ranges(t)},C.prototype.qJ=function(t,n,i){var r,e,o,a,u,s,f,c,l,s,h,v,d,r=this,e=!1;for(r.XJ(),a=0,u=(o=r._S).length;a<u;a++)f=(s=o[a]).row,c=s.rowCount,l=s.col,s=s.colCount,h=f===t.row&&c===t.rowCount&&t.col<=l&&s<=t.colCount,v=f===n.row&&c===n.rowCount&&n.col<=l&&s<=n.colCount,(d=h||v)&&(o[a]=m(f,l,c+i,s),e=!0);return e&&r.g6t(o),e},C.prototype.JO=function(t,n,i,r){var e,o,a,u,s,f,c;if(!(t<0||n<=0)){for(this.condition()&&this.condition().initExpression(),e=0;e<this._S.length;e++)if(a=(o=this._S[e]).row,i&&0<i.length){for(u=!1,s=0,f=i.length;s<f;s++)if((c=i[s])&&(!0!==r||c.containsRange(o))){if(c.row===a&&c.row+c.rowCount-n===a+o.rowCount&&a===t){o.rowCount+=n,u=!0;break}if(t<=a){o.row+=n;break}if(t<=a+o.rowCount){o.rowCount+=n;break}}if(u)break}else t<=a?o.row+=n:t<=a+o.rowCount&&(o.rowCount+=n);this.condition()&&this.condition().ranges(this._S)}},C.prototype.xP=function(e,o){var a;e<0||o<=0||(this.condition()&&this.condition().initExpression(),a=[],this._S.forEach(function(t){var n,i,r,n=t.row,i=t.rowCount;e<n?((r=e+o-n)<=0?n-=o:(n-=1+r,t.rowCount-=r),t.row=n=n<0?e:n):n<=e&&e<n+i&&(t.rowCount-=A(o,n+i-e)),(0<t.rowCount||-1===t.row&&-1===t.rowCount)&&a.push(t)}),this._S=a,this.condition()&&this.condition().ranges(this._S))},C.prototype.qO=function(t,n,i){var r,e,o,a,u,s,f,c;if(!(t<0||n<=0)){for(this.condition()&&this.condition().initExpression(),r=0;r<this._S.length;r++){if(e=this._S[r],i&&0<i.length){for(a=o=!1,u=0,s=i.length;u<s;u++)if((f=i[u])&&!f.containsRange(e))o=!0;else if(f&&f.col===e.col&&f.col+f.colCount-n===e.col+e.colCount&&f.col===t){e.colCount+=n,a=!0;break}if(o)continue;if(a)break}t<=(c=e.col)?e.col+=n:t<=c+e.colCount&&(e.colCount+=n)}this.condition()&&this.condition().ranges(this._S)}},C.prototype.NP=function(e,o){var a;e<0||o<=0||(this.condition()&&this.condition().initExpression(),a=[],this._S.forEach(function(t){var n,i,r,n=t.col,i=t.colCount;e<n?((r=e+o-n)<=0?n-=o:(n-=r,t.colCount-=r),n<0&&(t.colCount+=n,n=0),t.col=n):n<=e&&e<n+i&&(t.colCount-=A(o,n+i-e)),(0<t.colCount||-1===t.col&&-1===t.colCount)&&a.push(t)}),this._S=a,this.condition()&&this.condition().ranges(this._S))},C.prototype.rv=function(t,n,i,r){var e,o,a,u,o,a,s,f,c,i,a,e=this;i?((o=U(t,"sqref"))&&(a=d.formulaToRanges(n,o.c_[0],0,0,!0)[0].ranges),e._S=a):e._S=d.formulaToRanges(n,t.sqref,0,0,!0)[0].ranges,u=Ut(t.type),o=ft[t.operator],L(u)||e.type(u),L(o)&&(o=6),e.comparisonOperator(o),t.allowBlank===F?e.ignoreBlank(!0):e.ignoreBlank(!1),L(t.error)||e.errorMessage(l(t.error)),L(t.errorTitle)||e.errorTitle(l(t.errorTitle)),L(t.errorStyle)||e.errorStyle(lt[t.errorStyle]),L(t.prompt)||e.inputMessage(l(t.prompt)),t.showDropDown===F&&e.inCellDropdown(!1),L(t.promptTitle)||e.inputTitle(l(t.promptTitle)),t.showErrorMessage!==F&&e.showErrorMessage(!1),t.showInputMessage!==F&&e.showInputMessage(!1),(a=t.c_)&&0<a.length&&(i?a.forEach(function(t){var n;t&&(n=U(t,"f"),c=l(n&&n.c_[0]),"formula1"===t.n_&&(s=w(c,u)),"formula2"===t.n_)&&(f=w(c,u))}):a.forEach(function(t){t&&(c=l(K(t)),"formula1"===t.n_&&(s=w(c,u)),"formula2"===t.n_)&&(f=w(c,u))})),L(u)||(i=void 0,1===u||2===u?i=Ct(o,M(s,r),M(f,r),1===u):3===u?(c=s||f)&&(i='"'===c[0]&&'"'===c[c.length-1]?Dt(X(c)):yt(P(c))):4===u||5===u?i=(5===u?Mt:kt)(o,s,f):6===u?i=Vt(o,M(s,r),M(f,r)):7===u&&void 0!==s&&(i=St(s)),i&&(a=i.condition())&&(a.ranges(e._S),a.ignoreBlank(e.ignoreBlank()),a.context(n),e.condition(a))),e.Mf=n,t.lossless&&t.lossless.highlightStyle&&(e.l6t=JSON.parse(t.lossless.highlightStyle))},C.f6t=1,b=C,t.DefaultDataValidator=b,n={errorStyle:e("errorStyle",0),ignoreBlank:e("ignoreBlank",!0,function(t){this.condition()&&this.condition().ignoreBlank(t)}),preciseCompareDate:e("preciseCompareDate",!1,function(t){this.condition()&&this.condition().preciseCompareDate(t)}),inCellDropdown:e("inCellDropdown",!0),showInputMessage:e("showInputMessage",!0),showErrorMessage:e("showErrorMessage",!0),inputTitle:e("inputTitle",""),errorTitle:e("errorTitle",""),inputMessage:e("inputMessage",""),errorMessage:e("errorMessage",""),comparisonOperator:e("comparisonOperator",6),condition:e("condition",g),type:e("type",0)},s.extend(b.prototype,n),t.Hrt=wt,t.kf=O,t.createNumberValidator=Ct,t.createDateValidator=kt,t.createTimeValidator=Mt,t.createTextLengthValidator=Vt,t.createFormulaValidator=St,t.createFormulaListValidator=yt,t.createListValidator=Dt,s.extend(y.Worksheet.prototype,{getDataValidator:function(t,n,i){var t=this.hG(t,n,i);return t?t[0]:E},hG:function(t,n,i){return 3===(i=L(i)?3:i)?this.b8.p6t(t,n):E},setDataValidator:function(t,n,i,r,e,o){var a,u,s,f,i,r,a=this,u=a.b8;arguments.length<5&&(e=i,o=r,i=-1===t?-1:1,r=-1===n?-1:1),3===(o=L(o)?3:o)&&(s=a.getDataValidator(t,n,o),(f=1===i&&1===r)&&s===e||(a.Ut.b6t(),i=m(t,n,i,r),u.y6t(i),e&&u.w6t(e,i),a.Ut.b6t(!0),r="validator",f&&(a.Rj(r,t,n,o,s,e),-1!==t&&-1===n?a.dj(t,o,r,e,s):-1===t&&-1!==n&&a.vj(n,o,r,e,s)),a.zw()))},isValid:function(t,n,i,r){var e,o,e=this;try{if(e.Ubt=t,e.Hbt=n,e.zbt=i,e.Gbt=!0,o=e.getDataValidator(t,n))return o.isValid(e,t,n,i,r)}finally{e.Ubt=-1,e.Hbt=-1,e.zbt=g,e.Gbt=!1}return!0},G1:function(){var t,n,i,n,n,t=this;return!(t.M6t||(t.M6t=!0,(n=t.KD)&&((i=n.parentNode)&&i.removeChild(n),t.KD=g),(n=t.a6t)&&(s(n).unbind("click"),(i=n.parentNode)&&i.removeChild(n),t.a6t=g),(n=t.gf)&&(s(n).unbind("keydown").unbind("blur").unbind("click").unbind("change"),(i=n.parentNode)&&i.removeChild(n),t.gf=g),t.M6t=!1))},xyt:function(){var t,n,i,r,e,o,a,t=this,n=[],i=t.b8,r=i&&i.YB;if(r)for(e in r)jt(a=(o=r[e])&&o.condition())&&n.push({validator:o,sheet:t});return n},Sge:function(t,n){var t=this.getDataValidator(t,n);return t&&jt(t.condition())}}),s.extend(y.Workbook.prototype,{xyt:function(){var n,t,i,n=[],t,i;return this.sheets.forEach(function(t){var t=t.xyt();t&&t.length&&t.forEach(function(t){n.push(t)})}),n}}),s.extend(y.CellRange.prototype,{validator:function(t){var n,i,r,e,o,a,u,n=this,i=n.sheet,r=n.sheetArea,e=n.row,o=n.col,a=n.rowCount,u=n.colCount;return 0===arguments.length?i.getDataValidator(e,o,r):(i.setDataValidator(e,o,a,u,t,r),n)}}),k.prototype.getUsedRange=function(){var t,n,i,r,e,o,a,u,s,f,t,n=this.p6t(),i={};if(n)for(r=void 0,e=0,o=n;e<o.length;e++)for(u=0,s=r=(a=o[e]).smt();u<s.length;u++)f=s[u],c(i,S(f));return i},k.prototype.L0=function(){this.eJ=g},k.prototype.GJ=function(t){return Ft(this.eJ,t)},k.prototype.OX=function(t){return Et(this.eJ,t)},k.prototype.C8=function(t,n,i){var r,e,o,a,r=this,e=r.YB;if(L(n)?r.h6t={}:r.h6t.cellCache={},e)for(o in e)(a=e[o])&&(t&&delete a.C6t,r.fE(a,!0,n,i));r.S6t()},k.prototype.m6t=function(t){var n=this.d6t;-1===n.indexOf(t)&&n.push(t)},k.prototype.fE=function(n,t,i,r){var e=this,o=e.GJ(n.smt()),a=e.eJ,u=a.getRowCount(),s=a.getColumnCount();o&&(e.d6t.length=0,o.forEach(function(t){Bt(t,u,s,e,n,i,r)}),t||e.S6t())},k.prototype.RX=function(t){var n=this,t=n.GJ(t.smt());n.d6t.length=0,t.forEach(function(t){Tt(t,n)}),n.S6t()},k.prototype.BX=function(t){var n=this;t&&Tt(n.eJ.JS(t),n),n.S6t()},k.prototype.S6t=function(){var t,n,t=this.d6t;t.length&&(n=this.YB,t.forEach(function(t){t.smt().length?t.condition()&&t.condition().ranges(t.smt()):(delete n[t.id],delete t.Mf)}),t.length=0)},k.prototype.w6t=function(t,n){var i=this,r=i.eJ;if(n&&((t=t.Mf&&r!==t.Mf?t.clone(r):t).Mf=r,t.v6t(n)),r)return t.context(r),i.YB[t.id]=t,i.fE(t),t},k.prototype.y6t=function(t){var n,i;t&&(i=(n=this).eJ,n.BX(t),i.zw())},k.prototype.d5=function(){var t=this,n;t.eJ&&(t.YB={},t.C8())},k.prototype.p6t=function(t,i){var n,r,e,n,o,r,r,r,r,r,n=this,r=n.YB;return 0===arguments.length||(e=[],n=n.h6t,i===E&&(i=-1),-1===(t=t===E?-1:t)&&-1===i)?qt(r):((r=(r=n.colCache)&&r[i])&&(t>=r.cacheStartRowIndex&&t<r.cacheStartRowIndex+r.cacheRowCount||-1===t&&0===r.cacheStartRowIndex)?e.push(r.dv):(r=(r=n.rowCache)&&r[t])&&(i>=r.cacheStartColIndex&&i<r.cacheStartColIndex+r.cacheColCount||-1===i&&0===r.cacheStartColIndex)?e.push(r.dv):(r=n.cellCache)&&(-1!==t&&-1!==i?(o=r[t])&&o[i]&&e.push(o[i]):-1===t?s.each(r,function(t,n){var n=n[i];n&&-1===e.indexOf(n)&&e.push(n)}):(o=r[t])&&s.each(o,function(t,n){n&&-1===e.indexOf(n)&&e.push(n)})),e)},k.prototype.qJ=function(t,n,i){var r,e,o,a,u,s,f,r=this,e,o=r.eJ.Ut,a=r.YB,u=!1;if(!L(a)){for(s in o.b6t(),a)(f=a[s])&&f.qJ(t,n,i)&&(u=!0);u&&r.C8()}},k.prototype.jve=function(t,n,i){var r,e=this.h6t;e&&Rt(i?e.rowCache:e.colCache,t,n)},k.prototype.$J=function(t,n,i,r,e){var o,a,u,s,o=this,a=o.YB;if(a)for(u in a)(s=a[u])&&(i?s.JO(t,n,r,e):s.qO(t,n,r));o.jve(t,n,i),o.C8(E,t,i)},k.prototype.JO=function(t,n,i,r){this.$J(t,n,!0,i,r)},k.prototype.qO=function(t,n,i){this.$J(t,n,!1,i)},k.prototype.tX=function(t,n,i){var r,e,o,a,r=this,e=r.YB;if(e)for(o in e)(a=e[o])&&(i?a.xP(t,n):a.NP(t,n),0===a._S.length)&&(e[o]=E);r.C8()},k.prototype.xP=function(t,n){this.tX(t,n,!0)},k.prototype.NP=function(t,n){this.tX(t,n,!1)},k.prototype.toJSON=function(t){var n,i,r,e,n=this.YB,i=[];for(r in n)(e=n[r])&&i.push(e.toJSON(t));return i},k.prototype.fromJSON=function(t,i,r){var e=this,o=e.eJ;e.YB={},t&&t.length&&(t.forEach(function(t){var n=new b;n.fromJSON(t,i,r),n.Mf=o,e.YB[n.id]=n}),e.C8())},k.prototype.y8=function(t,n,i){this.eJ.setDataValidator(t,n,i)},gt=k,s.extend(y.Y8.prototype,{b6t:function(t){var n,i,r,e,o,a,u,n=this,i=n.G8;if(i&&(t||!i.originalValidators)){for(o in e=[],r=n.b8.YB)(a=r[o])&&(u=a._S.map(function(t){return m(t.row,t.col,t.rowCount,t.colCount)}),e.push({validator:a,ranges:u}));t?i.currentValidators=e:i.originalValidators=e}},T6t:function(t){var r,n,e;t&&(r=this.Mf,n=this.b8,e={},t.forEach(function(t){var n,i,n=t.validator;"Object"===n.constructor.name&&((i=new b).fromJSON(n,!1,r),n=i),n._S=t.ranges,n.condition()&&n.condition().ranges(n._S),e[n.id]=n}),n.YB=e,n.C8(!1))},ATt:function(t,n,i,r){this.b6t(),this.b8.JO(t,n,i,r),this.b6t(!0)},A6t:function(t,n){this.b6t(),this.b8.xP(t,n),this.b6t(!0)},NTt:function(t,n,i){this.b6t(),this.b8.qO(t,n,i),this.b6t(!0)},kTt:function(t,n){this.b6t(),this.b8.NP(t,n),this.b6t(!0)},I6t:function(t){this.b6t(),this.b8.BX(t),this.b6t(!0)},x6t:function(){this.b6t(),this.b8.C8(),this.b6t(!0)}}),y.Y8.ch("validator",{init:function(){this.b8=new gt(this.Mf)},applyChanges:function(t){var n,t,t,n=t.changes,t=t.isUndo;n&&(t=t?n.originalValidators:n.currentValidators)&&this.T6t(t)},undo:function(t){var t=t.originalValidators;t&&this.T6t(t)},dispose:function(t){var n;!1!==(t&&t.clearCache)&&this.b8&&(this.b8.L0(),this.b8=g)}}),y.Worksheet.ch("validator",{getUsedRange:function(t){var n,i,r;t.type&y.UsedRangeType.dataValidation&&(r=(i=(n=this).b8).getUsedRange(),c(t.range,r))},init:function(){var i=this;i.b8=i.Ut.b8,i._3(y.Events.FloatingElementSelected+u),i.D3(y.Events.FloatingElementSelected+u,function(t,n){"worksheet"!==n.type&&i.G1()})},dispose:function(t){var n=this;n.G1(),t.clearCache&&n.b8.d5(),!1!==t.clearCache&&n._3(y.Events.FloatingElementSelected+u)},onLayoutChanged:function(t){var n,i,r,e,o,a,u,s,f,n=t.changeType,i=t.row,r=t.rowCount,e=t.col,o=t.colCount,a=t.sheetArea,u=L(a)||3===a,s=this.Ut,f=this.tables;"addRows"===n&&u?s.ATt(i,r,f&&f.AJ(i,-1,r,-1,!0)):"deleteRows"===n&&u?s.A6t(i,r):"addColumns"===n&&u?s.NTt(e,o,f&&f.AJ(-1,e,-1,o,!1)):"deleteColumns"===n&&u?s.kTt(e,o):"clear"===n?3===a&&2==(2&t.type)&&s.I6t(m(i,e,r,o)):"setColumnCount"!==n&&"setRowCount"!==n||3!==a&&1!==a||s.x6t()},toJson:function(t,n){var i,n,n,i=this.b8,n=n&&n.ignoreStyle;i&&!n&&(n=i.toJSON(this))&&n.length&&(t.validations=n)},fromJson:function(t,n,i){var i,i,i=i&&i.ignoreStyle;t&&t.validations&&!i&&(i=t.validations,this.b8.fromJSON(i,n,this))},wh:function(t,n,i){var r,e,o,a,u,i,s,f,c,l,h,v,d,g,m,A,p,b,w,C,O,k,M,g,m,A,p,b,w,C,O,V,S,r=this,e=r.b8,o=i&&!1===i.includeStyles,a=i&&i.fileType===y.OpenSaveFileType.excel;if(!o&&e&&!r.NMi){for(l in u=e.YB,s=(i={n_:j,c_:[]}).c_,f=0,c=[],u)if((h=u[l])&&h._S&&0<h._S.length){if(f++,d=!(v={n_:x}),g=h.comparisonOperator(),m=h.ignoreBlank(),A=h.errorMessage(),p=h.errorTitle(),b=h.errorStyle(),w=h.inputMessage(),C=h.inCellDropdown(),O=h.inputTitle(),k=h.showErrorMessage(),M=h.showInputMessage(),6!==g&&(v.operator=st[g]),!1!==m&&(v.allowBlank=F),A&&(v.error=B(Z(A))),p&&(v.errorTitle=B(p)),0!==b&&(v.errorStyle=ut[b]),w&&(v.prompt=B(Z(w))),!1===C&&(v.showDropDown=F),O&&(v.promptTitle=B(O)),!1!==k&&(v.showErrorMessage=F),!1!==M&&(v.showInputMessage=F),g=h.condition(),m=h._S,v.sqref=Gt(m),g){if(A=h.type(),v.type=at[A],b=(p=Jt(g)).firstFormula,w=p.secondFormula,a&&(H(b)||H(w)))continue;v.c_=[],C=r.name(),O=r.parent&&r.parent.r4(),I(b,C,O)||I(w,C,O)?(v.n_=x,L(b)||v.c_.push({n_:"formula1",c_:[{n_:"f",c_:[B(T(b))]}]}),L(w)||v.c_.push({n_:"formula2",c_:[{n_:"f",c_:[B(T(w))]}]}),v.c_.push({n_:"sqref",c_:[$(m)]}),d=!0):(L(b)||(4===A||5===A?v.c_.push({n_:"formula1",c_:[At(b)+""]}):v.c_.push({n_:"formula1",c_:[B(T(b))]})),L(w)||(4===A||5===A?v.c_.push({n_:"formula2",c_:[At(w)+""]}):v.c_.push({n_:"formula2",c_:[B(T(w))]})))}h.l6t&&(v.lossless={highlightStyle:JSON.stringify(h.l6t)}),(d?c:s).push(v)}0<s.length&&(i.count=f,t.c_.push(i)),0<c.length&&(V=U(t,D)).c_.push(S={n_:"ext",r_:[1,9],c_:[{n_:j,c_:c,r_:[2],count:c.length}]})}},yh:function(t,n,i){var r,e,o,a,u,i,s,f,c,l,i,t,h,v,r=this,e=r.b8,o=e.YB,a;if(!(i&&!1===i.includeStyles)&&e&&d){if(u=y.Util.ko(i),(s=(i=U(t,j))&&i.c_)&&0<s.length)for(f=s.length-1;0<=f;f--)c=s[f],(l=new b).rv(c,r,E,u),o[l.id]=l;if(i=U(t,D),(t=N(i,"dataValidations"))&&t.c_&&0<t.c_.length)for(f=(h=t.c_).length-1;0<=f;f--)v=h[f],(l=new b).rv(v,r,!0,u),o[l.id]=l;e.C8()}}}),y.Style.ch("validator",{fromJson:function(t){var n;"validator"===t.p&&((n=new b).fromJSON(t.v,t.noSchema,t.context),this.validator=n,t.r=!0)}}),i.gcGlobal.wf.push(function(t,n){!n&&t.G1&&t.G1()})},Common:function(t){t.exports=GC.Spread},CalcEngine:function(t){t.exports=GC.Spread.CalcEngine},Core:function(t){t.exports=GC.Spread.Sheets},SheetsCalc:function(t){t.exports=GC.Spread.Sheets.CalcEngine},ConditionalFormatting:function(t){t.exports=GC.Spread.Sheets.ConditionalFormatting}},r={},n=t={},Object.defineProperty(n,"__esModule",{value:!0}),n.createListValidator=n.createFormulaListValidator=n.createFormulaValidator=n.createTextLengthValidator=n.createTimeValidator=n.createDateValidator=n.createNumberValidator=n.kf=n.Hrt=n.HighlightPosition=n.HighlightType=n.DefaultDataValidator=n.ErrorStyle=n.DataValidationResult=n.CriteriaType=void 0,o("./dist/plugins/validation/datavalidation-event.js"),e=o("./dist/plugins/validation/datavalidation.js"),Object.defineProperty(n,"CriteriaType",{enumerable:!0,get:function(){return e.CriteriaType}}),Object.defineProperty(n,"DataValidationResult",{enumerable:!0,get:function(){return e.DataValidationResult}}),Object.defineProperty(n,"ErrorStyle",{enumerable:!0,get:function(){return e.ErrorStyle}}),Object.defineProperty(n,"DefaultDataValidator",{enumerable:!0,get:function(){return e.DefaultDataValidator}}),Object.defineProperty(n,"HighlightType",{enumerable:!0,get:function(){return e.HighlightType}}),Object.defineProperty(n,"HighlightPosition",{enumerable:!0,get:function(){return e.HighlightPosition}}),Object.defineProperty(n,"Hrt",{enumerable:!0,get:function(){return e.Hrt}}),Object.defineProperty(n,"kf",{enumerable:!0,get:function(){return e.kf}}),Object.defineProperty(n,"createNumberValidator",{enumerable:!0,get:function(){return e.createNumberValidator}}),Object.defineProperty(n,"createDateValidator",{enumerable:!0,get:function(){return e.createDateValidator}}),Object.defineProperty(n,"createTimeValidator",{enumerable:!0,get:function(){return e.createTimeValidator}}),Object.defineProperty(n,"createTextLengthValidator",{enumerable:!0,get:function(){return e.createTextLengthValidator}}),Object.defineProperty(n,"createFormulaValidator",{enumerable:!0,get:function(){return e.createFormulaValidator}}),Object.defineProperty(n,"createFormulaListValidator",{enumerable:!0,get:function(){return e.createFormulaListValidator}}),Object.defineProperty(n,"createListValidator",{enumerable:!0,get:function(){return e.createListValidator}}),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).DataValidation=t}();
;var GC;!function(){"use strict";var i,r,t;function e(t){var n,n,n=r[t];return void 0!==n||(n=r[t]={exports:{}},i[t].call(n.exports,n,n.exports,e)),n.exports}i={"./dist/plugins/fill/drag-fill.js":function(y,t,n){var i,c,k,h,t,n,s,x,M,R,v,n,T,j,r,l,b,u,I,S,O,A,g,e,o,f,t,d,C,a,D,F,p,B,W,$;function E(t){return t.rowCount}function N(t){return t.colCount}function V(t,n){return t.getRowCount(n)}function G(t,n){return t.getColumnCount(n)}function H(t,n,i,r){return t&&n&&n.containsRange(t)&&(!x(i)&&(1===i&&t.row===n.row&&E(t)===E(n)||0===i&&t.col===n.col&&N(t)===N(n))||!(x(r)||(2!==r&&3!==r||t.col!==n.col||N(t)!==N(n))&&(0!==r&&1!==r||t.row!==n.row||E(t)!==E(n))))}function w(t,n){var i,r,e,o,u,s,f,a,l,c,f,i=B.call(this)||this,r=i,e=n[A],o=0===e,u=o||1===e,s=n[S],f=n[I],a=f.row,l=f.col,c=E(f),f=N(f);return r.Mf=t,4===(r.Ftt=n)[O]?r.Ptt=new k.Commands.JI(t,{ranges:[n[S]]}):r.Gtt=u?v(a,o?s.col:l,c,f+N(s)):v(2===e?s.row:a,l,c+E(s),f),r.Utt=u?1:0,i}function m(t,n){var i,r,i=W.call(this)||this,r=i;return r.Mf=t,r.Htt=n,r.ztt=n[I],r.Vtt=n[S],r.Ytt=n[O],r.Ztt=n[A],i}function L(t,n,i,r,e,o){var u,r,e,n,u=t.getSelections();t.IA(),t.n4(n,i,r,e,!0),r=t.getSelections(),e=0<n?n:t.N9(),n=0<i?i:t.k9(),t.O6(e,n,t.R9,t.B9),t.jA(u),t.parent&&o.Z3&&t.parent.changeSelectionInCommandExecuting(o,null,null,r)}function z(t){var n,i,n,i=t.parent.getActiveSheet();i&&t!==i&&i.repaint()}function _(t,n){return $.call(this,t,n)||this}i=this&&this.__extends||(p=function(t,n){return(p=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}p(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(t,"__esModule",{value:!0}),c=n("Common"),k=n("Core"),h=n("./dist/plugins/fill/fill.js"),t=n("./dist/plugins/fill/fill.ns.js"),n=n("CalcEngine"),s=!!n,x=c.Common.lt.ht,M=null,R=void 0,v=k.Ec,n=k.GC$,T=Math.max,j=Math.floor,r=k.Commands.ActionBase,l=k.Commands.CI,b=k.Commands.SI,u=k.CopyToOptions.all,I="startRange",S="fillRange",O="autoFillType",A="fillDirection",g="cancel",e="fill",o="dragDrop",f=n.isEmptyObject,t=new c.Common.ResourceManager(t.SR,"Fill"),d=t.getResource.bind(t),n.extend(k.Worksheet.prototype,C={fillAuto:function(t,n,i){if(!n)throw new Error(d().Exp_RangeIsNull);var r=this,e=i.fillType,o=i.series,u=i.direction,s=i.step,f=i.stop,a=new h.Wtt(r),l=i.Qtt;if(H(t,n,u?M:o,u)){r.suspendPaint(),t&&(r.rt.Ktt=t);try{4===e?a.Jtt(n,o,!1,i.withTag,i.withoutStyle,l):0===e?a.Xtt(n,u):1===e||2===e?a.qtt(1===e,n,o,s,f):3===e&&a.$tt(n,o,3,s,x(f)?M:c.Common.ct.o0(f),i.unit)}finally{r.resumePaint()}}}}),k.Worksheet.ch(e,{init:function(){this.tnt=new h.nnt(this)},setHost:function(t){var t;t&&((t=this.Qy())[e]||t.register(e,k.Commands[e]),t[o]||t.register(o,k.Commands[o]))},dispose:function(t){var t;!1!==t.clearCache&&(t=this).tnt&&(t.tnt.L0(),t.tnt=M)}}),k.Workbook.ch(e,{onCultureChanged:function(){d()}}),i(w,B=r),w.prototype.canExecute=function(){var t=this,n=t.Mf,t=t.Ftt,i=t[I],r=t[S];return!(!n.PT(r.row,r.col,E(r),N(r),{isIgnoreFilterOutRow:!0,sheetArea:k.SheetArea.viewport})||4!==t[O]&&r.intersect(i.row,i.col,E(i),N(i)))},w.prototype.execute=function(){var t,n,i,r,e,o,o,t=this;if(t.canExecute()){i=(n=t.Ftt)[S],e=(r=t.Mf).parent.i4(),k.Commands.II(e),t.X5(r,!0);try{s&&r.suspendCalcService(),o=r.getSelections(),r.isDirtySuspended()||(t.ent=new l(r,n[S],u)),4===n[O]?t.int(r):t.rnt(r),r.EA(o,r.getSelections())&&r.jA(o)}finally{t.q5(r,!0),s&&r.resumeCalcService(!1),k.Commands.xI(e,n),r.Q1i&&r.Q1i(i.row,i.col,E(i),N(i)),o=[],r.isDirtySuspended()||(t.ont=new l(r,i,u),t.ont.yI(t.ent.bI()),o=t.ont.MI()),b(r,i.row,i.col,E(i),N(i),o,1)}}},w.prototype.int=function(t){var n,i,r,i,n,e,o,e,o,n,n=this;n.Ptt.execute(t),r=(i=n.Ftt)[I],i=i[S],n=0===n.Utt,o=E(r),e=N(r),o=n?T(1,o-E(i)):o,n=n?e:T(1,e-N(i)),r.equals(i)||(e=v(r.row,r.col,o,n),t.O6(T(t.N9(),e.row),T(t.k9(),e.col),t.R9,t.B9),t.IA(),t.n4(e.row,e.col,E(e),N(e)))},w.prototype.rnt=function(t){var n,i,r,e,o,u,s,f,a,l,c,h,v,g,d,p,w,m,_,y,C,D,r,F,b,n=this,i=n.Mf,r=n.Ftt,e=r[I],o=r[S],u=r[O],s=n.Gtt,l={fillType:4,series:n.Utt,withTag:!0,withoutStyle:!(i.lF&k.CopyToOptions.style)},c=i.tables,h=!1,v=new k.Range(s.row,s.col,s.rowCount,s.colCount);if(c)try{p=0===(g=r[A]),(d=2===g)&&(w=e.rowCount,m=0===c.AB(e.row,e.col,w,e.colCount).length)&&(h=!0,v.rowCount-=w),p&&(_=e.colCount,m=0===c.AB(e.row,e.col,e.rowCount,_).length)&&(h=!0,v.colCount-=_),y=[],C=[],c.yx(M,v,R,R,R,y,{applyDragFillAfterTableExpand:h,backupTableResizedArgs:C}),0<y.length&&(l.Qtt=y),n.lCe=C}catch(t){return i.jT(6,t.message),void i.resumePaint()}if(1===u){if(i.fillAuto(e,s,l),i.lF&k.CopyToOptions.style&&i.Ut.eE(e.row,e.col,e.rowCount,e.colCount))for(f=0;f<o.rowCount;f++)for(a=0;a<o.colCount;a++)(D=i.vI(e.row+j(f%e.rowCount),e.col+j(a%e.colCount)))&&D.clone&&(D=D.clone()),i.CL(o.row+f,o.col+a,D)}else 0===u?(r=i.lF&~k.CopyToOptions.comment,n.ant(e,o,r)):2===u?n.ant(e,o,4320):3===u&&((F=!(1!==E(e)||1!==N(e)||-1===e.row&&-1!==e.col||-1===e.col&&-1!==e.row))?n.ant(e,o,b=4251):(l.withoutStyle=!0,i.fillAuto(e,s,l)));i.O6(T(t.N9(),s.row),T(t.k9(),s.col),t.R9,t.B9),t.IA&&t.IA(),i.n4(s.row,s.col,E(s),N(s))},w.prototype.ant=function(t,n,i){var r=this,e=r.Mf,t=e.JS(t),n=e.JS(n),o=t.row,u=t.col,s=E(t),f=N(t),a=n.row,l=n.col,c=E(n),h=N(n),t=r.Ftt[A],v=3===t,g=1===t,d=j(c/s),n=c%s,p=j(h/f),t=h%f,w,m,_,y,C;if(e.HB=!0,0===r.Utt){for(w=0;w<d;w++)e.vT(o,u,y=v?a+w*s:a+c-(w+1)*s,l,s,f,i,!0,!0);0!=n&&e.vT(m=v?o:o+(d+1)*s-c,u,y=v?a+s*d:a+c-d*s-n,l,n,f,i,!0,!0)}else{for(w=0;w<p;w++)e.vT(o,u,a,C=g?l+w*f:l+h-(w+1)*f,s,f,i,!0,!0);0!=t&&e.vT(o,_=g?u:u+(p+1)*f-h,a,C=g?l+f*p:l+h-p*f-t,s,t,i,!0,!0)}delete e.HB,e.recalcRange(a,l,c,h)},w.prototype.undo=function(){var t,n,i,r,e,o,u,t=this,n=t.Mf,i=!1;if(t.canUndo()){t.X5(n,!0);try{s&&n.suspendCalcService(),r=n.getSelections(),e=t.Ftt,o=n.R_,u=e[S],i=4===e[O]?t.unt(n):t.snt(n),!n.cnt&&o&&o.close(),b(n,u.row,u.col,E(u),N(u),t.ont?t.ont.MI():[],1,R,!0),n.EA(r,n.getSelections())&&n.jA(r)}finally{t.q5(n,!0),s&&n.resumeCalcService(!1)}}return i},w.prototype.unt=function(t){var n,i,r,i,e,n=this,i=n.Ftt[I],r=i.row,i=i.col,e=k.Commands.TI(t.name());return t.Ut.undo(n.Ftt[e]),t.O6(T(t.N9(),r),T(t.k9(),i),t.R9,t.B9),!0},w.prototype.snt=function(t){var n,i,r,e,r,o,n,i=this.Ftt,r=i[I],e=r.row,r=r.col;s&&t.suspendCalcService();try{o=k.Commands.TI(t.name()),t.Ut.undo(i[o]),t.O6(T(t.N9(),e),T(t.k9(),r),t.R9,t.B9)}finally{s&&t.resumeCalcService(!1)}return t.invalidateLayout(),!0},a=w,i(m,W=r),m.prototype.execute=function(){var t,n,i,r,e,o,u,s,f,a,l,t=this,n=!1;if(t.canExecute()){r=(i=t.Mf).parent,e=t.Vtt,o=t.Htt,u=i.parent.i4(),k.Commands.II(u),t.XI(),t.X5(i,!0),i.QI=!0;try{s=i.getSelections(),f=void 0,a=i.rt,(l={sheet:i,sheetName:i.name(),cancel:!1})[S]=e,l[O]=t.Ytt,l[A]=t.Ztt,i.ki(k.Events.DragFillBlock,l),a.fnt=l[O],a.lnt=l[g],l[g]||(t.hnt(l),i.ki(k.Events.DragFillBlockCompleted,l)),n=!0,f=i.getSelections(),i.EA(s,f)&&i.jA(s),r&&o.Z3&&r.changeSelectionInCommandExecuting(o,null,null,f)}finally{t.q5(i,!0),i.QI=!1,t.dnt(i,e),k.Commands.xI(u,t.Htt)}}return n},m.prototype.hnt=function(t){var n,i,r,e,o,r,e,n=this,i=n.Mf,r=i.rt,e=n.Vtt,o=n.Ytt;r.fnt=o,r.lnt||((r={})[I]=n.ztt,r[S]=e,r[O]=5===t[O]?o:t[O],r[A]=n.Ztt,e=new a(i,r),i.suspendEvent(),e.execute(),i.resumeEvent(),n.Htt.vnt=e)},m.prototype.XI=function(){var t=this;t.Mf.isDirtySuspended()||(t.ent=new l(t.Mf,t.Vtt,u))},m.prototype.undo=function(){var t,n,i,r,e,o,u,s,f,n=this;if(n.canUndo()){i=n.Mf,r=n.Vtt,e=i.parent,o=n.Htt,n.XI(),n.X5(i,!0);try{u=i.getSelections(),i.suspendEvent(),i.Nj=!0,s=(0,k.hCe)(i),k.Commands.NI(s,o),i.Nj=!1,i.resumeEvent(),f=o[I],i.EA(u,[f])&&i.jA(u),e&&o.Z3&&e.changeSelectionInCommandExecuting(o,null,null,[f]),(0,k.handleRestoredTableResizedArgs)(null==(t=o.vnt)?void 0:t.lCe)}finally{n.q5(i,!0),n.dnt(i,r,!0)}}return!0},m.prototype.dnt=function(t,n,i){var r,e,o,r=this,e=[];t.isDirtySuspended()||((o=new l(t,n,u)).yI(r.ent.bI()),e=o.MI()),b(t,n.row,n.col,E(n),N(n),e,1,R,i)},D=m,i(_,$=r),_.prototype.canExecute=function(){var t,n,i,r,e,o,u,s,f,a,l,c,h,a,v,g,d,p,a,t=this,n=t.Mf,i=t.tT,r=i.fromRow,e=i.fromColumn,o=E(i),u=i.columnCount,s=i.toRow,f=i.toColumn,a=!i.copy,l,c;if(n.tables&&n.tables.mx(n,{row:r,col:e,rowCount:o,colCount:u},n,{row:s,col:f,rowCount:o,colCount:u},a))return!1;if(!n.zT(r,e,o,u,V(n),G(n)))return!1;if(!i.insert&&!n.zT(s,f,o,u,V(n),G(n)))return!1;if(i.cmd===k.RangeChangedAction[0]&&n.tables&&(h=!1,0<(a=n.tables.AB(r,e,o,u)).length)){for(g=(v=a[0].range()).row;g<v.row+v.rowCount;g++)if(n.isRowFilterOut(g)){h=!0;break}return!(h&&v.contains(i.mouseTargetRow,i.mouseTargetCol,1,1))}return a=t.mnt(d=0<=s&&f<0&&0<=r&&e<0&&0<o&&u<0,p=s<0&&0<=f&&r<0&&0<=e&&o<0&&0<u),n.PT(s,f,o,u,{isAllowDragInsert:a,sheetArea:k.SheetArea.viewport})&&n.PT(r,e,o,u,{isAllowDragInsert:a,sheetArea:k.SheetArea.viewport})},_.prototype.mnt=function(t,n){var i,r,i,r,e,i,e,i,i=this,r=i.tT,i=i.Mf,r=r.insert,e=i.isActualProtected(),i=i.options.protectionOptions;return!(!e||f(i)||(e=i.allowDragInsertRows,i=i.allowDragInsertColumns,!r)||!(e&&t||i&&n))},_.prototype.execute=function(){var t,n,i,r,e,o,u,s,f,a,l,c,h,v,g,d,p,w,m,_,y,C,D,F,b,R,T,j,t=this,n=!1;if(t.canExecute()){i=t.Mf,r=t.tT,t.XI(),s=r.fromRow,f=r.fromColumn,a=r.toRow,l=r.toColumn,c=E(r),h=r.columnCount,v=r.option,g=c,d=h,p=(u=o=e=void 0,k.hCe)(i),(w=i.o5())&&(g+=i.lT(a,c,!0),d+=i.lT(l,h)),k.Commands.II(p),t.X5(i,!0),i.QI=!0,m=void 0;try{try{_=[],m={shiftCells:r.insert&&r.shiftCells===k.InsertShiftCell.down,isCopy:r.copy,isFirst:!0},i.tables&&i.tables.yx(i,new k.Range(a,l,g,d),new k.Range(s,f,c,h),M,M,M,{shiftInfo:m,backupTableResizedArgs:_}),r.Kh.lCe=_}catch(t){return i.jT(6,t.message),void i.resumePaint()}r.insert?0<=f&&s<0?(e=f,u=h,y=o=l,i.addColumns(o,u),r.copy?i.copyTo(-1,o<=e?e+u:e,-1,o,-1,u,v):(i.moveTo(-1,o<=e?e+u:e,-1,o,-1,u,v),i.deleteColumns(o<=e?e+u:e,u),e<o&&(y=o-u)),L(i,-1,y,V(i),u,r)):0<=s&&f<0?(e=s,u=c,C=o=a,i.addRows(o,u),r.copy?i.copyTo(o<=e?e+u:e,-1,o,-1,u,-1,v):(i.moveTo(o<=e?e+u:e,-1,o,-1,u,-1,v),i.deleteRows(o<=e?e+u:e,u),e<o&&(C=o-u)),L(i,C,-1,u,G(i),r)):0<=s&&0<=f&&(D=r.shiftCells,F=new k.Range(a,l,1,1),b=[new k.Range(s,f,c,h)],x(D)||(R={cmd:"clipboardPaste",sheetName:i.name(),clipboardHtml:"",clipboardImage:"",clipboardText:"",fromRanges:b,fromSheet:i,isCutting:!r.copy,pasteOption:0,pastedRanges:[new k.Range(a,l,c,h)],cA:F,fA:b,sA:D,bx:!0,px:m&&m.ignoreFooterShiftIndex},i.Qy().execute(R),T=i.getSelections()[0],D===k.InsertShiftCell.down&&s<a&&!r.copy&&f===l?i.setSelection(T.row-c,T.col,T.rowCount,T.colCount):D===k.InsertShiftCell.right&&f<l&&!r.copy&&s===a&&i.setSelection(T.row,T.col-h,T.rowCount,T.colCount))):(r.copy?i.copyTo(s,f,a,l,c,h,v):i.moveTo(s,f,a,l,c,h,v),i&&(L(i,a,l,g,d,r),j=r.Kh,r.copy||i.isDirtySuspended()||(j.wx=t.gnt(i,j.qI,s,f,c,h)),i.isDirtySuspended()||(j.Mx=t.gnt(i,j.$I,a,l,c,h)))),n=!0}finally{i.rt.q6={},t.q5(i,!0),i.QI=!1,k.Commands.xI(p,r)}z(i)}return n},_.prototype.gnt=function(t,n,i,r,e,o){var u,s,u=new l(t,v(i,r,e,o),this.tT.option),s=t.tables&&t.tables.WI&&t.tables.WI(i,r,e,o);return s&&0<s.length&&(this.tT.tableNamesObj={r:i,c:r,rc:e,cc:o,tableNames:s}),u.yI(n.bI()),b(t,i,r,e,o,u.MI(),0,s),u},_.prototype.XI=function(){var t,n,t,i,r,e,o,u,s,f,a,o,u,r,e,t=this,n=t.Mf,t=t.tT,i=t.Kh;i=i||(t.Kh={}),r=t.fromRow,e=t.fromColumn,o=t.toRow,u=t.toColumn,s=t.option,f=r<0?0:r,a=e<0?0:e,o=o<0?0:o,u=u<0?0:u,r=r<0?V(n):E(t),e=e<0?G(n):t.columnCount,t.insert||n.isDirtySuspended()||(t.copy||(i.qI=new l(n,v(f,a,r,e),s)),i.$I=new l(n,v(o,u,r,e),s)),i.pnt=n.R9,i.bnt=n.B9,i.ynt=n.ui,i.wnt=n.ci},_.prototype.undo=function(){var t,n,i,r,e,o,u,s,f,a,l,c,h,v,g,d,p,w,m,_,y,C,D,F,t=this;if(t.canUndo()){if(n=t.Mf,r=(i=t.tT).fromRow,e=i.fromColumn,o=i.toRow,u=i.toColumn,s=E(i),f=i.columnCount,!n.zT(r,e,s,f,V(n),G(n)))return!1;if(!i.insert&&!n.zT(o,u,s,f,V(n),G(n)))return!1;l=i.Kh,t.X5(n,!(a=void 0)),c=(0,k.hCe)(n),k.Commands.NI(c,i);try{i.insert?0<=e&&0<=r||(0<=e?(a=f,n&&L(n,-1,e,V(n),a,i)):0<=r&&(a=s,n)&&L(n,r,-1,a,G(n),i)):(g=r<0?0:r,d=e<0?0:e,p=o<0?0:o,w=u<0?0:u,m=r<0?V(n):s,_=e<0?G(n):f,n&&(L(n,r,e,s,f,i),y=i.tableNamesObj,C=[],D=[],y&&(y.r===p&&y.c===w&&y.rc===m&&y.cc===_?D=y.tableNames:C=y.tableNames),b(n,p,w,m,_,l.Mx?l.Mx.MI():[],0,C,!0),b(n,g,d,m,_,l.wx?l.wx.MI():[],0,D,!0))),n&&(-1!==l.ynt&&-1!==l.wnt&&((F=n.getSelections()[0]).contains(l.ynt,l.wnt)?n.XA(l.ynt,l.wnt):n.XA(F.row,F.col)),-2!==l.pnt&&-2!==l.bnt&&-1!==l.ynt&&-1!==l.wnt&&n.showCell(l.ynt,l.wnt,3,3),(0,k.handleRestoredTableResizedArgs)(l.lCe))}finally{t.q5(n,!0)}z(n)}return!0},F=_,k.Commands[e]={canUndo:!0,execute:function(t,n,i){return k.Commands.zA(t,D,n,i)}},k.Commands[o]={canUndo:!0,execute:function(t,n,i){return k.Commands.zA(t,F,n,i)}}},"./dist/plugins/fill/fill-event.js":function(e,t,n){var p,D,d,r,w,t,m,_,v,y,a,C,F,b,g,R,i,o,l,c,h,T,n,j;function k(t){return t.rowViewportIndex}function x(t){return t.colViewportIndex}function u(t){return t.frozenRowCount()}function f(t){return t.frozenColumnCount()}function s(t){return t.hitTestType}function M(t,n){return t.getRowCount(n)}function I(t,n){return t.getColumnCount(n)}function S(t){return t.colCount}function O(t){return t.rowCount}function A(t){return t.height}function E(t){return t.width}function N(t){var n,t,n=7,t=t.parent;return n=t?2007<t.SC?2:7:n}function V(t,n,i,r,e,o,u){var s,f,a;t.save(),o=o||h,u=u||2,n===r?(t.rect(n-2,i,7,g(e-i)),t.clip(),t.beginPath(),i<e?(i-=3,e+=3):(i+=3,e-=3),s=(0,D.Zx)(n-1,i-1,r-1,e+1,o,u),f=(0,D.Zx)(n,i,r,e,o,u),a=(0,D.Zx)(n+1,i-1,r+1,e+1,o,u)):i===e&&(t.rect(n,i-2,g(r-n),7),t.clip(),t.beginPath(),n<r?(n-=3,r+=3):(n+=3,r-=3),s=(0,D.Zx)(n-1,i-1,r+1,e-1,o,u),f=(0,D.Zx)(n,i,r,e,o,u),a=(0,D.Zx)(n-1,i+1,r+1,e+1,o,u)),s&&s.qx(t),f&&f.qx(t),a&&a.qx(t),t.strokeStyle=o,t.stroke(),t.beginPath(),t.restore()}function G(t,n,i,r,e,o,u,s,f,a,l){var c=n?D.Events.DragDropBlock:D.Events.DragDropBlockCompleted,i={sheet:t,sheetName:t.name(),fromRow:i,fromCol:r,toRow:e,toCol:o,rowCount:u,colCount:s,copy:f,insert:a,copyOption:l};return n&&(i.cancel=!1),t.ki(c,i),i}function L(t,n,i,r,e){for(var o,u,s,o=0;o<i.rowCount;o++){for(u=0;u<i.colCount;u++){if(!(s=t.getSpan(i.row+o,i.col+u))||s.rowCount!==n.rowCount||s.colCount!==n.colCount)return!1;r&&(u+=n.colCount)}e&&(o+=n.rowCount)}return!0}function B(t,n,i){var r,e,o,u,s,f,a,l,e,u,r,r=n.row,e=n.rowCount,o=n.col,u=n.colCount,s=i.row,f=i.rowCount,a=i.col,l=i.colCount,e=r===s&&e===f,u=o===a&&u===l;return(e||u)&&(r=t.getSpan(r,o))&&L(t,r,n,e,u)&&!t.Ut.GT(s,a,f,l)&&L(t,r,i,e,u)}Object.defineProperty(t,"__esModule",{value:!0}),p=n("Common"),D=n("Core"),d=n("SheetsCalc"),r=n("./dist/plugins/fill/fill-ui.js"),w=n("./dist/plugins/fill/fill.js"),t=n("./dist/plugins/fill/fill.ns.js"),m=n("CalcEngine"),_=!!m,v=D.GC$,y=D.Ec,a=p.Common.lt.ht,C=null,F=void 0,b=Math.min,g=Math.abs,R=Math.max,i=5,o=3,l="drag",c="corner",h="black",T=p.Common.zf,n=new p.Common.ResourceManager(t.SR,"Fill"),j=n.getResource.bind(n),v.extend(D.nk.prototype,{bk:function(t){var n,i,r,e,e,o,u,u,o,e,u,i,n=this;n.zk||(i=n.Mf,r=C,1===(e=i.Ut.getSelections()).length?r=e[0]:e.length<1&&(r=i.Ut.getSpan(i.ui,i.ci)),r&&(n.zk=!0,n.rb=!0,n.Mnt=r,(e=i.tables&&i.tables.find(r.row,r.col))&&(o=n.Cnt=!0,u=e.range(),o=!(e.showHeader()&&r.row===u.row||e.showFooter()&&r.row===u.row+u.rowCount-1||r.col!==u.col||r.colCount!==u.colCount)&&o)&&(n.Snt=!0,n.e_=!0,n.Tnt=e.name()),u=i.getRangeRect(k(t),x(t),r),(o=n.q6).x=u.x,o.y=u.y,o.width=u.width-1,o.height=u.height-1,o.row=r.row,o.col=r.col,o.rowCount=O(r),o.colCount=S(r),e=i.JS(r),u=t.row,i=t.col,(u=u<e.row?e.row:u)>=e.row+O(e)&&(u=e.row+O(e)-1),(i=i<e.col?e.col:i)>=e.col+S(e)&&(i=e.col+S(e)-1),o.hitRow=u,o.hitCol=i,o.rowOffset=u-e.row,o.colOffset=i-e.col,n.Rk={e9:k(t),r9:x(t),Bk:s(t)},n.Ok()))},Vk:function(){var t,n,i,r,e,o,u,r,i,s,f,t=this;t.Rk&&t.rb&&t.zk&&t.Mnt&&(n=t.fk,i=t.q6,e=(r=t.Mf.getCellRect(i.hitRow,i.hitCol)).width/2,o=r.x+e,u=r.height/2,r=r.y+u,i.hitTarget={x:n.x,y:n.y},i=t.Q9(),s=t.K9(),f=!1,(g(o-n.x)>5+e||g(r-n.y)>5+u)&&(f=!0),0<=i&&0<=s&&f&&t.Ant(i,s),t.a9())},Ant:function(t,n){var i,r,e,o,u,s,f,a,l,c,h,c,u,l,a,c,u,t,n,o,i=this;i.zk&&i.Mnt&&(r=i.Mf,e=i.q6,o=r.o5(),u=r.U5(),s=M(r),f=I(r),a=b(f-S(e),n-e.colOffset),l=b(s-O(e),t-e.rowOffset),o&&(c=r.ox(n,e.colOffset+1),l-=h=r.ox(t,e.rowOffset+1,!0),0===r.getColumnWidth(a-=c)&&(a=r.r6(a)),0===r.getRowHeight(l))&&(l=r.nI(l)),-1===u.row&&-1!==u.col?(e.row=-1,e.col=R(0,a)):-1!==u.row&&-1===u.col?(e.row=R(0,l),e.col=-1):(e.row=e.row<0?-1:R(0,l),e.col=e.col<0?-1:R(0,a)),i.Snt&&(u=(c=r.tables&&r.tables.find(t,n))&&c.range(),!c||c.name()!==i.Tnt||t===u.row||c.showFooter()&&t===u.row+u.rowCount?i.e_=!1:i.e_=!0,i.e_?(e.col=u.col,i.i_=!i.isPressShiftKey):i.i_=i.isPressShiftKey),e.hitRow=t,e.hitCol=n,l=r.JS(e),o&&(a=r.lT(l.row,l.rowCount,!0),c=r.lT(l.col,l.colCount),l.rowCount+=a,l.colCount+=c,l.rowCount=b(s,l.rowCount),l.colCount=b(f,l.colCount),l.row+l.rowCount>s||l.col+l.colCount>f)||(u=i.Int)&&l.row===u.row&&l.col===u.col&&O(l)===O(u)&&S(l)===S(u)&&l.row>r.N9()&&l.col>r.k9()&&l.row+O(l)-1<r.P6()&&l.col+S(l)-1<r.G6()||(i.xnt=l,r.Dn.o_(),i.Int=l,(t=r.parent)&&t.options.showDragDropTip&&(n=e.x+e.width+5,o=e.y+e.height+5,t.Tw(T.j0(i.Nnt(l)),n,o))))},Nnt:function(t){var n,i,r,e,o,u,s,f,a,l,c,h,v,g;return t&&_?(r=O(i=(n=this.Mf).U5()),e=S(i),o=n.getActiveRowIndex(),u=n.getActiveColumnIndex(),s=void 0,f=n.o5(),o=o<0?0:o,u=u<0?0:u,s=1===r&&1===e?m.knt(C,C,t.row-o,t.col-u,!0,!0):(h=c=l=a=void 0,g=v=0,-1===i.row&&0<=i.col?(a=c=d.BAND_INDEX_CONST,l=t.col-u,h=t.col-u+e-1,g=e):-1===i.col&&0<=i.row?(l=h=d.BAND_INDEX_CONST,a=t.row-o,c=t.row-o+r-1,v=r):0<=i.row&&0<=i.col&&(a=t.row-o,c=t.row-o+r-1,l=t.col-u,h=t.col-u+e-1,v=r,g=e),f&&(c+=n.lT(t.row,v,!0),h+=n.lT(t.col,g)),m.lJ(C,C,a,l,c,h,!0,!0,!0,!0,o,u)),n.op().unparse(n.Uw(),s,o,u)):F},kD:function(t){var n,i,r,e,o,u,u,s,f,a,l,c,h,v,u,g,d,p,w,w,m,w,m,m,n=this,i=!1,r="",e=!1,o=n.Mf;n.Rk=C,n.l9(),u=o.U5(),s=n.q6.row,f=n.q6.col,a=n.q6.hitRow,l=n.q6.hitCol,n.i_&&u.contains(a,l)||(u=u&&(0<O(u)||0<S(u))?{r:u.row,c:u.col,rc:O(u),cc:S(u)}:{r:o.ui,c:o.ci,rc:1,cc:1},!0===n.zk&&!0===n.rb&&(c=u.r,h=u.c,v=u.rc,u=u.cc,g=o.options.protectionOptions,d=o.lF,p=void 0,n.shiftCells=null,n.i_&&(n.shiftCells=n.Dnt?D.InsertShiftCell.right:D.InsertShiftCell.down),w={fromRow:c,fromColumn:h,rowCount:v,columnCount:u,toRow:s,toColumn:f,isDragInsert:n.i_,isDragCopy:n.t_},o.ki(D.Events.BeforeDragDrop,w),(r=w.invalidMessage)&&0!==r.length||(!n.i_||-1!==c&&-1!==h?s===c&&f===h||(w=o.GT(c,h,v,u),m=o.GT(s,f,v,u),!w&&!m||(m=!1,m=!(w||n.shiftCells!==D.InsertShiftCell.right&&n.shiftCells!==D.InsertShiftCell.down)||m)||(i=!0,r=j().Exp_ChangeMergedCell),i||_&&(o.KT(c,h,v,u)||o.KT(s,f,v,u))&&(i=!0,r=j().Exp_ChangePartOfArray),!i&&o.isActualProtected()&&(!n.t_&&o.dA(y(c,h,v,u),!0,D.SheetArea.viewport)||o.dA(y(s,f,v,u),!0,D.SheetArea.viewport))&&(i=!0,r=o.FT()),i)||(n.i_&&(n.Dnt?f=n.q6.hitCol:s=n.q6.hitRow),(p=G(o,!0,c,h,s,f,v,u,n.t_,!1,d)).cancel)||(e=o.Qy().execute({cmd:"dragDrop",sheetName:o.name(),fromRow:c,fromColumn:h,toRow:s,toColumn:f,rowCount:v,columnCount:u,copy:n.t_,insert:n.i_,shiftCells:n.shiftCells,option:p.copyOption,mouseTargetRow:a,mouseTargetCol:l}),G(o,!1,c,h,s,f,v,u,n.t_,!1,p.copyOption)):0<=h?(n.t_&&(f<=h||h+u<=f)||!n.t_&&(f<h||h+u<f))&&((o.GT(-1,h,-1,u)||o.GT(-1,f,-1,0))&&(i=!0,r=j().Exp_ChangeMergedCell),w=g&&g.allowDragInsertColumns,!i&&o.isActualProtected()&&!0!==w&&(i=!0,r=j().Exp_ColumnReadOnly),i||(p=G(o,!0,-1,h,-1,f,-1,u,n.t_,!0,d)).cancel||(e=o.Qy().execute({cmd:"dragDrop",sheetName:o.name(),fromRow:-1,fromColumn:h,toRow:-1,toColumn:f,rowCount:-1,columnCount:u,copy:n.t_,insert:!0,option:p.copyOption,mouseTargetRow:a,mouseTargetCol:l}),G(o,!1,-1,h,-1,f,-1,u,n.t_,!0,p.copyOption))):0<=c&&h<0&&(n.t_&&(s<=c||c+v<=s)||!n.t_&&(s<c||c+v<s))&&((o.GT(c,-1,v,-1)||o.GT(s,-1,0,-1))&&(i=!0,r=j().Exp_ChangeMergedCell),i||_&&(o.KT(c,-1,v,-1)||o.KT(s,-1,0,-1))&&(i=!0,r=j().Exp_ChangePartOfArray),m=g&&g.allowDragInsertRows,!i&&o.isActualProtected()&&!0!==m&&(i=!0,r=j().Exp_RowReadOnly),i||(p=G(o,!0,c,-1,s,-1,v,-1,n.t_,!0,d)).cancel||(e=o.Qy().execute({cmd:"dragDrop",sheetName:o.name(),fromRow:c,fromColumn:-1,toRow:s,toColumn:-1,rowCount:v,columnCount:-1,copy:n.t_,insert:!0,option:p.copyOption,mouseTargetRow:a,mouseTargetCol:l}),G(o,!1,c,-1,s,-1,v,-1,n.t_,!0,p.copyOption)))))),n.rb=!1,n.zk=!1,n.Snt=!1,n.Cnt=!1,n.e_=!1,n.Tnt=C,n.Mnt=C,n.i_=!1,n.t_=!1,n.Int=C,n.xnt=C,n.iy(),e||(n.q6={},o.repaint()),i&&o.jT(3,r)},wk:function(t){var n=this;!0!==n.Yk&&!0!==n.rb&&(n._nt(),n.Ktt)&&(n.rb=!0,n.Yk=!0,n.hO=!0,n.Ent=t,n.jnt=x(t),n.Ont=k(t),n.Rnt=x(t),n.Bnt(),n.Rk={e9:k(t),r9:x(t),Bk:s(t)},n.Ok())},Bnt:function(){var t,n,i,r,n,t=this,n=u(t.Mf),i=f(t.Mf),r=t.Lnt();0<=r&&r<n?t.Fnt=0:n<=r&&r<=M(t.Mf)&&(t.Fnt=1),t.Pnt()?t.Gnt=1:t.Gnt=t.Ent,0<=(n=t.Unt())&&n<i?t.Hnt=0:i<=n&&n<=I(t.Mf)&&(t.Hnt=1),t.znt()?t.Vnt=1:t.Vnt=t.jnt},Zk:function(){var t,n,i,r,t=this;t.Rk&&t.Yk&&t.rb&&t.Ktt&&(t.Ont=t.nD(),t.Rnt=t.eD(),t.Ynt=t.Q9(),t.Znt=t.K9(),0<=t.Ynt&&0<=t.Znt&&(t.Wnt(),t.Qnt(),n=t.Mf.parent,i=!1,(r=t.Knt())&&(i=t.Jnt(t.Ktt,t.Xnt,!0)),n&&n.options.showDragFillTip&&i&&t.qnt(),t.$nt()),t.a9())},tet:function(){var t,n,i,r,e,e,o,u,s,s,f,u,a,l,c,h,v,h,v,g,d,t=this,n=t.Mf,i=t.Ktt,r=t.Xnt,e=n.parent.options.defaultDragFillType,e=t.net(3===e?5:e,3===e),o=t.eet(),u=t.Knt();return 1===e?(s=0===o||1===o?1:0,u=(f=new w.Wtt(n)).Jtt(u,s,!0),s=t.iet(o,r,i),l=(a=n.getActualStyle(s.row,s.col)).cellType||n.$f(),c=a.formatter||a._autoFormatter,h=p.Formatter&&p.Formatter.GeneralFormatter,u instanceof Date&&h&&(c=new h(p.Common.CultureManager.Fe().DateTimeFormat.shortDatePattern+" hh:mm:ss AM/PM;@","0")),h=3,(v=t.Rk)&&(h=v.Bk),v={sheet:n,row:s.row,col:s.col,sheetArea:h,quotePrefix:a.quotePrefix},l.format(u,c,g={},v)):0!==e||(s=t.iet(o,r,i),d=n.getFormula(s.row,s.col))?C:n.getText(s.row,s.col)},iet:function(t,n,i){var r,e,o,i,u,s,r=i.row,e=i.col,o=O(i),i=S(i),u=y(r,e,1,1);return 3===t?(s=O(n)%o,u.row=s=0===s?r+o-1:r+s-1,u.col=e):1===t?(s=0===(s=S(n)%i)?e+i-1:e+s-1,u.row=r,u.col=s):0===t?(s=0===(s=S(n)%i)?e:e+i-s,u.row=r,u.col=s):2===t&&(s=O(n)%o,u.row=s=0===s?r:r+o-s,u.col=e),u},qnt:function(){var t,n,i,r,e,o,u,o,n,t=this,n=t.Mf,i;if(4===t.net()||t.znt()||t.Pnt())return t.iy(),C;u=t.eet(),o=t.Knt(),n=n.j1(o),o=t.tet(),3===u||1===u?(r=n.x+n.width+3,e=n.y+n.height+3):0===u?(r=n.x+3,e=n.y+n.height+3):2===u&&(r=n.x+n.width+3,e=n.y+3),t.Tw(o,r,e)},$nt:function(){var t=this;t.ret(),t.oet(),t.aet(),t.uet=t.Knt()},ret:function(){var t,n,t=this.Mf;this.uet&&((n=t.j1(this.uet)).x-=2,n.y-=2,n.width+=4,n.height+=4,t.Dn.O1(n))},oet:function(t){var n;this.Mf.Dn.E1(this.Ktt,C,t)},aet:function(){var t,n,i,r,i,e,t,t=this.Mf,n=t.Dn,i=this.Knt();i&&(r=n.J(),i=t.j1(i),e=t.getSelectionBorderColor(),t=N(t),r.save(),r.beginPath(),n.cet(r,i,e,t),r.restore())},Qnt:function(){this.Xnt=this.dO()},znt:function(){return-1===this.Ktt.col&&-1!==this.Ktt.row},Pnt:function(){return-1===this.Ktt.row&&-1!==this.Ktt.col},lO:function(){return 4===this.bO||5===this.bO},dO:function(){var t,n,i,r,e,t=this,n=-1,i=-1,r=-1,e=-1;switch(t.bO){case 0:r=t.Pnt()?n=-1:(n=t.Lnt(),O(t.Ktt)),i=t.Znt,e=t.Unt()-i;break;case 1:r=t.Pnt()?n=-1:(n=t.Lnt(),O(t.Ktt)),i=t.fet()+1,e=t.Znt-i+1;break;case 2:n=t.Ynt,r=t.Lnt()-n,e=t.znt()?i=-1:(i=t.Unt(),S(t.Ktt));break;case 3:n=t.let()+1,r=t.Ynt-n+1,e=t.znt()?i=-1:(i=t.Unt(),S(t.Ktt));break;case 5:n=t.Ynt,r=t.let()-n+1,e=t.znt()?i=-1:(i=t.Unt(),S(t.Ktt));break;case 4:r=t.Pnt()?n=-1:(n=t.Ktt.row,O(t.Ktt)),i=t.Znt,e=t.fet()-i+1}return y(n,i,r,e)},het:function(){var t=this.let();return-1!==t?this.Mf._y(this.Gnt).findRow(t):C},det:function(){return this.Mf._y(this.Ont).findRow(this.vet())},vet:function(){return this.Mf.getViewportBottomRow(this.Ont)},met:function(){var t=this.fet();return-1!==t?this.Mf.Yy(this.Vnt).findCol(t):C},pet:function(){return this.Mf.Yy(this.Rnt).findCol(this.bet())},bet:function(){return this.Mf.getViewportRightColumn(this.Rnt)},Wnt:function(){var t,n,i,r,e,o,u,s,e,r,f,a,l,c,o,u,c,l,o,u,f,a,l,o,u,f,l,u,a,h,t=this,n=t.znt(),i=t.Pnt(),r=v(t.Mf.Dg()).offset(),e=t.fk.e,o=t.fk.x,u=t.fk.y,s=e.pageX-r.left,e=e.pageY-r.top,r=!1;n||i?i?t.Znt>=t.Unt()&&t.Znt<=t.fet()?t.bO=4:t.Znt<t.Unt()?t.bO=0:t.Znt>t.fet()&&(t.bO=1):n&&(t.Ynt>=t.Lnt()&&t.Ynt<=t.let()?t.bO=5:t.Ynt<t.Lnt()?t.bO=2:t.Ynt>t.let()&&(t.bO=3)):t.Ynt>=t.Lnt()&&t.Ynt<=t.let()?t.Znt>=t.Unt()&&t.Znt<=t.fet()?(f=g(t.Znt-t.fet()))<(a=g(t.Ynt-t.let()))?t.bO=5:a<f?t.bO=4:u>(l=(l=t.het())||t.det()).y+l.height?t.bO=3:(o=(c=(c=t.met())||t.pet()).x+c.width-o,u=l.y+l.height-u,s>=c.x&&s<=c.x+c.width&&e>=l.y&&e<=l.y+l.height?t.bO=u<=o?4:5:r=!0):t.Znt<t.Unt()?t.bO=0:t.Znt>t.fet()&&(t.bO=1):t.Ynt<t.Lnt()?t.Znt>=t.Unt()&&t.Znt<=t.fet()?t.bO=2:t.Znt<t.Unt()?(f=g(t.Znt-t.Unt()),a=g(t.Ynt-t.Lnt()),t.bO=f<=a?2:0):t.Znt>t.fet()&&(f=g(t.Znt-t.fet()),a=g(t.Ynt-t.Lnt()),t.bO=f<=a?2:1):t.Ynt>t.let()&&(t.Znt>=t.Unt()&&t.Znt<=t.fet()?t.bO=3:t.Znt<t.Unt()?(f=g(t.Znt-t.Unt()),a=g(t.Ynt-t.let()),t.bO=f<=a?3:0):t.Znt>t.fet()&&(f=g(t.Znt-t.fet()),a=g(t.Ynt-t.let()),t.bO=f<=a?3:1)),(c=t.Mf.Dn.yet)&&(u=(l=t.let())+1,f=(o=t.fet())+1,a=t.Mf.getRowHeight(l,3),l=t.Mf.getColumnWidth(o,3),o=t.Mf.getRowHeight(u,3),u=t.Mf.getColumnWidth(f,3),f=c.x+c.width/2-b(10,l/2),l=c.x+c.width/2+b(10,u/2),u=c.y+c.height/2-b(10,a/2),a=c.y+c.height/2+b(10,o/2),h=!1,(h=n||i?i?f<=s&&s<=l:u<=e&&e<=a:f<=s&&s<=l&&u<=e&&e<=a)||r?(t.hO=!0,t.bO=4):t.hO=!1)},Lnt:function(){return this.Ktt?-1===this.Ktt.row?0:this.Ktt.row:-1},let:function(){var t=this;return t.Ktt?-1===t.Ktt.row?M(t.Mf)-1:t.Ktt.row+O(t.Ktt)-1:-1},Unt:function(){return this.Ktt?-1===this.Ktt.col?0:this.Ktt.col:-1},fet:function(){var t=this;return t.Ktt?-1===t.Ktt.col?I(t.Mf)-1:t.Ktt.col+S(t.Ktt)-1:-1},wet:function(t,n){var n,i,r,e,e,r,e,t,n=y(n.row,n.col,n.rowCount,n.colCount),i=this.Mf;return i.Ut.findSpan(t.row,t.col)&&(r=t.rowCount,e=n.rowCount,0!==Math.floor(e%r)&&(e=Math.ceil(e/r)*r,n.row+e<=i.getRowCount())&&(n.rowCount=e),r=t.colCount,e=n.colCount,0!==Math.floor(e%r))&&(t=Math.ceil(e/r)*r,n.col+t<=i.getColumnCount())&&(n.colCount=t),n},DD:function(){var t,n,i,r,e,o,u,s,t=this,n=t.Mf;t.Rk=C,t.l9(),t.iy(),t.Yk&&t.rb?(t.Yk=!1,t.rb=!1,(i=t.Knt())&&(!(r=t.Jnt(t.Ktt,t.Xnt))||t.hO?(t.Met(),t.Ax(i)):(e=n.rt.Ktt,o=t.wet(e,t.Xnt),u=t.net(),n.Qy().execute({cmd:"fill",sheetName:n.name(),startRange:e,fillRange:o,autoFillType:u,fillDirection:n.rt.eet()}),!(s=t.lnt)&&t.Cet()&&n.parent.options.showDragFillSmartTag&&4!==t.fnt?t.Tet(t.fnt):t.Ax(i),t.Met()))):t.Met()},Tet:function(t){var n,i,i,n=this.Mf,i=n.Dn.yet,i={x:i.x+i.width,y:i.y+i.height,fillType:t};n.R_=new r.Aet(n.parent.j2(),n,i),n.R_.rQ()},_nt:function(){var t,n,n,i,t=this.Mf,n=t.Ut.getSelections();1===n.length?(n=n[0],(i=t.Ut.getSpans(n))&&0<i.length&&(n=t.kR(i,n)),this.Ktt=n):0<=t.ui&&0<=t.ci&&(this.Ktt=y(t.ui,t.ci,1,1))},Met:function(){this.rb=!1,this.Yk=!1},Ax:function(t){this.Mf.Dn.E1(t)},net:function(t,n){var i,r,t,e,i=this,r=i.Mf,t=t!==F?t:r.parent.options.defaultDragFillType;return i.lO()?4:5!==t?t:(e=1===O(i.Ktt)&&1===S(i.Ktt)&&!i.Pnt()&&!i.znt())?i.a_&&!n?1:0:i.a_&&!n?0:1},Knt:function(){var t,n,i,r,e,t=this;return t.Ktt?t.lO()?t.Ktt:t.Xnt?(e=r=i=n=0,e=t.Iet()?(n=(2===t.bO?t.Xnt:t.Ktt).row,i=O(t.Ktt)+O(t.Xnt),r=t.Ktt.col,S(t.Ktt)):(n=t.Ktt.row,i=O(t.Ktt),r=(0===t.bO?t.Xnt:t.Ktt).col,S(t.Ktt)+S(t.Xnt)),y(n,r,i,e)):C:C},Jnt:function(t,n,i){var r,e,o,r=this.Mf,e=!0,o="";return r.Ut.eE(n.row,n.col,O(n),S(n))&&!B(r,t,n)&&(e=!1,o=j().Exp_FillRangeContainsMergedCell),e&&r.isActualProtected()&&r.dA(n,!0,D.SheetArea.viewport)&&(e=!1,o=r.FT()),e||i||r.ki(D.Events.InvalidOperation,{sheet:r,sheetName:r.name(),invalidType:D.InvalidOperationType.dragFill,message:o,fillRange:n}),e},Cet:function(){return this.xet()||this.Net()},xet:function(){return 3===this.bO||1===this.bO},Net:function(){return 0===this.bO||2===this.bO},Iet:function(){return 2===this.bO||3===this.bO||5===this.bO},eet:function(){var t=this.bO;return 0<=t&&t<=3?t:4===t?0:5===t?2:3},VL:function(t,n,i){var r,e,o,t,u,s,f,u,o,r=this,e=C,o=k(t),t=x(t),u=r.Mf,s=u.parent;if(!a(o)&&!a(t)&&(s.options.allowUserDragDrop||s.options.allowUserDragFill)&&(-1!==(f=u.U5()).row||-1!==f.col)){if(0<=o&&0<=t&&1===u.Ut.getSelections().length){if(r.yD(o,t,n,i))return e;(e=(u=u.getRangeRect(o,t,f)).x-4<n&&n<u.x+4&&u.y<=i&&i<u.y+u.height?{action:l,side:"left"}:e)||(o=r.Mf.Dn.yet)&&o.x<=n&&n<=o.x+o.width&&o.y<=i&&i<=o.y+o.height&&(e={action:l,side:c}),e||u.x+u.width-4<n&&n<u.x+u.width+4&&u.y<=i&&i<u.y+u.height&&(e={action:l,side:"right"}),e||u.y-4<i&&i<u.y+4&&u.x<=n&&n<u.x+u.width&&(e={action:l,side:"top"}),e||u.y+u.height-4<i&&i<u.y+u.height+4&&u.x<=n&&n<u.x+u.width&&(e={action:l,side:"bottom"}),e&&(n<u.x||n>u.x+u.width||i<u.y||i>u.y+u.height)&&(e.outside=!0)}s&&s.options.allowUserDragDrop||e&&e.side!==c&&(e.side=C),s&&s.options.allowUserDragFill||e&&e.side===c&&(e.side=C)}return e},ket:function(t,n){var i,r,e,i=this,r,e=i.Mf.getSpan(t,n,3);return e?!a(i.Mf.getValue(e.row,e.col,3,0)):!a(i.Mf.getValue(t,n,3,0))},Det:function(t,n){var i,r,e,e,i,r,e=this.Mf.tables;return!(!e||0===e.all().length)&&(e=e.AB(t,n,1,1)[0])&&e.footerIndex()===t},_et:function(t,n,i,r){for(var e,o,e=this,o=n;o<n+r;o++)if(!e.ket(t,o)||e.Det(t,o))return!1;return!0},Eet:function(t,n,i,r){for(var e,o,e=this,o=n;o<n+r;o++)if(e.ket(t,o))return!1;return!0},jet:function(t,n,i,r){var e,o,u,s,f,a,l,c,h,e=this,o=e.Mf;if("left"===r){for(u=0;u<n;u++)e.ket(t,u)&&(i.searchArray[u]=!0);for(s=n-1,f=1;i.searchArray[s];)s--,f++;i.searchLength=f}if("right"===r){for(a=o.getColumnCount(),l=n;l<a;l++)e.ket(t,l)&&(i.searchArray[l-n]=!0);for(c=0,h=1;i.searchArray[c];)c++,h++;i.searchLength=h}return i},Oet:function(t,n,i,r,e){for(var o,u,s,f,a,l,c,h,v,g,o=this,u=o.Mf,s=0,f={searchArray:new Array(r),searchLength:1},a={searchArray:new Array(u.getColumnCount()-e),searchLength:1},l=n;l<i;l++)f=o.jet(l,t.col,f,"left"),a=o.jet(l,t.col+t.colCount-1,a,"right");for(;o.Eet(i+s,t.col,1,t.colCount);){for(h=!(c=!0),f=o.jet(i+s,r,f,"left"),a=o.jet(i+s,e,a,"right"),v=r-1;v>=r-f.searchLength;v--)if(o.ket(i+s,v)){s++,c=!1;break}if(c){for(g=e+1;g<=e+a.searchLength;g++)if(o.ket(i+s,g)){s++,h=!0;break}if(!h)return s}}return s},Ret:function(t){for(var n,i,n=this,i=0;n._et(t.row+t.rowCount+i,t.col,1,t.colCount);)i++;return i},Bet:function(t){var n,i,r,e,o,n=this;return n._et(t.row+t.rowCount,t.col,1,t.colCount)?n.Ret(t):(e=t.row-2,o=t.row+t.rowCount,r=1===t.colCount?i=t.col:(i=t.col,t.col+t.colCount-1),n.Oet(t,e,o,i,r))},H_:function(){var t,n,i,r,r,e,o,t=this,n=t.Mf,i=n.rt.Ktt,r=t.Bet(i);0!==r&&(r=y(i.row+i.rowCount,i.col,r,i.colCount),t.bO=3,t.Xnt=r,e=t.net(),o=t.lnt,n.Qy().execute({cmd:"fill",sheetName:n.name(),startRange:i,fillRange:r,autoFillType:e,fillDirection:t.bO}),!o)&&n.parent.options.showDragFillSmartTag&&4!==t.fnt&&t.Tet(t.fnt)}}),v.extend(D.g7.prototype,{Let:function(t,n){var i,r,e,o,t,u,i,s,f,n,i=this.Mf,r=t.x,e=t.y,o=E(t),t=A(t),u=i.U5(),i=i.Fi(),s=4,f=-2.5;return 2007<n&&(s=5,f=-3),n=new D.Rect(-4,-4,s,s),-1===u.col?(n.x=i.b6,n.y=e+t+f):-1===u.row?(n.x=r+o+f,n.y=i.T6):(n.x=r+o+f,n.y=e+t+f),n},yO:function(t,n,i,r,e){var o,u,s,f,f,r,a,l,c,h,s,n,i,o=this,u=o.Mf,s=u.Fi(),f=u.parent,f=f&&f.SC,r=o.Let(r,f),a=r.x,l=r.y,c=E(r),h=A(r),s=s.c9(n,i);e&&!r.intersectRect(e)||r.intersectRect(s)&&(n=-1.5,(i=new D.Rect(a+(n=2007<f?-1:n),l+n,c+2,h+2)).x=R(i.x,s.x),i.y=R(i.y,s.y),o.O1(i),t.save(),e&&!e.containsRect(r)&&(t.rect(e.x,e.y,E(e),A(e)),t.clip()),t.beginPath(),t.fillStyle=D.Pf.vl(u,u.getSelectionBorderColor()),t.fillRect(a,l,c,h),o.yet=new D.Rect(r.x,r.y,4,4),t.beginPath(),t.restore())},cet:function(t,n,i,r){var e=n.x,o=n.y,u=e+E(n),n=o+A(n);V(t,e-2,o,u+1,o,i,r),V(t,e-1,n,u+1,n,i,r),V(t,e,o-1,e,n+1,i,r),V(t,u,o-1,u,n+1,i,r)},Fet:function(t,n){var i,r,e,o,u,s,f,a,l,c,h,v,g,d,p,c,w,m,_,y,_,u,_,l,a,C,i=this,r=i.Mf,e=r.rt,o=e.q6,u=o.hitTarget;o&&u&&(s=o.hitCol,f=o.hitRow,a=o.row,l=o.col,c=e.i_,h=r.Pet,g=r.getSelectionBorderColor(),d=N(r),p=8,t.save(),!0===c?(c=r.Yy(0).findCol(s)||r.Yy(1).findCol(s)||r.Yy(2).findCol(s),w=r._y(0).findRow(f)||r._y(1).findRow(f)||r._y(2).findRow(f),-1===o.row&&-1!==o.col?c&&(m=c.x,_=E(c),o.col=s,u.x>m+_/2&&(o.col<r.getLastFullyVisibleColumn()||o.col===r.G6())&&(m=c.x+E(c),o.col++),(h=h&&0===E(h)?h:e.q6)&&(v=new D.Rect(h.x-8,h.y-8,E(h)+16,A(h)+16),i.O1(v,n),i.E1(r.U5(),n)),r.Uet=new D.Rect(m,o.y,0,A(o)),t.rect(n.x,n.y,E(n),A(n)),t.clip(),t.beginPath(),V(t,m-8,o.y,m+8,o.y,g,d),V(t,m,o.y,m,o.y+A(o),g,d),V(t,m-8,o.y+A(o),m+8,o.y+A(o),g,d)):-1!==o.row&&-1===o.col?w&&(y=w.y,_=A(w),o.row=f,u.y>y+_/2&&(o.row<r.getLastFullyVisibleRow()||o.row===r.P6())&&(y=w.y+A(w),o.row++),(h=h&&0===A(h)?h:e.q6)&&(v=new D.Rect(h.x-8,h.y-8,E(h)+16,A(h)+16),i.O1(v,n),i.E1(r.U5(),n)),r.Uet=new D.Rect(o.x,y,E(o),0),t.rect(n.x,n.y,E(n),A(n)),t.clip(),t.beginPath(),V(t,o.x,y-8,o.x,y+8,g,d),V(t,o.x,y,o.x+E(o),y,g,d),V(t,o.x+E(o),y-8,o.x+E(o),y+8,g,d)):-1!==o.row&&-1!==o.col&&(u=r.Yy(0).findCol(l)||r.Yy(1).findCol(l)||r.Yy(2).findCol(l),_=r._y(0).findRow(a)||r._y(1).findRow(a)||r._y(2).findRow(a),w)&&c&&_&&u&&(m=u.x,y=_.y,h&&(v=new D.Rect(h.x-8,h.y-8,E(h)+16,A(h)+16),i.O1(v,n),i.E1(r.U5(),n)),l=!1,a=r.getCellRect(f,s),(l=!e.Cnt&&a?(C=o.hitTarget.x-a.x)<b(16,r.nn(s)/4):l)?m=c.x:y=w.y,r.Uet=new D.Rect(m,y,E(o),A(o)),r.U5().contains(f,s)||(t.rect(n.x,n.y,E(n),A(n)),t.clip(),t.beginPath(),l?(V(t,m-8,y,m+8,y,g,d),V(t,m,y,m,y+A(o),g,d),V(t,m-8,y+A(o),m+8,y+A(o),g,d),e.Dnt=!0):(V(t,m,y-8,m,y+8,g,d),V(t,m,y,m+E(o),y,g,d),V(t,m+E(o),y-8,m+E(o),y+8,g,d),e.Dnt=!1)))):(h&&(v=new D.Rect(h.x-8,h.y-8,E(h)+16,A(h)+16),i.O1(v,n),i.E1(r.U5(),n)),t.rect(n.x,n.y,E(n),A(n)),t.clip(),t.beginPath(),i.cet(t,o,g,d)),t.beginPath(),t.restore())},o_:function(){var t,n,i,r,i,e,o,u,s,f,a,l,c,s,a,t=this,n=t.Mf,i=n.sw,r=n.rt.xnt;i&&i.dragInfo&&r&&(i=t.J(),e=n.Fi(),o=n.rt.q6,u=n.j1(r),s=n.frozenTrailingColumnCount(),f=n.frozenTrailingRowCount(),a=n.getColumnCount()-s,l=n.getRowCount()-f,c=e.c9(1,1),0<s&&r.col+r.colCount<=a&&u.x+E(u)>c.x+E(c)&&u.intersectRect(c)&&(u=u.getIntersectRect(c)),0<f&&r.row+r.rowCount<=l&&u.y+A(u)>c.y+A(c)&&u.intersectRect(c)&&(u=u.getIntersectRect(c)),s=new D.Rect(e.b6,e.T6,e.Hy+e.zy,e.Ay+e.Iy),0<=E(u)&&0<=A(u)&&(o.x=u.x,o.y=u.y,o.width=E(u),o.height=A(u),t.Fet(i,s)),a=n.rt.i_,n.Pet=!0===a?n.Uet:new D.Rect(o.x,o.y,E(o),A(o)))}})},"./dist/plugins/fill/fill-ui.js":function(N,t,n){var i,V,u,n,s,f,r,a,l,e,o,c,h,v,g,d,p,w,m,_,y,C,G,L,D,F,b,R,T,j,k,x,B,e,M,W,$,H,I,S;function O(t,n,i,r,e,o){var t=t.Oi,u=t?"160px":"150px",t=t?"25px":"20px",u=s(f("div")).css([C,L,D,"padding",F],["block",u,t,0,0]).addClass("gc-smartMenu-item-default "+i+" ui-state-default"+l),t=s(f("div")).addClass(d).appendTo(u),i=s(f("div")).addClass("gc-menu-item-text").appendTo(u),n=s(f("input")).attr({id:n,value:e,type:"radio",name:"fill-group",style:"display:none"}).appendTo(t);return s(f("span")).text(r).appendTo(i),o?(t.addClass(g),n.prop("checked","checked")):n.prop("checked",""),u}function A(t,n){var t,i,t=I.call(this,t,r(n.parent.Ti))||this;return t.Mf=n,t.Het=s("."+w),(i=t.g$=t.Xc()).addClass(c),O(n,"smartMenuCopyCells",o,M().CopyCells,"0",!0).appendTo(i),O(n,"smartMenuFillSeries",o,M().FillSeries,"1").appendTo(i),n.NMi||(O(n,"smartMenuFillFormattingOnly",o,M().FillFormattingOnly,"2").appendTo(i),O(n,"smartMenuFillWithoutFormatting",o,M().FillWithoutFormatting,"3").appendTo(i)),t}function E(t,n,i){var t,n,t=S.call(this,t,r(n.parent.Ti))||this;return t.Mf=n,t.zet=i,n=t.Vet=t.Xc().addClass("gc-smart-tag-default "+w+" gc-no-user-select ui-widget-header"+l),t.Yet=s(f("div")).attr("class","fillSmartTag").css(m,_).appendTo(n),t.Zet=s(f("div")).attr("class","fillSmartTagDown").css([m,C],[_,"none"]).appendTo(n),t}i=this&&this.__extends||(H=function(t,n){return(H=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}H(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(t,"__esModule",{value:!0}),t.Aet=void 0,V=n("Common"),u=n("Core"),n=n("./dist/plugins/fill/fill.ns.js"),s=u.GC$,f=u.mt.En,r=u.mt.gi,a=s(document),l=" btn btn-default",o="gc-fill-type-item",c="gc-fill-menu-container",h=(e="ui-state-hover ")+"gc-smartMenu-item-hover",v=e+"gc-smart-tag-hover",g="ui-icon ui-icon-check gc-check-image",d="gc-menu-item-input",p="ui-state-active gc-smart-tag-active",w="gc-tag-container",m="float",_="left",y="top",C="display",G="width",L="min-width",D="height",F="margin",b="change",R="input[type=radio]",T="mouseover",j="mouseout",k="click",x="fillTypeChanged",B="keydown.ui-fill",e=new V.Common.ResourceManager(n.SR,"Fill"),M=e.getResource.bind(e),I=u.zc,i(A,I),A.prototype.$c=function(){I.prototype.$c.call(this)},A.prototype.aY=function(){var e,t,n,e=this,t;s("."+o).bind(T,function(){s(this).addClass(h)}).bind(j,function(){s(this).removeClass(h)}).bind(k,function(){var t,n,i,r,i,t=s(this),n=e.Het,i=t.find(R),r=i[0];r.checked=!0,i.trigger(b),n.trigger(k),n.trigger(j),t.removeClass(h),i=parseInt(s(r).attr("value"),10),e.Wet(i)}),(n=e.g$.find(R)).bind(b,function(){s("."+d).removeClass(g),s(this).parent().addClass(g)})},A.prototype.Qet=function(){s("."+o).unbind(T).unbind(j).unbind(k),this.g$.find(R).unbind(b)},A.prototype.Wet=function(t){var n=this,i=n.Mf,r=i.rt;if(n.Ket!==t){n.Ket=t,i.cnt=!0,i.suspendEvent();try{u.Commands.undo.execute(i.parent,{sheetName:i.name()})}finally{i.resumeEvent()}i.cnt=!1,i.Qy().execute({cmd:"fill",sheetName:i.name(),startRange:r.Ktt,fillRange:r.Xnt,autoFillType:t,fillDirection:r.bO}),n.Het.trigger(x,t)}},A.prototype.Jet=function(){return!!s("."+c).length},W=A,S=u.zc,i(E,S),E.prototype.Xet=function(t,n,i){var r=this,e=r.Mf.Oi,n=s(n),o=r.qet,r=r.Zet,u=e?"38px":"32px",e=e?"24px":"18px";o&&o.Jet()||(t?n.addClass(v):n.removeClass(v),n.css([G,D],[t?u:e,e]),i)||(t?r.show():r.hide())},E.prototype.$et=function(){var e=this,t=e.Vet,n=u.mt.pi(),o=u.mt.Tt.safari&&(n.ipad||n.iphone);t.bind(T,function(){e.Xet(!0,this,o)}).bind(j,function(){e.Xet(!1,this,o)}),t.bind(k,function(){var t,n,i,r,n,i,t=s(this),n=e.qet,i=e.Zet,r;n&&n.Jet()?(o&&i.hide(),t.removeClass(p),e.tit()):(o&&i.show(),t.addClass(p),e.nit(),(i=(n=e.g$)&&n.find(R)[e.zet.fillType])&&!i.checked&&(i.checked=!0,s(i).trigger(b)))}),a.bind(B,function(t){27===t.keyCode&&(e.qet&&e.qet.Jet()?e.tit():e.close(),u.mt.vi(t))})},E.prototype.rQ=function(){var t=this,n=t.Vet,i=t.zet,r=t.Mf.Oi,e=r?"3px":"0px",r=r?"24px":"18px";n&&(n.css([_,y],[i.x,i.y]),t.$c(),t.$et(),t.Yet.css(F,e),t.Zet.css(D,r),t.c5())},E.prototype.nit=function(){var t,n,n,i,r,r,e,o,u,t=this,n=t.Mf;t.qet||(t.qet=new W(n.parent.j2(),n),t.g$=t.qet.Xc()),i=(n=t.Vet).css(_),r=n.css(y),r=parseFloat(r),o=t.qet,u=t.zet,o.Ket=u.fillType,isNaN(r)||(e=r+n.height()+2),t.g$.css([_,y],[i,e]),o.$c(),o.aY(),o.Het.unbind(x).bind(x,function(t,n){u.fillType=n})},E.prototype.tit=function(){var t=this.qet;t&&(t.Qet(),t.close())},E.prototype.c5=function(){var t=this,n=t.qet,t=t.Vet;n&&(n.Jet()&&t.trigger(k),t.trigger(j))},E.prototype.close=function(){var t,n,t,t=this,n=t.Mf;t.c5(),a.unbind(B),S.prototype.close.call(this),(t=n.fg)&&(t.style.cursor="default"),n&&n.Zg()},E.prototype.lf=function(t){var n;return!(!this.Wc||!S.prototype.hf.call(this,this.Wc.get(0),t))||this.g$&&S.prototype.hf.call(this,this.g$.get(0),t)},t.Aet=E},"./dist/plugins/fill/fill.entry.js":function(t,n,i){var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),i("./dist/plugins/fill/drag-fill.js"),i("./dist/plugins/fill/fill-event.js"),e(i("./dist/plugins/fill/fill-ui.js"),n),e(i("./dist/plugins/fill/fill.js"),n),e(i("./dist/plugins/fill/fill.ns.js"),n)},"./dist/plugins/fill/fill.js":function(T,t,n){var i,e,h,r,j,n,M,o,tt,y,C,D,nt,I,u,S,k,u,O,A,it,rt,et,E,u,x,N,V,G,L,B,W,ot,$,H,u,n,z,P,q,n,U,J,K,Q,X,Y,Z,ft,at,lt,ct,ht,n,u,n,u,n,vt,gt,dt,pt,wt,mt,_t,yt,Ct,s,f,Dt,Ft;function ut(t){return!st(t)&&o.q8(t)}function st(t){return"string"==typeof t}function bt(t,n){return-1!==t.lastIndexOf(n)}function Rt(t){var n=[t];return n.rowCount=1,n.colCount=k(t),n}function Tt(t){return t}function jt(t,n,i,r){var n=Rt(n),i=Rt(i),r=Rt([r]),t=t?e.Common.eit(n,i,r,!0,Tt,tt,tt,tt):e.Common.iit(n,i,r,!0,tt,tt,tt),n=t&&t[0][0];return typeof n===it?e.Common.st.E8(n,13):n}function kt(t){return t.toLowerCase()}function a(t){this.rit=[],this.oit=[],this.ait=[],this.uit=tt,this.sit=[],this.cit=tt,this.lit=nt(t)?-1:t}function l(t){this.hit=-1,this.dit=[],this.MV=-1,this.Mf=t}function xt(){this.vit="",this.mit="",this.MV=0,this.git=1,this._padding=""}function c(t){var n,i,r,e,n=t.length,i=1;if(1<n)for(i=t[1]-t[0],e=2;e<n;e++)if(i!==(r=t[e]-t[e-1])){i=0;break}return i}function v(t,n){return 0<t?(t-1)%n:n-Math.abs(t)%n-1}function g(t){for(var n="",i=0;i<t;)n+="0",i++;return n}function d(t,n){return 12*(n.getFullYear()-t.getFullYear())+(n.getMonth()-t.getMonth())}function Mt(t){return t.every(function(t){var n;return 1===t.getDate()})}function It(t){return t.every(function(t){var n,i,r,e,n=t.getFullYear(),i=t.getMonth(),r,e;return t.getDate()===new Date(n,i+1,0).getDate()})}function St(t){var n,i,n=0,i;return t.every(function(t){var t=t.getDate();return(n=n||t)===t})?n:0}function Ot(t,n){for(var i,r,e,o,i=t.length,r=!0,o=2;o<i&&(r=n===(e=d(t[o-1],t[o])));o++);return r}function At(t){return t.every(function(t){var n=t.getHours(),i=t.getMinutes(),t=t.getSeconds();return 0!==n||0!==i||0!==t})}function Et(t,n){return new Date(t,n+1,0).getDate()}function p(t){return"0"===t[0]}function Nt(n,t,i){var r,e,o,e,o,u,s,u=i?1:2,s=i?2:1;return t.every(function(t){return!!(r=t.match(n.pit))&&(e=r[u],(o=e.length)>n.yit&&p(e)&&(n.yit=o),o=parseInt(e,10),e=r[s],nt(n.cit)&&(n.cit=e),e!==n.cit?(n.wit=!0,n.cit=tt,n.sit=[]):n.sit.push(o),!0)})}function w(){}function Vt(){var t=null!==vt&&vt.apply(this,arguments)||this;return t.Mit=0,t.uit=rt,t}function m(){return null!==gt&&gt.apply(this,arguments)||this}function _(){return null!==dt&&dt.apply(this,arguments)||this}function Gt(){return null!==pt&&pt.apply(this,arguments)||this}function Lt(){var t=wt.call(this)||this;return t.pit=tt,t.sit=[],t.cit=tt,t.wit=!1,t.yit=0,t.uit=et,t.Cit=!1,t.Sit=!1,t.Tit=new H,t}function F(t){var n=mt.call(this)||this;return n.Ait=new $(t),n}function Bt(){var t=null!==_t&&_t.apply(this,arguments)||this;return t.pit=/^\d+$/,t}function Wt(){var t=null!==yt&&yt.apply(this,arguments)||this;return t.pit=/^(.*\D+)(\d+)$/,t}function $t(){var t=null!==Ct&&Ct.apply(this,arguments)||this;return t.pit=/^(\d+)(\D+.*)$/,t}function b(){var t=null!==s&&s.apply(this,arguments)||this;return t.pit=/^(.*\D+)(\d+)(\D+.*)$/,t}function Ht(){return null!==f&&f.apply(this,arguments)||this}function zt(){return null!==Dt&&Dt.apply(this,arguments)||this}function Pt(){var t=null!==Ft&&Ft.apply(this,arguments)||this;return t.Cit=!0,t}function qt(t){var n,i,i,t,r,e,o,n=this;n.Iit=[new z,new P,new q],n.xit=new ft,n.Nit=new at,i=N.culture(),i=N.Fe(i).isJCKCulture,t=new U(t),r=new J,e=new K,o=new Q,n.kit=i?[t,r,new Z,e,o,new X]:[t,r,e,o]}function Ut(t){t.forEach(function(t){t&&t.dispose()})}function R(t){this.Mf=t,this.Dit=!1,this._it=[]}i=this&&this.__extends||(ht=function(t,n){return(ht=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}ht(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(t,"__esModule",{value:!0}),t.Wtt=t.nnt=t.FillDateUnit=t.FillType=t.FillSeries=t.FillDirection=t.AutoFillType=void 0,e=n("Common"),h=n("Core"),r=n("CalcEngine"),j=n("SheetsCalc"),n=n("./dist/plugins/fill/fill.ns.js"),M=!!r,o=e.Common.lt,tt=null,y=void 0,C=Math.floor,D=h.Ec,nt=o.ht,I=o.uJ,u=e.Common.Uf,S=u.Eit,k=u.tR,u=e.Common.ct,O=u.o0,A=u.Y0,it="number",rt="date",et="string",E="default",u=new e.Common.ResourceManager(n.SR,"Fill"),x=u.getResource.bind(u),N=e.Common.CultureManager,(n=V=t.AutoFillType||(t.AutoFillType={}))[n.copyCells=0]="copyCells",n[n.fillSeries=1]="fillSeries",n[n.fillFormattingOnly=2]="fillFormattingOnly",n[n.fillWithoutFormatting=3]="fillWithoutFormatting",n[n.clearValues=4]="clearValues",n[n.auto=5]="auto",(u=G=t.FillDirection||(t.FillDirection={}))[u.left=0]="left",u[u.right=1]="right",u[u.up=2]="up",u[u.down=3]="down",(n=L=t.FillSeries||(t.FillSeries={}))[n.column=0]="column",n[n.row=1]="row",(u=B=t.FillType||(t.FillType={}))[u.direction=0]="direction",u[u.linear=1]="linear",u[u.growth=2]="growth",u[u.date=3]="date",u[u.auto=4]="auto",(n=W=t.FillDateUnit||(t.FillDateUnit={}))[n.day=0]="day",n[n.weekday=1]="weekday",n[n.month=2]="month",n[n.year=3]="year",a.prototype.jit=function(){return k(this.rit)},a.prototype.Oit=function(){for(var t=this,n=[],i=t.oit,r,e,r=0;r<k(i);r++)e=i[r],n.push("object"===t.uit?t.r0(e):e);return n},a.prototype.Rit=function(){var t,n,i,r,e,t=this,n=t.rit;if(0<k(n)){for(r=[],e=void 0,-1===(i=t.lit)&&(i=n[0]),e=0;e<k(n);e++)r[e]=n[e]-i+1;return r}return tt},a.prototype.Bit=function(){var t=this.oit;return k(t)?t:tt},a.prototype.Eit=function(t,n,i){if(!ut(i))throw new Error(x().Exp_NumberOnly);var r=this;nt(r.uit)&&(r.uit=i instanceof Date?rt:it),S(r.rit,t,n),S(r.oit,t,I(i))},a.prototype.ZP=function(t,n){var i=this,r=nt(i.uit);ut(n)?(r&&(n instanceof Date?i.uit=rt:i.uit=it),i.oit.push(I(n))):r&&(i.uit=st(n)?et:E),i.rit.push(t),i.ait.push(n)},a.prototype.Lit=function(t){return this.uit===rt?this.r0(t):t},a.prototype.r0=function(n){var i=tt;if(n instanceof Date)i=n;else if(r)try{i=r.Convert.r0(n)}catch(t){i=n}return i},ot=a,l.prototype.L0=function(){this.Mf=tt},l.prototype.Fit=function(){var t=this.Mf;return t.parent&&t.parent.Ow()||[]},l.prototype.Pit=function(t){var n,i,r,e,o,u,s,f,a,l,c,h,v,g,d,p,n=t.length,i=!1;if(t&&0<n)for(r=kt(t[0]),e=this.Fit(),l=a=f=s=u=o=void 0,o=0;o<e.length;o++)if(0<=(f=(s=(u=e[o]).map(kt)).indexOf(r))){for(a=f,c=s.length,g=v=h=void 0,d=1;d<n;d++){if(v=kt(t[d]),!(0<=(h=s.indexOf(v)))){i=!1;break}if(g=h-a+c,l){if(l!==g){i=!1;break}}else i=!0,l=g,a=h}if(p=1===n,i||p){i=!0,this.hit=f,this.dit=u,this.MV=p?1:l;break}}return i},l.prototype.Sl=function(t){var n=this.dit,i=this.hit,r=this.MV,e=n.length,o,u,u;return n[(i+r*v(t,e))%e]},$=l,xt.prototype.Sl=function(t){var t=this.MV*(t-1)+this.git,n=this._padding.length,t=""+Math.abs(t),i,r=this._padding+t,e=r.length,t=n<t.length?t:r.substr(e-n);return this.vit+t+this.mit},H=xt,w.prototype.match=function(t){return!1},w.prototype.getTargetValue=function(t,n,i,r,e){},w.prototype.resetProp=function(){},w.prototype.Git=function(t,n){return t.indexOf(n+1)},w.prototype.dispose=function(){},i(Vt,vt=u=w),i(m,gt=n=Vt),m.prototype.match=function(t){var n,i,r,e,n=this.Mit=d(t[0],t[1]),i=Mt(t),r=t.length,e=!0;return i&&2<r&&(e=Ot(t,n)),i&&e},m.prototype.getTargetValue=function(t,n){var i,t=t.ait[0],r=t.getFullYear(),e,o,u,t=t.getMonth()+this.Mit*(n-1);return new Date(r+parseInt(t/12,10),t%12,1)},z=m,i(_,dt=n),_.prototype.match=function(t){var n,i,r,e,n=this.Mit=d(t[0],t[1]),i=It(t),r=t.length,e=!0;return i&&2<r&&(e=Ot(t,n)),i&&e},_.prototype.getTargetValue=function(t,n){var i,t=t.ait[0],r=t.getFullYear(),e,o,u,t=t.getMonth()+this.Mit*(n-1),n=r+parseInt(t/12,10),r=t%12;return new Date(n,r,Et(n,r))},P=_,i(Gt,pt=n),Gt.prototype.match=function(t){var n,i,r,e,o,u,n=!1;return At(t)||(i=this.Mit=d(t[0],t[1]),e=0<(r=St(t)),o=t.length,u=!0,this.Uit=r,e&&2<o&&(u=Ot(t,i)),n=e&&u),n},Gt.prototype.getTargetValue=function(t,n){var i,t=t.ait[0],r=t.getFullYear(),e,o,u,t=t.getMonth()+this.Mit*(n-1),n=r+parseInt(t/12,10),s;return new Date(n,t%12,this.Uit)},q=Gt,i(Lt,wt=u),Lt.prototype.resetProp=function(){this.sit=[],this.yit=0,this.cit=tt,this.wit=!1,this.Cit=!1,this.Sit=!1},Lt.prototype.getInternal=function(t){for(var n,i,r,e,n=!1,i=t[0],e=1;e<t.length;e++)if(r=t[e],1!==Math.abs(r-i)){n=!0;break}return n},i(F,mt=n=Lt),F.prototype.dispose=function(){var t=this;t.Ait&&(t.Ait.L0(),t.Ait=tt)},F.prototype.match=function(t){return this.Ait.Pit(t)},F.prototype.getTargetValue=function(t,n,i,r,e){var o,t=t.ait.length,i=this.Git(i,r),r=tt,u;return r=-1!==i?this.Ait.Sl(u=t*e+i+1):r},U=F,i(Bt,_t=n),Bt.prototype.match=function(t){var n=this,i,r,r;return t.every(function(t){return!!(i=t.match(n.pit))&&((r=t.length)>n.yit&&p(t)&&(n.yit=r),r=parseInt(t,10),n.sit.push(r),!0)})},Bt.prototype.getTargetValue=function(t,n,i,r,e){var o=t.ait,u=this.Tit,s=c(this.sit),o=o.length,f=0!==s,n=f?0:v(n,o),i=this.Git(i,r),r=tt,a;return this.Cit=f,this.Sit=this.getInternal(t.rit),-1!==i&&(u.MV=s,u.git=this.sit[n],u._padding=g(this.yit),r=u.Sl(a=o*e+i+1)),r},J=Bt,i(Wt,yt=n),Wt.prototype.match=function(t){return Nt(this,t,!1)},Wt.prototype.getTargetValue=function(t,n,i,r,e){var o=t.ait,u=this.Tit,s=c(this.sit),o=o.length,f=0!==s,n=f?0:v(n,o),i=this.Git(i,r),r=tt,a;return this.Cit=f,this.Sit=this.getInternal(t.rit),-1!==i&&(u.vit=this.cit,u.MV=s,u.git=this.sit[n],u._padding=g(this.yit),r=u.Sl(a=o*e+i+1)),r},K=Wt,i($t,Ct=n),$t.prototype.match=function(t){return Nt(this,t,!0)},$t.prototype.getTargetValue=function(t,n,i,r,e){var o=t.ait,u=this.Tit,s=c(this.sit),o=o.length,f=0!==s,n=f?0:v(n,o),i=this.Git(i,r),r=tt,a;return this.Cit=f,this.Sit=this.getInternal(t.rit),-1!==i&&(u.mit=this.cit,u.MV=s,u.git=this.sit[n],u._padding=g(this.yit),r=u.Sl(a=o*e+i+1)),r},Q=$t,i(b,s=n),b.prototype.resetProp=function(){s.prototype.resetProp.call(this),this.Hit=tt},b.prototype.match=function(t){var n,i,r,i,n,r,e,e=this;return t.every(function(t){return!!(n=t.match(e.pit))&&(i=n[2],(r=i.length)>e.yit&&p(i)&&(e.yit=r),r=parseInt(i,10),i=n[1],nt(e.cit)&&(e.cit=i),n=n[3],nt(e.Hit)&&(e.Hit=n),i!==e.cit||n!==e.Hit?(e.wit=!0,e.cit=tt,e.Hit=tt,e.sit=[]):e.sit.push(r),!0)})},b.prototype.getTargetValue=function(t,n,i,r,e){var o=this,u=t.ait,s=o.Tit,f=c(o.sit),u=u.length,a=0!==f,n=a?0:v(n,u),i=o.Git(i,r),r=tt,l;return o.Cit=a,o.Sit=o.getInternal(t.rit),-1!==i&&(s.vit=o.cit,s.mit=o.Hit,s.MV=f,s.git=o.sit[n],s._padding=g(o.yit),r=s.Sl(l=u*e+i+1)),r},Y=["-","_",":",".",","],i(Ht,f=X=b),Ht.prototype.resetProp=function(){f.prototype.resetProp.call(this),this.zit=tt},Ht.prototype.match=function(t){var r,e,o,r,e,o,u,s,u=this;return t.every(function(n){var t,t,t,i,t=u.zit;if(s=nt(t)?Y.some(function(t){if(bt(n,t))return u.zit=t,!0}):bt(n,t)){if(t=u.zit,t=n.lastIndexOf(t),r=n.substring(0,t+1),nt(u.cit))u.cit=r;else if(u.cit!==r)return!1;if(t=n.substr(t+1),r=t.match(i=/^(\d+)(\D+.*)$/))return e=r[1],(o=e.length)>u.yit&&p(e)&&(u.yit=o),o=parseInt(e,10),e=r[2],nt(u.Hit)&&(u.Hit=e),e!==u.Hit?(u.cit=tt,u.Hit=tt,!(u.sit=[])):(u.sit.push(o),!0)}return!1})},Z=Ht,i(zt,Dt=u),zt.prototype.getTargetValue=function(t,n,i){return jt(!0,t.Bit(),i,n)},ft=zt,i(Pt,Ft=u),Pt.prototype.getTargetValue=function(t,n,i,r){var t=t.ait,e,o;return t[v(n,t.length)]},at=Pt,qt.prototype.getRule=function(t,n){var i,r,e,o,u,i=[],r=this.Nit;for(t===rt?(i=this.Iit,r=this.xit):t===et?i=this.kit:t===it&&(r=this.xit),e=0;e<i.length;e++)if(u=void 0,(o=i[e]).resetProp(),o.match(n)){if(u=o.wit,nt(u)||!1===u)return o;if(!0===u)return r}return r},qt.prototype.L0=function(){var t=this;t.Iit&&(Ut(t.Iit),t.Iit=tt),t.kit&&(Ut(t.kit),t.kit=tt),t.xit&&(t.xit.dispose(),t.xit=tt),t.Nit&&(t.Nit.dispose(),t.Nit=tt)},t.nnt=qt,R.prototype.qtt=function(t,n,i,r,e){var o=this,t=t?1:2;nt(r)&&nt(e)?o.$tt(n,i,t):o.$tt(n,i,t,r,e,tt)},R.prototype.$tt=function(t,n,i,r,e,o){var u,s,t,f,a,l,c,h,v,g,d,p,w,m,_,y,C,D,F,t,b,R,p,T,j,u=this,s=u.Mf,t=s.JS(t),f=t.row,a=t.col,l=t.rowCount,c=t.colCount;if(s.Ut.eE(f,a,l,c))throw new Error(x().Exp_RangeContainsMergedCell);for(m=0,y=(_=1===n)?c:l,D=_?f+l:a+c,F=(w=3<arguments.length)?1:y,b=(t=this.Mf.rt.Ktt).row===f&&t.rowCount===l&&t.col>a||t.col===a&&t.colCount===c&&t.row>f,h=C=_?f:a;h<D;h++)if(p=b&&w?f+l-1:f,(T=_?u.Vit(h,R=b&&w?a+c-1:a,1,F,n):u.Vit(p,h,F,1,n))&&T.jit())for(d=T.rit[0],w?(p=b?T.oit[k(T.oit)-1]:T.oit[0],v=u.Yit(b,p,y,i,r,e,o),b&&(m=y-k(v),d=T.rit[k(T.rit)-1])):v=u.Zit(T,y,i),g=0;g<k(v);g++)j=T.Lit(v[g]),_?u.Wit(s,h,d,h,a+m+g,j,i):u.Wit(s,d,h,f+m+g,h,j,i)},R.prototype.Vit=function(t,n,i,r,e){for(var o=tt,u=this.Mf,s,f=1===e,a=f?n+r-1:t+i-1,l=f?n:t;l<=a;)ut(s=f?u.getValue(t,a):u.getValue(a,n))&&(o=o||new ot(l)).Eit(0,a,s),a--;return o},R.prototype.Yit=function(t,n,i,r,e,o,u){for(var s,f,a,l,c,h,v,s=[],f=n,l=0<=e,c=nt(o),a=0;a<i;a++)h=o<=f,v=f<=o,t&&(c||l&&h||!l&&v)?(s.unshift(f),1===r?f-=e:2===r?f/=e:3!==r||nt(u)||(f=this.Qit(!0,u,n,f,e,a+1))):!t&&(c||l&&v||!l&&h)&&(s.push(f),1===r?f+=e:2===r?f*=e:3!==r||nt(u)||(f=this.Qit(!1,u,n,f,e,a+1)));return s},R.prototype.Zit=function(t,n,i){var r=[],e,o=1===i;if(o||2===i){for(1===t.jit()&&t.ZP(t.rit[0]+1,o?t.Lit(t.oit[0]+1):t.Oit()[0]),e=0;e<n;e++)r.push(jt(!!o,t.Bit(),t.Rit(),e+1));return r}return tt},R.prototype.Jtt=function(t,n,i,r,e,o){var u,s,f,t,a,l,c,t,s,h,v,f,u=this,s=u.Mf,f=s.Ut,t=s.JS(t),a=t.row,l=t.col,c=t.rowCount,t=t.colCount,s=s.JS(s.rt.Ktt),h=s.row,v=s.col;if(f.GT(h,v,s.rowCount,s.colCount)||f.GT(a,l,c,t))throw new Error(x().Exp_ChangeMergedCell);return f=u.Kit(s,c,t,n,i,!(a<h||l<v),r,e,o),u.Jit&&u.Jit.IB&&(u.Jit.IB.reFilter(),delete u.Jit),f},R.prototype.Kit=function(t,n,i,r,e,o,u,s,f){var a=this,l=o?1:-1,c,h,v,g,d=t.row,p=t.col,w=t.rowCount,m=t.colCount;if(1===r){if(c=C(i/m),h=i%m,!e)for(g=1;g<c;g++)v=D(d,p+g*l*m,w,m),a.Tle(t,v,r,4,e,o,y,y,!0,u,s),a.Xit(t,v,r,4,e,o,y,y,!0,u,s);if(e&&1<c&&0===h&&(c-=1,h=m),0<c&&0<h)return v=D(d,o?p+c*m:p-c*m+m-h,w,h),a.Tle(t,v,r,4,e,o,tt,o?0:m-h,y,u,s),a.Xit(t,v,r,4,e,o,tt,o?0:m-h,y,u,s)}else{if(c=C(n/w),h=n%w,a.Dit||(v=D(d+l*w,p,n-w,i),a.qit(t,v,l,f)),!e)for(g=1;g<c;g++)v=D(d+g*l*w,p,w,m),a.Tle(t,v,r,4,e,o,tt,tt,!0,u,s),a.Xit(t,v,r,4,e,o,tt,tt,!0,u,s);if(e&&1<c&&0===h&&(c-=1,h=w),0<c&&0<h)return v=D(o?d+c*w:d-c*w+w-h,p,h,m),a.Tle(t,v,r,4,e,o,o?0:w-h,tt,!0,u,s),a.Xit(t,v,r,4,e,o,o?0:w-h,tt,!0,u,s)}},R.prototype.Xit=function(t,n,N,i,r,e,V,G,o,u,s){for(var f,a,L,l,B,c,h,v,g,W,$,H,d,z,P,q,p,w,m,_,y,C,D,F,b,U,R,T,j,k,J,x,M,c,I,S,K,Q,X,O,Y,Z,A,E,f=this,a=f.Mf,L=a.Ut,l=1===N,W=l?t.row:t.col,$=l?t.col:t.row,H=l?n.row:n.col,d=l?n.col:n.row,z=l?t.rowCount:t.colCount,P=l?t.colCount:t.rowCount,q=l?n.colCount:n.rowCount,v=0;v<z;v++){for(m=0,C=_=W+v,D=y=H+v,F=(l?G:V)||0,b=l?0:F,U=l?tt:o,R=w=p=tt;m<P;)if(k=tt,J=T=$+m,x=j=d+m-F,l||(_=T,T=C,y=j,j=D),h=L.findSpan(_,T),(B=a.hasFormula&&a.hasFormula(_,T))||(k=a.getValue(_,T)),(M=f.Dit)&&nt(R)&&(R=!1===e?a.getValue($+P-1,T):a.getValue(_,T)),M||4!==i||!ut(k)&&!st(k)||(p=p||new ot,c=ut(k)?k instanceof Date?rt:it:et,(w=w||c)!==c))if(!M&&k&&p&&p.jit()){if(g=f.$it(l,t,n,C,D,p,r,e,b,U,u,s),r&&g)return g;w=p=tt}else{if(M||!h||h&&(l?h.row:h.col)===C)if(c=x===d+q-1,I=M?R:k,r){if(M)return I;if(h&&c||!h&&(c&&e||!e&&x===d))return k}else!(x<d+q&&d<=x)||!M&&!l&&(l||o&&a.XT&&a.XT(x))||M&&-1!==f._it.indexOf(y)||f.Wit(a,_,T,y,j,I,i,u,s);h?m+=l?h.colCount:h.rowCount:m++}else p.ZP(J,k),h?m+=l?h.colCount:h.rowCount:m++;if(f.Dit)for(S=t.row,K=t.col,Q=t.rowCount,X=t.colCount,Y=O=void 0,Z=!1===e?-1:1,A=1;A<Q;A++)for(O=S+Z*A,E=0;E<X;)Y=K+E,-1===f._it.indexOf(O)&&f.Wit(a,S,K,O,Y,R,i,u,s),E++;if(p&&p.jit()&&(g=f.$it(l,t,n,C,D,p,r,e,b,o,u,s),r)&&!nt(g))return g}return tt},R.prototype.Tle=function(t,n,N,i,r,e,V,G,L,o,u){var s,f,B,a,l,c,h,v,g,W,d,$,p,H,w,z,m,_,y,C,D,F,b,R,T,j,k,x,M,I,P,S,c,c,h,q,U,J,K,O,Q,X,A,E;if(!r){for(a=(B=(f=(s=this).Mf).Ut).yle(),W=(l=1===N)?t.row:t.col,d=l?t.col:t.row,$=l?n.row:n.col,p=l?n.col:n.row,H=l?t.rowCount:t.colCount,w=l?t.colCount:t.rowCount,z=l?n.colCount:n.rowCount,g=0;g<H;g++){for(y=0,F=C=W+g,b=D=$+g,R=(l?G:V)||0,T=l?0:R,j=l?tt:L,k=_=m=tt;y<w;)I=tt,P=x=d+y,S=M=p+y-R,l||(C=x,x=F,D=M,M=b),v=B.findSpan(C,x),c=f.getValueIgnoreDefault(C,x),nt(c)?y++:((c=a.getFormula(C,x))&&""!==c||(I=a.getValue(C,x)),(c=s.Dit)&&nt(k)&&(k=!1===e?f.getValue(d+w-1,x):f.getValue(C,x)),c||4!==i||!ut(I)&&!st(I)||(m=m||new ot,h=ut(I)?I instanceof Date?rt:it:et,(_=_||h)!==h)?!c&&I&&m&&m.jit()?(s.$it(l,t,n,F,b,m,r,e,T,j,o,u,!0),_=m=tt):((c||!v||v&&(l?v.row:v.col)===F)&&(h=c?k:I,!(S<p+z&&p<=S)||!c&&!l&&(l||L&&f.XT&&f.XT(S))||c&&-1!==s._it.indexOf(D)||s.Wit(f,C,x,D,M,h,i,o,u,!0)),v?y+=l?v.colCount:v.rowCount:y++):(m.ZP(P,I),v?y+=l?v.colCount:v.rowCount:y++));if(s.Dit)for(q=t.row,U=t.col,J=t.rowCount,K=t.colCount,Q=O=void 0,X=!1===e?-1:1,A=1;A<J;A++)for(O=q+X*A,E=0;E<K;)Q=U+E,-1===s._it.indexOf(O)&&s.Wit(f,q,U,O,Q,k,i,o,u,!0),E++;m&&m.jit()&&s.$it(l,t,n,F,b,m,r,e,T,j,o,u,!0)}return tt}},R.prototype.qit=function(t,n,i,r){var e,o,u,n,s,f,n,a,l,t,c,h,v,g,d,p,w,m,_,y,C,D,F,b,R,e=this,o=e.Mf,u=o.tables,n=t.union(n),s=n.row,f=n.rowCount,n=t.row,a=t.col,l=t.rowCount,t=t.colCount;if(u)for(h=0,v=c=u.AB(n,a,l,t);h<v.length;h++){if(d=(g=v[h]).Ky,p=g.iw,w=f,r)for(m=0,_=r;m<_.length;m++)if((y=_[m]).row===d&&y.col===p){w=y.rowCount,e.Jit=g;break}if(C=g.IB,D=e._it,F=void 0,C&&C.isFiltered&&C.isFiltered()){for(b=0;b<w;b++)C.isRowFilteredOut(F=s+i*b)&&e._it.push(F);if(0<D.length){e.Dit=!0;break}}}if(R=o.IB,!0!==e.Dit&&R&&R.isFiltered&&R.isFiltered()){for(D=e._it,F=void 0,b=0;b<f;b++)R.isRowFilteredOut(F=s+i*b)&&e._it.push(F);0<D.length&&(e.Dit=!0)}},R.prototype.Wit=function(t,n,i,r,e,o,u,s,f,a){var l,c,c,u,l=t.Ut;M&&(a?((c=l.yle().getExpression(n,i))&&t.hasFormula(n,i,3,!0)||!nt(t.getValueIgnoreDefault(n,i)))&&(0,h.copyDefaultFormula)(t,t,r,e,c):(t.hasFormula(n,i,3)||t.hasFormula(r,e,3))&&(t.setFormula(r,e,tt),0!==u&&4!==u||(t.getFormula(n,i)||l.getDefaultValue(n,i,tt,h.DefaultChangeValueType.Expression))&&j.CalcOperatorAdjustor.copyFormula(t,n,i,t,r,e,1,1,y,!0))),a||nt(t.getValueIgnoreDefault(n,i))&&!nt(l.getDefaultValue(n,i,tt,h.DefaultChangeValueType.Value))?l.getDefaultValue(n,i,tt,h.DefaultChangeValueType.Expression)||l.setDefaultValue(r,e,o,tt,h.DefaultChangeValueType.Value):t.setValue(r,e,o),a||(c=f?0:64,s&&(c|=4224),t.vT(n,i,r,e,1,1,c=c|1024|256,y,!0),f)||(t.removeSpan(r,e,3),(u=l.findSpan(n,i))&&n===u.row&&i===u.col&&t.EL(r,e,u.rowCount,u.colCount,3))},R.prototype.$it=function(t,n,i,r,e,o,u,s,f,a,l,c,h){var v,g,d,p,w,m,_,y,C,D,F,b,R,T,j,k,x,M,j,I,k,j,v=this,g=v.Mf,_=t?i.col:i.row,y=t?n.col:n.row,C=t?i.colCount:i.rowCount,D=t?n.colCount:n.rowCount;if(f=f||0,F=o.jit(),b=(_-y-f)/D,R=v.Cit(o.rit,o.oit),T=o.uit,R){for(w=[],p=0;p<F;p++)w[p]=p+1;d=F}else m=o.rit[0],d=o.rit[F-1]-m+1,1===F&&T!==et&&o.ZP(o.rit[0]+1,o.Lit(o.oit[0]+1)),w=o.Rit();for(p=0;p<d;p++)if(j=o.ait,M=x=k=void 0,I=_+C-1,j=(k=(M=(k=T!==rt&&T!==et?k:g.tnt&&g.tnt.getRule(T,j))?(x=k.getTargetValue(o,d*b+p+1,w,p,b),R=k.Cit||R,j=k.Sit||!1,R&&!j):(x=jt(!0,o.Bit(),w,d*b+p+1),R))?o.rit[p]:m+p)+b*D,u){if(R&&(s&&j===I||!s&&j===_)||!R&&j+f===I)return o.Lit(x)}else j<_+C&&_<=j&&(t?a&&g.XT&&g.XT(r)||v.Wit(g,r,k,e,j,o.Lit(x),4,l,c,h):a&&g.XT&&g.XT(j)||v.Wit(g,k,r,j,e,o.Lit(x),4,l,c,h));return tt},R.prototype.Cit=function(t,n){var i,r,e,o,i=k(n);if(i<=1||k(t)!==i)return!1;for(r=t[1]-t[0],e=n[1]-n[0],o=2;o<i;o++)if(t[o]-t[o-1]!=r||n[o]-n[o-1]!=e)return!1;return!0},R.prototype.Xtt=function(t,n){var i=this,r=this.Mf,e=r.Ut.getSpans(),t=r.JS(t),o=t.row,u=t.col,s=t.rowCount,t=t.colCount,f,f=0===n?D(o,u+t-1,s,1):1===n?D(o,u,s,1):D(2===n?o+s-1:o,u,1,t);(f=r.nR(e,f))&&i.trt(f,o,u,s,t,n)},R.prototype.trt=function(t,n,i,r,e,o){var u=this,s=t.row,f=t.col,a=t.rowCount,l=t.colCount,c,h,v,g,d,p,w,m=u.Mf.Ut,_,d=0===o?(_=m.eE(n,i,r,e-l),p=0,w=-1*l,v=e,g=l,1):1===o?(_=m.eE(n,i+l,r,e-l),p=0,v=e,g=w=l,1):w=(g=2===o?(_=m.eE(n,i,r-a,e),p=-1*a,v=r,a):(_=m.eE(n+a,i,r-a,e),v=r,p=a),0);if(_)throw new Error(x().Exp_TargetContainsMergedCells);if(v%g!=0)throw new Error(x().Exp_MergedCellsIdentical);for(c=C(v/g),h=1;h<c;h++)u.Xit(t,D(s+h*p,f+h*w,a,l),d,0,y,y,y,y,!0)},R.prototype.Qit=function(t,n,i,r,e,o){var u,t,s,f,u=t?-1:1,t=C(o*e),s=Math.abs(e),f=A(1<n?i:r);if(0===n)f.setDate(f.getDate()+u*e);else if(1===n)for(;0<s;)f.setDate(f.getDate()+u*(0<e?1:-1)),6!==f.getDay()&&0!==f.getDay()&&s--;else 2===n?f.setMonth(f.getMonth()+u*t):f.setFullYear(f.getFullYear()+u*t);return O(f)},t.Wtt=R},"./dist/plugins/fill/fill.ns.js":function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var i=i("./dist/plugins/fill/fill.res.en.js");n.SR={en:i}},"./dist/plugins/fill/fill.res.en.js":function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_ChangePartOfArray=n.Exp_RangeIsNull=n.Exp_CellReadOnly=n.Exp_RowReadOnly=n.Exp_ColumnReadOnly=n.Exp_ChangeMergedCell=n.Exp_FillCellsReadOnly=n.Exp_FillRangeContainsMergedCell=n.Exp_MergedCellsIdentical=n.Exp_TargetContainsMergedCells=n.Exp_RangeContainsMergedCell=n.Exp_NumberOnly=n.FillWithoutFormatting=n.FillFormattingOnly=n.FillSeries=n.CopyCells=void 0,n.CopyCells="Copy Cells",n.FillSeries="Fill Series",n.FillFormattingOnly="Fill Formatting Only",n.FillWithoutFormatting="Fill Without Formatting",n.Exp_NumberOnly="Only works for Numbers",n.Exp_RangeContainsMergedCell="Range should not have merged cells.",n.Exp_TargetContainsMergedCells="Target range should not have merged cells.",n.Exp_MergedCellsIdentical="This operation requires the merged cells to be identically sized.",n.Exp_FillRangeContainsMergedCell="Cannot fill range that contains a merged cell.",n.Exp_FillCellsReadOnly="The cells you are trying to fill are protected and therefore read-only.",n.Exp_ChangeMergedCell="Cannot change part of merged cell.",n.Exp_ColumnReadOnly="The column you are trying to change is protected and therefore read-only.",n.Exp_RowReadOnly="The row you are trying to change is protected and therefore read-only.",n.Exp_CellReadOnly="The cell you are trying to change is protected and therefore read-only.",n.Exp_RangeIsNull="range is null",n.Exp_ChangePartOfArray="Cannot change part of an array."},Common:function(t){t.exports=GC.Spread},CalcEngine:function(t){t.exports=GC.Spread.CalcEngine},Core:function(t){t.exports=GC.Spread.Sheets},SheetsCalc:function(t){t.exports=GC.Spread.Sheets.CalcEngine}},r={},t=e("./dist/plugins/fill/fill.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Fill=t}();
;var GC;!function(){"use strict";var i,r,n;function e(n){var t,t,t=r[n];return void 0!==t||(t=r[n]={exports:{}},i[n].call(t.exports,t,t.exports,e)),t.exports}i={"./dist/plugins/touch/touch.entry.js":function(n,t,i){var r,e,r=this&&this.__createBinding||(Object.create?function(n,t,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(t,i);e&&("get"in e?t.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,r,e)}:function(n,t,i,r){n[r=void 0===r?i:r]=t[i]}),e=this&&this.__exportStar||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),e(i("./dist/plugins/touch/touch.js"),t)},"./dist/plugins/touch/touch.js":function(P,n,y){var T,_,F,y,I,y,O,R,Z,c,a,D,Q,L,G,r,M,p,B,Y,z,J,K,o,X,V,W,q,$,nn,h,tn,rn,en,on,un,fn,sn,cn,an,hn,v,u,vn,An,ln,H,wn,A,dn,S,L,f,pn,gn,mn,Cn,Mn,bn,b,xn,En,kn,Pn,yn,Fn,In,On,Bn,Yn,Hn,Sn,jn,Nn,Un,Tn,_n,j,Rn,Zn,Dn,Qn,Ln,Gn,zn,Jn,Kn,Xn,Vn,l,Wn,qn,$n,nt,tt,it,rt,et,ot,ut,ft,st,ct,at,ht;function N(n){return n.height}function U(n){return n.width}function vt(n){clearInterval(n)}function w(){return(new Date).valueOf()}function At(n,t){var i,r,e,o,u,f,s,n;return n&&t&&(o=e=i=13,f=u=r=15,s=n.X-t.X,n=n.Y-t.Y,B(s)<13)&&B(n)<13&&V(s*s+n*n)<Y(15,15)}function d(n){var n=n.jg();return n instanceof F.Worksheet?n:n&&n.Mf}function m(n){return n.getSelections()}function lt(n){return n.frozenTrailingColumnCount()}function wt(n){return n.frozenTrailingRowCount()}function dt(n,t){return n.getColumnCount(t)}function pt(n,t){return n.getRowCount(t)}function gt(n){var n=O(n).offset(),t=H.body,i=0,r=0;return n&&(i=n.top+t.clientTop||0,r=n.left+t.clientLeft||0),{A0:i,I0:r}}function t(){var n=this;n.j0t=[],n.WTt={length:0},n.QTt=new Mn,n.KTt=new bn}function mt(n,t){var t=K(t.Y,t.X)-K(n.Y,n.X);return o<t?t-=2*o:t<-o&&(t+=2*o),t}function Ct(n,t){return V((t.X-n.X)*(t.X-n.X)+(t.Y-n.Y)*(t.Y-n.Y))}function Mt(n,t,i){var r,e,n,t,r,r=new b(i._Center.X,i._Center.Y),e=new b(t.X-r.X,t.Y-r.Y),n=new b(n.X-r.X,n.Y-r.Y),t=Y(1,J(Ct(t,r)/i._Radius,4)),r=mt(e,n);return u(r)?0:r*t}function bt(n){return B(n)<=2220446049250313e-31}function xt(n,t){var i=!1,r=!1,e;return{JTt:i=0!==n&&(e=W(t/n)/o*180)<20?!0:i,XTt:r=0===n||75<(e=W(t/n)/o*180)&&e<105?!0:r}}function i(){var n=this;n.qTt=0,n.$Tt=0,n.tAt=1,n.nAt=0,n.eAt=0,n._process=0,n.rAt=511,n.oAt=new In,n.aAt=20,n.uAt=new xn}function Et(){}function kt(n,t){this.X=n,this.Y=t}function Pt(n){return new b(n?X(n.X):-1,n?X(n.Y):-1)}function e(){var n=this;n.DU=0,n.ak=0,n.sAt=10,n.cAt=[]}function yt(n,t,i,r,e){var o=this;n?o.cAt=n:(o.fAt=new b(t,i),o.lAt=r,o.hAt=e)}function Ft(n){this.dAt=n,this.vAt=0}function It(n){this.dAt=n,this.vAt=0}function Ot(n,t){var i=this;i.mAt=n,i.gAt=t,i.pAt=0,i.bAt=0,i.vAt=0,i.yAt=V(n*n+t*t)}function Bt(){var n=this;n.wAt=new b(0,0),n.tW=0,n.MAt=0,n.CAt=0}function Yt(){this.wY=[]}function Ht(n,t,i){var r=this;r.nW=n,r.SAt=t,r.TAt=i}function St(n,t,i,r,e){var o=this;o.qZ=n,o.nW=t,o.AAt=i,o.JZ=r,o.TAt=e}function jt(n,t,i,r,e,o){var u=this;u.qZ=n,u.nW=t,u.SAt=i,u.AAt=r,u.JZ=e,u.TAt=o}function Nt(n,t,i,r,e,o,u){var f=this;f.qZ=n,f.nW=t,f.SAt=i,f.TAt=r,f.IAt=e,f.xAt=o,f.NAt=u}function Ut(n,t,i,r){var e=this;e.qZ=n,e.kAt=t,e.nW=i,e.JZ=r}function Tt(n,t,i,r){var e=this;e.qZ=n,e.KZ=t,e.DAt=i,e.JZ=r}function _t(n){this.JZ=n}function Rt(n){this.JZ=n}function Zt(n){this.JZ=n}function Dt(n,t){var n=n*t;return 4<n?n=4:n<.5&&(n=.5),n}function Qt(n){this.Mf=n}function Lt(n,t,i,r){var e,o,i,u,f,s,c,a,h,v,v,A,l,w,d,c,e=i,o=0,i=0,u=n.Jt,c=n.Fi(),a=c.Cy,h=n.dw(1).findRow(e),v=n.parent,v=v&&v.options.scrollByPixel&&v.options.scrollbarMaxAlign;if(h)if(0<t){for(f=n.vw(-1),o=a-h.y;f<e&&o<t;)o+=u.Gt(--e);i=t-o}else if(t<0){if(A=0,l=r,v){if(w=n.frozenRowCount(),d=n.getRowCount()-n.frozenTrailingRowCount()-1,s=(c=n.gw(n.Sy(c),w,d)).Ky,A=c.Xy,l=r+t,s<e||e===s&&l<A)return M}else s=n.mw().Ky;for(o=-(h.y+N(h)-a);e<s&&t<o;)o-=u.Gt(++e);i=t-o,v&&e===s&&l<A&&(t=(i=A+u.Gt(e))+o)}return{Ky:e,Xy:i,_At:t}}function Gt(n,t,i,r){var e,o,i,u,f,s,c,a,h,v,v,A,l,w,d,c,e=i,o=0,i=0,s=n.Jt,c=n.Fi(),a=c.Py,h=n.yw(1).findCol(e),v=n.parent,v=v&&v.options.scrollByPixel&&v.options.scrollbarMaxAlign;if(h)if(0<t){for(u=n.ww(-1),o=a-h.x;u<e&&o<t;)o+=s.Kt(--e);i=t-o}else if(t<0){if(A=0,l=r,v){if(w=n.frozenColumnCount(),d=n.getColumnCount()-n.frozenTrailingColumnCount()-1,f=(c=n.Cw(n.Gy(c),w,d)).iw,A=c.Xy,l=r+t,f<e||e===f&&l<A)return M}else f=n.Mw().iw;for(o=-(h.x+U(h)-a);e<f&&t<o;)o-=s.Kt(++e);i=t-o,v&&e===f&&l<A&&(t=(i=A+s.Kt(e))+o)}return{iw:e,Xy:i,EAt:t}}function zt(n,t){return vn(-t/(n/t+1)+t+"")}function Jt(n,t){return vn(t*(-t/(n-t)-1)+"")}function C(n,t,i,r,e,o){n.fillStyle=t,n.fillRect(i,r,e,o)}function Kt(n,t,i,r,e){var o,u,f,u,s,c,a,h,u=F.I.He(0,"gc-columnHeader-normal"),f=u&&u.backgroundImage,u=u&&u.backgroundColor;if(f&&-1!==f.indexOf("linear-gradient"))for(s=F.mt.ri(f),o=n.createLinearGradient(t+r/2,i,t+r/2,i+e),c=0,a=s.length;c<a;c++)h=s[c],o.addColorStop(h.point,h.color);else u&&(o=u);return o}function Xt(){var n=F.I.He(0,"gc-rowHeader-normal");return n&&n.backgroundColor}function Vt(n,t){var i,r,e,o,u,o,f,s,r,c,a,h,v,A,l,w,d,p,g,u,o,m,A,m,A,A,m,g,o,p,i=n.Fi(),r=n.Dn,e,o=n.options.sheetAreaOffset,u=o.left,o=o.top,f=r.R7(!1),s=r.J(),r=r._7(),A=n.dw(1),l=qt(n),w=i.J7,d=i.Uy,p=i.X7,g=i.Ty,c=i.BA,u=1<=u?1:0,o=1<=o?1:0,h=U(i);s.save(),r.save(),m=n.vw(-1),(A=A.findRow(m))&&(a=i.Cy,0<(v=A.y-a-1-o))&&(t?(m=i.XC,C(s,A=Xt(),c,a,m-1,v+1),C(r,A,c,a,m-1,v+1),C(s,f,c+m,a,h-m-l.width,v),C(r,f,c+m,a,h-m-l.width,v)):(C(s,f,c,a,h,v),C(r,f,c,a,h,v))),S<g&&(C(s,f,c,p,h,v=g-S-o),C(r,f,c,p,h,v)),A=n.yw(1),a=i.LA,v=N(i),m=n.ww(-1),(g=A.findCol(m))&&(c=i.Py,0<(h=g.x-c-1-u))&&(t?(C(s,p=Kt(s,c,a,h+1,(o=i.qC)-1),c,a,h+1,o-1),C(r,p,c,a,h+1,o-1),C(s,f,c,a+o,h,v-o-l.height),C(r,f,c,a+o,h,v-o-l.height)):(C(s,f,c,a,h,v),C(r,f,c,a,h,v))),S<d&&(C(s,f,w,a,h=d-S-u,v),C(r,f,w,a,h,v)),r.restore(),s.restore()}function Wt(n,t,i,r,e,o){n.beginPath(),n.strokeStyle=t,n.moveTo(i,r),n.lineTo(e,o),n.stroke()}function qt(n){var t,i=n.options.sheetAreaOffset;return n.gj&&n.gj()||{x:i.left,y:i.top,width:0,height:0}}function $t(n,t){var i,r,e,o,u,f,o,f,s,c,s,o,n,s,a,i=n.Fi(),r,e=n.Dn.J(),o=n.dw(1),u=qt(n),f=n.vw(-1),o=o.findRow(f),f=Q("gc-group").color;o&&(s=i.Cy,0<(c=o.y-s))&&t&&0<u.width&&0===i.XC&&Wt(e,f,i.b6-.5,s,i.b6-.5,o.y),s=n.yw(1),o=n.ww(-1),(n=s.findCol(o))&&(s=i.Py,0<(a=n.x-s))&&t&&0<u.height&&0===i.qC&&Wt(e,f,s,i.T6-.5,n.x,i.T6-.5)}function ni(n,t){var i,r,e,o,o,r,u,f,s,c,a,h,v,a,v,a,n,i=n.Fi(),r=n.Dn,e=n.options.gridline.color,o=F.I.He(0,"gc-columnHeader-normal"),o=o&&o.borderBottomColor,r=r.J(),a=n.dw(1),h=qt(n),u=i.BA,s=U(i),v=n.vw(-1),a=a.findRow(v);a&&(f=i.Cy,0<(c=a.y-f))&&(Wt(r,e,u,a.y-.5,u+s-h.width,a.y-.5),t)&&(0===h.width&&Wt(r,e,i.BA-.5,f,i.BA-.5,a.y),Wt(r,o,i.b6-.5,f,i.b6-.5,a.y)),v=n.yw(1),f=i.LA,c=N(i),a=n.ww(-1),(n=v.findCol(a))&&(u=i.Py,0<(s=n.x-u))&&(Wt(r,e,n.x-.5,f,n.x-.5,f+c-h.height),t)&&(0===h.height&&Wt(r,e,u,i.LA-.5,n.x,i.LA-.5),Wt(r,o,u,i.T6-.5,n.x,i.T6-.5))}function ti(n,t){var i=0;return n||(i|=1),t||(i|=2),i}function ii(n,t){var i=0;return i=i|(0!==n?1:0)|(0!==t?2:0)}function s(n){this.Mf=n}function ri(n,t,i,r,e){var o,u,f,s,c,a,h,a,v,A,l,a,o=n.parent,u=n.rt,f=n.options,s=t.rowViewportIndex,c=t.colViewportIndex,a=m(n),h=M;return n.Oi&&0<a.length&&(v=(a=a[a.length-1]).row,A=a.row+a.rowCount-1,l=a.col,a=a.col+a.colCount-1,o&&!o.options.allowUserResize||(-1!==v&&-1===l&&0<=s&&c<0&&f.rowHeaderVisible?!(h=u.cD(n,t,e,2,r))||"sizeRow"!==h.action&&"sizeHiddenRow"!==h.action||2!==h.sheetArea||h.index===A||(h=M):-1===v&&-1!==l&&s<0&&0<=c&&f.colHeaderVisible&&(!(h=u.dD(n,t,e,1,i))||"sizeCol"!==h.action&&"sizeHiddenCol"!==h.action||1!==h.sheetArea||h.index===a||(h=M)))),h}function ei(n,t,i,r){var e,o,u,f,u,s,c,c,c;if(0===n.selectionPolicy())return M;for(e=t.hitTestType,o=xi(n),u=m(n),f=3,n.Oi&&0<u.length&&(-1!==(u=u[u.length-1]).row&&-1===u.col?f=2:-1!==u.col&&-1===u.row&&(f=1)),s=0;s<o.length;s++)if((c=o[s])&&(c.x-=U(c),c.y-=N(c),c.width*=3,c.height*=3,c.contains(i,r)))return I(t.row)&&(c=n.dw(1))&&0<c.length&&(t.row=c[c.length-1].row),I(t.col)&&(c=n.yw(1))&&0<c.length&&(t.col=c[c.length-1].col),{x:i,y:r,type:f,isHeader:!1,isFirstIndicator:0===s};return 1===e&&n.JA(-1,t.col)?{x:i,y:r,type:1,isHeader:!0}:2===e&&n.JA(t.row,-1)?{x:i,y:r,type:2,isHeader:!0}:M}function oi(n,t,i,r){var e,o,t,u,f,f,s,c,a,h,s,a,t,s,a,e=M,o=t.rowViewportIndex,t=t.colViewportIndex;if(!I(o)&&!I(t)){if(u=n.parent,f=n.U5(),0<=o&&0<=t&&1===n.Ut.getSelections().length){if(f=n.JS(f),s=lt(n),c=wt(n),a=dt(n)-s,h=pt(n)-c,1===t&&0<s&&f.col<a&&f.col+f.colCount>a&&(s=n.Yy(t))&&0<s.length&&i>(a=s[s.length-1]).x+U(a))return e;if(1===o&&0<c&&f.row<h&&f.row+f.rowCount>h&&(t=n._y(o))&&0<t.length&&r>(s=t[t.length-1]).y+N(s))return e}(a=Ci(n))&&(e||(a.x-=U(a),a.y-=N(a),a.width*=3,a.height*=3,a.contains(i,r)&&(e={action:"drag",side:"corner"})),u&&u.options.allowUserDragFill||e&&"corner"===e.side&&(e.side=M))}return e}function ui(n,t,i,r){for(var e,o,u,f,s,c,a,h,v,s,e=!1,o=n.Ut.getSelections(),u=0,f=o.length;u<f;u++){if(s=o[u],a=(s=(c=3===r||I(r))?n.JS(s):s).row,h=s.col,v=s.rowCount,s=s.colCount,c)e=a<=t&&t<a+v&&h<=i&&i<h+s;else if(2===r)e=-1===h&&a<=t&&t<a+v;else if(1===r)e=-1===a&&h<=i&&i<h+s;else if(0===r)return e;if(e)break}return e}function fi(n,t,i,r,e){t===r&&i===e||(n.Ut.setCellState(t,i,F.CellStatesType.active,!1,F.SheetArea.viewport),n.k_&&n.k_(F.CellStatesType.active,t,i,F.SheetArea.viewport),n.Ut.setCellState(r,e,F.CellStatesType.active,!0,F.SheetArea.viewport),n.k_&&n.k_(F.CellStatesType.active,r,e,F.SheetArea.viewport))}function si(n,t,i,r){var t,t,e,o;t||(t=(t=m(n))[t.length-1],e=n.ui,o=n.ci,i?3===r?(n.ui=t.row+t.rowCount-1,n.ci=t.col+t.colCount-1):2===r?(n.ui=t.row+t.rowCount-1,n.ci=0):1===r&&(n.ui=0,n.ci=t.col+t.colCount-1):3===r?(n.ui=t.row,n.ci=t.col):2===r?(n.ui=t.row,n.ci=0):1===r&&(n.ui=0,n.ci=t.col),fi(n,e,o,n.ui,n.ci))}function ci(n,t,i,r){var t,t,e,o;t||(t=(t=m(n))[t.length-1],e=n.ui,o=n.ci,i&&(3===r?(n.ui=t.row,n.ci=t.col):2===r?(n.ui=t.row,n.ci=0):1===r&&(n.ui=0,n.ci=t.col)),fi(n,e,o,n.ui,n.ci))}function g(n){var t=this;t.jAt=!1,t.YZ=new _n(n),t.OAt=new Zn(n),t.Mf=n}function ai(n,t,i){var r=this;r.kZ=i,r.AZ=new tt(t),r.DZ=new Dn(t),r.xZ=new it(n,"sheet",r.AZ,100,10),r.kZ.aW(r.xZ,!0)}function x(n,t){var t,i,n,t=ht.call(this,t,F.mt.gi(n.Ti))||this,i=t;return i.RAt=32,i.BAt=45,i.f$={},i.Jet=!1,i.Vv=n,n=i.Xc(),(i.LAt=n).addClass("gc-toolstrip-default ui-state-default well"),n.appendTo(i.qc()),n.hide(),i.FAt(),i.PAt(),i.aY(),t}function hi(n){var n=n.WL,t=!1;return n&&n.QP().forEach(function(n){n&&n.isSelected()&&(t=!0)}),t}function vi(n,t,i){var r,e,i,r=c("span"),e=H.body;return r.className=i,r.style.font=n,r.style.cssFloat="left",r.textContent=t,e.insertBefore(r,M),i=O(r).width(),e.removeChild(r),i}function Ai(n,t,i,r,e){this._font="normal 12px Arial";var o=this;o.Zc=n,o._text=t,o.GAt=i,r&&(o.tT=r),e&&(o.UAt=e)}function li(n){function t(){for(var n,t,i,n="separator",t=0,i=n+t.toString();H.getElementById(i);)i=n+(++t).toString();return i}this.Zc=t(),n&&(this.UAt=n)}function E(n){this.jS=n}function wi(n,t,i,r,e){var o=this;o.RS=n,o.HAt=i,o.zAt=t,o.VAt=r,o.YAt=e}function di(){}function k(n){this.w2=n}function pi(n,t,i){var r,e,n,r=this;r.AZ=new tt(r),r.xZ=new it(n,"tabStrip",r.AZ,1,-1),r.kZ=i,r.DZ=new ft(t),e=r.DZ,(n=r.xZ).RZ=function(n){return e.BZ(n)},n.LZ=function(n){return e.FZ(n)},n.PZ=function(n){return e.GZ(n)},n.UZ=function(n){return e.HZ(n)},n.ZAt=function(n){return e.WAt(n)}}function gi(n,t,i,r){var n=n.BO();n.getState(t)?i.drawImage(n.getImage(t),r.x,r.y,U(r),N(r)):n.addImage(t)}function mi(n,t){var i,r,e,o,u,f,f,s,c,a,f,h,v,h,h,h,s,i=n.Fi(),e=16,f=m(n);n.Oi&&0<f.length&&(s=(f=f[f.length-1]).row,c=f.row+f.rowCount-1,a=f.col,f=f.col+f.colCount-1,v="AAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADs",(h=n.parent)&&!h.options.allowUserResize||(-1!==s&&-1===a&&n.getRowResizable(c)?(h=n.C0(c),r=A+v+"MAAA7DAcdvqGQAAABaSURBVDhPY/z//z8DLsDIyAiWBKphBAtgAUxQGgPANIMAMhsdYDUAmwZchtDOC8SCgTcA5DfcgUAEoNwFo7GAPQxwJVtsYYHVBdgU4gpInF5A1oBLMwMDAwMApuAtD6Z7YxQAAAAASUVORK5CYII=",h=N(o=n.getCellRect(c,dt(n,2)-1,h,-1)),bi(n,c,f,o.x,o.y+h,{rowCheck:!0})&&(u=new F.Rect(i.b6-16,o.y+h-8,16,16))):-1===s&&-1!==a&&n.getColumnResizable(f)&&(h=n.S0(f),r=A+v+"IAAA7CARUoSoAAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAE1JREFUOE/ljtEKACAIA/v/nzZ9mFhsJPRocLEuGS4zk/iJyyP/D6gE0wrYoCqoLoUafPl8fEBln3ulSscfErk65TMjMFRBhUowosDWBoHpba8+C7w0"+dn,s=U(o=n.getCellRect(pt(n,1)-1,f,-1,h)),bi(n,c,f,o.x+s,o.y,{colCheck:!0}))&&(u=new F.Rect(o.x+s-8,i.T6-16,16,16)),r&&u&&gi(n,r,t,u)))}function Ci(n){var t,i,r,i,r,e,o,t=M,i=m(n),r=i.length;return n.Oi&&0<r&&(i=i[r-1],r=n.j1(i),t=new F.Rect(r.x+U(r)-(e=17),r.y+N(r),17,o=20)),t}function Mi(n,t,i){var t,i,t,n,i,r,e,o,t=n.C0(t),i=n.S0(i),t=n.dw(t),n=n.yw(i),i=0,r=0,e=0,o=0;return 0<t.length&&(i=t[0].row,r=t[t.length-1].row),0<n.length&&(e=n[0].col,o=n[n.length-1].col),(0,F.Ec)(i,e,r-i+1,o-e+1)}function bi(n,t,i,r,e,o){var u,f,s,u,f,n,t,u=n.C0(t),f=n.S0(i),s,u=n.Fi().c9(u,f),f=Mi(n,t,i),n=f.row<=t&&t<=f.row+f.rowCount-1&&u.y<=e&&e<=u.y+N(u),t=f.col<=i&&i<=f.col+f.colCount-1&&u.x<=r&&r<=u.x+U(u);return o&&o.colCheck?t:(o&&o.rowCheck||t)&&n}function xi(n){var t,i,t,r,e,o,u,f,s,c,a,h,v,A,l,A,w,l,A,l,v,t,d,o,p,g,t=m(n),i=[];if(n.Oi&&0<t.length)for(t=t[t.length-1],r=n.j1(t),e=8,o=n.Fi(),u=t.row,f=t.row+t.rowCount-1,s=t.col,c=t.col+t.colCount-1,-1!==t.row&&-1!==t.col?(bi(n,u,s,r.x,r.y)&&(i[0]=new F.Rect(r.x-8,r.y-8,16,16)),bi(n,f,c,r.x+U(r),r.y+N(r))&&(i[1]=new F.Rect(r.x+U(r)-8,r.y+N(r)-8,16,16))):-1!==t.row?(a=o.c9(1,0),h=o.c9(1,1),v=a.x+(U(a)+U(h))/2-8,A=dt(n)-1-lt(n),(A=(l=n.yw(1)).findCol(A))&&(l=(w=n.yw(0))[0]||l[0])&&(v=l.x+(A.x+U(A)-l.x)/2-8),bi(n,u,s,v+8,r.y,{rowCheck:!0})&&(i[0]=new F.Rect(v,r.y-8,16,16)),bi(n,f,c,v+8,r.y+N(r),{rowCheck:!0})&&(i[1]=new F.Rect(v,r.y+N(r)-8,16,16))):-1!==t.col&&(a=o.c9(0,1),h=o.c9(1,1),A=a.y+(N(a)+N(h))/2-8,l=pt(n)-1-wt(n),(t=(v=n.dw(1)).findRow(l))&&(o=(d=n.dw(0))[0]||v[0])&&(A=o.y+(t.y+N(t)-o.y)/2-8),bi(n,u,s,r.x,A+8,{colCheck:!0})&&(i[0]=new F.Rect(r.x-8,A,16,16)),bi(n,f,c,r.x+U(r),A+8,{colCheck:!0}))&&(i[1]=new F.Rect(r.x+U(r)-8,A,16,16)),p=void 0,g=i.length-1;0<=g;g--)(!(p=i[g])||p.x<0||p.y<0)&&(i[g]=M);return i}function Ei(n,t,i){var r,e,o,u;if((0,F.needPaintSelection)(n)&&!n.isEditing()&&t&&0!==n.selectionPolicy()&&(o=void 0,0<(e=(r=xi(n)).length))){for(i.save(),i.fillStyle=n.aR()||"white",i.strokeStyle=n.getSelectionBorderColor(),u=0;u<e;u++)(o=r[u])&&(i.beginPath(),i.arc(o.x+U(o)/2,o.y+N(o)/2,U(o)/2,0,2*Math.PI,!1),i.fill(),i.stroke());i.restore()}}function ki(n,t){var i,r,i=Ci(n);i&&gi(n,r=A+"EAAAATCAIAAAD5x3GmAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAGhJREFUOE / djkEOwCAIBHk6P98u1lKo1diEU + dggOyAAkC + YPl / Onx3WDmiytm4aulQoKba + 4uiO77YhHDH5SqnRa0If / Nhq0fnjPob2h5oVXJI0rJA3h1ya1kgU4f4nQfVzozk7APgAIEqATZbalz1"+dn,t,i)}T=this&&this.__extends||(at=function(n,t){return(at=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}at(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.QAt=n.NZ=n.IZ=n.TouchToolStripSeparator=n.TouchToolStripItem=n.TouchToolStrip=n.TouchEventHandler=n.ZZ=n.ManipulationStartingEventArgs=n.ManipulationStartedEventArgs=n.ManipulationDeltaEventArgs=n.ManipulationCompletedEventArgs=n.QZ=n.TouchEventProvider=n.SR=void 0,_=y("Common"),F=y("Core"),y=y("./dist/plugins/touch/touch.res.en.js"),n.SR={en:y},I=_.Common.lt.ht,y=F.zc,R=(O=F.GC$).extend,Z=O.isEmptyObject,c=F.mt.En,a=F.mt.vi,D=F.mt.Tt.mozilla,Q=F.I.fl,L=F.mt.pi(),G=L.ipad,r=G||L.iphone,M=null,p=void 0,B=Math.abs,Y=Math.min,z=Math.max,J=Math.pow,K=Math.atan2,o=Math.PI,X=Math.round,V=Math.sqrt,W=Math.atan,q=Math.log,$=Math.floor,nn=100,h="touch",tn="none",rn="MSPointerDown",en="MSPointerMove",on="MSPointerUp",un="pointerdown",fn="pointermove",sn="pointerup",cn="touchstart",an="touchmove",hn="touchend",v="MSPOINTER_TYPE_TOUCH",u=isNaN,vn=parseInt,An=parseFloat,ln=window,H=document,wn=ln.gcGlobal,A="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB",dn="AAAAAElFTkSuQmCC",S=1,F.Of.touch=!0,L=new _.Common.ResourceManager(n.SR,"Touch"),f=L.getResource.bind(L),pn=400,gn=1e3,mn=20,t.prototype.KAt=function(n){this.QTt.KAt=n},t.prototype.JAt=function(n){this.QTt.JAt=n},t.prototype.XAt=function(t){var i=this;i.QTt.XAt=function(n){var n;t&&(t(n),n=i.AZ)&&n.qAt()}},t.prototype.$At=function(n){this.QTt.$At=n},t.prototype.tIt=function(n){this.QTt.tIt=n},t.prototype.nIt=function(n){this.KTt.nIt=n},t.prototype.eIt=function(n){this.KTt.eIt=n},t.prototype.iIt=function(n){this.KTt.iIt=n},t.prototype.rIt=function(n){this.oIt=n},t.prototype.aIt=function(n){this.uIt=n},t.prototype.sIt=function(n,t){var t=(t||this.cIt).RS;return F.mt.T0(n,t)},t.prototype.fIt=function(n,t){var i,r,e,o,u,r,f,r,s,n,e,i=this,r=t.pointerType,e=t.target,o=t.offsetX,u=t.offsetY;r!==t[v]&&r!==h||(f=(r=i.sIt(e,n)).I0,r=r.A0,(s=i.lIt(n,e,t.pointerId,new b(o+f,u+r),t.timeStamp))&&a(t),"sheet"===i.cIt.zAt&&(n=t.pageX-(o+f),e=t.pageY-(u+r),i.cIt.RS.canvasOffset={top:e,left:n}))},t.prototype.hIt=function(n){var t,i,r,i,e,t=this,i=n.pointerType,r=n.pointerId;if(i===n[v]||i===h){if(t.WTt[r]===p)return!1;i=t.sIt(n.target),(e=t.iE(r,new b(n.offsetX+i.I0,n.offsetY+i.A0),n.timeStamp))&&a(n)}},t.prototype.dIt=function(n){var t,i,r,i,e,t=this,i=n.pointerType,r=n.pointerId;if(i===n[v]||i===h){if(t.WTt[r]===p)return!1;i=t.sIt(n.target),(e=t.vIt(r,new b(n.offsetX+i.I0,n.offsetY+i.A0)))&&a(n)}},t.prototype.mIt=function(n){var t,i,r,i,e,t=this,i=n.pointerType,r=n.pointerId;if(i===n[v]||i===h){if(t.WTt[r]===p)return!1;i=t.sIt(n.target),(e=t.gIt(r,new b(n.offsetX+i.I0,n.offsetY+i.A0)))&&a(n)}},t.prototype.pIt=function(n,t){for(var i,r,e,o,u,f,i=gt(n.RS),r=t.changedTouches,e=!1,o=0;o<r.length;o++)u=r[o],f=D?w():t.timeStamp,e=this.lIt(n,t.target,u.identifier,new b(u.pageX-i.I0,u.pageY-i.A0),f)||e;e&&a(t)},t.prototype.bIt=function(n){for(var t,i,r,e,o,u,f,t=this,i=gt(t.cIt.RS),r=n.changedTouches,e=!1,o=0;o<r.length;o++)u=r[o],f=D?w():n.timeStamp,e=t.iE(u.identifier,new b(u.pageX-i.I0,u.pageY-i.A0),f)||e;e&&a(n)},t.prototype.yIt=function(n){for(var t,i,r,e,o,u,t=this,i=gt(t.cIt.RS),r=n.changedTouches,e=!1,o=0;o<r.length;o++)u=r[o],e=t.vIt(u.identifier,new b(u.pageX-i.I0,u.pageY-i.A0))||e;e&&a(n)},t.prototype.wIt=function(n){for(var t,i,r,e,o,u,t=this,i=gt(t.cIt.RS),r=n.changedTouches,e=!1,o=0;o<r.length;o++)u=r[o],e=t.gIt(u.identifier,new b(u.pageX-i.I0,u.pageY-i.A0))||e;e&&a(n)},t.prototype.MIt=function(n){var t,i,t,i,t,t=this,i=t.cIt,t=t.CIt;i!==t&&(i=O(i.RS).offset(),t=O(t.RS).offset(),n.X+=i.left-t.left,n.Y+=i.top-t.top)},t.prototype.SIt=function(n,t){var i,r,e,o,u,f,s,i=this,r=i.j0t;for(i.CIt=M,i.AZ=M,o=0;o<r.length;o++)if(r[o]===n){if(u=r[o],s=f=M,u._Z&&!u._Z()){for(o=0;o<r.length;o++)if((e=r[o])!==u&&0<=e.YAt&&e.YAt<u.YAt&&(!e._Z||e._Z())){f=e;break}if(f===M)return!1}if(u.EZ&&!u.EZ()){for(o=0;o<r.length;o++)if((e=r[o])!==u&&0<=e.YAt&&e.YAt<u.YAt&&(!e.EZ||e.EZ())){s=e;break}if(s===M)return!1}f===M&&(f=u),s===M&&(s=u),i.cIt=u,i.CIt=f,i.TIt=s,i.KAt(s.jZ||M),i.JAt(f.RZ||M),i.tIt(f.LZ||M),i.$At(f.AIt||M),i.XAt(f.PZ||M),i.nIt(s.UZ||M),i.eIt(s.ZAt||M),i.iIt(s.IIt||M),i.rIt(f.oIt||M),i.aIt(f.uIt||M),f.HAt&&(i.AZ=u.HAt);break}return!0},t.prototype.lIt=function(n,t,i,r,e){var o=this;if(o.WTt[i]!==p)return!1;if(0===o.WTt.length&&!o.SIt(n,t))return!1;if(!o.CIt)return!1;if(!(o.WTt.length>=o.CIt.VAt)){if(o.AZ&&o.AZ.xIt())return!1;o.MIt(r),o.AZ&&0===o.WTt.length&&o.AZ.NIt(),o.WTt[i]={id:i,time:w(),position:r},o.WTt.length++,o.QTt.kIt(t,i,r,e),o.QTt.DIt(i,r,o.WTt.length,e),1===o.WTt.length&&o.KTt.DIt(r),1===o.WTt.length&&o.oIt&&o.oIt({JZ:r})}return!0},t.prototype.iE=function(n,t,i){var r=this;return r.WTt[n]!==p&&!(r.AZ&&r.AZ._It()||(r.MIt(t),r.WTt[n]={id:n,time:w(),position:t},r.QTt.EIt(n,t,i),0))},t.prototype.vIt=function(n,t){var i=this;return i.WTt[n]!==p&&(delete i.WTt[n],i.WTt.length--,!(i.AZ&&i.AZ.jIt()||(i.MIt(t),i.QTt.OIt(n),i.QTt.RIt(),0===i.WTt.length&&(i.KTt.OIt(t),i.KTt.RIt()),0===i.WTt.length&&i.uIt&&i.uIt({JZ:t}),i.AZ&&0===i.WTt.length&&0===i.QTt._process&&i.AZ.qAt(),0)))},t.prototype.gIt=function(n,t){return this.vIt(n,t)},t.prototype.aW=function(t,n){var i,r,e,o,u,f,s,c,a,h,v,A,l,r,w,d,e,p,g,m,C,M;function b(){O(H).bind(u,k).bind(f,P).bind(h,k).bind(v,P).bind(s,y).bind(c,y).bind(A,y).bind(l,y)}function x(){O(H).unbind(u).unbind(h).unbind(f).unbind(v).unbind(s).unbind(l).unbind(c).unbind(A)}function E(n){b(),i.fIt(t,n)}function k(n){i.hIt(n)}function P(n){i.dIt(n),0===i.WTt.length&&x()}function y(n){i.mIt(n),0===i.WTt.length&&x()}i=this,r="."+t.zAt,o=rn+(e=".gcSheet"),u=en+e+r,f=on+e+r,s="MSPointerCancel"+e+r,c="MSLostPointerCapture"+e+r,a=un+e,h=fn+e+r,v=sn+e+r,A="LostPointerCapture"+e+r,l="pointercancel"+e+r,r=cn+e,w=an+e,d=hn+e,e="touchcancel"+e,p=t.RS,g=i.j0t,0<=(m=_.Common.Uf.hD(g,t))&&n||m<0&&!n||(C=F.mt.m0(),n?C?(M=p.style,I(M.msTouchAction)||(M.msTouchAction=tn),I(M.touchAction)||(M.touchAction=tn),O(p).bind(o,E).bind(a,E)):(O(p).bind(r,function(n){i.pIt(t,n)}),O(p).bind(w,function(n){i.bIt(n)}).bind(d,function(n){i.yIt(n)}).bind(e,function(n){i.wIt(n)})):C?O(p).unbind(o).unbind(a):O(p).unbind(r).unbind(w).unbind(d).unbind(e),n?g.push(t):g.splice(m,1))},t.prototype.L0=function(){for(var n,t,i,n=this,t=n.j0t,i=t.length-1;0<=i;i--)n.aW(t[i],!1)},Cn=t,n.TouchEventProvider=Cn,i.prototype.kIt=function(n,t,i,r){var e,n,e=this;3===e._process&&e.BIt(!0),e.jAt=2===e._process&&1===e.oAt.LIt(),e.FIt=n,(n={}).rL=t,n.PIt=i,n.GIt=i,e.oAt.UIt(n),e.HIt=r,1<e.oAt.LIt()&&(e.zIt=!1,e.VIt=!1,1===e._process)&&e.YIt()},i.prototype.DIt=function(n,t,i,r){0===this._process&&1===i&&this.ZIt(this.oAt.WIt(0).GIt)},i.prototype.EIt=function(n,t,i){var r,e,e,o,e,u,f,s,r=this;if(0!==r.rAt&&r.oAt.QIt(n)){if(1===r._process&&1===r.oAt.LIt()){if(e=r.KIt(),!r.JIt(1)&&!r.JIt(2)&&!e)return;if(At(t,e=r.oAt.XIt(n).GIt))return;o=B(t.X-e.X),e=B(t.Y-e.Y),r.qIt(o,e)}if(!(i-r.HIt<20)){if(r.oAt.XIt(n).$It=t,1<(u=r.oAt.LIt()))for(f=0;f<u;f++)if(!(s=r.oAt.WIt(f)).$It)return;for(r.txt(i),r.HIt=i,u=r.oAt.LIt(),f=0;f<u;f++)(s=r.oAt.WIt(f)).PIt=s.$It,s.$It=M}}},i.prototype.RIt=function(){var n=this;n.nxt&&(n.ixt(n.nxt),n.nxt=M)},i.prototype.OIt=function(n){var t=this;t.oAt.QIt(n)&&(t.oAt.rxt(n),2===t._process?0===t.oAt.LIt()&&(t.JIt(64)||t.JIt(256)||t.JIt(128)?t.oxt():t.BIt(!0)):3===t._process?t.BIt(!0):1===t._process&&t.BIt(!1))},i.prototype.txt=function(n){var t,i,r,e,o,u,f,f,e,s,c,n,s,e,t=this,f=t.axt(),i=f.uxt,r=f.sxt,f=f.u_,e=t.cxt(),u=e.L0t,o=e.fxt,e=e.hAt;t.qTt+=i,t.$Tt+=r,t.tAt*=o,t.nAt+=u,t.eAt+=e,(s={}).hAt=e,s.L0t=u,s.lxt=n-t.HIt,s.uxt=i,s.sxt=r,t.uAt.hxt(s),t.dxt=f,1!==t._process&&2!==t._process||1===t._process&&(c=t.YIt())||((n=new Fn).CAt=e,n.MAt=u,n.tW=o,n.wAt=new b(i,r),s=new En(t.uAt),e=new Yn(t.FIt,t.vxt(),n,!1,f,s),t.mxt(e),e.gxt&&t.BIt(!0))},i.prototype.YIt=function(){var n,t,n=this;return n._process=2,t=new Sn(n.FIt,n.oAt.LIt(),n.vxt(),n.oAt.WIt(0).GIt),n.pxt(t),!!t.gxt&&(n.BIt(!0),!0)},i.prototype.qIt=function(n,t){var n=xt(n,t);this.zIt=n.JTt,this.VIt=n.XTt},i.prototype.axt=function(){var n,t,i,r,i,e,n=0,t=0,i=this.bxt(),r=i.yxt,i=i.wxt,e=new b(r.X,r.Y);return{uxt:n=r.X-i.X,sxt:t=r.Y-i.Y,u_:e}},i.prototype.cxt=function(){var n,t,i,r,n,n=this,t=0,i=1,r=0;return n.JIt(16)&&1===n.oAt.LIt()&&n.KIt()&&(t=Mt(n.oAt.WIt(0).$It,n.oAt.WIt(0).PIt,n.fMt)),1<n.oAt.LIt()&&(t=(n=n.Mxt()).L0t,i=n.fxt,r=n.hAt),{L0t:t=t/o*180,fxt:i,hAt:r}},i.prototype.Mxt=function(){for(var n,t,i,r,e,o,u,t,f,s,c,a,h,v,A,l,w,l,d,p,g,m,l,w,C,n=this,t=n.bxt(),i=t.yxt,r=t.wxt,e=n.KIt(),o=e?n.fMt._Center:new b(0,0),u=0,t=1,f=0,s=0,c=0,a=0,h=0,v=n.oAt.LIt(),A=0;A<v;A++)w=(l=n.oAt.WIt(A)).$It,l=l.PIt,d=Ct(w,i),p=Ct(l,r),g=e?new b(l.X-o.X,l.Y-o.Y):new b(l.X-r.X,l.Y-r.Y),m=e?new b(w.X-o.X,w.Y-o.Y):new b(w.X-i.X,w.Y-i.Y),l=Ct(l,o),w=Ct(w,o),p>=n.aAt&&d>=n.aAt&&(c++,a+=d,h+=p,!e||l>=n.aAt)&&w>=n.aAt&&(u+=C=mt(g,m),s++);return 0<s&&n.JIt(16)?u/=s:u=0,0<c&&n.JIt(32)?(n.jAt||(t=a/h),f=(a-h)/c,n.Cxt=a/c):n.Cxt=0,{L0t:u,fxt:t,hAt:f}},i.prototype.JIt=function(n){return 0!=(this.rAt&n)},i.prototype.bxt=function(){for(var n,t,i,r,e,o,u,f,s,f,c,a,n=0,t=0,i=0,r=0,e=this.oAt,o=e.LIt(),u=0;u<o;u++)s=(f=e.WIt(u)).PIt,f=f.$It,n+=s.X,t+=s.Y,i+=f.X,r+=f.Y;return c=new b(n/o,t/o),{yxt:a=new b(i/o,r/o),wxt:c}},i.prototype.KIt=function(){var n=this.fMt;return n&&!u(n._Radius)},i.prototype.ZIt=function(n){var t,n,t=this,n=new jn(t.FIt,t.rAt,M,n);return n.KZ=511,t.Sxt(n),t.Txt=n.KZ,0===n.KZ?(t.BIt(!1),!1):(t.rAt=n.KZ,t.fMt=n.DAt,t._process=1,!0)},i.prototype.BIt=function(n){var t,i,n,t=this,i=3===t._process;t._process=0,t.Axt&&(vt(t.Axt),t.Axt=M),n&&(n=new Bn(t.FIt,t.vxt(),i,Pt(t.dxt),new En(t.uAt)),3===t._process?t.nxt=n:t.ixt(n)),t.uAt.Ixt(),t.oAt.Ixt(),t.fMt=M,t.qTt=0,t.$Tt=0,t.tAt=1,t.nAt=0,t.eAt=0,t.zIt=!1,t.VIt=!1,t.rAt=0},i.prototype.oxt=function(){var n,t,i,i,i,n=this,t={},i=new En(n.uAt);t.xxt=n.JIt(64)?i.Nxt().X:0,t.kxt=n.JIt(64)?i.Nxt().Y:0,t.Dxt=n.JIt(256)?i.CAt():0,t._xt=n.JIt(128)?i.Ext():0,0===t.xxt&&0===t.kxt&&0===t.Dxt&&0===t._xt?n.BIt(!0):(t.jxt=new yn(t.xxt,t.kxt),t.IAt=new kn(t.Dxt),t.xAt=new Pn(t._xt),i=new En(M,t.xxt,t.kxt,t._xt,t.Dxt),i=new Hn(n.FIt,n.vxt(),new Fn,i,t.IAt,t.xAt,t.jxt),n.Oxt(i),t.jxt=i.NAt,t.IAt=i.IAt,t.xAt=i.xAt,t.jxt.pAt<=0&&t.jxt.bAt<=0&&t.jxt.Rxt(.003),t.IAt.Bxt()<=0&&t.IAt.Rxt(.002),t.xAt.Bxt()<=0&&t.xAt.Rxt(.003),i=w(),t.Lxt=i,t.Fxt=i,t.Pxt=0,t.Gxt=0,n._process=3,n.Axt=ln.setInterval(function(){try{n.Uxt(t)}catch(n){}},20))},i.prototype.Uxt=function(n){var t,i,r,e,o,u,f,i,e,o,u,r,f,s,e,o,t=this,i=w(),r=i-n.Fxt;if(0!=r){if(e=n.xxt,o=n.kxt,u=n.Dxt,f=n._xt,n.xxt=t.Hxt(r,n.jxt.pAt,n.xxt),n.kxt=t.Hxt(r,n.jxt.bAt,n.kxt),n.Dxt=t.Hxt(r,n.IAt.Bxt(),n.Dxt),n._xt=t.Hxt(r,n.xAt.Bxt(),n._xt),e=(e+n.xxt)/2,o=(o+n.kxt)/2,u=(u+n.Dxt)/2,f=(f+n._xt)/2,n.Fxt=i,i=!1,bt(e)&&bt(o)&&bt(u)&&bt(f)&&(i=!0),e=r*e,o=r*o,u=r*u,r=r*f,f=1,0<t.Cxt&&(t.Cxt+2*u<0&&(u=-t.Cxt/2+1),0!==t.Cxt)&&(f=(t.Cxt+2*u)/t.Cxt),t.eAt+=u,t.nAt+=r,t.qTt+=e,t.$Tt+=o,t.tAt*=f,t.Cxt+=u,t.dxt=new b(t.dxt.X+e,t.dxt.Y+o),n.Pxt+=e,n.Gxt+=o,i){if(e=X(n.Pxt),o=X(n.Gxt),bt(e)&&bt(o))return void t.BIt(!0)}else 1<=B(n.Pxt)&&(e=n.Pxt,n.Pxt-=e),1<=B(n.Gxt)&&(o=n.Gxt,n.Gxt-=o);(s=new Fn).wAt=new b(e,o),s.tW=f,s.CAt=u,s.MAt=r,e=new En(M,n.xxt,n.kxt,n._xt,n.Dxt),o=new Yn(t.FIt,t.vxt(),s,!0,Pt(t.dxt),e),t.mxt(o),(o.gxt||i)&&t.BIt(!0)}},i.prototype.Hxt=function(n,t,i){var t,t;return bt(i)||(t=i<0?i+t*n:i-t*n)<0&&0<i||0<t&&i<0?0:t},i.prototype.vxt=function(){var n,t,n=this,t=new Fn;return t.CAt=n.eAt,t.MAt=n.nAt,t.tW=n.tAt,t.wAt=new b(n.qTt,n.$Tt),t},i.prototype.zxt=function(n,t,i,r){var e,o,u,f,s,c,a,h,v,v,e=this,o=new Fn,u=new Fn,f=0,s=0,c=0,a=0,h=e.JIt(4)&&e.zIt,v=e.JIt(8)&&e.VIt;return!e.JIt(1)||v||n&&!e.JIt(64)||(o.wAt.X=t.wAt.X,u.wAt.X=i.wAt.X,f=r.Nxt().X),!e.JIt(2)||h||n&&!e.JIt(64)||(o.wAt.Y=t.wAt.Y,u.wAt.Y=i.wAt.Y,s=r.Nxt().Y),!e.JIt(32)||n&&!e.JIt(256)?(o.tW=t.tW,u.tW=1):(o.tW=t.tW,o.CAt=t.CAt,u.tW=i.tW,u.CAt=i.CAt,a=r.CAt()),!e.JIt(16)||n&&!e.JIt(128)||(o.MAt=t.MAt,u.MAt=i.MAt,c=r.Ext()),v=new En(M,f,s,c,a),new On(o,u,v)},i.prototype.Sxt=function(n){this.KAt&&n&&this.KAt(n)},i.prototype.pxt=function(n){this.JAt&&n&&this.JAt(n)},i.prototype.ixt=function(n){var t,i,t=this;t.XAt&&n&&(i=t.zxt(!1,n.nW,n.nW,n.TAt),n.nW=i.nW,n.TAt=i.TAt,t.XAt(n))},i.prototype.Oxt=function(n){var t,i,t=this;t.$At&&n&&(i=t.zxt(!1,n.nW,n.SAt,n.TAt),n.nW=i.nW,n.SAt=i.SAt,n.TAt=i.TAt,t.$At(n))},i.prototype.mxt=function(n){var t,i,t=this;t.tIt&&n&&(i=t.zxt(n.AAt,n.nW,n.SAt,n.TAt),n.nW=i.nW,n.SAt=i.SAt,n.TAt=i.TAt,t.tIt(n))},Mn=i,Et.prototype.DIt=function(n){var t,i,t=this;t.Vxt++,1<t.Vxt||(i=w(),t.Yxt&&At(n,t.Yxt)&&i-t.Zxt<pn?t.DU++:(t.Yxt=n,t.DU=1),t.Wxt=n,t.Zxt=i)},Et.prototype.RIt=function(){var n=this;n.nxt&&(n.nxt instanceof Nn?n.Qxt(n.nxt):n.nxt instanceof Un&&n.Kxt(n.nxt),n.nxt=M)},Et.prototype.OIt=function(n){var t,i,t=this;t.Vxt--,0<t.Vxt||(i=w(),At(n,t.Wxt)?i-t.Zxt>gn?t.nxt=new Un(t.Wxt):1<t.DU?(t.DU=0,t.Jxt(new Tn(t.Yxt)),t.Yxt=M):t.nxt=new Nn(t.Wxt):t.Yxt=M)},Et.prototype.Xxt=function(){this.Yxt=M},Et.prototype.Qxt=function(n){this.nIt&&n&&this.nIt(n)},Et.prototype.Jxt=function(n){this.eIt&&n&&this.eIt(n)},Et.prototype.Kxt=function(n){this.iIt&&n&&this.iIt(n)},bn=Et,b=kt,n.QZ=b,e.prototype.qxt=function(n){var t,i,r,e,o,u,o,t=this;if(0===t.DU)return 0;for(i=0,r=(1+t.DU)*t.DU/2,e=t.DU-1;0<=e;e--)o=0,u=t.$xt(e),0===n?o=u.uxt:1===n?o=u.sxt:2===n?o=u.hAt:3===n&&(o=u.L0t),o=t.tNt(o,u.lxt),i+=o*=e+1;return i/r},e.prototype.tNt=function(n,t){return n/t},e.prototype.$xt=function(n){return this.cAt[this.nNt(n)]},e.prototype.eNt=function(){return this.cAt[this.DU-1]},e.prototype.hxt=function(n){var t,i,r,t=this;for(10===t.DU&&t.iNt(),t.DU++,t.cAt[t.nNt(t.DU-1)]=n,i=20*t.sAt,r=0;r<t.DU;r++)n.lxt-t.cAt[r].lxt>i&&(t.iNt(),r--)},e.prototype.iNt=function(){var n=this;n.ak++,n.ak===n.sAt&&(n.ak=0),n.DU--},e.prototype.Ixt=function(){this.DU=0},e.prototype.nNt=function(n){return(this.ak+n)%this.sAt},xn=e,yt.prototype.Nxt=function(){var n=this;return n.fAt||(n.fAt=new b(n.cAt.qxt(0),n.cAt.qxt(1))),n.fAt},yt.prototype.Ext=function(){var n=this;return I(n.lAt)&&(n.lAt=n.cAt.qxt(3)),n.lAt},yt.prototype.CAt=function(){var n=this;return I(n.hAt)&&(n.hAt=n.cAt.qxt(2)),n.hAt},En=yt,Ft.prototype.Bxt=function(){var n=this,t=n._DesiredExpansion,i=n._DesiredDeceleration,r=n.dAt;return u(t)||0===t?u(i)?n.vAt:i:.5*r*r/t},Ft.prototype.Rxt=function(n){this.vAt=n},kn=Ft,It.prototype.Bxt=function(){var n=this,t=n._DesiredRotation,i=n._DesiredDeceleration,r=n.dAt;return u(t)||0===t?u(i)?n.vAt:i:.5*r*r/t},It.prototype.Rxt=function(n){this.vAt=n},Pn=It,Ot.prototype.rNt=function(){var n=this,t=n._DesiredDisplacement,i=n.yAt,r=n.mAt,e=n.gAt,o=n.Bxt();u(t)||0===t?u(o)||0===o?(n.pAt=0,n.bAt=0):(n.pAt=o*B(r)/i,n.bAt=o*B(e)/i):(n.pAt=.5*i*B(r)/t,n.bAt=.5*i*B(e)/t)},Ot.prototype.Bxt=function(){var n=this,t=n._DesiredDeceleration;return u(t)&&u(n._DesiredDisplacement)?n.vAt:t},Ot.prototype.Rxt=function(n){this.vAt=n,this.rNt()},yn=Ot,Fn=Bt,Yt.prototype.QIt=function(n){for(var t,i,r,t=this.wY,i=0;i<t.length;i++)if((r=t[i]).rL===n)return!0;return!1},Yt.prototype.UIt=function(n){this.wY.push(n)},Yt.prototype.rxt=function(n){for(var t,i,t=this.wY,i=0;i<t.length;i++)if(t[i].rL===n){t.splice(i,1);break}},Yt.prototype.LIt=function(){return this.wY.length},Yt.prototype.WIt=function(n){return this.wY[n]},Yt.prototype.XIt=function(n){for(var t,i,r,t=this.wY,i=0;i<t.length;i++)if((r=t[i]).rL===n)return r;return M},Yt.prototype.Ixt=function(){var n=this.wY;n.splice(0,n.length)},In=Yt,On=Ht,Bn=St,n.ManipulationCompletedEventArgs=Bn,Yn=jt,n.ManipulationDeltaEventArgs=Yn,Hn=Nt,Sn=Ut,n.ManipulationStartedEventArgs=Sn,jn=Tt,n.ManipulationStartingEventArgs=jn,Nn=_t,Un=Rt,Tn=Zt,Qt.prototype.oNt=function(n,t){var i=this.fg;return i?n===F.Bf.Xl(i)&&t===F.Bf.ql(i)||F.Bf.$l(i,n,t):(i=c("canvas"),F.Bf.Wl(i,M,this.Mf),F.Bf.$l(i,n,t)),i},Qt.prototype.aNt=function(n,t,i,r){var e,o,u,o,u,f,s,e=this,o=F.Bf.Xl(n),u=F.Bf.ql(n),o=e.oNt(o,u),u=o.getContext("2d"),f=F.Bf.Kl(o),s=F.Bf.Jl(o);F.Lf.Vl(u,1,1),u.drawImage(n,0,0,U(o),N(o),0,0,U(o),N(o)),F.Lf.Vl(u,f,s),e.fg=o,e.uNt=t,e.sNt=i,e.cNt=r},Qt.prototype.fNt=function(n,t,i){var r,e,o,i,u,e,f,s,c,a,u,o,h,v,A,l,w,d,p,g,t,m,C,n,r,i,u,r=this,e=r.Mf,u=F.Bf.Xl(n),o=F.Bf.ql(n),h=lt(e),v=wt(e),A=0<h?1:0,l=0<v?1:0,w=r.sNt,d=qt(e),p=r.uNt,g=e.Fi(),t=t/r.cNt,m=n.getContext("2d"),C=F.Bf.Kl(n),n=F.Bf.Jl(n),r=r.fg;m.save(),m.fillStyle=i,m.fillRect(0,0,u,o),i=e.rowOutlines,u=e.columnOutlines,i&&i._e(e,m,M,!0),u&&u._e(e,m,M,!1),o=w.x+U(w),i=w.y+N(w),u=p.Hy-o-A,e=p.Ay-i-l,f=d.x+U(d),s=d.y+N(d),c=u*t,a=e*t,o*=C,i*=n,u*=C,e*=n,f*=C,s*=n,c*=C,a*=n,F.Lf.Vl(m,1,1),m.drawImage(r,o,i,u,e,f,s,c,a),0<h&&(o=p.Hy-A,i=w.y+N(w),u=p.zy+A,e=p.Ay-i-l,f=g.Hy-A,s=d.y+N(d),c=g.zy+A,a=e*t,m.drawImage(r,o*=C,i*=n,u*=C,e*=n,f*=C,s*=n,c*=C,a*=n)),0<v&&(o=w.x+U(w),i=p.Ay-l,u=p.Hy-o-A,e=p.Iy+l,f=d.x+U(d),s=g.Ay-l,c=u*t,a=g.Iy+l,m.drawImage(r,o*=C,i*=n,u*=C,e*=n,f*=C,s*=n,c*=C,a*=n)),0<h&&0<v&&(o=p.Hy-A,i=p.Ay-l,u=p.zy+A,e=p.Iy+l,f=g.Hy-A,s=g.Ay-l,c=g.zy+A,a=g.Iy+l,m.drawImage(r,o*=C,i*=n,u*=C,e*=n,f*=C,s*=n,c*=C,a*=n)),F.Lf.Vl(m,C,n),m.restore()},Qt.prototype.$Z=function(){var n,t,i,r,n=this,t=n.Mf,i=t.zoom(),r=t.Dn._7();r&&n.aNt(r.canvas,t.Fi(),qt(t),i)},Qt.prototype.iW=function(n){var t,i,n,r,e,o,o,e,t=this,i=t.Mf;i.endEdit()&&(n=Dt(n,t.cNt),r=i.zoom(),e=i.name(),r!==n)&&(i.ki(F.Events.ViewZooming,o={sheet:i,sheetName:e,oldZoomFactor:r,newZoomFactor:n,cancel:!1}),!0!==o.cancel)&&(i.g8(n=o.newZoomFactor),i.ki(F.Events.UserZooming,{sheet:i,sheetName:e,oldZoomFactor:r,newZoomFactor:n}),i.ki(F.Events.ViewZoomed,{sheet:i,sheetName:e,oldZoomFactor:r,newZoomFactor:n}),i.invalidateLayout(),(e=(o=i.Dn).J())&&t.fNt(e.canvas,n,o.R7(!1)),i.oht&&i.oht(M,n),i.CW)&&i.CW(M)},Qt.prototype.rW=function(n){var t,i,r,n,t,e,t=this,i=t.Mf,r=i.name(),n=Dt(n,t.cNt),t=i.zoom();if(n!==t){if(i.ki(F.Events.ViewZooming,e={sheet:i,sheetName:r,oldZoomFactor:t,newZoomFactor:n,cancel:!1}),!0===e.cancel)return;i.g8(n=e.newZoomFactor),i.ki(F.Events.UserZooming,{sheet:i,sheetName:r,oldZoomFactor:t,newZoomFactor:n}),i.ki(F.Events.ViewZoomed,{sheet:i,sheetName:r,oldZoomFactor:t,newZoomFactor:n})}i.Zw=!0,i.Ww=!0,i.zw()},_n=Qt,n.ZZ=_n,j=200,Rn=20,s.prototype.lNt=function(n){var t;this.Mf.my=n,this.tbe=!0},s.prototype.hNt=function(n){var t;this.Mf.ly=n,this.nbe=!0},s.prototype.dNt=function(){var n;this.Mf.invalidateLayout()},s.prototype.yy=function(n,t,i,r,e){var o,u,f,s,c,a,h,v,a,A,l,w,d,p,g,m,A,C,M,b,f,x,E,k,P,P,k,E,P,y,F,h,o=this,u=o.Mf,f=u.options,s,c,a=Lt(u,n,u.Tb,u.ly);if(a&&(h=a.Ky,v=a.Xy,n=a._At,u.Tb=h,!(0<u.My)))if(a=u.ot(),l=(A=u.Fi()).Cy,w=u.Sy(A),d=A.Iy,p=A.Ay,g=A.Ty,m=(a||A).x,A=U(A),f=f.sheetAreaOffset,x=u.Ny,A+=f.left,n<0)o.vNt=0,k=E=void(o.mNt=0),(E=(P=u.dw(1))&&0<P.length?P.findRow(h):E)&&(k=P[P.length-1]).row>=h&&(C=2+f.top,M=l+B(n),0<=(b=Y(l+w,k.y+N(k))-M))&&(b-=C,o.hNt(v-N(E)),i.x=m,i.y=M,i.width=A,i.height=b,i.tx=m,i.ty=l,P=x?w:w+d+g,r.x=m,r.y=l+b,r.width=A,r.height=P-b);else if(0<n){if(k=u.vw(-1),P=E=void 0,(y=u.parent&&u.parent.options.scrollByPixel)&&0<v&&(n-=v,v=0),h===k&&0<v){if(0<o.vNt&&0<o.mNt){if(v=P=zt(E=o.vNt+n,j),(n=P-o.mNt)<=0)return t;if(t&&20<=P)return!0}else{if(j<=v&&(n-=v-199,v=199,n<=0))return t;if(E=Jt(v,j),P=v,t&&20<=P)return!0}o.vNt=E,o.mNt=P}else o.vNt=0,o.mNt=0;n<(F=x?w:w+d)&&(C=2+f.top,M=l,b=w-n,0<wt(u)&&(b-=S),o.hNt(v),!x&&0<g&&(h=Y(a.height-d-S,p-S+n),e.x=m,e.y=p-S,e.width=A,e.height=d+S,e.tx=m,e.ty=h),i.x=m,i.y=M,i.width=A,i.height=b+(x?0:Y(n,g)-S),i.tx=m,i.ty=M+n,r.x=m,r.y=M,r.width=A,r.height=n+C)}return!1},s.prototype.wy=function(n,t,i,r,e){var o,u,f,s,c,a,h,c,v,A,l,w,d,p,g,v,m,C,M,b,x,E,k,P,y,F,F,y,I,O,P,F,o=this,u=o.Mf,f,s,c=Gt(u,n,u.Ab,u.my);if(c&&(a=c.iw,h=c.Xy,n=c.EAt,u.Ab=a,!(0<u.My)))if(c=u.ot(),A=(v=u.Fi()).Py,l=u.Gy(v),w=v.zy,d=v.Hy,p=v.Uy,g=(c||v).y,v=N(v),E=u.options.sheetAreaOffset,k=u.Vy,v+=E.top,n<0)o.gNt=0,y=P=void(o.pNt=0),(P=(F=u.yw(1))&&0<F.length?F.findCol(a):P)&&(y=F[F.length-1]).col>=a&&(m=2+E.left,C=A+B(n),0<=(M=Y(A+l,y.x+U(y))-C))&&(M-=m,o.lNt(h-U(P)),i.x=C,i.y=g,i.width=M,i.height=v,i.tx=A,i.ty=g,F=k?l:l+w+p,r.x=A+M,r.y=g,r.width=F-M,r.height=v);else if(0<n){if(y=u.ww(-1),(I=u.parent&&u.parent.options.scrollByPixel)&&0<h&&(n-=h,h=0),a===y&&0<h){if(0<o.gNt&&0<o.pNt){if(h=x=zt(b=o.gNt+n,j),(n=x-o.pNt)<=0)return t;if(t&&20<=x)return!0}else{if(j<=h&&(n-=h-199,h=199,n<=0))return t;if(b=Jt(h,j),x=h,t&&20<=x)return!0}o.gNt=b,o.pNt=x}else o.gNt=0,o.pNt=0;n<(O=k?l:l+w)&&(m=2+E.left,C=A,M=l-n,0<lt(u)&&(M-=S),o.lNt(h),P=0,!k&&0<p&&(F=Y(c.width-(P=w)-S,d-S+n),e.x=d-S,e.y=g,e.width=P+S,e.height=v,e.tx=F,e.ty=g),i.x=C,i.y=g,i.width=M+(k?0:Y(n,p)-S),i.height=v,i.tx=C+n,i.ty=g,r.x=C,r.y=g,r.width=n+m,r.height=v)}return!1},s.prototype.bNt=function(n,t,i,r){var e,o,u,f,s,c,t,a,h,v,A,i,h,l,w,d,p,g,w,d,h,m,C,M,b,x,t,m,C,M,b,x,n,r,l,t,m,C,M,b,x,e=this,o=e.Mf,u=!0,f=!0,s=o.Dn,c=s.J(),A=0!=(2&i),i=0!=(1&i);if(i||A)return h={},l={},w=o.ot(),d=o.Fi(),p=(w||d).y,g=N(d),w=(w||d).x,d=U(d),A&&(u=e.yy(t,r,t={},a={},h),m=h.y,C=U(h),M=N(h),b=h.tx,x=h.ty,I(h=h.x)||s.Ey(h,m,C,M,b,x),s.Ey(t.x,t.y,U(t),N(t),t.tx,t.ty)),i&&(f=e.wy(n,r,h={},v={},l),m=l.y,C=U(l),M=N(l),b=l.tx,x=l.ty,I(t=l.x)||s.Ey(t,m,C,M,b,x),s.Ey(h.x,h.y,U(h),N(h),h.tx,h.ty),A||(a=v)),(n=o.parent)&&!n.options.scrollbarShowMax&&(i&&(o.Zw=!0),A)&&(o.Ww=!0),e.dNt(),r=o.rowOutlines&&!o.rowOutlines.Oy()?1:0,l=o.columnOutlines&&!o.columnOutlines.Oy()?1:0,i&&A?s.D1(c,new F.Rect(a.x,a.y,U(a),N(a)+r),new F.Rect(v.x,v.y,U(v)+l,N(v))):s.D1(c,new F.Rect(a.x,a.y,U(a)+l,N(a)+r)),t=new F.Rect(w,p,d,g),(m=o.getSelections())&&0<m.length&&(C=o.getRangeRect(1,1,m[0]),M=z(t.x+t.width,C.x+C.width),b=z(t.y+t.height,C.y+C.height),t.x=Y(t.x,C.x),t.y=Y(t.y,C.y),t.width=M-t.x+1,t.height=b-t.y+1),s.O1(t),s.jy(c,t),ni(o,!0),Vt(o,!0),e.yNt(i,A),$t(o,!0),x=o.options.sheetAreaOffset,o.options.rowHeaderVisible||s.q7(c,new F.Rect(w,p,2,g+x.top)),o.options.colHeaderVisible||s.q7(c,new F.Rect(w,p,d+x.left,2)),u&&f},s.prototype.yNt=function(n,t){var i=this.Mf;t&&i.tw(),n&&i.ow(),i.rt.By()},s.prototype.wNt=function(e,o,u){function f(n,t,i,r){return J(.75,n/=i)*r*(t?1:-1)}function n(n,t,i){return n=B(n),q(n/=i)/q(.75)*t}var s=this,c=s.Mf,a=j,t=10,i=20,h=100,v=n(e,10,a),A=n(o,10,a),l=e,w=o,d=0,p=0,g=!1,m=!1;s.H6=ln.setInterval(function(){var n,n,t,i,r;g&&m?(c.Jt.Rl(),(n=c.parent)&&!n.options.scrollbarShowMax&&(c.Zw=!0,c.Ww=!0),c.Jt.Bl(),c.ly=0,c.my=0,c.zw(),c.ow(),c.tw(),vt(s.H6),s.H6=M):(A+=20,h<(v+=20)&&h<A?(s.bNt(e-d,o-p,ti(g,m),u),m=g=!0):(h<v&&!g&&(s.bNt(e-d,0,1,u),g=!0),h<A&&!m&&(s.bNt(0,o-p,2,u),m=!0),n=f(v,0<e,10,a),t=f(A,0<o,10,a),i=$(l-n),r=$(w-t),s.bNt(i,r,ti(g,m),u),l=n,w=t,d+=i,p+=r))},20)},s.prototype.Ok=function(n){var t=this,i=t.Mf,r=i.Jt;t.H6&&(r.Bl(),vt(t.H6),t.H6=M),t.tbe=!1,t.nbe=!1,t.ebe=i.my,t.ibe=i.ly,t.gNt=0,t.pNt=0,t.vNt=0,t.mNt=0,t.MNt=i.Tb,t.CNt=i.Ab,n&&r.jl()},s.prototype.a9=function(n,t){var i,r,e,o,u,f,e,s,n,c,i,r,e=this.Mf.parent,o=e.options.scrollbarAppearance===F.ScrollbarAppearance.mobile,u=e.Xb,f=e.zb,e=e.ib,s=vn(n.X+""),n=vn(n.Y+""),c=ii(s,n);return o&&(0!==n&&(u.qy(F.ScrollbarState.show),e.$y(!0)),0!==s)&&(f.qy(F.ScrollbarState.show),e.$y(!1)),this.bNt(s,n,c,t)},s.prototype.SNt=function(n){var t,i,r,e,o,u,f,s,c,s,a,h,v,A,v,l,w,d,w,p,t=this,i=t.Mf,r=t.MNt,e=i.Tb,o=t.CNt,u=i.Ab,f;i.parent&&i.parent.options.scrollByPixel?(i.Jt.Bl(),i.zw(),t.TNt(),t.tbe=M,t.nbe=M,t.ebe=M,t.ibe=M):(c=(s=i.Fi()).Py,s=s.Cy,a=i.yw(1),v=i.Mw().iw,A=1,a&&0<a.length&&(h=a.findCol(u),u<v&&h&&h.x+U(h)-c<U(h)/2?u++:A=-1),v=i.dw(1),w=i.mw().Ky,d=1,v&&0<v.length&&(l=v.findRow(e),e<w&&l&&l.y+N(l)-s<N(l)/2?e++:d=-1),p=w=0,a&&0<a.length&&(w=c-(h=a.findCol(u)).x),v&&0<v.length&&(p=s-(l=v.findRow(e)).y),e!==r&&i.$A(e,0,r),u!==o&&i.o9(u,0,o),t.wNt(w*=A,p*=d,n))},s.prototype.TNt=function(){var n,t,i,r,e,o,u,n=this,t=n.Mf,i=n.MNt,r=t.Tb,e=n.CNt,o=t.Ab,u=t.zoom();i===r&&!n.nbe||t.ki(F.Events.TopRowChanged,{sheet:t,sheetName:t.name(),oldTopRow:i,newTopRow:r,oldOffset:B(n.ibe/u),newOffset:B(t.ly/u)}),e===o&&!n.tbe||t.ki(F.Events.LeftColumnChanged,{sheet:t,sheetName:t.name(),oldLeftCol:e,newLeftCol:o,oldOffset:B(n.ebe/u),newOffset:B(t.my/u)})},Zn=s,g.prototype.OZ=function(n){var t,i,r,e,o,u,f,s,r,c,a,h,v,t,c,A,l,t=this,i=t.Mf,r=i.Fi(),e=r.Py,o=r.Cy,u=r.J7,f=r.X7,s=r.Hy,r=r.Ay,c=n.JZ,a=i.Ny,h=i.Vy,v=0,t=t.ANt(c.X,c.Y),c=t.dragInfo,A=t.x,l=t.y;t&&(t.resizeInfo||c&&"corner"===c.side||t.selectionHitInfo)?v|=3:(o<=l&&(a&&l<r||!a&&l<f)&&(v|=2),e<=A&&(h&&A<s||!h&&A<u)&&(v|=1),v|=96,i.parent&&(v|=12)),n.KZ=v},g.prototype.BZ=function(n){var t,i,i,r,e,o,u,i,f,s,f,c,s,a,t=this,i={e:n,r:M};g.et(t,"preProcessManipulationStarted",i),i.r||(i=n.JZ,e=(r=t.Mf).parent,o=r.rt,u=r.Dn,f=(i=t.ANt(i.X,i.Y)).dragInfo,s=i.selectionHitInfo,(r.sw=i).resizeInfo?r.endEdit()&&o.gk(i):f&&"corner"===f.side?o.wk&&o.wk(i):s?r.endEdit()&&(f=s.isHeader,c=s.isFirstIndicator,s=s.type,f&&o.A9(i,!0),a=i.hitTestType,i.hitTestType=s,o.F9(i),i.hitTestType=a,si(r,f,c,s),r.INt=!1,u.PD()):(r.pW&&(r.pW().VW=!1),r.INt=!1,u.PD(),1<n.kAt&&e&&e.options.allowUserZoom?(t.jAt=!1,t.YZ.$Z()):(t.jAt=!0,t.OAt.Ok(1===n.kAt))))},g.prototype.FZ=function(n){var t,i,i,r,e,r,o,i,u,f,r,u,t=this,i={e:n,r:M};g.et(t,"preProcessManipulationDelta",i),i.r||(i=n.JZ,e=(r=t.Mf).rt,r=r.sw,o=i.X,i=i.Y,r&&(u=r.dragInfo,f=r.selectionHitInfo,r.resizeInfo?(e.fk={e:n,x:o,y:i},e.y9()):u&&"corner"===u.side?(e.fk={e:n,x:o,y:i},e.Zk&&e.Zk()):f||e.ob?f&&e.Rk&&e.rb&&!0!==e.FI&&(r=f.type,e.fk={e:n,x:o,y:i},3===r?e.Y9():2===r?e.Z9():1===r&&e.W9()):t.jAt?n.gxt=t.OAt.a9(n.SAt.wAt,n.AAt):(u=n.nW.tW,t.YZ.iW(u))))},g.prototype.GZ=function(n){var t,i,i,r,e,o,e,t=this,i={e:n,r:M};g.et(t,"preProcessManipulationCompleted",i),i.r||(r=(i=t.Mf).rt,i.INt=!0,o=(e=i.sw).selectionHitInfo,e.resizeInfo?r.C9():e.dragInfo&&r.Yk?(r.DD&&r.DD(),i.parent.touchToolStrip.xNt()):o||r.ob?(r.X9(),o&&ci(i,o.isHeader,o.isFirstIndicator,o.type),i.Dn.E1()):(i.pW&&(i.pW().VW=!0),t.jAt?t.OAt.SNt(n.AAt):(e=n.nW.tW,t.YZ.rW(e))))},g.prototype.HZ=function(n){var i,t,t,r,e,n,o,o,u,t,f,s,c,a,h,v,A,v,h,A,a,v,t,t,t,l,l,l,l,w,d,l,t,i=this,t={e:n,r:M};if(g.et(i,"preProcessTapped",t),t.r)i.Mf.repaint();else if(t=n.JZ,r=i.Mf,e=r.parent,n=!1,r.Nk=p,i.NNt(),r.Olt&&r.Olt(),(o=r.Ut.pI)&&o.CZ(),o=r.rt,t=(u=i.ANt(t.X,t.Y,!0)).filterButtonHitInfo,f=u.hitTestType,s=u.row,c=u.col,a=u.outlineHitInfo)r.isEditing()||(h=a.what,v=r.rowOutlines,A=r.columnOutlines,"rg"===h||"rgh"===h?v&&v.rpt(r,a):"cg"!==h&&"cgh"!==h||A&&A.rpt(r,a));else if(r.sw=u,t)r.endEdit()&&(v=t.rowFilter)&&v.openFilterDialog(t);else if(!u.resizeInfo&&r.JA(u.rowViewportIndex<0?-1:s,u.colViewportIndex<0?-1:c)){if(r.kNt&&!o.Yk&&e.touchToolStrip.xNt(),h=r.getActiveRowIndex(),A=r.getActiveColumnIndex(),a=u.cellTypeHitInfo){if(v=r.getCellType(a.row,a.col,f),a.sheet||(a.sheet=r),i.xk(v,a))if(t=a.sheetArea,!I(t)&&3!==t||s===h&&c===A)r.Dn.PD();else{if(r.suspendPaint(),!r.endEdit())return;if(t={sheet:r,sheetName:r.name(),row:h,col:A,cancel:!1},r.ki(F.Events.LeaveCell,t),!0===t.cancel)return;t=r.Ut.getSelections(),l=r.Ut.getSpan(s,c),l=[(0,F.Ec)(l.row,l.col,l.rowCount,l.colCount)],r.EA(t,l),r.ki(F.Events.FloatingElementSelected,{type:"worksheet"}),l=a.isReservedLocation&&a.isFocusAware,r.t4(s,c,p,p,l?0:1),l={sheet:r,sheetName:r.name(),row:s,col:c},r.ki(F.Events.EnterCell,l),r.ki(F.Events.EnterCellInternal,l),r.jA(t),r.Nk=!0,o.PA&&o.PA(s,c),r.resumePaint(),n=!0}v.processCellAndPaddingMouseDown(a),v.Ve(a)}if(a&&a.isReservedLocation)return!0;a&&(a.cellButtonHitInfo||a.outlineColumnHitInfo)&&(n=!0),r.ki(F.Events.CellClick,{sheet:r,sheetName:r.name(),sheetArea:f,row:u.row,col:u.col});try{if(o.Dk=u,w=r.isEditing(),d=r.endEdit(),r.Oi&&G&&w&&d&&(o.shift=!1),w&&h===r.getActiveRowIndex()&&A===r.getActiveColumnIndex()&&!d)return}finally{o.Dk=M}I(s)||I(c)||(3===f&&o.PA&&o.PA(s,c),ui(r,s,c,f)&&!n?i.DNt=ln.setTimeout(function(){var n,t,n={x:u.x,y:u.y,handled:!1},t=e.touchToolStrip;r.ki(F.Events.TouchToolStripOpening,n),n.handled||t.open(u.x,u.y-nn),i.NNt()},420):(r.ki(F.Events.FloatingElementSelected,{type:"worksheet"}),l=r.Ut.getSelections(),o.A9(u),t=r.Ut.getSelections(),r.EA(l,t),o.X9()))}},g.prototype.xk=function(n,t){return!(n&&n.activeOnClick&&!n.activeOnClick()&&t.isReservedLocation)},g.prototype._Nt=function(n,t){var i,r,i,n,t,e,o,i=this,r=i.Mf,i=i.ANt(n,t,!0);i&&0<=i.row&&0<=i.col&&0<=i.rowViewportIndex&&0<=i.colViewportIndex&&!i.resizeInfo&&r.JA(i.row,i.col)&&((n=r.isCtrlPressed(i.hitTestType))||r.IA(),t=r.C0(i.row),e=r.S0(i.col),o=!0,r.ui===i.row&&r.ci===i.col||(o=!1),r.O6(i.row,i.col,t,e,o),n?r.zw():r.n4(i.row,i.col,1,1),r.rt.S_(!1,!0),r.f6(r.Dg(),i.row,i.col))},g.prototype.WAt=function(n){var t,i,i,n,r,e,t=this,i={e:n,r:M};g.et(t,"preProcessDoubleTapped",i),!i.r&&(i=t.Mf,n=n.JZ,t.NNt(),r=i.sw)&&(e=!1,3===r.hitTestType?t._Nt(n.X,n.Y):e=i.rt.j_(r),e||i.ki(F.Events.CellDoubleClick,{sheet:i,sheetName:i.name(),sheetArea:r.hitTestType,row:r.row,col:r.col}))},g.prototype.ENt=function(n){var t,i,n,r,r,t=this,i=t.Mf,n=n.JZ,r=t.ANt(n.X,n.Y);i.isEditing()?r.row===i.ui&&r.col===i.ci||i.rt.C_(r):(t._target=r,(r=t.ANt(n.X,n.Y,!0))&&r.cellTypeHitInfo&&r.cellTypeHitInfo.isEditing||i.rt.C_(r))},g.prototype.jNt=function(n){var t,i,t,r,e,e,t=this,i=t.Mf;!i.isEditing()&&(r=!0,r=(!(t=t._target)||!((e=t.cellTypeHitInfo)&&e.isReservedLocation||(e=i.getCellType(t.row,t.col))&&e.isEditing()))&&r)&&i.rt.S_(!0)},g.prototype.ANt=function(n,t,i){var r,e,o,u,f,s,u,f,s,s,u,f,c,a,f,f,f,r,e=this.Mf;return e.Fi(),o={x:n,y:t,rowViewportIndex:M,colViewportIndex:M,row:-1,col:-1,resizeInfo:M,hitTestType:M,outlineHitInfo:M,filterButtonHitInfo:M,dragInfo:M,cellTypeHitInfo:M,selectionHitInfo:M},u=e.rowOutlines,f=e.columnOutlines,(s=!(s=u?u.hitTest(e,n,t):s)&&f?f.hitTest(e,n,t):s)?o.outlineHitInfo=s:(f=u=void 0,u=e.FL(t),f=e.PL(n),o.rowViewportIndex=u,o.colViewportIndex=f,o.row=e.GL(t,u),o.col=e.UL(n,f,t,u,o.row),0<=u&&u<=2&&0<=f&&(s=e.O_(u,f,p,o.row,o.col))&&(o.row=s.row,o.col=s.col),o.hitTestType=e.C6(u,f),a=c=f=u=s=void 0,s=ri(e,o,n,t,10),c=(c=(f=e.IB)&&f.hitTest(o,n,t))||(f=(f=(f=e.tables)&&f.find(o.row,o.col))&&f.IB)&&f.hitTest(o,n,t),e.kNt?(u=oi(e,o,n,t),o.dragInfo=u):s?o.resizeInfo=s:c?o.filterButtonHitInfo=c:i?o.cellTypeHitInfo=e.JL(o,n,t):(a=ei(e,o,n,t),o.selectionHitInfo=a)),o},g.prototype.NNt=function(){var n=this,t=n.DNt;t&&(clearTimeout(t),n.DNt=M)},Dn=g,n.TouchEventHandler=Dn,(0,F.$e)(Dn),ai.prototype.oW=function(){var n,t,n,n=this,t=n.DZ,n=n.xZ;n.jZ=function(n){return t.OZ(n)},n.RZ=function(n){return t.BZ(n)},n.LZ=function(n){return t.FZ(n)},n.PZ=function(n){return t.GZ(n)},n.UZ=function(n){return t.HZ(n)},n.ZAt=function(n){return t.WAt(n)},n.oIt=function(n){return t.ENt(n)},n.uIt=function(n){return t.jNt(n)}},ai.prototype.uW=function(){var n=this,t=n.xZ;t&&(n.kZ.aW(t,!1),t.jZ=M,t.RZ=M,t.LZ=M,t.AIt=M,t.PZ=M,t.UZ=M,t.ZAt=M,t.IIt=M,t.oIt=M,t.uIt=M,n.xZ=M)},ai.prototype.sW=function(n){return this.AZ.sW()},ai.prototype.cW=function(n){return this.AZ.cW()},ai.prototype.fW=function(n){return this.AZ.fW()},Qn=ai,Ln="gc-toolstrip-button",Gn="gc-toolstrip-text",zn="gc-toolstrip-image",Jn="gc-toolstrip-item",Kn="gc-touch-sperate-line",Xn="height",Vn="width",l="px",Wn="button",T(x,ht=y),x.prototype.open=function(n,t){var i,r,e,o,u,f,i=this,r=d(i.Vv);if(r&&(F.hi.F1(M,!0),i.LAt.css({left:n,top:t}),i.$c(),i.Jet=!0,i.if(),!Z(i.f$)))for(o in e=i.f$)e.hasOwnProperty(o)&&((f=!(u=e[o]).UAt||u.UAt.call(i))?O("#"+o).show():O("#"+o).hide())},x.prototype.add=function(n){var t,i,r,r;n&&(i=(t=this).f$,n instanceof nt?(r=n.name())&&(i[r]=n,t.ONt(n.RNt(Kn,t.BAt+l))):n instanceof $n&&(r=n.name(),t.getItem(r)||(i[r]=n,t.ONt(n.RNt(zn,t.RAt+l,Gn,Ln)))))},x.prototype.getItem=function(n){return this.f$[n]},x.prototype.getItems=function(){var n,t,i,r,n,t=[],i=this.f$;if(Z(i))return M;for(r in i)i.hasOwnProperty(r)&&t.push(i[r]);return t},x.prototype.remove=function(n){var t,i,t=this;return t.getItem(n)?(O("#"+n).parent().remove(),i=t.f$[n],delete t.f$[n],i):M},x.prototype.clear=function(){var n=this;n.LAt&&(n.LAt.find("td."+Jn).remove(),n.f$={})},x.prototype.close=function(){var n,n,t,n=this;wn.cf(),n.LAt&&n.LAt.hide(),n.Jet=!1,n.uf(),(n=d(n.Vv))&&(n.Zg(),0<(t=m(n)).length)&&!n.kNt&&-1===t[0].row&&-1===t[0].col&&n.IA()},x.prototype.imageAreaHeight=function(n){var t=this;return 0===arguments.length?t.RAt:(0<n&&(t.RAt=n,t.LAt.find("span."+zn).css(Xn,n+l)),t)},x.prototype.itemHeight=function(n){var t=this,i=t.LAt.find("button."+Ln);return 0===arguments.length?An(i.css(Xn)):(0<n&&i.css(Xn,n+l),t)},x.prototype.itemWidth=function(n){var t,i,r,e,t=this,i=t.LAt.find("button."+Ln);return 0===arguments.length?An(i.css(Vn)):(0<n&&(n<(e=An(i.css(r="min-width")))&&i.css(r,n+l),i.css(Vn,n+l)),t)},x.prototype.separatorHeight=function(n){var t=this;return 0===arguments.length?t.BAt:(0<n&&(t.BAt=n,t.LAt.find("div."+Kn).css(Xn,n+l)),t)},x.prototype.FAt=function(){var n,t,n,n="table",t=this,n=O(c(n)).css({padding:0,display:n}).attr({cellspacing:0,cellpadding:0});t.BNt=O(c("tr")).appendTo(n),n.appendTo(t.LAt)},x.prototype.L0=function(){var n=this,t=n.LAt;t&&(n.Jet&&(wn.cf(),n.uf()),t.unbind("click"),t.remove(),n.LAt=M)},x.prototype.aY=function(){var r=this;r.LAt.bind("click",function(n){var n,t,i,n,n,n=n.target,t;n.tagName.toLowerCase()===Wn?i=n.id:(n=n.parentElement)&&n.tagName.toLowerCase()===Wn&&(i=n.id),n=r.f$[i],i&&n&&n.tT.call(r)})},x.prototype.ONt=function(n){this.LAt&&n&&O(c("td")).append(n).appendTo(this.BNt).addClass(Jn)},x.prototype.PAt=function(){var n,n,t,i,r,e,n;function o(n){for(var t,i,t=0,i=n+t;H.getElementById(i);)i=n+ ++t;return i}i=(n={0:A+(n="gAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAA")+"A8ElEQVRIS92VwQ3CMAxFe+qZERiHY8dgDI4cYYNOhDhwY4ayQviW4q/Eddu0KRe+9CQ72P8rEpAmhPBT3ENLd76EiPv5HO5hSmK+KYTFsz+04A4G9NZ0hAizn7jTos2MFRYYugFZQlscoFzRZsYKCwwNulAqnZddtJmxwiIZ3oT6WFh4S2tQHwsLb2kN6mNh4S2tQX0sLLwly4IyY4WFZ2gReV/ZhBOQH2ddgKcYwBAc7R/weL0ZgqO6gGPXE1E0JlBdwJx2CUhvkCL63xvw33QKUc0N+B5MIaq5gb5o8kotBszJDShFlkvQ+ZHBvoTmC+fiVfoq/m86"+dn,1:A+n+"BkklEQVRIS7WTUXECQRBEcYCFOIiESAAH/OYPCcQBEogDJCABCUhAwqXf1QzVM0cojko+Xt3ObG/33t7eYhiGf6UU68+vneD5Mu4HpZDgKja+YCYH94NSSHAUg3glZC9k8zgAYwLmhuS6o/tBKUJ8CTGsoveIsin3g1LEAkxzAd/kXbihwxwatGys+EEpEAT5LR6FuDmMb+t+UAoEwVL44h7CvB8lGxrn3A9KkaLAj8pDMD9HL/v0ZgfAQfSAk/WgXAT3g1K4MPCj2AoPhNvRJO4HpejigF1jxtjNy9Ek7gel6GIjfzoP+Ihewf2gFPcWNNL817/c/aAUKXpbfy/FXlzFIM6gOYy3Gp+iz/xBPHeLQGLAMI2PNmYOw1uojZfdCyYNCXexiGcGpiljdp9hsBGjvnvBpCHhRbgBZChjAgj0eXrX7gWThoR992lAMGOOLMfJuIHuBZMGQuE75KN66Cpq14xH2L1g0kixyLNm3I8sNbwJulHfvWDSkJArmou4hlxXeh4AvBEBuZnnbtHfMix+AHqkr6wgQ4Q7"+dn,2:A+n+"A3UlEQVRIS72PwQ3CMAxFOwrjcOyZCTgyAjfWYCJO3JiCCVL/iFSO9W0MDTzpqYob+ztTKeWn0uJIadE6H8/ljXsR96q6tzt4YogH/olPcQ2R8mp3CHRBwO3+6EKkvNodcDkSgyyoAx0iRz/AA/8Op0sdtJuv1Va3Ct8FYHgL8dgUAGxIe41+kRAH6CbdaGW86nFAhnaXLSLEAbqJCbxlUgEZ2DIgFaCbmMBbJhWQgS0DUgG6iQm8ZVIBGTYFsK21oN3F1yrEARnsIM/u8JeAT9S9nrQ4UlocKS2Os0wLtkPMdu9POt0AAAAASUVORK5CYII=",3:A+"UAAAAXCAIAAABrvZPKAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAIdJREFUOE/tzEEKgCAQheEOWLdx351adYc8Qgs3rbuAUC9nkkF0BKNN9CMy0Xx25llf8Edr7d57j/tlP4wTHf4W/b7gsT0vLs7Sz9bFWfM9nrDXE9ITphlVPO512wkkM++FNF86vBfKeKR43rjLe5QwOvxPVPSoipHmkY5RxSMFo7rXY9+eMSdet07b6c/bnwAAAABJRU5ErkJggg=="})[0],r=n[1],e=n[2],n=n[3],(t=this).LNt=new $n(o("wijspread_toolstrip_paste"),f().ToolStrip_PasteText,i,t.FNt),t.PNt=new $n(o("wijspread_toolstrip_cut"),f().ToolStrip_CutText,r,t.GNt),t.UNt=new $n(o("wijspread_toolstrip_copy"),f().ToolStrip_CopyText,e,t.HNt),t.zNt=new $n(o("wijspread_toolstrip_autofill"),f().ToolStrip_AutoFillText,n,t.VNt,t.YNt),t.add(t.LNt),t.add(t.PNt),t.add(t.UNt),t.add(new nt(t.YNt)),t.add(t.zNt)},x.prototype.YNt=function(){var n,t,i,r,n=d(this.Vv);if(!n)return!1;if(0===(t=m(n)).length)return!1;for(i=0;i<t.length;i++)if(-1===(r=t[i]).row&&-1===r.col)return!1;return!0},x.prototype.VNt=function(){var n,t;this.close(),(n=d(this.Vv))&&(t=m(n).length)<=1&&(n.kNt=!0,n.Dn.E1())},x.prototype.xNt=function(){var n=d(this.Vv);n&&(n.kNt=!1,n.Dn.E1())},x.prototype.HNt=function(){var n,t,n=d(this.Vv);n&&(t=hi(n),this.ZNt=t?n.Qy().execute({cmd:"copyFloatingObjects",sheetName:n.name()}):n.eA(!0)),this.close()},x.prototype.GNt=function(){var n,t,n=d(this.Vv);n&&(t=hi(n),this.ZNt=t?n.Qy().execute({cmd:"cutFloatingObjects",sheetName:n.name()}):n.tA(!0)),this.close()},x.prototype.FNt=function(){var n,t,i,n=this,t=n.ZNt,i=d(n.Vv);i&&!I(t)&&(i.isPasteFloatingObject&&i.isPasteFloatingObject()?i.Qy().execute({cmd:"pasteFloatingObjects",sheetName:i.name()}):i.rA({pasteHtml:t.copyHtml,pasteText:t.copyText})),n.close()},x.prototype.WNt=function(){var n=this,t="span."+Gn;O("#"+n.LNt.Zc).find(t).text(f().ToolStrip_PasteText),O("#"+n.PNt.Zc).find(t).text(f().ToolStrip_CutText),O("#"+n.UNt.Zc).find(t).text(f().ToolStrip_CopyText),O("#"+n.zNt.Zc).find(t).text(f().ToolStrip_AutoFillText)},qn=x,n.TouchToolStrip=qn,Ai.prototype.name=function(n){var t=this;return 0===arguments.length?t.Zc:(O("#"+t.Zc).attr("id",n),O("#"+t.Zc+"Text").attr("id",n+"Text"),O("#"+t.Zc+"Image").attr("id",n+"Image"),t.Zc=n,t)},Ai.prototype.text=function(n){var t=this;return 0===arguments.length?t._text:(t._text=n,O("#"+t.name()+"Text").text(n),t)},Ai.prototype.font=function(n){var t,i,t=this,i=O("#"+t.name()+"Text");return 0===arguments.length?t._font:(t._font=n,i.css("font",n),t)},Ai.prototype.foreColor=function(n){var t,i,t=this,i=O("#"+t.name()+"Text");return 0===arguments.length?t.Oft||i.css("color"):(i.css("color",n),t)},Ai.prototype.image=function(n){var t=this;return 0===arguments.length?t.GAt:(t.GAt=n,O("#"+t.name()+"Image").css("background-image","url("+n+")"),t)},Ai.prototype.RNt=function(n,t,i,r){var e,o,u,f,s,n,t,e,u,e=this,o=e.name(),u=e.font(),f=e.text(),s=O(c("span"));return s.attr("id",o+"Image"),s.addClass(n),s.css({"background-image":"url("+e.image()+")","background-repeat":"no-repeat",display:"block",height:t,"background-position-x":"50%"}),(n=O(c("span"))).attr("id",o+"Text"),n.addClass(i),n.css("font",u),n.text(f),(e=60)<(t=vi(u,f,i))&&(e=t),(u=O(c(Wn))).attr("type",Wn),u.attr("id",o),u.addClass(r+" gc-toolstrip-button-style ui-state-default ui-widget btn btn-default"),u.css({"box-sizing":"content-box",border:"0px",padding:"4px",margin:"3px",width:e+l}),u.append(s),u.append(n),u[0]},$n=Ai,n.TouchToolStripItem=$n,li.prototype.name=function(){return this.Zc},li.prototype.RNt=function(n,t){var i=O(c("div"));return i.attr("id",this.name()),i.addClass(n),i.css({width:"1px",height:t,display:"inline-block;","background-color":"#CCC","margin-left":"5px","margin-right":"5px",opacity:.6}),i[0]},nt=li,n.TouchToolStripSeparator=nt,E.prototype.NIt=function(){this.QNt=2,this.jS.Oi=!0},E.prototype.qAt=function(){this.QNt=0,this.KNt=w()},E.prototype.xIt=function(){return 1===this.QNt},E.prototype.jIt=function(){return 1===this.QNt},E.prototype._It=function(){return 1===this.QNt},E.prototype.sW=function(){var n=this;if(2===n.QNt)return!0;if(n.KNt){if(w()-n.KNt<=200)return n.JNt++,!0;n.KNt=0,n.JNt=0}return n.QNt=1,n.jS.Oi=!1},E.prototype.cW=function(){var n=this;return n.JNt?(n.JNt--,!0):2===n.QNt||(n.QNt=0,!1)},E.prototype.fW=function(){return 2===this.QNt},tt=E,n.IZ=tt,it=wi,n.NZ=it,di.prototype.XNt=function(n,t){var i,r,e,o,r,e,i=n,r=i.touches,e=i.targetTouches,o=i.changedTouches;!1===i.isPrimary||r&&1<=r.length&&e&&1<=e.length&&(r[0].clientX!==e[0].clientX||r[0].clientY!==e[0].clientY)||(a(n),r=I(o)?i:o[0],(e=H.createEvent("MouseEvents")).initMouseEvent(t,!0,!0,ln,1,r.screenX,r.screenY,r.clientX,r.clientY,!1,!1,!1,!1,0,M),n.target.dispatchEvent(e))},di.prototype.lIt=function(n){var t,t,t=n.pointerType;t&&t!==n[v]&&t!==h||(t=n.data).Vb||(t.Vb=!0,t.qNt=!1,t.XNt(n,"mouseover"),t.XNt(n,"mousemove"),t.XNt(n,"mousedown"))},di.prototype.iE=function(n){var t,t,t=n.pointerType;t&&t!==n[v]&&t!==h||(t=n.data).Vb&&(t.qNt=!0,t.XNt(n,"mousemove"))},di.prototype.vIt=function(n){var t,t,t=n.pointerType;t&&t!==n[v]&&t!==h||(t=n.data).Vb&&(t.XNt(n,"mouseup"),t.XNt(n,"mouseout"),t.qNt||t.XNt(n,"click"),t.Vb=!1)},di.prototype.$Nt=function(n,t,i){var r,e,e,o,u,f,s,c,a,h,i,v,t,r=this,e=i.charAt(0),e=rn+(i="."!==e?"."+i:i),o=en+i,u=on+i,f=un+i,s=fn+i,c=sn+i,a=cn+i,h=an+i,i=hn+i,v=F.mt.m0();t?v?(t=n.style,I(t.msTouchAction)||(t.msTouchAction=tn),I(t.touchAction)||(t.touchAction=tn),O(n).bind(e,r,r.lIt).bind(f,r,r.lIt),O(H).bind(o,r,r.iE).bind(s,r,r.iE).bind(u,r,r.vIt).bind(c,r,r.vIt)):O(n).bind(a,r,r.lIt).bind(h,r,r.iE).bind(i,r,r.vIt):v?(O(n).unbind(e).unbind(f),O(H).unbind(o).unbind(s).unbind(u).unbind(c)):O(n).unbind(a).unbind(h).unbind(i)},rt=di,n.QAt=rt,et="newSheet",ot="tab",ut="allSheets",k.prototype.BZ=function(n){var t,n,i,r,e,e,o,u,e,n,u,n,u,f,s,c,e,t=this,n=n.JZ,i=t.w2,r=i.im(),e=d(i.Vv);i.Og&&i.Rg(e,!1),e="resize",(u=(o=i.hitTest(n.X,n.Y)).element)===e?(i.Bg=!0,i.Lg=n.X):u!==ot&&u!==et&&""!==u||(e=i.fg,n=F.Bf.Xl(e),u=F.Bf.ql(e),u=(n=t.oNt(n,u)).getContext("2d"),f=F.Bf.Kl(n),s=F.Bf.Jl(n),F.Lf.Vl(u,1,1),u.drawImage(e,0,0,U(n),N(n),0,0,U(n),N(n)),F.Lf.Vl(u,f,s),t.fg=n,t.t6t=i.om,t.n6t=i.tm(),t.e6t=i.Xv(),t.Rv=i.Jv()),t.i6t=i.N2(-1),t.r6t=i.Ym(i.Zm()),e=(c=r?i.$v:i.M2e).slice(0,t.t6t),t.uTe=0<e.length?e.reduce(function(n,t){return n+t}):0},k.prototype.FZ=function(n){var t,i,r,e,o,u,f,s,o,c,o,u,f,s,i,a,h,n,v,v,f,u,s,i,f,e,A,l,w,d,p,g,t,e,t=this,i=n.JZ.X,r=t.w2,e=r.im();r.Bg?(o=i-r.Lg,f=(u=r.Vv).options,s=u.Kg.clientWidth,f.tabStripRatio=u.Jg()+o/s,o=r.rm()/s,c=1,u.Jg()<o?(f.tabStripRatio=o,r.Lg=r.rm()):1<=u.Jg()?(f.tabStripRatio=1,r.Lg=s):r.Lg=i):(o=t.fg,u=t.t6t,o&&!I(u)&&(f=t.i6t,s=t.r6t,i=t.Rv,a=t.n6t,h=t.e6t,n=e?n.nW.wAt.X:n.nW.wAt.Y,v=t.o6t(n,u),r.om=v.om,v=v.Eft,(0<n&&u===f&&r.om===f||n<0&&u===s&&r.om===s)&&(v=0),0<n&&v+i<n?n=v+i:n<0&&n<v-i&&(n=v-i),0!==n)&&(u=(f=r.fg).getContext("2d"),s=F.Bf.Kl(f),i=F.Bf.Jl(f),u.save(),u.clearRect(0,0,F.Bf.Xl(f),F.Bf.ql(f)),f=r.ot(),r.wm(u,f),e?(e=a-t.uTe+n,F.Lf.Yl(u,e,0),r.Z2(u,void 0,!0),F.Lf.Yl(u,-e,0),F.Lf.Vl(u,1,1),d=N(f),u.drawImage(o,(A=0)*s,l=0,(w=a)*s,d*i,A*s,l,w*s,d*i),p=F.I.fl(""),2007<(g=vn(p.zIndex))&&(A=h,w=f.x+U(f)-r.rm()-A,u.drawImage(o,A*s,l,w*s,d*i,A*s,l,w*s,d*i)),A=U(f)-r.rm(),w=r.rm(),u.drawImage(o,A*s,l,w*s,d*i,A*s,l,w*s,d*i)):(w=U(f),e=t=d=l=void(A=0),0<n?(0<(d=h-(t=(l=a)+n))&&(F.Lf.Vl(u,1,1),u.drawImage(o,A*s,l*i,w*s,d*i,A*s,t*i,w*s,d*i),F.Lf.Vl(u,s,i)),e=h-a<=n?0:n-v,l=a,0<(d=v)&&(F.Lf.Yl(u,0,e),r.Z2(u,new F.Rect(A,l,w,d)),F.Lf.Yl(u,0,-e))):n<0&&(0<(d=h-(l=(t=a)+B(n)))&&(F.Lf.Vl(u,1,1),u.drawImage(o,A*s,l*i,w*s,d*i,A*s,t*i,w*s,d*i),F.Lf.Vl(u,s,i)),e=n-v,h-a<=B(n)&&(e=0),l=h-(d=B(v)),0<d)&&(F.Lf.Yl(u,0,e),r.Z2(u,new F.Rect(A,l,w,d)),F.Lf.Yl(u,0,-e)),F.Lf.Vl(u,1,1),u.drawImage(o,A*s,(l=0)*i,w*s,(d=a)*i,A*s,l*i,w*s,d*i),p=F.I.fl(""),2007<(g=vn(p.zIndex))&&(l=h,d=f.y+N(f)-r.rm()-l,u.drawImage(o,A*s,l*i,w*s,d*i,A*s,l*i,w*s,d*i)),l=N(f)-r.rm(),d=r.rm(),u.drawImage(o,A*s,l*i,w*s,d*i,A*s,l*i,w*s,d*i)),F.Lf.Vl(u,s,i),u.restore()))},k.prototype.GZ=function(n){var t=this.w2;t.Bg?(t.Bg=!1,t.Vv.Xg()):t.repaint()},k.prototype.HZ=function(n){var t,i,r,e,o,r,u,o,t=this.w2,i=t.Vv,r=n.JZ,e=d(i);t.Og&&t.Rg(e,!1),o=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],u=(r=t.hitTest(r.X,r.Y)).element,i.Bp=!0;try{0<=o.indexOf(u)?t.Pg(r.index,!0):u===ot?t.Gg(r.index,r.position):u===et?t.Hg(r.position):u===ut&&this.zg(n)}finally{i.Bp=!1,(o=d(i))!==e&&(o.Oi=!0,o.Zg())}},k.prototype.WAt=function(n){return this.w2.E2(n.JZ.X,n.JZ.Y)},k.prototype.oNt=function(n,t){var i=this.fg;return i?n===F.Bf.Xl(i)&&t===F.Bf.ql(i)||F.Bf.$l(i,n,t):(i=c("canvas"),F.Bf.Wl(i,this.w2.Vv),F.Bf.$l(i,n,t)),i},k.prototype.o6t=function(n,t){var i,r,e,o,u,f,s,c,a,i=this,r=i.w2,e=r.$v,o=r.M2e,u=i.i6t,f=i.r6t,s=r.im(),c=t,a=0;if(0<n){for(;u<=c&&!(n<a);)a+=(s?e:o)[c],c--;c<u&&(c=u)}else if(n<0&&-1!==f){for(;c<=f&&!(a<n);)a-=(s?e:o)[c],c++;f<c&&(c=f)}return{om:c,Eft:a}},k.prototype.zg=function(n){var t,i,t=this.w2,i=gt(t.getCanvas());t.zg({pageX:n.JZ.X+i.I0,pageY:n.JZ.Y+i.A0})},ft=k,pi.prototype.oW=function(){var n=this,t=n.kZ;t&&t.aW(n.xZ,!0)},pi.prototype.uW=function(){var n=this,t=n.kZ;t&&t.aW(n.xZ,!1)},pi.prototype.sW=function(n){return this.AZ.sW()},pi.prototype.cW=function(n){return this.AZ.cW()},pi.prototype.fW=function(n){return this.AZ.fW()},st=pi,F.g7.prototype.PD=function(){var n,t,i,r,n=this,t=n.Mf,i=m(t),r=i.length;t.My<=0&&0<r&&n.E1(i[r-1],p,p,!0)},F.Worksheet.ch(h,{init:function(){this.kNt=!1,this.INt=!0},setHost:function(n){var t,i,i,n,t=this,i=t.parent,i=i&&i.kZ||new Cn,n=new Qn(n[0],t,i);n.oW(),t.dW=n},dispose:function(n){var t=this;t.dW&&t.dW.uW(),!1!==n.clearCache&&(t.dW=M)},startEdit:function(){this.Oi&&this.Dn.PD()},paintAdornment:function(n){var t,n,t=this,n=n.ctx;t.Oi&&(t.isActualProtected()||mi(t,n),t.kNt?ki(t,n):Ei(t,t.INt,n))},preProcessMouseDown:function(n){var t,i,t=n.e,i=this.dW;(r||i.sW(t))&&(a(t),n.r=!0)},preProcessMouseMove:function(n){var t,i,t=n.e,i=this.dW;(r||i.fW(t))&&(a(t),n.r=!0)},preProcessMouseUp:function(n){var t,i,t=n.e,i=this.dW;(r||i.cW(t))&&(a(t),n.r=!0)},preProcessMouseDbClick:function(n){(r||this.Oi)&&(n.r=!0)},preProcessMouseOut:function(n){r&&(n.r=!0)},preProcessMouseWheel:function(n){r&&(n.r=!0)}}),F.Workbook.ch(h,{init:function(){this.kZ=new Cn},setHost:function(){var n=this;n.touchToolStrip=new qn(n,n.j2())},dispose:function(){var n=this,t=n.kZ,i=n.touchToolStrip;t&&t.L0(),i&&(i.L0(),n.touchToolStrip=M)},onCultureChanged:function(){var n=this.touchToolStrip;n&&n.WNt()}}),F.Hv.ch(h,{setHost:function(){var n,t,n=this,t=new st(n.fg,n,n.Vv.kZ);t.oW(),n.dW=t},dispose:function(){var n=this,t=n.dW;t&&(t.uW(),n.dW=M)},preProcessMouseDown:function(n){var t=this.dW,i=n.e;(r||t.sW(i))&&(a(i),n.r=!1)},preProcessMouseMove:function(n){var t=this.dW,i=n.e;(r||t.fW(i))&&(a(i),n.r=!1)},preProcessMouseUp:function(n){var t=this.dW,i=n.e;(r||t.cW(i))&&(a(i),n.r=!1)},preProcessMouseDbClick:function(n){var t=d(this.Vv);(r||t&&t.Oi)&&(n.r=!1)},preProcessMouseOut:function(n){r&&(n.r=!1)}}),ct=".gcScrollbar",F.YM.ch(h,{initEvents:function(n){var t;(this.Hb=new rt).$Nt(n,!0,ct)},dispose:function(n){var t=this.Hb;t&&t.$Nt(n,!1,ct)}})},"./dist/plugins/touch/touch.res.en.js":function(n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ToolStrip_AutoFillText=t.ToolStrip_CopyText=t.ToolStrip_CutText=t.ToolStrip_PasteText=void 0,t.ToolStrip_PasteText="Paste",t.ToolStrip_CutText="Cut",t.ToolStrip_CopyText="Copy",t.ToolStrip_AutoFillText="AutoFill"},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets}},r={},n=e("./dist/plugins/touch/touch.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Touch=n}();
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},Forguncy;(function(n){var t=function(t){function i(i,r,u,f,e){var o=t.call(this,i,r,u,f)||this;return o._loadedOnDemandCriticalRowIndex=0,o._rangeChangedManager=new n.ListViewHelper.RangeChangedManager(o),o._isMouseIn=!1,o._colHeaderCellIDDic={},o._conditionFormatDependenceListviews=[],o._getMultiComboBindingOptionsRequestID=0,o._getMultiComboBindingOptionsRequestList={},o._suspenPaintCountWhenResetData=0,o._columnAutoWidths=[],o._dirtyCellColor=null,o._allowDirtyColumns=null,o._tabIndex=0,o._cancelInput=!1,o._newRowIndex=-1,o.layout=e,o.row=e.Row,o.column=e.Column,o.evenRowBackcolor=o.listviewData.getAlternativeBackcolor(!0),o.oddRowBackcolor=o.listviewData.getAlternativeBackcolor(!1),o.listViewStyleTemplate=o.listviewData.getListViewStyleTemplate(),o.initStretchInfo(),new n.ListViewHelper.AutoScrollHelper(o).apply(),o}return __extends(i,t),i.prototype.isMouseInListView=function(){return this._isMouseIn},Object.defineProperty(i.prototype,"totalRowIndex",{get:function(){return this.listviewData.allowShowTotalRow()?this.listviewData.getIsTotalRowAtFirstRow()?0:this._sheet.getRowCount()-1:-1},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"firstDataRowIndexInView",{get:function(){return this.listviewData.allowShowTotalRow()&&this.listviewData.getIsTotalRowAtFirstRow()?1:0},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"lastDataRowIndexInView",{get:function(){return this.listviewData.allowShowTotalRow()&&this.listviewData.getIsTotalRowAtFirstRow()?this.getListDataCount():this.getListDataCount()-1},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"activeRowIndexInDataArea",{get:function(){return this.listviewData.allowShowTotalRow()&&this.listviewData.getIsTotalRowAtFirstRow()?this._sheet.getActiveRowIndex()-1:this._sheet.getActiveRowIndex()},enumerable:!1,configurable:!0}),i.prototype.mappedRowIndexFromData=function(n){return this.listviewData.allowShowTotalRow()&&this.listviewData.getIsTotalRowAtFirstRow()?n+1:n},i.prototype.mappedRowIndexFrowView=function(n){return this.listviewData.allowShowTotalRow()&&this.listviewData.getIsTotalRowAtFirstRow()?n-1:n},i.prototype.isNewLineRow=function(n){return n===this.lastDataRowIndexInView+1?!0:!1},i.prototype.isComboboxRequestCompleted=function(){for(var n in this._getMultiComboBindingOptionsRequestList)if(this._getMultiComboBindingOptionsRequestList[n])return!1;return!0},i.prototype.getContainer=function(){return this._divContainer},i.prototype.getSheet=function(){return this._sheet},i.prototype.getSpread=function(){return this._spread},i.prototype.suspendPaintWhenResetData=function(){var n;this._suspenPaintCountWhenResetData===0&&((n=this._spread)===null||n===void 0?void 0:n.suspendPaint());this._suspenPaintCountWhenResetData++},i.prototype.resumePaintAndTriggerEventWhenResetData=function(){var n;(n=this._spread)===null||n===void 0?void 0:n.resumePaint();this._suspenPaintCountWhenResetData=0;this.trigger("listviewDataChanged")},i.prototype.resetListviewData=function(i){var r=this;this.suspendPaintWhenResetData();this.hideActiveCellValidationTooltip();t.prototype.resetListviewData.call(this,i);this.initConditionFormatFormula();this.handleDefaultFormulaDependenceCells();this.handleTotalRowFormulaDependenceCells();this.handleComboboxDependenceCells();this.evenRowBackcolor=this.listviewData.getAlternativeBackcolor(!0);this.oddRowBackcolor=this.listviewData.getAlternativeBackcolor(!1);this._stretchHelper.cacheWidth();this.resetSpreadSetting();this.resetSheetSetting();this.tryCreateDeleteButton();this.bindDeleteButtonEvents();this.listviewData.visibleColumns.length>0&&(this._stretchHelper.stretch(!1),this.refresh());this.fillData(null,!1,!0,function(t){t||r.refreshUI();n.DelayRefresh.Push(r,function(){r.resumePaintAndTriggerEventWhenResetData()},"resetListviewData_"+r.getCalcSheetName())},function(){r.resumePaintAndTriggerEventWhenResetData()},function(){r.resumePaintAndTriggerEventWhenResetData()})},i.prototype.onLoad=function(){var i=this,n=this.getContainerDiv();n.length>0&&(this.initSpread(n[0]),this.modifyInternalMethod(),this.bindSpreadEvent());n.on("mouseenter",function(){i._isMouseIn=!0});n.on("mouseleave",function(){i._isMouseIn=!1});t.prototype.onLoad.call(this);this.bindDeleteButtonEvents();this.handleDefaultFormulaDependenceCells();this.handleTotalRowFormulaDependenceCells();this.handleComboboxDependenceCells()},i.prototype.bindDeleteButtonEvents=function(){var n=this;this._deleteButton&&(this._deleteButton.bind("mouseenter",function(){n._isMouseIn=!0}),this._deleteButton.bind("mouseleave",function(){n._isMouseIn=!1}))},i.prototype.handleDefaultFormulaDependenceCells=function(){var t=this,r,f,u,i;if(this.canAddRow())for(f=function(i){var f=(r=u.listviewData.visibleColumns[i].columnInfo)===null||r===void 0?void 0:r.DefaultFormulaDependenceCells;if(!f)return"continue";n.DependenceCellValueChangeHelper.listenFormulaRefChanged(f,function(){if(t._newRowIndex>=0){var n=t.listviewData.visibleColumns[i].getDefaultValue(t.getCalcSheetName(),t.runTimePageName,t._listData.getRowCount());t._sheet.setValue(t._newRowIndex,i,n)}},u.runTimePageName)},u=this,i=0;i<this.listviewData.visibleColumns.length;i++)f(i)},i.prototype.handleComboboxDependenceCells=function(){for(var t,o=this,i,r,u,f,e=0;e<this.listviewData.visibleColumns.length;e++)(t=(r=(i=this.listviewData.visibleColumns[e].columnInfo)===null||i===void 0?void 0:i.TemplateCell)===null||r===void 0?void 0:r.Element,((u=t===null||t===void 0?void 0:t.CellType)===null||u===void 0?void 0:u.$type)==="Forguncy.DropDownListCellType, ServerDesignerCommon")&&n.DependenceCellValueChangeHelper.listenFormulaRefChanged((f=t===null||t===void 0?void 0:t.CellType)===null||f===void 0?void 0:f.QueryConditionDependenceFormulas,function(){o.cacheComboboxText()},this.runTimePageName)},i.prototype.onWindowResized=function(t){var e,s,f,r,c,h,l;if(t===void 0&&(t=!1),this._stretchHelper.cacheWidth(),t){var i=this.listviewData.metadata,u=!1,o=n.ForguncyData.getPageLayout(this.locatedPageID,this.runTimePageName);if(i.Columns.forEach(function(n){var r=n.TemplateCell.Element,i=r.Layout,t;i&&(n.IsHiddenByColumnOptions||n.IsHiddenByJavaScriptAPI||(t=o.getColumnWidth(i.Column,i.ColumnSpan),n.OriginalWidth!==t&&(n.IgnoreHidden||(n.Width=t,n.IsHiddenByLayout=t>0?!1:!0,n.OriginalWidth=t,u=!0))))}),s=o.getRowHeight(i.TemplateRowIndex,1),s!==i.TemplateRowHeight&&(i.TemplateRowHeight=s,u=!0),f=(e=i.ColumnHeaderHeights)===null||e===void 0?void 0:e.length,f)for(r=0;r<f;r++)c=i.TemplateRowIndex-f+r,h=o.getRowHeight(c,1),h!==i.ColumnHeaderHeights[r]&&(i.ColumnHeaderHeights[r]=h,u=!0);if(u){n.ColumnOptionsListviewMetadataHelper.recalcHeaderCellsColumnSpan(i);l=new n.ListviewData(i,this.runTimePageName,this.designerPageName,this.listviewData.uniqueIndex);this.resetListviewData(l);this.cacheListviewStatusWhenColumnWidthChanged();return}}this.listviewData.visibleColumns.length>0&&this._stretchHelper.stretch(!0)},i.prototype.updateRowHeaderWidth=function(n){this._rowHeaderWidth=n},i.prototype.updateRowHeaderCheckBoxWidth=function(n){this._rowHeaderCheckBoxWidth=n},i.prototype.modifyInternalMethod=function(){var t="";t="Command_CLIPBOARD_PASTE_execute";i.OriginalSpreadJSMethod[t]||(i.OriginalSpreadJSMethod[t]=GC.Spread.Sheets.Commands.clipboardPaste.execute,function(t){GC.Spread.Sheets.Commands.clipboardPaste.execute=function(){for(var o,e,r,u=[],f=0;f<arguments.length;f++)u[f]=arguments[f];o=u[0];e=u[1];i.isListviewWorkbook(o)&&(r=n.ListviewBase.getListviewByCalcSheetName(o.name),r&&(r._rangeChangedManager.isPasteInternal=!!(e.fromSheet&&e.fromRanges)),e.pasteOption=GC.Spread.Sheets.ClipboardPasteOptions.values);try{i.OriginalSpreadJSMethod[t].apply(this,u)}finally{r===null||r===void 0?void 0:r._rangeChangedManager.resumeCalc()}}}(t));t="Command_EDIT_CELL_execute";i.OriginalSpreadJSMethod[t]||(i.OriginalSpreadJSMethod[t]=GC.Spread.Sheets.Commands.editCell.execute,function(t){GC.Spread.Sheets.Commands.editCell.execute=function(){for(var e,r,o,s,u=[],f=0;f<arguments.length;f++)u[f]=arguments[f];e=u[0];r=u[1];i.isListviewWorkbook(e)&&(r.autoFormat=!1,e instanceof GC.Spread.Sheets.Workbook&&(o=e.getActiveSheet(),o&&(s=o.getCellType(r.row,r.col),s instanceof n.CheckBoxCellTypeListView&&(r.newValue=n.CheckBoxCellTypeListView.convertValue(r.newValue)))));i.OriginalSpreadJSMethod[t].apply(this,u)}}(t));t="GC.Spread.Sheets.Worksheet.prototype.moveTo";i.OriginalSpreadJSMethod[t]||(i.OriginalSpreadJSMethod[t]=GC.Spread.Sheets.Worksheet.prototype.moveTo,function(n){GC.Spread.Sheets.Worksheet.prototype.moveTo=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];r[6]=GC.Spread.Sheets.CopyToOptions.value;i.OriginalSpreadJSMethod[n].apply(this,r)}}(t));t="Command_CLEAR_execute";i.OriginalSpreadJSMethod[t]||(i.OriginalSpreadJSMethod[t]=GC.Spread.Sheets.Commands.clear.execute,function(t){GC.Spread.Sheets.Commands.clear.execute=function(){for(var e,r,f=[],u=0;u<arguments.length;u++)f[u]=arguments[u];if(e=f[0],r=i.isListviewWorkbook(e)?n.ListviewBase.getListviewByCalcSheetName(e.name):null,r&&!r._sheet.isEditing())r._rangeChangedManager.onRangeChangeOperationBegin(GC.Spread.Sheets.RangeChangedAction.clear);if(i.OriginalSpreadJSMethod[t].apply(this,f),r&&!r._sheet.isEditing())r._rangeChangedManager.onRangeChangeOperationCompleted(!1)}}(t));t="Command_CANCEL_INPUT_execute";i.OriginalSpreadJSMethod[t]||(i.OriginalSpreadJSMethod[t]=GC.Spread.Sheets.Commands.cancelInput.execute,function(t){GC.Spread.Sheets.Commands.cancelInput.execute=function(){for(var e,r,f=[],u=0;u<arguments.length;u++)f[u]=arguments[u];e=f[0];r=i.isListviewWorkbook(e)?n.ListviewBase.getListviewByCalcSheetName(e.name):null;r&&(r._cancelInput=!0);i.OriginalSpreadJSMethod[t].apply(this,f);r&&(r._cancelInput=!1)}}(t))},i.prototype.initSpread=function(t){this._divContainer=this._initDIVContainer(t);GC.Spread.Sheets.CellTypes.Corner=n.MutiCheckCornerCellType;this._spread=new GC.Spread.Sheets.Workbook(this._divContainer.childNodes[0],{sheetCount:1});this._spread.suspendPaint();this.intSpreadSettings(this._spread);this._sheet=this._spread.getActiveSheet();this.initSheetSettings(this._sheet);this.onColumnWidthOrColumnCountChanged();this._stretchHelper.stretchWithoutSuspendPaint(!1);this.refreshUI();this.initFocusBehavior();this._spread.resumePaint()},i.prototype.getFormulaListRowInfo=function(){var n;return n={},n[this.getCalcSheetName()]=this.activeRowIndexInDataArea,n},i.prototype.initStretchInfo=function(){this.canHorizontallyStretch=!1;this.canVerticallyStretch=!1;var t=this._getPageStretchInfo(),i=this._getPageLayout();t&&(this.canHorizontallyStretch=n.Presentation.StretchCommon.canHorizontallyStretch(t.StretchMode)||i.possibleStretchInColumns(this.layout),this.canVerticallyStretch=n.Presentation.StretchCommon.canVerticallyStretch(t.StretchMode)||i.possibleStretchInRows(this.layout));this._stretchHelper=new n.ListViewHelper.StretchHelper(this);this._stretchHelper.cacheWidth()},Object.defineProperty(i.prototype,"canStretch",{get:function(){return this.canHorizontallyStretch||this.canVerticallyStretch},enumerable:!1,configurable:!0}),i.prototype.onStretch=function(n,t){this.hideDeleteButton();this.canVerticallyStretch&&this.updateLoadedOnDemandCriticalRowIndex();this.changeHorizontalBarVisible(n.showHScrollBar);this.changeVerticalBarVisible(n.showVScrollbar);t&&(this.refresh(),this.refreshUI())},Object.defineProperty(i.prototype,"hasVisibleColumn",{get:function(){var n=this.listviewData.visibleColumns;return n&&n.length>0},enumerable:!1,configurable:!0}),i.prototype._generateSpreadDiv=function(){var i="100%",r="100%",t=$("<div class='spreadDiv'/>"),n;return t.css("width",i),t.css("height",r),t.css("position","absolute"),n=$("<div class='spreadDiv'/>"),n.css("width",i),n.css("height",r),n.css("position","absolute"),n.css("top","0.5px"),n.css("left","0.5px"),t.append(n),t},i.prototype._initDIVContainer=function(n){if(this.hasVisibleColumn){var t=this._generateSpreadDiv();n.appendChild(t[0]);n=t[0]}return n},i.prototype.intSpreadSettings=function(n){n.name=this.getCalcSheetName();n.options.allowUserEditFormula=!1;n.options.scrollbarMaxAlign=!0;n.options.backColor="transparent";n.options.grayAreaBackColor=this.getGrayAreaBackColor();n.options.tabStripVisible=!1;n.options.allowUserDragDrop=this.listviewData.canUserDragDrop();n.options.allowUserDragFill=this.listviewData.canUserDragFill();n.options.showHorizontalScrollbar=!1;n.options.showVerticalScrollbar=!1;n.options.showDragFillSmartTag=!1;n.options.autoFitType=GC.Spread.Sheets.AutoFitType.cellWithHeader;n.options.hideSelection=this.listviewData.hideSelectionWhenLostFocus();n.options.defaultDragFillType=GC.Spread.Sheets.Fill.AutoFillType.fillWithoutFormatting;n.options.allowUserZoom=!1;n.options.allowExtendPasteRange=!0;n.options.copyPasteHeaderOptions=GC.Spread.Sheets.CopyPasteHeaderOptions.noHeaders;n.options.allowCopyPasteExcelStyle=!1;n.options.allowUndo=!1;n.options.allowAutoCreateHyperlink=!1;n.options.scrollbarAppearance=this.getScrollbarAppearance();n.options.numbersFitMode=1;this.initTouchToolStripItems();this.initSpreadContextMenu()},i.prototype.getScrollbarAppearance=function(){return this.listviewData.metadata.UseSimpleBar?GC.Spread.Sheets.ScrollbarAppearance.mobile:GC.Spread.Sheets.ScrollbarAppearance.skin},i.prototype.initSpreadContextMenu=function(){this.listviewData.isRowHeaderContextMenuVisible()?this._spread.contextMenu=new n.SpreadContextMenu(this,i.getCanvas(this.getCalcSheetName())):this._spread.options.allowContextMenu=!1},i.prototype.initSheetSettings=function(){var t,i,r,u,f;this._sheet.frozenColumnCount(this.listviewData.getFrozenIndex());this._sheet.frozenTrailingColumnCount(this.listviewData.getFrozenIndexEnd());this._sheet.options.frozenlineColor=this.listviewData.getFrozenLineColor();this._sheet.options.allowCellOverflow=!1;this._sheet.selectionUnit(this.getSelecionUnit());this._sheet.options.selectionBackColor=this.getSelectionBackColor();this._sheet.options.selectionBorderColor=this.getSelectionBorderColor();this._sheet.defaults.rowHeight=this.getDefaultRowHeight();this._sheet.options.gridline.showHorizontalGridline=!!((t=this.listViewStyleTemplate)===null||t===void 0?void 0:t.ShowHorizontalGridLine);this._sheet.options.gridline.showVerticalGridline=!!((i=this.listViewStyleTemplate)===null||i===void 0?void 0:i.ShowVerticalGridLine);this._sheet.options.gridline.color=(u=n.ColorHelper.Convert((r=this.listViewStyleTemplate)===null||r===void 0?void 0:r.GridLineColor))!==null&&u!==void 0?u:"#d4d4d4";this._sheet.options.clipBoardOptions=GC.Spread.Sheets.ClipboardPasteOptions.values;this._sheet.autoGenerateColumns=!1;this.listviewData.isSingleSelection()?this._sheet.selectionPolicy(GC.Spread.Sheets.SelectionPolicy.single):this.initSheetSettings_isCtrlPressed();this._initSheetCommand();f=this.listviewData.visibleColumns.length;this._sheet.setColumnCount(f);this._sheet.setRowCount(0);this.clearSelectionIfDisableAutoSelectRow();this.allowShowTotalRow()&&(this.listviewData.getIsTotalRowAtFirstRow()?this._sheet.frozenRowCount(1):this._sheet.frozenTrailingRowCount(1));this._initRowHeader();this._initColumnHeader();this.initColumnsBindingInfo();this.initColumnsStyle();this.setSheetTag()},i.prototype.initSheetSettings_isCtrlPressed=function(){this._orginal_isCtrlPressed=this._sheet.isCtrlPressed;this._orginal_deselectIgnoreSpan=this._sheet.deselectIgnoreSpan;this.shouldCtrlPressed()?(this._sheet.isCtrlPressed=function(n){return n===GC.Spread.Sheets.SheetArea.rowHeader||n===GC.Spread.Sheets.SheetArea.viewport},this._sheet.deselectIgnoreSpan=function(){return!0}):(this._sheet.isCtrlPressed=this._orginal_isCtrlPressed,this._sheet.deselectIgnoreSpan=this._orginal_deselectIgnoreSpan)},i.prototype.shouldCtrlPressed=function(){return this.listviewData.getSelectionMode()===1&&!this.listviewData.canEdit()&&this.listviewData.isRowHeaderCheckBoxVisible()},i.prototype.getSelectionBackColor=function(){var t=this.listviewData.getSelectionBackColor();return!!t&&t!=="rgba(20,20,20,0.2)"?t:this.listViewStyleTemplate?this.listViewStyleTemplate.SelectBack?n.ColorHelper.Convert(this.listViewStyleTemplate.SelectBack):"transparent":null},i.prototype.getDefaultRowHeight=function(){return this.listviewData.getTemplateRowHeight()},i.prototype.getColumnHeaderHeight=function(){return this.listviewData.getColumnHeaderHeight()},i.prototype.getSelectionBorderColor=function(){var t=this.listviewData.getSelectionBorderColor();return!!t&&t!=="#217346"?t:this.listViewStyleTemplate?this.listViewStyleTemplate.SelectBorder?n.ColorHelper.Convert(this.listViewStyleTemplate.SelectBorder):"transparent":null},i.prototype.getGrayAreaBackColor=function(){var t=this.listviewData.getGrayAreaBackColor();return!!t&&t!=="transparent"?t:this.listViewStyleTemplate&&this.listViewStyleTemplate.GrayAreaBack?n.ColorHelper.Convert(this.listViewStyleTemplate.GrayAreaBack):"transparent"},i.prototype.setSheetTag=function(){this._sheet.tag({ListviewCalcSheetName:this.getCalcSheetName(),ListViewStyleTemplate:this.listViewStyleTemplate})},i.isListviewWorkbook=function(n){var t,i=(t=n===null||n===void 0?void 0:n.getActiveSheet())===null||t===void 0?void 0:t.tag();return!!(i===null||i===void 0?void 0:i.ListviewCalcSheetName)},i.prototype.resetSpreadSetting=function(){this._spread.options.allowUserDragDrop=this.listviewData.canUserDragDrop();this._spread.options.allowUserDragFill=this.listviewData.canUserDragFill()},i.prototype.resetSheetSetting=function(){this._sheet=this._spread.getActiveSheet();this._sheet.defaults.rowHeight=this.listviewData.getTemplateRowHeight();this._sheet.setRowCount(0);this.initSheetSettings_isCtrlPressed();this._initSheetCommand_ShortcutKey();var n=this.listviewData.visibleColumns.length;this._sheet.setColumnCount(n);this._initRowHeader();this._initColumnHeader();this.initColumnsBindingInfo();this.clearColumnHeaderSpans();this.initColumnsStyle();this.onColumnWidthOrColumnCountChanged()},i.prototype._initColumnHeader=function(){var i=this,u=GC.Spread.Sheets.SheetArea.colHeader,r,f,t;if(this.listviewData.isColumnHeaderVisible()){for(r=this.getColumnHeaderHeight(),f=r.length,this._sheet.setRowCount(f,u),this._colHeaderHeight=0,t=0;t<f;t++)this._colHeaderHeight+=r[t],this._sheet.setRowHeight(t,r[t],u),this._sheet.setRowResizable(t,!1,u);this._colHeaderCellIDDic=this.getcolHeaderCellIDDic();this._onNormalCellValueChangedEventHandler=function(t,r){i._colHeaderCellIDDic[r.id]&&n.DelayRefresh.Push(i,function(){i.hasDestroyed()||i.resetColumnHeaderText()},"repaintColHeader"+i.getCalcSheetName())};n.ForguncyData.pageInfo.dataModel.normalCellDataModel.bind("valuechanged",null,this._onNormalCellValueChangedEventHandler);this.resetColumnHeaderText()}else this._colHeaderHeight=0,this._sheet.options.colHeaderVisible=!1;this._sheet.options.colHeaderAutoText=GC.Spread.Sheets.HeaderAutoText.blank},i.prototype.getColHeaderHeight=function(){return this._colHeaderHeight},i.prototype.getcolHeaderCellIDDic=function(){var u={},i=this.listviewData.visibleColumns,r,t,e,o;if(!i||i.length<=0)return u;var f=this.getRangeInfo(),s=GC.Spread.Sheets.SheetArea.colHeader,h=this._sheet.getRowCount(s);for(r=0;r<h;r++)for(t=0;t<i.length;t++)e=this.getHeaderCellIDSuffix(i[t].columnInfo.IsExternal),o=n.Common.getIdStr(f.Row+r,f.Column+i[t].getColumnIndex(),e),u[o]={Row:r,Column:t};return u},i.prototype.resetColumnHeaderText=function(){var i,t,r;this._sheet.suspendPaint();for(i in this._colHeaderCellIDDic)t=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(i),t=n.Common.IsEmpty(t)?"":t,r=this._colHeaderCellIDDic[i],this._sheet.setValue(r.Row,r.Column,t,GC.Spread.Sheets.SheetArea.colHeader);this._sheet.resumePaint()},i.prototype.autoFitRowHeight=function(){for(var t=this._sheet.getRowCount(GC.Spread.Sheets.SheetArea.viewport),n=0;n<t;n++)this._sheet.autoFitRow(n);this._restartEdit()},i.prototype.autoFitColumnWidth=function(){for(var t=this._sheet.getColumnCount(GC.Spread.Sheets.SheetArea.viewport),n=0;n<t;n++)this._sheet.autoFitColumn(n),this._columnAutoWidths[n]=this._sheet.getColumnWidth(n);this._restartEdit()},i.prototype._restartEdit=function(){var t=this;n.DelayRefresh.setTimeout(function(){t._sheet.isEditing()&&(t._sheet.endEdit(),t._sheet.startEdit())})},i.prototype._initRowHeader=function(){var i=GC.Spread.Sheets.SheetArea.rowHeader,u=0,f,t,e,r;for(this.listviewData.isRowHeaderVisible()?(++u,this._rowHeaderWidth=this.listviewData.rowHeaderColumnInfo.columnInfo.Width,this._sheet.setColumnWidth(0,this._rowHeaderWidth,i),t=this.initRowHeaderStyle(),this._sheet.setCellType(-1,0,new n.SpreadJSRowHeaderCellType(this.listViewStyleTemplate,this.getCalcSheetName(),t===null||t===void 0?void 0:t.foreColor),i)):this._rowHeaderWidth=0,this.listviewData.isRowHeaderCheckBoxVisible()?(++u,this._sheet.setColumnCount(u,i),r=this.listviewData.rowHeaderCheckBoxColumnIndex,f=this.listviewData.rowHeaderCheckBoxColumnInfo.columnInfo.Width,this._sheet.setColumnWidth(r,f,i),this._rowHeaderCheckBoxWidth=f,t=this.createHeaderStyle(this.listviewData.rowHeaderCheckBoxColumnInfo.columnInfo.TemplateCell,n.HeaderType.CheckBoxRowHeader),t&&(t.hAlign=GC.Spread.Sheets.HorizontalAlign.center,t.vAlign=GC.Spread.Sheets.VerticalAlign.center,t.textDecoration=GC.Spread.Sheets.TextDecorationType.none,this._sheet.setStyle(-1,r,t,i)),this._sheet.setCellType(-1,r,new n.CheckBoxRowHeader(this,this.listViewStyleTemplate),i),this._sheet.options.rowHeaderAutoTextIndex=0):this._rowHeaderCheckBoxWidth=0,u===0&&(this._sheet.options.rowHeaderVisible=!1),this._sheet.options.rowHeaderAutoText=this.listviewData.isRowHeaderFillNumber()?GC.Spread.Sheets.HeaderAutoText.numbers:GC.Spread.Sheets.HeaderAutoText.blank,e=this._sheet.getColumnCount(i),r=0;r<e;r++)this._sheet.setColumnResizable(r,!1,i)},i.prototype._initSheetCommand=function(){var t=this,i=this._spread.commandManager();i.register("SelectAll",function(){t._sheet.isEditing()||(n.ListViewHelper.SelectionHelper.selectAllRows(t),t.onSelectionChanged())},GC.Spread.Commands.Key.a,!0,!1,!1,!1);i.register("PressF2EnterEditMode",{execute:function(){return t.listviewData.canEdit()&&t._sheet.startEdit()}},113);this._initSheetCommand_ShortcutKey();this.supportMoveActiveCellHorizontallyByEnter();this.supportMoveFocusByEnter()},i.prototype._initSheetCommand_ShortcutKey=function(){var t=n.Platform.isMac(),i=!t,r=t;this.listviewData.canEdit()?(this._spread.commandManager().setShortcutKey("clear",GC.Spread.Commands.Key.del,!1,!1,!1,!1),this._spread.commandManager().setShortcutKey("paste",GC.Spread.Commands.Key.v,i,!1,!1,r)):(this._spread.commandManager().setShortcutKey(null,GC.Spread.Commands.Key.del,!1,!1,!1,!1),this._spread.commandManager().setShortcutKey(null,GC.Spread.Commands.Key.v,i,!1,!1,r))},i.prototype.supportMoveFocusByEnter=function(){var t=this;n.ForguncyData.pageInfo.moveFocusByEnter&&(this._spread.commandManager().register("EnterHit",function(){var i=t._sheet,r;if(!i.isEditing()&&(r=t.listviewData.getMoveFocusHorizontally()?i.getActiveRowIndex()===i.getRowCount()-1&&i.getActiveColumnIndex()===i.getColumnCount()-1:i.getActiveRowIndex()===i.getRowCount()-1,r))return i.getParent().focus(!1),n.FocusMoveHelper.MoveFocusToNextControl(t.getGcSheetFocusElementForTab()),!0},GC.Spread.Commands.Key.enter,!1,!1,!1,!1),this._spread.commandManager().register("ShiftEnterHit",function(){var i=t._sheet,r;return r=t.listviewData.getMoveFocusHorizontally()?i.getActiveRowIndex()===0&&i.getActiveColumnIndex()===0:i.getActiveRowIndex()===0,r?(i.getParent().focus(!1),n.FocusMoveHelper.MoveFocusToPreviousControl(t.getGcSheetFocusElementForTab()),!0):void 0},GC.Spread.Commands.Key.enter,!1,!0,!1,!1))},i.prototype.supportMoveActiveCellHorizontallyByEnter=function(){this.listviewData.getMoveFocusHorizontally()&&(this._spread.commandManager().setShortcutKey("moveToNextCell",GC.Spread.Commands.Key.enter,!1,!1,!1,!1),this._spread.commandManager().setShortcutKey("moveToPreviousCell",GC.Spread.Commands.Key.enter,!1,!0,!1,!1))},i.prototype.getGcSheetFocusElementForTab=function(){return this.getContainerDiv().find("[gcuielement=gcSheetFocusElementForTab]")[0]},i.prototype.initTouchToolStripItems=function(){var t;if(n.Platform.isMobile()&&this._spread.bind(GC.Spread.Sheets.Events.TouchToolStripOpening,function(n,t){t.handled=!0}),t=this._spread.touchToolStrip,t)this.listviewData.canUserDragFill()||(t.remove("wijspread_toolstrip_autofill0"),t.remove("separator0")),this.listviewData.canEdit()||(t.remove("wijspread_toolstrip_cut0"),t.remove("wijspread_toolstrip_paste0"))},i.prototype.initColumnsStyle=function(){for(var n,i,r,u,f=this.listviewData.visibleColumns,e=f.length,t=0;t<e;t++){if(n=f[t],n.columnInfo.HeaderCell)for(i=0,r=n.columnInfo.HeaderCell;i<r.length;i++)u=r[i],this.initColumnHeaderStyle(u.Row,t,u);this.initColumnStyle(t,n.columnInfo.TemplateCell,n.canEnterEditMode);this.initColumnInputMessageFromDataValidation(t,n.columnInfo.TemplateCell);this.initCellType(t,n,n.getTemplateCell())}},i.prototype.initColumnsBindingInfo=function(){for(var i,t=this.getBindingColumnInfos(),r=t.length,n=0;n<r;n++)i=t[n],this._sheet.bindColumn(n,i)},i.prototype.initFocusBehavior=function(){this._spread.commandManager().setShortcutKey("moveToNextCellThenControl",GC.Spread.Commands.Key.tab,!1,!1,!1,!1);this._spread.commandManager().setShortcutKey("moveToPreviousCellThenControl",GC.Spread.Commands.Key.tab,!1,!0,!1,!1);this.listviewData.getAllowGetFocus()||this.setTabIndex(-1)},i.prototype.getSelecionUnit=function(){return this.listviewData.getSelectionMode()===1?GC.Spread.Sheets.SelectionUnit.row:GC.Spread.Sheets.SelectionUnit.cell},i.prototype.initColumnStyle=function(n,t,r){var f,e,o,u;r===void 0&&(r=!1);u=(f=i.createStyleByCell(t,r))!==null&&f!==void 0?f:new GC.Spread.Sheets.Style;((o=(e=t===null||t===void 0?void 0:t.Element)===null||e===void 0?void 0:e.CellType)===null||o===void 0?void 0:o.$type)==="Forguncy.MultilineTextBox, ServerDesignerCommon"&&r&&(u.formatter="@");u.showEllipsis=this.showEllipsis(t);this.listviewData.canEdit()&&this.listviewData.getMoveFocusOnlyEditableCell()&&(u.tabStop=r);this._sheet.setStyle(-1,n,u)},i.prototype.showEllipsis=function(t){var r,i=(r=t===null||t===void 0?void 0:t.Element)===null||r===void 0?void 0:r.CellType;return(i===null||i===void 0?void 0:i.$type)==="Forguncy.ImageCellType, ServerDesignerCommon"&&!n.Common.IsEmpty(i.ToolTip)?!1:!0},i.prototype.initColumnInputMessageFromDataValidation=function(t,i){if(i&&i.Element&&i.Element.DataValidation&&i.Element.DataValidation.ShowInputMessageWhenCellIsSelected){var r=GC.Spread.Sheets.DataValidation.createNumberValidator(GC.Spread.Sheets.ConditionalFormatting.ComparisonOperators.equalsTo,null,null,!0);r.showInputMessage(!0);r.inputMessage(n.Common.IsEmpty(i.Element.DataValidation.InputMessage)?"":n.Common.getMultiLanguageWord(i.Element.DataValidation.InputMessage));r.inputTitle(n.Common.IsEmpty(i.Element.DataValidation.InputMessageTitle)?"":n.Common.getMultiLanguageWord(i.Element.DataValidation.InputMessageTitle));r.type(GC.Spread.Sheets.DataValidation.CriteriaType.anyValue);r&&this._sheet.setDataValidator(-1,t,r)}},i.prototype.initColumnHeaderStyle=function(t,i,r){var o,s,e=this.createHeaderStyle(r,n.HeaderType.ColumnHeader),u,f;e&&(i>0&&(u=this._sheet.getStyle(t,i-1,GC.Spread.Sheets.SheetArea.colHeader),((o=u===null||u===void 0?void 0:u.borderRight)===null||o===void 0?void 0:o.color)&&!n.ColorHelper.isTransparent(u.borderRight.color)&&delete e.borderLeft),t>0&&(f=this._sheet.getStyle(t-1,i,GC.Spread.Sheets.SheetArea.colHeader),((s=f===null||f===void 0?void 0:f.borderBottom)===null||s===void 0?void 0:s.color)&&!n.ColorHelper.isTransparent(f.borderBottom.color)&&delete e.borderTop),this._sheet.setStyle(t,i,e,GC.Spread.Sheets.SheetArea.colHeader));r&&(r.RowSpan>1||r.ColumnSpan>1)&&this._sheet.addSpan(t,i,r.RowSpan,r.ColumnSpan,GC.Spread.Sheets.SheetArea.colHeader)},i.prototype.clearColumnHeaderSpans=function(){var n=this,t=this._sheet.getSpans(new GC.Spread.Sheets.Range(-1,-1,-1,-1),GC.Spread.Sheets.SheetArea.colHeader);t.forEach(function(t){n._sheet.removeSpan(t.row,t.col,GC.Spread.Sheets.SheetArea.colHeader)})},i.createStyleByCell=function(t,i){var u,r;return(i===void 0&&(i=!1),!t)?null:(u=t.Element&&t.Element.StyleInfo?n.Common.clone(t.Element.StyleInfo):{},u.BorderBottom=t.BorderBottom,u.BorderRight=t.BorderRight,r=n.ListViewHelper.SpreadJSStyleHelper.generateStyleObject(u),!n.Common.IsEmpty(r.formatter)&&r.formatter!=="@"&&i&&(r.formatter=null),r)},i.prototype.initCellType=function(t,i,r){var u=n.SpreadJSCellTypeHelper.getColumnCellType(this,i,r);this._sheet.setCellType(-1,t,u);this.initCellTypeOfColumnHeader(t,i)},i.prototype.initCellTypeOfColumnHeader=function(t,i){for(var r,e,f,s=this.listviewData.getColumnOperation(),h=s===1,c=this.shouldUseFilterHeaderCellType(i),o=[],l=this._sheet.getRowCount(GC.Spread.Sheets.SheetArea.colHeader),u=l-1;u>=0;u--)(r=this._sheet.getSpans(new GC.Spread.Sheets.Range(u,t,1,1),GC.Spread.Sheets.SheetArea.colHeader),r.length!==1||r[0].row===u&&r[0].col===t)&&(e=!r||r.length===0||r[0].colCount===1,f=null,h&&e?f=new n.SpreadJSSortHeaderCellType(i,this.getCalcSheetName(),this.listViewStyleTemplate):c&&e&&o[t]!==!0?(o[t]=!0,f=new n.SpreadJSFilterHeaderCellType(i,this.getCalcSheetName(),this.listViewStyleTemplate)):f=new n.SpreadJSColumnHeaderCellType(this.listViewStyleTemplate),this._sheet.setCellType(u,t,f,GC.Spread.Sheets.SheetArea.colHeader))},i.prototype.shouldUseFilterHeaderCellType=function(t){var i,r;return!t.allowFieldSort()&&!t.allowNoFieldSort()?!1:(i=this.listviewData.getColumnOperation(),i!==2)?!1:t.allowFieldSort()?(r=t.columnInfo.BindingColumnDataType,!n.Common.IsEmpty(t.getFilterActualBindingInfo())&&n.SpreadJSFilterHeaderCellType.supportedTypes.indexOf(r)>=0):this.allowNoFieldSortFilter(t)?!0:!1},i.prototype.onDataLoaded=function(){this._sheet.suspendPaint();try{this.resetColumnHeaderCellType()}finally{this._sheet.resumePaint()}},i.prototype.resetColumnHeaderCellType=function(){var n=this;this.listviewData.getColumnOperation()===2&&this.listviewData.visibleColumns.forEach(function(t,i){return n.initCellTypeOfColumnHeader(i,t)})},i.prototype.onCurrentRowChanged=function(n,i){i===void 0&&(i=!0);t.prototype.onCurrentRowChanged.call(this,n,i);this.onSelectionChanged(!1)},i.prototype.onSelectionChanged=function(n){var t;if(n===void 0&&(n=!0),((t=this._rangeChangedManager.rangeChangedInfo)===null||t===void 0?void 0:t.handled)!==!1){if(n)this.onCurrentRowChanged(this.getMappedEditorSelectedRowIndex());this.operationTypeWhenValueChanged===0&&(this.getAlwaysReservedSelections()&&this.cacheManager.save(this.getSelectedRowsIndexes()),this.triggerSelectedRowsChangedEvent())}},i.prototype.clearSelectedRowByQuery=function(t){var i=this,r=this;this.getAlwaysReservedSelections()?this.cacheManager.clearByQuery(t,function(){i.listviewData.getSelectionMode()===1&&i.getSelectedRowsIndexes().length<=1&&(i.cacheManager.reset(),i.listviewData.getDisableAutoSelectRow()||i.cacheManager.save([i._listData.getCurrentRowIndex()]));n.DelayRefresh.Push(r,function(){r.hasDestroyed()||(r.selectInEditorFromCache(),r.delayTriggerEvent(n.ListViewEvents.SelectedRowsChanged,{}))},"selectInEditorFromCache"+r.getCalcSheetName())}):this.getSelectedRowsIndexes().forEach(function(r){n.Common.isQueryEqual(i._listData.getRowQuery(r),t)&&i.clearSelectedRow(r)})},i.prototype.beforeRefeshUIWhenQueryDataFromServer=function(){if(this.getAlwaysReservedSelections()){if(this.cacheManager.reset(),this.listviewData.getSelectionMode()===1)if(this.listviewData.getDisableAutoSelectRow())this._sheet.clearSelection();else{var n=this._listData.getCurrentRowIndex();n>=0&&this.cacheManager.save([n])}}else this.clearSelectionIfDisableAutoSelectRow()},i.prototype.clearSelectionIfDisableAutoSelectRow=function(){this.listviewData.getDisableAutoSelectRow()&&this._sheet.clearSelection()},i.prototype.selectInEditorFromCache=function(){var t,i;for(this._sheet.suspendPaint(),t=0;t<this._listData.getRowCount();t++)i=this.mappedRowIndexFromData(t),this.cacheManager.exists(this.getCachedRowData(t))?n.ListViewHelper.SelectionHelper.addSelectedRow(this,i):n.ListViewHelper.SelectionHelper.clearSelectedRow(this,i);this._sheet.resumePaint();this.onSelectionChanged()},i.prototype.isSelectMultipleRows=function(n){return n.some(function(n){return n.colCount>1||n.rowCount>1||n.row===-1})},i.prototype.updateSelectedRowsAfterDeleteRow=function(){this.getAlwaysReservedSelections()&&(this.cacheManager.save(this.getSelectedRowsIndexes()),this.delayTriggerEvent(n.ListViewEvents.SelectedRowsChanged,{}))},i.prototype.bindSpreadEvent=function(){var i=this,t=this;t.listviewData.isDoubleClickCommandsExists()&&t._sheet.bind(GC.Spread.Sheets.Events.CellDoubleClick,function(r,u){var f;if(!t.listviewData.canEdit()){var e=u.row!==undefined&&u.row>=i.firstDataRowIndexInView&&u.row<=i.lastDataRowIndexInView,o=u.sheetArea===GC.Spread.Sheets.SheetArea.rowHeader,s=u.sheetArea===GC.Spread.Sheets.SheetArea.viewport;e&&(o||s)&&(f=t.listviewData.getDoubleClickCommands(),n.ForguncyData.commandExecutor.executeCommand(f,{runTimePageName:t.runTimePageName,commandTrigger:t,commandID:t.getListviewName(),eventType:"click",locationString:n.FormulaHelper.getListviewCellLogLocationString(u.row,null,null,i.getListviewName(),i.runTimePageName)}))}});t._sheet.bind(GC.Spread.Sheets.Events.SelectionChanging,function(n,i){if(t._sheet.selectionPolicy()===GC.Spread.Sheets.SelectionPolicy.single){var r=t.isSelectMultipleRows(i.newSelections);r&&(i.oldSelections.length>0?i.oldSelections.forEach(function(n){t._sheet.setSelection(n.row,n.col,n.rowCount,n.colCount)}):t._sheet.clearSelection())}});t._sheet.bind(GC.Spread.Sheets.Events.SelectionChanged,function(){t.onSelectionChanged()});t._sheet.bind(GC.Spread.Sheets.Events.EnterCell,function(i,r){t._rangeChangedManager.clearRangeChangedInfo();t.canEditInListview()&&t.getAlwaysInEditMode()&&t._sheet.startEdit(!0);t.repaintDropDownCell(r);n.DelayRefresh.setTimeout(function(){if(!t.hasDestroyed()){var n=t.operationTypeWhenValueChanged;try{t.operationTypeWhenValueChanged=1;t.onCurrentRowChanged(t.getMappedEditorSelectedRowIndex())}finally{t.operationTypeWhenValueChanged=n}}},200)});t._sheet.bind(GC.Spread.Sheets.Events.LeaveCell,function(n,i){t._rangeChangedManager.clearRangeChangedInfo();t.repaintDropDownCell(i)});t._sheet.bind(GC.Spread.Sheets.Events.ValueChanged,function(n,i){t.onValueChanged(i.row,i.col)});t._sheet.bind(GC.Spread.Sheets.Events.TopRowChanged,function(n,i){t.onTopRowChanged(i)});t._sheet.bind(GC.Spread.Sheets.Events.RowHeightChanged,function(){t.onRowHeightOrRowCountChanged()});t._sheet.bind(GC.Spread.Sheets.Events.ColumnWidthChanged,function(){t.onColumnWidthOrColumnCountChanged();t.cacheListviewStatusWhenColumnWidthChanged()});t._sheet.bind(GC.Spread.Sheets.Events.CellClick,function(i,r){if(r.sheetArea===GC.Spread.Sheets.SheetArea.viewport){n.ListViewHelper.SelectionHelper.isSelectAllRows(t._sheet)&&t._sheet.repaint();t.onCellClick(r.row,r.col);t.getAlwaysInEditMode()&&t._sheet.startEdit()}});t._spread.bind(GC.Spread.Sheets.Events.ButtonClicked,function(n,i){t.onCellTypeClicked(i)});t._sheet.bind(GC.Spread.Sheets.Events.EditStarting,function(n,i){t.listviewData.canEdit()&&t.canCellEnterEditMode(i.row,i.col)||(i.cancel=!0)});t._sheet.bind(GC.Spread.Sheets.Events.EditEnding,function(i,r){if(!t._cancelInput){var u=t._sheet.getCellType(-1,r.col);t.isNewLineRow(r.row)&&n.Common.IsEmpty(r.editingText)||u.validate&&!u.validate(r.row,r.col)&&(r.cancel=!0)}});t._sheet.bind(GC.Spread.Sheets.Events.RangeChanged,function(n,i){t._rangeChangedManager.onRangeChanged(i)});t._sheet.bind(GC.Spread.Sheets.Events.ClipboardPasting,function(i,r){if(!t.listviewData.canEdit()){r.cancel=!0;return}if(!t.isValidPasteRange(r)){alert(n.RS.InvalidCopyPasteSize);r.cancel=!0;return}if(t.isRangeContainsTotalRow(r.cellRange.row,r.cellRange.row+1)){alert(n.RS.RangeOperationCannotInvolveTotalRow);r.cancel=!0;return}t.clearTotalRowCellTypeAndStyle();t._rangeChangedManager.onRangeChangeOperationBegin(GC.Spread.Sheets.RangeChangedAction.paste,!0)});t._sheet.bind(GC.Spread.Sheets.Events.ClipboardPasted,function(n,i){t.resetStyle(i.cellRange);t._rangeChangedManager.onRangeChangeOperationCompleted(i.cellRange.row===-1||i.cellRange.rowCount===-1)});t._sheet.bind(GC.Spread.Sheets.Events.DragDropBlock,function(i,r){if(t.isRangeContainsTotalRow(r.fromRow,r.fromRow+r.rowCount)||t.isRangeContainsTotalRow(r.toRow,r.toRow+r.rowCount)){alert(n.RS.RangeOperationCannotInvolveTotalRow);r.cancel=!0;return}t._rangeChangedManager.onRangeChangeOperationBegin(GC.Spread.Sheets.RangeChangedAction.dragDrop)});t._sheet.bind(GC.Spread.Sheets.Events.DragDropBlockCompleted,function(n,i){t._rangeChangedManager.onRangeChangeOperationCompleted(i.fromRow===-1||i.toRow===-1||i.rowCount===-1)});t._sheet.bind(GC.Spread.Sheets.Events.DragFillBlock,function(i,r){if(t.isRangeContainsTotalRow(r.fillRange.row,r.fillRange.row+r.fillRange.rowCount)){alert(n.RS.RangeOperationCannotInvolveTotalRow);r.cancel=!0;return}if(r.autoFillType!==GC.Spread.Sheets.Fill.AutoFillType.copyCells){var u=t._sheet.getSelections()[0],f=t.getCellIndexesBySelection(u),e=f.some(function(i){var r=t._sheet.getValue(i[0],i[1],GC.Spread.Sheets.SheetArea.viewport);return typeof r!="string"?!1:t.isForguncyUrl(r)?!0:n.Common.isForguncyFile(r)?t.isNumeric(r[0])||t.isNumeric(r[r.length-1]):void 0});e&&(r.autoFillType=GC.Spread.Sheets.Fill.AutoFillType.copyCells)}t._rangeChangedManager.onRangeChangeOperationBegin(GC.Spread.Sheets.RangeChangedAction.dragFill)})},i.prototype.isNumeric=function(n){return!isNaN(~~n)&&isFinite(n)},i.prototype.isForguncyUrl=function(t){if(t===null||t===void 0?void 0:t.startsWith(n.Helper.SpecialPath.getBaseUrl()))return!0},i.prototype.getCellIndexesBySelection=function(n){for(var t,r=[],i=Math.max(n.row,0);i<n.row+n.rowCount;i++)for(t=Math.max(n.col,0);t<n.col+n.colCount;t++)r.push([i,t]);return r},i.prototype.repaintDropDownCell=function(t){n.DelayRefresh.setTimeout(function(){var i=t.sheet.getCellType(t.row,t.col);i instanceof n.DropDownEditorCellType&&i.showDropdownButton===2&&t.sheet.repaint(t.sheet.getCellRect(t.row,t.col))})},i.prototype.resetStyle=function(n){for(var i,r=n.row===-1?0:n.row,f=n.rowCount===-1?this._sheet.getRowCount():n.rowCount,u=n.col===-1?0:n.col,e=n.colCount===-1?this._sheet.getColumnCount():n.colCount,t=r;t<r+f;t++)if(t!==this.totalRowIndex)for(i=u;i<u+e;i++)this._sheet.setStyle(t,i,null)},i.prototype.onCellTypeClicked=function(t){var u=this,i,r;if(!this.isProtected())if(i=this._sheet.getCellType(t.row,t.col,t.sheetArea),t.sheetArea===GC.Spread.Sheets.SheetArea.viewport){this.onCellClick(t.row,t.col);r=this.mappedRowIndexFrowView(t.row);this.triggerClickCommand(r,t.col)}else t.sheetArea===GC.Spread.Sheets.SheetArea.colHeader?i instanceof n.SpreadJSFilterHeaderCellType?this.tryCommitEdit()&&n.ColumnFilterHelper.showContextMenu(this,t):n.DelayRefresh.setTimeout(function(){u.sortByColumn(t.col)}):t.sheetArea===GC.Spread.Sheets.SheetArea.rowHeader&&i instanceof n.CheckBoxRowHeader?(this._rangeChangedManager.clearRangeChangedInfo(),this.changeSelectedRowsInRowHeader(t.row,t.col)):t.sheetArea===GC.Spread.Sheets.SheetArea.corner&&i instanceof GC.Spread.Sheets.CellTypes.Corner&&this.selectAllByCornerCell()},i.prototype.triggerClickCommand=function(t,i){var r=i,s=n.Common.getIdStr(t,r,this.getCalcSheetName()),h=this._listData.getRowCount(),c=this._listData.getColumnCount(),u,f,e,o;return t<0||t>=h||r<0||r>=c?!1:(u=this.listviewData.visibleColumns[r],f=u.getClickCommandsMetaData(),!f||f.length===0)?!1:(e=this._listData.getCurrentRowIndex(),e!==t&&this.selectRow(t),o=n.FormulaHelper.getListviewCellLogLocationString(t,r,u.getName(),this.getListviewName(),this.runTimePageName),n.ForguncyData.commandExecutor.executeCommand(f,{runTimePageName:this.runTimePageName,commandTrigger:this,commandID:s,eventType:"click",locationString:o,listViewInfo:{rowIndex:t,colIndex:r,columnName:u.getName(),listViewName:this.getListviewName(),pageName:this.runTimePageName}}),!0)},i.prototype.onCellClick=function(i,r){var u=this;t.prototype.onCellClick.call(this,i,r);this.shouldCancelSelectionOnCellClick(i)&&n.DelayRefresh.Push(null,function(){var n=u._sheet.getColumnCount(GC.Spread.Sheets.SheetArea.rowHeader)-1;u.changeSelectedRowsInRowHeader(i,n)},this.getCalcSheetName()+"_changeSelection")},i.prototype.shouldCancelSelectionOnCellClick=function(t){return this.shouldCtrlPressed()&&n.Platform.isMobile(!0)&&n.ListViewHelper.SelectionHelper.isRowSelected(this._sheet,t)},i.prototype.isValidPasteRange=function(n){return n.sheet.getColumnCount()<n.cellRange.col+n.cellRange.colCount?!1:!this.allowAddRow()&&n.cellRange.row+n.cellRange.rowCount>this.lastDataRowIndexInView+1?!1:!0},i.prototype.isRangeContainsTotalRow=function(n,t){if(this.allowShowTotalRow()){var i=this.totalRowIndex;if(i>=n&&i<t)return!0}return!1},i.prototype.onValueChanged=function(t,i){var f,o,s,h;if(this.canCellBeEdited(t,i)){var u=this.mappedRowIndexFrowView(t),e=this._listData.getRowCount(),r=this._sheet.getValue(t,i);if(this._sheet.getCellType(t,i)instanceof n.SpreadJSViewUploadImageCellType&&(r=n.ImageHelper.convertPathToFileName(r)),((f=this._rangeChangedManager.rangeChangedInfo)===null||f===void 0?void 0:f.handled)===!1){if(u>=e){if(!this.allowAddRow())return;for(o=e;o<=u;o++)this.addNewRow([],!0,!0)}if(s=this.listviewData.getColIndexByVisibleColIndex(i),s===-1)return;if(this._rangeChangedManager.rangeChangedInfo.addChangedCell(t,i,this._listData.getValue(u,s)),this._rangeChangedManager.rangeChangedInfo.needParseValue){if(r instanceof Date&&(r=n.Convertor.fromDateToOADate(r)),h=n.ListviewEditorHelper.getCell(this.listviewData.visibleColumns[i].getTemplateCell(),this.runTimePageName,this.designerPageName,this.listviewData.getListviewName()),!h)return;r=h.cellType.getValueFromListviewText(r,!0);this._sheet.setValue(t,i,r)}}else if(u===e){this.onValueChangedInNewRow(t,i,r);return}this._onCellValueChanged(u,i,r,!0)}},i.prototype.canCellEnterEditMode=function(n,t){var r=this.mappedRowIndexFrowView(n),i;if(!(this.listviewData.visibleColumns[t].canEnterEditMode&&this._commitingRows.indexOf(r)===-1))return!1;if(this.listviewData.allowShowTotalRow())if(this.listviewData.getIsTotalRowAtFirstRow()){if(n===0)return!1}else if(n===this._sheet.getRowCount()-1)return!1;return(i=this._sheet.getSpans(new GC.Spread.Sheets.Range(n,t,1,1)),i&&i.length>0)?!1:!0},i.prototype.canCellBeEdited=function(n,t){return this.listviewData.visibleColumns[t].canEditInForguncy&&this._commitingRows.indexOf(this.mappedRowIndexFrowView(n))===-1},i.prototype.onValueChangedInNewRow=function(n,t,i){var u=this.listviewData.getColIndexByVisibleColIndex(t),r;if(u!==-1){if(this.shouldIgnoreValueChangedInNewRow(t,i)){this.setDataToSpreadJSNow();return}r=[];r[u]=i;this.addNewRow(r,!0,!0,6)}},i.prototype.shouldIgnoreValueChangedInNewRow=function(t,i){var r=this.listviewData.visibleColumns[t],u;if(r.cellType.constructor===n.PasswordCellType){if(u=r.getDefaultValue(this.getCalcSheetName(),this.runTimePageName,this._listData.getRowCount()),u===i)return!0}else if(r.cellType.constructor===n.CheckBoxCellType&&(u=r.getDefaultValue(this.getCalcSheetName(),this.runTimePageName,this._listData.getRowCount()),u===null&&i===0))return!0;return!1},i.prototype.hideSelection=function(n){if(arguments.length===0)return this._spread.options.hideSelection;this._spread.options.hideSelection=!!n},i.prototype.refresh=function(){this._spread.refresh()},i.prototype.getAllSelectedRowsOfView=function(){for(var n,l,t,r,u,a=this,s={},v=this._sheet.getSelections(),i=[],f=this.firstDataRowIndexInView,e=this.lastDataRowIndexInView,h=!1,o=0,c=v;o<c.length;o++)if(n=c[o],n.col===-1||n.colCount===-1){if(n.row===-1||n.rowCount===-1){h=!0;break}for(l=n.row+n.rowCount,t=n.row;t<l;t++)if(t<f||t>e)continue;else s[t]!==!0&&(i.push(t),s[t]=!0)}if(h)for(i=[],r=f;r<=e;r++)i.push(r);else i.length!==0||this.listviewData.isRowHeaderCheckBoxVisible()||this.listviewData.getDisableAutoSelectRow()||(u=this.mappedRowIndexFromData(this.getCurrentRowIndex()),u>=f&&u<=e&&i.push(u));return i.map(function(n){return a.mappedRowIndexFrowView(n)})},i.prototype.changeSelectedRowsInRowHeader=function(t,i){this.listviewData.isRowHeaderCheckBoxVisible()&&this.stopEditingActiveCell()&&(n.Common.IsEmpty(t)||n.Common.IsEmpty(i)||(n.ListViewHelper.SelectionHelper.isRowSelected(this._sheet,t)?n.ListViewHelper.SelectionHelper.clearSelectedRow(this,t):n.ListViewHelper.SelectionHelper.addSelectedRow(this,t),this.onSelectionChanged()))},i.prototype.selectAllByCornerCell=function(){this.listviewData.isRowHeaderCheckBoxVisible()&&this._sheet.getRowCount()!==0&&(n.ListViewHelper.SelectionHelper.isSelectAllRows(this._sheet)?n.ListViewHelper.SelectionHelper.clearAllSelectedRows(this):n.ListViewHelper.SelectionHelper.selectAllRows(this),this.onSelectionChanged())},i.prototype.onTopRowChanged=function(n){(this.hideDeleteButton(),this._loadedOnDemandCriticalRowIndex!==-1)&&n.newTopRow>=this._loadedOnDemandCriticalRowIndex&&this.loadOnDemand()},i.prototype.onRowHeightOrRowCountChanged=function(){this.updateLoadedOnDemandCriticalRowIndex();this.updateScrollbarVisibility()},i.prototype.updateLoadedOnDemandCriticalRowIndex=function(){var t,i,n;for(this._loadedOnDemandCriticalRowIndex=-1,t=this.viewportHeight,i=this._sheet.getRowCount(),n=i-1;n>=0;n--)if(t-=this._sheet.getRowHeight(n),t<0){this._loadedOnDemandCriticalRowIndex=n;break}},i.prototype.onColumnWidthOrColumnCountChanged=function(){this.updateScrollbarVisibility()},i.prototype.cacheListviewStatusWhenColumnWidthChanged=function(){var i=this,t=this.listviewData.metadata;t.CacheListviewStatus&&(t.AutoFitColumnWidth||(t.Columns.forEach(function(n){i.changeColumnMetadataWidthInfo(n)}),n.ListviewStatusCacheHelper.autoSaveMetadataCacheDataAsync(this,{columns:n.ListviewStatusCacheHelper.getCacheDataFromListviewMatadata(t)})))},i.prototype.getClonedListviewMetadataAfterAdjustColumnWidth=function(){var i=this,n=t.prototype.getClonedListviewMetadataAfterAdjustColumnWidth.call(this);return n.Columns.forEach(function(n){i.changeColumnMetadataWidthInfo(n)}),n},i.prototype.changeColumnMetadataWidthInfo=function(n){var r=this.listviewData.rowHeaderColumnInfo,t,i,u;if(r&&r.getColumnIndex()===n.Index){this.changeColumnMetadataWidthInfoInternal(n,this._rowHeaderWidth);return}if(t=this.listviewData.rowHeaderCheckBoxColumnInfo,t&&t.getColumnIndex()===n.Index){this.changeColumnMetadataWidthInfoInternal(n,this._rowHeaderCheckBoxWidth);return}(i=this.getVisibleColumnIndexInListViewByDataIndex(n.Index),i!==-1)&&(u=this.getColumnWidth(i),this.changeColumnMetadataWidthInfoInternal(n,u))},i.prototype.changeColumnMetadataWidthInfoInternal=function(n,t){t!=n.Width&&(n.Width=t);n.IsHiddenByUIResizeColumn=t>0?!1:!0},i.prototype.updateScrollbarVisibility=function(){var t;t=this.canStretch?this._stretchHelper.getCurrntScrollbarVisibility():n.ListViewHelper.SpreadJSStyleHelper.needShowScrollbar(this._sheet,this.viewportWidth,this.viewportHeight);this.changeHorizontalBarVisible(t.showHScrollBar);this.changeVerticalBarVisible(t.showVScrollbar)},i.prototype.changeHorizontalBarVisible=function(n){this._spread.options.showHorizontalScrollbar=this.forceHideHorizontalScrollBar?!1:n},i.prototype.changeVerticalBarVisible=function(n){this._spread.options.showVerticalScrollbar=this.forceHideVerticalScrollBar?!1:n},Object.defineProperty(i.prototype,"viewportWidth",{get:function(){return $(this._divContainer).width()-this._rowHeaderWidth-this._rowHeaderCheckBoxWidth},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"viewportHeight",{get:function(){return $(this._divContainer).height()-this._colHeaderHeight},enumerable:!1,configurable:!0}),i.prototype._onValueChangedInDataModel=function(t){var f=this,i,r,u;if((n.FormulaColumnSortFilterHelper.updateDataCacheOnValueChanged(this,t),this.operationTypeWhenValueChanged!==1)&&((t.cellRange.ColumnCount!==1||t.cellRange.RowCount!==1)&&this.cacheComboboxText(),t.actionType===2&&n.Common.remove(this._waitValidateRows,t.deleteRow),this.triggerAPIValueChangedEvent([__assign({},t.cellRange)],t.newRowCount,t.oldRowCount),this.operationTypeWhenValueChanged!==2)&&(this.updateSelectedRowsCache(),n.DelayRefresh.NeedDelayRun===!0&&this.isFocused?(this.isWaitForRefresh=!0,n.DelayRefresh.setTimeout(function(){(f.isWaitForRefresh=!1,f.hasDestroyed())||f.refreshUI()},200)):this.refreshUI(),i=t.cellRange,t.uiAction&&i))for(r=i.Row;r<i.Row+i.RowCount;r++)for(u=i.Column;u<i.Column+i.ColumnCount;u++)this.updateValuesWhenItemQueryWithColumnCell(r,u)},i.prototype.cacheComboboxText=function(){var r=this,i=this.createMultiComboBindingOptionsParam(),t;i&&(t="GetMultiComboBindingOptions_"+this.getCalcSheetName()+"_"+this._getMultiComboBindingOptionsRequestID++,this._getMultiComboBindingOptionsRequestList[t]=!0,n.TableColumnsCacheManager.cacheComboboxText(i,function(){delete r._getMultiComboBindingOptionsRequestList[t]}))},i.prototype.createMultiComboBindingOptionsParam=function(){var r,s=this.listviewData.visibleColumns,i,f,a,o;if(!s)return null;var h=this.getListDataCount(),u=[],c=[];for(i=0,f=s;i<f.length;i++){var e=f[i],v=e.getColumnIndex(),l=(r=e.getTemplateCell())===null||r===void 0?void 0:r.CellType,t=n.TableColumnsCacheManager.getBindingValueCacheKey(l);t&&(a=e.getDefaultValue(this.getCalcSheetName(),this.runTimePageName,h),o=this.getQueryAndValuesOfCombobox(h,v,l,t,a),o.length!==0)&&(u.push({lookupColumnBindingInfo:t.lookupColumnBindingInfo.GUID,resultColumnBindingInfo:t.resultColumnBindingInfo.GUID,queryAndValues:o}),c.push(t))}return u.length===0?null:{pageName:this.designerPageName,data:u,cacheKeys:c}},i.prototype.getQueryAndValuesOfCombobox=function(t,i,r,u,f){for(var v,o,s,h,c,y=this.getCalcSheetName(),l=[],a=[],e=0;e<t;e++)(o=(h={},h[y]=e,h),v=this._listData.getValue(e,i),v instanceof n.WrongParseResult)||(s=n.ConditionHelper.getComputedSqlConditionFormula(r.ItemsQuery,this.runTimePageName,r.NullFormulaValueQueryPolicy,0,0,o),l.push(v),a.push(s));return n.Common.IsEmpty(f)||(l.push(f),o=(c={},c[y]=t,c),s=n.ConditionHelper.getComputedSqlConditionFormula(r.ItemsQuery,this.runTimePageName,r.NullFormulaValueQueryPolicy,0,0,o),a.push(s)),n.TableColumnsCacheManager.getQueryAndValuesOfCombobox(l,a,r,u)},i.prototype.cacheComboboxForValidateText=function(t,i){var r=this.createParamForComboboxValidate(t);if(!r){i();return}n.TableColumnsCacheManager.cacheComboboxText(r,function(){i()})},i.prototype.createParamForComboboxValidate=function(t){var h,y=this.listviewData.visibleColumns,i,f,e,c,a,v,u,b,o,s;if(!y)return null;for(i=[],f=[],e=0,c=y;e<c.length;e++){var p=c[e],w=p.getColumnIndex(),l=(h=p.getTemplateCell())===null||h===void 0?void 0:h.CellType,r=n.TableColumnsCacheManager.getBindingValueCacheKey(l,!1);if(r){for(a=[],v=[],u=0;u<t.length;u++)b=t[u][w],n.Common.IsEmpty(b)||(a.push(t[u][w]),v.push(null));(o=n.TableColumnsCacheManager.getQueryAndValuesOfCombobox(a,v,l,r),o.length!==0)&&(i.push({lookupColumnBindingInfo:r.lookupColumnBindingInfo.GUID,resultColumnBindingInfo:r.resultColumnBindingInfo.GUID,queryAndValues:o}),f.push(r),s=n.TableColumnsCacheManager.getBindingValueCacheKey(l,!0),i.push({lookupColumnBindingInfo:s.lookupColumnBindingInfo.GUID,resultColumnBindingInfo:s.resultColumnBindingInfo.GUID,queryAndValues:n.Common.clone(o)}),f.push(s))}}return i.length===0?null:{pageName:this.designerPageName,data:i,cacheKeys:f}},i.prototype.updateValuesWhenItemQueryWithColumnCell=function(n,t){for(var u,f,e,i=0,r=this.listviewData.visibleColumns;i<r.length;i++)u=r[i],f=u.dependenceColumnsIndex,f&&f.indexOf(t)!==-1&&(e=u.getColumnIndex(),this._listData.setValue(n,e,null,7,!0))},i.prototype.onDependenceCellValueChanged=function(){this.stopEditingActiveCell()||this.hideActiveCellValidationTooltip();t.prototype.onDependenceCellValueChanged.call(this)},i.prototype.hideActiveCellValidationTooltip=function(){var n=this._sheet.getCellType(this._sheet.getActiveRowIndex(),this._sheet.getActiveColumnIndex());n&&n.hideValidationTooltip&&n.hideValidationTooltip()},i.prototype.refreshUI=function(i,r){var u=this;i===void 0&&(i=-1);r===void 0&&(r=-1);n.DelayRefresh.Push(this,function(){if(!u.hasDestroyed()){if(u.cacheComboboxText(),!u.isComboboxRequestCompleted()){n.DelayRefresh.setTimeout(function(){u.refreshUI(i,r)},100);return}u.setDataToSpreadJSNow(i,r);u.selectInEditor(u._listData.getCurrentRowIndex(),undefined,function(){u.clearSelectionIfDisableAutoSelectRow()});u.getAlwaysReservedSelections()&&u.selectInEditorFromCache();u.triggerSelectedRowsChangedEvent();t.prototype.refreshUI.call(u)}},"setDataToSpreadJs"+this.getCalcSheetName())},i.prototype.autoFit=function(){this.listviewData.getAutoFitColumnWidth()&&this.autoFitColumnWidth();this.listviewData.getAutoFitRowHeight()&&this.autoFitRowHeight()},i.prototype.refreshTotalRowIndexInListViewStyleTemplate=function(){this.listviewData.allowShowTotalRow()&&this.listViewStyleTemplate&&this.listviewData.getIsTotalRowAtFirstRow()&&(this.listViewStyleTemplate.ShowTotalRowAtFirstRow=!0)},i.prototype.setTotalRowCellTypeAndStyle=function(){var t=this,i=this.totalRowIndex;i>=0&&this.listviewData.visibleColumns.forEach(function(r,u){var f=new n.SpreadJSViewTotalRowCellType(t.runTimePageName,t.designerPageName,t.listviewData.getListviewName(),t.getCalcSheetName(),t.listViewStyleTemplate),o=t.getTotalRowStyleMetaData(r),e=n.ListViewHelper.SpreadJSStyleHelper.generateStyleObject(o);t.handleTotalRowCellTypeStyle(f,e);t._sheet.setStyle(t.totalRowIndex,u,e,GC.Spread.Sheets.SheetArea.viewport);t._sheet.setCellType(i,u,f,GC.Spread.Sheets.SheetArea.viewport);t._sheet.setDataValidator(i,u,null,GC.Spread.Sheets.SheetArea.viewport)})},i.prototype.getTotalRowStyleMetaData=function(t){var f=t.totalRowSetting,i={HorizontalAlignment:n.CellHorizontalAlignment.General,VerticalAlignment:n.CellVerticalAlignment.Center,Formatter:null,WordWrap:!1,FontFamily:n.LocaleFonts.default,FontStyle:n.StaticValues.Font_Normal,FontWeight:n.StaticValues.Font_Normal,TextIndent:1},r=f===null||f===void 0?void 0:f.StyleMetaData,u;if(r)for(u in r)r[u]!==undefined&&(i[u]=r[u]);return(n.Common.IsEmpty(i.FontSize)||i.FontSize<=0)&&(i.FontSize=n.StaticValues.DefaultFontSizeInPx),i},i.prototype.handleTotalRowCellTypeStyle=function(t,i){t.forceBackColor=i.backColor||n.ColorHelper.Convert(this.listViewStyleTemplate&&this.listViewStyleTemplate.TotalRowBack)||"transparent";i.backColor=undefined;i.foreColor=i.foreColor||n.ColorHelper.Convert(this.listViewStyleTemplate&&this.listViewStyleTemplate.TotalRowFore)||"#000000"},i.prototype.clearTotalRowCellTypeAndStyle=function(){var t=this,n=this.totalRowIndex;n>=0&&this.listviewData.visibleColumns.forEach(function(i,r){t._sheet.setStyle(n,r,null,GC.Spread.Sheets.SheetArea.viewport);t._sheet.setCellType(n,r,undefined,GC.Spread.Sheets.SheetArea.viewport)})},i.prototype.setDataToSpreadJSNow=function(n,t){if(n===void 0&&(n=-1),t===void 0&&(t=-1),this._sheet){this._sheet.suspendPaint();this.clearTotalRowCellTypeAndStyle();this._newRowIndex!==-1&&this.processNoneEditCellTypeInNewRow(!1);var i=this.getBindingDataSource();this._sheet.setDataSource(i);this.setTotalRowCellTypeAndStyle();this.refreshTotalRowIndexInListViewStyleTemplate();this.allowAddRow()?(this._newRowIndex=this.lastDataRowIndexInView+1,this.processNoneEditCellTypeInNewRow(!0)):this._newRowIndex=-1;this.refreshConditionFormat();this.refreshAutoMerge(n,t);this.autoFit();this._sheet.resumePaint();this.onRowHeightOrRowCountChanged();this.repaintConditionFormatDepenceListview();this.updateNodata()}},i.prototype.repaintConditionFormatDepenceListview=function(){var t=this;n.ForguncyData.pageInfo.pageElementManager.listviewCollection.listviews.filter(function(n){return n._conditionFormatDependenceListviews&&n._conditionFormatDependenceListviews.indexOf(t.getCalcSheetName())>=0}).forEach(function(n){return n.repaint()})},i.prototype.initConditionFormatCalc=function(){n.ForguncyData.pageInfo.formulaManager.addCalcSource(new n.ConditionFormatCalcSource(n.ForguncyData.pageInfo.formulaManager.getCalcService(),this.getConditionFormatCalcSourceName(),this.getListDataModel(),this));this.setCalcService(n.ForguncyData.pageInfo.formulaManager.getCalcService())},i.prototype.initConditionFormatFormula=function(){for(var f,i=this,r=new n.ConditionFormatFormulaHelper(i.runTimePageName),e=function(t){var i=t.getTemplateCell(),u,o,f,e,s;if(i.IsContainSpecificFormulaRule&&(!i||!i.ConditionalFormattingMetadata||!i.ConditionalFormattingMetadata.Rules||i.ConditionalFormattingMetadata.handledRules)||!i.IsContainSpecificFormulaRule&&(!i.ConditionalFormattingGuids||i.ConditionalFormattingMetadata&&i.ConditionalFormattingMetadata.handledRules))return"continue";for(u=[],i.IsContainSpecificFormulaRule?u=i.ConditionalFormattingMetadata.handledRules=n.Common.clone(i.ConditionalFormattingMetadata.Rules):(o=n.ForguncyData.pageInfo.ConditionalFormattingMetadata,i.ConditionalFormattingGuids&&(i.ConditionalFormattingMetadata=new n.ConditionalFormattingMetadata,u=i.ConditionalFormattingGuids.map(function(t){return n.Common.clone(o.Rules.find(function(n){return n.GUID===t}))}),i.ConditionalFormattingMetadata.handledRules=u)),f=0,e=u;f<e.length;f++)s=e[f],r.HandleFormulaInConditionFormat(s)},t=0,u=i.listviewData.visibleColumns;t<u.length;t++)f=u[t],e(f);this.addDependenceHandler(r)},i.prototype.addDependenceHandler=function(t){var i=this,r=t.getDependences();r&&r.length>0&&n.DependenceCellValueChangeHelper.listenFormulaRefChanged(r,function(){i.repaint()},i.runTimePageName);t.dependenceListviews.filter(function(n){return n!==i.getCalcSheetName()&&i._conditionFormatDependenceListviews.indexOf(n)===-1}).forEach(function(n){return i._conditionFormatDependenceListviews.push(n)})},i.prototype.getConditionFormatCalcSourceName=function(){return this.getCalcSheetName()+"c"},i.prototype.getSheetRowCount=function(){return this._sheet.getRowCount()},i.prototype.getListViewRules=function(){for(var u,t,r,n=[],i=0;i<this.listviewData.visibleColumns.length;i++)(u=this.listviewData.visibleColumns[i],t=u.getTemplateCell(),t&&t.ConditionalFormattingMetadata)&&(r=t.ConditionalFormattingMetadata.handledRules,r&&r.forEach(function(t){n.find(function(n){return n.GUID===t.GUID})||n.push(t)}));return n.sort(function(n,t){return n.Priority-t.Priority}),n},i.prototype.checkRuleIsInRange=function(n){return n.RuleType===10?!1:!0},i.prototype.addSettedRangeConditionRules=function(){var f=this.firstDataRowIndexInView,u=this._listData.getRowCount(),e=this.getListViewRules(),r;if(!(u<=0)){var o=new n.ConditionFormatRuleHelper,h=function(n){var c=e[n],l=[],w=c.GUID,r,y,h,a,v,p;for(t=null,r=0;r<i.listviewData.visibleColumns.length;r++)(y=i.listviewData.visibleColumns[r],h=y.getTemplateCell(),h&&h.ConditionalFormattingMetadata)&&(a=h.ConditionalFormattingMetadata.handledRules,v=a.find(function(n){return n.GUID===w}),a&&v&&(t==null&&(t=h.StyleInfo),i.checkRuleIsInRange(c)?l.push(new GC.Spread.Sheets.Range(f,r,u,1)):(s=o.ConvertConditionRuleToSpreadJSByRanges(t,v,[new GC.Spread.Sheets.Range(f,r,u,1)]),i._sheet.conditionalFormats.addRule(s),t=null)));l.length>0&&(p=o.ConvertConditionRuleToSpreadJSByRanges(t,c,l),i._sheet.conditionalFormats.addRule(p),t=null)},i=this,t,s;for(r=0;r<e.length;r++)h(r)}},i.prototype.refreshConditionFormat=function(){var o=this.firstDataRowIndexInView,u=this._listData.getRowCount(),t,r,i,f,e;if(this._sheet.conditionalFormats.clearRule(),!(u<=0))for(this.listViewStyleTemplate&&((this.listViewStyleTemplate.RowHoverBack||this.listViewStyleTemplate.RowHoverFore)&&(t=new GC.Spread.Sheets.Style,this.listViewStyleTemplate.RowHoverBack&&(t.backColor=n.ColorHelper.Convert(this.listViewStyleTemplate.RowHoverBack)),this.listViewStyleTemplate.RowHoverFore&&(t.foreColor=n.ColorHelper.Convert(this.listViewStyleTemplate.RowHoverFore)),r=[new GC.Spread.Sheets.Range(-1,-1,-1,-1)],this._sheet.conditionalFormats.addRowStateRule(GC.Spread.Sheets.RowColumnStates.hover,t,r)),(this.listViewStyleTemplate.RowSelectBack||this.listViewStyleTemplate.RowSelectFore)&&(t=new GC.Spread.Sheets.Style,this.listViewStyleTemplate.RowSelectBack&&(t.backColor=n.ColorHelper.Convert(this.listViewStyleTemplate.RowSelectBack)),this.listViewStyleTemplate.RowSelectFore&&(t.foreColor=n.ColorHelper.Convert(this.listViewStyleTemplate.RowSelectFore)),r=[new GC.Spread.Sheets.Range(-1,-1,-1,-1)],this._sheet.conditionalFormats.addRowStateRule(GC.Spread.Sheets.RowColumnStates.selected,t,r))),this.addSettedRangeConditionRules(),i=0;i<this.listviewData.visibleColumns.length;i++)f=this.listviewData.visibleColumns[i],e=new GC.Spread.Sheets.Range(o,i,u,1),this.addDirtyConditionRule(f,e)},i.prototype.addDirtyConditionRule=function(t,i){var u=t.columnInfo.Index,r,f,e;this.shouldAddDirtyConditionRule(u)&&(r=new GC.Spread.Sheets.Style,r.borderBottom=new GC.Spread.Sheets.LineBorder(this.getDirtyCellMarkColor(),GC.Spread.Sheets.LineStyle.thick),f=n.Common.format('=ISDIRTY({0},"{1}",ROW()-{2},{3})',this.locatedPageID,this.getCalcSheetName(),i.row+1,u),e=new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(GC.Spread.Sheets.ConditionalFormatting.RuleType.formulaRule,[i],r,null,null,null,null,f),this._sheet.conditionalFormats.addRule(e))},i.prototype.getDirtyCellMarkColor=function(){var i,t;return this._dirtyCellColor||(t=n.ColorHelper.Convert((i=this.listViewStyleTemplate)===null||i===void 0?void 0:i.DirtyCellColor),n.Common.IsEmpty(t)?t="#F3DB92":this.isTransparent(t)&&(t="transparent"),this._dirtyCellColor=t),this._dirtyCellColor},i.prototype.isTransparent=function(n){if(!n||n.indexOf("rgba(")!==0)return!1;var t=n.lastIndexOf(",")+1,i=n.substr(t,n.length-t-1);return Number(i)===0},i.prototype.shouldAddDirtyConditionRule=function(n){return n>=0&&this.listviewData.ShowEditStatusIcon()&&this.getDirtyCellMarkColor()!=="transparent"&&this.getAllowDirtyColumns().indexOf(n)>=0},i.prototype.getAllowDirtyColumns=function(){var t,n;if(!this._allowDirtyColumns)for(this._allowDirtyColumns=[],t=this._listData.getColumnCount(),n=0;n<t;n++)this.getAllowEditedBindingInfo(n)&&this._allowDirtyColumns.push(n);return this._allowDirtyColumns},i.prototype.getRowState=function(n){var t,r,i;if(!this.listviewData.ShowEditStatusIcon()||this.isGroupMode()||(t=this.mappedRowIndexFrowView(n),t<0||t>=this._listData.getRowCount()))return 0;if(!this._listData.getRowQuery(t))return 2;for(r=this.getAllowDirtyColumns(),i=0;i<this._listData.getColumnCount();i++)if(this._listData.isDirty(t,i)&&r.indexOf(i)>=0)return 1;return 0},i.prototype.refreshAutoMerge=function(t,i){for(var u,f,e,o=[],r=0;r<this.listviewData.visibleColumns.length;r++)this.listviewData.visibleColumns[r].columnInfo.AllowAutoMerge&&o.push(r);u=this.allowShowTotalRow();f=0;u&&this.listviewData.getIsTotalRowAtFirstRow()&&(f=1);e=this._sheet.getRowCount();u&&this.listviewData.getIsTotalRowAtLastRow()&&(e-=1);t>=0&&(t=this.mappedRowIndexFromData(t));n.ListViewHelper.AutoMergeHelper.autoMerge(this._sheet,o,t,i,f,e)},i.prototype.setCalcService=function(n){this._sheet.setCalc(n,null)},i.prototype.repaint=function(){this._sheet.repaint()},i.prototype.processNoneEditCellTypeInNewRow=function(t){var u,i,r,f;if(!(this._sheet.getRowCount()<=this._newRowIndex)&&this.listviewData.visibleColumns)for(u=this.listviewData.visibleColumns.length,i=0;i<u;i++)r=this.listviewData.visibleColumns[i],f=r.cellType.shouldDisplayInListviewNewRow()||!t?undefined:new n.SpreadJSViewTextCellType(r.getTemplateCell(),this.oddRowBackcolor,this.evenRowBackcolor,this.runTimePageName,this.designerPageName,this.listviewData.getListviewName(),this.getCalcSheetName(),this.listViewStyleTemplate),this._sheet.setCellType(this._newRowIndex,i,f)},i.prototype.getBindingDataSource=function(){var n=[],t=this._listData.getRowCount();return this.fillDataSource(n,0,t),this.allowAddRow()&&n.push(this.getBindingDataSourceOfNewRow()),this.allowShowTotalRow()&&(this.listviewData.getIsTotalRowAtFirstRow()?n.unshift(this.getTotalRowDataSource()):n.push(this.getTotalRowDataSource())),n},i.prototype.getBindingDataSourceOfNewRow=function(){for(var t,r,e=this._listData.getRowCount(),o=this.listviewData.visibleColumns.length,f={},u=0;u<o;u++)t=this.listviewData.visibleColumns[u],r=t===null||t===void 0?void 0:t.getDefaultValue(this.getCalcSheetName(),this.runTimePageName,e),r=n.Common.IsEmpty(r)?null:this.adjustValue(r,t),f[i.ColumnPrefix+u]=r;return f},i.prototype.fillDataSource=function(n,t,r){for(var o,h,u,s,e,c=this.listviewData.visibleColumns.length,f=t;f<t+r;f++){for(o={},h=this._listData.getRowValue(f),u=0;u<c;u++)s=this.listviewData.visibleColumns[u],e=h[s.getColumnIndex()],e=this.adjustValue(e,s),o[i.ColumnPrefix+u]=e;n[f]=o}},i.prototype.adjustValue=function(t,i){var u=i.cellType.constructor,r,f,e;if(u===n.ImageCellType||u===n.UploadImageCellType){r=i.getTemplateCell();f=r.Value;try{return r.Value=t,n.ImageHelper.getImageSrcFromCellContentElement(r,!1,!1)}finally{r.Value=f}}else if(i.cellType.constructor===n.PasswordCellType)return e=n.ListviewEditorHelper.getCell(i.getTemplateCell(),this.runTimePageName,this.designerPageName,this.listviewData.getListviewName()),e.cellType.getListviewNoneEditModeText(t);return t===undefined?null:t},i.prototype.getTotalRowDataSource=function(){var t=this,n={};return this.listviewData.visibleColumns.forEach(function(r,u){var f=r.columnInfo.TotalRowCell;n[i.ColumnPrefix+u]=t.getTotalRowStaticValue(f)}),n},i.prototype.getTotalRowStaticValue=function(t){var r,u,i,f;return t&&t.FormulaType===0&&t.StatisticFormula?((r=n.ListViewHelper.PreviewHelper)===null||r===void 0?void 0:r.ForPreview)?n.Common.getMultiLanguageWord(t.StatisticFormula):(i=t.StatisticFormula,f=(u=i===null||i===void 0?void 0:i.startsWith("="))!==null&&u!==void 0?u:!1,f)?n.ForguncyData.pageInfo.formulaManager.evaluateFormula(i,{runTimePageName:this.runTimePageName}):n.Common.getMultiLanguageWord(t.StatisticFormula):t&&t.FormulaType!==0?t.Value:null},i.prototype.handleTotalRowFormulaDependenceCells=function(){for(var t=this,u=function(i){var u=r.listviewData.visibleColumns[i].columnInfo,f=u===null||u===void 0?void 0:u.TotalRowFormulaDependenceCells;if(!f)return"continue";n.DependenceCellValueChangeHelper.listenFormulaRefChanged(f,function(){var n=t.getTotalRowStaticValue(u.TotalRowCell);t.allowShowTotalRow()&&(t.listviewData.getIsTotalRowAtFirstRow()?t._sheet.setValue(0,i,n):t._sheet.setValue(t._sheet.getRowCount()-1,i,n))},r.runTimePageName)},r=this,i=0;i<this.listviewData.visibleColumns.length;i++)u(i)},i.prototype.initRowHeaderStyle=function(){var t=this.createHeaderStyle(this.listviewData.rowHeaderColumnInfo.columnInfo.TemplateCell,n.HeaderType.RowHeader);return t&&this._sheet.setStyle(-1,0,t,GC.Spread.Sheets.SheetArea.rowHeader),t},i.prototype.createHeaderStyle=function(n,t){var r=i.createStyleByCell(n);return this.adjustHeaderStyleByTemplate(r,t)},i.prototype.adjustHeaderStyleByTemplate=function(t,i){var o,s,r,u,e;if(!this.listViewStyleTemplate)return t;t=t||new GC.Spread.Sheets.Style;t.backColor==="#E1E1E1"&&(t.backColor=n.ColorHelper.Convert(this.listViewStyleTemplate.ColumnHeaderBack));t.foreColor==="#262626"&&(t.foreColor=n.ColorHelper.Convert(this.listViewStyleTemplate.ColumnHeaderFore));var f="#C8C8C8",h=!1,c=!1,l=!1,a=!1,v=this.listViewStyleTemplate.ColumnHeaderBorder;return i===n.HeaderType.ColumnHeader?(f=(o=n.ColorHelper.Convert(this.listViewStyleTemplate.ColumnHeaderGridLineColor))!==null&&o!==void 0?o:f,h=this.listViewStyleTemplate.ShowColumnHeaderHorizontalGridLine,c=this.listViewStyleTemplate.ShowColumnHeaderVerticalGridLine):(i===n.HeaderType.RowHeader||i===n.HeaderType.CheckBoxRowHeader)&&(f=(s=n.ColorHelper.Convert(this.listViewStyleTemplate.RowHeaderGridLineColor))!==null&&s!==void 0?s:f,h=this.listViewStyleTemplate.ShowRowHeaderHorizontalGridLine,c=this.listViewStyleTemplate.ShowRowHeaderVerticalGridLine),r=v,u=v,h&&!r&&(r=f,l=!0),c&&!u&&(u=f,a=!0),u=u!==null&&u!==void 0?u:"transparent",r=r!==null&&r!==void 0?r:"transparent",e=new GC.Spread.Sheets.LineBorder(n.ColorHelper.Convert(r),GC.Spread.Sheets.LineStyle.thin),n.Common.IsEmpty(t.borderTop)&&!l&&(t.borderTop=e),n.Common.IsEmpty(t.borderBottom)&&(t.borderBottom=e),e=new GC.Spread.Sheets.LineBorder(n.ColorHelper.Convert(u),GC.Spread.Sheets.LineStyle.thin),n.Common.IsEmpty(t.borderLeft)&&!a&&(t.borderLeft=e),n.Common.IsEmpty(t.borderRight)&&(t.borderRight=e),t},i.prototype.getBindingColumnInfos=function(){for(var t=this.listviewData.visibleColumns,r=[],u=t.length,n=0;n<u;n++)r.push({name:i.ColumnPrefix+n,size:t[n].columnInfo.Width});return r},i.prototype.selectInEditor=function(n,t,i){var r=this.mappedRowIndexFromData(n);r>=0&&r<this._sheet.getRowCount()&&(t===undefined&&(t=this._sheet.getActiveColumnIndex()),(r!==this._sheet.getActiveRowIndex()||t!==this._sheet.getActiveColumnIndex())&&(this.cancelEdit(),this._sheet.setActiveCell(r,t),this._sheet.showCell(r,t,GC.Spread.Sheets.VerticalPosition.nearest,GC.Spread.Sheets.HorizontalPosition.nearest),i===null||i===void 0?void 0:i()))},i.prototype.cancelInput=function(){GC.Spread.Sheets.Commands.cancelInput.execute(this._spread,{sheetName:this._sheet.name()},!1)},i.prototype.editAndValidateCell=function(t,i,r){var u,e,f;if(this._waitValidateRows.indexOf(t)>=0)n.Common.remove(this._waitValidateRows,t);else return;if(u=this.mappedRowIndexFromData(t),(this._sheet.getActiveRowIndex()!==u||this._sheet.getActiveColumnIndex()!==i)&&(this._sheet.isEditing()&&this.cancelInput(),this._sheet.setActiveCell(u,i),this.onSelectionChanged()),!this._sheet.isEditing()){if(e=this.getGlobalActiveSheet(),!n.Common.IsEmpty(e)&&e!==this._sheet)return;this._sheet.showCell(u,i,GC.Spread.Sheets.VerticalPosition.nearest,GC.Spread.Sheets.HorizontalPosition.nearest);this._sheet.startEdit();f=this._sheet.getCell(u,i).cellType();f&&f.validate&&f.validate(u,i,r)}},i.prototype.getGlobalActiveSheet=function(){var n=window.gcGlobal;return n?n.activeElement:null},i.prototype.getCurrentRowCenterY=function(){var r=this._listData.getCurrentRowIndex(),u=this._sheet.getActiveColumnIndex(),t,i;return r<0||u<0?-1:(t=this.mappedRowIndexFromData(r),t<0)?-1:(i=this._sheet.getCellRect(t,u).y,n.Common.IsEmpty(i))?-1:i+this._sheet.getRowHeight(t)/2},i.prototype.getMappedEditorSelectedRowIndex=function(){var i=this.getEditorRowCount(),t;return this._sheet&&i>0&&(t=this._sheet.getActiveRowIndex(),!n.Common.IsEmpty(t))?this.mappedRowIndexFrowView(t):undefined},i.prototype.endEdit=function(n,t){!this.hasDestroyed()&&this._sheet.getActiveRowIndex()===n&&this._sheet.getActiveColumnIndex()===t&&this._sheet.isEditing()&&this._sheet.endEdit()},i.prototype.stopEditingActiveCell=function(n){n===void 0&&(n=!1);var t=!!this._sheet.endEdit();return t===!1&&n&&this.scrollToView(),t},i.prototype.cancelEdit=function(){this._spread.commandManager().execute({cmd:"cancelInput",sheetName:this._sheet.name()})},i.prototype.getListviewControl=function(){return this._spread},i.prototype.getNewRowIndex=function(){return this._newRowIndex},i.prototype.protectListview=function(n){t.prototype.protectListview.call(this,n);this._sheet.options.isProtected=n},i.prototype.getValidateHelpInfoByViewIndex=function(n,t){var i=this.mappedRowIndexFrowView(n),r=this.listviewData.visibleColumns[t].getColumnIndex();return this.getValidateHelpInfo(i,r)},i.prototype.getCurrentColIndex=function(){var n=this._sheet.getActiveColumnIndex();return n<0||n>=this.listviewData.visibleColumns.length?-1:this.listviewData.visibleColumns[n].columnInfo.Index},i.prototype.isCurrentRowSameWithActiveCellRow=function(){return this.listviewData.allowShowTotalRow()&&this.listviewData.getIsTotalRowAtFirstRow()?this._sheet.getActiveRowIndex()===this._listData.getCurrentRowIndex()+1:this._sheet.getActiveRowIndex()===this._listData.getCurrentRowIndex()},i.prototype.showHorizontalScrollBar=function(n){if(n===undefined)return this._spread.options.showHorizontalScrollbar;this._spread.options.showHorizontalScrollbar=n},i.prototype.showVerticalScrollBar=function(n){if(n===undefined)return this._spread.options.showVerticalScrollbar;this._spread.options.showVerticalScrollbar=n},i.prototype.isEditing=function(){return this._sheet.isEditing()},i.prototype.getEditingValue=function(){return this._sheet.getCellType(-1,this._sheet.getActiveColumnIndex()).getEditorValue(null)},i.prototype._destroy=function(){this._onNormalCellValueChangedEventHandler&&n.ForguncyData.pageInfo.dataModel.normalCellDataModel.unbind("valuechanged",this._onNormalCellValueChangedEventHandler);var t=n.ForguncyData.pageInfo.formulaManager.getCalcSource(this.getConditionFormatCalcSourceName());t&&n.ForguncyData.pageInfo.formulaManager.removeCalcSourceByName(this.getConditionFormatCalcSourceName());this.removeSheetSource();this.setCalcService(new GC.Spread.CalcEngine.CalcService);this.destroySpread();this._stretchHelper&&this._stretchHelper.destroy()},i.prototype.removeSheetSource=function(){var i=n.ForguncyData.pageInfo.formulaManager.getCalcService(),r=i.getAllSourceModels(),u,t;for(u in r)if(t=r[u].getSource(),t.getSheet&&t.getSheet()===this._sheet){i.removeSource(t);break}},i.prototype.destroySpread=function(){var r,t,i;if(this._sheet){for(r=this._sheet.getColumnCount(),t=0;t<r;t++)i=this._sheet.getCellType(-1,t),i instanceof n.SpreadJSEditCellType&&i.destroy();this._sheet.unbindAll();this._sheet=null}if(this._spread){this._spread.unbindAll();try{this._spread.focus(!1)}catch(u){}this._spread.destroy();this._spread=null}},i.prototype.getControl=function(){return this._spread},i.prototype.clearSelectionOutOfCurrentRow=function(){var t=this;n.DelayRefresh.Push(this,function(){var n,i;if(!t.hasDestroyed()&&(n=t.getCurrentRowIndex(),n!==-1&&t._listData.getRowCount()>0)){i=t.mappedRowIndexFromData(n);t._sheet.setActiveCell(i,t._sheet.getActiveColumnIndex());t.clearSelectionIfDisableAutoSelectRow();t.onSelectionChanged(!1)}},"clearSelectionOutOfCurrentRow"+this.getCalcSheetName())},i.prototype.addSelectedRow=function(t){t=this.mappedRowIndexFromData(t);n.ListViewHelper.SelectionHelper.addSelectedRow(this,t);this.onSelectionChanged()},i.prototype.setSelectedRows=function(t){var i=this,r=t.filter(function(n){return n!==-1}).map(function(n){return i.mappedRowIndexFromData(n)});n.ListViewHelper.SelectionHelper.setSelectedRows(this,r);this.onSelectionChanged()},i.prototype.clearSelectedRow=function(t){t=this.mappedRowIndexFromData(t);n.ListViewHelper.SelectionHelper.clearSelectedRow(this,t);this.onSelectionChanged()},i.prototype.selectAllRows=function(){n.ListViewHelper.SelectionHelper.selectAllRows(this);this.onSelectionChanged()},i.prototype.clearAllSelectedRows=function(i){n.ListViewHelper.SelectionHelper.clearAllSelectedRows(this);t.prototype.clearAllSelectedRows.call(this,i)},i.getCanvas=function(t){var r=n.ListviewBase.getListviewByCalcSheetName(t);return r instanceof i?r.getContainerDiv().find("canvas")[0]:null},i.getCanvasPosition=function(n){var t=$(i.getCanvas(n)).position();return t||(t={top:0,left:0}),t},i.getBounds=function(t){var r=n.ListviewBase.getListviewByCalcSheetName(t);return r instanceof i?new GC.Spread.Sheets.Rect(0,0,$(r._divContainer).width(),$(r._divContainer).height()):new GC.Spread.Sheets.Rect(0,0,0,0)},i.getWorkBookByHost=function(n){return n.data("workbook")},i.prototype.setSelectionWithEvent=function(n,t,i,r){n=this.mappedRowIndexFromData(n);this._sheet.setSelection(n,t,i,r);this.onSelectionChanged()},i.prototype.isRowHeaderVisible=function(){return this.listviewData.isRowHeaderVisible()},i.prototype.isRowHeaderCheckBoxVisible=function(){return this.listviewData.isRowHeaderCheckBoxVisible()},i.prototype.getText=function(i,r){var f,e,u,s,o;return(i=this.mappedRowIndexFromData(i),i<0||i>=this._sheet.getRowCount())?"":(f=this.listviewData.rowHeaderColumnInfo,f&&f.getColumnIndex()===r)?this._sheet.getText(i,0,GC.Spread.Sheets.SheetArea.rowHeader):(e=this.listviewData.getColumnMetaData(r),e&&e.Width===0)?t.prototype.getText.call(this,i,r):(u=this.getVisibleColumnIndexInListViewByDataIndex(r),u===-1)?"":(s=this.listviewData.visibleColumns[u],o=s.cellType.constructor,o===n.ImageCellType||o===n.UploadImageCellType)?t.prototype.getText.call(this,i,r):this._sheet.getText(i,u)},i.prototype.focus=function(n){this._spread.focus(n)},i.prototype.getActualStyle=function(t,i){if(t=this.mappedRowIndexFromData(t),t<0||t>=this._sheet.getRowCount()||i<0||i>=this._sheet.getColumnCount())return null;var r=this._sheet.getActualStyle(t,i,GC.Spread.Sheets.SheetArea.viewport),u=new GC.Spread.Sheets.Style(r.backColor,r.foreColor);return u.textIndent=r.textIndent,n.CommandCellTypeHelper.setAlternativeRowColor(t,this.oddRowBackcolor,this.evenRowBackcolor,u,this.listViewStyleTemplate),u},i.prototype.getCellRect=function(n,t){return this._sheet.getCellRect(n,t)},i.prototype.getExportColmnMetadatas=function(){return this.listviewData.visibleColumns.map(function(n){return n.columnInfo})},i.prototype.getColumnWidth=function(n){return this._sheet.getColumnWidth(n)},i.prototype.getAutoFitWidth=function(n){return this._columnAutoWidths[n]},i.prototype.allowSortByColumn=function(n){var r=this.listviewData.getColumnOperation(),i,t;return r!==1&&r!==2?!1:this.tryCommitValueBeforeQueryOrSort(!0)?(i=this.listviewData.visibleColumns,!i)?!1:(t=i[n],t.getIsFilterListCompareType())?!1:t.allowFieldSort()?!0:this.allowNoFieldSortFilter(t)?!0:!1:!1},i.prototype.allowNoFieldSortFilter=function(t){if(this.listviewData.getColumnOperation()!==2||!t.allowNoFieldSort())return!1;var i=n.ForguncyData.pageingInfoList.IsPageing(this.getLocationString());return i||this._isAllDataLoaded},i.prototype.sortByColumn=function(t,i){var l=this.allowSortByColumn(t),o,u,s,h,c;if(l){for(o=this.listviewData.visibleColumns,u=0;u<o.length;u++)s=this.listviewData.visibleColumns[u],h=null,t===u&&(h=n.Common.IsEmpty(i)?s.sortInfo===0?1:0:i),s.sortInfo=h;var f=n.ForguncyData,e=this.getLocationString(),r=o[t];f.pageInfo.sortInfoCache[e]||(f.pageInfo.sortInfoCache[e]={});c={ColumnName:n.ColumnInfoHelper.getColumnUniqueLocationKey(r.columnInfo),ColumnIndex:r.columnInfo.Index,ColumnBindingInfo:r.allowFieldSort()?r.getBindingInfo():null,Order:r.sortInfo};f.pageInfo.sortInfoCache[e].sortInfo=[c];this.listviewData.metadata.CacheColumnFilterAndSort&&n.ListviewStatusCacheHelper.autoSaveMetadataCacheDataAsync(this,{sort:f.pageInfo.sortInfoCache[e]});this.getListDataCount()<=0?this.refreshUI():r.allowFieldSort()?this.fillData():r.allowNoFieldSort()&&n.FormulaColumnSortFilterHelper.sortByColumn(this)}},i.prototype.resetDataAfterFilter=function(t){var i;this.listviewData.metadata.CacheColumnFilterAndSort&&n.ListviewStatusCacheHelper.autoSaveMetadataCacheDataAsync(this,{columnFilter:(i=n.ForguncyData.pageInfo.columnFilterQueryCache[this.getLocationString()])!==null&&i!==void 0?i:[]});t.allowFieldSort()?(this.resetToFirstPage(),this.fillData()):this.allowNoFieldSortFilter(t)&&n.FormulaColumnSortFilterHelper.filterByColumn(this)},i.prototype.onInitAllData=function(){var t=n.FormulaColumnSortFilterHelper.getFilteredAndSortData(this);t!==this.dataCache&&this._listData.setData(t)},i.prototype.allowSetTabOrder=function(){return!0},i.prototype.setTabIndex=function(t){this._tabIndex!==t&&(this._tabIndex=t,n.DomUtilities.setTabIndex($(this.getGcSheetFocusElementForTab()),t))},i.prototype.isDisableTabOrder=function(){return!this.listviewData.getAllowGetFocus()},i.prototype.getSettedTabIndex=function(){return this.listviewData.getTabIndex()},i.prototype.getDirectRunTimePageNames=function(){return null},i.ColumnPrefix="c",i.OriginalSpreadJSMethod={},i}(n.UIListviewBase);n.SpreadJSView=t})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},Forguncy;(function(n){var f,i=function(){function t(){}return t.getColumnCellType=function(n,i,r){for(var f,o=t.columnCellTypeInfos,u=0,e=o;u<e.length;u++)if(f=e[u],f.shouldUse(n,i,r))return f.createInstance(n,i,r);return y.createInstance(n,i,r)},t.register=function(n,i){t.columnCellTypeInfos.push({shouldUse:n,createInstance:i})},t.executeEditCommand=function(n,t,i,r){var u={cmd:"editCell",sheetName:n.name(),row:t,col:i,newValue:r,autoFormat:!1};n.getParent().commandManager().execute(u)},t.renderTextDecoration=function(n,t,i,r,u,f,e){n.strokeStyle=n.fillStyle;var o=0,h=0,s=.5,c=f<=12?12:f;h=Math.floor((c-12)/21+1);n.lineWidth=h;(h&1)==0&&(s=0);n.textAlign==="center"?i=i-u/2:n.textAlign==="right"&&(i=i-u);n.beginPath();(t&GC.Spread.Sheets.TextDecorationType.overline)===GC.Spread.Sheets.TextDecorationType.overline&&(o=Math.ceil(r+e-f-1)-s,n.moveTo(i,o),n.lineTo(i+u,o));(t&GC.Spread.Sheets.TextDecorationType.lineThrough)===GC.Spread.Sheets.TextDecorationType.lineThrough&&(o=Math.ceil(r+e-f/2)-s,n.moveTo(i,o),n.lineTo(i+u,o));(t&GC.Spread.Sheets.TextDecorationType.underline)===GC.Spread.Sheets.TextDecorationType.underline&&(o=Math.ceil(r+e-1)-s,n.moveTo(i,o),n.lineTo(i+u,o));n.stroke()},t.getStringWidthByCanvas=function(n,t,i){var r=new GC.Spread.Sheets.Style,u;return r.font=t,u={sheet:i,row:0,col:0,sheetArea:GC.Spread.Sheets.SheetArea.viewport},GC.Spread.Sheets.CellTypes.Base.prototype.getAutoFitWidth(n,n,r,1,u)},t.getTextHeight=function(n,t){var i=new GC.Spread.Sheets.Style,r;return i.font=n,r={sheet:t,row:0,col:0,sheetArea:GC.Spread.Sheets.SheetArea.viewport},GC.Spread.Sheets.CellTypes.Base.prototype.getAutoFitHeight("text","text",i,1,r)},t.getVisualStateName=function(n){for(var t in GC.Spread.Sheets.VisualState)if(GC.Spread.Sheets.VisualState[t]===n)return t.toLowerCase();return null},t.getCustomStyle=function(t,i,r,u){var f=t||new GC.Spread.Sheets.Style,e={};return r&&(u===GC.Spread.Sheets.VisualState.normal?e[GC.Spread.Sheets.VisualState.normal]={backColor:r.ColumnHeaderBack,foreColor:r.ColumnHeaderFore}:u===GC.Spread.Sheets.VisualState.selected?e[GC.Spread.Sheets.VisualState.selected]={backColor:r.ColumnHeaderSelectBack,foreColor:r.ColumnHeaderSelectFore}:u===GC.Spread.Sheets.VisualState.hover?e[GC.Spread.Sheets.VisualState.hover]={backColor:r.ColumnHeaderHoverBack,foreColor:r.ColumnHeaderHoverFore}:u===GC.Spread.Sheets.VisualState.highlight&&(e[GC.Spread.Sheets.VisualState.highlight]={backColor:r.ColumnHeaderHighlightBack,foreColor:r.ColumnHeaderHighlightFore})),u===GC.Spread.Sheets.VisualState.normal?(f.backColor||(f.backColor=r?n.ColorHelper.Convert(e[u].backColor):i.backgroundColor),n.Common.IsEmpty(f.foreColor)&&(f.foreColor=r?n.ColorHelper.Convert(e[u].foreColor):i.color)):(r&&e[u].backColor&&(f.backColor=n.ColorHelper.Convert(e[u].backColor)),r&&e[u].foreColor&&(f.foreColor=n.ColorHelper.Convert(e[u].foreColor))),f.backColor||(f.backColor=i.backgroundColor),f.foreColor||(f.foreColor=i.color),f},t.changeCursorAsPointer=function(t){var r=t.getParent(),i=n.SpreadJSView.getCanvas(r.name);i&&(i.style.cursor="pointer")},t.columnCellTypeInfos=[],t}(),t,a,r,v,y,et,o,p,w,s,b,k,d,h,e,c,ut,ot,u,l,st,g,ht,ct,nt,ft,lt,tt,it,rt;n.SpreadJSCellTypeHelper=i;t=function(){function t(){}return t.processMouseMove=function(n){if(n){var t=n.sheet;t&&(t.isEditing()&&t.getActiveRowIndex()===n.row&&t.getActiveColumnIndex()===n.col||i.changeCursorAsPointer(t))}},t.processMouseLeave=function(t){var r=t.sheet,u,i;r&&(u=r.getParent(),i=n.SpreadJSView.getCanvas(u.name),i&&(i.style.cursor="default"))},t.shouldUsePointerCursor=function(n){return n&&n.length>0},t.setAlternativeRowColor=function(t,i,r,u,f){var e,o;return u=u||new GC.Spread.Sheets.Style,e=t,f&&f.ShowTotalRowAtFirstRow&&(e-=1),u.backColor||(o=e%2==0?r:i,o&&o!=="transparent"?u.backColor=n.ColorHelper.Convert(o):this.setStyleTemplateBackColor(u,f,e)),u.foreColor||this.setStyleTemplateForeColor(u,f,e),u},t.setStyleTemplateBackColor=function(t,i,r){if(i){var u=r%2==0?i.EvenRowBack:i.OddRowBack;u&&(t.backColor=n.ColorHelper.Convert(u))}},t.setStyleTemplateForeColor=function(t,i,r){if(i){var u=r%2==0?i.EvenRowFore:i.OddRowFore;u&&(t.foreColor=n.ColorHelper.Convert(u))}},t.getHitInfo=function(n,t,i,r,u,f){var e,o;return f?(e=f.sheetArea,(e===null||e===undefined||e===u)&&r)?(o={x:n,y:t,row:f.row,col:f.col,cellRect:r,sheetArea:e,sheet:f.sheet},r.x<=n&&n<r.x+r.width&&r.y<=t&&t<r.y+r.height&&(o.isReservedLocation=!0),o):null:null},t.processMouseDown=function(n,t){if(!t)return!1;var i=t.sheet;return i&&t.isReservedLocation&&!n._isMouseDownReservedLocation?(n._isMouseDownReservedLocation=!0,!0):!1},t.processMouseUp=function(n,i,r,u,f,e){if(!i)return!1;var o=i.sheet;return n._isMouseDownReservedLocation&&o&&i.isReservedLocation&&(n._isMouseDownReservedLocation=!1,t.triggerButtonClicked(o,r,u,i.sheetArea,f,i),e&&e.apply(n,[i])),!1},t.triggerButtonClicked=function(t,i,r,u,f,e){var o,s;if(u===f&&i!==undefined&&r!==undefined&&(o=t.getParent(),o)&&(s=n.ListviewBase.getListviewByCalcSheetName(o.name),s))s.onCellTypeClicked({row:i,col:r,sheetArea:u,x:e&&e.x,y:e&&e.y})},t}();n.CommandCellTypeHelper=t;a=function(i){function u(n,t,r,u){var f=i.call(this)||this;return f._cellMetaData=n,f._oddRowBackcolor=t,f._evenRowBackcolor=r,f._listViewStyleTemplate=u,f.useNormalStyleFontColorReplaceForeColor=!1,f.useNormalStyleBackColorReplaceBackColor=!1,f._hoveredY=-100,f.typeName="SpreadJSViewButtonCellType",f._cellMetaData.StyleInfo.Background&&f.buttonBackColor(f._cellMetaData.StyleInfo.Background),f._updateMargin(),f}return __extends(u,i),u.shouldUse=function(t,i){return i.cellType.constructor===n.ButtonCellType},u.createInstance=function(n,t,i){return new u(i,n.oddRowBackcolor,n.evenRowBackcolor,n.listViewStyleTemplate)},u.prototype._updateMargin=function(){var t=this.getTemplateStyle(r.Normal),n;t&&(n=this.getMargin(t),this.marginLeft(2+n.left),this.marginRight(2+n.right),this.marginTop(2+n.top),this.marginBottom(2+n.bottom))},u.prototype.paint=function(r,u,f,e,o,s,h,c){var a,v,y,p,w,b,k,l=n.CellTypeStyleTemplateUtils.GetStyleTemplateByKey(this._cellMetaData.CellType.$type.split(",")[0],this._cellMetaData.CellType.TemplateKey,n.ForguncyData.GlobalSettings.CellTypeStyleTemplates);this.useNormalStyleFontColorReplaceForeColor=!h.foreColor&&((y=(v=(a=l===null||l===void 0?void 0:l.Styles)===null||a===void 0?void 0:a.BUTTON)===null||v===void 0?void 0:v.NormalStyle)===null||y===void 0?void 0:y.FontColor)?!0:!1;this.useNormalStyleBackColorReplaceBackColor=!h.backColor&&((b=(w=(p=l===null||l===void 0?void 0:l.Styles)===null||p===void 0?void 0:p.BUTTON)===null||w===void 0?void 0:w.NormalStyle)===null||b===void 0?void 0:b.Background)?!0:!1;this._backcolorInfo={row:c.row,col:c.col,backColor:(k=h.backColor)===null||k===void 0?void 0:k.toLocaleLowerCase()};h=t.setAlternativeRowColor(c.row,this._oddRowBackcolor,this._evenRowBackcolor,h,this._listViewStyleTemplate);i.prototype.paint.call(this,r,u,f,e,o,s,h,c)},u.prototype.getButtonState=function(n,t,i){return n.getActiveRowIndex()!==t||n.getActiveColumnIndex()!==i?r.Normal:this.buttonState()},u.prototype.setRoundRectBackground=function(n,t,i,r,u,f){var c,h,l,w,b;if(t.indexOf("gradient")>-1){if(c=t.slice(0,t.indexOf("(")),h=t.slice(t.indexOf("(")+1),c==="linear-gradient"){var v=h.substring(0,h.length-2).split(", "),y=v[0],p=v.slice(1),a=isNaN(parseInt(y))?0:parseInt(y);a=(a+180+90)%360/360;var e=a*2*Math.PI,o=void 0,s=void 0;e<=Math.PI/2?(o=(i*(3+Math.cos(2*e))+r*Math.sin(2*e))/4,s=(r*(3-Math.cos(2*e))+i*Math.sin(2*e))/4):e<=Math.PI?(e=e-Math.PI/2,o=(i*(1+Math.cos(2*e))-r*Math.sin(2*e))/4,s=(r*(3+Math.cos(2*e))+i*Math.sin(2*e))/4):e<=3*Math.PI/2?(e=e-Math.PI,o=(i*(1-Math.cos(2*e))-r*Math.sin(2*e))/4,s=(r*(1+Math.cos(2*e))-i*Math.sin(2*e))/4):(e=e-3*Math.PI/2,o=(i*(3-Math.cos(2*e))+r*Math.sin(2*e))/4,s=(r*(1-Math.cos(2*e))-i*Math.sin(2*e))/4);w=i-o;b=r-s;l=n.createLinearGradient(u+w,f+b,u+o,f+s);p.forEach(function(n){var t=n.trim().split(" ").map(function(n){return n.trim()}),r=t[0],u=t[1],i=parseFloat(u)/100;isNaN(i)||l.addColorStop(i,r)})}else if(c==="radial-gradient"){var p=h.substring(0,h.length-2).split(", "),nt=Math.max(i,r)/2*1.1,k=u+i/2,d=f+r/2,g=n.createRadialGradient(k,d,0,k,d,nt);p.forEach(function(n){var t=n.trim().split(" ").map(function(n){return n.trim()}),r=t[0],u=t[1],i=parseFloat(u)/100;isNaN(i)||g.addColorStop(i,r)});n.fillStyle=g}n.fillStyle=l}else n.fillStyle=t},u.prototype.drawBackGround=function(n,t,i,r,u,f,e){var a=0,s=n,h=t,c=i,l=r,o={tr:u.tr,tl:u.tl,bl:u.bl,br:u.br};Object.keys(e).forEach(function(n){var t=e[n];t.width===1&&a++});a===4&&(s=s+.75,h=h+.75,c=c-.75,l=l-.75);o=this.updateRadius(o,c,l);f.beginPath();f.moveTo(s+o.tl,h);f.lineTo(s+c-o.tr,h);f.arc(s+c-o.tr,h+o.tr,o.tr,Math.PI/180*270,0,!1);f.lineTo(s+c,h+l-o.br);f.arc(s+c-o.br,h+l-o.br,o.br,0,Math.PI/2,!1);f.lineTo(s+o.bl,h+l);f.arc(s+o.bl,h+l-o.bl,o.bl,Math.PI/2,Math.PI*1,!1);f.lineTo(s,h+o.tl);f.arc(s+o.tl,h+o.tl,o.tl,Math.PI*1,Math.PI/180*270,!1);f.closePath();f.fill()},u.prototype.drawBorder=function(n,t,i,r,u,f,e){var c,o;f=this.updateRadius(f,r,u);var s=function(t,i,r,u,f){n.beginPath();n.moveTo(t,i);n.lineTo(r,u);n.setLineDash&&n.setLineDash(f.lineDash||[]);n.lineWidth=f.width;n.strokeStyle=f.color;n.stroke()},l=function(n,t,i,r,u,f){if(f[u].width!==1)return[n,t,i,r];switch(u){case"bottom":return[n,t-.5,i,r-.5];case"left":return[n+.5,t,i+.5,r];case"right":return[n-.5,t,i-.5,r];case"top":return[n,t+.5,i,r+.5]}},h=function(n,t,i,r,u,f,e){var y=l(n,t,i,r,f,u),h=y[0],c=y[1],a=y[2],v=y[3],o=u[f];if(o.width!==0&&o.type!==0)if(o.type===1)s(h,c,a,v,o);else if(o.type===2){s(h,c,a,v,__assign(__assign({},o),{width:1}));var p=Math.max(2.5-e.tl,0),w=Math.max(2.5-e.tr,0),b=Math.max(2.5-e.br,0),k=Math.max(2.5-e.bl,0);switch(f){case"top":return s(h-w,c+2.5,a+p,v+2.5,__assign(__assign({},o),{width:1}));case"right":return s(h-2.5,c+w,a-2.5,v-b,__assign(__assign({},o),{width:1}));case"left":return s(h+2.5,c+p,a+2.5,v-k,__assign(__assign({},o),{width:1}));case"bottom":return s(h-b,c-2.5,a+k,v-2.5,__assign(__assign({},o),{width:1}))}}};h(t+r-f.br,i+u,t+f.bl,i+u,e,"bottom",f);h(t+r-f.tr,i,t+f.tl,i,e,"top",f);h(t,i+f.tl,t,i+u-f.bl,e,"left",f);h(t+r,i+f.tr,t+r,i+u-f.br,e,"right",f);c=function(t,i,r,u,f,e){var o=e;(r.width===1&&(o=o-.5,o=Math.max(o,0)),o<=0)||(n.beginPath(),n.setLineDash&&n.setLineDash(r.lineDash||[]),n.lineWidth=r.width,n.strokeStyle=r.color,n.arc(t,i,o,u,f),n.stroke())};o=function(n,t,i,r,u,f,e){var o=f[e];if(o!==0&&i.width!==0&&i.type!==0){if(i.type===1)return c(n,t,i,r,u,o);i.type===2&&(c(n,t,__assign(__assign({},i),{width:1}),r,u,o),c(n,t,__assign(__assign({},i),{width:1}),r,u,Math.max(o-2.5,0)))}};o(t+f.tl,i+f.tl,e.left,1*Math.PI,1.25*Math.PI,f,"tl");o(t+f.tl,i+f.tl,e.top,1.25*Math.PI,1.5*Math.PI,f,"tl");o(t+r-f.tr,i+f.tr,e.top,1.5*Math.PI,1.75*Math.PI,f,"tr");o(t+r-f.tr,i+f.tr,e.right,1.75*Math.PI,2*Math.PI,f,"tr");o(t+r-f.br,i+u-f.br,e.right,0,.25*Math.PI,f,"br");o(t+r-f.br,i+u-f.br,e.bottom,.25*Math.PI,.5*Math.PI,f,"br");o(t+f.bl,i+u-f.bl,e.bottom,.5*Math.PI,.75*Math.PI,f,"bl");o(t+f.bl,i+u-f.bl,e.left,.75*Math.PI,1*Math.PI,f,"bl")},u.prototype.parseBorderString=function(t){var i={type:1,width:0,color:"#000000",lineDash:undefined};if(!t)return i;var r=n.ColorHelper.ConvertBorder(t).split(" "),u=r[0],f=r[1],e=r[2];i.width=parseFloat(u);isNaN(i.width)&&(i.width=0);i.color=n.ColorHelper.Convert(e);switch(f){case"dotted":i.lineDash=[3,3];break;case"dashed":i.lineDash=[5,2];break;case"double":return i.type=2,i}return i},u.prototype.getBroderSetting=function(n){return{top:this.parseBorderString(n.BorderTopString||n.BorderString),left:this.parseBorderString(n.BorderLeftString||n.BorderString),right:this.parseBorderString(n.BorderRightString||n.BorderString),bottom:this.parseBorderString(n.BorderBottomString||n.BorderString)}},u.prototype.getRadius=function(n){if(n){var t=n.split(" ").map(function(n){return parseInt(n)}).map(function(n){return isNaN(n)?0:n});return{tl:t[0],tr:t[1],br:t[2],bl:t[3]}}},u.prototype.updateRadius=function(n,t,i){var u;if(n){var f=Math.max(n.tl+n.tr,n.bl+n.br),e=Math.max(n.tl+n.bl,n.tr+n.br),r=1;if(f>t&&(r=f/t),e>i&&(r=Math.max(r,e/i)),r>1)return u={},u.tl=n.tl/r,u.tr=n.tr/r,u.bl=n.bl/r,u.br=n.br/r,u}return n},u.prototype.getPadding=function(n){return{top:n.PaddingTop||0,right:n.PaddingRight||0,bottom:n.PaddingBottom||0,left:n.PaddingLeft||0}},u.prototype.getMargin=function(n){return{top:n.MarginTop||0,right:n.MarginRight||0,bottom:n.MarginBottom||0,left:n.MarginLeft||0}},u.prototype.drawRoundRect=function(n,t,i,r,u,f,e,o){this.setRoundRectBackground(n,f,r,u,t,i);this.drawBackGround(t,i,r,u,e,n,o);this.drawBorder(n,t,i,r,u,e,o)},u.prototype.isHover=function(n,t){return n<this._hoveredY&&this._hoveredY<n+t},u.prototype.paintValue=function(t,i,u,f,e,o,s,h){var rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,p,b,y,pt,it,nt,w,wt;if(t&&h.sheet){p=h.row===((rt=this._backcolorInfo)===null||rt===void 0?void 0:rt.row)&&h.col===((ut=this._backcolorInfo)===null||ut===void 0?void 0:ut.col)?this._backcolorInfo.backColor:undefined;(p===((et=n.ColorHelper.Convert((ft=this._listViewStyleTemplate)===null||ft===void 0?void 0:ft.RowHoverBack))===null||et===void 0?void 0:et.toLocaleLowerCase())||p===((st=n.ColorHelper.Convert((ot=this._listViewStyleTemplate)===null||ot===void 0?void 0:ot.RowSelectBack))===null||st===void 0?void 0:st.toLocaleLowerCase()))&&(p=undefined);b=(ht=s.foreColor)===null||ht===void 0?void 0:ht.toLocaleLowerCase();(b===((lt=n.ColorHelper.Convert((ct=this._listViewStyleTemplate)===null||ct===void 0?void 0:ct.RowHoverFore))===null||lt===void 0?void 0:lt.toLocaleLowerCase())||b===((vt=n.ColorHelper.Convert((at=this._listViewStyleTemplate)===null||at===void 0?void 0:at.RowSelectFore))===null||vt===void 0?void 0:vt.toLocaleLowerCase()))&&(b=undefined);var yt={bl:0,br:0,tl:0,tr:0},tt,k=this.getPadding({}),d=this.getMargin({}),g=this.getButtonState(h.sheet,h.row,h.col);this.isHover(f,o)&&g===r.Normal&&(g=r.Hover);y=this.getTemplateStyle(g);y&&(pt=this.getTemplateStyle(r.Normal),b=this.useNormalStyleFontColorReplaceForeColor?n.ColorHelper.Convert(y.FontColor||pt.FontColor):n.ColorHelper.Convert(b||y.FontColor),p=this.useNormalStyleBackColorReplaceBackColor?n.ColorHelper.Convert(y.Background||pt.Background):n.ColorHelper.Convert(p||y.Background),it=n.CSSHelper.getCssFontInfoFromCssFontString(s.font),y.Bold&&(it.fontWeight="bold"),y.Italic&&(it.fontStyle="italic"),y.Underline&&(s.textDecoration=1),s.font=n.CSSHelper.getCssFontStringFromCssFontInfo(it),tt=this.getBroderSetting(y),yt=this.getRadius(y.BorderRadiusString)||yt,k=this.getPadding(y),d=this.getMargin(y));var c=u+2+d.left,l=f+2+d.top,a=e-4-d.left-d.right,v=o-4-d.top-d.bottom,dt=c+a>u&&c<u+e&&l+v>f&&l<f+o;if(a-2>0&&v-2>0&&dt){t.save();(c<u||c+a>u+e||l<f||l+v>f+o)&&(t.rect(u,f,e,o),t.clip());t.beginPath();p=n.ColorHelper.Convert(p);p=p||(g===r.Pressed?n.ColorHelper.Convert("Accent 1"):"linear-gradient(180deg, #ECECEC 0.00%, #D5D5D5 100.00%)");nt={color:"#707070",width:1,type:1};tt=tt||{top:nt,left:nt,right:nt,bottom:nt};this.drawRoundRect(t,c,l,a,v,p,yt,tt);!y&&s.backColor&&(w=g===r.Pressed,t.strokeStyle="#646464",t.strokeRect(c+.5,l+.5,a-1,v-1),t.beginPath(),t.strokeStyle=w?"#ffffff":"#696969",t.moveTo(c+1.5,l+v-1.5),t.lineTo(c+a-1.5,l+v-1.5),t.stroke(),t.beginPath(),t.strokeStyle=w?"#ffffff":"#696969",t.moveTo(c+a-1.5,l+1.5),t.lineTo(c+a-1.5,l+v-1.5),t.stroke(),t.beginPath(),t.strokeStyle=w?"#696969":"#ffffff",t.moveTo(c+1.5,l+1.5),t.lineTo(c+a-1.5,l+1.5),t.stroke(),t.beginPath(),t.strokeStyle=w?"#696969":"#ffffff",t.moveTo(c+1.5,l+1.5),t.lineTo(c+1.5,l+v-1.5),t.stroke(),t.beginPath(),t.strokeStyle=w?"#f0f0f0":"#a0a0a0",t.moveTo(c+2.5,l+v-2.5),t.lineTo(c+a-2.5,l+v-2.5),t.stroke(),t.beginPath(),t.strokeStyle=w?"#f0f0f0":"#a0a0a0",t.moveTo(c+a-2.5,l+2.5),t.lineTo(c+a-2.5,l+v-2.5),t.stroke(),t.beginPath(),t.strokeStyle=w?"#a0a0a0":"#f0f0f0",t.moveTo(c+2.5,l+2.5),t.lineTo(c+a-2.5,l+2.5),t.stroke(),t.beginPath(),t.strokeStyle=w?"#a0a0a0":"#f0f0f0",t.moveTo(c+2.5,l+2.5),t.lineTo(c+2.5,l+v-2.5),t.stroke(),t.fillStyle!==p&&(t.fillStyle=p),t.fillRect(c+3,l+3,a-6,v-6));t.restore();var gt=c+k.left,ni=l+k.top,bt=a-k.left-k.right,kt=v-k.top-k.bottom;kt>0&&bt>0&&(wt=this.cloneStyle(s),wt.foreColor=b,GC.Spread.Sheets.CellTypes.Text.prototype.paintValue.call(this,t,i,gt,ni,bt,kt,wt,h))}}},u.prototype.cloneStyle=function(n){var i=n.cellType,t=null;try{n.cellType=undefined;t=n.clone();t.cellType=i}finally{n.cellType=i}return t},u.prototype.getTemplateStyle=function(t){var u=n.CellTypeStyleTemplateUtils.GetStyleTemplateByKey(this._cellMetaData.CellType.$type.split(",")[0],this._cellMetaData.CellType.TemplateKey,n.ForguncyData.GlobalSettings.CellTypeStyleTemplates),i;if(u){i=u.Styles.BUTTON.NormalStyle;switch(t){case r.Hover:i=__assign(__assign({},i),u.Styles.BUTTON.HoverStyle);break;case r.Pressed:i=__assign(__assign({},i),u.Styles.BUTTON.ActiveStyle)}return i}return null},u.prototype.overflow=function(n,t,i,r,u,f,e){return GC.Spread.Sheets.CellTypes.Text.prototype.overflow.call(this,n,t,i,r,u,f,e)},u.prototype.getAutoFitWidth=function(n,t,r,u,f){return this.text(t),i.prototype.getAutoFitWidth.call(this,n,t,r,u,f)},u.prototype.getAutoFitHeight=function(n,t,r,u,f){return this.text(t),i.prototype.getAutoFitHeight.call(this,n,t,r,u,f)},u.prototype.processMouseEnter=function(n){return n&&(this._hoveredY=n.cellRect.y,n.sheet.repaint(n.cellRect)),i.prototype.processMouseEnter.call(this,n)},u.prototype.processMouseMove=function(n){var f=this._hoveredY,u=!1,r;return(n===null||n===void 0?void 0:n.isReservedLocation)?(this._hoveredY=n.cellRect.y,u=f===-100):(this._hoveredY=-100,u=f!==-100),u&&n.sheet.repaint(n.cellRect),r=this._cellMetaData.CellType,r&&r.CommandList&&t.shouldUsePointerCursor(r.CommandList)&&t.processMouseMove(n),i.prototype.processMouseMove.call(this,n)},u.prototype.processMouseLeave=function(n){n&&(this._hoveredY=-100,n.sheet.repaint(n.cellRect));var r=this._cellMetaData.CellType;return r&&r.CommandList&&t.shouldUsePointerCursor(r.CommandList)&&t.processMouseLeave(n),i.prototype.processMouseLeave.call(this,n)},u.prototype.toJSON=function(){return null},u}(GC.Spread.Sheets.CellTypes.Button);n.SpreadJSViewButtonCellType=a;i.register(a.shouldUse,a.createInstance),function(n){n[n.Normal=0]="Normal";n[n.Hover=1]="Hover";n[n.Pressed=2]="Pressed"}(r||(r={}));v=function(n){function i(t,i,r){var u=n.call(this)||this;return u._oddRowBackcolor=t,u._evenRowBackcolor=i,u._listViewStyleTemplate=r,u}return __extends(i,n),i.prototype.paint=function(i,r,u,f,e,o,s,h){s=t.setAlternativeRowColor(h.row,this._oddRowBackcolor,this._evenRowBackcolor,s,this._listViewStyleTemplate);n.prototype.paint.call(this,i,r,u,f,e,o,s,h)},i.prototype.toJSON=function(){return null},i}(GC.Spread.Sheets.CellTypes.Text);n.SpreadJSViewCellTypeBase=v;y=function(n){function t(t,i,r,u,f,e,o,s,h){h===void 0&&(h=null);var c=n.call(this,i,r,s)||this;return c._cellMetaData=t,c.runTimePageName=u,c.designerPageName=f,c.listviewName=e,c._calcSheetName=o,c._visibleColumn=h,c._textCache={},c.typeName="SpreadJSViewTextCellType",c}return __extends(t,n),t.createInstance=function(n,i,r){return new t(r,n.oddRowBackcolor,n.evenRowBackcolor,n.runTimePageName,n.designerPageName,n.listviewData.getListviewName(),n.getCalcSheetName(),n.listViewStyleTemplate,i)},t.prototype.isTransformText=function(){var t,i,r,u,n=(t=this._visibleColumn)===null||t===void 0?void 0:t.getTemplateCell();return((i=n===null||n===void 0?void 0:n.CellType)===null||i===void 0?void 0:i.$type)==="Forguncy.DropDownListCellType, ServerDesignerCommon"||((r=n===null||n===void 0?void 0:n.CellType)===null||r===void 0?void 0:r.$type)==="Forguncy.RadioGroupCellType, ServerDesignerCommon"||((u=n===null||n===void 0?void 0:n.CellType)===null||u===void 0?void 0:u.$type)==="Forguncy.CheckBoxGroupCellType, ServerDesignerCommon"?!0:!1},t.prototype.getText=function(n,t){return this.isTransformText()?this.format(n,null,null,t):n},t.prototype.format=function(t,i,r,f){var e,s,o;if(!this._cellMetaData)return n.prototype.format.call(this,t,i,r);this.isTransformText()&&(t=f.sheet.getValue(f.row,f.col));try{return s=u.getFormulaListRowInfo(f,this._calcSheetName),o=u.getDisplayText(t,this._cellMetaData,this.runTimePageName,this.designerPageName,this.listviewName,i,s,r),this._textCache[t+""]=o,o}catch(h){return(e=this._textCache[t+""])!==null&&e!==void 0?e:t+""}},t}(v);n.SpreadJSViewTextCellType=y;et=function(n){function t(t,i,r,u,f){var e=n.call(this,null,null,null,t,i,r,u,f)||this;return e.typeName="SpreadJSViewTotalRowCellType",e}return __extends(t,n),t.prototype.paint=function(t,i,r,u,f,e,o,s){this.forceBackColor&&(o.backColor=this.forceBackColor);n.prototype.paint.call(this,t,i,r,u,f,e,o,s)},t}(y);n.SpreadJSViewTotalRowCellType=et;o=function(n){function i(){return n!==null&&n.apply(this,arguments)||this}return __extends(i,n),i.prototype.getHitInfo=function(n,i,r,u,f){return this.allowTriggerCommand(f.sheet,f.row,f.col)?t.getHitInfo(n,i,r,u,GC.Spread.Sheets.SheetArea.viewport,f):null},i.prototype.activateEditor=function(i,r,u,f){n.prototype.activateEditor.call(this,i,r,u,f);var e=i&&f&&f.sheet;if(e)$(i).on("click",function(){t.triggerButtonClicked(e,e.getActiveRowIndex(),e.getActiveColumnIndex(),f.sheetArea,GC.Spread.Sheets.SheetArea.viewport)})},i.prototype.processMouseDown=function(n){return t.processMouseDown(this,n)},i.prototype.processMouseUp=function(n){if(!n)return!1;var i=n.sheet;return t.processMouseUp(this,n,i.getActiveRowIndex(),i.getActiveColumnIndex(),GC.Spread.Sheets.SheetArea.viewport,this.onClick)},i.prototype.onClick=function(){},i.prototype.processMouseMove=function(n){if(n){var i=n.sheet;i&&n.isReservedLocation&&this.allowTriggerCommand(i,n.row,n.col)&&t.processMouseMove(n)}},i.prototype.processMouseLeave=function(n){if(n){var i=n.sheet;i&&n.isReservedLocation&&(this._isMouseDownReservedLocation=!1,this.allowTriggerCommand(i,n.row,n.col)&&t.processMouseLeave(n))}},i.prototype.allowTriggerCommand=function(){return!0},i.prototype.toJSON=function(){return null},i}(GC.Spread.Sheets.CellTypes.Base);n.SpreadJSCommandCellTypeBase=o;p=function(i){function r(n,t,r){var u=i.call(this)||this;return u._oddRowBackcolor=n,u._evenRowBackcolor=t,u._listViewStyleTemplate=r,u.typeName="SpreadJSViewHyperLinkCellType",u}return __extends(r,i),r.shouldUse=function(t,i){return i.cellType.constructor===n.HyperlinkCellType},r.createInstance=function(n){return new r(n.oddRowBackcolor,n.evenRowBackcolor,n.listViewStyleTemplate)},r.prototype.paint=function(n,r,u,f,e,o,s,h){s=t.setAlternativeRowColor(h.row,this._oddRowBackcolor,this._evenRowBackcolor,s,this._listViewStyleTemplate);i.prototype.paint.call(this,n,r,u,f,e,o,s,h)},r.prototype.allowTriggerCommand=function(t,i,r){var u=t.getText(i,r);return!n.Common.IsEmpty(u)},r}(o);n.SpreadJSViewHyperLinkCellType=p;i.register(p.shouldUse,p.createInstance);w=function(i){function u(n,t,r,u,f,e){var o=i.call(this)||this;return o._hoveredY=-100,o._pressY=-100,o._cellMetaData=n,o._oddRowBackcolor=t,o._evenRowBackcolor=r,o._listViewStyleTemplate=u,o._autofitWidth=f,o._runTimePageName=e,o.typeName="SpreadJSViewImageCellType",o._cellTypeMetaData=o._cellMetaData.CellType,o._cellTypeMetaData.ImageSizeMode===undefined&&(o._cellTypeMetaData.ImageSizeMode=0),o._cellTypeMetaData.HorizontalAlignment===undefined&&(o._cellTypeMetaData.HorizontalAlignment=1),o._cellTypeMetaData.VerticalAlignment===undefined&&(o._cellTypeMetaData.VerticalAlignment=1),o}return __extends(u,i),u.prototype.getAutoFitWidth=function(){return this._autofitWidth},u.shouldUse=function(t,i){return i.cellType.constructor===n.ImageCellType},u.createInstance=function(n,t,i){return new s(i,n.oddRowBackcolor,n.evenRowBackcolor,n.listViewStyleTemplate,t.columnInfo.Width,n.runTimePageName)},u.prototype.paint=function(u,f,e,o,s,h,c,l){var y,p,w,b,k,d=(y=c.foreColor)===null||y===void 0?void 0:y.toLocaleLowerCase(),v=n.CellTypeStyleTemplateUtils.GetStyleTemplateByKey(this._cellMetaData.CellType.$type.split(",")[0],this._cellMetaData.CellType.TemplateKey,n.ForguncyData.GlobalSettings.CellTypeStyleTemplates),g=r.Normal,a;if(this.isPress(o,h)?g=r.Pressed:this.isHover(o,h)&&(g=r.Hover),v){a=v.Styles.CONTAINER.NormalStyle;switch(g){case r.Hover:a=__assign(__assign({},a),v.Styles.CONTAINER.HoverStyle);break;case r.Pressed:a=__assign(__assign({},a),v.Styles.CONTAINER.ActiveStyle)}}c=t.setAlternativeRowColor(l.row,this._oddRowBackcolor,this._evenRowBackcolor,c,this._listViewStyleTemplate);(a===null||a===void 0?void 0:a.FontColor)&&(d&&d!==((w=n.ColorHelper.Convert((p=this._listViewStyleTemplate)===null||p===void 0?void 0:p.RowHoverFore))===null||w===void 0?void 0:w.toLocaleLowerCase())&&d!==((k=n.ColorHelper.Convert((b=this._listViewStyleTemplate)===null||b===void 0?void 0:b.RowSelectFore))===null||k===void 0?void 0:k.toLocaleLowerCase())||(c.foreColor=n.ColorHelper.Convert(a.FontColor)));f=n.ImageHelper.encodeImageUrlAndUpdateQuery(f,s,h);this.paintBackground(u,f,e,o,s,h,c.backColor,c.foreColor,l,a);c.backColor=undefined;i.prototype.paint.call(this,u,this._cellTypeMetaData.Text,e,o,s,h,c,l)},u.prototype.paintBackground=function(t,i,r,u,f,e,o,s,h,c){var nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,g,l,gt;if(t){var k=i,d=GC.Spread.Sheets.ImageLayout.none,y=r,p=u,a=f,v=e,bt=0,kt=0,dt=this._cellTypeMetaData.ImageSizeMode,w=this._cellTypeMetaData.HorizontalAlignment,b=this._cellTypeMetaData.VerticalAlignment;n.ImageDataHelper.IsSvg(k)&&(((nt=this._cellMetaData)===null||nt===void 0?void 0:nt.CellType)&&(pt=this._cellMetaData.CellType,wt=pt.Color,pt.UseCellForeColor&&(wt=s),g=n.ImageDataHelper.GetColoredSvgRectInfo(k,wt),g&&(k=g.value,bt=g.width,kt=g.height),c||(a>10&&(a-=6,y+=3),v>10&&(v-=6,p+=3))),dt=1,w=n.CellHorizontalAlignment.Center,b=n.CellVerticalAlignment.Center);c&&(v=v-((tt=c.MarginTop)!==null&&tt!==void 0?tt:0)-((it=c.MarginBottom)!==null&&it!==void 0?it:0),a=a-((rt=c.MarginLeft)!==null&&rt!==void 0?rt:0)-((ut=c.MarginRight)!==null&&ut!==void 0?ut:0),y+=(ft=c.MarginLeft)!==null&&ft!==void 0?ft:0,p+=(et=c.MarginTop)!==null&&et!==void 0?et:0);v<=0&&(v=0);a<=0&&(a=0);switch(dt){case 2:d=GC.Spread.Sheets.ImageLayout.stretch;break;case 1:if(d=GC.Spread.Sheets.ImageLayout.zoom,l=this.getImageSize(k,h),l===null)break;if(v>0&&l.height>0&&a/v>l.width/l.height){if(w===n.CellHorizontalAlignment.Center)break;a=l.width/l.height*v;w===n.CellHorizontalAlignment.Right&&(y=y+f-a-((ot=c===null||c===void 0?void 0:c.MarginRight)!==null&&ot!==void 0?ot:0)-((st=c===null||c===void 0?void 0:c.MarginLeft)!==null&&st!==void 0?st:0))}else if(a>0&&l.width>0&&v/a>l.height/l.width){if(b===n.CellVerticalAlignment.Center)break;v=l.height/l.width*a;b===n.CellVerticalAlignment.Bottom&&(p=p+e-v-((ht=c===null||c===void 0?void 0:c.MarginBottom)!==null&&ht!==void 0?ht:0)-((ct=c===null||c===void 0?void 0:c.MarginTop)!==null&&ct!==void 0?ct:0))}break;case 0:if(w===n.CellHorizontalAlignment.Left&&b===n.CellVerticalAlignment.Top)d=GC.Spread.Sheets.ImageLayout.none;else if(w===n.CellHorizontalAlignment.Center&&b===n.CellVerticalAlignment.Center)d=GC.Spread.Sheets.ImageLayout.center;else{if(d=GC.Spread.Sheets.ImageLayout.none,l=this.getImageSize(k,h),l===null)break;l.width<a&&(a=l.width,w===n.CellHorizontalAlignment.Center?y=y+f/2-a/2:w===n.CellHorizontalAlignment.Right&&(y=y+f-a-((lt=c===null||c===void 0?void 0:c.MarginRight)!==null&&lt!==void 0?lt:0)-((at=c===null||c===void 0?void 0:c.MarginLeft)!==null&&at!==void 0?at:0)));l.height<v&&(v=l.height,b===n.CellVerticalAlignment.Center?p=p+e/2-v/2:b===n.CellVerticalAlignment.Bottom&&(p=p+e-v-((vt=c===null||c===void 0?void 0:c.MarginBottom)!==null&&vt!==void 0?vt:0)-((yt=c===null||c===void 0?void 0:c.MarginTop)!==null&&yt!==void 0?yt:0)))}}gt={x:y,y:p,width:a,height:v};n.SpreadJSHelpMethods.CellTypeContext.paintBackground(t,r,u,f,e,o,k,d,h.imageLoader,bt,kt,gt)}},u.prototype.getImageSize=function(t,i){var r=null,u={drawImage:function(n){r=n}};return n.SpreadJSHelpMethods.CellTypeContext.paintBackgroundImage(u,0,0,0,0,t,1,i.imageLoader),r===null?null:{width:r.width,height:r.height}},u.prototype.getHitInfo=function(n,i,r,u,f){return t.getHitInfo(n,i,r,u,GC.Spread.Sheets.SheetArea.viewport,f)},u.prototype.allowTriggerCommand=function(){var n=this._cellMetaData.CellType;return n&&n.CommandList?t.shouldUsePointerCursor(n.CommandList):!1},u.prototype.isHover=function(n,t){return n<this._hoveredY&&this._hoveredY<n+t},u.prototype.isPress=function(n,t){return n<this._pressY&&this._pressY<n+t},u.prototype.processMouseMove=function(n){if(n){this._hoveredY===-100&&(this._hoveredY=n.cellRect.y,n.sheet.repaint(n.cellRect));var t=n.sheet;return t&&n.isReservedLocation&&this.showTooltip(n),i.prototype.processMouseMove.call(this,n)}},u.prototype.processMouseLeave=function(n){if(n){this._hoveredY=-100;this._pressY=-100;n.sheet.repaint(n.cellRect);var t=n.sheet;return t&&n.isReservedLocation&&this.hideTooltip(),i.prototype.processMouseLeave.call(this,n)}},u.prototype.showTooltip=function(t){var f=t.sheet,r=f.tag(),u=this.getTooltipContent(r.ListviewCalcSheetName,t.row),i;if(n.Common.IsEmpty(u)){this.hideTooltip();return}this._tooltipElment||(i=this.getTooltipElement(),i.text(u),$("body").append(i),this.refreshTooltipLocation(i,t.cellRect.x+t.cellRect.width+5,t.cellRect.y+t.cellRect.height+5,r.ListviewCalcSheetName))},u.prototype.refreshTooltipLocation=function(n,t,i,r){var u=$("#"+r),f=u.offset();i=Math.min(i,u.outerHeight()-n.outerHeight());t=Math.min(t,u.outerWidth()-n.outerWidth());i=Math.max(0,i+f.top);t=Math.max(0,t+f.left);n.css("top",i).css("left",t)},u.prototype.hideTooltip=function(){this._tooltipElment&&(this._tooltipElment.remove(),this._tooltipElment=null)},u.prototype.getTooltipContent=function(t,i){var u=n.ListviewBase.getListviewByCalcSheetName(t),r={};return r[t]=u.mappedRowIndexFrowView(i),n.ForguncyData.pageInfo.formulaManager.evaluateFormula(this._cellMetaData.CellType.ToolTip,{runTimePageName:this._runTimePageName,nullAsException:!1,listInfo:r,rowOffset:0,columnOffset:0})},u.prototype.getTooltipElement=function(){if(!this._tooltipElment){var t=n.DomUtilities.createJqueryDomElement("div");t.addClass("gc-spread-toolTip ui-state-default ui-widget-content btn-default").css("position","absolute").css("padding","0px 3px 0px 3px").css("font","11pt calibri").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css("white-space","pre-wrap").css("z-index",100).width("auto").height("auto");this._tooltipElment=t}return this._tooltipElment},u.prototype.processMouseDown=function(n){return n&&this._pressY===-100&&(this._pressY=n.cellRect.y,n.sheet.repaint(n.cellRect)),i.prototype.processMouseDown.call(this,n)},u.prototype.processMouseUp=function(n){return this._pressY!==-100&&(this._pressY=-100,n.sheet.repaint(n.cellRect)),i.prototype.processMouseUp.call(this,n)},u}(o);n.SpreadJSViewImageCellTypeBase=w;s=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.paintBackground=function(t,i,r,u,f,e,o,s,h,c){var rt,w,ut,ft,et,ot,st,ht,ct,lt,at,pt,wt,p,y,it;if(t){var l=i,d=GC.Spread.Sheets.ImageLayout.none,b=r,k=u,a=f,v=e;c?(v=v-((ut=c.MarginTop)!==null&&ut!==void 0?ut:0)-((ft=c.MarginBottom)!==null&&ft!==void 0?ft:0),a=a-((et=c.MarginLeft)!==null&&et!==void 0?et:0)-((ot=c.MarginRight)!==null&&ot!==void 0?ot:0),b+=(st=c.MarginLeft)!==null&&st!==void 0?st:0,k+=(ht=c.MarginTop)!==null&&ht!==void 0?ht:0):n.ImageDataHelper.IsSvg(l)&&(y=this._cellMetaData.CellType,y.Size||(a>10&&(a-=6,b+=3),v>10&&(v-=6,k+=3)));var vt=0,yt=0,bt=this._cellTypeMetaData.ImageSizeMode,g=this._cellTypeMetaData.HorizontalAlignment,nt=this._cellTypeMetaData.VerticalAlignment;if(n.ImageDataHelper.IsSvg(l)&&(((ct=this._cellMetaData)===null||ct===void 0?void 0:ct.CellType)&&(pt=this._cellMetaData.CellType,wt=pt.Color,pt.UseCellForeColor&&(wt=s),p=n.ImageDataHelper.GetColoredSvgRectInfo(l,wt),p&&(l=p.value,vt=p.width,yt=p.height)),y=(lt=this._cellMetaData)===null||lt===void 0?void 0:lt.CellType,y?(g=y.HorizontalAlignment,nt=y.VerticalAlignment):(g=n.CellHorizontalAlignment.Center,nt=n.CellVerticalAlignment.Center),bt=1),v<=0&&(v=0),a<=0&&(a=0),n.ImageDataHelper.IsSvg(l)){var y=(at=this._cellMetaData)===null||at===void 0?void 0:at.CellType,tt={width:0,height:0},p=n.ImageDataHelper.GetColoredSvgRectInfo(l,"");p&&(tt=this.getSvgImageSize(a,v,y,p));d=GC.Spread.Sheets.ImageLayout.zoom;rt=this.svgSizeHandle(tt,v,a,g,b,nt,k);b=rt.availableX;k=rt.availableY;it={x:b,y:k,width:tt.width,height:tt.height};n.SpreadJSHelpMethods.CellTypeContext.paintBackground(t,r,u,f,e,o,l,d,h.imageLoader,vt,yt,it)}else{var kt=0,dt=0,gt=0,ni=0;w=this.imageSizeModeHandle(bt,d,l,h,v,a,g,b,f,c,nt,k,e);d=w.backgroundImageLayout;kt=w.realHeight;dt=w.realWidth;gt=w.realX;ni=w.realY;it={x:gt,y:ni,width:dt,height:kt};n.SpreadJSHelpMethods.CellTypeContext.paintBackground(t,r,u,f,e,o,l,d,h.imageLoader,vt,yt,it)}}},i.prototype.svgSizeHandle=function(t,i,r,u,f,e,o){return u===n.CellHorizontalAlignment.Center?f=f+r/2-t.width/2:u===n.CellHorizontalAlignment.Right&&(f=f+r-t.width),e===n.CellVerticalAlignment.Center?o=o+i/2-t.height/2:e===n.CellVerticalAlignment.Bottom&&(o=o+i-t.height),{availableX:f,availableY:o}},i.prototype.imageSizeModeHandle=function(t,i,r,u,f,e,o,s,h,c,l,a,v){var p,w,b,k,d,g,nt,tt,y;switch(t){case 2:i=GC.Spread.Sheets.ImageLayout.stretch;break;case 1:if(i=GC.Spread.Sheets.ImageLayout.zoom,y=this.getImageSize(r,u),y===null)break;if(f>0&&y.height>0&&e/f>y.width/y.height){if(o===n.CellHorizontalAlignment.Center)break;e=y.width/y.height*f;o===n.CellHorizontalAlignment.Right&&(s=s+h-e-((p=c===null||c===void 0?void 0:c.MarginRight)!==null&&p!==void 0?p:0)-((w=c===null||c===void 0?void 0:c.MarginLeft)!==null&&w!==void 0?w:0))}else if(e>0&&y.width>0&&f/e>y.height/y.width){if(l===n.CellVerticalAlignment.Center)break;f=y.height/y.width*e;l===n.CellVerticalAlignment.Bottom&&(a=a+v-f-((b=c===null||c===void 0?void 0:c.MarginBottom)!==null&&b!==void 0?b:0)-((k=c===null||c===void 0?void 0:c.MarginTop)!==null&&k!==void 0?k:0))}break;case 0:if(o===n.CellHorizontalAlignment.Left&&l===n.CellVerticalAlignment.Top)i=GC.Spread.Sheets.ImageLayout.none;else if(o===n.CellHorizontalAlignment.Center&&l===n.CellVerticalAlignment.Center)i=GC.Spread.Sheets.ImageLayout.center;else{if(i=GC.Spread.Sheets.ImageLayout.none,y=this.getImageSize(r,u),y===null)break;y.width<e&&(e=y.width,o===n.CellHorizontalAlignment.Center?s=s+h/2-e/2:o===n.CellHorizontalAlignment.Right&&(s=s+h-e-((d=c===null||c===void 0?void 0:c.MarginRight)!==null&&d!==void 0?d:0)-((g=c===null||c===void 0?void 0:c.MarginLeft)!==null&&g!==void 0?g:0)));y.height<f&&(f=y.height,l===n.CellVerticalAlignment.Center?a=a+v/2-f/2:l===n.CellVerticalAlignment.Bottom&&(a=a+v-f-((nt=c===null||c===void 0?void 0:c.MarginBottom)!==null&&nt!==void 0?nt:0)-((tt=c===null||c===void 0?void 0:c.MarginTop)!==null&&tt!==void 0?tt:0)))}}return{backgroundImageLayout:i,realHeight:f,realWidth:e,realX:s,realY:a}},i.prototype.shinkToFit=function(n,t){var i=0;return n.width<=t.width&&n.height<=t.height?n:(i=n.width/n.height>t.width/t.height?t.width/n.width:t.height/n.height,{width:n.width*i,height:n.height*i})},i.prototype.getSvgImageSize=function(n,t,i){function f(n,t){var i=n.Size||0,r={Width:Math.min(t.width,i),Height:Math.min(t.height,i)};return{Width:r.Width,Height:r.Height}}var u={width:n,height:t},r;return i.Size?(r=f(i,u),this.shinkToFit({width:r.Width,height:r.Height},{width:n,height:t})):u},i}(w);n.SpreadJSViewImageCellType=s;i.register(s.shouldUse,s.createInstance);b=function(t){function r(i,r,u,f,e,o){var s=t.call(this,r,u,f,e,o,null)||this,h=!i.canEditInForguncy,c;s._isReadOnly=n.Common.IsEmpty(h)===!0?!1:h;s._canEdit=i.canEditInForguncy;c=r.Value;try{r.Value=null;s._defaultImagePath=n.ImageHelper.getImageSrcFromCellContentElement(r)}finally{r.Value=c}return s._uploadImageLimit=r.CellType.UploadImageLimit,r.ServerPropertiesId&&(s._limitId=r.ServerPropertiesId.UploadLimit),s}return __extends(r,t),r.shouldUse=function(t,i){return i.cellType.constructor===n.UploadImageCellType},r.createInstance=function(n,t,i){return new r(t,i,n.oddRowBackcolor,n.evenRowBackcolor,n.listViewStyleTemplate,t.columnInfo.Width)},r.prototype.paint=function(i,r,u,f,e,o,s,h){n.Common.IsEmpty(r)&&(r=this._defaultImagePath);t.prototype.paint.call(this,i,r,u,f,e,o,s,h)},r.prototype.paintValue=function(){},r.prototype._canUpLoadImage=function(){return this._canEdit&&!this._isReadOnly&&!n.Platform.isMobile()},r.prototype.onClick=function(t){var r;this._canUpLoadImage()&&n.Common.uploadImageByFileSelector(this._uploadImageLimit,(r=this._uploadImageLimit)===null||r===void 0?void 0:r.AllowExtensions,function(r){var u=n.ForguncyData.ForguncyRoot+"Upload/"+r;i.executeEditCommand(t.sheet,t.row,t.col,u)},this._limitId,function(t,i){if(t){var r=(i===null||i===void 0?void 0:i.status)===401?n.RS.UnauthorizedUpload:t;alert(r)}},null,!0)},r.prototype.allowTriggerCommand=function(){return this._canUpLoadImage()?!0:!1},r}(w);n.SpreadJSViewUploadImageCellType=b;i.register(b.shouldUse,b.createInstance);k=function(r){function u(t,i,u,f,e,o){var s=this,c,h,l,a;return s=r.call(this)||this,s.oddRowBackcolor=u,s.evenRowBackcolor=f,s._listViewStyleTemplate=e,s._calcSheetName=o,s._startX=10,s._fileVerticalSpace=5,s._addFileButtonPadding=1,s._addFileButtonWidth=20,h=s,l=!t.canEditInForguncy,h._isReadOnly=n.Common.IsEmpty(l)===!0?!1:l,h._canEdit=t.canEditInForguncy,a=i.StyleInfo,h._font=n.ListViewHelper.SpreadJSStyleHelper.generateFontText(a),h._fileLimit=i.CellType.UploadLimit,h._fileLimitId=(c=i.ServerPropertiesId)===null||c===void 0?void 0:c.UploadLimit,s}return __extends(u,r),u.prototype._canModifyFile=function(){return this._canEdit&&!this._isReadOnly&&!n.Platform.isMobile()},u.shouldUse=function(t,i){return i.cellType.constructor===n.AttachmentCellType},u.createInstance=function(n,t,i){return new u(t,i,n.oddRowBackcolor,n.evenRowBackcolor,n.listViewStyleTemplate,n.getCalcSheetName())},u.prototype.paint=function(i,r,u,f,e,o,s,h){i&&(s=t.setAlternativeRowColor(h.row,this.oddRowBackcolor,this.evenRowBackcolor,s,this._listViewStyleTemplate),h&&h.parentBackColor&&h.parentBackColor===s.backColor||n.SpreadJSHelpMethods.CellTypeContext.paintBackground(i,u,f,e,o,s.backColor,s.backgroundImage,s.backgroundImageLayout,h.imageLoader),this.paintValue(i,r,u,f,e,o,s,h))},u.prototype.getIndent=function(t){var i=0,r=t.textIndent;return r>0&&(i=r*n.ListViewHelper.SpreadJSStyleHelper.textIndentToPixel),i},u.prototype.paintValue=function(n,t,i,r,u,f,e,o){var s,c,w,l,a,b,v,h,y;if(n)try{if(n.save(),n.rect(i,r,u,f),n.clip(),n.beginPath(),s=this,c=o.sheet,c){var k=s._getFileNames(t),d=s._startX+i,p=r;for(n.font=e.font,n.textAlign="left",n.fillStyle=e.foreColor,w=s._getActualFileCount(t),w===0&&s.paintText(n,null,d,p,1,1,e,o,"",{value:null}),l=0;l<w;l++)a=s._getTextWidth(k[l],c),s._canModifyFile()&&(b=u-s._addFileButtonWidth-s._addFileButtonPadding*2-s._startX,a>b&&(a=b)),s.paintText(n,t,d,p,a+5+this.getIndent(e),s._getTextHeight(c)+3,e,o,k[l],{value:null}),p+=s._getTextHeight(c)+s._fileVerticalSpace;this._canModifyFile()&&(v=new GC.Spread.Sheets.Rect(i,r,u,f),h=this._getAddFileButtonRect(v),h.x+=v.x,h.y+=v.y,y=n.createLinearGradient(h.x+h.width/2,h.y,h.x+h.width/2,h.y+h.height),y.addColorStop(0,"#ECECEC"),y.addColorStop(1,"#D5D5D5"),n.shadowBlur=2,n.shadowColor="black",n.fillStyle=y,n.fillRect(h.x,h.y,h.width,h.height),s._paintUploadIcon(n,h))}}finally{n.restore()}},u.prototype._paintUploadIcon=function(n,t){try{n.save();var i=5,c=10,e=5,l=4,s=2,h=3,a=16,o=2,f=a,v=i+e+s+o,r=t.y+(t.height-v)/2,u=t.x+(t.width-f)/2;n.fillStyle="#4F4F4F";n.shadowBlur=0;n.fillRect(u,r+i+e+s,a,o);n.fillRect(u,r+i+e+s-h,o,h);n.fillRect(u+f-o,r+i+e+s-h,o,h);n.fillRect(u+(f-l)/2,r+i,l,e);n.moveTo(u+f/2,r);n.lineTo(u+(f-c)/2,r+i);n.lineTo(u+(f-c)/2+c,r+i);n.fill()}finally{n.restore()}},u.prototype.onClick=function(t){var i=t.sheet.getValue(t.row,t.col,t.sheetArea),r=n.Common.IsEmpty(i)?"":i.toString();this._doFileCommand(r,this._getFileCommand(r,t),t)},u.prototype._getFileCommand=function(n,t){var r=this._getFileNames(n),e=t.x-t.cellRect.x,u=t.y-t.cellRect.y,f=this._getAddFileButtonRect(t.cellRect),i;return e>=f.x&&e<=f.x+f.width&&u>=f.y&&u<=f.y+f.height?{command:0}:r.length===0||!this._isHitFileRange(r,e,u,t.sheet)?{command:2}:(i=Math.ceil(u/this._getFileItemHeight(r,t.sheet)),u>=this._getFileItemHeight(r,t.sheet)*i-this._fileVerticalSpace&&u<=this._getFileItemHeight(r,t.sheet)*i)?{command:2}:i>this._getActualFileCount(n)?{command:2}:(--i,e>=this._startX&&e<=this._startX+this._getTextWidth(r[i],t.sheet)?{command:1,fileIndex:i}:{command:2})},u.prototype._isHitFileRange=function(n,t,i,r){var u=this._getFileNameMaxWidth(n,r),f=this._getFileItemHeight(n,r)*n.length;return t>=this._startX&&t<=this._startX+u&&i>=0&&i<=f?!0:!1},u.prototype._doFileCommand=function(n,t,i){switch(t.command){case 0:this._addAttachment(n,i);return;case 1:this._downloadAttachment(this._getFileFullNames(n)[t.fileIndex]);return;case 2:default:return}},u.prototype._addAttachment=function(t,i){var o=this,s;if(this._canModifyFile()){if(this._isOverMaxUploadCount(t)){alert(n.RS.uploadFileBiggerThanMaxFileCount);return}this._fileLimit&&(s=this._fileLimit.ExtensionFilter);var f=n.ListviewBase.getListviewByCalcSheetName(this._calcSheetName),r=-1,u=0,e=[];n.Common.updateFile(s,!0,function(n){if(e.push(n),u++,r===u)o.onAttachmentsAdded(f,e,i,t)},function(n){if(n&&alert(n),u++,r===u)o.onAttachmentsAdded(f,e,i,t)},this._fileLimit,this._fileLimitId,function(n){r===-1&&(r=n);f.showLoadingIndicator()},!0)}},u.prototype.onAttachmentsAdded=function(t,r,u,f){var s,h,e,o,c,l;if(t.hiddenLoadingIndicator(),!(r.length<=0)){if(s=this._getFileLimit()===1&&this._fileLimit.ReplaceWhenOneFile,h=this._getFileCount(f),s)r=r.slice(0,1);else if(e=r.length,o=h+e-this._getFileLimit(),o>0){if(alert(n.RS.uploadFileBiggerThanMaxFileCount),e<=o)return;r=r.slice(0,e-o)}c=r.join("|")+"|";l=h===0||s?c:f+c;i.executeEditCommand(u.sheet,u.row,u.col,l)}},u.prototype._downloadAttachment=function(t){var i=n.DomUtilities.createJqueryDomElement("a");i.append(n.DomUtilities.createJqueryDomElement("p"));i.attr("href",n.Helper.SpecialPath.getFileDownloadUrl(t));t&&t.toLowerCase().endsWith(".pdf")&&i.attr("target","_blank");i.children("p").trigger("click");i=null},u.prototype.getAutoFitWidth=function(n,t,i,u,f){if(f){var e=this;return e._canModifyFile()?e._startX+e._getFileNameMaxWidth(e._getFileNames(n),f.sheet)+e._addFileButtonPadding*2+e._addFileButtonWidth:e._startX+e._getFileNameMaxWidth(e._getFileNames(n),f.sheet)}return r.prototype.getAutoFitWidth.call(this,n,t,i,u,f)},u.prototype.getAutoFitHeight=function(n,t,i,u,f){if(f){var e=this,o=e._getFileNames(n);return e._getFileItemHeight(o,f.sheet)*o.length}return r.prototype.getAutoFitHeight.call(this,n,t,i,u,f)},u.prototype._isOverMaxUploadCount=function(n){return this._getFileCount(n)>=this._getFileLimit()&&(this._getFileLimit()!==1||!this._fileLimit.ReplaceWhenOneFile)},u.prototype._getFileCount=function(n){return this._getFileNames(n).length},u.prototype._getFileLimit=function(){return this._fileLimit&&this._fileLimit.MaxUploadFileCount?this._fileLimit.MaxUploadFileCount:Number.MAX_VALUE},u.prototype._getActualFileCount=function(n){var t=this,i=t._getFileNames(n);return t._isOverMaxUploadCount(n)?t._fileLimit.MaxUploadFileCount:i.length},u.prototype._getAddFileButtonRect=function(n){var t=this,i=n.width-t._addFileButtonWidth-t._addFileButtonPadding,r=t._addFileButtonPadding,u=t._addFileButtonWidth,f=n.height-t._addFileButtonPadding*2;return new GC.Spread.Sheets.Rect(i,r,u,f)},u.prototype._getFileFullNames=function(t){if(n.Common.IsEmpty(t)||typeof t!="string")return[];return t.split("|").filter(function(t){return!n.Common.IsEmpty(t)&&t.length>37&&t.charAt(36)==="_"&&n.Common.isForguncyFile(t)&&t.indexOf("<")<0})},u.prototype._getFileNames=function(n){return this._getFileFullNames(n).map(function(n){return n.substring(37)})},u.prototype._getFileNameMaxWidth=function(n,t){var i=this;return Math.max.apply(i,n.map(function(n){return i._getTextWidth(n,t)}))},u.prototype._getFileItemHeight=function(n,t){if(n.length===0)return 0;var i=this;return i._getTextHeight(t)+i._fileVerticalSpace},u.prototype._getTextWidth=function(n,t){return i.getStringWidthByCanvas(n,this._font,t)},u.prototype._getTextHeight=function(n){return i.getTextHeight(this._font,n)},u.prototype.getFileItemPosition=function(t,i,r,u){var f=this,h=u.getValue(t,i),o=u.getCellRect(t,i),e,c,s;if(n.Common.IsEmpty(h))throw new Error("There are no files to select");if(e=f._getFileNames(h.toString()),r<0||r>=e.length)throw new Error("Invalid file index");c=o.x+f._startX;s=o.y;r>0&&(s+=f._getFileItemHeight(e,u)*r);var l=f._getTextWidth(e[r],u),a=o.width-f._addFileButtonWidth-f._addFileButtonPadding*2-f._startX,v=l>a?a:l,y=f._getTextHeight(u);return{x:c,y:s,width:v,height:y}},u.prototype.getAddFileButtonPosition=function(n,t,i){var f=this,u,r;if(!f._canModifyFile())throw Error("There is no Button to add file");return u=i.getCellRect(n,t),r=f._getAddFileButtonRect(u),r.x+=u.x,r.y+=u.y,{x:r.x,y:r.y,width:r.width,height:r.height}},u.prototype.allowTriggerCommand=function(n,t,i){return this._canModifyFile()||n.getValue(t,i)?!0:!1},u}(o);n.SpreadJSViewAttachmentCellType=k;i.register(k.shouldUse,k.createInstance);d=function(i){function r(n,t,r,u){var f=i.call(this)||this;return f._cellMetaData=n,f._oddRowBackcolor=t,f._evenRowBackcolor=r,f._listViewStyleTemplate=u,f.typeName="SpreadJSViewBarcodeCellType",f._cellTypeMetaData=f._cellMetaData.CellType,f}return __extends(r,i),r.shouldUse=function(t,i){return i.cellType.constructor===n.BarcodeCellType},r.createInstance=function(n,t,i){return new r(i,n.oddRowBackcolor,n.evenRowBackcolor,n.listViewStyleTemplate)},r.prototype.paint=function(n,r,u,f,e,o,s,h){s=t.setAlternativeRowColor(h.row,this._oddRowBackcolor,this._evenRowBackcolor,s,this._listViewStyleTemplate);this.paintBackground(n,r,u,f,e,o,s.backColor,s.foreColor,h);s.backColor=undefined;i.prototype.paint.call(this,n,null,u,f,e,o,s,h)},r.prototype.paintBackground=function(t,i,r,u,f,e,o,s,h){if(t){var c=GC.Spread.Sheets.ImageLayout.zoom,l=n.BarcodeCellType.GetRequestParam(i,this._cellTypeMetaData,f,e,o,s,this),a=n.ForguncyData.ForguncyRoot+"Barcode/GetBarcodeImage?data="+encodeURIComponent(JSON.stringify(l));n.SpreadJSHelpMethods.CellTypeContext.paintBackground(t,r,u,f,e,o,a,c,h.imageLoader)}},r.prototype.toJSON=function(){return null},r}(GC.Spread.Sheets.CellTypes.Base);n.SpreadJSViewBarcodeCellType=d;i.register(d.shouldUse,d.createInstance);h=function(t){function i(n,i,r,u,f,e,o,s,h){var c=t.call(this,i,r,h)||this;return c._columnInfo=n,c._calcSheetName=u,c._locatedPageID=f,c.runTimePageName=e,c.designerPageName=o,c.listviewName=s,c._isEditorVisible=!1,c._textCache={},c._ignoreValidate=!1,c.typeName="SpreadJSEditCellType",c}return __extends(i,t),i.shouldUse=function(n,t,i){return t.canEnterEditMode?e.shouldUse(n,t,i)||c.shouldUse(n,t,i)?!1:!0:!1},i.createInstance=function(n,t){return new i(t,n.oddRowBackcolor,n.evenRowBackcolor,n.getCalcSheetName(),n.locatedPageID,n.runTimePageName,n.designerPageName,n.listviewData.getListviewName(),n.listViewStyleTemplate)},i.prototype.paint=function(i,r,f,e,o,s,h,c){var l,y,a,v;n.Common.IsEmpty(h.formatter)&&(y=u.getCell(this._columnInfo.getTemplateCell(),this.runTimePageName,this.designerPageName,this.listviewName).cellType,a=y.getFormatString(),n.Common.IsEmpty(a)||(v=(l=n.FormatHelper.format(a,r))===null||l===void 0?void 0:l.color,n.Common.IsEmpty(v)||(h.foreColor=v)));t.prototype.paint.call(this,i,r,f,e,o,s,h,c)},i.prototype.format=function(n,i,r,f){var e,s,o;if(!this._columnInfo||!this._columnInfo.getTemplateCell())return t.prototype.format.call(this,n,i,r);this.isTransformText()&&(n=f.sheet.getValue(f.row,f.col));try{return s=u.getFormulaListRowInfo(f,this._calcSheetName),o=u.getDisplayText(n,this._columnInfo.getTemplateCell(),this.runTimePageName,this.designerPageName,this.listviewName,i,s,r),this._textCache[n+""]=o,o}catch(h){return(e=this._textCache[n+""])!==null&&e!==void 0?e:n+""}},i.prototype.isTransformText=function(){var t,i,r,u,n=(t=this._columnInfo)===null||t===void 0?void 0:t.getTemplateCell();return((i=n===null||n===void 0?void 0:n.CellType)===null||i===void 0?void 0:i.$type)==="Forguncy.DropDownListCellType, ServerDesignerCommon"||((r=n===null||n===void 0?void 0:n.CellType)===null||r===void 0?void 0:r.$type)==="Forguncy.RadioGroupCellType, ServerDesignerCommon"||((u=n===null||n===void 0?void 0:n.CellType)===null||u===void 0?void 0:u.$type)==="Forguncy.CheckBoxGroupCellType, ServerDesignerCommon"?!0:!1},i.prototype.getText=function(n,t){return this.isTransformText()?this.format(n,null,null,t):n},i.prototype.createEditorElement=function(t,i){var e,o,s,r,h,c,f;this.destroy();this._isEditorVisible=!1;e=u.getCell(this._columnInfo.getTemplateCell(),this.runTimePageName,this.designerPageName,this.listviewName);this._cellType=e.cellType;o=this._columnInfo.columnInfo.BindingColumnDataType;s=[n.ColumnDataType.Other,n.ColumnDataType.String,n.ColumnDataType.User,n.ColumnDataType.Image,n.ColumnDataType.Attachment];s.indexOf(o)>=0&&this._cellType.constructor===n.TextBoxCellType&&(r=this._cellType.getFormatString(),(n.Common.IsEmpty(r)||r.toLowerCase()==="general")&&this._cellType.setFormatString("@"));h=this._cellType.createContent();c=this._cellType.getCellTypeInfo();t&&(f=n.ListviewBase.getListviewByCalcSheetName(this._calcSheetName),this._cellType.listviewCalcName=this._calcSheetName,this._cellType.listviewRowIndex=f.mappedRowIndexFrowView(t.row),this._cellType.listviewColIndex=f.getDataIndexByVisibleColumnIndexInListView(t.col));this._cellType.onPageLoaded(c);var l=this._cellType,a=document.createElement("div"),v=this.getHost(),y=n.SpreadJSHelpMethods.util.getPreferredZIndex(v)+1e3,p=n.Common.getIdStr(t.row,t.col,this._columnInfo.idSuffix);return $(a).attr(n.StaticValues.InnerID,p).attr("cellTypeID",l.ID).css("position","absolute").css("z-index",y).attr("gcuielement","gcEditingInput").append(h),$(i).attr("id",l.ID+"_div"),$(i).css("overflow",""),n.ValidationTooltipHelper.setTooltipAttr($(i),!0),a},i.prototype.getHost=function(n){if(!n||!n.sheet)return null;var t=n.sheet.getParent();return t?t.getHost():null},i.prototype.destroy=function(){this._cellType&&(u.destroyEditor(this._cellType),this._cellType=null)},i.prototype.deactivateEditor=function(n,i){this._isEditorVisible=!1;n&&this.destroyTooltip($(n));t.prototype.deactivateEditor.call(this,n,i)},i.prototype.destroyTooltip=function(t){var i,r,u,f;((u=(r=(i=this._cellType)===null||i===void 0?void 0:i.CellElement)===null||r===void 0?void 0:r.DataValidation)===null||u===void 0?void 0:u.ErrorTo)===1&&((f=this._cellType.CellElement)===null||f===void 0?void 0:f.DataValidation.ErrorToTargetCell)?n.FormulaHelper.setValueToCellLocation(null,this._cellType.CellElement.DataValidation.ErrorToTargetCell,7,this._cellType.getDefaultFormulaCalcInfo(),!1):n.ValidationTooltipHelper.destroyTooltip(t)},i.prototype.getEditorValue=function(){if(this._cellType)return u.getEditorValue(this._cellType.ID,this._cellType,this._columnInfo.columnInfo.BindingColumnDataType)},i.prototype.setEditorValue=function(t,i,r){var u,o;if(this._cellType&&(!this._isEditorVisible||!n.Platform.isIpad())&&$(t).attr("cellTypeID")===this._cellType.ID){var s=n.ListviewBase.getListviewByCalcSheetName(this._calcSheetName),f=s.mappedRowIndexFrowView(r.row),e=this.getListDataModel();i=e?e.getValue(f,this._columnInfo.getColumnIndex()):null;this.shouldUseDefaultValue(i,r)&&(u=this.getDefaultValue(f),n.Common.IsEmpty(u)||(i=u));this._cellType.canInputChars()&&(o=(!GC.Spread.Sheets.util.browser.msie||parseFloat(GC.Spread.Sheets.util.browser.version)<11)&&(r&&r.sheet&&this.isStartEditByKeydown(r)?!0:!1),o&&(i=null));this._cellType.setValueToElement($(t).find("#"+this._cellType.ID),i)}},i.prototype.isStartEditByKeydown=function(t){var i={value:null};return GC.Spread.Sheets.CellTypes.Text.prototype.setEditorValue(i,"text",t),n.Common.IsEmpty(i.value)},i.prototype.shouldUseDefaultValue=function(t,i){var r;if(!n.Common.IsEmpty(t)||!n.ForguncyData.pageInfo.dataModel||!i||!this._calcSheetName||(r=this.getListDataModel(),!r))return!1;var u=n.ListviewBase.getListviewByCalcSheetName(this._calcSheetName),f=u.mappedRowIndexFrowView(i.row),e=r.getRowInfo(f);return n.Common.IsEmpty(e)?!0:!1},i.prototype.getListDataModel=function(){return n.Common.IsEmpty(this._calcSheetName)?null:n.ForguncyData.pageInfo.dataModel.getListDataByCalcSheetName(this._calcSheetName)},i.prototype.selectAll=function(){this._cellType&&this._cellType.selectAll()},i.prototype.focus=function(t,i){var r;if(this._cellType&&t){if(n.Platform.isIpad()&&!this._isEditorVisible&&i&&i.sheet){if(r=i.sheet.getValue(i.row,i.col),this.shouldUseDefaultValue(r,i)){var f=n.ListviewBase.getListviewByCalcSheetName(this._calcSheetName),e=f.mappedRowIndexFrowView(i.row),u=this.getDefaultValue(e);n.Common.IsEmpty(u)||(r=u)}this._cellType.setValueToElement($(t).find("#"+this._cellType.ID),r)}this._cellType.focus();this._cellType.setCaretAtLast()}},i.prototype.getDefaultValue=function(n){var t=this.getListDataModel();return t?this._columnInfo.getDefaultValue(t.name,this.runTimePageName,n):null},i.prototype.activateEditor=function(n,t,i,r){if(this._cellType){this._isEditorVisible=!0;var u=n&&r&&r.sheet;u&&(this._editorRect=new GC.Spread.Sheets.Rect(null,null,null,null),this.updateEditorRect(n,i,r),this.upadateEditorStyle(n,t,u),this.attachAttrToDropDown())}},i.prototype.upadateEditorStyle=function(t,i){var r,u,f,e,o,s;t&&i&&(r=!1,u=!1,i.font&&typeof i.font=="string"&&(f=i.font.toLowerCase(),r=f.indexOf("italic")!==-1,u=f.indexOf("bold")!==-1),e=!1,o=!1,i.textDecoration&&(e=(i.textDecoration&GC.Spread.Sheets.TextDecorationType.lineThrough)===GC.Spread.Sheets.TextDecorationType.lineThrough,o=(i.textDecoration&GC.Spread.Sheets.TextDecorationType.underline)===GC.Spread.Sheets.TextDecorationType.underline),s=i.backColor?"rgb(".concat(n.ColorHelper.GetRGBNumberString(i.backColor),")"):"white",$(t).css("background-color",n.ColorHelper.Convert(s)),this._cellType.setStyle(i.backColor,i.foreColor,this._columnInfo.getTemplateCell().StyleInfo.FontSize,r,u,o,e))},i.prototype.attachAttrToDropDown=function(){var n=this._cellType.getDropDownObj();n&&$(n).attr("gcuielement","fgcDropDownWindow")},i.prototype.updateEditor=function(n,t,i,r){if(this._cellType){var u=this.updateEditorRect(n,i,r);u&&this.destroyTooltip($(n))}},i.prototype.updateEditorRect=function(t,i,r){var f=!1,s=t&&r&&r.sheet,u,o;if(s&&!this.isRectInvalid(i)){var h=s.getParent(),c=n.SpreadJSView.getBounds(h.name),e=void 0;e=r.canvasOffset?r.canvasOffset:n.SpreadJSView.getCanvasPosition(h.name);u=new GC.Spread.Sheets.Rect(e.left+c.x+i.x,e.top+c.y+i.y,i.width-1,i.height-1);o=$(t);(this._editorRect.x!==u.x||this._editorRect.y!==u.y)&&(f=!0);this._editorRect.width!==u.width&&(o.width(u.width),f=!0);this._editorRect.height!==u.height&&(o.height(u.height),f=!0);this._editorRect=u}return f},i.prototype.isRectInvalid=function(n){return!n||n.x===undefined||n.y===undefined||n.width===undefined||n.height===undefined},i.prototype.isReservedKey=function(n,t){var r=n.srcElement||n.target,i;return r&&t&&t.isEditing&&(i=this._columnInfo.cellType.getIgnoreKeysInListview(),i&&i.indexOf(n.keyCode)>=0||n.keyCode===GC.Spread.Commands.Key.z&&n.ctrlKey&&!n.altKey||n.keyCode===GC.Spread.Commands.Key.y&&n.ctrlKey&&!n.altKey||n.keyCode===GC.Spread.Commands.Key.c&&n.ctrlKey&&!n.altKey||n.keyCode===GC.Spread.Commands.Key.x&&n.ctrlKey&&!n.altKey||n.keyCode===GC.Spread.Commands.Key.v&&n.ctrlKey&&!n.altKey)?!0:!1},i.prototype.isEditingValueChanged=function(n,t){return!u.equals(n,t)},i.prototype.isImeAware=function(){return!0},i.prototype.validate=function(t,i,r){var f=this,e,u,o;return!this._cellType||this._ignoreValidate?!0:r?(n.Common.IsEmpty(r.message)||n.ValidationTooltipHelper.showTooltip(this._cellType.getContainer()[0],r.message),!1):(e=n.ListviewBase.getListviewByCalcSheetName(this._calcSheetName),u=n.ValidationMananger.validateCell(this._cellType,e.getValidateHelpInfoByViewIndex(t,i)),u===0?!0:u instanceof Promise?(u.then(function(r){if(!r.obsolete&&r.status===0){var u=n.ListviewBase.getListviewByCalcSheetName(f._calcSheetName);if(u)try{f._ignoreValidate=!0;u.endEdit(t,i)}finally{f._ignoreValidate=!1}}}),!1):(o=n.InputManCellTypeBase&&this._cellType instanceof n.InputManCellTypeBase&&this._cellType.canInput(),o&&this._cellType.focus(),!1))},i.prototype.hideValidationTooltip=function(){var t,i;this._cellType&&(t=n.ListviewBase.getListviewByCalcSheetName(this._calcSheetName),t)&&(i=t.getContainerDiv().find("[name='"+this._cellType.ID+"']"),i.length>0&&this.destroyTooltip(i))},i.prototype.toJSON=function(){return null},i}(v);n.SpreadJSEditCellType=h;i.register(h.shouldUse,h.createInstance);e=function(r){function u(){var n=r!==null&&r.apply(this,arguments)||this;return n._hoveredY=-100,n._iconPadding=7,n._iconSideLength=8,n}return __extends(u,r),Object.defineProperty(u.prototype,"showDropdownButton",{get:function(){return this._columnInfo.cellType.CellElement.CellType.DropdownButtonModeInListview},enumerable:!1,configurable:!0}),u.shouldUse=function(t,i){return i.canEnterEditMode?i.cellType.constructor===n.DateTimeCellType_InputMan:!1},u.createInstance=function(n,t){return new u(t,n.oddRowBackcolor,n.evenRowBackcolor,n.getCalcSheetName(),n.locatedPageID,n.runTimePageName,n.designerPageName,n.listviewData.getListviewName(),n.listViewStyleTemplate)},u.prototype.paintValue=function(n,t,i,u,f,e,o,s){n&&(r.prototype.paintValue.call(this,n,t,i,u,f-this.getIconWidth(s,!0),e,o,s),this.paintDropdownIcon(n,i,u,f,e,s))},u.prototype.paintDropdownIcon=function(n,t,i,r,u,f){var e=this.getIconRect(t,i,r,u,f),h,c,o,s;if(e)try{n.save();h="#000000";c="#DDDDDD";this.isDropDownIconHovered(i,u)&&(n.fillStyle=c,n.fillRect(e.x,e.y,e.width,e.height));o=i+(u-this._iconSideLength)/2;s=e.x+this._iconPadding;n.fillStyle=h;n.beginPath();n.moveTo(s,o);n.lineTo(s+this._iconSideLength,o);n.lineTo(s+this._iconSideLength/2,o+this._iconSideLength);n.closePath();n.fill()}finally{n.restore()}},u.prototype.isDropDownIconHovered=function(n,t){return n<=this._hoveredY&&this._hoveredY<=n+t},u.prototype.showDropDown=function(n){var t,r=(t=this._cellType)===null||t===void 0?void 0:t.getControl(),i;r instanceof GC.InputMan.GcDateTime&&(i=r.getDropDownCalendar(),n=this.getDate(n),n!==null&&i.setValue(n),i.open())},u.prototype.getDate=function(t){return t instanceof Date?t:typeof t=="number"?n.Convertor.fromOADateToDate(t):null},u.prototype.processMouseDown=function(n){(n===null||n===void 0?void 0:n.isReservedLocation)&&n.sheet&&n.sheet.getParent().focus(!0)},u.prototype.processMouseUp=function(t){if(!t||!t.isReservedLocation||!t.sheet)return!1;var i=t.sheet,r=t.row,u=t.col;n.DelayRefresh.setTimeout(function(){if(i.getActiveRowIndex()===r&&i.getActiveColumnIndex()===u){var n=i.getCellType(r,u);n&&n.showDropDown&&(i.startEdit(),n.showDropDown(i.getValue(r,u)))}})},u.prototype.processMouseMove=function(n){var t=this._hoveredY;(n===null||n===void 0?void 0:n.isReservedLocation)?(this._hoveredY=n.cellRect.y,i.changeCursorAsPointer(n.sheet)):this._hoveredY=-100;this._hoveredY!==t&&n.sheet.repaint(n.cellRect)},u.prototype.processMouseLeave=function(n){n&&(this._hoveredY=-100,n.sheet.repaint(n.cellRect))},u.prototype.getHitInfo=function(n,i,r,u,f){var e=this.getIconRect(u.x,u.y,u.width,u.height,f);return t.getHitInfo(n,i,r,e,GC.Spread.Sheets.SheetArea.viewport,f)},u.prototype.getIconWidth=function(n,t){return t===void 0&&(t=!1),this.shouldDisplayDropDownIcon(n)?this._iconPadding*2+this._iconSideLength+(t?2:0):0},u.prototype.shouldDisplayDropDownIcon=function(n){switch(this.showDropdownButton){case 1:case 3:return!1;case 0:return!0;case 2:if(!n)return!1;var t=n.sheet;return t.getActiveRowIndex()===n.row&&t.getActiveColumnIndex()===n.col}},u.prototype.getIconRect=function(n,t,i,r,u){var f=this.getIconWidth(u);return f===0?null:new GC.Spread.Sheets.Rect(n+i-(f+2),t+1,f,r-3)},u.prototype.getAutoFitWidth=function(n,t,i,u,f){var e=r.prototype.getAutoFitWidth.call(this,n,t,i,u,f);return e+this.getIconWidth(f,!0)},u}(h);n.DropDownEditorCellType=e;i.register(e.shouldUse,e.createInstance);c=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.shouldUse=function(t,i){return i.canEnterEditMode?i.cellType.constructor===n.ComboBoxCellType_InputMan||i.cellType.constructor===n.UserSelectorCellType_InputMan||i.cellType.constructor===n.TimeCellType_InputMan:!1},i.createInstance=function(n,t){return new i(t,n.oddRowBackcolor,n.evenRowBackcolor,n.getCalcSheetName(),n.locatedPageID,n.runTimePageName,n.designerPageName,n.listviewData.getListviewName(),n.listViewStyleTemplate)},i.prototype.createEditorElement=function(i,r){var e=t.prototype.createEditorElement.call(this,i,r),u=this.getGcCombobox(),f;return u&&(f=this,this._onDropDownOpenedCallBack=function(){f.onDropDownOpen()},u.addEventListener(GC.InputMan.GcComboBoxEvent.DropDownOpened,this._onDropDownOpenedCallBack),this._onDropDownClosedCallBack=function(){n.DelayRefresh.setTimeout(function(){f.onDropDownClose(i.sheet)})},u.addEventListener(GC.InputMan.GcComboBoxEvent.DropDownClosed,this._onDropDownClosedCallBack)),e},i.prototype.onDropDownOpen=function(){var n=this.getGcCombobox();this._cachedSelectedIndex=n?n.getSelectedIndex():-1},i.prototype.onDropDownClose=function(n){var t,i;n.isEditing()&&this._isEditorVisible&&(t=this.getGcCombobox(),t)&&(i=t.getSelectedIndex(),i!==-1&&i!==this._cachedSelectedIndex)&&n.endEdit()},Object.defineProperty(i.prototype,"_gcComboBox",{get:function(){return this._cellType?this._cellType.getControl():null},enumerable:!1,configurable:!0}),i.prototype.getGcCombobox=function(){return this._cellType?this._cellType.getControl():null},i.prototype.showDropDown=function(){var n=this.getGcCombobox();n&&n.getDropDown().open()},i.prototype.activateEditor=function(n,i,r,u){var e,f;if(t.prototype.activateEditor.call(this,n,i,r,u),this._cachedSelectedIndex=-1,e=n&&u&&u.sheet,e){if(f=this.getGcCombobox(),!f)return;this._cachedSelectedIndex=f.getSelectedIndex()}},i.prototype.isReservedKey=function(n,i){return t.prototype.isReservedKey.call(this,n,i)?!0:this._gcComboBox&&(n.srcElement||n.target)&&i&&i.isEditing&&this._cellType.isDropDownOpened()&&n.keyCode===GC.Spread.Commands.Key.enter?!0:!1},i.prototype.getAutoFitHeight=function(n,i,r,u,f){return t.prototype.getAutoFitHeight.call(this,i,i,r,u,f)},i.prototype.destroy=function(){var n=this.getGcCombobox();n&&(this._onDropDownOpenedCallBack&&n.removeEventListener(GC.InputMan.GcComboBoxEvent.DropDownOpened,this._onDropDownOpenedCallBack),this._onDropDownClosedCallBack&&n.removeEventListener(GC.InputMan.GcComboBoxEvent.DropDownClosed,this._onDropDownClosedCallBack));t.prototype.destroy.call(this)},i}(e);n.ComboboxEditorCellType=c;i.register(c.shouldUse,c.createInstance);ut=function(){function n(){}return n}();n.SpreadJSCellTypeContextArg=ut;ot=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(ut);n.IsReservedKeyContextArg=ot;u=function(){function t(){}return t.equals=function(t,i){return t===0&&i===""||t===""&&i===0?!1:t===null&&i===""||t===""&&i===null?!0:n.Common.isFuzzyEquals(t,i)?!0:t instanceof Date&&i instanceof Date&&t.valueOf()===i.valueOf()?!0:!1},t.getEditorValue=function(t,i,r){var u=[n.ColumnDataType.Other,n.ColumnDataType.String,n.ColumnDataType.User,n.ColumnDataType.Image,n.ColumnDataType.Attachment];return i.getValue(u.indexOf(r)>=0)},t.getEditorID=function(){return t.editorIDPrefix+n.Common.getUniqueNumber().toString()},t.getCell=function(i,r,u,f){if(!i)return null;var o=t.getEditorID(),e=n.Common.clone(i);return e.Value=null,new n.NormalCell(e,1,o,r,u,f)},t.destroyEditor=function(n){n&&n.destroy()},t.getDisplayText=function(i,r,u,f,e,o,s,h){var c=t.getCell(r,u,f,e).cellType,a=c.getFormatString(),l;return l=typeof o=="string"?o:o instanceof GC.Spread.Formatter.GeneralFormatter?!n.Common.IsEmpty(a)&&o.isAuto?null:o.formatString():null,c.getListviewNoneEditModeText(i,h,l,s)},t.getFormulaListRowInfo=function(t,i){var r,f=n.ListviewBase.getListviewByCalcSheetName(i),u=t.row;return f instanceof n.SpreadJSView&&(u=f.mappedRowIndexFrowView(u)),r={},r[i]=u,r},t.editorIDPrefix="a",t}();n.ListviewEditorHelper=u;l=function(){function t(){}return t._getIconStr=function(n){switch(n){case 2:return"data:image/svg+xml,%3Csvg width='16' height='16' viewBox='0 0 64 64' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M32 64C14.4 64 0 49.6 0 32S14.4 0 32 0s32 14.4 32 32-14.4 32-32 32zm-2.133-29.867v13.382c0 .931 1.202 1.552 2.133 1.552.93 0 2.133-.62 2.133-1.552V34.133h13.382c.931 0 1.552-1.202 1.552-2.133 0-.93-.62-2.133-1.552-2.133H34.133V16.485c0-.931-1.202-1.552-2.133-1.552-.93 0-2.133.62-2.133 1.552v13.382H16.485c-.931 0-1.552 1.202-1.552 2.133 0 .93.62 2.133 1.552 2.133h13.382z' fill-rule='evenodd' fill='{0}'/%3E%3C/svg%3E";case 1:return"data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 64 64' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24.2 48.52l-9.335-9.185L9 55l15.2-6.48zm22.28-21.707l-9.63-9.935-20.252 19.897 10.005 10.388 19.877-20.35zm7.937-7.62c1.311-1.476 0-4.294 0-4.294a41.74 41.74 0 0 0-5.485-4.944c-2.933-2.147-5.194 0-5.194 0l-4.962 4.971L48.856 24.98s4.251-4.293 5.56-5.788v.002z' fill-rule='nonzero' fill='{0}'/%3E%3C/svg%3E"}},t.addIconCache=function(t){if(!n.Common.IsEmpty(t)){var i=encodeURIComponent(t);this._addIconCacheByRowSate(2,i,t);this._addIconCacheByRowSate(1,i,t)}},t._addIconCacheByRowSate=function(i,r,u){var f=this._getKey(i,u),e,o;t._iconsCache[f]||(e=t._getIconStr(i),o=n.Common.format(e,r),t._iconsCache[f]=t.createImage(o))},t.getIconCache=function(i,r){if(i===0||n.Common.IsEmpty(r))return null;var u=this._getKey(i,r);return t._iconsCache[u]},t._getKey=function(n,t){return n+"_"+t},t.createImage=function(n){var t=new Image;return t.src=n,t},t._iconsCache={},t}();st=function(t){function r(i,r,u){var f=t.call(this)||this,e;return f._listViewStyleTemplate=i,f._calcSheetName=r,f.typeName="SpreadJSRowHeaderCellType",f._initIconsCache(u),f._dataModel=n.ForguncyData.pageInfo.dataModel.getListDataByCalcSheetName(f._calcSheetName),e=n.ListviewBase.getListviewByCalcSheetName(f._calcSheetName),f._hasTotalRow=e.allowShowTotalRow(),f._hasTotalRow&&(f._totalRowAtFirst=e.listviewData.getIsTotalRowAtFirstRow()),f}return __extends(r,t),r.prototype._initIconsCache=function(n){var t=this._getPossibleForeColors(n);t.forEach(function(n){return l.addIconCache(n)})},r.prototype._getPossibleForeColors=function(t){var i=[],u,r,f;if(n.Common.IsEmpty(t))for(u in GC.Spread.Sheets.VisualState)r=Number(u),isNaN(r)||(f=this._getThemeStyle(r),i.push(f.color));else i.push(t);return this._listViewStyleTemplate&&(i.push(n.ColorHelper.Convert(this._listViewStyleTemplate.ColumnHeaderFore)),i.push(n.ColorHelper.Convert(this._listViewStyleTemplate.ColumnHeaderHighlightFore)),i.push(n.ColorHelper.Convert(this._listViewStyleTemplate.ColumnHeaderHoverFore)),i.push(n.ColorHelper.Convert(this._listViewStyleTemplate.ColumnHeaderSelectFore))),i.filter(function(n){return!!n})},r.prototype.getListview=function(t){if(!this._listview){if(!t)return null;var i=t.sheet.tag(),r=i.ListviewCalcSheetName;this._listview=n.ListviewBase.getListviewByCalcSheetName(r)}return this._listview},r.prototype._getThemeStyle=function(t){return this.getThemeStyle(t,"gc-rowHeader-"+n.SpreadJSHelpMethods.HelpMethods.getVisualStateName(t))},r.prototype.paint=function(n,u,f,e,o,s,h,c){var v=this._getThemeStyle(c.visualState),l,a;h=i.getCustomStyle(h,v,this._listViewStyleTemplate,c.visualState);l=c.visualState;c.visualState=GC.Spread.Sheets.VisualState.normal;a=r.getValue(c.row,c.sheet,this._dataModel,this._hasTotalRow,this._totalRowAtFirst);t.prototype.paint.call(this,n,a,f,e,o,s,h,c);c.visualState=l;this.paintIcon(n,f,e,o,s,h,c)},r.getRowHeaderText=function(t,i){var o=n.ForguncyData.pageInfo.dataModel.getListDataByCalcSheetName(i),u=n.ListviewBase.getListviewByCalcSheetName(i),f,e;return(u instanceof n.SpreadJSView)?(f=u.allowShowTotalRow(),e=f&&u.listviewData.getIsTotalRowAtFirstRow(),r.getValue(t,u.getSheet(),o,f,e)):""},r.getValue=function(n,t,i,r,u){var f=n,o,e;if(r)if(u){if(n===0)return"∑";f=n-1}else if(n===t.getRowCount()-1)return"∑";return(o=i.getRowCount(),f<o)?(e=i.getValue(f,0),e===undefined||e===null?f+1:e):""},r.prototype._getForeColor=function(t,i){if(i.visualState!==GC.Spread.Sheets.VisualState.hover)return t.foreColor;var r=this.getThemeStyle(i.visualState,"gc-rowHeader-"+n.SpreadJSHelpMethods.HelpMethods.getVisualStateName(GC.Spread.Sheets.VisualState.hover));return r.color},r.prototype.paintIcon=function(n,t,i,r,u,f,e){var c=this.getListview(e),h,o,v,a,s;c&&(h=c.getRowState(e.row),h!==0)&&((o=h===1?20:16,v=h===1?1:4,r<o||u<o)||(a=l.getIconCache(c.getRowState(e.row),f.foreColor),a)&&(s=new GC.Spread.Sheets.Rect(t+v,i+u/2-o/2,o,o),n.drawImage(a,0,0,o,o,Math.floor(s.x),Math.floor(s.y),Math.floor(s.width),Math.floor(s.height))))},r}(GC.Spread.Sheets.CellTypes.RowHeader);n.SpreadJSRowHeaderCellType=st;g=function(t){function r(n){var i=t.call(this)||this;return i._listViewStyleTemplate=n,i.typeName="SpreadJSColumnHeaderCellType",i}return __extends(r,t),r.prototype.paint=function(r,u,f,e,o,s,h,c){var a=this.getThemeStyle(this._getVisualState(c),"gc-columnHeader-"+n.SpreadJSHelpMethods.HelpMethods.getVisualStateName(c.visualState)),l;h=i.getCustomStyle(h,a,this._listViewStyleTemplate,c.visualState);l=c.visualState;c.visualState=GC.Spread.Sheets.VisualState.normal;t.prototype.paint.call(this,r,u,f,e,o,s,h,c);c.visualState=l},r.prototype._getForeColor=function(t,i){var r=this._getVisualState(i),u;return r===GC.Spread.Sheets.VisualState.normal&&t.foreColor?t.foreColor:(u=this.getThemeStyle(i.visualState,"gc-columnHeader-"+n.SpreadJSHelpMethods.HelpMethods.getVisualStateName(r)),u.color)},r.prototype._getVisualState=function(n){var t=n.visualState===undefined?GC.Spread.Sheets.VisualState.normal:n.visualState;return t!==GC.Spread.Sheets.VisualState.normal&&this._isActiveColumn(n.sheet,n.col)&&(t=this._isSelectedColumn(n.sheet,n.col)?GC.Spread.Sheets.VisualState.selected:GC.Spread.Sheets.VisualState.highlight),t},r.prototype._isActiveColumn=function(n,t){for(var i,f=n.getSelections(),r=0,u=f;r<u.length;r++)if((i=u[r],i.col===-1||i.colCount===-1)||i.col<=t&&i.col+i.colCount>t)return!0;return!1},r.prototype._isSelectedColumn=function(n,t){for(var i,f=n.getSelections(),r=0,u=f;r<u.length;r++)if((i=u[r],i.row===-1||i.rowCount===-1)&&i.col<=t&&i.col+i.colCount>t)return!0;return!1},r}(GC.Spread.Sheets.CellTypes.ColumnHeader);n.SpreadJSColumnHeaderCellType=g;ht=function(i){function r(n,t,r){var u=i.call(this,r)||this;return u._columnInfo=n,u._calcSheetName=t,u.WIDTH=10,u.HEIGHT=8,u.SPACE=5,u.typeName="SpreadJSSortHeaderCellType",u}return __extends(r,i),r.prototype.paint=function(n,t,r,u,f,e,o,s){i.prototype.paint.call(this,n,t,r,u,f,e,o,s);this._paintSortIcon(n,r,u,f,e,o,s)},r.prototype._paintSortIcon=function(n,t,i,r,u,f){if(this.isSortIconShow()){var e=this._columnInfo.sortInfo;n.save();n.beginPath();e===0?this._paintASCIcon(n,t,i,r,u):this._paintDESCIcon(n,t,i,r,u);n.fillStyle!==f.foreColor&&(n.fillStyle=f.foreColor);n.fill();n.restore()}},r.prototype._paintASCIcon=function(n,t,i,r,u){var f=t+r-this.SPACE-this.WIDTH/2,e=i+u/2-this.HEIGHT/2;n.moveTo(f,e);n.lineTo(f-this.WIDTH/2,e+this.HEIGHT);n.lineTo(f+this.WIDTH/2,e+this.HEIGHT);n.lineTo(f,e)},r.prototype._paintDESCIcon=function(n,t,i,r,u){var f=t+r-this.SPACE-this.WIDTH,e=i+u/2-this.HEIGHT/2;n.moveTo(f,e);n.lineTo(f+this.WIDTH/2,e+this.HEIGHT);n.lineTo(f+this.WIDTH,e);n.lineTo(f,e)},r.prototype.getAutoFitWidth=function(n,t,r,u,f){var e=i.prototype.getAutoFitWidth.call(this,n,t,r,u,f);return e+this.WIDTH+this.SPACE*2},r.prototype.isSortIconShow=function(){return n.PrintCommand.IsPrinting?!1:this._columnInfo.sortInfo===0||this._columnInfo.sortInfo===1},r.prototype.paintContent=function(n,t,r,u,f,e,o,s){f=this._adjustTextAreaWidth(f);i.prototype.paintContent.call(this,n,t,r,u,f,e,o,s)},r.prototype._adjustTextAreaWidth=function(n){return this.isSortIconShow()&&(n=n-this.WIDTH-this.SPACE*2),n},r.prototype.getHitInfo=function(n,i,r,u,f){return t.getHitInfo(n,i,r,u,GC.Spread.Sheets.SheetArea.colHeader,f)},r.prototype.processMouseDown=function(n){return t.processMouseDown(this,n)},r.prototype.processMouseUp=function(n){return t.processMouseUp(this,n,n.row,n.col,GC.Spread.Sheets.SheetArea.colHeader)},r}(g);n.SpreadJSSortHeaderCellType=ht;ct=function(i){function r(n,t,r){var u=i.call(this,r)||this;return u._columnInfo=n,u._calcSheetName=t,u.imageSize=16,u.spaceWidth=1,u.typeName="SpreadJSFilterHeaderCellType",u}return __extends(r,i),Object.defineProperty(r,"supportedTypes",{get:function(){return[n.ColumnDataType.Bool,n.ColumnDataType.Number,n.ColumnDataType.Date,n.ColumnDataType.Time,n.ColumnDataType.String,n.ColumnDataType.User]},enumerable:!1,configurable:!0}),r.getIcon=function(t,i,r,u){var c=this,f=t,o,e,s,h;return i=i!==null&&i!==void 0?i:0,i===1&&(f=f+r),this.iconsImageCache[f]||(o=this.iconsCache[t],i===0?(s="%23666",h="white",e=l.createImage(n.Common.format(o,s,s,h))):(r=r!==null&&r!==void 0?r:"#666",r=n.ColorHelper.Convert(r),r=encodeURIComponent(r),e=l.createImage(n.Common.format(o,"transparent",r,"transparent"))),e.onload=function(){c.iconsImageCache[f]=e;u()}),this.iconsImageCache[f]},r.prototype.paint=function(n,t,r,u,f,e,o,s){i.prototype.paint.call(this,n,t,r,u,f,e,o,s);this.paintFilterIcon(n,r,u,f,e,o,s)},r.prototype.paintContent=function(n,t,r,u,f,e,o,s){var h=f-this.imageSize;i.prototype.paintContent.call(this,n,t,r,u,h,e,o,s)},r.prototype.getAutoFitWidth=function(n,t,r,u,f){var e=i.prototype.getAutoFitWidth.call(this,n,t,r,u,f);return e+this.imageSize+this.spaceWidth*2},r.prototype.getHitInfo=function(n,r,u,f,e){var s,o=t.getHitInfo(n,r,u,f,GC.Spread.Sheets.SheetArea.colHeader,e);return o&&((s=this.destRect)===null||s===void 0?void 0:s.contains(o.x,o.y))?o:i.prototype.getHitInfo.call(this,n,r,u,f,e)},r.prototype.processMouseDown=function(n){var r;return n&&((r=this.destRect)===null||r===void 0?void 0:r.contains(n.x,n.y))?t.processMouseDown(this,n):i.prototype.processMouseDown.call(this,n)},r.prototype.processMouseUp=function(n){var r;return n&&((r=this.destRect)===null||r===void 0?void 0:r.contains(n.x,n.y))?t.processMouseUp(this,n,n.row,n.col,GC.Spread.Sheets.SheetArea.colHeader):i.prototype.processMouseUp.call(this,n)},r.prototype.processMouseMove=function(n){var i;return n&&((i=this.destRect)===null||i===void 0?void 0:i.contains(n.x,n.y))?t.processMouseMove(n):t.processMouseLeave(n)},r.prototype.processMouseLeave=function(n){return t.processMouseLeave(n)},r.prototype.paintFilterIcon=function(t,i,u,f,e,o,s){var l,a,v,y,p,w,b=this.imageSize,k=-2,h=b,c=b,g;f<b-k&&(h=f+k);this.destRect=new GC.Spread.Sheets.Rect(i+f-h+k,u+e/2-c/2,h,c);var d=(l=n.ListviewBase.getListviewByCalcSheetName(this._calcSheetName))===null||l===void 0?void 0:l.getColumnFilterHelper(this._columnInfo),tt=n.Common.IsEmpty(this._columnInfo.sortInfo)?"null":this._columnInfo.sortInfo.toString(),it=d&&d.isColumnFilterValid(d.columnFilterQuery)?"filter":"null",nt=(a=this._listViewStyleTemplate)===null||a===void 0?void 0:a.ColumnFilterIconColor;((((v=this._listViewStyleTemplate)===null||v===void 0?void 0:v.IconColorUseCellForground)||((y=this._listViewStyleTemplate)===null||y===void 0?void 0:y.IconColorUseCellForground)===undefined)&&(nt=(p=o.foreColor)!==null&&p!==void 0?p:"black"),g=r.getIcon(tt+it,(w=this._listViewStyleTemplate)===null||w===void 0?void 0:w.ColumnFilterButtonStyle,nt,function(){var n;((n=s===null||s===void 0?void 0:s.sheet)===null||n===void 0?void 0:n.repaint)&&s.sheet.repaint(new GC.Spread.Sheets.Rect(i,u,f,e))}),g)&&(h<=0||c<=0||Math.floor(this.destRect.width)<=0||Math.floor(this.destRect.height)<=0||t.drawImage(g,0,0,h,c,Math.floor(this.destRect.x),Math.floor(this.destRect.y),Math.floor(this.destRect.width),Math.floor(this.destRect.height)))},r.iconsImageCache={},r.iconsCache=(f={},f.nullnull="data:image/svg+xml,%3Csvg width='16' height='16' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill-rule='evenodd'%3E%3Crect width='100%25' height='100%25' fill='{2}'/%3E%3Cpath d='M1 1v14h14V1H1zM0 0h16v16H0V0z'  fill='{0}' fill-rule='nonzero'/%3E%3Cpath d='M8 10L5 7h6z' fill='{1}'/%3E%3C/g%3E%3C/svg%3E",f.nullfilter="data:image/svg+xml,%3Csvg width='16' height='16' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill-rule='evenodd'%3E%3Crect width='100%25' height='100%25' fill='{2}'/%3E%3Cpath d='M1 1v14h14V1H1zM0 0h16v16H0V0z'  fill='{0}' fill-rule='nonzero'/%3E%3Cpath d='M5 13l-2-2h4z' fill='{1}'/%3E%3Cpath fill-rule='nonzero' d='M9.429 7.408L6 3h8l-3.429 4.408v2.449L9.429 11V7.408z' fill='{1}'/%3E%3C/g%3E%3C/svg%3E",f[0..toString()+"null"]="data:image/svg+xml,%3Csvg width='16' height='16' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill-rule='evenodd'%3E%3Crect width='100%25' height='100%25' fill='{2}'/%3E%3Cpath d='M1 1v14h14V1H1zM0 0h16v16H0V0z'  fill='{0}' fill-rule='nonzero'/%3E%3Cpath d='M5 13l-2-2h4zM10.5 3L13 6H8zM10 6h1v7h-1z' fill='{1}'/%3E%3C/g%3E%3C/svg%3E",f[1..toString()+"null"]="data:image/svg+xml,%3Csvg width='16' height='16' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill-rule='evenodd'%3E%3Crect width='100%25' height='100%25' fill='{2}'/%3E%3Cpath d='M1 1v14h14V1H1zM0 0h16v16H0V0z'  fill='{0}' fill-rule='nonzero'/%3E%3Cpath d='M5 13l-2-2h4zM10.5 13L8 10h5zM10 3h1v7h-1z' fill='{1}'/%3E%3C/g%3E%3C/svg%3E",f[0..toString()+"filter"]="data:image/svg+xml,%3Csvg width='16' height='16' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill-rule='evenodd'%3E%3Crect width='100%25' height='100%25' fill='{2}'/%3E%3Cpath d='M1 1v14h14V1H1zM0 0h16v16H0V0z' fill='{0}' fill-rule='nonzero'/%3E%3Cpath fill-rule='nonzero' d='M9.429 7.408L6 3h8l-3.429 4.408v2.449L9.429 11V7.408z' fill='{1}'/%3E%3Cpath d='M4.5 5L7 8H2zM4 8h1v5H4z' fill='{1}'/%3E%3C/g%3E%3C/svg%3E",f[1..toString()+"filter"]="data:image/svg+xml,%3Csvg width='16' height='16' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill-rule='evenodd'%3E%3Crect width='100%25' height='100%25' fill='{2}'/%3E%3Cpath d='M1 1v14h14V1H1zM0 0h16v16H0V0z' fill='{0}' fill-rule='nonzero'/%3E%3Cpath fill-rule='nonzero' d='M9.429 7.408L6 3h8l-3.429 4.408v2.449L9.429 11V7.408z' fill='{1}'/%3E%3Cpath d='M4.5 13L2 10h5zM4 5h1v5H4z' fill='{1}'/%3E%3C/g%3E%3C/svg%3E",f),r}(g);n.SpreadJSFilterHeaderCellType=ct;nt=function(i){function r(t,r,u,f,e,o){var s=i.call(this)||this,h,c;return s._oddRowBackcolor=u,s._evenRowBackcolor=f,s._calcSheetName=e,s._listViewStyleTemplate=o,h=n.Common.getMultiLanguageWord(r.CellType.Caption),c=r.CellType.ReadOnly,s._isReadOnly=n.Common.IsEmpty(c)===!0?!1:c,s._canEdit=t.canEditInForguncy,n.Common.IsEmpty(h)||s.caption(h),s}return __extends(r,i),r.shouldUse=function(t,i){return i.cellType.constructor===n.CheckBoxCellType&&!i.cellType.cellTypeData.canEnterEditModeInListview()},r.createInstance=function(n,t,i){return new r(t,i,n.oddRowBackcolor,n.evenRowBackcolor,n.getCalcSheetName(),n.listViewStyleTemplate)},r.prototype.getHitInfo=function(n,t,r,u,f){return!f||!this.allowChecked(f.row)?null:i.prototype.getHitInfo.call(this,n,t,r,u,f)},r.prototype.paint=function(n,r,u,f,e,o,s,h){s=t.setAlternativeRowColor(h.row,this._oddRowBackcolor,this._evenRowBackcolor,s,this._listViewStyleTemplate);i.prototype.paint.call(this,n,r,u,f,e,o,s,h)},r.prototype.paintValue=function(n,t,u,f,e,o,s,h){t=r.convertValue(t);i.prototype.paintValue.call(this,n,t,u,f,e,o,s,h)},r.prototype.allowChecked=function(t){return this._canEdit&&!this._isReadOnly&&!n.Platform.isMobile()&&!this.getListview().isCommiting(t)},r.prototype.getListview=function(){return n.ListviewBase.getListviewByCalcSheetName(this._calcSheetName)},r.prototype.processMouseDown=function(n){return n&&n.isReservedLocation&&(this._isMouseDownReservedLocation=!0),i.prototype.processMouseDown.call(this,n)},r.prototype.processMouseUp=function(n){if(!n)return!1;var r=this,t=n.sheet,u=this.getListview(),f=u.mappedRowIndexFrowView(n.row);return r._isMouseDownReservedLocation&&t&&n.isReservedLocation&&(t.getActiveRowIndex()!==n.row||t.getActiveColumnIndex()!==n.col||u.getCurrentRowIndex()!==f)?(r._isMouseDownReservedLocation=!1,!1):this.allowChecked(f)?i.prototype.processMouseUp.call(this,n):!1},r.prototype.processMouseLeave=function(n){return n&&(this._isMouseDownReservedLocation=!1),i.prototype.processMouseLeave.call(this,n)},r.convertValue=function(t){return n.CheckBoxCellType.isChecked(t)?1:0},r.prototype.isReservedKey=function(n,t){return this.allowChecked(t.row)&&i.prototype.isReservedKey.call(this,n,t)},r.prototype.toJSON=function(){return null},r}(GC.Spread.Sheets.CellTypes.CheckBox);n.CheckBoxCellTypeListView=nt;i.register(nt.shouldUse,nt.createInstance);ft=function(r){function u(n,t){var i=r.call(this)||this;return i.listview=n,i._listViewStyleTemplate=t,i.typeName="CheckBoxRowHeader",i}return __extends(u,r),u.prototype.paint=function(t,u,f,e,o,s,h,c){var l=this.getThemeStyle(c.visualState,"gc-rowHeader-"+n.SpreadJSHelpMethods.HelpMethods.getVisualStateName(c.visualState));h=i.getCustomStyle(h,l,this._listViewStyleTemplate,c.visualState);r.prototype.paint.call(this,t,u,f,e,o,s,h,c)},u.prototype.paintValue=function(t,i,u,f,e,o,s,h){var c=!1,l=h.sheet,a=h.row;n.ListViewHelper.SelectionHelper.isRowSelected(l,a)&&(c=!0);r.prototype.paintValue.call(this,t,c,u,f,e,o,s,h)},u.prototype.getHitInfo=function(n,i,r,u,f){return t.getHitInfo(n,i,r,u,GC.Spread.Sheets.SheetArea.rowHeader,f)},u.prototype.processMouseDown=function(n){return t.processMouseDown(this,n)},u.prototype.processMouseUp=function(n){return t.processMouseUp(this,n,n.row,n.col,GC.Spread.Sheets.SheetArea.rowHeader)},u.prototype.toJSON=function(){return null},u}(GC.Spread.Sheets.CellTypes.CheckBox);n.CheckBoxRowHeader=ft;lt=function(r){function u(){var n=r!==null&&r.apply(this,arguments)||this;return n._isRowHeaderVisible=null,n._isRowHeaderCheckBoxVisible=null,n}return __extends(u,r),u.prototype.getCheckBoxColumnWidth=function(n){var t=n.getColumnCount(GC.Spread.Sheets.SheetArea.rowHeader)===1?0:1;return n.getColumnWidth(t,GC.Spread.Sheets.SheetArea.rowHeader)-2},u.prototype.getCornerColumnWidth=function(n){return n.getColumnWidth(0,GC.Spread.Sheets.SheetArea.rowHeader)},u.prototype.getHitInfo=function(n,i,u,f,e){var o=e.sheet,s=this._getIsRowHeaderCheckBoxVisible(o);return s?(f.x=0,f.y=0,f.width=this.getCornerColumnWidth(o)+this.getCheckBoxColumnWidth(o),f.height=this._getColHeaderHeight(o),t.getHitInfo(n,i,u,f,GC.Spread.Sheets.SheetArea.corner,e)):r.prototype.getHitInfo.call(this,n,i,u,f,e)},u.prototype.processMouseDown=function(n){var u=this._getIsRowHeaderCheckBoxVisible(n.sheet),i;if(!u)return r.prototype.processMouseDown.call(this,n);i=t.processMouseDown(this,n);i||n.isReservedLocation&&(i=!0)},u.prototype.processMouseUp=function(n){var f=this._getIsRowHeaderCheckBoxVisible(n.sheet),u,i;if(!f)return r.prototype.processMouseUp.call(this,n);u=n.sheet;i=new GC.Spread.Sheets.Rect(0,0,0,0);i.x=0;u.getColumnCount(GC.Spread.Sheets.SheetArea.rowHeader)===2&&(i.x+=u.getColumnWidth(0,GC.Spread.Sheets.SheetArea.rowHeader));i.y=0;i.width=this.getCheckBoxColumnWidth(u);i.height=this._getColHeaderHeight(u);i.x<=n.x&&n.x<i.x+i.width&&i.y<=n.y&&n.y<i.y+i.height&&(n.isReservedLocation=!0,t.triggerButtonClicked(u,n.row,n.col,GC.Spread.Sheets.SheetArea.corner,GC.Spread.Sheets.SheetArea.corner))},u.prototype._getColHeaderHeight=function(n){for(var i=GC.Spread.Sheets.SheetArea.colHeader,u=n.getRowCount(i),r=0,t=0;t<u;t++)r+=n.getRowHeight(t,i);return r},u.prototype._getIsRowHeaderVisible=function(n){return this._isRowHeaderVisible===null&&(this._isRowHeaderVisible=n.getColumnCount(GC.Spread.Sheets.SheetArea.rowHeader)===1?!this._getIsRowHeaderCheckBoxVisible(n):!0),this._isRowHeaderVisible},u.prototype._getIsRowHeaderCheckBoxVisible=function(n){var i,t;return(this._isRowHeaderCheckBoxVisible===null&&(n.getColumnCount(GC.Spread.Sheets.SheetArea.rowHeader)===1?(i=n.getCellType(0,0,GC.Spread.Sheets.SheetArea.rowHeader),this._isRowHeaderCheckBoxVisible=i instanceof ft,this._rowHeaderCheckBoxColumnIndex=0):(this._isRowHeaderCheckBoxVisible=!0,this._rowHeaderCheckBoxColumnIndex=1)),this._isRowHeaderCheckBoxVisible&&(i=n.getCellType(0,this._rowHeaderCheckBoxColumnIndex,GC.Spread.Sheets.SheetArea.rowHeader),t=i.listview.listviewData.metadata.Columns[this._rowHeaderCheckBoxColumnIndex],t&&!t.IsHiddenByLayout&&!t.IsHiddenByJavaScriptAPI&&!t.IsHiddenByColumnOptions))?!0:!1},u.prototype.paint=function(t,r,f,e,o,s,h,c){var bt,kt,y=c.sheet,dt=y.tag(),ei,gt,et,w,nt,ii,it,ui,vt,ci,fi,li,vi,b,pt;if(this._listViewStyleTemplate=dt===null||dt===void 0?void 0:dt.ListViewStyleTemplate,ei=this._getIsRowHeaderVisible(y),gt=this._getIsRowHeaderCheckBoxVisible(y),n.ListViewHelper.SelectionHelper.isSelectAllRows(y)&&(r=!0),h.hAlign=GC.Spread.Sheets.HorizontalAlign.center,h.vAlign=GC.Spread.Sheets.VerticalAlign.center,et=gt?this.getCheckBoxColumnWidth(y)-1:0,t){t.save();t.rect(f,e,o,s);t.clip();t.beginPath();var ni=this._listViewStyleTemplate?n.ColorHelper.Convert(this._listViewStyleTemplate.ColumnHeaderBorder):null,oi="#C8C8C8",ot=ni,st=ni;if(this._listViewStyleTemplate&&!ni&&(ot=this._listViewStyleTemplate.ShowColumnHeaderHorizontalGridLine?(bt=n.ColorHelper.Convert(this._listViewStyleTemplate.ColumnHeaderGridLineColor))!==null&&bt!==void 0?bt:oi:"rgba(0,0,0,0)",st=this._listViewStyleTemplate.ShowColumnHeaderVerticalGridLine?(kt=n.ColorHelper.Convert(this._listViewStyleTemplate.ColumnHeaderGridLineColor))!==null&&kt!==void 0?kt:oi:"rgba(0,0,0,0)"),w=GC.Spread.Sheets.VisualState.normal,nt={},c.visualState!==undefined&&(w=c.visualState,nt=this.getThemeStyle(GC.Spread.Sheets.VisualState.hover,"gc-corner-triangle-"+n.SpreadJSHelpMethods.HelpMethods.getVisualStateName(w))),ei){if(typeof w!==undefined){try{var si=this.getThemeStyle(c.visualState,"gc-corner-"+n.SpreadJSHelpMethods.HelpMethods.getVisualStateName(w)),tt=i.getCustomStyle(null,si,this._listViewStyleTemplate,GC.Spread.Sheets.VisualState.normal),lt=tt&&tt.backColor,ti=tt&&tt.backgroundImage;lt?(t.fillStyle=lt,t.fillRect(f,e,o,s)):ti&&ti!=="none"&&(ii=new Image,it=ti,it=it.replace('url("',""),it=it.replace('")',""),ii.src=it,t.drawImage(ii,f,e,o,s))}catch(pi){}var ht=this.getThemeStyle(GC.Spread.Sheets.VisualState.hover,"gc-corner-triangle-"+n.SpreadJSHelpMethods.HelpMethods.getVisualStateName(w)),at=i.getCustomStyle(null,ht,this._listViewStyleTemplate,w),ri=at&&at.backgroundImage,hi=at&&at.backColor,ct=t.createLinearGradient(f+o/2,e,f+o/2,e+s);if(ri&&ri.indexOf("linear-gradient")!==-1){for(ui=n.SpreadJSHelpMethods.util.getLinearGradientColors(ri),vt=0,ci=ui.length;vt<ci;vt++)fi=ui[vt],ct.addColorStop(fi.point,fi.color);t.fillStyle=ct}else hi&&(li="#f6fafb",ct.addColorStop(.125,li),ct.addColorStop(1,hi),t.fillStyle=ct);this.paintRightBottomBorder(t,f,e,o,s,st||ht.borderLeftColor,st||ht.borderRightColor,ot||ht.borderTopColor,ot||ht.borderBottomColor,et)}t.restore()}else{if(typeof w!==undefined)try{var si=this.getThemeStyle(c.visualState,"gc-corner-"+n.SpreadJSHelpMethods.HelpMethods.getVisualStateName(w)),tt=i.getCustomStyle(h,si,this._listViewStyleTemplate,w),lt=tt&&tt.backColor;lt&&(t.fillStyle=lt,t.fillRect(f,e,o,s))}catch(pi){}this.paintRightBottomBorder(t,f,e,o,s,st||nt.borderLeftColor,st||nt.borderRightColor,ot||nt.borderTopColor,ot||nt.borderBottomColor,et);t.restore()}if(gt&&y.selectionPolicy()!==GC.Spread.Sheets.SelectionPolicy.single&&t){t.save();t.rect(f,e,o,s);t.clip();t.beginPath();var ai=this,g="",rt=0,p=0;y&&(rt=i.getStringWidthByCanvas(g,h.font,y),p=i.getTextHeight(h.font,y),g&&(vi=g.split(/\r\n|\r|\n/),p*=vi.length));b=new GC.Spread.Sheets.CellTypes.CheckBox;f=f+o-et;o=et;var l=u._checkboxSize/2,yi=new GC.Spread.Sheets.Rect(++f,++e,--o,--s),a=parseInt((e+ai._getCheckBoxTop(b,h,yi,p,y.zoom())).toString()),v=parseInt((f+ai._getCheckBoxLeft(b,h,yi,rt,y.zoom())).toString()),yt="left",ut=v+1;h.hAlign===GC.Spread.Sheets.HorizontalAlign.center?(yt="center",ut+=l):h.hAlign===GC.Spread.Sheets.HorizontalAlign.right&&(yt="right",ut+=l*2);pt=h.font;pt&&t.font!==pt&&(t.font=pt);h.foreColor&&(t.fillStyle=h.foreColor);var k=h.textDecoration,ft=c.fontInfo.fontSize,wt=ft>8?Math.floor((ft-8)/5+2):1,d=p/2-ft/2+wt-1;t.textBaseline!=="alphabetic"&&(t.textBaseline="alphabetic");b.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.left?(t.textAlign="right",t.fillText(g,v+1-2,a+l+p/2-d),k&&i.renderTextDecoration(t,k,v+1-2,a+l+p/2-d,rt,ft,wt)):b.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.top&&(t.textAlign=yt,t.fillText(g,ut,a-2-d),k&&i.renderTextDecoration(t,k,ut,a-2-d,rt,p));t.save();t.strokeStyle="black";v-=2;t.strokeRect(v+.5,a+.5,l*2+.05,l*2+.05);t.fillStyle="white";t.fillRect(v+1,a+1,l*2-1,l*2-1);b.isThreeState()&&(r===null||r===undefined)?(t.beginPath(),t.fillStyle="green",t.rect(v+3,a+3,(l-2.5)*2,(l-2.5)*2),t.fill()):!!r==!0&&(t.beginPath(),t.lineWidth=2.5,t.moveTo(v+3,a+l),t.lineTo(v+l,a+l*2-3.5),t.lineTo(v+l*2-1.5,a+3),t.stroke());t.restore();h.foreColor&&(t.fillStyle=h.foreColor);b.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.right?(t.textAlign="left",t.fillText(g,v+1+l*2+2,a+l+p/2-d),k&&i.renderTextDecoration(t,k,v+1+l*2+2,a+l+p/2-d,rt,ft,wt)):b.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.bottom&&(t.textAlign=yt,t.fillText(g,ut,a+l*2+2+p-d),k&&i.renderTextDecoration(t,k,ut,a+l*2+2+p-d,rt,ft,wt));t.restore()}}},u.prototype._getCheckBoxLeft=function(n,t,i,r,f){var e=i.x-1,s=i.width+1,h=0,o=0,c=5*f;return n.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.top||n.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.bottom?(o=e+c,t.hAlign===GC.Spread.Sheets.HorizontalAlign.center?o=e+s/2-u._checkboxSize/2:t.hAlign===GC.Spread.Sheets.HorizontalAlign.right&&(o=e+s-c-u._checkboxSize)):n.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.left?(h=u._checkboxSize+r,o=e+c+r,t.hAlign===GC.Spread.Sheets.HorizontalAlign.center?o=e+s/2-h/2+r:t.hAlign===GC.Spread.Sheets.HorizontalAlign.right&&(o=e+s-c-h+r)):(h=u._checkboxSize+r,o=e+c,t.hAlign===GC.Spread.Sheets.HorizontalAlign.center?o=e+s/2-h/2:t.hAlign===GC.Spread.Sheets.HorizontalAlign.right&&(o=e+s-c-h)),o-e},u.prototype._getCheckBoxTop=function(n,t,i,r,f){var e=i.y-1,s=i.height+1,h=0,o=0,c=5*f;return n.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.top?(h=u._checkboxSize+r,o=e+c+r,t.vAlign===GC.Spread.Sheets.VerticalAlign.center?o=e+s/2-h/2+r:t.vAlign===GC.Spread.Sheets.VerticalAlign.bottom&&(o=e+s-c-h+r)):n.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.bottom?(h=u._checkboxSize+r,o=e+c,t.vAlign===GC.Spread.Sheets.VerticalAlign.center?o=e+s/2-h/2:t.vAlign===GC.Spread.Sheets.VerticalAlign.bottom&&(o=e+s-c-h)):(o=e+c,t.vAlign===GC.Spread.Sheets.VerticalAlign.center?o=e+s/2-u._checkboxSize/2:t.vAlign===GC.Spread.Sheets.VerticalAlign.bottom&&(o=e+s-c-u._checkboxSize)),o-e},u.prototype.paintRightBottomBorder=function(n,t,i,r,u,f,e,o,s,h){var y=n.createLinearGradient(t+r,i+1,t+r,i+u-2),l,c,a,v;y.addColorStop(0,f);y.addColorStop(1,e);n.beginPath();n.strokeStyle=y;n.moveTo(t+r-.5,i);n.lineTo(t+r-.5,i+u);n.stroke();l=n.createLinearGradient(t,i,t+r-2,i);l.addColorStop(0,o);l.addColorStop(1,s);n.beginPath();n.strokeStyle=l;n.moveTo(t,i+u-.5);n.lineTo(t+r,i+u-.5);n.stroke();n.beginPath();c=3;a=u;r-h<u&&(a=r-h);v=h;n.moveTo(t+r-a+c-v,i+u-c);n.lineTo(t+r-c-v,i+u-c);n.lineTo(t+r-c-v,i+u-a+c);n.fill()},u._checkboxSize=12,u}(GC.Spread.Sheets.CellTypes.Corner);n.MutiCheckCornerCellType=lt;tt=function(r){function u(t,i,u,f,e,o,s){var h=r.call(this)||this;return h.oddRowBackcolor=u,h.evenRowBackcolor=f,h._calcSheetName=o,h._listViewStyleTemplate=s,h._currentZoomFactor=e.zoom(),h._cellMetaData=i,h._cellType=i.CellType,h._cellStyle=n.SpreadJSView.createStyleByCell(t.columnInfo.TemplateCell),h._canEdit=t.canEditInForguncy,h._isReadOnly=!!h._cellType.ReadOnly,h._nodes=[],h._cellType.hasInitItemsInfo=!1,h._tryInitItemsInfo(e),h}return __extends(u,r),u.prototype._tryInitItemsInfo=function(n){!this._cellType.hasInitItemsInfo&&this._cellType.haveLoadItems&&(this._initItemsInfo(n),this._cellType.hasInitItemsInfo=!0,this._cellType.initItemsInfoCallback&&this._cellType.initItemsInfoCallback())},u.prototype._initItemsInfo=function(t){var r=this,f,u,e,o,s,h,l,c,a;for(r.itemsMargin=n.Common.IsEmpty(r._cellType.ItemSpace)===!0?5:r._cellType.ItemSpace,r.itemsDisplayText=[],r.itemsValueText=[],r.itemsTextWidth=[],r.totalTextWidth=0,r.itemsTextHeight=[],r.itemsTextFormatFontColor=[],f=r._cellType.ItemsInfo.Items,r.itemsCount=f.length,u=0;u<r.itemsCount;u++)e=void 0,e=f[u].DisplayValue===undefined||f[u].DisplayValue===null?r._cellType.AddNullItemWhenBinding?r._cellType.AddOtherItem:"":n.Common.getMultiLanguageWord(f[u].DisplayValue.toString()),o=r._cellMetaData.StyleInfo,o.Formatter&&(s=n.FormatHelper.format(o.Formatter,e),e=s.text,r.itemsTextFormatFontColor[u]=s.color),r.itemsDisplayText[u]=e,r.itemsValueText[u]=n.Common.IsEmpty(f[u].Value)?"":f[u].Value.toString(),h=n.ListViewHelper.SpreadJSStyleHelper.generateFontText(o),r.itemsTextWidth[u]=i.getStringWidthByCanvas(r.itemsDisplayText[u],h,t),r.totalTextWidth+=r.itemsTextWidth[u],r.itemsTextHeight[u]=i.getTextHeight(h,t),r.itemsDisplayText[u]&&(l=r.itemsDisplayText[u].split(/\r\n|\r|\n/),r.itemsTextHeight[u]*=l.length);c=this.getListview();a=c.listviewData.getAutoFitColumnWidth();a&&n.DelayRefresh.setTimeout(function(){c.autoFitColumnWidth()})},u.prototype.getItemLeftPosition=function(n,t,i,r,f){for(var l=t.width,s=0,o=0,e=this,a=e._getItemsGroupMargin(r),h=0,c=0;c<f;c++)h+=i[c];return h+=e.itemsMargin*f,s=e.itemsCount*(u.itemsSize+e.itemsMargin)+e.totalTextWidth,n.hAlign===GC.Spread.Sheets.HorizontalAlign.left?o=a:n.hAlign===GC.Spread.Sheets.HorizontalAlign.center?o=l/2-s/2:n.hAlign===GC.Spread.Sheets.HorizontalAlign.right&&(o=l-a-s),o+u.itemsSize*f+h},u.prototype.getItemTopPosition=function(n,t,i){var f=t.height,o=this,e=o._getItemsGroupMargin(i),r=e;return n.vAlign===GC.Spread.Sheets.VerticalAlign.center?r=f/2-u.itemsSize/2:n.vAlign===GC.Spread.Sheets.VerticalAlign.bottom&&(r=f-e-u.itemsSize),r},u.prototype._getItemsGroupMargin=function(n){return 5*n},u.prototype._isHitCurrentItem=function(n,t){var i=this,o=parseInt(i.getItemLeftPosition(i._cellStyle,n.cellRect,i.itemsTextWidth,n.sheet.zoom(),t).toString()),s=parseInt(i.getItemTopPosition(i._cellStyle,n.cellRect,n.sheet.zoom()).toString()),r=o+n.cellRect.x+u.itemsSize/2,f=s+n.cellRect.y+u.itemsSize/2,h=u.itemsSize/2,c=u.itemsSize/2+i.itemsTextWidth[t],e=i.itemsTextHeight[t]/2;if(r-h<=n.x&&n.x<=r+c&&f-e<=n.y&&n.y<=f+e)return!0},u.prototype.updateItemsGroupValue=function(n,t){var e=this,i=n.toString().split(","),o=i.indexOf(this.itemsValueText[t]),r,u,s,f;if(o===-1){for(i.push(this.itemsValueText[t]),r=[],u=0;u<i.length;u++)s=e.itemsValueText.indexOf(i[u]),s!==-1&&r.push(e.itemsValueText.indexOf(i[u]));for(r.sort(function(n,t){return n-t}),i=[],f=0;f<r.length;f++)i[f]=e.itemsValueText[r[f]]}else i.splice(o,1);return i.join(",")},u.prototype._allowChecked=function(t){return this._canEdit&&!this._isReadOnly&&!n.Platform.isMobile()&&!this.getListview().isCommiting(t)},u.prototype.getListview=function(){return n.ListviewBase.getListviewByCalcSheetName(this._calcSheetName)},u.prototype.getHitInfo=function(n,t,i,r,u){if(u&&this._allowChecked(u.row)){var f=u.sheetArea;if(f===null||f===undefined||f===GC.Spread.Sheets.SheetArea.viewport)return{x:n,y:t,row:u.row,col:u.col,cellRect:r,sheetArea:f,isReservedLocation:!0,sheet:u.sheet}}return null},u.prototype.processMouseDown=function(n){if(!n)return!1;n.isReservedLocation&&(this._isMouseDownReservedLocation=!0)},u.prototype.getNode=function(t){return n.Common.IsEmpty(this._nodes[t])&&(this._nodes[t]={}),this._nodes[t]},u.prototype.deleteNode=function(n){this._nodes[n]=undefined},u.prototype.processMouseUp=function(t){var u=this,f,h,o;if(u._allowChecked(t.row)){if(f=t.sheet,u._isMouseDownReservedLocation&&f&&t.isReservedLocation){u._isMouseDownReservedLocation=!1;var e=t.row,c=t.col,s=t.sheetArea,r=u.getNode(e);if(r.isFirstMouseUp)delete r.isFirstMouseUp,r.mouseupToken&&(window.clearTimeout(r.mouseupToken),delete r.mouseupToken),u.deleteNode(e);else{if(s===null||s===undefined||s===GC.Spread.Sheets.SheetArea.viewport){h=f.getValue(e,c,s);n.Common.IsEmpty(h)&&(h="");var l="",a=u.getListview(),v=a.mappedRowIndexFrowView(e);for(o=0;o<u.itemsCount;o++)if(u._isHitCurrentItem(t,o)){f.getActiveRowIndex()===e&&f.getActiveColumnIndex()===c&&a.getCurrentRowIndex()===v&&(l=u.updateItemsGroupValue(h.toString(),o),i.executeEditCommand(f,e,c,l));break}}return r.isFirstMouseUp=!0,r.mouseupToken=window.setTimeout(function(){delete r.isFirstMouseUp;r.mouseupToken&&(window.clearTimeout(r.mouseupToken),delete r.mouseupToken)},250),!0}}return!1}},u.prototype.paint=function(i,r,u,f,e,o,s,h){i&&(this._currentZoomFactor=h.sheet.zoom(),this._tryInitItemsInfo(h.sheet),s=t.setAlternativeRowColor(h.row,this.oddRowBackcolor,this.evenRowBackcolor,s,this._listViewStyleTemplate),h&&h.parentBackColor&&h.parentBackColor===s.backColor||n.SpreadJSHelpMethods.CellTypeContext.paintBackground(i,u,f,e,o,s.backColor,s.backgroundImage,s.backgroundImageLayout,h.imageLoader),this.paintValue(i,r,u,f,e,o,s,h))},u.prototype.paintValue=function(t,r,f,e,o,s,h,c){var l,y,v,w,a;if(t)try{if(t.save(),t.rect(f,e,o,s),t.clip(),t.beginPath(),l=this,y=c.sheet,y)for(v=u.itemsSize/2,w=new GC.Spread.Sheets.Rect(++f,++e,--o,--s),a=0;a<l.itemsCount;a++){var b=parseInt((f+l.getItemLeftPosition(h,w,l.itemsTextWidth,y.zoom(),a)).toString()),k=parseInt((e+l.getItemTopPosition(h,w,y.zoom())).toString()),d=h.font;d&&t.font!==d&&(t.font=d);h.foreColor&&(t.fillStyle=h.foreColor);var g=h.textDecoration,p=c.fontInfo.fontSize,nt=p>8?Math.floor((p-8)/5+2):1,tt=l.itemsTextHeight[a]/2-p/2+nt-1;t.textBaseline!=="alphabetic"&&(t.textBaseline="alphabetic");l.paintIcon(t,r,b,k,v,a);n.Common.IsEmpty(l.itemsTextFormatFontColor[a])?h.foreColor&&(t.fillStyle=h.foreColor):t.fillStyle=l.itemsTextFormatFontColor[a];t.textAlign="left";t.fillText(l.itemsDisplayText[a],b+1+v*2+2,k+v+l.itemsTextHeight[a]/2-tt);g&&i.renderTextDecoration(t,g,b+1+v*2+2,k+v+l.itemsTextHeight[a]/2-tt,l.itemsTextWidth[a],p,nt)}}finally{t.restore()}},u.prototype.paintIcon=function(){},u.prototype.getAutoFitWidth=function(){var n=this;return n.itemsCount*(u.itemsSize+n.itemsMargin)+n.totalTextWidth},u.prototype.getAutoFitHeight=function(){var n=this,t=0;return n.itemsTextHeight&&n.itemsTextHeight.length>0&&n.itemsTextHeight.forEach(function(n){n>t&&(t=n)}),Math.max(u.itemsSize,t)},u.prototype.getCurrentItemInfo=function(n,t){if(t<0||t>=this.itemsCount)return null;var i={};return i["width"]=this.itemsTextWidth[t]+u.itemsSize,i["height"]=this.itemsTextHeight[t],i["startX"]=this.getItemLeftPosition(this._cellStyle,n,this.itemsTextWidth,this._currentZoomFactor,t),i["startY"]=this.getItemTopPosition(this._cellStyle,n,this._currentZoomFactor),i["displayText"]=this.itemsDisplayText[t],i},u.prototype.toJSON=function(){return null},u.itemsSize=12,u}(GC.Spread.Sheets.CellTypes.Base);n.SpreadJSItemsGroupCellType=tt;it=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.shouldUse=function(t,i){return i.cellType.constructor===n.CheckBoxGroupCellType&&!i.cellType.cellTypeData.canEnterEditModeInListview()},i.createInstance=function(n,t,r){return new i(t,r,n.oddRowBackcolor,n.evenRowBackcolor,n._sheet,n.getCalcSheetName(),n.listViewStyleTemplate)},i.prototype.paintIcon=function(n,t,i,r,u,f){try{if(n.save(),n.strokeStyle="Black",n.strokeRect(i+.5,r+.5,u*2+.05,u*2+.05),n.fillStyle="White",n.fillRect(i+1,r+1,u*2-1,u*2-1),t!==undefined){t===null&&(t="");var e=t.toString().split(",");e.indexOf(this.itemsValueText[f])!==-1&&(n.beginPath(),n.strokeStyle="Black",n.lineWidth=2.5,n.moveTo(i+3,r+u),n.lineTo(i+u,r+u*2-3.5),n.lineTo(i+u*2-1.5,r+3),n.stroke())}}finally{n.restore()}},i}(tt);n.SpreadJSCheckBoxGroupCellType=it;i.register(it.shouldUse,it.createInstance);rt=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.shouldUse=function(t,i){return i.cellType.constructor===n.RadioGroupCellType&&!i.cellType.cellTypeData.canEnterEditModeInListview()},i.createInstance=function(n,t,r){return new i(t,r,n.oddRowBackcolor,n.evenRowBackcolor,n._sheet,n.getCalcSheetName(),n.listViewStyleTemplate)},i.prototype.paintIcon=function(n,t,i,r,u,f){try{if(n.save(),n.beginPath(),n.arc(i+u,r+u,u,0,2*Math.PI),n.closePath(),n.strokeStyle="Black",n.stroke(),n.beginPath(),n.arc(i+u,r+u,u-.5,0,2*Math.PI),n.closePath(),n.fillStyle="White",n.fill(),t!==undefined){t===null&&(t="");var e=t.toString();e===this.itemsValueText[f]&&(n.beginPath(),n.arc(i+u,r+u,u-2.8,0,2*Math.PI),n.closePath(),n.fillStyle="Black",n.fill())}}finally{n.restore()}},i.prototype.updateItemsGroupValue=function(n,t){return n!==this.itemsValueText[t]?this.itemsValueText[t]:n},i}(tt);n.SpreadJSRadioGroupCellType=rt;i.register(rt.shouldUse,rt.createInstance)})(Forguncy||(Forguncy={}))
;var __spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var t={SortAsc:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M7 7H5.906L5.47 5.864H3.48L3.067 7H2l1.94-5h1.065L7 7zM5.148 5.022L4.46 3.166l-.673 1.856h1.36z" fill="#418FCF"/><path fill="#C74444" d="M2 14v-.91l3.233-3.244H2.365V9H6.87v.784l-3.371 3.374H7V14z"/><g fill="#666"><path d="M11.5 13L9 10h5zM11 3h1v7h-1z"/><\/g><\/g><\/svg>',SortDesc:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M7 14H5.906l-.436-1.136H3.48L3.067 14H2l1.94-5h1.065L7 14zm-1.852-1.978l-.687-1.856-.673 1.856h1.36z" fill="#418FCF"/><path fill="#C74444" d="M2 7v-.91l3.233-3.244H2.365V2H6.87v.784L3.499 6.158H7V7z"/><g fill="#666"><path d="M11.5 13L9 10h5zM11 3h1v7h-1z"/><\/g><\/g><\/svg>',SortAsc_Checked:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M7 7H5.906L5.47 5.864H3.48L3.067 7H2l1.94-5h1.065L7 7zM5.148 5.022L4.46 3.166l-.673 1.856h1.36z" fill="#418FCF"/><path fill="#C74444" d="M2 14v-.91l3.233-3.244H2.365V9H6.87v.784l-3.371 3.374H7V14z"/><g fill="#666"><path d="M11.5 13L9 10h5zM11 3h1v7h-1z"/><\/g><path stroke="#EA7044" d="M.5.5h15v15H.5z"/><\/g><\/svg>',SortDesc_Checked:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M7 14H5.906l-.436-1.136H3.48L3.067 14H2l1.94-5h1.065L7 14zm-1.852-1.978l-.687-1.856-.673 1.856h1.36z" fill="#418FCF"/><path fill="#C74444" d="M2 7v-.91l3.233-3.244H2.365V2H6.87v.784L3.499 6.158H7V7z"/><g fill="#666"><path d="M11.5 13L9 10h5zM11 3h1v7h-1z"/><\/g><path stroke="#EA7044" d="M.5.5h15v15H.5z"/><\/g><\/svg>',FilterClear:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="a" d="M0 0h12v12H0z"/><\/defs><g fill="none" fill-rule="evenodd"><path d="M7.302 6.528c0-.026-.005-.054-.001-.079-.004.025 0 .053 0 .08M7.329 6.684c.01.033.027.066.044.102a1.047 1.047 0 0 1-.044-.102M7.361 6.305c.01-.013.012-.03.022-.042-.01.012-.013.03-.022.042" fill="#419AE5"/><path d="M15.7 13.868c-.45-1.072-1.792-2.812-3.062-4.322 1.632-1.426 2.98-2.34 2.98-2.34s1.135-.887-.562-.323c-.75.25-1.92 1.008-3.099 1.863a63.838 63.838 0 0 0-1.567-1.749c-1.398-1.675-4.92-1.127-1.93.8.82.497 1.627 1.117 2.388 1.775a65.873 65.873 0 0 0-2.575 2.084c-1.672 1.278-1.834 5.243.336 2.251.891-1.293 2.026-2.506 3.123-3.538a37.099 37.099 0 0 1 3.776 4.2s.964 1.133.192-.7" fill="#D65836"/><g transform="translate(0 1)"><mask id="b" fill="#fff"><use xlink:href="#a"/><\/mask><path d="M6.857 10.286v-3.53a2.587 2.587 0 0 1-.38-.527 1.473 1.473 0 0 1-.164-.922c0-.008 0-.013.002-.02.01-.056.015-.11.03-.167.207-.7.902-1.12 1.858-1.12.193 0 .409.021.638.062L12 0H0l5.143 6.612V12l1.714-1.714z" fill="#666" mask="url(#b)"/><\/g><\/g><\/svg>'},r=function(){function t(){}return t.getFieldColumnFilterQueries=function(t,i){i===void 0&&(i=[]);var r=n.ForguncyData.pageInfo.columnFilterQueryCache[t];return r?r.filter(function(n){return n.ColumnBindingInfoID&&i.filter(function(t){return t.GUID===n.ColumnBindingInfoID}).length===0}):null},t.clearColumnFilterCache=function(t){var i=t.getLocationString();n.ForguncyData.pageInfo.columnFilterQueryCache[i]=undefined},t.showContextMenu=function(t,r){var f=r.col,u=(new n.UI.ContextMenu).identify("fgc-columnfilter-contextmenu"),s=i.createSortMenuItems(t,f,u),h=i.createClearFilterMenuItem(t,f,u),c=i.createAdvancedFilterMenuItem(t,f,u),l=i.createBasicFilterMenuItem(t,f,u),o,e;u.add.apply(u,__spreadArray(__spreadArray([],s,!1),[new n.UI.ContextMenuItem(new n.UI.ContextMenuSpliter),h,new n.UI.ContextMenuItem(new n.UI.ContextMenuSpliter),c,l],!1));n.ForguncyData.pageInfo.appendExtralPopup(u);n.PageBuilder.pagesContainer.append(u.createUI().container);o=$(n.SpreadJSView.getCanvas(t.getCalcSheetName()));e=o.offset();u.location=new n.Numerics.Vector2(e.left+r.x||0,e.top+r.y||0);u.show()},t}(),i;n.ColumnFilterHelper=r;i=function(){function i(){}return i.createSortMenuItems=function(r,u,f){var e=r.listviewData.visibleColumns[u],h=i.isFilterCurrentPage(r,e)?n.RS.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage:"",o=new n.UI.ContextMenuButton(n.RS.ColumnFilter_ContextMenu_SortAscending+h,t.SortAsc_Checked,t.SortAsc).on("Clicked",function(){r.sortByColumn(u,0);f.dispose()}).identify("fgc-columnfilter-sortasc"),s=new n.UI.ContextMenuButton(n.RS.ColumnFilter_ContextMenu_SortDesending+h,t.SortDesc_Checked,t.SortDesc).on("Clicked",function(){r.sortByColumn(u,1);f.dispose()}).identify("fgc-columnfilter-sortdesc"),c=e.sortInfo;return o.isChecked=c===0,s.isChecked=c===1,e.getIsFilterListCompareType()&&(o.enabled=!1,s.enabled=!1),[o,s].map(function(t){return new n.UI.ContextMenuItem(t)})},i.createClearFilterMenuItem=function(r,u,f){var e=r.listviewData.visibleColumns[u],o=r.getColumnFilterHelper(e),h=i.isFilterCurrentPage(r,e)?n.RS.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage:"",s=new n.UI.ContextMenuButton(n.RS.ColumnFilter_ContextMenu_ClearFilter+h,t.FilterClear,t.FilterClear).on("Clicked",function(){r.tryCommitValueBeforeQueryOrSort()&&(o.clearColumnFilter(),r.resetDataAfterFilter(e));f.dispose()}).identify("fgc-columnfilter-clear");return s.enabled=o.isColumnFilterValid(o.columnFilterQuery),new n.UI.ContextMenuItem(s)},i.createAdvancedFilterMenuItem=function(t,r,u){var f=t.listviewData.visibleColumns[r],c=this.getColumnDataType(f,t),s=n.AdvancedFilterFactory.create(c,i.isFilterCurrentPage(t,f)),e,h,o;if(s&&(e=new n.UI.ContextMenuButton(s.title),h=t.getColumnFilterHelper(f).columnFilterQuery,e.isChecked=!n.Common.IsEmpty(h.Conditions)),e){o=new n.UI.ContextMenuItem(e).identify("fgc-columnfilter-advanced");o.child=s.createContextMenu(t,f);o.child.on("Dispose",function(){u.dispose()})}return o},i.getColumnDataType=function(t,i){if(t.allowFieldSort()){if(t.getIsFilterListCompareType())return 4;var r=t.getFilterColumnDataType();return this.convertFilterDataType(r)}return n.Common.IsEmpty(t.filterColumnDataType)&&(t.filterColumnDataType=this.getDataTypeOfNoFieldColumn(i,t)),t.filterColumnDataType},i.getDataTypeOfNoFieldColumn=function(n,t){var i=this.getValueTypeByFormatString(t);return i!==null?i:this.getDataTypeOfFirstValue(n,t)},i.getValueTypeByFormatString=function(t){var i=t.getOriginalFormatter();return n.FormatHelper.isFormatSetted(i)?i==="@"?1:n.FormatHelper.isDateOrTimeFormat(i)?n.FormatHelper.isTimeFormat(i)?3:2:null:null},i.getDataTypeOfFirstValue=function(t,i){for(var r,e,u=t.getListDataModel(),o=i.getColumnIndex(),s=u.getRowCount(),f=0;f<s;f++){r=u.getValue(0,o);e=typeof r;switch(e){case"number":return 0;case"string":return 1;case"object":if(n.DateHelper.isValidDate(r))return this.isTime(n.Convertor.fromDateToOADate(r))?3:2}}return null},i.isTime=function(n){return n<=1},i.createBasicFilterMenuItem=function(t,r,u){var f=t.listviewData.visibleColumns[r],s=i.isFilterCurrentPage(t,f)?n.RS.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage:"",e=new n.UI.ContextMenuButton(n.RS.ColumnFilter_ContextMenu_Filter+s).on("Clicked",function(){u.dispose();var i=new n.BasicFilterDialog(t,f);n.ForguncyData.pageInfo.appendExtralPopup(i);n.PageBuilder.pagesContainer.append(i.createUI().container);i.show()}).identify("fgc-columnfilter-basic"),o=t.getColumnFilterHelper(f).columnFilterQuery;return e.isChecked=n.Common.IsEmpty(o.Conditions)&&!n.Common.IsEmpty(o.Values),e.enabled=!f.getIsFilterStatisticColumn(),new n.UI.ContextMenuItem(e)},i.convertFilterDataType=function(t){switch(t){case n.ColumnDataType.String:case n.ColumnDataType.User:return 1;case n.ColumnDataType.Number:return 0;case n.ColumnDataType.Date:return 2;case n.ColumnDataType.Time:return 3;default:return null}},i.isFilterCurrentPage=function(t,i){return i.allowNoFieldSort()&&n.ForguncyData.pageingInfoList.IsPageing(t.getLocationString())},i}();n.ContextMenuBuilder=i})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var r='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><title>Admonition<\/title><g fill="none" fill-rule="evenodd"><path d="M8.933 1.557l6.878 11.5c.344.574.205 1.35-.31 1.733-.185.137-.401.21-.623.21H1.122C.502 15 0 14.44 0 13.75c0-.247.066-.488.188-.694l6.879-11.5C7.41.983 8.107.828 8.622 1.21c.123.092.23.21.311.347z" fill="#F8BB59"/><path d="M7 5h2l-.37 6H7.37L7 5zm.994 7c.283 0 .529.093.722.278.18.186.284.424.284.715 0 .292-.103.543-.284.729a1.032 1.032 0 0 1-.722.278.94.94 0 0 1-.697-.291C7.09 13.523 7 13.285 7 12.993c0-.291.09-.53.297-.715A.93.93 0 0 1 7.994 12z" fill="#666"/><\/g><\/svg>',u=function(i){function u(u,f){var e=i.call(this)||this;return e.id="fgc-basicfilter-dialog",e.defaultUI=t,e.treeView=(new n.UI.TreeView).identify("fgc-basicfilter-treeview"),e.textBlock=new n.UI.IconText(n.RS.ColumnFilter_TreeView_TooManyItems,r).identify("fgc-basicfilter-overflow"),e.progress=new n.UI.Progress,e.isShowAllItems=!0,e.listview=u,e.visibleColumn=f,e.columnFilterHelper=u.getColumnFilterHelper(f),e.title=n.RS.ColumnFilter_Dialog_Title+(n.ContextMenuBuilder.isFilterCurrentPage(u,f)?n.RS.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage:""),e.textBlock.visibility=!1,e.progress.show(),n.DelayRefresh.setTimeout(function(){e.initializeEvents();e.initializeData();n.DelayRefresh.setTimeout(function(){e.progress.hide()},0)},0),e}return __extends(u,i),u.prototype.initializeEvents=function(){var n=this;this.on("Confirm",function(){if(n.listview.tryCommitValueBeforeQueryOrSort()){if(n.treeView.nodes[0].isChecked&&!n.treeView.nodes[0].indeterminate)n.columnFilterHelper.clearColumnFilter();else{n.columnFilterHelper.clearColumnFilterConditions();var t=n.treeView.nodes[0].leafs,r=t.filter(function(n){return n.isChecked}),u=!1,i=null;r.length<t.length/2||!n.isShowAllItems?i=r.map(function(n){return n.userData.DisplayValue}):(u=!0,i=t.filter(function(n){return!n.isChecked}).map(function(n){return n.userData.DisplayValue}));n.columnFilterHelper.setBasicFilter(u,i)}n.listview.resetDataAfterFilter(n.visibleColumn)}})},u.prototype.initializeData=function(){var t=this,i=function(i,r){var e=i||[],c=r||__spreadArray([],e,!0),o=e.map(function(n,t){return{Value:e[t],DisplayValue:c[t]}}),f=o.filter(function(n){return n.Value!==null&&n.DisplayValue!==null}),s,h,u;f.length<o.length&&f.push({Value:null,DisplayValue:null});h=n.ContextMenuBuilder.getColumnDataType(t.visibleColumn,t.listview);s=h===2?t.generateDateNodes(f):t.generateNormalNodes(f,t.visibleColumn,t.listview);u=new n.UI.TreeViewNode(n.RS.ColumnFilter_TreeView_SelectAll);u.isExpand=!0;u.addChildren(s);t.initRootCheckedState(u);u.refreshNodes();t.treeView.add(u);t.isShowAllItems=u.leafs.length<500;t.textBlock.visibility=!t.isShowAllItems;t.footerButtonGroup.items[0].enabled=u.isChecked||u.indeterminate;u.on("PropertyChanged",function(n,i){(i==="isChecked"||i==="indeterminate")&&(t.footerButtonGroup.items[0].enabled=u.isChecked||u.indeterminate)})},r=function(){t.footerButtonGroup.items[0].enabled=!1};this.visibleColumn.allowFieldSort()?this.queryRowsForFieldColumn(i,r):this.queryRowsForNoFieldColumn(i,r)},u.prototype.initRootCheckedState=function(n){var u,t=this.columnFilterHelper.columnFilterQuery,r=t.IsNotInMode,i=t.Values,f;if(((u=t.Conditions)===null||u===void 0?void 0:u.length)>0)switch(t.filterComapreType){case 1:r=!1;i=[t.Conditions[0].Value];break;case 2:r=!0;i=[t.Conditions[0].Value];break;case 15:r=!1;i=t.Conditions[0].Value.split(",").map(function(n){return n.trim()});break;case 16:r=!0;i=t.Conditions[0].Value.split(",").map(function(n){return n.trim()});break;default:n.leafs.forEach(function(n){return n.isChecked=!1});return}(i===null||i===void 0?void 0:i.length)>0?n.leafs.forEach(function(n){n.isChecked=r!==i.some(function(t){return t===n.userData.DisplayValue})}):(f=this.listview.getListDataCount()>0,n.leafs.forEach(function(n){return n.isChecked=f}))},u.prototype.queryRowsForFieldColumn=function(t,i){var f=this.visibleColumn.getFilterBindingInfo(),e=this.visibleColumn.getFilterDisplayBindingInfo(),r=[f,e].filter(function(t){return!n.Common.IsEmpty(t)}),u=this.listview.getLocationString(),o={columnBindingInfos:r===null||r===void 0?void 0:r.map(function(n){return n.GUID}),rowInfo:this.listview.getRowInfo(),queryData:n.ForguncyData.pageInfo.commandQuerys[this.listview.getDataTableName()],sortCommandID:null,sortInfo:n.ForguncyData.pageInfo.getSortInfoWithBinding(u),columnFilterQueries:n.ColumnFilterHelper.getFieldColumnFilterQueries(u,r),pageName:n.PageManager.getDesignerPageName(this.listview.runTimePageName,!1),runtimeQueryConditionData:n.ForguncyData.pageInfo.runtimeQueryConditionDataCache[u]};n.HomeController.GetRowsDataForColumnFilter(o,function(n){if(!n){i();return}if(n.errorMessage){alert(n.errorMessage);i();return}n.rows&&t(n.rows,n.displayRows)},this.listview.getCalcSheetName())},u.prototype.queryRowsForNoFieldColumn=function(t,i){var r=n.FormulaColumnSortFilterHelper.getFilteredValuesOfColumn(this.listview,this.visibleColumn);r.length>0?t(r,null):i()},u.prototype.generateNormalNodes=function(t,i,r){return t.map(function(t){var u,f;if(n.Common.IsEmpty(t.Value))u=n.RS.ColumnFilter_TreeView_Blanks;else{var o=i.columnInfo.TemplateCell.Element,s=r.runTimePageName,e=n.ListviewEditorHelper.getCell(o,s,r.designerPageName,r.getListviewName()).cellType,h=e?e.getFormatString():"";u=n.FormatHelper.formatValue(t.DisplayValue,h)}return f=new n.UI.TreeViewNode(u),f.userData=t,f})},u.prototype.generateDateNodes=function(t){var i=this,r=[],u=t.some(function(t){var r=t.Value,i;return!n.Common.IsEmpty(r)&&(i=n.ConvertOADateToDate(r),i&&!isNaN(i.getTime())&&(i.getHours()!==0||i.getMinutes()!==0||i.getSeconds()!==0))?!0:!1});return t.forEach(function(t){var o=t.Value,e,f;if(n.Common.IsEmpty(o))f=new n.UI.TreeViewNode(n.RS.ColumnFilter_TreeView_Blanks).identify("fgc-columnfilter-blank-datetime"),f.userData=t,r.push(f);else if(e=n.ConvertOADateToDate(o),e)if(isNaN(e.getTime()))f=new n.UI.TreeViewNode(o),f.userData=t,r.push(f);else{var s=e.getFullYear(),h=e.getMonth(),c=e.getDate(),f=void 0,y=n.RS.MonthNames.split(",");if(f=i.createChild(null,r,s,s+n.RS.ColumnFilter_YearName),f=i.createChild(f,f.children,h,y[h]),f=i.createChild(f,f.children,c,c+n.RS.ColumnFilter_DayName),u){var l=e.getHours(),a=e.getMinutes(),v=e.getSeconds();f=i.createChild(f,f.children,l,l);f=i.createChild(f,f.children,a,":"+a);f=i.createChild(f,f.children,v,":"+v)}f.userData=t}}),r},u.prototype.createChild=function(t,i,r,u){return i[r]||(i[r]=new n.UI.TreeViewNode(u.toString()),i[r].parent=t),i[r]},u}(n.UI.Dialog),t,i;n.BasicFilterDialog=u;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"content",{get:function(){return new i(this.target)},enumerable:!1,configurable:!0}),t}(n.UI.DialogUI);i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createChildren=function(){this.addChild(this.target.treeView.createUI());this.addChild(this.target.textBlock.createUI());this.addChild(this.target.progress.createUI())},t}(n.UI.DialogContentUI)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t,i,s=(t={},Object.defineProperty(t,1,{get:function(){return n.RS.CompareType_Equals},enumerable:!1,configurable:!0}),Object.defineProperty(t,2,{get:function(){return n.RS.CompareType_DoesNotEqual},enumerable:!1,configurable:!0}),Object.defineProperty(t,3,{get:function(){return n.RS.CompareType_BeginsWith},enumerable:!1,configurable:!0}),Object.defineProperty(t,4,{get:function(){return n.RS.CompareType_DoesNotBeginWith},enumerable:!1,configurable:!0}),Object.defineProperty(t,5,{get:function(){return n.RS.CompareType_EndsWith},enumerable:!1,configurable:!0}),Object.defineProperty(t,6,{get:function(){return n.RS.CompareType_DoesNotEndWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t,7,{get:function(){return n.RS.CompareType_Contains},enumerable:!1,configurable:!0}),Object.defineProperty(t,8,{get:function(){return n.RS.CompareType_DoesNotContain},enumerable:!1,configurable:!0}),Object.defineProperty(t,9,{get:function(){return n.RS.CompareType_IsGreaterThan},enumerable:!1,configurable:!0}),Object.defineProperty(t,10,{get:function(){return n.RS.CompareType_IsGreaterThanOrEqualTo},enumerable:!1,configurable:!0}),Object.defineProperty(t,11,{get:function(){return n.RS.CompareType_IsLessThan},enumerable:!1,configurable:!0}),Object.defineProperty(t,12,{get:function(){return n.RS.CompareType_IsLessThanOrEqualTo},enumerable:!1,configurable:!0}),Object.defineProperty(t,13,{get:function(){return n.RS.CompareType_IsBetween},enumerable:!1,configurable:!0}),Object.defineProperty(t,14,{get:function(){return n.RS.CompareType_IsNotBetween},enumerable:!1,configurable:!0}),Object.defineProperty(t,15,{get:function(){return n.RS.CompareType_In},enumerable:!1,configurable:!0}),Object.defineProperty(t,16,{get:function(){return n.RS.CompareType_NotIn},enumerable:!1,configurable:!0}),Object.defineProperty(t,17,{get:function(){return n.RS.CompareType_ListContains},enumerable:!1,configurable:!0}),Object.defineProperty(t,18,{get:function(){return n.RS.CompareType_ListIsContainedBy},enumerable:!1,configurable:!0}),Object.defineProperty(t,19,{get:function(){return n.RS.CompareType_ListIntersects},enumerable:!1,configurable:!0}),Object.defineProperty(t,20,{get:function(){return n.RS.CompareType_ListNoIntersection},enumerable:!1,configurable:!0}),Object.defineProperty(t,21,{get:function(){return n.RS.CompareType_ListEquals},enumerable:!1,configurable:!0}),t),h=(i={},Object.defineProperty(i,1,{get:function(){return n.RS.CompareType_Equals},enumerable:!1,configurable:!0}),Object.defineProperty(i,2,{get:function(){return n.RS.CompareType_DoesNotEqual},enumerable:!1,configurable:!0}),Object.defineProperty(i,3,{get:function(){return n.RS.CompareType_BeginsWith},enumerable:!1,configurable:!0}),Object.defineProperty(i,4,{get:function(){return n.RS.CompareType_DoesNotBeginWith},enumerable:!1,configurable:!0}),Object.defineProperty(i,5,{get:function(){return n.RS.CompareType_EndsWith},enumerable:!1,configurable:!0}),Object.defineProperty(i,6,{get:function(){return n.RS.CompareType_DoesNotEndWidth},enumerable:!1,configurable:!0}),Object.defineProperty(i,7,{get:function(){return n.RS.CompareType_Contains},enumerable:!1,configurable:!0}),Object.defineProperty(i,8,{get:function(){return n.RS.CompareType_DoesNotContain},enumerable:!1,configurable:!0}),Object.defineProperty(i,9,{get:function(){return n.RS.CompareType_IsGreaterThan},enumerable:!1,configurable:!0}),Object.defineProperty(i,10,{get:function(){return n.RS.CompareType_IsGreaterThanOrEqualTo},enumerable:!1,configurable:!0}),Object.defineProperty(i,11,{get:function(){return n.RS.CompareType_IsLessThan},enumerable:!1,configurable:!0}),Object.defineProperty(i,12,{get:function(){return n.RS.CompareType_IsLessThanOrEqualTo},enumerable:!1,configurable:!0}),Object.defineProperty(i,13,{get:function(){return n.RS.CompareType_IsBetween},enumerable:!1,configurable:!0}),Object.defineProperty(i,14,{get:function(){return n.RS.CompareType_IsNotBetween},enumerable:!1,configurable:!0}),Object.defineProperty(i,15,{get:function(){return n.RS.CompareType_In},enumerable:!1,configurable:!0}),Object.defineProperty(i,16,{get:function(){return n.RS.CompareType_NotIn},enumerable:!1,configurable:!0}),Object.defineProperty(i,17,{get:function(){return n.RS.CompareType_ListContains},enumerable:!1,configurable:!0}),Object.defineProperty(i,18,{get:function(){return n.RS.CompareType_ListIsContainedBy},enumerable:!1,configurable:!0}),Object.defineProperty(i,19,{get:function(){return n.RS.CompareType_ListIntersects},enumerable:!1,configurable:!0}),Object.defineProperty(i,20,{get:function(){return n.RS.CompareType_ListNoIntersection},enumerable:!1,configurable:!0}),Object.defineProperty(i,21,{get:function(){return n.RS.CompareType_ListEquals},enumerable:!1,configurable:!0}),i),c=function(){function t(n){this._isFilterCurrentPage=n}return t.prototype.createContextMenu=function(t,i){var o=this,r=t.getColumnFilterHelper(i),f=null,u=[],e;return this.contextMenuCompareTypes.forEach(function(e){e.forEach(function(e){var h=new n.UI.ContextMenuButton(s[e]+"...").on("Clicked",function(){f.dispose();o.openCustomFilterDialog(t,i,e)}),c=r.columnFilterQuery;h.isChecked=!n.Common.IsEmpty(c.Conditions)&&e===c.filterComapreType;u.push(new n.UI.ContextMenuItem(h))});u.push(new n.UI.ContextMenuItem(new n.UI.ContextMenuSpliter))}),e=new n.UI.ContextMenuButton(n.RS.ColumnFilter_ContextMenu_CustomFilter+"...").on("Clicked",function(){f.dispose();var n=r.getActualCompareType(r.columnFilterQuery);o.openCustomFilterDialog(t,i,n)}),e.isChecked=this.getCustomFilterIsChecked(r.columnFilterQuery),u.push(new n.UI.ContextMenuItem(e)),f=new n.UI.ContextMenu(u)},t.prototype.openCustomFilterDialog=function(t,i,e){var c=this,s,l;e===void 0&&(e=this.supportedCompareTypes[0]);var h=t.getColumnFilterHelper(i),o=new u,a=n.ContextMenuBuilder.isFilterCurrentPage(t,i)?n.RS.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage:"";o.title=n.RS.ColumnFilter_ContextMenu_CustomFilter+a;o.targetName=n.Common.getMultiLanguageWord(i.getName())||"";e===null||e===undefined||e===0?o.selectModel=new r(this.supportedCompareTypes[0]):(o.selectModel=new r(e),s=h.columnFilterQuery,l=h.getActualCompareType(s),s.Conditions&&e===l&&(n.Common.IsEmpty(s.Conditions[0])||(o.value1=this.convertConditionToString(s.Conditions[0])),n.Common.IsEmpty(s.Conditions[1])||(o.value2=this.convertConditionToString(s.Conditions[1]))));o.prefabModels=this.supportedCompareTypes.map(function(n){return new r(n)});o.on("Confirm",function(r,u){var f,e;if(t.tryCommitValueBeforeQueryOrSort()){h.clearColumnFilterValues();try{f=c.generate(o.selectModel.type,[o.value1,o.value2])}catch(s){alert(n.RS.ColumnFilter_Alert_IncorrectValue);u.cancel=!0;return}e=o.selectModel.type===14;h.setConditionFilter(o.selectModel.type,e,f);t.resetDataAfterFilter(i)}});this.updateExampleText(o);o.on("PropertyChanged",function(n,t){t==="selectModel"&&c.updateExampleText(o)});n.ForguncyData.pageInfo.appendExtralPopup(o);n.PageBuilder.pagesContainer.append(o.createUI(f).container);o.show()},t.prototype.convertConditionToString=function(t){return t.Value===n.KeyWords.Null?"":t.Value},t.prototype.convertValueToReal=function(t){return t.trim()===""?n.KeyWords.Null:t},t.prototype.getCustomFilterIsChecked=function(t){if(!n.Common.IsEmpty(t.Conditions)){var i=this.contextMenuCompareTypes.reduce(function(n,t){return n.concat(t)});return i.indexOf(t.filterComapreType)<0}return!1},t.prototype.updateExampleText=function(t){var i=this.getExampleText(t.selectModel.type);n.Common.IsEmpty(i)?t.exampleTextBlock.visibility=!1:(t.exampleTextBlock.visibility=!0,t.exampleTextBlock.text=i)},t}(),e,r,u,f,o;n.AdvancedFilter=c;e=function(){function t(){}return t.create=function(t,i){switch(t){case 0:return new n.NumberFilter(i);case 1:return new n.TextFilter(i);case 2:return new n.DateFilter(i);case 3:return new n.TimeFilter(i);case 4:return new n.ListFilter(i);default:return null}},t}();n.AdvancedFilterFactory=e;r=function(){function n(n){this.type=n}return Object.defineProperty(n.prototype,"title",{get:function(){return h[this.type]},enumerable:!1,configurable:!0}),n}();u=function(t){function i(){var i=t.call(this)||this;i.value1="";i.value2="";i.titleTextBlock=new n.UI.TextBlock(i.whereTitle);i.targetNameTextBlock=new n.UI.TextBlock("").identify("fgc-advancedfilter-targetname");i.comboBox=(new n.UI.ComboBox).identify("fgc-advancedfilter-combobox");i.textBox1=(new n.UI.TextBox).identify("fgc-advancedfilter-leftinput");i.textBox2=(new n.UI.TextBox).identify("fgc-advancedfilter-rightinput");i.modeTextBlock=new n.UI.TextBlock(n.RS.ColumnFilter_TextBlock_And);i.exampleTextBlock=(new n.UI.TextBlock).identify("fgc-advancedfilter-example");i.outerFlex=new n.UI.FlexLayout(1).identify("fgc-advancedfilter-outerflex");i.innerFlex1=new n.UI.FlexLayout(0).identify("fgc-advancedfilter-titleflex");i.innerFlex2=new n.UI.FlexLayout(0).identify("fgc-advancedfilter-contentflex");i.id="fgc-advancedfilter-dialog";i.bindProperty(i.targetNameTextBlock,"text","targetName");i.bindProperty(i.comboBox,"value","selectModel");i.bindProperty(i.comboBox,"items","prefabModels");i.bindProperty(i.textBox1,"text","value1");i.bindProperty(i.textBox2,"text","value2");i.on("PropertyChanged",function(t,r){r==="selectModel"&&(i.selectModel.type===13||i.selectModel.type===14?(i.textBox2.show(),i.modeTextBlock.show()):(i.textBox2.hide(),i.modeTextBlock.hide()),n.DelayRefresh.setTimeout(function(){i.textBox1.focus()},50))});i.textBox1.on("Confirm",function(){i.confirm()});i.textBox2.on("Confirm",function(){i.confirm()});return i.comboBox.displayName="title",i.initializeFlexLayout(),i}return __extends(i,t),Object.defineProperty(i.prototype,"whereTitle",{get:function(){return n.RS.ColumnFilter_TextBlock_Where},enumerable:!1,configurable:!0}),i.prototype.initializeFlexLayout=function(){this.outerFlex.add(this.innerFlex1);this.outerFlex.add(this.innerFlex2);this.outerFlex.add(this.exampleTextBlock);this.innerFlex1.add(this.titleTextBlock);this.innerFlex1.add(this.targetNameTextBlock);this.innerFlex2.add(this.comboBox);this.innerFlex2.add(this.textBox1);this.innerFlex2.add(this.modeTextBlock);this.innerFlex2.add(this.textBox2)},i}(n.UI.Dialog);n.AdvancedFilterDialog=u;f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"content",{get:function(){return new o(this.target)},enumerable:!1,configurable:!0}),t}(n.UI.DialogUI);n.AdvancedFilterDialogUI=f;o=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createChildren=function(){this.addChild(this.target.outerFlex.createUI())},t}(n.UI.DialogContentUI)})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var i=function(){function i(){}return i.sortByColumn=function(n){var t=n.getListDataModel().getData(!1),i=this.sortData(n,t);this.resetListviewData(n,i)},i.resetListviewData=function(t,r){var u=t.getListDataModel(),e=u.getCurrentRowIndex(),o=u.getData(!1).map(function(n){return n.uniqueIndex}),f;u.select();t.hideDeleteButton();u.setData(r,!0);f=i.adjustRowIndex(e,o,r);t.initSelectionAfterInitData(f===-1?e:f);t.hideDeleteButton();t.trigger(n.ListViewEvents.Reloaded,{})},i.sortData=function(n,t){var f=this,i=this.getSortedFormulaColumnIndex(n),u,r;return i===-1?t:(u=n.listviewData.visibleColumns[i],r=n.listviewData.getColIndexByVisibleColIndex(i),t.map(function(n){return n}).sort(function(n,t){return f.compareValueItem(n.data[r],t.data[r],u.sortInfo)}))},i.compareValueItem=function(t,i,r){var u=n.ListDataModel.getValueFromItem(t),f=n.ListDataModel.getValueFromItem(i);return this.compareValue(u,f,r)},i.compareValue=function(n,t,i){if(n===t)return 0;var r=n>t?1:-1;return i===1?r*-1:r},i.adjustRowIndex=function(n,t,i){var u=t[n],r;if(u>=0)for(r=0;r<i.length;r++)if(i[r].uniqueIndex===u)return r;return-1},i.getSortedFormulaColumnIndex=function(t){var r=t.listviewData.visibleColumns,i,u;if(!r)return-1;for(i=0;i<r.length;i++)if(u=r[i],u.allowNoFieldSort()&&!n.Common.IsEmpty(u.sortInfo))return i;return-1},i.filterByColumn=function(n){var t=this.getFilteredAndSortData(n);this.resetListviewData(n,t)},i.getFilteredAndSortData=function(n){var t=this.getFilteredData(n);return this.sortData(n,t)},i.getFilteredData=function(i,r){var u,f,e;return(r===void 0&&(r=null),i.dataCache||(i.dataCache=i.getListDataModel().getData(!1)),u=this.getFilterCondition(i,r),!u)?i.dataCache:(f=new t(i.dataCache),e=i.dataCache.filter(function(t,i){return f.rowIndex=i,n.ConditionHelper.getConditionResult(u,null,f)}),e)},i.getFilterCondition=function(t,i){var f=this,r=t.listviewData.visibleColumns,u;return!r||r.length===0?null:(u=r.map(function(r){return n.Common.IsEmpty(i)||r!==i?f.getConditionOfColumn(r,t.getColumnFilterHelper(r).columnFilterQuery):null}).filter(function(n){return!!n}),this.combinConditions(u,0))},i.combinConditions=function(n,t){return n.length===0?null:{SubConditions:n,RelationType:t}},i.getConditionOfColumn=function(n,t){var i;return n.allowNoFieldSort()?t.Conditions?this.convertFilterConditions(n,t,(i=n.columnInfo)===null||i===void 0?void 0:i.HaveFormula):t.Values?this.createConditionByFilterValues(n,t):null:null},i.createConditionByFilterValues=function(n,t){var i=n.getColumnIndex(),r=t.IsNotInMode?1:0,u=t.IsNotInMode?0:1,f=t.Values.map(function(n){return{colIndex:i,value:n,compareType:r}});return this.combinConditions(f,u)},i.convertFilterConditions=function(n,t,i){var r=this,u=n.getColumnIndex(),f=t.IsOrMode?1:0,e=t.Conditions.map(function(n){return r.convertToFilterCondition(n,u,i)});return this.combinConditions(e,f)},i.convertToFilterCondition=function(n,t,i){return{colIndex:t,value:this.convertValue(n.Value,i),compareType:this.convertCompareType(n)}},i.convertValue=function(t,i){return i?n.FormulaHelper.adjustNumberPrecision(t):t},i.convertCompareType=function(n){switch(n.ConditionType){case 0:return this.convertGeneralCompareType(n.CompareType);case 1:return this.convertTextCompareType(n.CompareType)}},i.convertGeneralCompareType=function(n){return n},i.convertTextCompareType=function(n){switch(n){case 0:return 0;case 1:return 1;case 2:return 6;case 3:return 7;case 4:return 8;case 5:return 9;case 6:return 10;case 7:return 11;case 8:return 12;case 9:return 13}},i.getFilteredValuesOfColumn=function(t,r){var u=this.getFilteredData(t,r),f=r.getColumnIndex(),e=u.map(function(t){var i=t.data[f];return n.ListDataModel.getValueFromItem(i)});return this.unique(e).sort(function(n,t){return i.compareValue(n,t,0)}).slice(0,500)},i.unique=function(n){for(var t,r=[],u={},i=0,f=n;i<f.length;i++)t=f[i],u[t]||(u[t]=1,r.push(t));return r},i.updateDataCacheOnValueChanged=function(t,i){t.dataCache&&(i.newRowCount>i.oldRowCount?this.updateDataCacheAfterAddRows(t):n.Common.IsEmpty(i.deletedRowUniqueIndex)||this.updateDataCacheAfterDeleteRow(t,i.deletedRowUniqueIndex))},i.updateDataCacheAfterAddRows=function(n){var i=n.getListDataModel().getData(!1),t=[];i.forEach(function(i){var r=!n.dataCache.some(function(n){return n.uniqueIndex===i.uniqueIndex});r&&t.push(i)});t.forEach(function(t){return n.dataCache.push(t)})},i.updateDataCacheAfterDeleteRow=function(n,t){for(var r=-1,i=0;i<n.dataCache.length;i++)if(n.dataCache[i].uniqueIndex===t){r=i;break}r>=0&&n.dataCache.splice(r,1)},i}(),t;n.FormulaColumnSortFilterHelper=i;t=function(){function t(n){this._data=n;this.rowIndex=0}return t.prototype.calc=function(t){var i=t,r=this._data[this.rowIndex].data[i.colIndex];return n.ListDataModel.getValueFromItem(r)},t.prototype.needUnparseValue2=function(){return!1},t.prototype.equals=function(n,t){return n+""==t+""},t}()})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var i=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n.contextMenuCompareTypes=[[1,2],[3,5,],[7,8,]],n.supportedCompareTypes=[1,2,3,4,5,6,7,8,15,16],n}return __extends(i,t),Object.defineProperty(i.prototype,"title",{get:function(){var t=this._isFilterCurrentPage?n.RS.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage:"";return n.RS.ColumnFilter_ContextMenu_TextFilter+t},enumerable:!1,configurable:!0}),i.prototype.getExampleText=function(t){return t===15||t===16?n.RS.ColumnFilter_TextBlock_TextExample_In:""},i.prototype.generate=function(n,t){var i=this.convertValueToReal(t[0]);switch(n){case 1:return[{ConditionType:1,CompareType:0,Value:i}];case 2:return[{ConditionType:1,CompareType:1,Value:i}];case 3:return[{ConditionType:1,CompareType:2,Value:i}];case 4:return[{ConditionType:1,CompareType:3,Value:i}];case 5:return[{ConditionType:1,CompareType:4,Value:i}];case 6:return[{ConditionType:1,CompareType:5,Value:i}];case 7:return[{ConditionType:1,CompareType:6,Value:i}];case 8:return[{ConditionType:1,CompareType:7,Value:i}];case 15:return[{ConditionType:1,CompareType:8,Value:i}];case 16:return[{ConditionType:1,CompareType:9,Value:i}];default:return[]}},i}(n.AdvancedFilter),t;n.TextFilter=i;t=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n.contextMenuCompareTypes=[[17,18],[19,20,],[21,]],n.supportedCompareTypes=[17,18,19,20,21,],n}return __extends(i,t),Object.defineProperty(i.prototype,"title",{get:function(){var t=this._isFilterCurrentPage?n.RS.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage:"";return"集合筛选"+t},enumerable:!1,configurable:!0}),i.prototype.getExampleText=function(){return n.RS.ColumnFilter_TextBlock_TextExample_In},i.prototype.generate=function(n,t){var i=this.convertValueToReal(t[0]);switch(n){case 17:return[{ConditionType:2,CompareType:0,Value:i}];case 18:return[{ConditionType:2,CompareType:1,Value:i}];case 19:return[{ConditionType:2,CompareType:2,Value:i}];case 20:return[{ConditionType:2,CompareType:3,Value:i}];case 21:return[{ConditionType:2,CompareType:4,Value:i}];default:return[]}},i}(n.AdvancedFilter);n.ListFilter=t})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n.contextMenuCompareTypes=[[1,2],[9,11,13]],n.supportedCompareTypes=[1,2,9,10,11,12,13,14,],n}return __extends(i,t),Object.defineProperty(i.prototype,"title",{get:function(){var t=this._isFilterCurrentPage?n.RS.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage:"";return n.RS.ColumnFilter_ContextMenu_NumberFilter+t},enumerable:!1,configurable:!0}),i.prototype.getExampleText=function(){return""},i.prototype.generate=function(n,t){var i=this.convertValueToReal(t[0]),r;switch(n){case 1:return[{ConditionType:0,CompareType:0,Value:i}];case 2:return[{ConditionType:0,CompareType:1,Value:i}];case 9:return[{ConditionType:0,CompareType:2,Value:i}];case 10:return[{ConditionType:0,CompareType:3,Value:i}];case 11:return[{ConditionType:0,CompareType:4,Value:i}];case 12:return[{ConditionType:0,CompareType:5,Value:i}];case 13:return r=this.convertValueToReal(t[1]),[{ConditionType:0,CompareType:3,Value:i},{ConditionType:0,CompareType:5,Value:r}];case 14:return r=this.convertValueToReal(t[1]),[{ConditionType:0,CompareType:4,Value:i},{ConditionType:0,CompareType:2,Value:r}];default:return[]}},i.prototype.convertValueToReal=function(t){if(typeof t=="number")return t;if(typeof t=="string"&&t.trim()==="")return n.KeyWords.Null;var i=Number(t);if(isNaN(i))throw new Error;else return i},i}(n.AdvancedFilter);n.NumberFilter=t})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.getExampleText=function(t){return t===13||t===14?n.RS.ColumnFilter_TextBlock_TimeExample_Between:n.RS.ColumnFilter_TextBlock_TimeExample},i.prototype.convertValueToReal=function(t){var i,r;if(typeof t=="number")return t;if(t.trim()==="")return n.KeyWords.Null;if(i=n.FormatHelper.getValueFromText(t),i instanceof Date)return n.ConvertDateToOADate(i);if(r=Number(i),isNaN(r))throw new Error;else return r},i.prototype.convertConditionToString=function(t){return t.Value===n.KeyWords.Null?"":n.FormatHelper.formatValue(t.Value,"hh:mm:ss")},i}(n.NumberFilter);n.TimeFilter=t})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var t,i,u=(t={},Object.defineProperty(t,100,{get:function(){return n.RS.DateCompareType_Tomorrow},enumerable:!1,configurable:!0}),Object.defineProperty(t,101,{get:function(){return n.RS.DateCompareType_Today},enumerable:!1,configurable:!0}),Object.defineProperty(t,102,{get:function(){return n.RS.DateCompareType_Yesterday},enumerable:!1,configurable:!0}),Object.defineProperty(t,103,{get:function(){return n.RS.DateCompareType_NextWeek},enumerable:!1,configurable:!0}),Object.defineProperty(t,104,{get:function(){return n.RS.DateCompareType_ThisWeek},enumerable:!1,configurable:!0}),Object.defineProperty(t,105,{get:function(){return n.RS.DateCompareType_LastWeek},enumerable:!1,configurable:!0}),Object.defineProperty(t,106,{get:function(){return n.RS.DateCompareType_NextMonth},enumerable:!1,configurable:!0}),Object.defineProperty(t,107,{get:function(){return n.RS.DateCompareType_ThisMonth},enumerable:!1,configurable:!0}),Object.defineProperty(t,108,{get:function(){return n.RS.DateCompareType_LastMonth},enumerable:!1,configurable:!0}),Object.defineProperty(t,109,{get:function(){return n.RS.DateCompareType_NextYear},enumerable:!1,configurable:!0}),Object.defineProperty(t,110,{get:function(){return n.RS.DateCompareType_ThisYear},enumerable:!1,configurable:!0}),Object.defineProperty(t,111,{get:function(){return n.RS.DateCompareType_LastYear},enumerable:!1,configurable:!0}),t),r=(i={},Object.defineProperty(i,11,{get:function(){return n.RS.CompareType_IsLessThan_Date},enumerable:!1,configurable:!0}),Object.defineProperty(i,9,{get:function(){return n.RS.CompareType_IsGreaterThan_Date},enumerable:!1,configurable:!0}),i),f=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n.contextMenuCompareTypes=[[1,],[11,9,13]],n.contextMenuDateCompareTypes=[[100,101,102,],[103,104,105,],[106,107,108,],[109,110,111]],n}return __extends(i,t),Object.defineProperty(i.prototype,"title",{get:function(){var t=this._isFilterCurrentPage?n.RS.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage:"";return n.RS.ColumnFilter_ContextMenu_DateFilter+t},enumerable:!1,configurable:!0}),i.prototype.getExampleText=function(t){return t===13||t===14?n.RS.ColumnFilter_TextBlock_DateExample_Between:n.RS.ColumnFilter_TextBlock_DateExample},i.prototype.createContextMenu=function(i,f){var s=this,e=t.prototype.createContextMenu.call(this,i,f),o=[];return o.push(new n.UI.ContextMenuItem(new n.UI.ContextMenuSpliter)),this.contextMenuDateCompareTypes.forEach(function(t){t.forEach(function(t){var r=new n.UI.ContextMenuButton(u[t]).on("Clicked",function(){var n,r;e.dispose();n=i.getColumnFilterHelper(f);n.clearColumnFilterValues();r=s.generateByDateCompareType(t);n.setConditionFilter(t,!1,r);i.resetDataAfterFilter(f)}),h=i.getColumnFilterHelper(f).columnFilterQuery;r.isChecked=!n.Common.IsEmpty(h.Conditions)&&t===h.filterComapreType;o.push(new n.UI.ContextMenuItem(r))});o.push(new n.UI.ContextMenuItem(new n.UI.ContextMenuSpliter))}),e.items[2].inner.text=r[11]+"...",e.items[3].inner.text=r[9]+"...",e.items=__spreadArray(__spreadArray(__spreadArray([],e.items.slice(0,e.items.length-2),!0),o,!0),e.items.slice(-1),!0),e},i.prototype.convertValueToReal=function(t){var i,r;if(typeof t=="number")return t;if(t.trim()==="")return n.KeyWords.Null;if(i=n.FormatHelper.getValueFromText(t),i instanceof Date)return n.ConvertDateToOADate(i);if(r=Number(i),isNaN(r))throw new Error;else return r},i.prototype.convertConditionToString=function(t){return t.Value===n.KeyWords.Null?"":n.FormatHelper.getTextFromValue(n.ConvertOADateToDate(t.Value))},i.prototype.getCustomFilterIsChecked=function(t){if(!n.Common.IsEmpty(t.Conditions)){var i=this.contextMenuCompareTypes.reduce(function(n,t){return n.concat(t)}),r=this.contextMenuDateCompareTypes.reduce(function(n,t){return n.concat(t)});return i.indexOf(t.filterComapreType)<0&&r.indexOf(t.filterComapreType)<0}return!1},i.prototype.generateByDateCompareType=function(t){var i=new Date,r,u,f,e;switch(t){case 100:r=new Date(i.getFullYear(),i.getMonth(),i.getDate()+1);u=new Date(i.getFullYear(),i.getMonth(),i.getDate()+2);break;case 101:r=new Date(i.getFullYear(),i.getMonth(),i.getDate());u=new Date(i.getFullYear(),i.getMonth(),i.getDate()+1);break;case 102:r=new Date(i.getFullYear(),i.getMonth(),i.getDate()-1);u=new Date(i.getFullYear(),i.getMonth(),i.getDate());break;case 103:r=new Date(i.getFullYear(),i.getMonth(),i.getDate()+(7-i.getDay()));u=new Date(i.getFullYear(),i.getMonth(),i.getDate()+(7-i.getDay())+7);break;case 104:r=new Date(i.getFullYear(),i.getMonth(),i.getDate()-i.getDay());u=new Date(i.getFullYear(),i.getMonth(),i.getDate()+(7-i.getDay()));break;case 105:r=new Date(i.getFullYear(),i.getMonth(),i.getDate()-i.getDay()-7);u=new Date(i.getFullYear(),i.getMonth(),i.getDate()-i.getDay());break;case 106:r=new Date(i.getFullYear(),i.getMonth()+1);u=new Date(i.getFullYear(),i.getMonth()+2);break;case 107:r=new Date(i.getFullYear(),i.getMonth());u=new Date(i.getFullYear(),i.getMonth()+1);break;case 108:r=new Date(i.getFullYear(),i.getMonth()-1);u=new Date(i.getFullYear(),i.getMonth());break;case 109:r=new Date(i.getFullYear()+1,0);u=new Date(i.getFullYear()+2,0);break;case 110:r=new Date(i.getFullYear(),0);u=new Date(i.getFullYear()+1,0);break;case 111:r=new Date(i.getFullYear()-1,0);u=new Date(i.getFullYear(),0);break;default:return null}return f=n.ConvertDateToOADate(r),e=n.ConvertDateToOADate(u),[{ConditionType:0,CompareType:3,Value:f},{ConditionType:0,CompareType:4,Value:e}]},i}(n.NumberFilter);n.DateFilter=f})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(i){var r=t.call(this)||this,u;return r.id="fgc-rowheader-contextmenu",r.insertButton=(new n.UI.ContextMenuButton).identify("fgc-rowheader-insert"),r.deleteButton=(new n.UI.ContextMenuButton).identify("fgc-rowheader-delete"),r.duplicateButton=(new n.UI.ContextMenuButton).identify("fgc-rowheader-duplicate"),u=i.listviewData.getRowHeaderContextMenuData(),u.ContextMenuItems.forEach(function(t){if(t&&t.Visible)if(t.OperationType===n.ContextMenuOperationType.Insert){r.insertButton.text=n.RS.Listview_RowHeaderContextMenu_Insert;r.insertButton.enabled=i.allowInsertRow();r.insertButton.on("Clicked",function(){i.insertRowBySelection(!0);r.dispose()});r.items.push(new n.UI.ContextMenuItem(r.insertButton))}else if(t.OperationType===n.ContextMenuOperationType.Delete){i.listviewData.metadata.forceDisableDeleteMenuItem&&(r.deleteButton.enabled=!1);r.deleteButton.text=n.RS.Listview_RowHeaderContextMenu_Delete;r.deleteButton.on("Clicked",function(){i.deleteOnUIClick(!0);r.dispose()});r.items.push(new n.UI.ContextMenuItem(r.deleteButton))}else if(t.OperationType===n.ContextMenuOperationType.Duplicate){r.duplicateButton.text=n.RS.Listview_RowHeaderContextMenu_Duplicate;r.duplicateButton.enabled=i.allowDuplicateRow();r.duplicateButton.on("Clicked",function(){i.duplicateRowBySelection(!0);r.dispose()});r.items.push(new n.UI.ContextMenuItem(r.duplicateButton))}}),r}return __extends(i,t),i}(n.UI.ContextMenu),i=function(i){function r(n,t){var r=i.call(this)||this;r.listview=n;r.canvas=t;$(t).on("contextmenu",function(n){n.preventDefault()});return r}return __extends(r,i),r.prototype.onOpenMenu=function(i,r,u){var f,e;if(u.worksheetHitInfo.hitTestType===GC.Spread.Sheets.SheetArea.rowHeader){if(!this.listview.tryCommitEdit())return!0;if(this.listview.allowShowTotalRow())if(this.listview.listviewData.getIsTotalRowAtFirstRow()){if(u.worksheetHitInfo.row===0)return!0}else if(u.worksheetHitInfo.row===this.listview.getSheet().getRowCount()-1)return!0;f=new t(this.listview);n.ForguncyData.pageInfo.appendExtralPopup(f);n.PageBuilder.pagesContainer.append(f.createUI().container);e=$(this.canvas).offset();f.location=new n.Numerics.Vector2(e.left+u.x||0,e.top+u.y||0);f.show()}return!0},r}(GC.Spread.Sheets.ContextMenu.ContextMenu);n.SpreadContextMenu=i})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t;(function(t){var i=function(){function t(){}return t.autoMerge=function(i,r,u,f,e,o){var c,v,l,a,s,y,h;if(u===void 0&&(u=-1),f===void 0&&(f=-1),e===void 0&&(e=0),o===void 0&&(o=-1),!n.Common.IsEmpty(r)&&!(r.length<=0))for(c=t.getOriginalSpanInfos(i,r,u,f,e,o),t.clearOldSpans(i,c,u,f),v=i.getColumnCount(),l=[],s=0;s<v;s++)if(a=n.Common.IsEmpty(c[s])?l:[c[s]],l=[],r.indexOf(s)!==-1)for(y=a.length,h=0;h<y;h++)t.setSpan(i,a[h].row,s,a[h].span,l)},t.getOriginalSpanInfos=function(n,i,r,u,f,e){var l,c,o,s,h;for(f===void 0&&(f=0),e===void 0&&(e=-1),l=n.getColumnCount(),c=[],o=0;o<l;o++)t.isMergeAreaFirstColumn(i,o)&&(s=void 0,h=void 0,s=r===-1?f:t.getMergeAreaStartRow(n,r,o,f),h=u===-1?n.getRowCount():u+(r-s),e!==-1&&(h=Math.min(e,n.getRowCount())),c[o]={row:s,span:h});return c},t.isMergeAreaFirstColumn=function(n,t){return n.indexOf(t)!==-1&&n.indexOf(t-1)===-1},t.getMergeAreaStartRow=function(n,i,r,u){var e,f;for(u===void 0&&(u=0),e=n.getValue(i,r),f=i-1;f>=u;f--)if(!t.shouldAutoMerge(e,n.getValue(f,r)))return f+1;return u},t.clearOldSpans=function(n,i,r,u){var e=t.getOldSpans(n,i,r,u),f;if(e)for(f=0;f<e.length;f++)n.removeSpan(e[f].row,e[f].col)},t.getOldSpans=function(n,i,r,u){var f,o,e;if(r===-1||u===-1)return n.getSpans(new GC.Spread.Sheets.Range(-1,-1,-1,-1));for(f=[],o=t.getCrossArea(n,i,r,u),e=0;e<o.length;e++)f=f.concat(n.getSpans(o[e]));return f},t.getCrossArea=function(t,i,r){for(var f,e,c,o,s=[],h=t.getColumnCount(),u=0;u<h;u++)if(!n.Common.IsEmpty(i[u])&&(f=i[u].row,e=r-f,!(e<=0))){for(c=u,o=1,u++;u<h;u++)if(n.Common.IsEmpty(i[u]))o++;else{u--;break}s.push(new GC.Spread.Sheets.Range(f,c,e,o))}return s},t.setSpan=function(n,i,r,u,f){for(var s,c,e,h,o=i;o<i+u;)for(s=o,c=n.getValue(s,r),e=o+1;;e++)if(e===i+u||!t.shouldAutoMerge(c,n.getValue(e,r))){h=e-s;h>1&&(n.addSpan(s,r,h,1),f.push({row:s,span:h}));o=e;break}},t.shouldAutoMerge=function(t,i){return n.Common.IsEmpty(t)&&n.Common.IsEmpty(i)?!1:(t instanceof Date&&i instanceof Date&&(t=n.Convertor.fromDateToOADate(t),i=n.Convertor.fromDateToOADate(i)),t===i)},t}();t.AutoMergeHelper=i})(t=n.ListViewHelper||(n.ListViewHelper={}))})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t;(function(n){var t=function(){function n(n){var t;this._scrollSpeedIntervals=(t={},t[0]=150,t[1]=100,t[2]=50,t);this._rearchBottomCount=0;this.listview=n}return Object.defineProperty(n.prototype,"sheet",{get:function(){return this.listview.getSheet()},enumerable:!1,configurable:!0}),n.prototype.apply=function(){var n=this,i,t,r;this.listview.listviewData.getIsAutoScroll()&&(i=this.listview.listviewData.getAutoScrollSpeed(),t=this._scrollSpeedIntervals[i],t>0&&(r=setInterval(function(){n.listview.hasDestroyed()?clearInterval(r):n.listview.isInCurrentPage()&&!n.listview.isMouseInListView()&&n._scrollListView()},t),this.listview.forceHideVerticalScrollBar=!0))},n.prototype._scrollListView=function(){var r,n,t,i;if(this._rearchBottomCount<0){this._rearchBottomCount++;return}if(this.listview.getSpread().options.scrollByPixel=!0,r=this.listview.getListDataCount(),r>0)if(n=this.sheet.getViewportBottomRow(1),n>=this.listview.lastDataRowIndexInView-1)try{t=this.sheet.getCellRect(n,this.sheet.getViewportLeftColumn(1));this.sheet.scroll(1,0);i=this.sheet.getCellRect(n,this.sheet.getViewportLeftColumn(1));t.y===i.y&&t.height===i.height&&(this._rearchBottomCount<10?this._rearchBottomCount++:(this._rearchBottomCount=-5,this.sheet.showRow(this.listview.firstDataRowIndexInView,GC.Spread.Sheets.VerticalPosition.top),this.sheet.scroll(-1e5,0)))}catch(u){}else this.sheet.scroll(1,0),window.devicePixelRatio%1!=0&&this.sheet.repaint()},n}();n.AutoScrollHelper=t})(t=n.ListViewHelper||(n.ListViewHelper={}))})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t;(function(n){var t=function(){function n(){}return n.isSelectAllRows=function(n){var i=n.getSelections(),e=[],t,r,u;if(i.length!==0&&n.getRowCount()!==0){for(t=0;t<i.length;t++){var f=i[t].row,o=i[t].rowCount,s=i[t].col,h=i[t].colCount;if(s===-1||h===-1){if(f===-1||o===-1)return!0;for(r=f;r<f+o;r++)e[r]=!0}}for(u=0;u<n.getRowCount();u++)if(!e[u])return!1;return!0}return!1},n.isRowSelected=function(n,t){var r=n.getSelections(),i;if(r.length!==0&&n.getRowCount()!==0)for(i=0;i<r.length;i++){var u=r[i].row,f=r[i].rowCount,e=r[i].col,o=r[i].colCount;if((e===-1||o===-1)&&(u===-1||f===-1||t>=u&&t<u+f))return!0}return!1},n.existingRowSelected=function(n){var i=n.getSelections(),t,r,u;if(i.length!==0&&n.getRowCount()!==0)for(t=0;t<i.length;t++)if(r=i[t].col,u=i[t].colCount,r===-1||u===-1)return!0;return!1},n.getOldSelection=function(n){for(var h,c,e,u,o,f,i=n.getSelections(),r=[],s=n.getRowCount(),t=0;t<i.length;t++)if(h=i[t].col,c=i[t].colCount,h===-1||c===-1){if(i[t].row===-1){for(e=0;e<s;e++)jQuery.inArray(e,r)===-1&&r.push(e);break}if(u=i[t].row,o=i[t].row+i[t].rowCount-1,u===o)jQuery.inArray(u,r)===-1&&u<s&&r.push(u);else if(u<o)for(f=u;f<=o;f++)jQuery.inArray(f,r)===-1&&f<s&&r.push(f)}return r},n.mergeSelection=function(n,t,i){var r={},u,f,e,o;if(i&&n.indexOf(t)===-1?n.push(t):i||n.indexOf(t)===-1||n.splice(n.indexOf(t),1),n.length===0)return r;if(n.length===1)return r[n[0]]=1,r;for(n.sort(function(n,t){return n-t}),u=n[0],f=n[0],e=0;e<n.length;e++)e!==0&&(o=n[e],o===f+1?(++f,e===n.length-1&&(r[u]=f-u+1)):o>f+1&&(r[u]=f-u+1,u=o,f=o,e===n.length-1&&(r[u]=1)));return r},n.clearSelectedRow=function(t,i){var r=t.getSheet(),e,f,o,u;if(n.isRowSelected(r,i)){if(e=n.getOldSelection(r),r.suspendPaint(),r.clearSelection(),e.length===1)r.setActiveCell(i,r.getActiveColumnIndex()),t.clearSelectionIfDisableAutoSelectRow();else{f=n.mergeSelection(e,i,!1);o=n.existingRowSelected(r);for(u in f)o?r.addSelection(Number(u),-1,f[u],-1):(r.setSelection(Number(u),-1,f[u],-1),o=!0)}r.resumePaint()}},n.addRowSelection=function(t,i){var r=t.getSheet(),e=n.getOldSelection(r),u,f;r.suspendPaint();r.clearSelection();u=[];r.selectionPolicy()===GC.Spread.Sheets.SelectionPolicy.single?u[i]=1:u=n.mergeSelection(e,i,!0);for(f in u)n.existingRowSelected(r)?r.addSelection(Number(f),-1,u[f],-1):r.setSelection(Number(f),-1,u[f],-1);r.resumePaint()},n.addSelectedRow=function(t,i){var r=t.getSheet();n.isRowSelected(r,i)||(r.suspendPaint(),n.existingRowSelected(r)?n.addRowSelection(t,i):r.setSelection(i,-1,1,-1),r.resumePaint())},n.setSelectedRows=function(t,i){var r=t.getSheet();r.suspendPaint();i&&i.length!==0?i.forEach(function(n,t){t===0?(r.setActiveCell(i[0],0),r.setSelection(n,-1,1,-1)):r.addSelection(n,-1,1,-1)}):n.clearAllSelectedRows(t);r.resumePaint()},n.selectAllRows=function(n){var t=n.getSheet();t.selectionPolicy()!==GC.Spread.Sheets.SelectionPolicy.single&&(t.clearSelection(),t.addSelection(-1,-1,t.getRowCount(GC.Spread.Sheets.SheetArea.viewport),t.getColumnCount(GC.Spread.Sheets.SheetArea.viewport)))},n.clearAllSelectedRows=function(n){var t=n.getSheet();t.clearSelection();t.setActiveCell(0,0);n.clearSelectionIfDisableAutoSelectRow()},n}();n.SelectionHelper=t})(t=n.ListViewHelper||(n.ListViewHelper={}))})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t;(function(t){var i=function(){function t(){}return t.generateStyleObject=function(i){var r=new GC.Spread.Sheets.Style;return i?(r.backColor=n.ColorHelper.Convert(i.Background),r.foreColor=n.ColorHelper.Convert(i.Foreground),r.hAlign=i.HorizontalAlignment,r.vAlign=i.VerticalAlignment,r.font=t.generateFontText(i),r.textDecoration=t.generateTextDecorationType(i),r.textIndent=t.generateTextIndent(i.TextIndent),r.wordWrap=i.WordWrap,r.shrinkToFit=i.ShrinkToFit,r.formatter=i.Formatter,r.borderBottom=t.generateLineBorderObject(i.BorderBottom),r.borderRight=t.generateLineBorderObject(i.BorderRight),r.borderLeft=t.generateLineBorderObject(i.BorderLeft),r.borderTop=t.generateLineBorderObject(i.BorderTop),r):r},t.generateFontText=function(t){var i=[];return t.FontStyle!==undefined&&i.push(n.DomUtilities.getFontStyleText(t.FontStyle)),t.FontWeight!==undefined&&i.push(n.DomUtilities.getFontWeightText(t.FontWeight)),t.FontSize>0&&i.push(t.FontSize+"px"),t.FontFamily?i.push('"'+t.FontFamily+'"'):i.push('"'+n.LocaleFonts.default+'"'),i.length>0?i.join(" "):null},t.generateTextIndent=function(n){return n>0?n/this.textIndentToPixel:this.defaultTextIndent},t.generateTextDecorationType=function(n){var t=GC.Spread.Sheets.TextDecorationType.none;return n.Strikethrough&&(t|=GC.Spread.Sheets.TextDecorationType.lineThrough),n.Underline&&(t|=GC.Spread.Sheets.TextDecorationType.underline),t},t.generateLineBorderObject=function(t){return n.Common.IsEmpty(t)?undefined:new GC.Spread.Sheets.LineBorder(n.ColorHelper.Convert(t.Color),t.Style)},t.needShowScrollbar=function(n,i,r){var e,o,u=!t.canDisplayAllColumnsInViewport(n,i),f=!t.canDisplayAllRowsInViewport(n,r),s=((o=(e=n.getParent())===null||e===void 0?void 0:e.options)===null||o===void 0?void 0:o.scrollbarAppearance)===GC.Spread.Sheets.ScrollbarAppearance.mobile,h,c;return u&&!f?(h=s?0:t.hScrollbarHeight,f=!t.canDisplayAllRowsInViewport(n,r-h)):f&&!u&&(c=s?0:t.vScrollbarWidth,u=!t.canDisplayAllColumnsInViewport(n,i-c)),{showHScrollBar:u,showVScrollbar:f}},t.canDisplayAllRowsInViewport=function(n,t){for(var r=n.getRowCount(),i=0;i<r;i++)if(t-=n.getRowHeight(i),t<0)return!1;return!0},t.canDisplayAllColumnsInViewport=function(n,t){for(var r=n.getColumnCount(),i=0;i<r;i++)if(t-=n.getColumnWidth(i),t<0)return!1;return!0},t.vScrollbarWidth=22,t.hScrollbarHeight=28,t.defaultTextIndent=.125,t.textIndentToPixel=8,t}();t.SpreadJSStyleHelper=i})(t=n.ListViewHelper||(n.ListViewHelper={}))})(Forguncy||(Forguncy={}))
;var __awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},Forguncy;(function(n){var t;(function(t){var i=function(){function n(n,t,i,r){this.oldRowCount=n;this.oldSelections=t;this.oldActiveRowIndex=i;this.oldActiveColIndex=r;this.changedCells=[];this.handled=!1;this.needParseValue=!1;this._changedCellsCount=0}return n.prototype.addChangedCell=function(n,t,i){if(this.changedCells[t]){for(var r=0;r<this.changedCells[t].length;r++)if(this.changedCells[t][r].row===n)return}else this.changedCells[t]=[];this._changedCellsCount++;this.changedCells[t].push({row:n,value:i})},n.prototype.getChangedCellCount=function(){return this._changedCellsCount},n}(),r=function(){function t(n){this._needWait=!1;this._completeAfterWait=!1;this._needResetColumns=!1;this.listview=n}return Object.defineProperty(t.prototype,"_sheet",{get:function(){return this.listview.getSheet()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_listData",{get:function(){return this.listview.getListDataModel()},enumerable:!1,configurable:!0}),t.prototype.getData=function(n){for(var i,t,o,r=[],u=[],f=0,e=n.changedCells;f<e.length;f++)i=e[f],t=u.indexOf(i.row),t===-1&&(t=u.length,u.push(t),r[t]=[]),o=this.listview.listviewData.visibleColumns[i.col].getColumnIndex(),r[t][o]=n.sheet.getValue(i.row,i.col);return r},t.prototype.onRangeChanged=function(t){var i=this,r,u;t.changedCells&&t.changedCells.length!==0&&(r=function(){i.listview.operationTypeWhenValueChanged=1;try{n.ForguncyData.pageInfo.formulaManager.suspend();i.listview.getSheet().suspendPaint();for(var r=0;r<t.changedCells.length;r++)i.listview.onValueChanged(t.changedCells[r].row,t.changedCells[r].col)}finally{n.ForguncyData.pageInfo.formulaManager.resume(!0);i.listview.getSheet().resumePaint()}if(i.listview.operationTypeWhenValueChanged=0,t.action===GC.Spread.Sheets.RangeChangedAction.dragFill)i.onRangeChangeOperationCompleted(!1)},this.rangeChangedInfo.needParseValue?(u=this.getData(t),this._needWait=!0,this.listview.cacheComboboxForValidateText(u,function(){if(i._needWait=!1,r(),i._completeAfterWait)i.onRangeChangeOperationCompleted(i._needResetColumns)})):r())},t.prototype.clearRangeChangedInfo=function(){this.resumeCalc();this.rangeChangedInfo=null},t.prototype.resumeCalc=function(){var t;((t=this.rangeChangedInfo)===null||t===void 0?void 0:t.suspendCalc)&&(this.rangeChangedInfo.suspendCalc=!1,n.ForguncyData.pageInfo.formulaManager.resume(!0))},t.prototype.onRangeChangeOperationBegin=function(t,r){r===void 0&&(r=!1);this.rangeChangedInfo=new i(this._listData.getRowCount(),this._sheet.getSelections(),this._sheet.getActiveRowIndex(),this._sheet.getActiveColumnIndex());this.rangeChangedInfo.needParseValue=t===GC.Spread.Sheets.RangeChangedAction.paste?!this.isPasteInternal:!1;r&&(this.rangeChangedInfo.suspendCalc=!0,n.ForguncyData.pageInfo.formulaManager.suspend())},t.prototype.onRangeChangeOperationCompleted=function(t){return __awaiter(this,void 0,void 0,function(){var i,r,u,f,e=this;return __generator(this,function(o){switch(o.label){case 0:if(this._needWait)return this._completeAfterWait=!0,this._needResetColumns=t,[2];if(this._completeAfterWait=!1,t&&this.restoreColumnsOnRangeChangeOperationCompleted(),!this.rangeChangedInfo||this.rangeChangedInfo.handled||this.rangeChangedInfo.getChangedCellCount()===0){this.rollBackRangeChange();this.listview.setDataToSpreadJSNow();this.listview.onCurrentRowChanged(this.listview.getMappedEditorSelectedRowIndex());return this.rangeChangedInfo.handled=!0,[2]}return(this.listview.cacheComboboxText(),!this.listview.isComboboxRequestCompleted())?(n.DelayRefresh.setTimeout(function(){e.onRangeChangeOperationCompleted(t)},50),[2]):(this.rangeChangedInfo.handled=!0,this.listview.setDataToSpreadJSNow(),[4,this.validateRangeChangedCells()]);case 1:return(i=o.sent(),u=this.isRangeChangedInCurrentRow(),u||i.status!==0||(this.resumeCalc(),r=this.listview.buildDetailListviewValues(!1),r&&(f=n.UpdateDataTableCommand.checkCalcErrorValue(null,null,[r]),n.Common.IsEmpty(f)||(i={status:1,message:f}))),i.status===1&&this.listview.GetDataValidationTime()===0)?(this.showErrorMessageAndRollBackRangeChange(i.message),[2]):(this.listview.triggerAPIValueChangedEvent(this._getRangeChangedCellRanges(),this._listData.getRowCount(),this.rangeChangedInfo.oldRowCount),u)?[2]:(this.clearRangeChangedInfo(),this.listview.GetDataCommitMode()!==0)?(this.listview.onSelectionChanged(),[2]):(r&&this.updateOnRangeChanged(r),this.listview.onSelectionChanged(),[2])}})})},t.prototype._getRangeChangedCellRanges=function(){var t=this,n=[];return this.rangeChangedInfo.changedCells.forEach(function(i,r){i.forEach(function(i){n.push({Row:i.row,Column:t.listview.listviewData.getColIndexByVisibleColIndex(r),RowCount:1,ColumnCount:1})})}),n},t.prototype.restoreColumnsOnRangeChangeOperationCompleted=function(){for(var t=this._sheet.getColumnCount(),i=[],n=0;n<t;n++)i[n]=this._sheet.getColumnWidth(n);for(this.listview.initColumnsBindingInfo(),this.listview.resetColumnHeaderText(),n=0;n<t;n++)this._sheet.setColumnWidth(n,i[n]);this.listview.onColumnWidthOrColumnCountChanged()},t.prototype.isRangeChangedInCurrentRow=function(){for(var n,t,r=this.rangeChangedInfo.changedCells,i=0;i<r.length;i++)if(n=r[i],n)for(t=0;t<n.length;t++)if(n[t].row!==this.rangeChangedInfo.oldActiveRowIndex)return!1;return!0},t.prototype.getEditRowsInRangeChange=function(n){return n.EditValues?n.EditValues.map(function(n){return{rowIndex:n.rowIndex,updateType:"edit",query:n.query,values:n.values}}):[]},t.prototype.getAddRowsInRangeChange=function(n){return n.AddValues?n.AddValues.map(function(n){return{rowIndex:n.rowIndex,updateType:"add",query:null,values:n.values}}):[]},t.prototype.updateOnRangeChanged=function(t){var f=this,r=this.getEditRowsInRangeChange(t),u=this.getAddRowsInRangeChange(t),e=r.concat(u),i;e.some(function(n){return!f.listview.commitChangeRealTime(n.rowIndex,n.updateType)})||(e.forEach(function(n){return f.listview.pushToCommitingRow(n.rowIndex)}),this.listview.showLoadingIndicator(),i=this,this.listview.updateMultiRows(t,function(t){var o,s,e,f;if(!i.listview.hasDestroyed()){if(t.ReloadData){i.listview.fillData();return}i._sheet.suspendPaint();((o=t.UpdatedRowResults)===null||o===void 0?void 0:o.length)?(s=t.UpdatedRowResults,e=[],i.updateQueryIfPrimaryKeyChanged(r),s.forEach(function(t){for(var f=!0,u=0;u<r.length;u++)if(t.JustInsertedRowInfo&&n.Common.isQueryEqual(r[u].query,t.JustInsertedRowInfo.query)){f=!1;i.listview.handleAfterUpdateDataChange(r[u].rowIndex,r[u].updateType,t);break}f&&e.push(t)}),e.length===u.length&&e.forEach(function(n,t){return i.listview.handleAfterUpdateDataChange(u[t].rowIndex,u[t].updateType,n)})):(f=t,f.Message&&alert(f.Message),f.Success=!1,f.Message=null,f.ConcurrentError=!1,u.sort(function(n,t){return t.rowIndex-n.rowIndex}),r.concat(u).forEach(function(n){return i.listview.handleAfterUpdateDataChange(n.rowIndex,n.updateType,f)}));i._sheet.resumePaint();i.listview.refreshOtherListViewsBindingToSameTable();i.listview.hiddenLoadingIndicator()}},function(){alert(n.RS.Commit_FailMessage)}))},t.prototype.updateQueryIfPrimaryKeyChanged=function(n){var i,r,e,u,f,o,t;if(n&&!(n.length<=0)){if(i=[],n[0].query)for(t in n[0].query)i.push(t);if(!(i.length<=0))for(r=0,e=n;r<e.length;r++)for(u=e[r],f=0,o=i;f<o.length;f++)t=o[f],u.values[t]!==undefined&&(u.query[t]=u.values[t])}},t.prototype.validateRangeChangedCells=function(){return __awaiter(this,void 0,void 0,function(){var e,s,h,r,f,u,t,o,i;return __generator(this,function(c){switch(c.label){case 0:if(this.listview.GetDataValidationTime()===1)return[2,{status:0}];e=this.listview.listviewData.visibleColumns;s=this.rangeChangedInfo.changedCells;h=this._listData.getRowCount();r=0;c.label=1;case 1:if(!(r<e.length))return[3,10];if(f=n.ListviewEditorHelper.getCell(e[r].getTemplateCell(),this.listview.runTimePageName,this.listview.designerPageName,this.listview.getListviewName()),!f)return[3,9];if(u=s[r],!u)return[3,5];t=0;c.label=2;case 2:return(t<u.length)?this.listview.mappedRowIndexFrowView(u[t].row)>=this.rangeChangedInfo.oldRowCount?[3,4]:[4,this.validateRangeChangedCell(u[t].row,r,f.cellType)]:[3,5];case 3:if(i=c.sent(),i.status===1)return i.message=this.generateValidateErrorMessage(u[t].row,r,i.message),[2,i];c.label=4;case 4:return t++,[3,2];case 5:t=this.rangeChangedInfo.oldRowCount;c.label=6;case 6:return(t<h)?(o=this.listview.mappedRowIndexFromData(t),[4,this.validateRangeChangedCell(o,r,f.cellType)]):[3,9];case 7:if(i=c.sent(),i.status===1)return i.message=this.generateValidateErrorMessage(o,r,i.message),[2,i];c.label=8;case 8:return t++,[3,6];case 9:return r++,[3,1];case 10:return[2,{status:0}]}})})},t.prototype.validateRangeChangedCell=function(n,t,i){return __awaiter(this,void 0,void 0,function(){var u,r;return __generator(this,function(f){switch(f.label){case 0:return(u=this._sheet.getValue(n,t),this.listview.allowShowTotalRow()&&n===this.listview.totalRowIndex)?[2,null]:(r=i.validateValue(u,this.listview.getValidateHelpInfoByViewIndex(n,t)),!(r instanceof Promise))?[3,2]:[4,r];case 1:return[2,f.sent()];case 2:return[2,r]}})})},t.prototype.generateValidateErrorMessage=function(t,i,r){var u;if(n.Common.IsEmpty(r))return r;var e=this._sheet.getValue(t,i),o=n.FormatHelper.getTextFromValue(e),f="";return this._sheet.options.colHeaderVisible&&(f=this._sheet.getText(0,i,GC.Spread.Sheets.SheetArea.colHeader)),n.Common.IsEmpty(f)&&(f=i+1+""),u="",this._sheet.options.rowHeaderVisible&&(u=this._sheet.getText(t,0,GC.Spread.Sheets.SheetArea.rowHeader)),n.Common.IsEmpty(u)&&(u=this.listview.mappedRowIndexFrowView(t)+1+""),n.Common.format(n.RS.ValidateErrorMessage,o,u,f,r)},t.prototype.showErrorMessageAndRollBackRangeChange=function(t){var i=this,r;this.rollBackRangeChange();r=this;n.DelayRefresh.NeedDelayRun===!0?(this.listview.showLoadingIndicator(!1),n.DelayRefresh.setTimeout(function(){i.listview.hasDestroyed()||(i.showErrorMessageAndRepaint(t),i.listview.hiddenLoadingIndicator())},100)):r.showErrorMessageAndRepaint(t)},t.prototype.rollBackRangeChange=function(){var u,f,n,t,e,i,o,s,r;for(this.listview.operationTypeWhenValueChanged=1,u=this.rangeChangedInfo.changedCells,f=this.listview.listviewData.visibleColumns,n=0;n<f.length;n++)if((t=u[n],t)&&(e=this.listview.listviewData.getColIndexByVisibleColIndex(n),e!==-1))for(i=0;i<t.length;i++)t[i].row>=this.rangeChangedInfo.oldRowCount||(o=this.listview.mappedRowIndexFrowView(t[i].row),this.listview._onCellValueChanged(o,n,t[i].value));for(s=this._listData.getRowCount()-this.rangeChangedInfo.oldRowCount,r=0;r<s;r++)this.listview.deleteRowInDataModel(this.rangeChangedInfo.oldRowCount);this.listview.operationTypeWhenValueChanged=0},t.prototype.showErrorMessageAndRepaint=function(t){var r,i;for(n.Common.IsEmpty(t)||alert(t),this._sheet.suspendPaint(),this.listview.setDataToSpreadJSNow(),r=this.rangeChangedInfo.oldSelections,i=0;i<r.length;i++)i===0?this._sheet.setSelection(r[i].row,r[i].col,r[i].rowCount,r[i].colCount):this._sheet.addSelection(r[i].row,r[i].col,r[i].rowCount,r[i].colCount);this._sheet.resumePaint()},t}();t.RangeChangedManager=r})(t=n.ListViewHelper||(n.ListViewHelper={}))})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t;(function(t){var i=function(){function i(t){this._spreadJSView=t;this._pageStretchInfo=n.PageManager.getPageStretchInfo(t.runTimePageName)}return i.prototype.cacheWidth=function(){this._clearCachedWidth();var n=this._calcColumnsWidth(!0);this._originalColumnsWidth=n.widths.slice();this._originalSolidColumnsWidth=n.solidWidth;this._originalTotalColumnsWidth=n.totalWidth},i.prototype.isListviewUseSimpleBar=function(){var n=this._spreadJSView.getSpread();return n?n.options.scrollbarAppearance===GC.Spread.Sheets.ScrollbarAppearance.mobile:!1},i.prototype.stretch=function(n){var t=this._spreadJSView.getSpread();t&&(t.suspendPaint(),this.redraw(),this.stretchWithoutSuspendPaint(n),t.resumePaint())},i.prototype.stretchWithoutSuspendPaint=function(n){this._updateInnerContainerWidth();this._updateInnerContainerHeight();var t=this._getScrollStatus(this._originalTotalColumnsWidth,this._originalSolidColumnsWidth,this._getSolidRowsHeight(),!0,this.isListviewUseSimpleBar());this._stretchColumns(t.availableWidth);this._stretchContainer(this._innerContainerWidth);this._spreadJSView.onStretch(t,n)},i.prototype.getCurrntScrollbarVisibility=function(){var n=this._calcColumnsWidth(!1),i=this._calcCurrentSolidRowsHeight(),t=this._getScrollStatus(n.totalWidth,n.solidWidth,i,!1,this.isListviewUseSimpleBar());return{showHScrollBar:t.showHScrollBar,showVScrollbar:t.showVScrollbar}},i.prototype.destroy=function(){this._clearCachedWidth();this._spreadJSView=null},i.prototype._canDisplayAllSolidColumns=function(n,t){return t=Math.ceil(t),t>=n},i.prototype._canDisplayAllRows=function(n,t){return t=Math.ceil(t),t>=n},i.prototype._getSolidRowsHeight=function(){var n=this._spreadJSView.getSheet(),t=n.getRowCount(),i=n.getRowHeight(0);return t*i+this._spreadJSView.getColHeaderHeight()},i.prototype._getEmptyColumnWidthAfterStretch=function(n,t,i){if(!i)return n;var r=t/this._originalTotalColumnsWidth;return n*r},i.prototype._getScrollStatus=function(n,i,r,u,f){var h=this._innerContainerWidth,e=!this._canDisplayAllSolidColumns(n,h),o=!this._canDisplayAllRows(r,this._innerContainerHeight),c,s,l;return this._spreadJSView.forceHideVerticalScrollBar&&(o=!1),this._spreadJSView.forceHideHorizontalScrollBar&&(e=!1),e&&!o?(c=f?0:t.SpreadJSStyleHelper.hScrollbarHeight,o=!this._canDisplayAllRows(r,this._innerContainerHeight-c)):o&&!e&&(s=this._getEmptyColumnWidthAfterStretch(n-i,h,u),s=Math.round(s),l=f?0:t.SpreadJSStyleHelper.vScrollbarWidth,e=s<l),{showHScrollBar:e,showVScrollbar:o,availableHeight:this._innerContainerHeight,availableWidth:h}},i.prototype._calcCurrentSolidRowsHeight=function(){for(var t=this._spreadJSView.getSheet(),r=t.getRowCount(),i=0,n=0;n<r;n++)i+=t.getRowHeight(n);return i+this._spreadJSView.getColHeaderHeight()},i.prototype._calcOriginalColumnsWidth=function(n,t){for(var e,o,f=n.visibleColumns,h=n.isRowHeaderCheckBoxVisible(),c=n.isRowHeaderVisible(),r=[],i=0,s=0,u=0;u<f.length;u++)r[u]=f[u].columnInfo.Width,i+=r[u];return h&&(e=n.rowHeaderCheckBoxColumnInfo.columnInfo.Width,r.unshift(e),i+=e),c&&(o=n.rowHeaderColumnInfo.columnInfo.Width,r.unshift(o),i+=o),s=i,f.length>0&&i<t&&(i=t,r.push(t-i)),{widths:r,totalWidth:i,solidWidth:s}},i.prototype._calcCurrentColumnsWidth=function(n,t){var u=this._spreadJSView.getSheet(),l=n.isRowHeaderCheckBoxVisible(),a=n.isRowHeaderVisible(),y=this._originalColumnsWidth.length,e=0,r=[],i=0,v=0,o,s,h,f,c;for(a&&l?(o=u.getColumnWidth(0,GC.Spread.Sheets.SheetArea.rowHeader),s=u.getColumnWidth(1,GC.Spread.Sheets.SheetArea.rowHeader),i+=o+s,e=2,r.unshift(o,s)):(a||l)&&(h=u.getColumnWidth(0,GC.Spread.Sheets.SheetArea.rowHeader),i+=h,r.unshift(h),e=1),f=0;f<y-e;f++)c=u.getColumnWidth(f,GC.Spread.Sheets.SheetArea.viewport),i+=c,r.push(c);return v=i,i<t&&(i=t,r.push(t-i)),{widths:r,totalWidth:i,solidWidth:v}},i.prototype._calcColumnsWidth=function(t){var i=this._spreadJSView.listviewData,r,u,f;return t?(r=n.ForguncyData.getPageLayout(this._spreadJSView.locatedPageID,this._spreadJSView.runTimePageName),r?(u=this._spreadJSView.layout,f=r.getColumnWidth(u.Column,u.ColumnSpan),this._calcOriginalColumnsWidth(i,f)):this._calcOriginalColumnsWidth(i,100)):this._calcCurrentColumnsWidth(i,this._innerContainerWidth)},i.prototype._stretchColumns=function(n){var c=this._spreadJSView.listviewData,h,i,f,t,a;if(!c.getAutoFitColumnWidth()){var e=0,o=this._spreadJSView.getSheet(),l=c.isRowHeaderCheckBoxVisible(),s=c.isRowHeaderVisible(),r=this._originalColumnsWidth.slice(),u=[];if(this._originalTotalColumnsWidth<=Math.ceil(n)){if(h=n/this._originalTotalColumnsWidth,s&&l)for(u=r.splice(0,2),i=0,f=u.length;i<f;i++)t=u[i]*h,t=Math.round(t),e+=t,o.setColumnWidth(i,t,GC.Spread.Sheets.SheetArea.rowHeader),i===0?this._spreadJSView.updateRowHeaderWidth(t):this._spreadJSView.updateRowHeaderCheckBoxWidth(t);else(s||l)&&(u=r.splice(0,1),t=u[0]*h,t=Math.round(t),e+=t,o.setColumnWidth(0,t,GC.Spread.Sheets.SheetArea.rowHeader),s?this._spreadJSView.updateRowHeaderWidth(t):this._spreadJSView.updateRowHeaderCheckBoxWidth(t));for(i=0,f=r.length;i<f;i++)t=r[i]*h,t=Math.round(t),e+=t,i===f-1&&(a=n-e,t+=a,t=Math.floor(t)),o.setColumnWidth(i,t)}else this._resetAllColmnsWidth(o,r,s,l)}},i.prototype._resetAllColmnsWidth=function(n,t,i,r){var f=[],u,e;if(i&&r)for(f=t.splice(0,2),u=0,e=f.length;u<e;u++)n.setColumnWidth(u,f[u],GC.Spread.Sheets.SheetArea.rowHeader);else(i||r)&&(f=t.splice(0,1),n.setColumnWidth(0,f[0],GC.Spread.Sheets.SheetArea.rowHeader));for(u=0,e=t.length;u<e;u++)n.setColumnWidth(u,t[u])},i.prototype._stretchContainer=function(n){$(this._spreadJSView.getContainer()).width(n)},i.prototype._clearCachedWidth=function(){this._originalTotalColumnsWidth=0;this._originalSolidColumnsWidth=0;this._originalColumnsWidth=[]},i.prototype._updateInnerContainerWidth=function(){var n=this._spreadJSView.getContainerDiv(),t;n.css("overflow","hidden");t=n.width();this._innerContainerWidth=t;n.css("overflow","")},i.prototype._updateInnerContainerHeight=function(){var n=this._spreadJSView.getContainerDiv(),t;n.css("overflow","hidden");t=n.height();this._innerContainerHeight=t;n.css("overflow","")},i.prototype.redraw=function(){if(this._pageStretchInfo.StretchMode===4){var n=this._spreadJSView.getContainer();n.style.display="none";n.offsetHeight;n.style.display=""}},i}();t.StretchHelper=i})(t=n.ListViewHelper||(n.ListViewHelper={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(n){var i=t.call(this)||this,r;return(i._deleteButton=undefined,r=n,!r||r.length===0)?i:(i._deleteButton=i.create(),i.bindEvents(),r.append(i._deleteButton),i)}return __extends(i,t),i.prototype.create=function(){var t=$("<div/>"),u,r;return t.addClass(i.className),t.css("display","none"),t.css("position","absolute"),t.css("zIndex",999),t.css("width",21),t.css("height",16),u=-21,t.css("left",u),r=$("<img/>"),r.addClass("deleteButton"),r.css("position","absolute"),r.css("width",16),r.css("height","100%"),r.css("cursor","pointer"),r.attr("src",n.ForguncyData.ForguncyRoot+"Resources/Images/SiteBuiltInImages/delete.png"),t.append(r),t},i.prototype.bindEvents=function(){var n=this;this._deleteButton.on("click",function(){n.trigger("click");n.hide()});this._deleteButton.on("mouseenter",function(){n.trigger("mouseenter")});this._deleteButton.on("mouseleave",function(){n.trigger("mouseleave")})},i.prototype.show=function(n){if(this._deleteButton){var t=n-8;this._deleteButton.css("top",t);this._deleteButton.show()}},i.prototype.hide=function(){this._deleteButton&&this._deleteButton.hide()},i.prototype.isVisible=function(){return this._deleteButton?this._deleteButton.css("display")==="block":!1},i.prototype.isPointIn=function(t){return n.ListviewBase.isPointInElement(t,this._deleteButton)},i.prototype.getButtonCenterY=function(){return parseFloat(this._deleteButton.css("top").slice(0,-2))+8},i.className="deleteButton",i}(n.EventClassBase);n.ListviewDeleteButton=t})(Forguncy||(Forguncy={}))
;