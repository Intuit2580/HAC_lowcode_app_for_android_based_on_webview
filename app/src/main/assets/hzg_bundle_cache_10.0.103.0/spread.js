var GC;!function(){"use strict";var i,r,t;function e(t){var n,n,n=r[t];return void 0!==n||(n=r[t]={exports:{}},i[t].call(n.exports,n,n.exports,e)),n.exports}i={"./dist/plugins/cellState/cellStateManager.js":function(t,n,i){var o,s,r,b,j,i,c,r,m,e,u,n,a;function f(t){var n=t.row,i=t.col,r=t.rowCount,t=t.colCount;return new b.Range(n,i,r,t)}function h(t,n){this.Mf=t,this.Kh=n,this.cE=[];for(var i=1;i<=3;i++)this.PP(i)}function v(t){this.Mf=t,this.GP={}}function l(n,t,i){var r=[],e=n.getRowCount(3),o=n.getColumnCount(3);return t.forEach(function(t){r=r.concat(C(n,t.style,t.range,i,e,o))}),r}function d(t){for(var n,i,r,e,o,i,s,u,a,f,i,n=[],r=0,e=t.length;r<e;r++)o=(i=t[r]).style,i={range:{row:s=(i=i.range).row,col:u=i.col,colCount:a=i.colCount,rowCount:f=i.rowCount},style:o.toJSON()},n.push(i);return n}function g(t,n,i,r){for(var e,e,o,s,u,a,f,c,u,e,h,o=0,s=n.length;o<s;o++)a=(u=(e=n[o]).range).row,f=u.col,c=u.rowCount,u=u.colCount,e=e.style,(h=new b.Style).fromJSON(e,i,r),e={style:h,range:new b.Range(a,f,c,u)},t.push(e)}function C(t,n,i,r,e,o){var s;return t.BR(i,r,e,o).map(function(t){return{range:t,style:n}})}function w(t,n,i){return i.contains(t,n)}function y(t){var n=t.range,i=t.style;return n.constructor.name===Object&&((n=new b.Range(0,0,1,1)).fromJSON(t.range),(i=new b.Style).fromJSON(t.style)),{range:n,style:i}}o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},s=this&&this.__rest||function(t,n){var i,r,e,i={};for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(e=0,r=Object.getOwnPropertySymbols(t);e<r.length;e++)n.indexOf(r[e])<0&&Object.prototype.propertyIsEnumerable.call(t,r[e])&&(i[r[e]]=t[r[e]]);return i},Object.defineProperty(n,"__esModule",{value:!0}),n.CellStateManager=void 0,r=i("Common"),b=i("Core"),j=r.Common.lt.ht,i=b.GC$.extend,c=void 0,r="cellState",m=[b.CellStatesType.readonly,b.CellStatesType.invalid,b.CellStatesType.dirty,b.CellStatesType.invalidFormula,b.CellStatesType.selected,b.CellStatesType.active,b.CellStatesType.hover,b.CellStatesType.edit],h.prototype.PP=function(t){this.cE[t]=[]},h.prototype.UP=function(t){return this.cE[t]},h.prototype.HP=function(t,n){this.cE[n]=t},h.prototype.zP=function(t,n){for(var i,r,e,i=0,r=t.length;i<r;i++)if((e=t[i]).range.equals(n))return i;return-1},h.prototype.VP=function(t,n){var i,r,t,e,i=this,r=i.UP(n),t=this.zP(r,t);-1<t&&(e=r[t],i.YP(t,e.range,e.style,r,n),r.splice(t,1))},h.prototype.ZP=function(t,n,i){var r,e,o,s,r=this,e=r.UP(i),o=r.zP(e,t),s={range:t,style:n};r.WP({index:o,cache:e,range:t,style:n,sheetArea:i}),-1===o?e.push(s):e[o]=s},h.prototype.QP=function(t){var t=this.UP(t),i=this.Kh;return t.map(function(t){var n=t.range,t=t.style;return{range:f(n),style:t.clone(),state:i}})},h.prototype.ML=function(t,n,i){for(var r,e,o,s,u,r=this.UP(i),o=[],s=r.length,u=0;u<s;u++)w(t,n,(e=r[u]).range)&&o.push(e);return 0<o.length?o:null},h.prototype.KP=function(t,n,i){var r,i,e,o,s,r,i=this.UP(i);if(i&&0<i.length)for(e=0,o=i;e<o.length;e++)if(w(t,n,s=o[e].range))return!0;return!1},h.prototype.JP=function(t,n,i,r,e,o){var s,u,a,f,c,h,v,s=this,u=s.Mf,a=s.UP(e);if(a&&0===a.length)return!1;if(s.Kh===b.CellStatesType.dirty&&(j(r)||0<(r&s.Kh)))return u.isReportWorkSheet?!!u.isDirtyCell(n,i):u.XP(n,i,e);if(s.Kh===b.CellStatesType.selected&&(j(r)||0<(r&s.Kh))){for(c=0,h=f=s.Mf.getSelections();c<h.length;c++)if(w(n,i,v=h[c]))return!0;return!1}return s.Kh===b.CellStatesType.invalid?!(!u.isValid||!(j(r)||0<(r&s.Kh))||u.isValid(n,i,u.getValue(n,i,e))):s.Kh===b.CellStatesType.readonly?o&&s.Mf.isActualProtected():0<(s.Kh&t)},h.prototype.qP=function(t,n){var i=this,r=this.UP(n);this.$P({cache:r,sheetArea:n,collection:i,state:i.Kh,range:t}),this.HP(l(this.Mf,r,t),n)},h.prototype.toJSON=function(){for(var t,n,i,r,t=this,n={},r=0;r<=3;r++)(i=t.UP(r))&&0<i.length&&(n[r]=d(i));return n},h.prototype.fromJSON=function(t,n,i){var r,e,o,s,r=this;for(r.cE=[],o=1;o<=3;o++)r.PP(o);for(s in t)t.hasOwnProperty(s)&&g(e=r.UP(s),t[s],n,i)},h.prototype.tG=function(t){var t,n,i,t=s(t,[]),n=this,i;n.Mf.Ut.nG(o({type:"rangeChange",state:n.Kh},t))},h.prototype.WP=function(t){var n,i,r,e,t,o,s,n=t.index,i=t.cache,r=t.range,e=t.style,t=t.sheetArea,o=this,s=o.Mf.Ut;-1!==n&&(e=i[n].style),s.nG({type:"add",index:n,cache:i,state:o.Kh,range:r,style:e,sheetArea:t})},h.prototype.YP=function(t,n,i,r,e){var o=this,s;o.Mf.Ut.nG({type:"remove",index:t,range:n,style:i,cache:r,state:o.Kh,sheetArea:e})},h.prototype.$P=function(t){var t,n,i,t=s(t,[]),n=this,i;n.Mf.Ut.nG(o({type:"clear",state:n.Kh},t))},h.prototype.JO=function(o,s){for(var u,a,t,n,u=this,t=function(e){(a=u.UP(e))&&0<a.length&&a.forEach(function(t,n){var t,i,r,t=t.range,i=t.row,r=t.rowCount;o<=i?(t.row=i+s,u.tG({cache:a,range:t,row:i,index:n,sheetArea:e})):i<o&&o<i+r&&(t.rowCount=t.rowCount+s,u.tG({cache:a,range:t,rowCount:r,index:n,sheetArea:e}))})},n=0;n<=3;n++)t(n)},h.prototype.xP=function(s,u){for(var a,f,t,n,a=this,t=function(o){(f=a.UP(o))&&0<f.length&&f.forEach(function(t,n){var t,i,r,e,t=t.range,i=t.row,r=t.rowCount;s<i?((e=s+u-i)<=0?i-=u:(i-=e,t.rowCount-=e),i<0&&(t.rowCount=r+i,i=0),t.row=i,a.tG({cache:f,range:t,row:i,rowCount:r,index:n,sheetArea:o})):i<=s&&s<i+r&&(t.rowCount=t.rowCount-Math.min(u,i+r-s),a.tG({cache:f,range:t,rowCount:r,index:n,sheetArea:o}))})},n=0;n<=3;n++)t(n)},h.prototype.qO=function(o,s){for(var u,a,t,n,u=this,t=function(e){(a=u.UP(e))&&0<a.length&&a.forEach(function(t,n){var t,i,r,t=t.range,i=t.col,r=t.colCount;o<=i?(t.col=i+s,u.tG({cache:a,range:t,col:i,index:n,sheetArea:e})):i<o&&o<i+t.colCount&&(t.colCount=r+s,u.tG({cache:a,range:t,colCount:r,index:n,sheetArea:e}))})},n=0;n<=3;n++)t(n)},h.prototype.NP=function(s,u){for(var a,f,t,n,a=this,t=function(o){(f=a.UP(o))&&0<f.length&&f.forEach(function(t,n){var t,i,r,e,t=t.range,i=t.col,r=t.colCount;s<i?((e=s+u-i)<=0?i-=u:(i-=e,t.colCount-=e),i<0&&(t.colCount+=i,i=0),t.col=i,a.tG({cache:f,range:t,col:i,colCount:r,index:n,sheetArea:o})):i<=s&&s<i+r&&(t.colCount-=Math.min(u,i+r-s),a.tG({cache:f,range:t,colCount:r,index:n,sheetArea:o}))})},n=0;n<=3;n++)t(n)},h.prototype.eG=function(){this.cE=[],this.Mf=null},e=h,v.prototype.getCollection=function(t,n){var i=this;return!i.GP[t]&&n&&(i.GP[t]=new e(i.Mf,t)),i.GP[t]},v.prototype.hasIntersectInSelectionState=function(t,n,i,r){var e,o,o,s,u,a,e,o=this.GP[b.CellStatesType.selected];if(o&&(o=o.UP(b.SheetArea.viewport))&&0<o.length)for(s=0,u=o;s<u.length;s++)if((a=u[s].range).intersect(t,n,i,r))return!0;return!1},v.prototype.getState=function(t,n,i){var r;return this.Mf.Ut.W_(i).getCellState(t,n)||0},v.prototype.remove=function(t,n,i){var r;void 0===i&&(i=b.SheetArea.viewport),this.GP[n].VP(t,i)},v.prototype.all=function(t,n){var i,r;if(void 0===n&&(n=b.SheetArea.viewport),i=[],j(t))for(r in this.GP)this.GP.hasOwnProperty(r)&&(i=i.concat(this.GP[r].QP(n)));else i=this.GP[t].QP(n);return i},v.prototype.add=function(t,n,i,r){var e,n,i;if(b.CellStatesType[n]===c)throw new Error("Unmatched Cell State Type");j(r)&&(r=3),(e=this.getCollection(n,!0)).ZP(f(t),i,r),n=this.Mf,r===b.SheetArea.viewport?n.repaint(n.j1(t)):(i=n.Fi(),r===b.SheetArea.colHeader&&n.repaint(new b.Rect(i.Py,i.LA,n.Gy(i),i.qC)),r===b.SheetArea.rowHeader&&n.repaint(new b.Rect(i.BA,i.Cy,i.XC,n.Sy(i))))},v.prototype.clear=function(t,n){this.iG(t,n)},v.prototype.iG=function(t,n){for(var i in this.GP)this.GP.hasOwnProperty(i)&&this.GP[i].qP(t,n)},v.prototype.rG=function(t,n,i,r,e,o){var s=this,u=s.Mf,s=s.GP[t];s&&s.KP(n,i,r)&&-1!==e&&-1!==o&&u.repaint(u.XL(u,n,i,e,o))},v.prototype.getStyle=function(t,n,i,r,e){var o,s,u,u,a,f,c,h,v,l,d,g,C,w;if(j(i)&&(i=3),o=new b.Style,s=[],h=(c=(f=(a=this).Mf).Ut).getSpan(t,n,i),j(h)||(t=h.row,n=h.col),v=j(r)?a.getState(t,n,i):a.getState(t,n,i)&r,!j(v)){for(l=0,d=m;l<d.length;l++)(u=a.GP[g=d[l]])&&u.JP(v,t,n,r,i,e)&&(u=u.ML(t,n,i))&&0<u.length&&(s=s.concat(u));if(0<s.length){for(w=(C=s.length)-1;0<=w;w--)o.h5(s[w].style);return o}}return null},v.prototype.destroy=function(){for(var t in this.GP)this.GP.hasOwnProperty(t)&&this.GP[t].eG();delete this.GP,delete this.Mf},v.prototype.reset=function(t){this.GP={},this.Mf=t},v.prototype.toJSON=function(){var t,n,i,t={};for(i in this.GP)this.GP.hasOwnProperty(i)&&(n=this.GP[i],t[i]=n.toJSON());return t},v.prototype.fromJSON=function(t,n,i){var r,e,o,s,r=this;for(o in t)t.hasOwnProperty(o)&&(s=parseInt(o,10),(e=r.getCollection(s,!0)).fromJSON(t[s],n,i))},v.prototype.JO=function(t,n){for(var i in this.GP)this.GP.hasOwnProperty(i)&&this.GP[i].JO(t,n)},v.prototype.xP=function(t,n){for(var i in this.GP)this.GP.hasOwnProperty(i)&&this.GP[i].xP(t,n)},v.prototype.qO=function(t,n){for(var i in this.GP)this.GP.hasOwnProperty(i)&&this.GP[i].qO(t,n)},v.prototype.NP=function(t,n){for(var i in this.GP)this.GP.hasOwnProperty(i)&&this.GP[i].NP(t,n)},u=v,n.CellStateManager=u,n={init:function(){this.cellStates=new u(this)},dispose:function(t){var n=this;n.cellStates&&!1!==t.clearCache&&(n.cellStates.destroy(),n.cellStates=null)},onLayoutChanged:function(t){var n,i,r,e,o,s,u,a,f,n=t.changeType,i=t.row,r=t.rowCount,e=t.col,o=t.colCount,s=t.sheetArea;if(j(s)||s===b.SheetArea.viewport)if(u=this.cellStates,"addRows"===n)u.JO(i,r);else if("deleteRows"===n)u.xP(i,r);else if("addColumns"===n)u.qO(e,o);else if("deleteColumns"===n)u.NP(e,o);else if("clear"===n&&(3===s&&2==(2&t.type)&&u.iG(new b.Range(i,e,r,o),s),3===s)&&1==(1&t.type))for(a=i;a<i+r;a++)for(f=e;f<e+o;f++)this.Ut.W_(s).setCellState(a,f,b.CellStatesType.invalid,!1)},toJson:function(t,n){n&&n.ignoreStyle||(t.cellStates=this.cellStates.toJSON())},fromJson:function(t,n,i){var r,e,r=this,e=i&&!i.ignoreStyle||!i;t&&t.cellStates&&e&&(r.cellStates=new u(r),r.cellStates.fromJSON(t.cellStates,n,i))},wh:function(t,n,i){var r;i&&!1===i.includeStyles||(t.lossless.cellStates=this.cellStates.toJSON())},yh:function(t,n,i){var r;i&&!1===i.includeStyles||!t.lossless||!t.lossless.cellStates||this.cellStates.fromJSON(t.lossless.cellStates,c,i)}},i(b.Worksheet.prototype,a={k_:function(t,n,i,r,e,o){r&&r<=3&&0<r&&this.cellStates.rG(t,n,i,r,e,o)},XP:function(t,n,i){var r,i=this.Ut.Fj(i);return i&&i[t]&&i[t][n]}}),b.Worksheet.ch(r,n),i(b.Y8.prototype,{nG:function(t){var n,i,r,n,i=this.G8;i&&(r=void 0,(r=i.originalCellStates||[]).push(t),i.originalCellStates=r)},oG:function(t,r){var e=this;t&&0<t.length&&t.forEach(function(t){var n=t.type,i=s(t,["type"]);switch(n){case"rangeChange":e.aG(o({},i),r);break;case"add":e.uG(o({},i),r);break;case"clear":e.sG(o({},i),r);break;case"remove":e.cG(o({},i),r)}})},sG:function(t,n){var i=t.cache,r=t.sheetArea,e=t.collection,o=t.state,t=t.range;"Object"===e.constructor.name&&(e=this.Mf.cellStates.getCollection(o,!0),i=i.map(y)),n?e.HP(l(this.Mf,i,t),r):e.HP(i,r)},cG:function(t,n){var i=t.cache,r=t.range,e=t.sheetArea,o=t.state,s=t.style,t=t.index;"Object"===r.constructor.name&&(i=this.Mf.cellStates.getCollection(o,!0).UP(e)),n?i.splice(t,1):i.splice(t,0,y({range:r,style:s}))},uG:function(t,n){var i,r,e,o,s,t,u,a,i=t.cache,r=t.range,e=t.sheetArea,o=t.state,s=t.style,t=t.index;"Object"===r.constructor.name&&(i=this.Mf.cellStates.getCollection(o,!0).UP(e)),u=y({range:r,style:s}),n?-1===t?i.push(u):i[t]=u:-1===t?(i.forEach(function(t,n){var i=t.range,t=t.style;i===u.range&&t===u.style&&(a=n)}),i.splice(a,1)):i[t].style=u.style},aG:function(t,n){var i,r,e,o,s,u,a,f,t,e,i=t.cache,r=t.range,e=t.state,o=t.sheetArea,s=t.index,u=t.row,a=t.col,f=t.rowCount,t=t.colCount;"Object"===r.constructor.name&&(i=this.Mf.cellStates.getCollection(e,!0).UP(o),(e=new b.Range(0,0,0,0)).fromJSON(r),r=e),n?i[s].range=r:(r=i[s].range,u!==c&&(r.row=u),a!==c&&(r.col=a),f!==c&&(r.rowCount=f),t!==c&&(r.colCount=t))}}),b.Y8.ch(r,{applyChanges:function(t){var n,t,n,n=t.changes,t=t.isUndo,n=n&&n.originalCellStates;n&&this.oG(n,!t)},undo:function(t){var t=t.originalCellStates;t&&this.oG(t)}})},"./dist/plugins/cellState/cellstate.entry.js":function(t,n,i){var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/plugins/cellState/cellStateManager.js"),n),e(i("./dist/plugins/cellState/stateManager.js"),n)},"./dist/plugins/cellState/stateManager.js":function(t,n,i){var r,r,b,e,h,o,i,s,u,a;function f(t){this.fG={},this.getStateMethods={},this.context=t,o(this.getStateMethods,s)}function c(t,n){var t;if(n)return(t=new u(t)).fromJSON(n),t}Object.defineProperty(n,"__esModule",{value:!0}),n.lG=void 0,r=i("Common"),b=i("Core"),e=r.Common.lt.ht,h=r.Common.lt.q8,o=b.GC$.extend,i="states",(r={})[b.RowColumnStates.hover]=function(t,n,i,r){var e,o,s,u,e=this,o;return(i?t===e.A_:n===e.I_)&&(s=e.zO(e.A_,e.I_,b.SheetArea.viewport),!!(u=r&&r.some(function(t){return!(!t.contains(e.A_,e.I_)||!s)})))},r[b.RowColumnStates.active]=function(t,n,i,r){var e,o,s,e=this,o;return(i?t===e.ui:n===e.ci)&&!!(s=h(e.ui)&&h(e.ci)&&r&&r.some(function(t){return!!t.contains(e.ui,e.ci)}))},r[b.RowColumnStates.selected]=function(t,n,i,r){var e,o,s,u,a,f,c,h,v,l,d,d,g,C,w,e=this,o=!this.parent||this.parent.options.hideSelection;if(o&&!(s=b.hi.ai()===this))return!1;for(a=!1,f=0,c=u=e.getSelections();f<c.length;f++)for(h=c[f],v=0,l=r;v<l.length;v++)d=l[v],h.intersect(d.row,d.col,d.rowCount,d.colCount)&&(d=-1===h.row?0:h.row,g=-1===h.rowCount?e.getRowCount():h.rowCount,C=-1===h.col?0:h.col,w=-1===h.colCount?e.getColumnCount():h.colCount,i&&d<=t&&t<d+g||!i&&C<=n&&n<C+w)&&(a=!0);return a},r[4]=function(t,n,i,r){return!1},r[b.RowColumnStates.edit]=function(t,n,i,r){var e,o,s,u,a,f,c,e=this,o=e.ui,s=e.ci,u;return(i?t===o:n===s)&&(f=((a=e.cellStates).getState(o,s,b.SheetArea.viewport)&b.RowColumnStates.edit)===b.RowColumnStates.edit)&&!!(c=h(o)&&h(s)&&r&&r.some(function(t){return!!t.contains(o,s)}))},r[b.RowColumnStates.invalid]=function(t,n,i,r){var e,o,s,u,a,f,c,h,v,l,d,g,e=this,o=i?e.hG(t,-1):e.hG(-1,n);if(o&&0<o.length&&r)for(s=0,u=r;s<u.length;s++)if(a=u[s],i){for(f=-1===a.col?0:a.col,c=-1===a.colCount?e.getColumnCount():a.colCount,h=f;h<f+c;h++)if(!(v=e.isValid(t,h,e.getValue(t,h,b.SheetArea.viewport))))return!0}else for(l=-1===a.row?0:a.row,d=-1===a.rowCount?e.getRowCount():a.rowCount,g=l;g<l+d;g++)if(!(v=e.isValid(g,n,e.getValue(g,n,b.SheetArea.viewport))))return!0;return!1},r[b.RowColumnStates.dirty]=function(t,n,i,r){var e,o,s,u,a,f,c,h,v,l,d,g,C,w,e;if(r&&0!==r.length)for(o=this.Ut.Fj(),s=0,u=r;s<u.length;s++)for(f in a=u[s],o)if(o[f])for(v in c=Number(f),h=o[f])if(h[v]&&(l=Number(v),d=-1===a.row?0:a.row,g=-1===a.rowCount?this.getRowCount(b.SheetArea.viewport):a.rowCount,C=-1===a.col?0:a.col,w=-1===a.colCount?this.getColumnCount(b.SheetArea.viewport):a.colCount,i&&c===t&&(C<=l&&l<C+w||"n"===h[v])||!i&&l===n&&(d<=c&&c<d+g||"n"===h[v])))return!0;return!1},r[b.RowColumnStates.inserted]=function(t){for(var n,i,r,e,n,i=0,r=this.getInsertRows();i<r.length;i++)if((e=r[i]).row===t)return!0},r[256]=function(t){return!1},r[b.RowColumnStates.invalidFormula]=function(r,e,o,t){var n,s,i,u,a,f,n=this;if(t&&0!==t.length)for(s=n.cellStates,i=function(t,n,i){return!!((o?r===n:e===i)&&s.getState(n,i)&b.CellStatesType.invalidFormula)},u=0;u<t.length;u++)if(a=t[u],f=n.findSpecialNonNullCellInRange(a,i))return!0;return!1},s=r,f.prototype.enableState=function(t,n){var i=this.fG;e(i[t])&&(i[t]={row:!1,column:!1}),n?i[t].row=!0:i[t].column=!0},f.prototype.disableState=function(t,n){var i=this.fG;e(i[t])||(n?i[t].row=!1:i[t].column=!1)},f.prototype.isEnable=function(t,n){var i=this.fG;return!e(i[t])&&(n?i[t].row:i[t].column)},f.prototype.getState=function(t,n,i,r,e,o){var s,u,s=this.context,u=this.getStateMethods[i];if("function"==typeof u)return u.call(s,t,n,r,e,o)?i:0},f.prototype.destroy=function(){delete this.context,delete this.fG},f.prototype.fromJSON=function(t){this.fG=o({},t)},f.prototype.toJSON=function(){return o({},this.fG)},u=f,n.lG=u,b.Worksheet.ch(i,a={init:function(){this._1=new u(this)},dispose:function(t){var n=this;n._1&&!1!==t.clearCache&&(n._1.destroy(),n._1=null)},toJson:function(t){t.states=this._1.toJSON()},fromJson:function(t){var t=c(this,t&&t.states);t&&(this._1=t)},yh:function(t){var t=c(this,t&&t.lossless&&t.lossless.states);t&&(this._1=t)},wh:function(t){t.lossless||(t.lossless={}),t.lossless.states=this._1.toJSON()}})},Common:function(t){t.exports=GC.Spread},Core:function(t){t.exports=GC.Spread.Sheets}},r={},t=e("./dist/plugins/cellState/cellstate.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).CellState=t}();
;var GC;!function(){var n,e,t;function s(t){var i,i,i=e[t];return void 0!==i||(i=e[t]={exports:{}},n[t].call(i.exports,i,i.exports,s)),i.exports}n={"./dist/plugins/celltype/actionUtils.js":function(t,i){"use strict";function n(t,i){t&&t.suspendCalcService(i)}function e(t,i){t&&t.resumeCalcService(i)}function s(t,i){var n,t,n=t._f(i);return n||(t=t.Ofe(i))&&(n=t.Mf),n}function o(t,i){if(t.sheets){var i=s(t,i.sheetName);if(i)return i}return t}function c(t,i,n,e){var t,i,t=o(t,n),i=new i(t,n,e);return e?i.undo(t):i.execute(t)}function r(t,i){t.suspendPaint(),i||t.suspendEvent()}function u(t,i){i||t.resumeEvent(),t.resumePaint()}Object.defineProperty(i,"__esModule",{value:!0}),i.afterAction=i.beforeAction=i.executeCommand=i.getWorksheet=i.resumeCalcService=i.suspendCalcService=void 0,i.suspendCalcService=n,i.resumeCalcService=e,i.getWorksheet=o,i.executeCommand=c,i.beforeAction=r,i.afterAction=u},"./dist/plugins/celltype/addrowcolumnbuttoncelltype.js":function(t,i,n){"use strict";var e,s,n,o,s,c,r,u,a,l,M,g,h;function I(t){return o(t)||"string"==typeof t&&""===t.trim()}function N(t){var i,t=t.sheet.Dg();return t&&(t.style.cursor="pointer"),!0}function f(t){var t=t.sheet;return t.isEditing()&&t.endEdit(),!0}function D(t,i){var n,i,e,i,s,e,n=t.sheet;return!o(n)&&(e=(i=i(n)).cmd,i=i.selection,!I(e))&&(s=n.rt,n.Qy().execute({cmd:e,sheetName:n.name(),selections:[i],hitInfo:{x:t.x,y:t.y,row:t.row,col:t.col,cellRect:t.cellRect,sheetArea:t.sheetArea,cellStyle:t.cellStyle}}),(e=n.hitTest((s.fk||t).x,(s.fk||t).y))&&(s.cw(e),s.fw(e)),!0)}function d(){var t=null!==g&&g.apply(this,arguments)||this;return t.typeName="96",t.qu="add-column-button",t}function v(){var t=null!==h&&h.apply(this,arguments)||this;return t.typeName="97",t.qu="add-row-button",t}e=this&&this.__extends||(M=function(t,i){return(M=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}M(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.AddRowButton=i.AddColumnButton=void 0,s=n("Common"),n=n("Core"),o=s.Common.lt.ht,s=n.CellTypes.ti,c=n.CellTypes.ColumnHeader,r=n.CellTypes.RowHeader,e(d,g=c),d.prototype.getHitInfo=function(t,i,n,e,s){return{x:t,y:i,row:s.row,col:s.col,sheet:s.sheet,cellRect:e,sheetArea:s.sheetArea,isReservedLocation:!0,cellStyle:n,addRowColumnButtonHitInfo:{addRowColumnButtonType:1}}},d.prototype.processMouseMove=N,d.prototype.processMouseDown=f,d.prototype.processMouseUp=function(t){return D(t,function(t){return{cmd:t.u9e(),selection:{row:-1,rowCount:t.getRowCount(),col:t.getColumnCount(),colCount:1}}})},u=d,i.AddColumnButton=u,s[96]=u,e(v,h=r),v.prototype.getHitInfo=function(t,i,n,e,s){return{x:t,y:i,row:s.row,col:s.col,sheet:s.sheet,cellRect:e,sheetArea:s.sheetArea,isReservedLocation:!0,cellStyle:n,addRowColumnButtonHitInfo:{addRowColumnButtonType:2}}},v.prototype.processMouseMove=N,v.prototype.processMouseDown=f,v.prototype.processMouseUp=function(t){return D(t,function(t){return{cmd:t.a9e(),selection:{row:t.getRowCount(),rowCount:1,col:-1,colCount:t.getColumnCount()}}})},a=v,i.AddRowButton=a,s[97]=a,n.Worksheet.ch(l="addRowColumnButton",{init:function(){var t=this;t.c9e=new u,t.f9e=new a}})},"./dist/plugins/celltype/buttoncelltype.js":function(t,i,n){"use strict";var e,s,D,r,u,l,o,a,d,n,s,c,M,g,h,I,v,w,N,f,j,A,T;function b(t,i,n,e){var t,s,t=t.Ut;t&&(t.do("setValueForKey",i,n,h,g,e),s=t.getValueForKey(i,n,I,e))&&(clearTimeout(s),t.do("setValueForKey",i,n,I,g,e))}function y(){var t,n,t=T.call(this)||this;return t.typeName="6",n=t,c(f,function(t,i){n["_"+t]=i}),t}e=this&&this.__extends||(A=function(t,i){return(A=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}A(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.Button=void 0,s=n("Common"),D=n("Core"),r=n("./dist/plugins/celltype/cellbuttons.js"),u=D.Events.SelectionChanged,l=s.Common.lt.ht,o=D.mt.vi,a=D.CellTypes.Context,d=D.CellTypes.Text,n=D.CellTypes.Base,s=D.GC$,c=s.each,g=void 0,h="_isFirstMouseUp",I="_mouseupToken",v="#707070",w="#34B4E3",N=".buttonCellType",f={marginTop:2,marginRight:2,marginBottom:2,marginLeft:2,text:"",buttonBackColor:M=null,buttonClickColor:M,buttonState:0},e(y,T=n),y.prototype.paintValue=function(t,i,n,e,s,o,c,r){var u,a,l,M,g,h,I,N,a,l,a,f;t&&(a=(u=this)._marginLeft,l=u._marginTop,M=n+a,g=e+l,h=s-a-u._marginRight,I=o-l-u._marginBottom,0<h-2)&&0<I-2&&(N=n<M+h&&M<n+s&&e<g+I&&g<e+o)&&(t.save(),(M<n||n+s<M+h||g<e||e+o<g+I)&&(t.rect(n,e,s,o),t.clip()),t.beginPath(),t.strokeStyle!==(a=v)&&(t.strokeStyle=a),t.strokeRect(M+.5,g+.5,h-1,I-1),l=void 0,a=u._buttonState,f=u._text,l=2===a?u._buttonClickColor||w:(l=u._buttonBackColor)||{degree:90,stops:[{position:0,color:"#F6FAFB"},{position:.125,color:"#F6FAFB"},{position:1,color:"#D2DBEB"}]},t.fillStyle!==l&&(t.fillStyle=l),D.W.setFillStyle(t,l,n,e,s,o,function(){t.fillRect(M+1,g+1,h-2,I-2)}),t.restore(),f)&&d.prototype.paintValue.call(u,t,f,M,g,h,I,c,r)},y.prototype.getText=function(t,i){return t},y.prototype.j3=function(t,i,n,e){var s=t.parent;s&&s.j3(t,i,n,e)},y.prototype.getHitInfo=function(t,i,n,e,s){var o,c,r,u,a,o,e,o=this;return s&&(c=s.sheetArea,l(c)||3===c)&&e?(r=e.x+o._marginLeft,u=e.x+e.width-o._marginRight,a=e.y+o._marginTop,o=e.y+e.height-o._marginBottom,e={x:t,y:i,row:s.row,col:s.col,cellRect:e,sheetArea:c,sheet:s.sheet,cellStyle:n},r<=t&&t<=u&&a<=i&&i<=o&&(e.isReservedLocation=!0),e):M},y.prototype.processMouseDown=function(t){var i,n,i=this,n=t&&t.sheet;return!(!n||!t.isReservedLocation||i.pG||(i.pG=!0,i._buttonState=2,(0,r.XCe)(n,t.cellRect),0))},y.prototype.processMouseUp=function(t){var i,n,e,s,o,c,t,i=this,n=t&&t.sheet;if(i.pG&&n&&t.isReservedLocation){if((i._buttonState=0,r.XCe)(n,t.cellRect),i.pG=!1,e=t.row,s=t.col,o=t.sheetArea,!(c=n.Ut.getValueForKey(e,s,h,o)))return i.j3(n,e,s,o),n.Ut.do("setValueForKey",e,s,h,!0,o),t=setTimeout(function(){b(n,e,s,o)},250),n.Ut.do("setValueForKey",e,s,I,t,o),!0;b(n,e,s,o)}return!1},y.prototype.processMouseLeave=function(t){var i,n,i=this,n=t&&t.sheet;n&&i.pG&&((i._buttonState=0,r.XCe)(n,t.cellRect),i.pG=!1)},y.prototype.processKeyDown=function(t,i){var n,e,s,n=i.sheet,e=this;return!(!n||e.bG)&&(s=n.getCellRect(i.row,i.col),e._buttonState=2,n.repaint(s),n.D3(u+N,function(){n._3(u+N),e.bG=!1,e._buttonState=0,n.repaint(s)}),e.bG=!0)},y.prototype.processKeyUp=function(t,i){var n,e,s,o,c,n=i.sheet,e=this;return!(!n||!e.bG||(s=i.row,o=i.col,c=n.getCellRect(s,o),e._buttonState=0,n.repaint(c),n._3(u+N),e.j3(n,s,o,i.sheetArea),e.bG=!1))},y.prototype.isReservedKey=function(t,i){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},y.prototype.getAutoFitWidth=function(t,i,n,e,s){var o,c,o=this,c;return a.Bt(t,o._text,n,e,s)+o._marginLeft+o._marginRight},y.prototype.getAutoFitHeight=function(t,i,n,e,s){var o,c,o=this,c;return a.tn(t,o._text,n,e,s)+o._marginTop+o._marginBottom},y.prototype.QD=function(t){this.isReservedKey(t)&&o(t)},y.prototype.isImeAware=function(t){return!1},y.prototype.toJSON=function(){var n,e,s,n=this,e={typeName:n.typeName};return c(f,function(t,i){"buttonState"!==t&&(s=n["_"+t])!==i&&(e[t]=s)}),e},y.prototype.fromJSON=function(n){var e=this;c(f,function(t){var i=n[t];l(i)||(e["_"+t]=i)})},y.prototype.jn=function(t){},y.prototype.Ke=function(){},j=y,i.Button=j,c(f,function(i){j.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:(this["_"+i]=t,this)}}),D.CellTypes.ti[6]=j},"./dist/plugins/celltype/cellbuttons.js":function(n,o,t){"use strict";var b,i,t,A,W,T,y,I,c,H,V,J,F,X,f,D,g,_,z,h,K,C,q,m,$,s,d,v,w,j,p,L,x,S,u,N,a,O,i,l,k,e,t;function tt(t){switch(t){case p:return b.ButtonPosition.left;case L:return b.ButtonPosition.right;case x:return b.ButtonPosition.leftOfText;case S:return b.ButtonPosition.rightOfText}}function it(t){switch(t){case b.ButtonPosition.left:return p;case b.ButtonPosition.right:return L;case b.ButtonPosition.leftOfText:return x;case b.ButtonPosition.rightOfText:return S}}function nt(t){for(var i,n,e,i=t.split(" "),e=0;e<i.length;e++)if(0<=i[e].indexOf(s)){n=i[e];break}switch(n){case d:return p;case v:return L;case w:return x;case j:return S}}function et(t){switch(t){case p:return d;case L:return v;case x:return w;case S:return j}}function st(t,i,n,e){var t,s,t=t.Ut;t&&(t.do("setValueForKey",i,n,f,T,e),s=t.getValueForKey(i,n,D,e))&&(clearTimeout(s),t.do("setValueForKey",i,n,D,T,e))}function ot(t,i,n){var e,s;switch(n){case k.topLeft:return new b.Rect(t.x,t.y,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.topCenter:return e=(t.width-i.width)/2,e=Math.max(0,e),new b.Rect(t.x+e,t.y,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.topRight:return e=t.width-i.width,e=Math.max(0,e),new b.Rect(t.x+e,t.y,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.MiddleLeft:return s=(t.height-i.height)/2,s=Math.max(0,s),new b.Rect(t.x,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.MiddleCenter:return e=(t.width-i.width)/2,e=Math.max(0,e),s=(t.height-i.height)/2,s=Math.max(0,s),new b.Rect(t.x+e,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.MiddleRight:return e=t.width-i.width,e=Math.max(0,e),s=(t.height-i.height)/2,s=Math.max(0,s),new b.Rect(t.x+e,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.bottomLeft:return s=t.height-i.height,s=Math.max(0,s),new b.Rect(t.x,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.bottomCenter:return e=(t.width-i.width)/2,e=Math.max(0,e),s=t.height-i.height,s=Math.max(0,s),new b.Rect(t.x+e,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.bottomRight:return e=t.width-i.width,e=Math.max(0,e),s=t.height-i.height,s=Math.max(0,s),new b.Rect(t.x+e,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height))}}function M(t,i,n){for(var e,s,e=[],s=0;s<t.length;s++)e.push({width:Q(t[s].button,i,n),height:jt(t[s].button,n),isStick:t[s].button.v_i});return e}function E(t,i,n,e,s,o){for(var c,r,u,a,l,M,g,c=[],r=[],u=0;u<t.length;u++)a=i[t[u].index],A(a)?r.push(t[u]):c.push(a);for(l=ut(c),u=0;u<r.length;u++)M=Q(r[u].button,n,e),(g=!o||l.width+M<=o.width)&&(l.width+=M);return l.height=l.height||(o?o.height:0),l}function ct(t,i,n,e,s,o,c,r,u,a,l,M){var n,g,r,i,c,h,n,a,s,I,N,f,n=Y(i,n,c,r,!0,[t]);if(0<n.length){switch(Z(n,i,c),t){case b.ButtonPosition.left:g=d;break;case b.ButtonPosition.right:g=v;break;case b.ButtonPosition.leftOfText:g=w;break;case b.ButtonPosition.rightOfText:g=j;break;default:return}switch(r=E(n,a,s,e,!0,o),i="0",c=W(),((h=b.mt.Tt).mozilla||1<c)&&(i="1px"),n=r.width,a=r.height,s=it(t),A(u.canvasSizes)&&(u.canvasSizes={}),(I=u.canvasSizes)[s]={width:n,height:a},f=rt(g,n,a,N={width:n+"px",height:a+"px",display:"block",position:"absolute",bottom:i,overflow:"hidden",paddingTop:"0"}),t){case b.ButtonPosition.left:f.style.left="0";break;case b.ButtonPosition.right:f.style.right="0";break;case b.ButtonPosition.leftOfText:f.style.left="0";break;case b.ButtonPosition.rightOfText:f.style.right="0";break;default:return}l.appendChild(f)}}function rt(t,i,n,e){var s,o,s=document.createElement("canvas");for(o in s.className=t+" "+$,e)e.hasOwnProperty(o)&&(s.style[o]=e[o]);return s.width=i,s.height=n,s}function ut(t){var i,n,e,s,o;if(t.length<=0)return new b.Rect(0,0,0,0);for(i=t[0].x,n=t[0].y,e=t[0].x+t[0].width,s=t[0].y+t[0].height,o=1;o<t.length;o++)i=Math.min(i,t[o].x),n=Math.min(n,t[o].y),e=Math.max(e,t[o].x+t[o].width),s=Math.max(s,t[o].y+t[o].height);return new b.Rect(i,n,e-i,s-n)}function U(t,i,n,e,s,o,c,r){var u,c,a,l,M,g,h;if(!A(t))for(A(r[n])&&(r[n]={}),Z(i,e.sheet,e.row),u=t.getContext("2d"),c=E(i,c,s,e,!0),u.setTransform(parseFloat(t.style.width)/c.width,0,0,parseFloat(t.style.height)/c.height,0,0),M=new b.Rect(l=a=0,0,parseFloat(t.style.width),parseFloat(t.style.height)),g=0;g<i.length&&(h=B(u,a,0,Q(i[g].button,s,e),e.sheet.getRowHeight(e.row),i[g].button,s,e,o,r[n],i[g].index,M),!A(h));g++)a+=h.width}function at(n,e,s,o,c,t){var t,i,i,i,i;A(t.eventListeners)&&(t.eventListeners={}),A(t.eventListeners[e])&&(t.eventListeners[e]={}),i=(t=t.eventListeners[e]).mouseDownListener=function(t){var i;yt(r({x:t.offsetX,y:t.offsetY,context:s,cellRect:c,cellStyle:o,buttonArea:e},!0),!0,n)},n.addEventListener("mousedown",i),i=t.mouseUpListener=function(t){var i;zt(r({x:t.offsetX,y:t.offsetY,context:s,cellRect:c,cellStyle:o,buttonArea:e},!0),!0,n)},n.addEventListener("mouseup",i),i=t.mouseMoveListener=function(t){var i;Ct(r({x:t.offsetX,y:t.offsetY,context:s,cellRect:c,cellStyle:o,buttonArea:e},!0),!0,n)},n.addEventListener("mousemove",i),i=t.mouseLeaveListener=function(t){var t={x:t.offsetX,y:t.offsetY,context:s,cellRect:c,cellStyle:o,buttonArea:e};t.x<0&&(t.x=0),t.x>=parseFloat(n.style.width)&&(t.x=parseFloat(n.style.width)-1),mt(r(t,!0),!0,n)},n.addEventListener("mouseleave",i)}function lt(t,i,n,e,s,o,c,r,u,a,l,M){var i,g,h,n,I,N,f,D,i=Y(i,n,c,r,!0,[t]);if(0<i.length){switch(h=g=void 0,t){case b.ButtonPosition.left:g=d,h=p;break;case b.ButtonPosition.right:g=v,h=L;break;case b.ButtonPosition.leftOfText:g=w,h=x;break;case b.ButtonPosition.rightOfText:g=j,h=S;break;default:return}if(n=M.querySelector("."+g),!A(n)){switch(I=parseFloat(n.style.width),N=o.options.contentRect,f=o.options.leftExternalRect,D=o.options.rightExternalRect,t){case b.ButtonPosition.left:N.x+=I,N.width-=I;break;case b.ButtonPosition.right:N.width-=I;break;case b.ButtonPosition.leftOfText:f.width+=I;break;case b.ButtonPosition.rightOfText:D.width+=I}U(n,i,h,e,s,u,a,l),at(n,h,e,s,o.options.cellRect,u)}}}function Mt(t,i,n,e,s,o,c){var i,n,r,u,a,l,M,i=Y(i,n,e,s,!0,[t]);if(i&&0<i.length)switch(n=it(t),r=o&&o[n]&&o[n].width||0,u=c.contentContainer,a=c.contentRect,l=c.leftExternalRect,M=c.rightExternalRect,t){case b.ButtonPosition.left:ht(u,"left",r),a.x+=r,a.width-=r;break;case b.ButtonPosition.leftOfText:ht(u,"left",r),l.width+=r;break;case b.ButtonPosition.right:a.width-=r;break;case b.ButtonPosition.rightOfText:M.width+=r}}function gt(t){return+t.replace("px","")||0}function ht(t,i,n){var e=0;t.style[i]&&(e=gt(t.style[i])),t.style[i]="".concat((e+=n)-1,"px")}function It(t,i){A(i.mouseDownListener)||t.removeEventListener("mousedown",i.mouseDownListener),A(i.mouseUpListener)||t.removeEventListener("mouseup",i.mouseUpListener),A(i.mouseMoveListener)||t.removeEventListener("mousemove",i.mouseMoveListener),A(i.mouseLeaveListener)||t.removeEventListener("mouseleave",i.mouseLeaveListener)}function Z(t,i,n){for(var e,s,o,e=i.BO(),s=0;s<t.length;s++)(o=Ot(t[s].button,n))&&e.addImage(o)}function G(t){var i=t.isPrinting,t=t.printZoomFactor;return i&&"number"==typeof t&&1!==t}function Nt(t,i){return 2===i.columnHeaderFitMode&&i.cornerX&&(t.width=i.cornerX-t.x,t.height=t.height-(i.cornerY-t.y)-1,t.y=i.cornerY-1),t}function ft(t,i,n){switch(n){case b.ButtonPosition.leftOfText:return new b.Rect(t.x,t.y,i.x-t.x,t.height);case b.ButtonPosition.rightOfText:return new b.Rect(i.x+i.width,t.y,t.x+t.width-i.x-i.width,t.height)}}function Dt(t,i,n,e,s,o,c){var r,u,a,l,M,g,h,I,N;if(t&&!(i.length<=0)){if(s=Lt(s),Z(i,r=o.sheet,o.row),2===o.columnHeaderFitMode&&o.cornerX&&(u=o.cellRect.x+o.cellRect.width-(n.x+n.width),(n=n.clone()).width=o.cornerX-n.x-u,n.height=n.height-(o.cornerY-n.y)-1,n.y=o.cornerY-1),a=ft(n,e,c?b.ButtonPosition.leftOfText:b.ButtonPosition.rightOfText),t.save(),t.rect(a.x,a.y,a.width,a.height),t.clip(),t.beginPath(),l=P(r,o.row,o.col,o.sheetArea),M=Lt(s),A(l.layout)&&(l.layout={}),c){for(g=a.x+a.width,h=i.length-1;0<=h&&(N=B(t,g-=I=Q(i[h].button,M,o),n.y,Q(i[h].button,M,o),a.height,i[h].button,M,o,l,l.layout,i[h].index,n),!A(N));h--);e.x=g}else{for(g=a.x,h=0;h<i.length&&(N=B(t,g,n.y,Q(i[h].button,M,o),a.height,i[h].button,M,o,l,l.layout,i[h].index,n),!A(N));h++)g+=N.width;e.width=g-e.x}t.restore()}}function dt(t,i,n,e,s){if(!(t+n<s.x||t>s.x+s.width||i+e<s.y||i>s.y+s.height))return t+n>s.x+s.width&&(n=s.x+s.width-t),i+e>s.y+s.height&&(e=s.y+s.height-i),t<s.x&&(t=s.x),i<s.y&&(i=s.y),new b.Rect(t,i,n,e)}function B(t,i,n,e,s,o,c,r,u,a,l,M){var g,u,g=h;if(u.buttonDownIndex===l?g=K:u.buttonHoverIndex===l&&(g=C),u=dt(i,n,e,s=c.vAlign===b.VerticalAlign.center?M.height:s,M),!A(u))return vt(t,u.x,u.y,u.width,u.height,o,c,r,g,M),a[l]=new b.Rect(u.x,u.y,u.width,u.height),a[l].offsetX=u.x-M.x,a[l].offsetY=u.y-M.y,r.cornerY&&(a[l].offsetY+=r.cornerY),a[l]}function vt(t,i,n,e,s,o,c,r,u,a){var l,M,g,g,h,h,I,h,N,l,l,u,I,l,N,f,D,d,v,d,i,d,w,n,e,j;t.save(),t.beginPath(),l=o.useButtonStyle,M=G(r),g=r.printZoomFactor,g=M?g:r.sheet.zoom(),i+=h=l?z*g:0,n+=h,e-=2*h,s-=2*h,h=H,I=o.hoverBackColor||F,h&&t.strokeStyle!==h&&(t.strokeStyle=h),l&&t.strokeRect(i+.5,n+.5,e-1,s-1),h=kt(o.enabled,r.row),l?N=!1===o.enabled?o.buttonBackColor||J:u===K?V:u===C||r.visualState===b.VisualState.hover?I:((l=t.createLinearGradient(i+e/2,n,i+e/2,n+s)).addColorStop(.125,"#F6FAFB"),l.addColorStop(1,"#D2DBEB"),o.buttonBackColor||l):(N=o.buttonBackColor||"white",u===C&&(o.enabled||A(o.enabled))&&(N=I)),(l=c.font)&&t.font!==l&&(t.font=l),t.fillStyle!==N&&(t.fillStyle=N),t.rect(i+=1,n+=1,e-=2,s-=2),t.clip(),t.beginPath(),t.fillRect(i,n,e,s),u=new b.Rect(i,n,e,s),I=new b.Rect(i,n,e,s),l=_*g,N=Ot(o,r.row),o.caption&&N&&(f=(m.Bt(y,o.caption,c,g,r)+2*z)*g,D=At(o)*g,d=new b.Rect(0,0,f+D+l,s),d=ot(v=new b.Rect(i,n,e,s),d,k.MiddleCenter),o.captionAlign===b.CaptionAlignment.left?(I=new b.Rect(d.x,n,f,s),u=d.x+f+l<i+e-2?new b.Rect(d.x+f+l,n,Math.max(0,D),s):new b.Rect(0,0,0,0)):(u=new b.Rect(d.x,n,Math.min(D,e),s),I=d.x+D+l<i+e-2?new b.Rect(d.x+D+l,n,Math.min(e-2-D-l,f),s):new b.Rect(0,0,0,0))),o.caption&&(i=(m.Bt(y,o.caption,c,g,r)+2*z)*g,d=(m.tn(y,o.caption,c,g,r)+2*z)*g,n=ot(I,w=new b.Rect(0,0,i,d),k.MiddleCenter),e=new q,c=c.clone(),!1===h&&(c.foreColor=X),c.cellButtons=T,c.decoration=T,e.paintValue(t,o.caption,n.x,n.y-(j=M?0:2),n.width,n.height,c,r)),N&&wt(t,o,u.x,u.y,u.width,u.height,N,r,a),t.restore()}function wt(t,i,n,e,s,o,c,r,u){var a,l,a,n,s,o,M,g,r,r,M,e,n,h;t.save(),t.rect(n+2,e+2,s-4,o-4),t.clip(),t.beginPath(),(l=(a=r.sheet).BO()).getState(c)?l.qh(c)&&(a=G(r)?r.printZoomFactor:a.zoom(),n=new b.Rect(n,e,s,o),s=At(i)-2,o=Tt(i)-2,g=ot(n,M=new b.Rect(0,0,s*a,o*a),k.MiddleCenter),i.position!==b.ButtonPosition.leftOfText&&i.position!==b.ButtonPosition.rightOfText||((r=r.textRect)&&(g.y=I(r.y-r.height/2-M.height/2,e+4)),g.y+g.height>n.y+n.height&&(g.y=I(g.y-(g.y+g.height-n.y-n.height),n.y))),M=(r=l.getImage(c)).width,e=r.height,b.mt.Tt.msie&&i.imageType&&(e=i.imageType===b.ButtonImageType.custom?(N[c]||(r.style.position="absolute",r.style.left="-10000px",r.style.top="-100000px",document.body.appendChild(r),N[c]={width:r.width,height:r.height},document.body.removeChild(r)),M=N[c].width,N[c].height):M=12),u&&b.mt.Tt.msie&&g.x+g.width>u.x+u.width?0<(n=u.x+u.width-g.x)&&t.drawImage(r,0,0,n*(h=M/(s*a)),e,g.x,g.y,n,o*a):t.drawImage(r,0,0,M,e,g.x,g.y,s*a,o*a)):l.addImage(c),t.restore()}function Q(t,i,n,e){var s,o,i,c,r,n;return void 0===e&&(e=!0),s=G(n)?n.printZoomFactor:n.sheet.zoom(),o=2*z+3,A(t.width)?(i=m.Bt(y,t.caption,i,s,n),c=t.useButtonStyle,(r=Ot(t,n.row))&&(i=At(t)+i,o=(c?o:0)+_),e?(i+o+7)*s:i+o+7):(n=I(1,t.width),isNaN(n)&&(n=1),e?n*s:n)}function jt(t,i,n){var e,s,e,i,t;return void 0===n&&(n=!0),e=i.sheet,s=G(i)?i.printZoomFactor:e.zoom(),e=e.getRowHeight(i.row),i=t.imageSize?t.imageSize.height:y,t=I(1,i||e),isNaN(t)&&(t=1),n?t*s:t}function Y(t,i,n,e,s,o){var c,r,u,a,l,M,c=[];if(!i||0===i.length)return[];for(r=!1,u=t.Ut.getValueForKey(n,e,g),t.getActiveRowIndex()===n&&t.getActiveColumnIndex()===e&&!0!==u&&(r=!0),a=0;a<i.length;a++)if(l=i[a].visible,!s||!i[a].i4i)for(M=0;M<o.length;M++)(i[a].position===o[M]||A(i[a].position)&&o[M]===b.ButtonPosition.right)&&(l&&"function"==typeof l&&l(n)||i[a].visibility===b.ButtonVisibility.onEditing&&s||i[a].visibility!==b.ButtonVisibility.onEditing&&r||i[a].visibility===b.ButtonVisibility.always||A(i[a].visibility))&&c.push({index:a,button:i[a]});return c}function At(t){var i;return i=(i=t.imageSize&&("string"==typeof t.imageSize.width&&(i=c(t.imageSize.width)),"number"==typeof t.imageSize.width)?t.imageSize.width:i)===y||isNaN(i)||i<0?16:i}function Tt(t){var i;return i=(i=t.imageSize&&("string"==typeof t.imageSize.height&&(i=c(t.imageSize.height)),"number"==typeof t.imageSize.height)?t.imageSize.height:i)===y||isNaN(i)||i<0?16:i}function P(t,i,n,e,s){var o,c,o={isMouseDownReservedLocation:!1};return e===b.SheetArea.corner?o:((c=t.Ut.getValueForKey(i,n,u,e))||s||bt(t,i,n,e,c=o),c)}function bt(t,i,n,e,s){t.Ut.setValueForKey(i,n,u,s,e)}function r(t,i){var n,e,s,o,c,r,u,a,a,l,M,g,h,I,N,f,D,d,v,w,j,A,T,a,t,l,t,l;if(void 0===i&&(i=!1),n=t.context.row,e=t.context.col,s=t.cellRect,o=t.cellStyle,c=t.context,u=(r={x:t.x,y:t.y,row:n,col:e,cellRect:s,cellStyle:o,sheetArea:t.context.sheetArea,sheet:t.context.sheet,context:c}).sheet,!1!==t.cellStyle.locked&&u.isActualProtected()&&!u.NMi&&(a={row:n,col:e,sheetArea:t.context.sheetArea,isLocked:!0},b.Worksheet.et(u,"getCellActualLockedInfo",a),a.isLocked))return null;if(a=P(u,r.row,r.col,r.sheetArea,!0),l=t.cellStyle.cellButtons,!a||!l||l.length<=0)return null;if(M=a.layout,!(M=i?a.editorLayout[t.buttonArea]:M))return null;for(N in g=-1,h=r.x,I=r.y,M)if(M.hasOwnProperty(N)){if(f=void 0,D=M[N],i)f=new b.Rect(D.x,D.y,D.width,D.height);else{if(d=D.offsetX,u.parent&&!u.parent.options.scrollByPixel&&0<(v=u.frozenColumnCount())&&v<(w=u.getViewportLeftColumn(1))&&(j=u.getSpan(n,e,r.sheetArea))&&j.col<=w&&w<j.col+j.colCount)for(A=w-v,T=0;T<A;T++)d-=u.getColumnWidth(v+T+1,r.sheetArea);f=new b.Rect(s.x+d,s.y+D.offsetY,D.width,D.height)}if(f&&f.contains(h,I)){g=+N;break}}return-1!==g?r.cellButtonHitInfo={hitButtonIndex:g,buttonConfig:l[g],buttonArea:t.buttonArea}:(a=u.getCellType(r.row,r.col))&&(t=E(Y(u,l,n,e,i,[b.ButtonPosition.left]),M,o,c,!1),l=E(Y(u,l,n,e,i,[b.ButtonPosition.right]),M,o,c,!1),t=new b.Rect(s.x+t.width,s.y,s.width-t.width-l.width,s.height),l=a.getHitInfo(r.x,r.y,o,t,c))&&l.isReservedLocation&&(r.isReservedLocation=!0),r}function yt(t,i,n){var e,s,o,c,r,r,u,a,l,s,u,l,a,i,M,g;return void 0===i&&(i=!1),t&&t.cellButtonHitInfo&&(e=t.sheet,o=t.row,c=t.col,r=t.sheetArea,o===e.ui&&c===e.ci||r!==b.SheetArea.viewport||e.endEdit())&&(t.cellButtonHitInfo.buttonConfig&&(s=t.cellButtonHitInfo.buttonConfig.hasOverLay),r=P(e,o,c,t.sheetArea),t.cellButtonHitInfo&&(a=t.cellButtonHitInfo.hitButtonIndex,u=t.cellButtonHitInfo.buttonConfig),l=kt(u&&u.enabled,t.row),e)&&(!r.isMouseDownReservedLocation||s)&&u&&(l||A(l))&&0<=a&&(r.buttonDownIndex=a,r.isMouseDownReservedLocation=!0,i&&n?(s=t.cellStyle,u=r.layout,l=t.context,a=r.editorLayout,i=t.cellButtonHitInfo&&t.cellButtonHitInfo.buttonArea,M=s.cellButtons,i&&U(n,g=Y(e,M,o,c,!0,[tt(i)]),i,l,s,r,u,a)):R(e,t.cellRect),1)}function zt(t,i,n){var e,s,o,c,r,u,u,a,l,M,r,g,h,I,N,n;if(void 0===i&&(i=!1),t&&(e=t&&t.sheet,s=t.row,o=t.col,c=P(e,t.row,t.col,t.sheetArea),r=t.cellButtonHitInfo,c.isMouseDownReservedLocation)&&e){if(r&&0<=r.hitButtonIndex&&r.buttonConfig.command&&(u=r.buttonConfig.command,i||e.getActiveRowIndex()===s&&e.getActiveColumnIndex()===o||e.eR(s,o,1,1,2),"string"==typeof u?e.getParent().commandManager().execute({cmd:u,row:s,col:o,sheetName:e.name(),sheetArea:t.sheetArea}):"function"==typeof u&&u.call(y,e,s,o,t.sheetArea)),i&&0<=c.buttonDownIndex&&n&&(c.buttonDownIndex=-1,u=t.cellStyle,a=c.layout,l=t.context,M=c.editorLayout,r=r&&r.buttonArea,g=u.cellButtons,r)&&U(n,h=Y(e,g,s,o,!0,[tt(r)]),r,l,u,c,a,M),c.buttonDownIndex=-1,i||R(e,t.cellRect),c.isMouseDownReservedLocation=!1,I=t.sheetArea,!(N=e.Ut.getValueForKey(s,o,f,I)))return xt(e,s,o,I),e.Ut.do("setValueForKey",s,o,f,!0,I),n=setTimeout(function(){st(e,s,o,I)},250),void e.Ut.do("setValueForKey",s,o,D,n,I);st(e,s,o,I)}}function Ct(t,i,n){var e,s,o,o,i,c,r,u,a,l,M;void 0===i&&(i=!1),t&&(s=P(e=t&&t.sheet,t.row,t.col,t.sheetArea),o=-1,(o=t.cellButtonHitInfo?t.cellButtonHitInfo.hitButtonIndex:o)!==(A(s.buttonHoverIndex)?-1:s.buttonHoverIndex))&&(s.buttonHoverIndex=o,i?(o=t.cellStyle,i=s.layout,c=t.context,r=s.editorLayout,u=o.cellButtons,a=t.row,l=t.col,n&&pt(u,e,a,l,M=n.parentElement,c,o,s,i,r)):R(e,t.cellRect))}function R(t,i){var n,e,s,i,n,n=i.x-(0<i.x?2:0),e=i.y-(0<i.y?2:0),s=i.width+4,i=i.height+4,n=new b.Rect(n,e,s,i);t.repaint(n)}function mt(t,i,n){var e,s,i,o,c,r,u,a,l,M;void 0===i&&(i=!1),t&&t.cellButtonHitInfo&&(s=P(e=t&&t.sheet,t.row,t.col,t.sheetArea),i?(s.buttonHoverIndex=-1,0<=t.cellButtonHitInfo.hitButtonIndex&&(i=t.cellStyle,o=s.layout,c=t.context,r=s.editorLayout,u=i.cellButtons,a=t.row,l=t.col,n)&&pt(u,e,a,l,M=n.parentElement,c,i,s,o,r)):(e&&(s.buttonHoverIndex=-1,s.buttonDownIndex=-1,s.isMouseDownReservedLocation=!1),R(e,t.cellRect)))}function pt(t,i,n,e,s,o,c,r,u,a){for(var l,M,g,h,l=0;l<O.length;l++)M=it(O[l]),U(g=s.querySelector("."+et(M)),h=Y(i,t,n,e,!0,[tt(M)]),M,o,c,r,u,a)}function Lt(t){var t=t.clone(!0);return t.hAlign=b.HorizontalAlign.left,t.vAlign=b.VerticalAlign.center,t.wordWrap=!1,t.isVerticalText=!1,t.shrinkToFit=!1,t.formatter="General",t.textIndent=0,t}function xt(t,i,n,e){var s=t.parent;s&&s.j3(t,i,n,e)}function St(t,i,n,e,s){var o,c,r,o=t.Il(i,n,s);if(o&&o.cellButtons&&0<o.cellButtons.length&&0<(c=o.cellButtons.filter(function(t){return 1===t.visibility})).length){e&&t.Ut.do("setValueForKey",i,n,g,!0,s);try{r=t.getCellRect(i,n,1===s?-1:void 0,2===s?-1:void 0),t.repaint(r)}finally{e&&t.Ut.do("setValueForKey",i,n,g,T,s)}}}function Ot(t,i){var n,e,i,s,n=null,e=t.imageType;if(A(t.imageType))return null;switch(s=(i=kt(t.enabled,i))||A(i),e){case b.ButtonImageType.dropdown:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case b.ButtonImageType.left:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case b.ButtonImageType.right:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case b.ButtonImageType.clear:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case 3:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case b.ButtonImageType.ok:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case b.ButtonImageType.plus:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiM2RTZFNkUiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiNDQUNBQ0EiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case b.ButtonImageType.minus:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiM2RTZFNkUiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiNDQUNBQ0EiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+";break;case b.ButtonImageType.redo:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case b.ButtonImageType.undo:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case b.ButtonImageType.search:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case b.ButtonImageType.separator:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case b.ButtonImageType.spinLeft:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case b.ButtonImageType.spinRight:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iIzZFNkU2RSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iI0NBQ0FDQSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case b.ButtonImageType.ellipsis:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case b.ButtonImageType.expand:n=s?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==";break;case b.ButtonImageType.collapse:n=s?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=":"data:image/svg+xml;PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=";break;case b.ButtonImageType.custom:n=t.imageSrc}return n}function kt(t,i){return"function"==typeof t?t(i):t}Object.defineProperty(o,"__esModule",{value:!0}),o.XCe=void 0,b=t("Core"),i=t("Common"),t=t("./dist/plugins/celltype/celltypes.ns.js"),A=i.Common.lt.ht,W=b.Bf.Zl,T=void 0,y=null,I=Math.max,c=parseInt,H="#707070",V="#34B4E3",J="#e6e6e6",F="lightgray",X="#CACACA",f="_isFirstMouseUp",D="_mouseupToken",g="_leaveCell",h=_=0,K=z=2,C=3,q=b.CellTypes.Base,m=b.CellTypes.Context,$="gc-cell-button-canvas",d=(s="gc-editor-")+"left-cellbuttons",v=s+"right-cellbuttons",w=s+"left-of-text-cellbuttons",j=s+"right-of-text-cellbuttons",p="leftButtonArea",L="rightButtonArea",x="leftOfTextButtonArea",S="rightOfTextButtonArea",u="_cellButtonParam",N={},a=b.GC$,O=[b.ButtonPosition.left,b.ButtonPosition.right,b.ButtonPosition.leftOfText,b.ButtonPosition.rightOfText],i=new i.Common.ResourceManager(t.SR,"CellTypes"),l=i.getResource.bind(i),(t=k=k||{})[t.topLeft=0]="topLeft",t[t.topCenter=1]="topCenter",t[t.topRight=2]="topRight",t[t.MiddleLeft=3]="MiddleLeft",t[t.MiddleCenter=4]="MiddleCenter",t[t.MiddleRight=5]="MiddleRight",t[t.bottomLeft=6]="bottomLeft",t[t.bottomCenter=7]="bottomCenter",t[t.bottomRight=8]="bottomRight",b.CellTypes.Base.ch("cellButton",{beforePaintLabel:function(t){var i,n,e,s,o,c,r,u,a,l,c,M,g,h,I,N,f,D,d,i=t.options.context,n=t.options.style;if(!i.cellOverflowLayout&&n.cellButtons&&0<n.cellButtons.length&&(e=t.options.context.sheet,s=i.row,o=i.col,c=Y(e,n.cellButtons,s,o,!1,[b.ButtonPosition.left,b.ButtonPosition.right]))&&0<c.length&&(r=Lt(n),Z(c,e,t.options.context.row),u=t.ctx)){for(a=Nt(t.options.rect.clone(),i),u.save(),u.rect(a.x,a.y,a.width,a.height),u.clip(),u.beginPath(),l=a.x,c=a.x+a.width,M=P(e,i.row,i.col,i.sheetArea),A(M.layout)&&(M.layout={}),g=M.layout,h=Y(e,n.cellButtons,s,o,!1,[b.ButtonPosition.left]),I=0;I<h.length&&(N=B(u,l,a.y,Q(h[I].button,r,i),a.height,h[I].button,r,i,M,g,h[I].index,a),!A(N));I++)l+=N.width;for(f=l,l=c,I=(D=Y(e,n.cellButtons,s,o,!1,[b.ButtonPosition.right])).length-1;0<=I&&(N=B(u,l-=d=Q(D[I].button,r,i),a.y,d,a.height,D[I].button,r,i,M,g,D[I].index,a),!A(N));I--);u.restore(),(a=t.options.rect).width=a.x+a.width-(c-l)-f,a.x=f}},beforePaintText:function(t){var i,n,e,s,o,t,i=t.context,n=t.style;!i.cellOverflowLayout&&n.cellButtons&&0<n.cellButtons.length&&(e=t.context.sheet,s=i.row,o=i.col,(t=t.externals).left=t.left.concat(M(Y(e,n.cellButtons,s,o,!1,[b.ButtonPosition.leftOfText]),n,i)),t.right=t.right.concat(M(Y(e,n.cellButtons,s,o,!1,[b.ButtonPosition.rightOfText]),n,i)))},beforeFillTextArea:function(t){var i,n,e,s,o,e,c,r,u,a,i=t.style,n=i.cellButtons;i.cellButtons&&0<i.cellButtons.length&&(e=t.ctx,s=t.availRect,o=t.textRect,Dt(e,a=Y(c=(e=t.context).sheet,n,r=e.row,u=e.col,!1,[b.ButtonPosition.leftOfText]),s,o,i,e,!0))},afterFillTextArea:function(t){var i,n,e,s,o,e,c,r,u,a,i=t.style,n=i.cellButtons;i.cellButtons&&0<i.cellButtons.length&&(e=t.ctx,s=t.availRect,o=t.textRect,Dt(e,a=Y(c=(e=t.context).sheet,n,r=e.row,u=e.col,!1,[b.ButtonPosition.rightOfText]),s,o,i,e,!1))},onCreateCellEditor:function(t){var i,n,e,s,o,c,r,u,a,t,l,M,g,h,I,i=t.options.dom;if(i&&i.children&&(n=i.children[0])&&n.children&&(e=n.children[0])&&(o=(s=t.context).sheet,c=s.row,r=s.col,u=t.options.cellStyle,a=(u=A(u)?o.getActualStyle(c,r):u).cellButtons,!(A(a)||a&&a.length<=0))){for(t=t.options.cellRect,l=new b.Rect(t.x,t.y,t.width,t.height),M=P(o,c,r,s.sheetArea),A(M.layout)&&(M.layout={}),g=M.layout,h=!1,I=0;I<a.length;I++)a[I].position!==b.ButtonPosition.leftOfText&&a[I].position!==b.ButtonPosition.rightOfText||(h=!0);for(h&&(n.style.overflow="hidden"),I=0;I<O.length;I++)ct(O[I],o,a,s,u,l,c,r,M,g,i,n)}},onActivateCellEditor:function(t){var i,n,e,s,o,c,r,u,a,l,M,g,i=t.context,n=i.sheet,e=i.row,s=i.col,o=t.options.cellStyle,c=o.cellButtons;if(!(A(c)||c.length<=0))for(r=P(n,e,s,i.sheetArea),A(r.editorLayout)&&(r.editorLayout={}),u=r.layout,a=r.editorLayout,l=Lt(o),M=t.options.dom,g=0;g<O.length;g++)lt(O[g],n,c,i,l,t,e,s,r,u,a,M)},onDeactivateCellEditor:function(t){var i,n,e,s,o,n,c,r,u,a,l,M,g,i=t.context,n=i.sheet,e=i.row,s=i.col,o,n=n.getActualStyle(e,s,i.sheetArea).cellButtons;if(n&&0<n.length)for(r=(c=P(i.sheet,e,s,i.sheetArea,!0))&&c.eventListeners,a=(u=t.options.dom).querySelectorAll("."+$),l=0;l<a.length;l++)g=nt((M=a[l]).className),A(g)||A(r)||A(r[g])||(It(M,r[g]),delete c.eventListeners[g])},onUpdateContainer:function(t){var i,n,e,s,i,o,c,r,i=t.context,n=i.sheet,e=i.row,s=i.col,i=P(i.sheet,e,s,i.sheetArea,!0),o=i&&i.canvasSizes,c=t.cellStyle.cellButtons;if(!(A(c)||c.length<=0))for(t.context.preventOverflow=!c.every(function(t){return t.i4i}),r=0;r<O.length;r++)Mt(O[r],n,c,e,s,o,t)},getCellButtonHitInfo:function(t){t.paddingHitInfo=r(t)},processMouseDownOnCellPadding:function(t){yt(t)},processMouseUpOnCellPadding:function(t){zt(t)},processMouseMoveOnCellPadding:function(t){Ct(t)},processMouseLeaveOnCellPadding:function(t){mt(t)},getCellButtonAutoHeight:function(e){var s,o,t,c,t,r,s=e.context.sheet,o=e.context.row,t=e.context.col,c=e.cellStyle;c.cellButtons&&0!==c.cellButtons.length&&(t=Y(s,c.cellButtons,o,t,!1,[b.ButtonPosition.left,b.ButtonPosition.right]),r=0,t.forEach(function(t){var i,n,i=m.tn(y,t.button.caption,c,s.zoom(),e.context)-2,n;Ot(t.button,o)&&(i=I(i,At(t.button))),r=I(i,r)}),e.value=r+ +z)},getCellButtonAutoWidth:function(i){var t,n,e,s,t,o,t=i.context.sheet,n=i.context.row,e=i.context.col,s=i.cellStyle;s.cellButtons&&0!==s.cellButtons.length&&(t=Y(t,s.cellButtons,n,e,!1,[b.ButtonPosition.left,b.ButtonPosition.right,b.ButtonPosition.leftOfText,b.ButtonPosition.rightOfText]),o=0,t.forEach(function(t){o+=Q(t.button,s,i.context,!1)}),i.value=o)}}),o.XCe=R,b.Worksheet.ch(e="cellButtons",{setHost:function(){var n=this;n.bind(b.Events.EnterCell+"."+e,function(t,i){St(n,i.row,i.col,!1,i.sheetArea)}),n.bind(b.Events.LeaveCell+"."+e,function(t,i){St(n,i.row,i.col,!0,i.sheetArea)}),n.bind(b.Events.TopRowChanged+"."+e,function(t,i){St(n,i.row,i.col,!0,i.sheetArea)})},dispose:function(t){var i=this;i.unbind(b.Events.EnterCell+"."+e),i.unbind(b.Events.LeaveCell+"."+e),i.unbind(b.Events.TopRowChanged+"."+e)},processMouseDown:function(t){var i=t.hitInfo.cellTypeHitInfo;i&&i.cellButtonHitInfo&&yt(i)&&(t.r=!0)}}),b.Workbook.ch(e,{onCultureChanged:function(){l()}})},"./dist/plugins/celltype/celltypes.entry.js":function(t,i,n){"use strict";var e,s,o,c,r,u,a,l,e=this&&this.__createBinding||(Object.create?function(t,i,n,e){void 0===e&&(e=n);var s=Object.getOwnPropertyDescriptor(i,n);s&&("get"in s?i.__esModule:!s.writable&&!s.configurable)||(s={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(t,e,s)}:function(t,i,n,e){t[e=void 0===e?n:e]=i[n]}),s=this&&this.__exportStar||function(t,i){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||e(i,t,n)};Object.defineProperty(i,"__esModule",{value:!0}),i.x9e=i.ti=i.EditorType=i.Context=i.Base=void 0,c=(o=n("Core")).CellTypes.Base,r=o.CellTypes.Context,u=o.CellTypes.EditorType,a=o.CellTypes.ti,i.Base=c,i.Context=r,i.EditorType=u,i.ti=a,i.Hi=o.CellTypes.Hi,i.zi=o.CellTypes.zi,Object.defineProperty(i,"Corner",{set:function(t){t!==i.Hi.Corner&&(i.Hi.Corner=t)},get:function(){return i.Hi.Corner}}),Object.defineProperty(i,"ColumnHeader",{set:function(t){t!==i.Hi.ColumnHeader&&(i.Hi.ColumnHeader=t)},get:function(){return i.Hi.ColumnHeader}}),Object.defineProperty(i,"RowHeader",{set:function(t){t!==i.Hi.RowHeader&&(i.Hi.RowHeader=t)},get:function(){return i.Hi.RowHeader}}),Object.defineProperty(i,"Text",{set:function(t){t!==i.zi.Text&&(i.zi.Text=t)},get:function(){return i.zi.Text}}),s(n("./dist/plugins/celltype/checkboxcelltype.js"),i),s(n("./dist/plugins/celltype/buttoncelltype.js"),i),s(n("./dist/plugins/celltype/hyperlinkcelltype.js"),i),s(n("./dist/plugins/celltype/comboboxcelltype.js"),i),s(n("./dist/plugins/celltype/addrowcolumnbuttoncelltype.js"),i),n("./dist/plugins/celltype/cellbuttons.js"),s(n("./dist/plugins/celltype/editor/colorpicker.js"),i),s(n("./dist/plugins/celltype/editor/timepicker.js"),i),s(n("./dist/plugins/celltype/editor/calendar.js"),i),s(n("./dist/plugins/celltype/editor/calculator.js"),i),s(n("./dist/plugins/celltype/editor/monthPicker.js"),i),s(n("./dist/plugins/celltype/editor/listControl.js"),i),s(n("./dist/plugins/celltype/dropdown-action.js"),i),s(n("./dist/plugins/celltype/radiochecklistcelltype.js"),i),s(n("./dist/plugins/celltype/celltypes.ns.js"),i),s(n("./dist/plugins/celltype/rangecelltype.js"),i),s(n("./dist/plugins/celltype/dataobjectcelltype.js"),i),s(n("./dist/plugins/celltype/editor/popupControl.js"),i),s(n("./dist/plugins/celltype/fileUploadCellType/fileUploadCellType.js"),i),l=n("./dist/plugins/celltype/fileUploadCellType/utils.js"),Object.defineProperty(i,"x9e",{enumerable:!0,get:function(){return l.x9e}})},"./dist/plugins/celltype/celltypes.ns.js":function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.SR=void 0;var n=n("./dist/plugins/celltype/celltypes.res.en.js");i.SR={en:n}},"./dist/plugins/celltype/celltypes.res.en.js":function(t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Calendar_BuiltIn_Yesterday=i.Calendar_BuiltIn_Today=i.Calendar_Today=i.Calendar_FirstYear=i.Calendar_EraName_4=i.Calendar_EraName_3=i.Calendar_EraName_2=i.Calendar_EraName_1=i.Calendar_Time_PM=i.Calendar_Time_AM=i.Calendar_Months_12=i.Calendar_Months_11=i.Calendar_Months_10=i.Calendar_Months_9=i.Calendar_Months_8=i.Calendar_Months_7=i.Calendar_Months_6=i.Calendar_Months_5=i.Calendar_Months_4=i.Calendar_Months_3=i.Calendar_Months_2=i.Calendar_Months_1=i.Calendar_ShortMonths_12=i.Calendar_ShortMonths_11=i.Calendar_ShortMonths_10=i.Calendar_ShortMonths_9=i.Calendar_ShortMonths_8=i.Calendar_ShortMonths_7=i.Calendar_ShortMonths_6=i.Calendar_ShortMonths_5=i.Calendar_ShortMonths_4=i.Calendar_ShortMonths_3=i.Calendar_ShortMonths_2=i.Calendar_ShortMonths_1=i.Calendar_Weeks_7=i.Calendar_Weeks_6=i.Calendar_Weeks_5=i.Calendar_Weeks_4=i.Calendar_Weeks_3=i.Calendar_Weeks_2=i.Calendar_Weeks_1=i.Calendar_ShortWeeks_7=i.Calendar_ShortWeeks_6=i.Calendar_ShortWeeks_5=i.Calendar_ShortWeeks_4=i.Calendar_ShortWeeks_3=i.Calendar_ShortWeeks_2=i.Calendar_ShortWeeks_1=i.Cancel=i.OK=void 0,i.FileUpload_Title=i.DataObject_MeetTable=i.DataObject_MeetSpan=i.DataObject_MeetLock=i.MultiColumn_InvalidDataSource=i.Calculator_OverFlowInfo=i.Calculator_SqrtParameterException=i.Calculator_InvalidInputInfo=i.Calculator_DivideByZeroInfo=i.StandardColor=i.ThemeColor=i.Quarter_Format_4=i.Quarter_Format_3=i.Quarter_Format_2=i.Quarter_Format_1=i.Calendar_NextTenYear=i.Calendar_LastTenYear=i.Calendar_NextYear=i.Calendar_LastYear=i.Calendar_NextMonth=i.Calendar_LastMonth=i.Calendar_BuiltIn_LastMonth=i.Calendar_BuiltIn_ThisMonth=i.Calendar_BuiltIn_Last7Days=void 0,i.OK="OK",i.Cancel="Cancel",i.Calendar_ShortWeeks_1="MON",i.Calendar_ShortWeeks_2="TUE",i.Calendar_ShortWeeks_3="WED",i.Calendar_ShortWeeks_4="THU",i.Calendar_ShortWeeks_5="FRI",i.Calendar_ShortWeeks_6="SAT",i.Calendar_ShortWeeks_7="SUN",i.Calendar_Weeks_1="Monday",i.Calendar_Weeks_2="Tuesday",i.Calendar_Weeks_3="Wednesday",i.Calendar_Weeks_4="Thursday",i.Calendar_Weeks_5="Friday",i.Calendar_Weeks_6="Saturday",i.Calendar_Weeks_7="Sunday",i.Calendar_ShortMonths_1="JAN",i.Calendar_ShortMonths_2="FEB",i.Calendar_ShortMonths_3="MAR",i.Calendar_ShortMonths_4="APR",i.Calendar_ShortMonths_5="MAY",i.Calendar_ShortMonths_6="JUN",i.Calendar_ShortMonths_7="JUL",i.Calendar_ShortMonths_8="AUG",i.Calendar_ShortMonths_9="SEP",i.Calendar_ShortMonths_10="OCT",i.Calendar_ShortMonths_11="NOV",i.Calendar_ShortMonths_12="DEC",i.Calendar_Months_1="JANUARY",i.Calendar_Months_2="FEBRUARY",i.Calendar_Months_3="MARCH",i.Calendar_Months_4="APRIL",i.Calendar_Months_5="MAY",i.Calendar_Months_6="JUNE",i.Calendar_Months_7="JULY",i.Calendar_Months_8="AUGUST",i.Calendar_Months_9="SEPTEMBER",i.Calendar_Months_10="OCTOBER",i.Calendar_Months_11="NOVEMBER",i.Calendar_Months_12="DECEMBER",i.Calendar_Time_AM="AM",i.Calendar_Time_PM="PM",i.Calendar_EraName_1="M",i.Calendar_EraName_2="T",i.Calendar_EraName_3="S",i.Calendar_EraName_4="H",i.Calendar_FirstYear="1",i.Calendar_Today="Today",i.Calendar_BuiltIn_Today="Today",i.Calendar_BuiltIn_Yesterday="Yesterday",i.Calendar_BuiltIn_Last7Days="Last 7 Days",i.Calendar_BuiltIn_ThisMonth="This Month",i.Calendar_BuiltIn_LastMonth="Last Month",i.Calendar_LastMonth="Go to previous month",i.Calendar_NextMonth="Go to next month",i.Calendar_LastYear="Go to previous year",i.Calendar_NextYear="Go to next year",i.Calendar_LastTenYear="Go to previous ten years",i.Calendar_NextTenYear="Go to next ten years",i.Quarter_Format_1="Q1",i.Quarter_Format_2="Q2",i.Quarter_Format_3="Q3",i.Quarter_Format_4="Q4",i.ThemeColor="Theme Colors",i.StandardColor="Standard Colors",i.Calculator_DivideByZeroInfo="Cannot divide by zero.",i.Calculator_InvalidInputInfo="Invalid Input.",i.Calculator_SqrtParameterException="Invalid input for function.",i.Calculator_OverFlowInfo="Arithmetic operation resulted in an overflow.",i.MultiColumn_InvalidDataSource="Invalid data source. The formula should return an array.",i.DataObject_MeetLock="Cannot insert data because there's a locked cell in the way.",i.DataObject_MeetSpan="Cannot insert data because there's a merged cell in the way.",i.DataObject_MeetTable="Cannot insert data because a table in the way.",i.FileUpload_Title="+ Upload"},"./dist/plugins/celltype/checkboxcelltype.js":function(U,t,i){"use strict";var n,e,b,s,a,v,c,u,i,d,o,w,r,l,M,y,g,h,j,A,T,z,C,I,N,Z,f,G,D,m,p,L,B,x,S,O,k,e,Q;function Y(t,i,n,e){var t,s,t=t.Ut;t&&(t.do("setValueForKey",i,n,p,l,e),s=t.getValueForKey(i,n,L,e))&&(clearTimeout(s),t.do("setValueForKey",i,n,L,l,e))}function E(){var t,n,t=Q.call(this)||this;return t.typeName="5",t._boxSize=x,t.Jtu=!0,n=t,o(S,function(t,i){n["_"+t]=i}),t}function P(t){return 5*t}function R(t,i,n,e,s,o,c,r){var u,a,l,M,g,h,I,n,N,f,D,d,v,w,j,c,A,a,e,T,i,u=5*c,a=i.hAlign,l=n.x,M=n.width,g=0,h=i.vAlign,I=n.y,n=n.height,N=0,f=0,D=1<e.split("\n").length,d=l,v=I,w=M,j=n,c=x*c;return 0===t||1===t?(1===a?g=l+M/2-c/2:w=2===a?(g=l+M-u-c,M-u+2):(d=(g=l+u)-1,M-u+1),j=(a=b.q.un(e,A=w-3-1,i.font)).length*o,D=D||1<a.length,N=c+j,v=0===t?(1===h?(f=I+n/2-N/2+j-3,j+=6):f=2===h?I+n-u-N+j:I+u+j,f-j):(1===h?(f=I+n/2-N/2-3,j+=6):f=2===h?I+n-u-N:I+u,f+c)):(f=1===h?I+n/2-c/2:2===h?I+n-u-c:I+u,i=o/2-(e=y(r.fontInfo.fontSize))/2+(T=8<e?Math.floor((e-8)/5+2):1)-1,D=D||M-c-u-4<s,w=M-c-u,2===h?j=n+i+2-u:0===h&&(j=n-((v=I-(2+i)+u)-I)),2===t?(g=l+M-u-c,w=M-c):d=(g=l+u)+c+1),{multiLine:D,startX:g,startY:f,textX:d,textY:v,textW:w,textH:j}}function W(t,i,n,e,s){var o,i,c,n,r,u,o=5*s,i=i.hAlign,c=n.x-1,n=n.width+1,r=0,u=0;return 0===t||1===t?(u=c+o,1===i?u=c+n/2-x*s/2:2===i&&(u=c+n-o-x*s)):2===t?(r=x*s+e,u=c+o+e,1===i?u=c+n/2-r/2+e:2===i&&(u=c+n-o-r+e)):(r=x*s+e,u=c+o,1===i?u=c+n/2-r/2:2===i&&(u=c+n-o-r)),u-c}function H(t,i,n,e,s){var o,i,c,n,r,u,o=5*s,i=i.vAlign,c=n.y-1,n=n.height+1,r=0,u=0;return 0===t?(r=x*s+e,u=c+o+e,1===i?u=c+n/2-r/2+e:2===i&&(u=c+n-o-r+e)):1===t?(r=x*s+e,u=c+o,1===i?u=c+n/2-r/2:2===i&&(u=c+n-o-r)):(u=c+o,1===i?u=c+n/2-x*s/2:2===i&&(u=c+n-o-x*s)),u-c}function V(t,i,n,e,s){var o,o,o;t.enable()&&(o=i.getValue(n,e,s),o=t.wG(o),o={cmd:"editCell",sheetName:i.name(),row:n,col:e,newValue:o,autoFormat:!0},i.Qy().execute(o),t.j3(i,n,e,s))}function J(t,i,n,e,s){var o,c;!1!==t.enable()&&(o=s&&s.sheet,c=t.getEditorValue(i,s),t.setEditorValue(i,c,s),t.updateEditor(i,n,e,s),t.j3(o,o.ui,o.ci,s.sheetArea))}n=this&&this.__extends||(k=function(t,i){return(k=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}k(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.CheckBox=t.CheckBoxTextAlign=void 0,e=i("Common"),b=i("Core"),s=b.mt.En,a=e.Common.lt.ht,v=b.mt.vt,c=b.mt.vi,u=b.CellTypes.Context,i=b.CellTypes.Base,d=b.GC$,o=d.each,w=b.mt.yt,r=null,l=void 0,M=Math.max,y=parseInt,g="position",h="absolute",j="font",A="left",T="right",z="top",C="alphabetic",I=".gcEditingInput",N="background-color",Z="white",f="green",G="div",D="normal 11pt calibri",m="white-space",p="_isFirstMouseUp",L="_mouseupToken",(e=B=t.CheckBoxTextAlign||(t.CheckBoxTextAlign={}))[e.top=0]="top",e[e.bottom=1]="bottom",e[e.left=2]="left",e[e.right=3]="right",S={caption:"",textTrue:"",textIndeterminate:"",textFalse:"",textAlign:3,isThreeState:!(x=12),boxSize:x},n(E,Q=i),E.prototype.Poe=function(t,i,n,e,s,o,c,r){var u=this,a=y(n.startX),l=y(n.startY),M=y(n.textX),g=y(n.textY),h=y(n.textW),n=y(n.textH);u.Goe(t,a,l,s,o,c),u.paintText(t,i,M,g,h,n,r,e,i,null)},E.prototype.Goe=function(t,i,n,e,s,o){t.save(),t.strokeStyle=this.Jtu?"black":"#B3B3B3",t.strokeRect(i+.5,n+.5,2*e+.05,2*e+.05),t.fillStyle=Z,t.fillRect(i+1,n+1,2*e-1,2*e-1),this._isThreeState&&a(o)?(t.beginPath(),t.fillStyle=f,t.rect(i+3*s,n+3*s,2*(e-2.5*s),2*(e-2.5*s)),t.fill()):!0==!!o&&(t.beginPath(),t.lineWidth=2.5*s,t.moveTo(i+3*s,n+e),t.lineTo(i+e,n+2*e-3.5*s),t.lineTo(i+2*e-1.5*s,n+3*s),t.stroke()),t.restore()},E.prototype.paintValue=function(t,i,n,e,s,o,c,r){var u,a,l,M,g,h,I,N,f,f,D,d,D,d,D,s,o,o,s,D,n,o,e,s,u,a,c;t&&(t.save(),t.rect(n,e,s,o),t.clip(),t.beginPath(),u=c.hAlign,a=c.font,l=c.foreColor,g=(M=this)._textAlign,h=M.getText(i,r),N=I=0,(f=r.sheet)&&(I=f.Qt(h,a),N=v(a)),f=f.zoom(),D=r.isPrinting,d=r.printZoomFactor,++n,++e,--s,--o,d=(D=this.CG(N,f=D&&"number"==typeof d&&1!==d?d:f)).radius,D=D.scaleFactor,s=new b.Rect(n,e,s,o),c.wordWrap&&(o=R(g,c,s,h,I,N,f*D,r)).multiLine?M.Poe(t,h,o,r,d,f,i,c):(o=W(g,c,s,I,f*D),s=H(g,c,s,N,f*D),D=y((n+o).toString()),n=y((e+s).toString()),o=A,e=D+1,1===u?(o="center",e+=d):2===u&&(o=T,e+=2*d),a&&t.font!==a&&b.mt.bt(t,a),l&&(t.fillStyle=l),s=c.textDecoration,c=N/2-(u=parseInt(r.fontInfo.fontSize,10))/2+(a=8<u?Math.floor((u-8)/5+2):1)-1,t.textBaseline!==C&&(t.textBaseline=C),2===g?(t.textAlign=T,t.fillText(h,D+1-2,n+d+N/2-c),s&&M.le(t,s,D+1-2,n+d+N/2-c,I,u,a)):0===g&&(t.textAlign=o,t.fillText(h,e,n-2-c),s)&&M.le(t,s,e,n-2-c,I,N),M.Goe(t,D,n,d,f,i),l&&(t.fillStyle=l),3===g?(t.textAlign=A,t.fillText(h,D+1+2*d+2,n+d+N/2-c),s&&M.le(t,s,D+1+2*d+2,n+d+N/2-c,I,u,a)):1===g&&(t.textAlign=o,t.fillText(h,e,n+2*d+2+N-c),s)&&M.le(t,s,e,n+2*d+2+N-c,I,u,a)),t.restore())},E.prototype.CG=function(t,i){var n,e,s,o,n,e=this._boxSize,s=x/2,o=1;return"auto"===e&&(s=t/4,o=t/2/x),"number"==typeof e&&0<e&&(s=i*e/2,o=e/x),{radius:s,scaleFactor:o}},E.prototype.bi=function(t,i,n){var e,i,t,s,o,c,e,i=i.font,t=this.getText(t,n),s=0,o;return n.sheet&&(s=v(i),t)&&(s*=(c=t.split(/\r\n|\r|\n/)).length),s},E.prototype.getText=function(t,i){return this.SG(t)},E.prototype.focus=function(t,i){t&&t.parentNode.focus()},E.prototype.createEditorElement=function(t,i){var n,n,n,i,t,e,e,i,n=t&&t.sheet&&t.sheet.parent&&t.sheet.parent.Ti,n=b.mt.gi(n)+1e3;return d(i).css("z-index",n).attr("tabindex",1).attr("gcUIElement","gcEditingInput"),(n=d(i.firstChild)).css("overflow","hidden"),(i=d(s("input"))).attr("type","checkbox"),i.attr("class","gc-checkbox-cell-type-input"),e=(t=this.TG(t))/x,i.css("transform","scale("+e+")"),n.append(i),(e=d(s("span"))).css(g,h).css(j,w(D)).css("cursor","default").css(m,"nowrap").css("word-break","break-all"),n.append(e),(i=d(s(G))).css(g,h).css(N,f).css("width",2*(t/2-2.5)).css("height",2*(t/2-2.5)),n.append(i),r},E.prototype.TG=function(t){var i,n,i,e,i=t.sheet,n=i.zoom();return"number"==typeof this._boxSize&&0<this._boxSize?this._boxSize*n:"auto"===this._boxSize?(e="",e=(i=i.Z_(t.row,t.col))&&i.font?i.font:D,n*v(e)/2):x/2},E.prototype.wG=function(t){var t,t=this._isThreeState?!a(t)&&(!0!=!!t||r):!t;return t},E.prototype.setEditorValue=function(t,i,n){var t,e,s,t,o,n,c,r,u;t&&this.Jtu&&(e=(t=t.parentNode.children)[0],s=t[1],t=t[2],e)&&s&&t&&(o=this,u=r=void 0,(c=(n=n&&n.sheet)&&n.Ai)||(u=o.wG(i)),o._isThreeState?a(u)?(r=!1,d(t).show()):(r=!!u,d(t).hide()):r=!!u,e.checked=r,d(s).text(o.SG(u)))},E.prototype.getEditorValue=function(t,i){if(t){var t=t.parentNode.children,n=t[0],e=t[1],t=t[2];if(n&&e&&t&&(!this._isThreeState||!d(t).isVisible()))return n.checked}return r},E.prototype.j3=function(t,i,n,e){var s=t.parent;s&&s.j3(t,i,n,e)},E.prototype.activateEditor=function(i,n,e,s){var t,t,o,t=s&&s.sheet;i&&t&&(t=d(i.parentNode.parentNode),o=this,t.bind("mousedown"+I,function(t){c(t)}),t.bind("mouseup"+I,function(){J(o,i,n,e,s)}),t.bind("keydown"+I,function(t){var i=t.keyCode;if(!t.ctrlKey&&!t.shiftKey&&!t.altKey){if(32===i)return o.AG=!0,c(t),!1;8===i&&c(t)}}),t.bind("keyup"+I,function(t){!o.AG||32!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||(o.AG=!1,J(o,i,n,e,s))}),d(i).bind("click",function(t){c(t)}))},E.prototype.updateEditor=function(t,i,n,e){var s,o,t,c,r,u,c,t,u,a,l,M,g,a,l,o,s,h,a,u,e,I,N,n,l,N,n,r,f,D,M,u,s=e&&e.sheet;t&&s&&(o=s.Dn,r=(c=(t=t.parentNode).children)[0],u=c[1],c=c[2],r)&&u&&c&&(d(t).width(n.width).height(n.height),u=(t=d(u)).text(),a=i.foreColor,l=i.font,M=i.hAlign,g=i.textDecoration,a&&t.css("color",a),a=void 0,a=l||o.Nn(),1<(l=s.zoom())&&(a=o._n(a)),t.css(j,w(a)),o=s.Gi(u,a),s=v(a),u&&(s*=(h=u.split(/\r\n|\r|\n/)).length),N=W(u=(a=this)._textAlign,i,n,o,l*(I=(e=this.TG(e))/x)),n=H(u,i,n,s,l*I),d(r).css("margin-left",N).css("margin-top",n),l=r.offsetLeft,N=r.offsetTop,n=r.offsetWidth,r=r.offsetHeight,(D=f=0)===u?(f=l,1===M?f=l+e/2-o/2:2===M&&(f=l+e-o),D=N-s,f-=(I-1)*x/2,D-=(I-1)*x/2):1===u?(f=l,1===M?f=l+e/2-o/2:2===M&&(f=l+e-o),D=N+r,f-=(I-1)*x/2,D+=(I-1)*x/2):(2===u?(f=l-o-2,D=N+e/2-s/2,f-=(I-1)*x/2):(f=l+n+2,D=N+e/2-s/2,f+=(I-1)*x/2),D-=(I-1)*x/2),t.css(A,f).css(z,D),i.wordWrap?t.css(m,"normal"):t.css(m,"nowrap"),a._isThreeState?(M=l+(n-c.offsetWidth)/2,u=N+(r-c.offsetHeight)/2,d(c).css(A,M).css(z,u).toggle().toggle()):d(c).hide(),g)&&a.Qe(t,g)},E.prototype.SG=function(t){var i=this,n=i._caption;return i._isThreeState&&a(t)?i._textIndeterminate||n:!0==!!t?i._textTrue||n:i._textFalse||n},E.prototype.getHitInfo=function(t,i,n,e,s){if(s&&this.Jtu){var o=s.sheetArea;if(a(o)||3===o)return{x:t,y:i,row:s.row,col:s.col,cellRect:e,sheetArea:3,isReservedLocation:!0,sheet:s.sheet,cellStyle:n}}return r},E.prototype.processMouseDown=function(t){if(!t)return!1;t.isReservedLocation&&(this.pG=!0)},E.prototype.processMouseUp=function(t){var i,n,e,s,o,c,t,i=this,n=t&&t.sheet;if(n&&i.pG&&t.isReservedLocation){if(i.pG=!1,e=t.row,s=t.col,o=t.sheetArea,!(c=n.Ut.getValueForKey(e,s,p,o)))return V(i,n,e,s,o),n.Ut.do("setValueForKey",e,s,p,!0,o),t=setTimeout(function(){Y(n,e,s,o)},250),n.Ut.do("setValueForKey",e,s,L,t,o),!0;Y(n,e,s,o)}return!1},E.prototype.processMouseLeave=function(t){if(!t)return!1;this.pG=!1},E.prototype.isReservedKey=function(t,i){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},E.prototype.processKeyUp=function(t,i){return V(this,i.sheet,i.row,i.col,i.sheetArea),!0},E.prototype.getAutoFitWidth=function(t,i,n,e,s){var o,c,r,t,n,o=this,c=o._textAlign,r=u.Bt(t,o.SG(t),n,e,s),t=o.bi(t,n,s),n=2*o.CG(t,e).radius;return 0===c||1===c?r=M(r,n):r+=n,r+5+2},E.prototype.getAutoFitHeight=function(t,i,n,e,s){var o,c,r,r,t,n,o=this,c=o._textAlign,r=o.SG(t),r=u.tn(r,r,n,e,s),t=o.bi(t,n,s),n=2*o.CG(t,e).radius;return 0===c||1===c?r+=n:r=M(r,n),r+5},E.prototype.QD=function(t){this.isReservedKey(t)&&c(t)},E.prototype.isImeAware=function(t){return!1},E.prototype.Ke=function(){},E.prototype.Je=function(t){var t={caption:t.caption,textTrue:t.textTrue,textIndeterminate:t.textIndeterminate,textFalse:t.textFalse,textAlign:t.textAlign&&B[t.textAlign],isThreeState:t.isThreeState,boxSize:t.boxSize};this.fromJSON(t)},E.prototype.toJSON=function(){var n,e,s,n=this,e={typeName:n.typeName};return o(S,function(t,i){(s=n["_"+t])!==i&&(e[t]=s)}),e},E.prototype.fromJSON=function(n){var e=this;o(S,function(t){var i=n[t];a(i)||(e["_"+t]=i)})},E.prototype.Tfe=function(t){var i,n=this._textAlign;return 2===n||3===n?x*t+5*t:0},E.prototype.enable=function(t){if(!(0<arguments.length))return this.Jtu;this.Jtu=Boolean(t)},O=E,t.CheckBox=O,o(S,function(i){O.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:("boxSize"===i&&("number"==typeof t&&0<t&&(this["_"+i]=t),"auto"!==t)||(this["_"+i]=t),this)}}),b.CellTypes.ti[5]=O},"./dist/plugins/celltype/comboboxcelltype.js":function(s,t,i){"use strict";var o,G,d,B,l,M,Q,a,r,g,c,Y,P,R,W,h,I,v,u,N,f,D,w,H,V,J,F,j,A,T,b,X,y,z,C,_,K,m,p,q,$,tt,L,it,nt,x,et,S,st,ot,ct,O,rt,ut,at,lt,Mt,gt,ht,It,Nt,k,ft,Dt,dt,vt,wt,jt,i,At;function E(t,i){t.appendChild(i)}function Tt(t,i){t.removeChild(i)}function U(t){return t&&t.parentNode.parentNode.comboBox}function bt(t,i,n,e){var s=t.cellPadding,o=0,t=t.labelOptions;return(s=n?t?t.margin:"0":s)&&(o=typeof(o=parseInt(zt(s)[i],10))===V&&0<o?o:0),e===I?o:o*e}function n(t,i,n,e,s,o,c,r,u){var a,i,u,t,n,e,n,t,u,a=this;a.xG=t,a.sfe=i,a.dfe=u,i=t.firstChild,g(t).bind(f,function(t){a.NG(t)}).css([q,A,T,z,C,"overflow"],[c||0,n,e,s,o,"visible"]).attr([b],["gcComboBox"]),u=v(0,s-17),a._editable=!1,a.DG=t=l(x),a._G=n=l("textarea"),E(i,a.EG=t),yt(t),yt(n),g(n).bind("keyup",function(){var t,i,t=a.EG.value;a._text=t,i=a.jG(t),a.editorValue(i),a.OG(t,!0,i),a.RG()}).bind(D,function(){a.BG()}).bind(w,function(){a.RG()}),g(t).bind(N,function(){a.LG?a.ki(k,{isMouse:!0}):a.PG()}).bind(D,function(){a.BG()}).bind(w,function(){a.RG()}),a.GG(0,0,u,o),E(i,e=a.UG=l(x)),g(e).css([ot,J,p,K],[y,F,L,tt]).attr(b,"gcDropDownButton").bind(N,function(){var t,i;!M(a.HG)&&(t=a.HG,a.HG=I,(i=(new Date).valueOf())-t<100)||(a.LG?a.ki(k,{isMouse:!0}):a.PG())}),n=l("canvas"),a.fg=n,a.zG(u,0,s-u,o),E(e,n),E(i,t=a.VG=l(x)),a.YG=!1,a.ZG=r||s,g(t).css([J,ot,p,q,_,$,"cursor",K,C,ct],[F,"1px solid",L,c||0,y,y,"default",tt,o,a.ZG+O]),g(t).attr(b,"gcDropDownWindow").attr(X,-1),a.WG(0,+o),a.QG=0,E(t,u=a.KG=l(x)),a.JG=new d.x4(t,u),a._itemHeight=22,a.qG=20,a.$G=-1,a._editorValueType=0,a._items=[],a.eU=ft,a.iU=""}function yt(t){g(t).css(["margin","overflow","resize",J,"padding",_,p,"white-space",K,ot],[0,"hidden",y,F,ht+"px 0px 0px "+gt+O,y,L,"nowrap",tt,y]).attr(b,"gcComboBoxEditor").attr(X,-1)}function e(){var t,n,t=At.call(this)||this;return t.typeName="7",t.v6=!1,t.rU=!1,n=t,c(dt,function(t,i){n["_"+t]=i="items"===t?[]:i}),t}function zt(t){var i,t,n,e,s,i=["0","0","0","0"];return typeof t===H&&(s=e=void 0,1===(n=(t=t.split(" ",4)).length)?i=[e=t[0],e,e,e]:2===n?i=[e=t[0],s=t[1],e,s]:3===n?(s=t[1],i=[t[0],s,t[2],s]):4===n&&(i=[t[0],t[1],t[2],t[3]])),i}function Z(t,i){return t.hasOwnProperty(i)}o=this&&this.__extends||(jt=function(t,i){return(jt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}jt(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.ComboBox=t.EditorValueType=void 0,G=i("Common"),d=i("Core"),B=d.CellTypes.Base,l=d.mt.En,M=G.Common.lt.ht,Q=G.Common.ft,a=d.mt,r=a.vi,g=d.GC$,c=g.each,Y=a.yt,P=a.Ct,R=a.M0,W=document,h=null,I=void 0,v=Math.max,u=parseInt,N="click",f="keydown",D="mouseover",w="mouseout",H="string",V="number",J="position",F="absolute",j="font",A="left",T="top",b="gcUIElement",X="tabindex",y="none",z="width",C="height",_="outline",K="box-sizing",m="color",p="background-color",q="z-index",$="display",tt="content-box",L="white",it="black",nt="title",x="div",et="span",S="text",st="value",ot="border",ct="min-width",O="px",rt=a.wt,(i=ut=t.EditorValueType||(t.EditorValueType={}))[i.text=0]="text",i[i.index=1]="index",i[i.value=2]="value",at=17,ht=gt=1,It=gt,Nt=18,k="EndEdit.gcEditingInput",ft="lightgrey",dt={editorValueType:Mt=0,items:h,itemHeight:22,editable:!(Dt="#1E90FF"),maxDropDownItems:lt=20,allowFloat:!0},n.prototype.getComboBox=function(){return this.xG},n.prototype.dispose=function(){var t=this;g(t.xG).unbind(f),g(t._G).unbind("keyup").unbind(D).unbind(w),g(t.DG).unbind(N).unbind(D).unbind(w),g(t.UG).unbind(N),g(t.KG).find("div").forEach(function(t){g(t).unbind(D).unbind(w).unbind(N)}),t.JG.dispose()},n.prototype.updateLocationAndSize=function(t,i,n,e,s){var o,c,o=this,c=v(0,n-17);o.GG(0,0,c,e),o.zG(c,0,n-c,e),o.WG(0,+e+(s||0))},n.prototype.updateStyle=function(t,i,n){var e=this;n=Y(n),t=t||I,g(e.EG).css(p,t).css(m,i).css(j,n),g(e.UG).css(p,t).css(m,i).css(j,n),g(e.VG).css(p,t).css(m,i).css(j,n),e.iU=i,g(e.xG).css(p,"transparent"),e.eU=Q.Tv(Q._(t),Q._(ft))?L:ft},n.prototype.updateImeMode=function(t){g(this.EG).css("ime-mode",t)},n.prototype.editorValueType=function(t){return 0===arguments.length?this._editorValueType:(this._editorValueType=t,this)},n.prototype.editorValue=function(t){var i,n,i=this;return 0===arguments.length?i.oU:(t!==i.oU&&(i.oU=t,n=i.aU(t),i.text(n),i.OG(n,!0,t)),i)},n.prototype.aU=function(t){var i,n=this,e=n._items,s=e.length,o=n._editorValueType,c,r,u;if(n.uU=!0,1===o)(i=(c=e[t])&&Z(c,S)?c.text:c)===I&&(i=t,n.uU=!1);else if(0===o){for(i=t,u=0;u<s&&!((c=e[u])&&Z(c,S)&&c.text===t||c===t);u++);s<=u&&(n.uU=!1)}else if(2===o){for(r=0;r<s;r++)if((c=e[r])&&Z(c,st)&&c.value===t){i=c.text;break}s<=r&&(i=t,n.uU=!1)}return i=M(t)?"":i},n.prototype.jG=function(t){var i,n,e,i,s,o,c,r,i=this,n=i._items,e=n.length,i=i._editorValueType,s=t;if(1===i)for(c=0;c<e;c++)((o=n[c])&&Z(o,S)&&o.text===t||o===t)&&(s=c);else if(2===i)for(r=0;r<e;r++)(o=n[r])&&Z(o,S)&&o.text===t?s=o.value:o===t&&(s=I);return s},n.prototype.OG=function(t,i,n){var e,s,o,c,r,u,a,l,s=-1;if(!M(t)&&""!==t)for(c=(o=this._items).length,e=0;e<c;e++)if(a=u=void 0,u=Z(r=o[e],S)?r.text:r,Z(r,st)&&(a=r.value),(l=i?u:u.toString().substr(0,t.length))===t){if(s=e,M(n))break;if(!M(a)&&a===n)break}this.sU(s)},n.prototype.RG=function(){g(this.EG).removeAttr(nt)},n.prototype.BG=function(){var t,i,n,e,t=this,i=t.Wt(t._text),n=g(t.EG),e;n.width()+gt<i?n.attr(nt,t._text):n.removeAttr(nt)},n.prototype.GG=function(t,i,n,e){n-=0,e-=0,g(this.EG).css(A,t).css(T,i).css(z,n-gt).css(C,e-ht)},n.prototype.editable=function(t){var i,n,e,s,o,s,i=this;return 0===arguments.length?i._editable:i._editable!==t?(i._editable=t,n=i.xG.firstChild,e=i.EG,s=g(e),o={left:u(s.css(A)),top:u(s.css(T)),width:u(s.css(z)),height:u(s.css(C))},s={backColor:s.css(p),foreColor:s.css(m),font:e.style.font},Tt(n,e),i.EG=t?i._G:i.DG,E(n,i.EG),g(i.EG).css(p,s.backColor).css(m,s.foreColor).css(j,s.font),i.GG(o.left,o.top,o.width,o.height),i):void 0},n.prototype.text=function(t){var i=this,n=i.EG;if(0===arguments.length)return i._text;t!==i._text&&(i._text=t,i._editable?n.value=t:n.textContent=t)},n.prototype.focus=function(){var t=this,i=t.EG;i.focus(),t._editable&&(i.selectionStart=i.value.length)},n.prototype.selectAll=function(){var t=this;t._editable&&t.EG.select()},n.prototype.zG=function(t,i,n,e){var s,o,s,t,i;n-=0,e-=0,o=(s=this).fg,g(s.UG).css(A,t).css(T,i).css(z,n).css(C,e),g(o).attr(z,n).attr(C,e),s=o.width,t=o.height,(i=o.getContext("2d")).beginPath(),i.lineWidth=2,i.fillStyle=it,i.moveTo(s-17+4,(t-2)/2-2.5),i.lineTo(s-17+7,(t-2)/2+3.5),i.lineTo(s-17+10,(t-2)/2-2.5),i.fill()},n.prototype.showDropDownList=function(){var i=this,t=i.JG;i.YG=!0,g(i.VG).bind(f,function(t){i.NG(t)}).show(),i.cU=!1,i.fU(),this.adjustPosition(),i.cU&&t.pS(g(i.KG.children).height()),t.w4(!1),i.lU(Dt,L),i.hU(i.$G),i.focus()},n.prototype.adjustPosition=function(){var t,i,n,e,s,o,c,r,u,a,l,a,M,M,M,a,t=this,i=g(t.VG);i&&(n=parseInt(i.css("left"),10),e=parseInt(i.css("top"),10),s=i.width(),o=i.height(),isNaN(n)||isNaN(e)||isNaN(s)||isNaN(o)||(r=c=0,!(u=.8)!==this.dfe?(l=(a=W.documentElement).clientWidth,a=a.clientHeight,M=i[0].getBoundingClientRect(),a<o&&(i.css("max-height",Math.round(.8*a)+O),o=Math.round(.8*a)),l<s&&(i.css("max-width",Math.round(.8*l)+O),s=Math.round(.8*l)),M.left+s>l&&(r=M.left+s-l),M.top+o>a&&(c=M.top+o-a)):(a=(M=t.sfe).clientHeight,l=M.clientWidth,a<o&&(o=Math.round(.8*a),i.css("max-height",o+O)),l<s&&(s=Math.round(.8*l),i.css("max-width",s+O)),M=i[0].getBoundingClientRect(),a=t.sfe.getBoundingClientRect(),c=v(0,M.bottom-a.bottom),r=v(0,M.right-a.right)),(n<0||e<0||0<c||0<r)&&((n-=r)<0&&(n-=22),i.css({left:n+O,top:(e-=c+5)+O}))))},n.prototype.shiftPadding=function(t,i){var n=this.xG.firstChild;t===A?g(n).css({left:(+g(n).css(A).replace(O,"")||0)-i}):t===T&&g(n).css({top:(+g(n).css(T).replace(O,"")||0)-i})},n.prototype.closeDropDownList=function(){var t=this;t.YG=!1,g(t.VG).unbind(f).hide(),t.lU("",t.iU),t.focus()},n.prototype.PG=function(){this.YG?this.closeDropDownList():this.showDropDownList()},n.prototype.listHeight=function(t){var i=this,n=g(i.VG);if(0===arguments.length)return n.height();0<t&&(n.height(t),i.JG.w4(!1))},n.prototype.WG=function(t,i){g(this.VG).css(A,t).css(T,i)},n.prototype.items=function(t){var i,n,e,s,o,c,i=this;if(0===arguments.length)return i._items;if(t){for(i._items=t,n=i.KG,e=void 0,g(n).find("div").forEach(function(t){g(t).unbind(D).unbind(w).unbind(N)}),e=n.firstChild;e;)Tt(n,e),e=n.firstChild;for(s=i.QG=0,o=t.length;s<o;s++)c=t[s],i.dU(Z(c,S)?c.text:c);return i}},n.prototype.dU=function(t){var i,n,e,i=this,n=l(x),e=l(et);e.textContent=t.toString(),e.style.padding="0 18px 0 "+It+O,e.style.textOverflow="ellipsis",e.style.whiteSpace="nowrap",E(n,e),E(i.KG,n),i.QG++,g(n).bind(N,function(){var t=g(n).index();i.selectedIndex(t),i.closeDropDownList(),i.ki(k,{isMouse:!0})}).bind(D,function(){var t=g(n);n.oldBackColor=t.css(p),t.css(p,i.eU)}).bind(w,function(){g(n).css(p,n.oldBackColor||"")}).css(ct,i.ZG+"px")},n.prototype.vU=function(){var t=this;t.S5=l(et),g(t.S5).css([$,j],[y,t.VG.style.font]).appendTo(W.body)},n.prototype.mU=function(){Tt(W.body,this.S5)},n.prototype.Mt=function(t){return this.S5.textContent=t,g(this.S5).width()+2+It},n.prototype.lU=function(t,i){var n=this,e=n.$G;0<=e&&e<n.QG&&g(n.KG.children[e]).css([p,m],[t,i])},n.prototype.NG=function(t){var i,n,e,s,o,c,i=this,n=t.keyCode,e=t.which;(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey||37===e||39===e)&&9!==e&&i.editable()||(s=i.QG,o=i.$G,c=0,38===e||40===e?(0<=(c=0<=o&&o<s?o+(38===e?-1:1):c)&&c<s&&i.selectedIndex(c),i.YG&&i.hU(c),r(t)):13===e||37===e||39===e||9===e?(i.selectedIndex(i.$G),(i.YG||i.editable())&&i.closeDropDownList(),i.ki(k,{keyCode:n,shiftKey:t.shiftKey}),(i.YG||i.editable())&&r(t)):27===e?(i.closeDropDownList(),i.ki(k,{keyCode:n}),r(t)):i.editable()||32!==e||r(t))},n.prototype.getSelectedValue=function(t,i,n){var i,e,i=i[t];return M(i)||(1===n?e=t:0===n?e=Z(i,S)?i.text:i:2===n&&Z(i,st)&&(e=i.value)),e},n.prototype.sU=function(t){var i=this;i.lU("",i.iU),i.$G=t,i.lU(Dt,L),i.hU(t)},n.prototype.selectedIndex=function(t){var i,t,i=this;if(0===arguments.length)return i.$G;0<=t&&t<i.QG&&(i.sU(t),t=i.getSelectedValue(i.$G,i._items,i._editorValueType),M(t)||i.editorValue(t))},n.prototype.itemCountPerPage=function(t){if(0===arguments.length)return this.qG;0<t&&(this.qG=t)},n.prototype.allowFloat=function(t){var i=this;if(0===arguments.length)return i.dfe;i.dfe=t},n.prototype.Wt=function(t){this.vU();var t=this.Mt(t);return this.mU(),t},n.prototype.itemHeight=function(t){if(0===arguments.length)return this._itemHeight;0<t&&(this._itemHeight=t)},n.prototype.fU=function(){var t,i,i,n,e,s,t=this;t.vU(),i=t._items[0],i=v(t._itemHeight,g(t.S5).text(M(i)?"":i).height()),g(t.KG.children).css(C,i),(e=t.QG)<=(s=t.qG)?n=e*i:(n=s*i,t.cU=!0),t.listHeight(n),t.mU()},n.prototype.hU=function(t){var t;0<=t&&t<this.QG&&(t=this.KG.children[t],this.JG.xS(t))},n.prototype.bind=function(t,i,n){g(this.xG).bind(t,i,n)},n.prototype.unbind=function(t,i){g(this.xG).unbind(t,i)},n.prototype.ki=function(t,i){g(this.xG).trigger(t,i)},vt=n,o(e,At=B),e.prototype.isReservedKey=function(t,i){return this.rU},e.prototype.paintValue=function(t,i,n,e,s,o,c,r){var u,a,a,l,M,g,h,g,h,I,N,f,D,I,N,f,I,N,u=this,a=r.sheet,a=a.zoom?a.zoom():1,l=17,M=v(0,s-17-1);3===c.hAlign&&(c.hAlign=0),c.wordWrap&&(c.wordWrap=!1),g=r.isPrinting,h=r.printZoomFactor,g&&"number"==typeof h&&1!==h&&(a=h),0<M&&0<o&&(g={},h=void 0,r.quotePrefix=c.quotePrefix,I=c.formatter&&"General"!==c.formatter,N=c._autoFormatter&&c._autoFormatter.formatCached&&"General"!==c._autoFormatter.formatCached,f=void 0,D=this.getItemValue(i),f=I?c.formatter:N?c._autoFormatter:d.CellTypes.Context.Nt(t,D,M+1,c,a),h=this.format(rt(i),f,g,r),h=(I=u.getText(i,r))!==i?h||(i=I):h)&&(N=new d.Rect(n,e,s,o),At.prototype.adjustRectForIconSet.call(this,c.hAlign,r.sheet,r.row,r.col,r.sheetArea,N,g.content&&At.prototype.hasInfilling.call(this,g.content)),n=N.x,s=N.width,f=c.isVerticalText,P(D)&&!f&&!0!==c.shrinkToFit&&(h!==(I=d.CellTypes.Context.Et(t,h,M+1,c,a))&&(delete g.content,c.textIndent=0),h=I),N=u.Pn(t,h,c,r,n,e,s,o),this.paintText(t,i,n,e,M,o,c,r,h,g,void 0,N.externals)),t.save(),(s<17||o<17)&&(t.rect(n,e,s,o),t.clip()),t.beginPath(),t.lineWidth=2,t.fillStyle=it,t.moveTo(n+s-17+3,e+(o-2)/2-2.5),t.lineTo(n+s-17+6,e+(o-2)/2+3.5),t.lineTo(n+s-17+9,e+(o-2)/2-2.5),t.fill(),t.restore()},e.prototype.getText=function(t,i){return t},e.prototype.createEditorElement=function(t,i){var n,e,e,e,s,o,c,r,c,u,u,t,n=t&&t.sheet,e=n&&n.parent,e=e&&e.Ti,e=a.gi(e)+1e3,s=n.defaults,o=this,c=n.getActualStyle(t.row,t.col).cellPadding,r=0;return c&&(r=parseFloat(zt(c)[3])||0),c=0,c=(u=n.getSpan(t.row,t.col))?R(n,u.col,u.col+u.colCount,!1):n.nn(t.col)-r,(u=new vt(i,n.qc(),0,0,s.colWidth,s.rowHeight,e,c)).editorValueType(o._editorValueType),u.items(o._items),u.itemHeight(o._itemHeight),u.itemCountPerPage(o._maxDropDownItems),u.editable(o._editable),u.allowFloat(o.allowFloat()),t=u.getComboBox(),Object.defineProperty(t,"comboBox",{get:function(){return this.gU},set:function(t){this.gU!==t&&(this.gU&&this.gU.dispose(),this.gU=t)}}),t.comboBox=u,h},e.prototype.getEditorValue=function(t,i){var t=U(t);return t&&(this.v6=!t.uU),t&&t.editorValue()},e.prototype.setEditorValue=function(t,i,n){var t=U(t);t&&t.editorValue(i)},e.prototype.focus=function(t,i){var t=U(t);t&&t.focus()},e.prototype.selectAll=function(t,i){var t=U(t);t&&t.selectAll()},e.prototype.activateEditor=function(t,i,n,e){var s,u,a,s=this,u=e.sheet,a=U(t);a&&(a.editorValueType(s._editorValueType),a.items(s._items),a.itemHeight(s._itemHeight),a.itemCountPerPage(s._maxDropDownItems),a.editable(s._editable),a.bind(k,function(t,i){var n,e,s,n,o,c,r,n=i.keyCode,e=i.shiftKey;if(n){if(n=(s=u.Qy()).getShortcutKey(n,!1,e||!1,!1,!1),o=s.getCommands(n))for(c=0,r=o.length;c<r;c++)if("navigationLeft"!==o[c].Zc&&"navigationRight"!==o[c].Zc||(u.Di=1),o[c].execute(u.parent,{sheetName:u.name()}))return!0}else i.isMouse&&a.LG&&u.endEdit()})),s.rU=!0},e.prototype.deactivateEditor=function(t,i){var n,e,s,o,c,r;if(t&&(n=U(t))){if(e=i.sheet.getActualStyle(i.row,i.col,i.sheetArea).cellPadding)for(s=[A,T],o=[3,0],c=0;c<s.length;c++)r=typeof(r=parseInt(zt(e)[o[c]],10))===V&&0<r?r:0,n.shiftPadding(s[c],r);n.unbind(k),n.closeDropDownList(),n.LG=!1}this.rU=!1},e.prototype.updateImeMode=function(t,i){var t;this.isImeAware()&&(t=U(t))&&t.updateImeMode(i)},e.prototype.updateEditor=function(t,i,n,e){var s,t,s,s,o,s=t&&e&&e.sheet;s&&(t=U(t),i&&t&&(s=s.Dn,t.updateStyle(i.backColor,i.foreColor||it,s._n(i.font||s.Nn()))),n)&&t&&(s=0,i&&e&&e.sheet&&e.sheet.NMi&&(s=bt(i,0,!1,o=e.sheet.zoom())),t.updateLocationAndSize(n.x,n.y,n.width,n.height,s))},e.prototype.format=function(t,i,n,e){var s,t;return M(t)?"":(t=(s=this).getItemValue(t),B.prototype.format.call(s,t,i,n))},e.prototype.getItemValue=function(t){var i,n,e,s,o,c,i,r,i=this,n=i._editorValueType,e=i._items;if(e)if(c=e.length,1===n){if(0<=(i=u(t))&&i<c&&(s=e[i])!==I&&s!==h)return o=Z(s,S)?s.text:s}else if(2===n)for(r=0;r<c;r++)if((s=e[r])&&Z(s,st)&&s.value===t)return o=s.text;return t},e.prototype.parse=function(t,i,n){var e,s,o,c,r,u,a,e=this,s=e._editorValueType,o=e._items,u=B.prototype.parse.call(e,t,i);if(o){if(a=o.length,0===s)return u;if(1===s){for(r=0;r<a;r++)if((c=o[r])&&Z(c,S)&&c.text===u||c===u)return r}else if(2===s)for(r=0;r<a;r++)if((c=o[r])&&Z(c,S)&&c.text===u)return c.value}return u},e.prototype.getHitInfo=function(t,i,n,e,s){var o,c,r,r,r,i;return s&&(o=s.sheetArea,c=s.sheet,M(o)||3===o)&&e&&(r=zt(n.cellPadding),r=parseInt(r[1],10)||0,r=e.x+e.width-r,i={x:t,y:i,row:s.row,col:s.col,cellStyle:n,cellRect:e,sheetArea:o,sheet:c},r-17<=t)&&t<r?(i.isReservedLocation=!0,i):h},e.prototype.processMouseDown=function(t){var i,n,n,i=t.sheet,n=t.sheetArea;(M(n)||3===n)&&t.isReservedLocation&&i&&(t.row===i.ui&&t.col===i.ci||i.setActiveCell(t.row,t.col),i.startEdit(),n=U(i.li))&&(a.Tt.mozilla&&(n.HG=(new Date).valueOf()),n.showDropDownList(),n.LG=!0)},e.prototype.getAutoFitWidth=function(t,i,n,e,s){var o;return n&&n.wordWrap&&(n.wordWrap=!1),d.CellTypes.Context.Bt(t,i,n,e,s)+17},e.prototype.getAutoFitHeight=function(t,i,n,e,s){return n&&n.wordWrap&&(n.wordWrap=!1),d.CellTypes.Context.tn(t,i,n,e,s)},e.prototype.isImeAware=function(t){return!0},e.prototype.lfe=function(t,i){var i=At.prototype.lfe.call(this,t,i);return t.readonly||this._editable||(i.readonly=!0),i},e.prototype.Ke=function(){},e.prototype.Je=function(t){var t={editorValueType:t.editorValueType&&ut[t.editorValueType],items:t.items,itemHeight:t.itemHeight,maxDropDownItems:t.maxDropDownItems,editable:t.editable};this.fromJSON(t)},e.prototype.toJSON=function(){var e,s,o,e=this,s={typeName:e.typeName};return c(dt,function(t,i){var n;o=e["_"+t],("items"===t?o&&0<o.length:o!==i)&&(s[t]=o)}),s},e.prototype.fromJSON=function(n){var e=this;c(dt,function(t){var i=n[t];M(i)||(e["_"+t]=i)})},wt=e,t.ComboBox=wt,c(dt,function(i){wt.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:(this["_"+i]=t,this)}}),d.CellTypes.ti[7]=wt},"./dist/plugins/celltype/dataobjectcelltype.js":function(t,i,l){"use strict";var n,e,s,M,o,o,g,u,o,h,I,s,c,a;function N(t){return t&&"object"==typeof t&&!(t instanceof e.CalcError)&&!(t instanceof Date)&&!Array.isArray(t)}function r(t){return N(t)?f(t,""):[]}function f(t,i){for(var n,e,s,o,c,r,u,a,n=[],e,s=0,o=Object.keys(t);s<o.length;s++)c=o[s],u=i?i+"."+c:c,"function"!=typeof(r=t[c])&&(N(r)?(a=f(r,u),n.push({text:c,value:r,path:u,layout:{displayAs:M.LayoutDisplayAs.popup},items:a})):n.push({text:c,value:r,path:u}));return n}function D(t){var i=a.call(this)||this;return i.typeName="18",i.pU=t,i}n=this&&this.__extends||(c=function(t,i){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}c(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.DataObject=void 0,e=l("CalcEngine"),s=l("Common"),M=l("Core"),o=l("./dist/plugins/celltype/celltypes.ns.js"),o=new s.Common.ResourceManager(o.SR,"CellTypes"),g=o.getResource.bind(o),u="vc",o=M.CellTypes.Text,h=s.Common.lt.ht,I=void 0,n(D,a=o),D.prototype.Xe=function(t,i,n,e,s){var o=t.Z_(i,n,s,!0);o||((o=new M.Style).cellType=this),t.Ut.do("setStyle",i,n,o,s)},D.prototype.qe=function(u,a,t,i,n){var e,n,e,n=r(u.getValue(a,t,n));0<n.length?(i.formatter=this.pU,i.cellButtons=[{command:"openList",imageType:M.ButtonImageType.custom,imageSrc:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+RGF0YSBvYmplY3QgY2VsbCB0eXBlPC90aXRsZT4KICAgIDxnIGlkPSJEYXRhLW9iamVjdC1jZWxsLXR5cGUiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0xMyw4LjcxNDI4NTcxIEwxMywxMS41NzE0Mjg2IEMxMywxMi4zNjA0OTExIDEwLjk4NTgxNzMsMTMgOC41LDEzIEM2LjAxNDE4MjY5LDEzIDQsMTIuMzYwNDkxMSA0LDExLjU3MTQyODYgTDQsOC43MTQyODU3MSBDNCw5LjUwMzM0ODIxIDYuMDE0MTgyNjksMTAuMTQyODU3MSA4LjUsMTAuMTQyODU3MSBDMTAuOTg1ODE3MywxMC4xNDI4NTcxIDEzLDkuNTAzMzQ4MjEgMTMsOC43MTQyODU3MSBaIE0xMyw1LjE0Mjg1NzE0IEwxMyw4IEMxMyw4Ljc4OTA2MjUgMTAuOTg1ODE3Myw5LjQyODU3MTQzIDguNSw5LjQyODU3MTQzIEM2LjAxNDE4MjY5LDkuNDI4NTcxNDMgNCw4Ljc4OTA2MjUgNCw4IEw0LDUuMTQyODU3MTQgQzQsNS45MzE5MTk2NCA2LjAxNDE4MjY5LDYuNTcxNDI4NTcgOC41LDYuNTcxNDI4NTcgQzEwLjk4NTgxNzMsNi41NzE0Mjg1NyAxMyw1LjkzMTkxOTY0IDEzLDUuMTQyODU3MTQgWiBNOC41LDMgQzEwLjk4NTgxNzMsMyAxMywzLjYzOTUwODkzIDEzLDQuNDI4NTcxNDMgQzEzLDUuMjE3NjMzOTMgMTAuOTg1ODE3Myw1Ljg1NzE0Mjg2IDguNSw1Ljg1NzE0Mjg2IEM2LjAxNDE4MjY5LDUuODU3MTQyODYgNCw1LjIxNzYzMzkzIDQsNC40Mjg1NzE0MyBDNCwzLjYzOTUwODkzIDYuMDE0MTgyNjksMyA4LjUsMyBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjMzY3RkNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+"}],i.dropDowns=[{type:M.DropDownType.list,option:{items:n,dropDownAlignment:0,dropDownDirection:3},submitCommand:function(t,i,n){for(var e,s,o,c,r,e=l("SheetsCalc"),s=n.sheetArea,o=n.col+1;o<t.getColumnCount(s);o++){if(t.isActualProtected()&&t.getCell(n.row,o,s).locked()){t.jT(16,g().DataObject_MeetLock);break}if(t.Ut.findSpan(n.row,o,s)){t.jT(16,g().DataObject_MeetSpan);break}if(3===s&&t.tables&&t.tables.find(n.row,o)||t.pivotTables&&t.pivotTables.findPivotTable(n.row,o)){t.jT(16,g().DataObject_MeetTable);break}if(h(t.getValue(n.row,o,s))){c=e.rangesToFormula([new M.Range(n.row,n.col,1,1)],a,o,15,1===u.parent.options.referenceStyle),r=n.path,t.Qy().execute({cmd:"editCell",sheetName:t.name(),row:n.row,col:o,sheetArea:s,newValue:"="+c+'."'+r+'"',autoFormat:!1});break}}}}]):(i.cellButtons=I,i.dropDowns=I),i.formatter&&M.util.St(i.formatter)&&u.SL(a,t,i.formatter)},D.prototype.paint=function(t,i,n,e,s,o,c,r){this.pU!==c.formatter||this.bU?(this.Xe(r.sheet,r.row,r.col,i,r.sheetArea),this.bU=!1):r.sheet.Ut.W_(r.sheetArea).getValueForKey(r.row,r.col,u)&&(this.Xe(r.sheet,r.row,r.col,i,r.sheetArea),r.sheet.Ut.W_(r.sheetArea).setValueForKey(r.row,r.col,u,I)),a.prototype.paint.call(this,t,i,n,e,s,o,c,r)},D.prototype.toJSON=function(){return{typeName:this.typeName,format:this.pU}},D.prototype.fromJSON=function(t){this.pU=t.format,this.bU=!0},i.DataObject=s=D,M.CellTypes.ti[18]=s},"./dist/plugins/celltype/dropdown-action.js":function(a,t,i){"use strict";var T,b,y,z,C,m,p,f,L,t,D,x,S,O,e,s,o,k,i,d,E,U,Z,G,B,Q,Y,P,R,n,c,v,r;function W(t,i){return n.createElement(t,i)}function u(A){return{canUndo:!1,execute:function(t,i,n){var e,t,s,o,c,r,u,a,l,M,g,h,I,l,N,f,D,d,v,l,M,t,w,s,j,l,M,e=(0,T._f)(t,i.sheetName);if(!e||t.jg().name()!==i.sheetName)return!1;if(t=i.row,s=i.col,(O(t)||O(s))&&(t=e.getActiveRowIndex(),s=e.getActiveColumnIndex()),o=i.sheetArea,O(o)&&(o=3),t<0||t>=e.getRowCount(o)||s<0||s>=e.getColumnCount(o))return!1;if(e.showCell(t,s,T.VerticalPosition.nearest,T.HorizontalPosition.nearest),u=e.getCellRect(t,s,c=1===o?-1:void 0,r=2===o?-1:void 0),e.parent&&!e.parent.options.scrollByPixel&&!e.isEditing()){if(0<(a=e.frozenColumnCount())&&a<(l=e.getViewportLeftColumn(1))&&(M=e.getSpan(t,s,o))&&M.col<=l&&l<M.col+M.colCount&&0<(g=l-a))for(h=0;h<g;h++)u.width=u.width-e.getColumnWidth(a+h+1,o);if(0<(I=e.frozenRowCount())&&I<(l=e.getViewportTopRow(1))&&(M=e.getSpan(t,s,o))&&M.row<=l&&0<(N=(l<M.row+M.rowCount?l:M.rowCount)-I))for(h=0;h<N;h++)u.height=u.height-e.getRowHeight(I+h+1,o)}switch(f=W("div"),D=V(e,t,s,o),(O(i.row)||O(i.col))&&(i.row=e.getActiveRowIndex(),i.col=e.getActiveColumnIndex()),l=i.row,M=i.col,t=e.Il(l,M,o),w=J(A),(l=(s=t.dropDowns)&&0<s.length)&&(M=s.filter(function(t){return t.type===w})[0])&&(void 0!==M.option&&null!==M.option&&(v=M.option),j=M),A){case E:d=new p.ColorPicker(f);break;case U:d=v&&v.showDateRange?(D=H(D,"dateRange"),new L.RangeCalendar(f,v)):(D=H(D,"date"),new L.Calendar(f));break;case Z:D=H(D,"date"),d=new C.TimePicker(f);break;case G:D=(D=H(D,"number")).toString(),d=new b.Calculator(f);break;case B:D=H(D,"date"),d=new m.MonthPicker(f);break;case Q:(d=new y.List(f)).formula=e.getFormula(i.row,i.col);break;case Y:D=v&&v.showNumberRange?H(D,"numberRange"):H(D,"number"),d=new z.Slider(f);break;case P:d=new x.WorkFlow(f),"string"!=typeof D&&D!==k&&(D=D.toString());break;case R:d=new S.MultiColumn(f,k,e)}return F(d,D,u,e,i,t,l,j,v),!0}}}function V(t,i,n,e){var s,o;return t.isEditing()?(s=t.getCellType(i,n)).getEditorValue(t.li,o={sheet:t,row:i,col:n,sheetArea:e}):t.getValue(i,n,e)}function H(t,i){var i,n;return"date"===i?"string"==typeof t?(t=s.yU(t))===k&&(t=new Date):t instanceof Date||(t=new Date):"dateRange"===i?t&&"object"==typeof t&&(t={start:o(t.start),end:o(t.end)}):"number"===i?"string"==typeof t?t=e.yU(t):"number"!=typeof t&&(t=0):"numberRange"===i&&(n=i=0,t&&"object"==typeof t&&("string"===t.start?i=e.yU(t.start):isNaN(t.start)||(i=t.start),"string"===t.end?n=e.yU(t.end):isNaN(t.end)||(n=t.end)),t={start:i,end:n}),t}function w(t,i,n,e){var s,o,c,r,n,i,r,c,u,s=n.row,o=n.col;(O(s)||O(o))&&(s=t.getActiveRowIndex(),o=t.getActiveColumnIndex()),c=n.sheetArea,O(c)&&(c=3),i&&i.submitCommand?"string"==typeof i.submitCommand?t.getParent().commandManager().execute({cmd:i.submitCommand,sheetName:t.name(),row:s,col:o,newValue:e.value}):"function"==typeof i.submitCommand&&((r={}).row=n.row,r.col=n.col,r.sheetArea=c,r.path=e.path,i.submitCommand.call(null,t,e.value,r)):(t.getParent().commandManager().execute({cmd:"editCell",sheetName:t.name(),row:s,col:o,newValue:e.text,autoFormat:!e.noAutoFormat,sheetArea:c,isUndo:!1}),t.ci===o&&t.ui===s&&(n=t.getCellType(s,o),i={sheet:t,row:s,col:o,sheetArea:T.SheetArea.viewport},r=n.isImeAware(i),t.isEditing()?(c=t.Il(s,o,c),u=t.getCellRect(s,o),t.li.Li=e.value,n.updateEditor(t.li,c,u,i),n.setEditorValue(t.li,e.text,i)):r&&t.rt.ATe(n,s,o,e.text)))}function J(t){var i=-1;switch(t){case E:i=T.DropDownType.colorPicker;break;case U:i=T.DropDownType.dateTimePicker;break;case Z:i=T.DropDownType.timePicker;break;case G:i=T.DropDownType.calculator;break;case B:i=T.DropDownType.monthPicker;break;case Q:i=T.DropDownType.list;break;case Y:i=T.DropDownType.slider;break;case P:i=T.DropDownType.workflowList;break;case R:i=T.DropDownType.multiColumn}return i}function j(t,i,n,e,s){var i,i,i=i.cellButtons;t&&i&&0<i.length&&(i=t.Ut.getValueForKey(n,e,c,s))&&i.isMouseDownReservedLocation&&(i.buttonDownIndex=-1,i.isMouseDownReservedLocation=!1,t.repaint(t.getCellRect(n,e)))}function F(i,t,n,e,s,o,c,r,u){var a,l,M,g,h,u,t,u,I,I,t,u,n,N;d.ef(),a=e.parent,l=e.qc(),M=s.row,g=s.col,h=s.sheetArea,u&&(u.row=M,u.col=g),i.setOptions(u),i.setValue(t),u=l.getBoundingClientRect(),t=n.x+u.left,u=n.y+u.top,(I=A(a))&&(t+=I.x,u+=I.y),I=new f.Rectangle(t,u,n.width,n.height),u=(t=i.getOptions())&&!O(t.dropDownAlignment)?t.dropDownAlignment:T.DropDownAlignment.Far,n=t&&!O(t.dropDownDirection)?t.dropDownDirection:void 0,N=new f.PopupControl(i.getContainer(),I,{align:u,hostElement:l,direction:n}),v+=1,c&&i.wU(),N.open(),i.scrollToSelect(),c&&i.refresh(),i.on(D.BaseDropdown.Event_ValueChanged,function(t){t.notCloseDropDown||N.close(),X(s,t)&&w(e,r,s,t)}),a&&(a.CC=a.CC||[],a.CC.push(N)),i.getContainer().addEventListener("contextmenu",function(t){t.stopPropagation(),t.preventDefault()}),N.on("close",function(){j(e,o,M,g,h),i&&i.dispose(),--v,N=null;var t=a.CC.indexOf(N);a.CC.splice(t,1),d.cf()})}function A(t){var i,n,e,s;if(t&&(i=t.options.tabStripVisible)&&0!==(n=t.options.tabStripPosition)){switch(e={x:0,y:0},s=t.w2.ot(),n){case 1:e.y=s.height;break;case 2:e.x=s.width}return e}}function X(t,i){return!0!==i.notSubmit&&(3===t.sheetArea||t.cmd!==G||!isNaN(i.value))}Object.defineProperty(t,"__esModule",{value:!0}),t.commands=void 0,T=i("Core"),Object.defineProperty(t,"commands",{enumerable:!0,get:function(){return T.Commands}}),b=i("./dist/plugins/celltype/editor/calculator.js"),y=i("./dist/plugins/celltype/editor/listControl.js"),z=i("./dist/plugins/celltype/editor/slider.js"),C=i("./dist/plugins/celltype/editor/timepicker.js"),m=i("./dist/plugins/celltype/editor/monthPicker.js"),p=i("./dist/plugins/celltype/editor/colorpicker.js"),f=i("./dist/plugins/celltype/editor/popupControl.js"),L=i("./dist/plugins/celltype/editor/calendar.js"),t=i("Common"),D=i("./dist/plugins/celltype/editor/baseControl.js"),x=i("./dist/plugins/celltype/editor/workflowPicker.js"),S=i("./dist/plugins/celltype/editor/multiColumnPicker.js"),O=t.Common.lt.ht,e=t.Common.st,s=t.Common.ct,o=T.mt.Eve,k=null,i=window,d=i.gcGlobal,E="openColorPicker",U="openDateTimePicker",Z="openTimePicker",G="openCalculator",B="openMonthPicker",Q="openList",Y="openSlider",P="openWorkflowList",R="openMultiColumn",n=document,c="_cellButtonParam",T.Commands[E]=u(E),T.Commands[U]=u(U),T.Commands[Z]=u(Z),T.Commands[G]=u(G),T.Commands[B]=u(B),T.Commands[Q]=u(Q),T.Commands[Y]=u(Y),T.Commands[P]=u(P),T.Commands[R]=u(R),v=0,T.Workbook.ch("registerOpendropdownCommand",r={init:function(){this.commandManager().register(E,T.Commands[E]),this.commandManager().register(U,T.Commands[U]),this.commandManager().register(Z,T.Commands[Z]),this.commandManager().register(G,T.Commands[G]),this.commandManager().register(B,T.Commands[B]),this.commandManager().register(Q,T.Commands[Q]),this.commandManager().register(Y,T.Commands[Y]),this.commandManager().register(P,T.Commands[P]),this.commandManager().register(R,T.Commands[R])}}),T.Worksheet.ch("registerOpendropdownCommand",{preProcessMouseWheel:function(t){0<v&&!this.RD&&(t.r=!0)}})},"./dist/plugins/celltype/editor/baseControl.js":function(t,i,n){"use strict";var e,n,s,o,c,r,u;function a(t){var i=r.call(this)||this;return i.Wc=t,i}function l(t){var i=u.call(this)||this;return i.Ti=t,i}e=this&&this.__extends||(c=function(t,i){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}c(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.BaseDropdown=i.BaseControl=void 0,n=n("./dist/plugins/celltype/editor/eventbase.js"),r=n.EventBase,e(a,r),a.prototype.init=function(t,i,n){this.Ti=this.Wc.querySelector("."+i),this.Ti?this.RemoveChilds(this.Ti):(this.Ti=this.CreateElement(t,i,n),this.Wc.appendChild(this.Ti))},a.prototype.GetContainer=function(){return this.Wc},a.prototype.RemoveChilds=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},a.prototype.CreateElement=function(t,i,n,e){var s,o,s=document.createElement(t);if(i&&(s.className=i),n)for(o in n)n[o]&&s.setAttribute(o,n[o]);return e&&e.appendChild(s),s},i.BaseControl=a,u=n.EventBase,e(l,u),l.prototype.getOptions=function(){return this.MU},l.prototype.updateStyle=function(t,i,n){},l.prototype.scrollToSelect=function(){},l.prototype.getContainer=function(){return this.Ti},l.prototype.refresh=function(){},l.prototype.wU=function(){},l.prototype.dispose=function(){},l.Event_ValueChanged="ValueChangedEvent",i.BaseDropdown=l},"./dist/plugins/celltype/editor/baseSpreadPicker.js":function(t,i,n){"use strict";var e,s,u,n,M,g,h,o,c,I,N,f,r,a,l;function D(t,i,n){var t=l.call(this,t)||this;return t.setOptions(i),t.CU=n,t}function d(t,i,n){var e={sheet:t};M(n)||(e.isEsc=n),t.ki(i,e)}e=this&&this.__extends||(a=function(t,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}a(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.BaseSpreadPicker=void 0,s=n("./dist/plugins/celltype/editor/baseControl.js"),u=n("Core"),n=n("Common"),M=n.Common.lt.ht,g=Math.min,h=Math.max,o=null,c=".baseSpreadNS",I=800,N=400,f=100,l=s.BaseDropdown,e(D,l),D.prototype.setOptions=function(t){var i,t,i,i=this;(i.MU=t)&&(t=i.Ti,(i=document.createElement("div")).setAttribute("class","gc-base-spread-div"),t.appendChild(i),this.SU=i,this.TU=this.AU(i))},D.prototype.setValue=function(t){var i,n,i=this;i.MU&&(n=i.TU,setTimeout(function(){var t;window.gcGlobal.cf(),n&&n.focus(!0)},1e3))},D.prototype.wU=function(){var t,i,n,e,s,n,t=this;t.SU&&(i=t.Ti,(n=t.MU)&&(e=n.width,s=n.height),n=t.IU(e,s),M(e)&&(e=n.width),M(s)&&(s=n.height),(0,u.GC$)(i).width(e).height(s))},D.prototype.refresh=function(){this.TU&&this.TU.refresh()},D.prototype.dispose=function(){var t=this;t.CU&&(t.CU.Zg(),t.CU=o),t.SU&&(t.SU=o),t.TU&&(t.TU.unbind(u.Events.DropdownSpreadMouseClick+c),t.TU.unbind(u.Events.DropdownSpreadKeyboardEnter+c),t.TU.L0(),t.TU=o)},D.prototype.IU=function(t,i){for(var n,e,s,o,c,r,u,a,a,t,t,i,l,n,e=this.TU,s=e.getActiveSheet(),o=s.getColumnCount(),c=0,r=0;r<o;r++)c+=s.getColumnWidth(r,3);return u=c,a=s.getRowCount(3)+s.getRowCount(1),a=s.getRowHeight(0,3)*a,u<I&&M(t)||u<=t?e.options.showHorizontalScrollbar=!1:(t=0,a+=t=e.zb?e.zb.ZC():t),a<N&&M(i)||a<i?e.options.showVerticalScrollbar=!1:(t=0,u+=t=(i=e.Xb)?(l=i.lS(!1))||e.NC():t),{width:g(u,I),height:g(h(a,f),N)}},D.prototype.AU=function(t){var t,i,n,e,t=new u.Workbook(t,{sheetCount:1});return t.xU=!0,(i=t.options).allowUserDragDrop=!1,i.allowDragHeaderToMove=u.AllowDragHeaderToMove.none,i.allowUserDragFill=!1,i.allowUserResize=!1,i.allowUserZoom=!1,i.tabStripVisible=!1,i.allowContextMenu=!1,i.allowUserDeselect=!1,i.scrollbarMaxAlign=!0,(n=t.getActiveSheet()).RD=!0,e=this,t.bind(u.Events.DropdownSpreadMouseClick+c,function(t,i){e.submitData(i)}),t.bind(u.Events.DropdownSpreadKeyboardEnter+c,function(t,i){e.submitData(i)}),t},D.prototype.submitData=function(t){},i.BaseSpreadPicker=D,u.GC$.extend(u.Worksheet.prototype,{BD:function(){d(this,u.Events.DropdownSpreadMouseClick)},GD:function(t){d(this,u.Events.DropdownSpreadKeyboardEnter,t)},Lpe:function(t,i,n){var r,e,e,r=this,e=r.Rpe(),e=e&&e[t]&&e[t][i];e&&(r.suspendPaint(),e.forEach(function(t){var i,n,e,s,o,c,s,o,i=t.row,n=t.col,e=t.dataSource,s=t.dependSheetName,o=t.targetSheetName;s===r.name()&&(s=(s=(c=r.getParent()).Gm(o))._gi===u.SheetType.reportSheet&&s.getSheet?s.getSheet():s)&&(o=s.getStyle(i,n))&&o.dropDowns&&o.dropDowns.some(function(t){return t.type===u.DropDownType.multiColumn&&t.option.dataSource===e})&&s.YI(t.row,t.col,null)}),r.resumePaint())},Rpe:function(){var t,i,t=this,i=t.Fpe;return i=i||(t.Fpe=[])}})},"./dist/plugins/celltype/editor/calculator.js":function(t,i,n){"use strict";var e,o,s,c,r,n,u,a,l,M,g,h,I,N,f,D,d,v,w,j,A,T;function b(t){var t=parseInt(window.getComputedStyle(t)["font-size"].replace("px",""),0);return t=isNaN(t)?0:t}function y(){}function z(){}function C(){}function m(t,i,n,e,s,o,c,r,u,a,l){var M=this;M.Y6=t,M._x=i,M._y=n,M.NU=e,M.kU=s,M.DU=o,M._U=c,M.EU=r,M.jU=u,M.OU=a,M.RU=l,M.BU=f}function p(t){var i,n,e,i=T.call(this,t)||this,n=i;return n.Ti=document.createElement("div"),n.Ti.classList.add("gc-calculator-container"),n.Ti.innerHTML=a,(e=n.Ti.querySelector(".okbtn")).textContent=u().OK,t.appendChild(i.Ti),n.LU(),n.FU(),n.PU(),n.GU(),n.UU("0"),i}e=this&&this.__extends||(A=function(t,i){return(A=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}A(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.Calculator=i.CalculatorErrorInfo=void 0,o=n("./dist/plugins/celltype/editor/baseControl.js"),s=n("./dist/plugins/celltype/celltypes.ns.js"),c=n("Common"),r=n("Core"),n=new c.Common.ResourceManager(s.SR,"CellTypes"),u=n.getResource.bind(n),a='\n<div class="gc-calculator">\n    <header class="gc-top-part">\n        <div class="gc-screen">\n            <div class="gc-main-screen">\n                <input class="gc-main" value="" type="text" disabled readonly="readonly"></div>\n        </div>\n    </header>\n    <section class="gc-bottom-part">\n        <div class="gc-features">\n            <div class="gc-sub-menu">\n                <div class="gc-row">\n                    <div class="percentage button image icon-group1" data-value="%" role="button">\n                        <img class="icon icons8-Percentage" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABK0lEQVRYR+2WYQ3CMBCFvznAAgrAAeAAHOAACYADHCABJIACcAA4wAHkkpYM6K7XZs3+rAnZYNf169u7Nyo6HlXH69MD9ArEFJgDK2AKnICtO2re3bk5D2AMPLViDUAWPwQmzxQIWfDi5iyAY6zLNIArMHK73gDyWQNnp0jo3qLSJFLzNU8DeLnKek3oN3/DJbB3X4bAPbZ7ud4WwAC4AXIUn4haptEWQJLx6mRtACQbzwrgTShyellDJkw2nhXA0oZZxrMCSJ0EkCjgW0vOZccyso2XApCTeEnpGYviJoAm41kemzmItN03GS85PXMU0IyXmp7J/4hixisOEEu8ogCWxCsKYEk8a3p+DG41oTXxirRhzHi/7aql519rWxUwvdtzinqAXoHOFXgD+J9gIZOwvCMAAAAASUVORK5CYII="></div>\n                    <div class="sqrt button image icon-group1" data-value="sqrt" role="button">\n                        <img class="icon icons8-Square-Root" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABP0lEQVRYR+3V4S0FQRQF4O9VgApQATrQASpABXSAClABOqCCRwWoABWgAnKTnWSzeV5mdkf2z55fm83sPWfPuXfuzMiYjcxvEjA5UNuBd6z/0dgLuWoK2MV8yVT9u4BbHOIC57njXcuBVXw2pJuIKLJQS8ARbvCA/Szm5lAtAS/YwjEiimzUELCNZ3wjoihCDQFXOME1TovYqbILvrCCHUQURRjqQGq+V0QUxVgm4KdVLcYqxquLe+z1ab5UKFdAnO92+AbemkJriCiKkRNBsrnrQjTcJe4QZ3ohR0AUTkum7UJ6d4CIohdyBXRdSIvnAxFFb+QKaLsQfxzXbfHiWaSyREBy4bEZubj1ihbPUAFBGLnHpRN4QkQxCCUOBFHs+bOGsXjxDHUgvk8upOdBfx8flzowmLBbYBIwOTC6A7+1/zEhMa617wAAAABJRU5ErkJggg=="></div>\n                    <div class="sqr button icon-group1" data-value="pow" role="button">\n                        <span class="x-sign">\n                            <sub>x</sub></span>\n                        <span>\n                            <sup>2</sup></span>\n                    </div>\n                    <div class="fraction button icon-group1" data-value="1/x" role="button">\n                        <span>\n                            <sup>1</sup></span>\n                        <span>&frasl;</span>\n                        <span class="x-sign">\n                            <sub>\n                                <em>x</em></sub>\n                        </span>\n                    </div>\n                </div>\n            </div>\n            <div class="gc-main-menu">\n                <div class="gc-row">\n                    <div class="clear-entry button icon-group1" data-value="CE" role="button">CE</div>\n                    <div class="clear button icon-group1" data-value="C" role="button">C</div>\n                    <div class="clear-element button image icon-group1" data-value="BS" role="button">BS</div>\n                    <div class="divide button image operation icon-group1" data-value="/" role="button">\n                        <img class="icon icons8-Divide" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAo0lEQVRYR+2VSxGDMBRFTxTUAkioklrAQSVAHSChjmqhdYCDMm8mCz7DIp/yurisQ+6Zk5u8gPMXnPMRgAyUGBiBWyzxE3jkFDoXwMLvm0ADGFIhcgEm4AJcY+ALeAOtJ8AHaM4CMNW95xFYtkF0ixImn7/9m9uBVNOH6wVwZOBbzfF6o13e3wL8SMB+W5WwxICmoaahpmGVx6rkGgpABqoYmAH2Lh4hfK3KfwAAAABJRU5ErkJggg=="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="7">7</div>\n                    <div class="button number icon-group2" role="button" data-value="8">8</div>\n                    <div class="button number icon-group2" role="button" data-value="9">9</div>\n                    <div class="multiply button image operation icon-group1" data-value="*" role="button">\n                        <img class="icon icons8-Multiply" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABBUlEQVRYR+2W6w3CMAyErxuwCYwAG7AJjAATMQKMUDZhBHQSQaFqYp8DqpDSn2nj+3J+NAMWfoaF9dEBugN/4cAewA3AQ+yYFYADgHNtn+UAxS8ARgA7AYLiVwCbF8CpBGEBMBBPvxYgcvE7gG0N3AIguAIhiTO4B8ALIYsrABZESFwFKEFwPRWcmfNpMXpTkO+b1gTfsdpl8YgDCSSH4FpIvBUg2c446px4OxpNQZ5zBlPmxEcZqABz1c6A6rAKOVBrNWVYhRzw9HkIwpMCj/hcd7gK0wJQxEMQFkD6Hat9nqeD94Hw75inarmQHGviLYNIvByVP7dS8DWh6I2oA3QHfu7AEzfHWCF+OOmJAAAAAElFTkSuQmCC"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="4">4</div>\n                    <div class="button number icon-group2" role="button" data-value="5">5</div>\n                    <div class="button number icon-group2" role="button" data-value="6">6</div>\n                    <div class="minus button image operation icon-group1" data-value="-" role="button">\n                        <img class="icon icons8-Minus-Math-" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAARElEQVRYR+3V0Q0AMAQFQPYfuh1A+ql8nAF4LhIZw5XD80MAAgQIECCwVuA0fcmy8EtgPEATQG279gYIECBAgACBbwIXi38CITaYSB4AAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="1">1</div>\n                    <div class="button number icon-group2" role="button" data-value="2">2</div>\n                    <div class="button number icon-group2" role="button" data-value="3">3</div>\n                    <div class="plus button image operation icon-group1" data-value="+" role="button">\n                        <img class="icon icons8-Plus-Math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAWUlEQVRYR+2WMQoAIAgA9f+PrsWmEMQSEa7Z8rzEUmle2pxfABhvYFkPpQtJb7TEAGAAAxgoM3AO/v1YXoPPm4TtANHKy64AAAxgAANjDERB3bjXXzEA8w1s3k4WIU0YaEoAAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="plus-minus button image icon-group1" data-value="+/-" role="button">\n                        <img class="icon icons8-Plus-Minus" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAYUlEQVRYR+2VMQ4AIAgD4f+P1gUdCakx1VB3pL0UcCM/J/c3CfiewIgMwUbgwmgsASLQg8ByiW7tdNIqY0gXkDnvkQEREIGnCaDLaddVFtFxk+wDCagQoN8CugCFUASuEpjXIBIhP3OSdgAAAABJRU5ErkJggg=="></div>\n                    <div class="button number icon-group2" role="button" data-value="0">0</div>\n                    <div class="dot button icon-group1" data-value="." role="button">.</div>\n                    <div class="equal button image operation icon-group1" data-value="=" role="button">\n                        <img class="icon icons8-Equal-Sign" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAQ0lEQVRYR+3U0Q0AMAQFQPYfuh1A+ikkPQMgF0/GcOXw/LAAAQIECLwETtOLLvPWLtAEUNs6wrUCUiAFBAgQIPCPwAX8vwQhcNJI5wAAAABJRU5ErkJggg==" width="32" height="32"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button okbtn icon-group1" role="button">OK</div>\n                </div>\n            </div>\n        </div>\n    </section>\n</div>\n',l=Math.floor,M=Math.abs,g=Math.pow,h=Math.round,I=Math.sqrt,N=Math.max,f=new Array("0","1","2","3","4","5","6","7","8","9","+/-",".","+","-","*","/","SQRT","%","1/x","=","MC","MR","MS","M+","BS","CE","C","POW"),y.Init=function(){var t;y.GetBrowserType(),y.IsIE=void 0!==y.ie||void 0!==y.edge},y.GetBrowserType=function(){try{var t=navigator.userAgent.toLowerCase();window.ActiveXObject?y.ie=t.match(/msie ([\d.]+)/)[1]:-1!==t.indexOf("edge")?y.edge=t.match(/edge\/([\d.]+)/)[1]:-1!==t.indexOf("firefox")&&(y.firefox=t.match(/firefox\/([\d.]+)/)[1]),-1!==t.indexOf("rv:")&&-1===t.indexOf("firefox")&&(y.ie=t.match(/rv:([\d.]+)/)[1])}catch(t){}},(D=y).Init(),z.IsErrorText=function(t){return t===u().Calculator_DivideByZeroInfo||t===u().Calculator_InvalidInputInfo||t===u().Calculator_SqrtParameterException||t===u().Calculator_OverFlowInfo},d=z,i.CalculatorErrorInfo=d,C.IsDotContained=function(t){var i;return-1!==(t+"").indexOf(".")},C.GetDotPosition=function(t){var i,n,e,i=t+"",n=0,e=0;for(e=i.length;0<e;e--){if("."===i.substring(e-1,e))return n;n++}return 0===e?0:n},C.FormatOutput=function(t){var i,n,e;if(null==t)return null;if(n=0,e=(i=t+"").length,C.IsDotContained(i))for(;"0"===i.substring(e-1,e)&&""!==i&&-1===i.indexOf("e");)i=i.substring(0,e-1),e--;return i},C.FormatResult=function(t){var i,n,t,e,s,o,s,i=(t=isNaN(t)?0:t)+"",n="";return t<0&&(n="-",i=i.substring(1,i.length)),t=i.length,e="",-1!==(s=i.indexOf("e"))&&(e=i.substring(s,t),t=(i=i.substring(0,s)).length),C.IsDotContained(i)&&16<t&&(o=0,i=1<parseFloat(i)?(o=C.GetDotPosition(i)-(t-16),i.toString().substring(0,17)):(o=C.GetDotPosition(i)-(t-17),i.toString().substring(0,18)),i=(0<o?h(parseFloat(i)*g(10,o))/g(10,o):h(parseFloat(i))).toString()),t=i.length,!C.IsDotContained(i)&&15<t&&(o=t-15,i=(h(parseFloat(i)/g(10,o))*g(10,o)).toString()),i=n+i+e,s=parseFloat(i),C.IsOverFlow(s.toString())?u().Calculator_OverFlowInfo:s},C.SingleMathOperation=function(t,i){var t,i,t=parseFloat(t);if(isNaN(t)&&(t=0),"SQRT"===i){if(t<0)return u().Calculator_InvalidInputInfo;t=I(t)}if("POW"===i&&(t=g(t,2)),"1/x"===i){if(0===t)return u().Calculator_DivideByZeroInfo;i=C.GetDotPosition(t.toString()),t=g(10,i)/(g(10,i)*t)}return C.FormatResult(t)},C.DoubleMathOperation=function(t,i,n){var t,i,e,s,o,c,t=parseFloat(t),i=parseFloat(i);if(C.IsDotContained(t.toString())||C.IsDotContained(i.toString())){if(o=s=0,C.IsDotContained(t.toString())&&(s=C.GetDotPosition(t.toString())),C.IsDotContained(i.toString())&&(o=C.GetDotPosition(i.toString())),c=N(s,o),"+"===n&&(e=((t*=g(10,c))+(i*=g(10,c)))/g(10,c)),"-"===n&&(e=((t*=g(10,c))-(i*=g(10,c)))/g(10,c)),"*"===n&&(e=(t*=g(10,s))*(i*=g(10,o))/g(10,s+o)),"/"===n){if(t*=g(10,c),0===(i*=g(10,c)))return u().Calculator_DivideByZeroInfo;e=t/i}"%"===n&&(e=(t*=g(10,s))*(i*=g(10,o))/g(10,s+o+2))}else{if("+"===n&&(e=t+i),"-"===n&&(e=t-i),"*"===n&&(e=t*i),"/"===n){if(0===i)return u().Calculator_DivideByZeroInfo;e=t/i}"%"===n&&(e=t*i/100)}return C.FormatResult(e)},C.IsOverFlow=function(t){var t=parseFloat(t);if(0!==t){if(79e27<t)return!0;if(t<1e-28&&-1e-28<t)return!0;if(t<-79e27)return!0}return!1},v=C,m.prototype.HU=function(){var t=this;t.Y6="",t._x=null,t._y=null,t.NU=null,t.kU=0,t.EU=!1,t.jU=!1},m.prototype.Click=function(t){var i,t,i=this;return 0<=t&&t<=11&&(i.OU&&(i.zU(t),i.OU=!1),i.VU(t),10!==t)&&(i.RU="ClickNumericButton"),(12<=t&&t<=19||27===t)&&(i.OU?(i.zU(t),i.OU=!1):(i.YU(t),i.RU="ClickMathButton")),24===t&&(i.OU&&(i.zU(t),i.OU=!1),i.ZU()),25!==t&&26!==t||(i.zU(t),i.OU=!1),i.OU?null:((t={}).outputText=i.WU(),d.IsErrorText(i.Y6)&&(i.OU=!0),t.result=void 0===i.Y6||null===i.Y6?"":i.Y6,t.x=i._x,t.y=i._y,t.operation=i.NU,t.token=i.kU,t.count=i.DU,t.memoryNumber=i._U,t.isBSCanUse=i.EU,t.isEqualClicked=i.jU,t.isOperationInvalid=i.OU,t.lastOperation=i.RU,t)},m.prototype.VU=function(t){var i=this;if(null!==i.Y6&&void 0!==i.Y6||(i.Y6=""),!(14<i.DU&&10!==t))switch(11!==t&&10!==t&&(0!==t||i.Y6+""!="0"&&""!==i.Y6)&&i.DU++,10!==t&&(i.EU=!0),i.kU){case 0:0<=t&&t<=9&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0"),"0"===i.Y6&&0!==t?i.Y6=""+t:"0"!==i.Y6&&(i.Y6=i.Y6+""+t)),10===t&&(-1===i.Y6.toString().indexOf("e")?""!==i.Y6&&"0"!==i.Y6&&(-1===i.Y6.toString().indexOf("-")?i.Y6="-"+i.Y6:i.Y6=i.Y6.toString().substring(1,i.Y6.toString().length)):0<+i.Y6?i.Y6="-"+i.Y6:i.Y6=i.Y6.substring(1,i.Y6.length)),11===t&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0."),""===i.Y6||v.IsDotContained(i.Y6)?""!==i.Y6&&v.IsDotContained(i.Y6)||(i.Y6="0."):i.Y6=i.Y6+"."),i.kU=1;break;case 1:0<=t&&t<=9&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0"),"0"===i.Y6&&0===t||("0"===i.Y6&&0!==t?i.Y6=""+t:i.Y6=i.Y6+""+t)),10===t&&(-1===i.Y6.toString().indexOf("e")?""!==i.Y6&&"0"!==i.Y6&&(-1===i.Y6.toString().indexOf("-")?i.Y6="-"+i.Y6:i.Y6=i.Y6.toString().substring(1,i.Y6.toString().length)):0<+i.Y6?i.Y6="-"+i.Y6:i.Y6=i.Y6.substring(1,i.Y6.length)),11===t&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU?i.Y6="0.":v.IsDotContained(i.Y6)||(""===i.Y6?i.Y6="0.":i.Y6=i.Y6+".")),i.jU||(i._y=i.Y6);break;case 2:0<=t&&t<=9&&(i.Y6="",i.Y6=i.Y6+t),11===t&&(i.Y6="0."),10===t&&(i.Y6="0"),i.kU=3,i._y=i.Y6;break;case 3:0<=t&&t<=9&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0"),"0"===i.Y6&&0===t||("0"===i.Y6&&0!==t?i.Y6=""+t:i.Y6=i.Y6+""+t)),10===t&&(-1===i.Y6.toString().indexOf("e")?""!==i.Y6&&"0"!==i.Y6&&(-1===i.Y6.toString().indexOf("-")?i.Y6="-"+i.Y6:i.Y6=i.Y6.toString().substring(1,i.Y6.toString().length)):0<+i.Y6?i.Y6="-"+i.Y6:i.Y6=i.Y6.substring(1,i.Y6.length)),11===t&&("ClickNumericButton"!==i.RU&&null!==i.RU?i.Y6="0.":v.IsDotContained(i.Y6)||(""===i.Y6?i.Y6="0.":i.Y6=i.Y6+".")),i._y=i.Y6}},m.prototype.YU=function(t){var i=this;switch(i.DU=0,i.EU=!1,i.jU&&(i.jU=!1),i.Y6=v.FormatOutput(i.Y6),i.kU){case 0:""===i.Y6&&(i.Y6=0),(16<=t&&t<=18&&17!==t||27===t)&&(i.Y6=v.SingleMathOperation(i.Y6,i.BU[t]).toString(),d.IsErrorText(i.Y6)||(i._x=i.Y6),i.kU=1),12<=t&&t<=15&&(i.NU=t,i._x=i.Y6,i.kU=2),17===t&&i.HU();break;case 1:(16<=t&&t<=18&&17!==t||27===t)&&(i.Y6=v.SingleMathOperation(i.Y6,i.BU[t]).toString(),d.IsErrorText(i.Y6)||(null!==i.NU&&void 0!==i.NU&&null!==i._y&&void 0!==i._y?i._y=i.Y6:i._x=i.Y6)),19===t&&(null!==i.NU&&void 0!==i.NU&&null!==i._y&&void 0!==i._y?(i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[i.NU]).toString(),d.IsErrorText(i.Y6)||(i._x=i.Y6)):"-0."===i.Y6&&(i.Y6="0."),i.jU=!0,i.EU=!1),12<=t&&t<=15&&(i.NU=t,i._x=i.Y6,i.kU=2),17===t&&(null!==i.NU&&void 0!==i.NU?(i._y=i.Y6,i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[17]).toString(),i._y=i.Y6):i.HU());break;case 2:(16<=t&&t<=18&&17!==t||27===t)&&(i.Y6=v.SingleMathOperation(i.Y6,i.BU[t]).toString(),d.IsErrorText(i.Y6)||(i.kU=3,i._y=i.Y6)),19===t&&(i._y=i._x,i.Y6=v.DoubleMathOperation(i._x.toString(),i._x.toString(),i.BU[i.NU]).toString(),d.IsErrorText(i.Y6)||(i._x=i.Y6,i.kU=1,i.EU=!1),i.jU=!0),12<=t&&t<=15&&(i.NU=t,i._y=i.Y6),17===t&&(i.Y6=v.DoubleMathOperation(i._x.toString(),i._x.toString(),i.BU[17]),d.IsErrorText(i.Y6)||(i._y=i.Y6,i.kU=3));break;case 3:16<=t&&t<=18&&17!==t&&(i.Y6=v.SingleMathOperation(i.Y6,i.BU[t]).toString(),d.IsErrorText(i.Y6)||(i._y=i.Y6)),12<=t&&t<=15&&(i._y=i.Y6,i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[i.NU]).toString(),d.IsErrorText(i.Y6)||(i._x=i.Y6,i._y=null,i.NU=t,i.kU=2)),17===t&&(i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[17]),d.IsErrorText(i.Y6)||(i._y=i.Y6)),19===t&&(i._y=i.Y6,i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[i.NU]).toString(),d.IsErrorText(i.Y6)||(i._x=i.Y6,i.kU=1,i.EU=!1),i.jU=!0)}i.Y6+=""},m.prototype.ZU=function(){var t,i,n,t=this;if(0<t.DU&&t.DU--,(0===t.kU||1===t.kU||3===t.kU)&&!0===t.EU)switch(t.Y6+="",(i=0)<(n=t.Y6.length)&&(t.Y6=t.Y6.substring(0,n-1)),"-0"===t.Y6&&(t.Y6="0"),"-"===t.Y6&&(t.Y6=""),""===t.Y6&&(t.EU=!1),t.kU){case 0:case 1:t._x=t.Y6;break;case 3:t._y=t.Y6}},m.prototype.zU=function(t){var i=this;i.DU=0,i.EU=!1,i.Y6="",25===t&&(1!==i.kU||null===i.NU||void 0===i.NU||i.jU||(i._y=0),2===i.kU)&&(i.kU=3),26===t&&i.HU()},m.prototype.WU=function(){var t,i,t=this,i="";return i=""===t.Y6||null===t.Y6||void 0===t.Y6?"0":t.Y6},m.prototype.mf=function(t){var i=t.keyCode;switch(t.shiftKey&&(i|=65536),t.ctrlKey&&(i|=131072),t.altKey&&(i|=262144),i){case 131138:case 131140:case 131141:case 131144:case 131145:case 131148:case 131150:case 131154:case 131159:case 131188:case 262181:case 262183:case 117:case 65657:case 131081:case 196617:case 9:case 65545:case 121:case 123:return null;case 48:case 96:return 0;case 49:case 97:return 1;case 50:case 98:return 2;case 51:case 99:return 3;case 52:case 100:return 4;case 53:case 101:return 5;case 54:case 102:return 6;case 55:case 103:return 7;case 56:case 104:return 8;case 57:case 105:return 9;case 120:return 10;case 190:case 188:case 110:return 11;case 65723:case 107:return 12;case 65643:if(D.IsIE)break;return 12;case 189:case 109:return 13;case 65592:case 106:case 65722:return 14;case 191:case 111:return 15;case 65586:case 192:return 16;case 65589:return 17;case 82:return 18;case 13:return 19;case 393292:return 20;case 393298:return 21;case 393293:return 22;case 393296:return 23;case 8:return 24;case 46:return 25;case 27:case 131118:return 26;default:return 61===i&&D.firefox||187===i&&!D.firefox?19:-1}},w=m,T=o.BaseDropdown,e(p,T),p.prototype.setValue=function(t){var i,t,i=this;t=i.QU(t);try{if(!i.q8(t))throw new Error(u().Calculator_InvalidInputInfo);t=""===t?"0":t,i.Y6=i.KU(t),i._text=i.JU(t),i._x=parseFloat(i.Y6),i._y=null,i.NU=null,i.kU=0,i.DU=i.XU(parseFloat(i.Y6)),0<i.DU?i.EU=!0:i.EU=!1,i.jU=!1,i.OU=!1,i.RU=null}catch(t){i._text=u().Calculator_InvalidInputInfo,i.Y6="",i._x=null,i._y=null,i.OU=!0}return i.qU(i.OU),i.UU(i._text),(t={}).outputText=i._text,t.result=i.Y6,t.x=i._x,t.y=i._y,t.operation=i.NU,t.token=i.kU,t.count=i.DU,t.memoryNumber=i._U,t.isBSCanUse=i.EU,t.isEqualClicked=i.jU,t.isOperationInvalid=i.OU,t.lastOperation=i.RU,i.$U=new w(i.Y6,i._x,i._y,i.NU,i.kU,i.DU,i._U,i.EU,i.jU,i.OU,i.RU),i},p.prototype.setOptions=function(){},p.prototype.scrollToSelect=function(){var t=this.Ti.querySelector(".gc-main-screen .gc-main");this.tH(t)},p.prototype.LU=function(){var t=this;t.nH="0",t._text=t.nH,t.Y6="",t._x=0,t._y=0,t.NU=null,t.kU=0,t.DU=0,t._U=null,t.EU=!1,t.jU=!1,t.OU=!1,t.RU=null},p.prototype.FU=function(){var t=this;t.$U=new w(this.Y6,t._x,t._y,t.NU,t.kU,t.DU,t._U,t.EU,t.jU,t.OU,t.RU)},p.prototype.PU=function(){var t=this;t.qU(t.OU)},p.prototype.GU=function(){var n,e,s,t,i,n=this,e=this,s=e.Ti,t,i=function(t){!0!==e.mf(t)&&(t.preventDefault(),t.stopPropagation())};s.addEventListener("click",function(t){for(var i,t,t,i=t.srcElement||t.target;i&&!i.classList.contains("button");)i=i.parentElement;i&&(i.getAttribute("data-value")?(t=i.getAttribute("data-value"),t=p.eH(t),s.focus(),-1!==t&&e.iH(t)):i.classList.contains("okbtn")&&("ClickNumericButton"===e.RU&&e.iH(19),n.fire(o.BaseDropdown.Event_ValueChanged,{value:e._text,text:e._text})))}),s.addEventListener("keydown",i),s.addEventListener("contextmenu",function(t){t.preventDefault(),t.stopPropagation()})},p.prototype.UU=function(t){var i,n,i=this.Ti.querySelector(".gc-main-screen .gc-main"),n=i.value;null!=n&&n.toString().replace(/\r\n/g,"\n")!==t.toString().replace(/\r\n/g,"\n")&&(i.value=t,this.tH(i))},p.prototype.tH=function(t){var i=this;if(null!==i.rH&&void 0!==i.rH||(i.rH=b(t)),i.oH(t))for(;i.oH(t);)i.aH(t);else i.uH(t)},p.prototype.oH=function(t){var i,n,e,i,s,o;return 1<t.scrollWidth-t.clientWidth||!(!r.mt.Tt.edge&&!r.mt.Tt.msie||t.clientWidth<=0)&&(n=(i=window.getComputedStyle(t)).fontWeight,e=i.fontSize,i=i.fontFamily,(o=r.q.Wt(t.value,s=n+" "+e+" "+i))+40>t.clientWidth)},p.prototype.aH=function(t){var i=b(t);t.style.fontSize="".concat(i-1,"px")},p.prototype.uH=function(t){for(var i,n,i=this,n=b(t);!i.oH(t)&&n<i.rH;)if(t.style.fontSize="".concat(++n,"px"),i.oH(t)){for(;i.oH(t);)i.aH(t);break}},p.prototype.QU=function(t){if(void 0!==t&&("string"==typeof t||t instanceof String))return(t=null==t?"":t).toString();throw new Error(t+" type is not a string.")},p.prototype.sH=function(t,i){var n,e,s,o;if(0===i.length)return"";for(n="",s=e=0;e<i.length;e++){for(o=!1,s=0;s<t.length;s++)i.substring(e,e+1)===t.substring(s,s+1)&&(o=!0);!0===o&&(n+=i.substring(e,e+1))}return n},p.prototype.q8=function(t){var i;return this.sH("-.0123456789",t)===t&&(-1===(i=t.indexOf("-"))||0===i)&&t.indexOf("-")===t.lastIndexOf("-")&&t.indexOf(".")===t.lastIndexOf(".")},p.prototype.KU=function(t){var t,i,t,n,e,s,o,t=parseFloat(t),i=t<0?!0:!1,t=M(t),n=l(t),e=v.GetDotPosition(t.toString()),s=(t*g(10,e)-n*g(10,e))/g(10,e);if(999999999999999<n)throw new Error(u().Calculator_InvalidInputInfo);return 999999999999999!==n?(o=0===n?15:15-n.toString().length,s=h(s*g(10,o))/g(10,o),e=v.GetDotPosition(s.toString()),t=(n*g(10,e)+s*g(10,e))/g(10,e),n=l(t),e=v.GetDotPosition(t.toString()),0===(s=(t*g(10,e)-n*g(10,e))/g(10,e))&&(t=n),i?"-"+t:""+t):0===s?n:void 0},p.prototype.JU=function(t){var t=t.toString();return t=""===t?"0":t},p.prototype.XU=function(t){var t,i,n,t,e,s,t=M(t),i=l(t),n=v.GetDotPosition(t.toString()),t=(t*g(10,n)-i*g(10,n))/g(10,n),e,s;return(0===i?0:i.toString().length)+(0==t?0:n)},p.prototype.qU=function(t){for(var i=10;i<=18;i++)this.cH(i,t);this.cH(27,t)},p.prototype.cH=function(t,i){var t,t,t=f[t],t=this.Ti.querySelector('[data-value="'+t.toLowerCase()+'"]');t&&(i?t.classList.add("disabled"):t.classList.remove("disabled"))},p.eH=function(t){var i=-1;switch(t){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":i=parseInt(t,10);break;case"+/-":i=10;break;case".":i=11;break;case"+":i=12;break;case"-":i=13;break;case"*":i=14;break;case"/":i=15;break;case"sqrt":i=16;break;case"%":i=17;break;case"1/x":i=18;break;case"=":i=19;break;case"MC":i=20;break;case"MR":i=21;break;case"MS":i=22;break;case"M+":i=23;break;case"BS":i=24;break;case"CE":i=25;break;case"C":i=26;break;case"pow":i=27;break;default:i=-1}return i},p.prototype.iH=function(t){var i,t,i=this,t=i.$U.Click(t);null!=t&&(null!==t.result&&void 0!==t.result&&(i.Y6=t.result),null!==t.outputText&&void 0!==t.outputText&&(i.nH=t.outputText,i._text=i.nH,i.UU(i.nH)),null!==t.isOperationInvalid&&void 0!==t.isOperationInvalid&&t.isOperationInvalid!==i.OU&&(i.OU=t.isOperationInvalid,i.qU(i.OU)),t.memoryNumber!==i._U&&(i._U=t.memoryNumber),t.lastOperation!==i.RU)&&(i.RU=t.lastOperation)},p.prototype.mf=function(t){var t=this.$U.mf(t);return null==t||-1!==t&&void this.iH(t)},i.Calculator=p},"./dist/plugins/celltype/editor/calendar.js":function(U,t,i){"use strict";var n,Z,G,o,e,c,r,i,N,e,u,B,a,Q,Y,P,R,W,H,V,J,F,X,l,f,_,K,q,$,tt,it,nt,et,st,D,d,M,g,ot,h,I,ct,s,rt,ut,v,w,at,j,A,T,lt,Mt,gt,ht,It,Nt,ft,Dt,dt,vt,wt,jt,At,b,Tt,y,bt,yt,zt,Ct,z,mt,C,m,pt,Lt,xt,St,p,Ot,kt,Et,Ut,Zt,Gt,Bt,Qt,i,Yt,Pt,Rt;function L(t){return B.createElement(t)}function Wt(){}function Ht(){this.yearTds=[]}function Vt(){this.monthTds=[]}function Jt(){this.weekThs=[],this.dayTds=[]}function Ft(){this.calendarYearSection=new pt,this.calendarMonthSection=new Lt,this.calendarDaySection=new xt,this.timeItemLIs=[]}function x(){}function Xt(t,i,n,e){this.year=t,this.selected=!!i,this.disabled=!!n,this.focused=!!e}function _t(t,i,n,e){this.month=t,this.selected=!!i,this.disabled=!!n,this.focused=!!e}function Kt(t,i,n,e){this.date=t,this.selected=!!i,this.disabled=!!n,this.focused=!!e}function S(t){this.owner=t,this.calendarPage=r.CalendarPage.month,this.oldSelectedData=null,this.S1e=null,this.T1e={start:p.getDefaultDate(),end:p.getDefaultDate()},this.selectedDate=new Date,this.updateDayFocusDate(),this.focusDateTimeIndex=-1,m.initResource()}function O(t){var i=Yt.call(this)||this;return i.fH=40,i.lH=100,i.hH=!1,i.jS=t,i}function k(t,i,n,e){var s=Pt.call(this,t)||this;return s.dH=7,s.HG=!0,n&&(s.parent=n,s.A1e=!0,s.HG=!1,s.N1e=e),s._data=new Ut(s),s.Dn=new Zt(s),s.Dn.on(o.BaseDropdown.Event_ValueChanged,function(t){var i,i,i=c.Common.CultureManager.getCultureInfo().DateTimeFormat,i=new c.Formatter.GeneralFormatter(i.defaultDatePattern).format(t.newValue);s.fire(o.BaseDropdown.Event_ValueChanged,{text:i,value:t.newValue})}),s.Dn.on(Zt.Event_GetHost,function(t){t.host=s.Ti}),s.A1e||(s.Ti.innerHTML=""),s.Ti.appendChild(s.Dn.createCalendarDom()),s.Dn.attachEvent(),s.A1e||s.setValue(new Date),s.Dn.showCalendarPage(r.CalendarPage.day),s.Dn.setCalendarActivePart(C.Date),i&&s.setOptions(i),s}function E(t,i){var t=Rt.call(this,t)||this;return t.D1e=0,t.S1e=null,t.T1e={start:p.getDefaultDate(),end:p.getDefaultDate()},t._1e(i),t.aY(),t}n=this&&this.__extends||(Qt=function(t,i){return(Qt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}Qt(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.RangeCalendar=t.Calendar=void 0,Z=i("./dist/plugins/celltype/editor/eventbase.js"),G=i("./dist/plugins/celltype/editor/timepicker.js"),o=i("./dist/plugins/celltype/editor/baseControl.js"),e=i("./dist/plugins/celltype/celltypes.ns.js"),c=i("Common"),r=i("Core"),i=new c.Common.ResourceManager(e.SR,"CellTypes"),N=i.getResource.bind(i),e=c.Common.lt,u=e.ht,B=document,a="gc-calendar-container",Q="gc-date-ranges-calendar",Y="gc-range-calendar-container",P="gc-date-range-container",R="gc-date-time-container",W="gc-date-part-container",H="gc-time-part-container",V="gc-ok-button-container",J="gc-date-container",F="gc-week-container",X="gc-today-container",l="gc-content-container",f="gc-header-container",_="gc-header-title",K="gc-content-td-date",q="gc-content-td-time",$="gc-date-time-vertical-partline",tt="gc-date-time-horizontal-partline",it="gc-year-page",nt="gc-year-select-div",et="gc-month-page",st="gc-day-page",D="gc-left-arrow",d="gc-right-arrow",M="gc-arrow-disable",g="gc-is-focused",ot="gc-cl-select",h="gc-cl-is-selected",I="gc-cl-disabled-text",ct="gc-cl-select-container",s="gc-focus-part-indicator",rt="gc-cl-datepicker",ut="gc-cl-dropdown",v="gc-cl-datepicker-filter",w="gc-cl-datepicker-filter-month",at="gc-cl-grid-align-spread",j="gc-cl-align-middle",A="gc-cl-button-icon-container",T="gc-cl-datepicker-month",lt="gc-cl-day",Mt="gc-cl-week",gt="gc-cl-show-inline-block",ht="gc-builtIn-date-Range-child-div",It="gc-builtIn-date-ranges-div",Nt="gc-date-ranges-result-div",ft="gc-date-ranges-result-button",Dt="gc-builtIn-date-range-childDiv-select",dt="gc-date-ranges-result-buttonDiv",vt="gc-date-ranges-result-input",wt="gc-cl-p-bottom-x-small",jt="gc-cl-shrink-none",At="gc-cl-grow",b="gc-cl-grid",Tt="gc-uiButton",y="gc-cl-button",bt="gc-cl-button-brand",yt="year-index",zt="month-index",Ct="week-index",z="day-index",mt="dateRange-index",(i=C=C||{})[i.Date=1]="Date",i[i.Time=2]="Time",Wt.initResource=function(){Wt.resource={shortWeeks:[N().Calendar_ShortWeeks_1,N().Calendar_ShortWeeks_2,N().Calendar_ShortWeeks_3,N().Calendar_ShortWeeks_4,N().Calendar_ShortWeeks_5,N().Calendar_ShortWeeks_6,N().Calendar_ShortWeeks_7],shortMonths:[N().Calendar_ShortMonths_1,N().Calendar_ShortMonths_2,N().Calendar_ShortMonths_3,N().Calendar_ShortMonths_4,N().Calendar_ShortMonths_5,N().Calendar_ShortMonths_6,N().Calendar_ShortMonths_7,N().Calendar_ShortMonths_8,N().Calendar_ShortMonths_9,N().Calendar_ShortMonths_10,N().Calendar_ShortMonths_11,N().Calendar_ShortMonths_12],weeks:[N().Calendar_Weeks_7,N().Calendar_Weeks_1,N().Calendar_Weeks_2,N().Calendar_Weeks_3,N().Calendar_Weeks_4,N().Calendar_Weeks_5,N().Calendar_Weeks_6],months:[N().Calendar_Months_1,N().Calendar_Months_2,N().Calendar_Months_3,N().Calendar_Months_4,N().Calendar_Months_5,N().Calendar_Months_6,N().Calendar_Months_7,N().Calendar_Months_8,N().Calendar_Months_9,N().Calendar_Months_10,N().Calendar_Months_11,N().Calendar_Months_12],timePrefix:[N().Calendar_Time_AM,N().Calendar_Time_PM],eraNames:[N().Calendar_EraName_1,N().Calendar_EraName_2,N().Calendar_EraName_3,N().Calendar_EraName_4],earFirstYear:N().Calendar_FirstYear,today:N().Calendar_Today,lastMonth:N().Calendar_LastMonth,nextMonth:N().Calendar_NextMonth,lastYear:N().Calendar_LastYear,nextYear:N().Calendar_NextYear,lastTenYears:N().Calendar_LastTenYear,nextTenYears:N().Calendar_NextTenYear}},Wt.resource={shortWeeks:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],shortMonths:["Jan","Feb","Mar","Api","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weeks:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],months:["January","February","March","Apirl","May","June","July","August","September","October","November","December"],timePrefix:["AM","PM"],eraNames:["M","T","S","H"],earFirstYear:"1",today:"Today",lastMonth:"Go to previous month",nextMonth:"Go to next month",lastYear:"Go to previous year",nextYear:"Go to next year",lastTenYears:"Go to previous ten years",nextTenYears:"Go to next ten years"},m=Wt,pt=Ht,Lt=Vt,xt=Jt,St=Ft,x.dateEqual=function(t,i,n){if(!t&&!i)return!0;if(!t)return!1;if(!i)return!1;try{return n?t.getFullYear()===i.getFullYear()&&t.getMonth()===i.getMonth()&&t.getDate()===i.getDate()&&t.getHours()===i.getHours()&&t.getMinutes()===i.getMinutes()&&t.getSeconds()===i.getSeconds():t.getFullYear()===i.getFullYear()&&t.getMonth()===i.getMonth()&&t.getDate()===i.getDate()}catch(t){return!1}},x.getMonthMaxDay=function(t,i){return-1!==[1,3,5,7,8,10,12].indexOf(i)?31:-1!==[4,6,9,11].indexOf(i)?30:t%4==0&&t%100!=0?29:28},x.isValidEraDate=function(t){return!(t<this.eraMin||t>this.eraMax)},x.addMilliseconds=function(t,i){var t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return t.setMilliseconds(t.getMilliseconds()+i),new Date(t.valueOf())},x.getEraDate=function(t){var i,n,e,i={era:-1,eraYear:-1};if(x.isValidEraDate(t))for(n=0;n<x.eraCount;n++)if(t<(e=n+1!==x.eraCount?x.eraDates[n+1]:x.addMilliseconds(x.eraMax,1))){i.era=n,i.eraYear=t.getFullYear()-x.eraDates[n].getFullYear()+1;break}return i},x.getEraYearString=function(t){var i,i,i=new Date(t,5,30),i=x.getEraDate(i);return-1===i.era||-1===i.eraYear?t.toString():t.toString()+"\u5e74"},x.getShortEraYearString=function(t){var t,t,i,t=new Date(t,11,31),t=x.getEraDate(t);return-1===t.era||-1===t.eraYear?"":(i=1===t.eraYear?m.resource.earFirstYear:t.eraYear,m.resource.eraNames[t.era]+i+"\u5e74")},x.getDateLocaleLabel=function(t){var i,t,n,e,s,i=t.getHours(),t=t.getMinutes(),n,e,s;return(i<12?m.resource.timePrefix[0]:m.resource.timePrefix[1])+" "+(0===i||12===i?"12":(i%12).toString())+":"+(t<10?"0"+t.toString():t.toString())},x.getBuiltInDateRanges=function(){var t,i,n,e,s,o,c,e,t=new Date,i=new Date(t.getFullYear(),t.getMonth(),t.getDate());return i.setDate(t.getDate()-1),(n=new Date(t)).setDate(t.getDate()-6),e=t.getFullYear(),s=t.getMonth(),o=new Date(e,s,1),c=new Date(e,s-1,1),e=new Date(e,s+1,0),[[N().Calendar_BuiltIn_Today,{start:new Date(t.getFullYear(),t.getMonth(),t.getDate()),end:new Date(t.getFullYear(),t.getMonth(),t.getDate())}],[N().Calendar_BuiltIn_Yesterday,{start:new Date(i.getFullYear(),i.getMonth(),i.getDate()),end:i}],[N().Calendar_BuiltIn_Last7Days,{start:new Date(n.getFullYear(),n.getMonth(),n.getDate()),end:new Date(t.getFullYear(),t.getMonth(),t.getDate())}],[N().Calendar_BuiltIn_ThisMonth,{start:new Date(o.getFullYear(),o.getMonth(),1),end:new Date(o.getFullYear(),o.getMonth(),e.getDate())}],[N().Calendar_BuiltIn_LastMonth,{start:new Date(c.getFullYear(),c.getMonth(),1),end:new Date(o.getFullYear(),o.getMonth(),0)}]]},x.getDefaultDate=function(){var t=new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())},x.getNextMonth=function(t){var i,t,n,i=t.getFullYear(),t=t.getMonth()+1,n=new Date(i,t,1);return 12===t&&(n.setFullYear(i+1),n.setMonth(0)),n},x.getPreviousMonth=function(t){var i,t,n,i=t.getFullYear(),t=t.getMonth()-1,n=new Date(i,t,1);return-1==t&&(n.setFullYear(i-1),n.setMonth(11)),n},x.getFirstDayOfMonth=function(t){var i,t,i=t.getFullYear(),t=t.getMonth();return new Date(i,t,1)},x.getShortDate=function(t){var i,t;return u(t)?t:(i=t.start,t=t.end,{start:new Date(i.getFullYear(),i.getMonth(),i.getDate()),end:new Date(t.getFullYear(),t.getMonth(),t.getDate())})},x.eraCount=4,x.eraMax=new Date(2087,11,31,23,59,59),x.eraMin=new Date(1868,8,8),x.eraDates=new Array(new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)),p=x,Xt.prototype.getLabel=function(){return this.year.toString()},Ot=Xt,_t.prototype.getLabel=function(){return m.resource.shortMonths[this.month]},kt=_t,Kt.prototype.getLabel=function(){return this.date.getDate().toString()},Et=Kt,S.getMonthName=function(t){return m.resource.months[t]},S.getShortMonthName=function(t){return m.resource.shortMonths[t]},Object.defineProperty(S.prototype,"RangeCalendar",{get:function(){return this.owner&&this.owner.parent},enumerable:!1,configurable:!0}),S.prototype.updateDayFocusDate=function(){var t,i;this.owner.A1e?(t=this.T1e,1===this.owner.N1e?this.focusDate=p.getFirstDayOfMonth(t.start):2===this.owner.N1e&&(i=void 0,i=t.end.getFullYear()===t.start.getFullYear()&&t.end.getMonth()===t.start.getMonth()?p.getNextMonth(t.start):p.getFirstDayOfMonth(t.end),this.focusDate=i)):this.focusDate=new Date(this.selectedDate.valueOf())},S.prototype.updateDayItems=function(){var t,i,n,e,s,o,c,r,u,a,l;for(this.dayItems=[],t=this.focusDate.getFullYear(),i=this.focusDate.getMonth(),r=c=((o=(e=(n=new Date(t,i,1)).getDay())-(s=this.owner.dH))<0?7+o:o)%7;0<r;r--)(u=new Date(t,i,1)).setDate(u.getDate()-r),a=new Et(u,!1,!0,!1),this.dayItems.push(a);for(r=1;r<=42-c;r++)u=new Date(t,i,r),a=new Et(u),u.getMonth()!==i&&(a.disabled=!0),this.owner.A1e?(l=this.T1e,(p.dateEqual(u,l.start)||p.dateEqual(u,l.end))&&(a.selected=!0),u>l.start&&(u<l.end||this.E1e&&u<=this.E1e)&&!a.disabled&&(a.focused=!0)):(p.dateEqual(u,this.selectedDate)&&(a.selected=!0),p.dateEqual(u,this.focusDate)&&(a.focused=!0)),this.dayItems.push(a)},S.prototype.updateMonthItems=function(){var t,i,n,n,e;for(this.monthItems=[],t=0;t<12;t++)i=new kt(t),this.owner.A1e?(n=this.T1e,i.selected=n.start.getMonth()===t||n.end.getMonth()===t,i.focused=n.start.getMonth()<t&&n.end.getMonth()>t):(n=this.selectedDate,e=this.focusDate,i.selected=n&&n.getMonth()===t&&n.getFullYear()===e.getFullYear(),i.focused=e&&e.getMonth()===t),this.monthItems.push(i)},S.prototype.updateYearItems=function(){var t,i,n;for(this.yearItems=[],t=this.focusDateYearRangeStart-1;t<=this.focusDateYearRangeEnd+1;t++)i=new Ot(t),this.owner.A1e?(n=this.T1e,i.selected=n.start.getFullYear()===t||n.end.getFullYear()===t,i.focused=n.start.getFullYear()<t&&n.end.getFullYear()>t):(i.selected=this.selectedDate&&this.selectedDate.getFullYear()===t,i.focused=this.focusDate&&this.focusDate.getFullYear()===t,i.disabled=t<this.focusDateYearRangeStart||t>this.focusDateYearRangeEnd),this.yearItems.push(i)},S.prototype.updateYearRange=function(){this.focusDateYearRangeStart=10*Math.floor(this.focusDate.getFullYear()/10),this.focusDateYearRangeEnd=this.focusDateYearRangeStart+9},S.prototype.getShortWeekName=function(t){var i,n,i,n;return m.resource.shortWeeks[t=(this.owner.dH+t-1)%7]},S.prototype.getCurrentMonthName=function(){var t=this.focusDate.getMonth();return S.getMonthName(t)},S.prototype.updateCalendarData=function(t){t?(this.T1e=t.selectedDateRange,this.S1e=t.oldSelectedDateRange,this.E1e=t.hoverDate):this.RangeCalendar.notifyCalendarData({selectedDateRange:this.T1e,oldSelectedDateRange:this.S1e,hoverDate:this.E1e})},Ut=S,Yt=Z.EventBase,n(O,Yt),Object.defineProperty(O.prototype,"host",{get:function(){return this.jS.getContainer()},enumerable:!1,configurable:!0}),O.prototype.createCalendarDom=function(){var t,i,n,e,s,e,t,t=this.jS;return this.mH=new St,i=L("div"),this.jS.A1e?i.className=a+" "+P:i.classList.add(a),t.HG?i.classList.add(R):i.classList.add(J),n=L("table"),e=L("tr"),(s=L("td")).classList.add(K),t.HG&&s.classList.add(q),s.appendChild(this.gH()),e.appendChild(s),n.appendChild(e),i.appendChild(n),t.HG&&(e=L("tr"),t=L("td"),s.appendChild(this.pH()),s.appendChild(this.bH()),t.appendChild(this.yH()),t.appendChild(this.wH()),e.appendChild(t),n.appendChild(e)),this.mH.outerContainerDiv=i},O.prototype.wH=function(){var t,i,t=L("div");return t.classList.add(V),(i=L("button")).textContent=N().OK,i.className=y+" "+bt+" "+Tt,t.appendChild(i),this.mH.okButton=i,t},O.prototype.pH=function(){var t=L("div");return t.classList.add($),t},O.prototype.yH=function(){var t=L("div");return t.classList.add(tt),t},O.prototype.gH=function(){var t=L("div");return t.className=W+" "+rt+" "+ut,t.tabIndex=0,t.appendChild(this.MH()),t.appendChild(this.CH()),t.appendChild(this.SH()),this.mH.dateContainerDiv=t},O.prototype.MH=function(){var t=L("div");return t.classList.add(it),t.appendChild(this.TH()),t.appendChild(this.AH()),t},O.prototype.TH=function(){var t,i,n,e,s,s,o,c,c,t=L("div");return t.className=f+" "+v+" "+b,(i=L("div")).className=w+" "+b+" "+at+" "+At,(n=L("div")).classList.add(j),(e=L("button")).className=y+" "+A,e.title=N().Calendar_LastTenYear,e.setAttribute("type","button"),(s=L("div")).classList.add(D),e.appendChild(s),(s=L("span")).classList.add(j),(o=L("button")).className=y+" "+A,o.title=N().Calendar_NextTenYear,o.setAttribute("type","button"),(c=L("div")).classList.add(d),o.appendChild(c),i.appendChild(e),i.appendChild(s),i.appendChild(o),(c=this.mH.calendarYearSection).headerDiv=t,c.lastYearRangeButton=e,c.focusDateYearRangeName=s,c.nextYearRangeButton=o,t.appendChild(i),t},O.prototype.AH=function(){var t,i,t=L("table");return t.className=l+" "+T,(i=L("div")).appendChild(t),this.mH.calendarYearSection.currentYearRangeTable=t,this.IH(),i},O.prototype.IH=function(){for(var t,i,n,e,s,o,c,t=this.mH.calendarYearSection,i=L("tbody"),n=0;n<3;n++){for(e=L("tr"),s=0;s<4;s++)(o=L("td")).setAttribute(yt,(4*n+s).toString()),(c=L("span")).classList.add(lt),c.setAttribute(yt,(4*n+s).toString()),c.innerText=(4*n+s+1).toString(),o.appendChild(c),e.appendChild(o),t.yearTds.push(o);i.appendChild(e)}t.currentYearRangeTable.appendChild(i)},O.prototype.CH=function(){var t=L("div");return t.classList.add(et),t.appendChild(this.xH()),t.appendChild(this.NH()),t},O.prototype.xH=function(){var t,i,n,e,s,s,o,c,c,t=L("div");return t.className=f+" "+v+" "+b,(i=L("div")).className=w+" "+b+" "+at+" "+At,(n=L("div")).classList.add(j),(e=L("button")).className=y+" "+A,e.title=N().Calendar_LastYear,e.setAttribute("type","button"),(s=L("div")).classList.add(D),e.appendChild(s),(s=L("span")).className=_+" "+j,(o=L("button")).className=y+" "+A,o.title=N().Calendar_NextYear,o.setAttribute("type","button"),(c=L("div")).classList.add(d),o.appendChild(c),i.appendChild(e),i.appendChild(s),i.appendChild(o),(c=this.mH.calendarMonthSection).headerDiv=t,c.lastYearButton=e,c.currentYearName=s,c.nextYearButton=o,t.appendChild(i),t},O.prototype.NH=function(){var t,i,t=L("table");return t.className=l+" "+T,(i=L("div")).appendChild(t),this.mH.calendarMonthSection.currentYearTable=t,this.kH(),i},O.prototype.kH=function(){for(var t,i,n,e,s,o,c,t=this.mH.calendarMonthSection,i=L("tbody"),n=0;n<3;n++){for(e=L("tr"),s=0;s<4;s++)(o=L("td")).setAttribute(zt,(4*n+s+1).toString()),(c=L("span")).classList.add(lt),c.setAttribute(zt,(4*n+s+1).toString()),c.innerText=(4*n+s+1).toString(),o.appendChild(c),e.appendChild(o),t.monthTds.push(o);i.appendChild(e)}t.currentYearTable.appendChild(i)},O.prototype.SH=function(){var t=L("div");return t.classList.add(st),t.appendChild(this._H()),t.appendChild(this.EH()),t.appendChild(this.jH()),this.jS.A1e||t.appendChild(this.OH()),t},O.prototype._H=function(){var t,i,n,e,s,s,o,c,c,r,u,a,l,M,g,h,I,a,t=L("div");for(t.className=f+" "+v+" "+b,(i=L("div")).className=w+" "+b+" "+at+" "+At,(n=L("div")).classList.add(j),(e=L("button")).className=y+" "+A,e.title=N().Calendar_LastMonth,e.setAttribute("type","button"),(s=L("div")).classList.add(D),e.appendChild(s),(s=L("span")).className=_+" "+j,(o=L("button")).className=y+" "+A,o.title=N().Calendar_NextMonth,o.setAttribute("type","button"),(c=L("div")).classList.add(d),o.appendChild(c),i.appendChild(e),i.appendChild(s),i.appendChild(o),(c=L("div")).className=nt+" "+jt,(r=L("div")).classList.add(ct),(u=L("select")).classList.add(ot),l=(a=new Date).getFullYear()-this.lH,M=a.getFullYear()+this.fH,g=l;g<=M;g++)(h=L("option")).text=g.toString(),h.value=g.toString(),u.options.add(h);return(I=L("div")).classList.add(ct),r.appendChild(u),c.appendChild(r),t.appendChild(c),t.appendChild(i),(a=this.mH.calendarDaySection).headerDiv=t,a.lastMonthButton=e,a.currentMonthName=s,a.nextMonthButton=o,a.yearSelect=u,t},O.prototype.EH=function(){var t,i,n,e,s,o,c,t=L("div");for(t.className=F+" "+v+" "+b,(i=L("table")).className=l+" "+T,n=L("thead"),e=L("tr"),s=0;s<7;s++)(o=L("th")).setAttribute(Ct,s.toString()),(c=L("span")).classList.add(Mt),c.setAttribute(Ct,s.toString()),c.innerText=this.jS._data.getShortWeekName(s),o.appendChild(c),e.appendChild(o),this.mH.calendarDaySection.weekThs.push(o);return n.appendChild(e),i.appendChild(n),t.appendChild(i),t},O.prototype.jH=function(){var t,i,n,e,s,o,c,r,u,a,t=this.mH.calendarDaySection,i=L("div"),n=L("div"),e=L("table");for(e.className=l+" "+T,s=L("tbody"),o=0;o<6;o++){for(c=L("tr"),r=0;r<7;r++)(u=L("td")).setAttribute(z,(7*o+r).toString()),(a=L("span")).classList.add(lt),a.setAttribute(z,(7*o+r).toString()),u.appendChild(a),c.appendChild(u),t.dayTds.push(u);s.appendChild(c)}return e.appendChild(s),n.appendChild(e),i.appendChild(n),t.dayContentTable=e,i},O.prototype.OH=function(){var t,i,n,e,s,o,t=L("div");return t.classList.add(X),(i=L("table")).classList.add(l),n=L("tbody"),e=L("tr"),s=L("td"),(o=L("i")).className=gt+" "+wt,o.innerText=m.resource.today,s.appendChild(o),e.appendChild(s),n.appendChild(e),i.appendChild(n),t.appendChild(i),this.mH.calendarDaySection.todayTd=s,this.mH.calendarDaySection.todayTable=i,t},O.prototype.bH=function(){var i,t,i=this,t=L("div");return t.className=H+" "+rt+" "+ut,t.tabIndex=0,this.mH.timeContainerDiv=t,this.RH=new G.TimePicker(t),this.RH.setOptions({step:{minute:30},height:260}),this.RH.on(o.BaseDropdown.Event_ValueChanged,function(t){i.BH(t)}),t},O.prototype.updateCalendarDom=function(){this.LH(),this.jS.HG&&this.FH()},O.prototype.LH=function(){switch(this.jS._data.calendarPage){case r.CalendarPage.year:this.PH();break;case r.CalendarPage.month:this.GH();break;case r.CalendarPage.day:this.UH()}},O.prototype.HH=function(){var t,i,n,e,s,o,t,c,r,c,t,i,u,a,l,t=this.jS._data,i=this.mH.calendarDaySection,n=!1;for(i.currentMonthName.innerText=t.getCurrentMonthName(),e=t.focusDate.getFullYear(),s=i.yearSelect,o=0;o<s.options.length;o++)if(e.toString()===s.options[o].value){s.selectedIndex=o,n=!0;break}if(t=this.fH+this.lH+1,n?s.options[t]&&s.selectedIndex<=t-1&&s.options[t].remove():((c=L("option")).text=e.toString(),c.value=e.toString(),s.options[t]=c,s.selectedIndex=t),this.jS.A1e&&(r=this.jS.parent).R1e&&r.B1e)if(c=i.lastMonthButton,t=i.nextMonthButton,i=this.jS.N1e,u=r.R1e._data.focusDate,a=r.B1e._data.focusDate,1===i){for(o=0;o<s.options.length;o++)(l=parseInt(s.options[o].value,10))>a.getFullYear()?s.options[o].disabled=!0:s.options[o].disabled=!1;u.getFullYear()===a.getFullYear()&&u.getMonth()>=a.getMonth()-1?(t.disabled=!0,t.classList.add(M)):(t.disabled=!1,t.classList.remove(M))}else if(2===i){for(o=0;o<s.options.length;o++)(l=parseInt(s.options[o].value,10))<u.getFullYear()?s.options[o].disabled=!0:s.options[o].disabled=!1;u.getFullYear()===a.getFullYear()&&a.getMonth()<=u.getMonth()+1?(c.disabled=!0,c.classList.add(M)):(c.disabled=!1,c.classList.remove(M))}},O.prototype.PH=function(){var t,i,n,e,s,o,c,r,c,u,t=this.jS._data,i=this.mH.calendarYearSection;if(t.updateYearItems(),i.focusDateYearRangeName.innerText=t.focusDateYearRangeStart.toString()+" - "+t.focusDateYearRangeEnd.toString(),n=i.yearTds,0!==(e=t.yearItems).length)for(s=0;s<3;s++)for(o=0;o<4;o++)r=e[c=4*s+o],(u=(c=n[c]).querySelector("span")).innerText=r.getLabel(),r.disabled?c.classList.add(I):c.classList.remove(I),r.selected?c.classList.add(h):c.classList.remove(h),r.focused?u.classList.add(g):u.classList.remove(g)},O.prototype.GH=function(){var t,i,n,e,s,o,c,r,u,r,a,t=this.jS._data,i=this.mH.calendarMonthSection;for(t.updateMonthItems(),n=t.focusDate.getFullYear(),e=t.monthItems,s=i.monthTds,i.currentYearName.innerText=n.toString(),o=0;o<3;o++)for(c=0;c<4;c++)u=e[r=4*o+c],(a=(r=s[r]).querySelector("span")).innerText=u.getLabel(),u.selected?r.classList.add(h):r.classList.remove(h),u.focused?a.classList.add(g):a.classList.remove(g)},O.prototype.UH=function(){this.HH(),this.zH()},Object.defineProperty(O.prototype,"RangeCalendar",{get:function(){return this.jS&&this.jS.parent},enumerable:!1,configurable:!0}),O.prototype.zH=function(){var t,i,n,e,s,o,c,o,r,t=this.jS._data;if(t.updateDayItems(),0!==(i=t.dayItems).length)for(n=this.mH.calendarDaySection.dayTds,e=0;e<6;e++)for(s=0;s<7;s++)c=i[o=7*e+s],(r=(o=n[o]).querySelector("span")).innerText=c.getLabel(),c.disabled?o.classList.add(I):o.classList.remove(I),c.focused?r.classList.add(g):r.classList.remove(g),c.selected?o.classList.add(h):o.classList.remove(h)},O.prototype.FH=function(){this.RH.setValue(this.jS._data.selectedDate)},O.prototype.attachEvent=function(){this.VH(),this.attachDateEvent(),this.jS.HG&&this.attachTimeEvent()},O.prototype.VH=function(){var i=this;this.mH.outerContainerDiv.addEventListener("keydown",function(t){i.YH(t)})},O.prototype.YH=function(t){9===t.keyCode?(this.jS.HG&&(this.jS._data.calendarActivePart===C.Date?this.setCalendarActivePart(C.Time):this.setCalendarActivePart(C.Date)),t.preventDefault()):this.jS._data.calendarActivePart!==C.Date||this.jS.A1e||this.ZH(t)},O.prototype.ZH=function(t){switch(this.jS._data.calendarPage){case r.CalendarPage.year:this.WH(t);break;case r.CalendarPage.month:this.QH(t);break;case r.CalendarPage.day:this.KH(t)}},O.prototype.WH=function(t){var i,n,i=this.jS._data,n=i.focusDate;switch(t.keyCode){case 13:i.selectedDate=new Date(n.valueOf()),this.showCalendarPage(r.CalendarPage.month);break;case 32:i.selectedDate=new Date(n.valueOf());break;case 37:this.JH();break;case 39:this.XH();break;case 38:this.JH(4);break;case 40:t.ctrlKey||t.metaKey?this.qH():this.XH(4);break;case 36:n.setFullYear(i.focusDateYearRangeStart);break;case 35:n.setFullYear(i.focusDateYearRangeEnd);break;case 33:this.$H();break;case 34:this.tz()}i.updateYearRange(),this.LH()},O.prototype.QH=function(t){var i,n,i=this.jS._data,n=i.focusDate;switch(t.keyCode){case 13:i.selectedDate=new Date(n.valueOf()),this.showCalendarPage(r.CalendarPage.day);break;case 32:i.selectedDate=new Date(n.valueOf());break;case 37:this.nz();break;case 39:this.ez();break;case 38:t.ctrlKey||t.metaKey?this.iz():this.nz(4);break;case 40:t.ctrlKey||t.metaKey?this.rz():this.ez(4);break;case 36:n.setMonth(0);break;case 35:n.setMonth(11);break;case 33:this.JH();break;case 34:this.XH()}this.LH()},O.prototype.KH=function(t){var i,n,e,s,o,c,i=this.jS._data,n=i.focusDate,e=n.getFullYear(),s=n.getMonth(),o=n.getDate(),c=p.getMonthMaxDay(e,s+1);switch(t.keyCode){case 13:return i.selectedDate=new Date(n.valueOf()),void this.oz();case 32:i.selectedDate=new Date(n.valueOf());break;case 37:n.setDate(o-1);break;case 39:n.setDate(o+1);break;case 38:n.setDate(o-7);break;case 40:n.setDate(o+7);break;case 36:n.setDate(1);break;case 35:n.setDate(c);break;case 33:t.shiftKey?this.nz(12):this.nz();break;case 34:t.shiftKey?this.ez(12):this.ez()}i.selectedDate=new Date(n.valueOf()),this.LH()},O.prototype.attachDateEvent=function(){var i=this;this.mH.dateContainerDiv.addEventListener("click",function(t){var t=t.target;t&&(t===i.mH.calendarDaySection.yearSelect||t.parentElement===i.mH.calendarDaySection.yearSelect)||i.setCalendarActivePart(C.Date)}),this.attachYearEvent(),this.attachMonthEvent(),this.attachDayEvent()},O.prototype.attachYearEvent=function(){var i=this;this.mH.calendarYearSection.lastYearRangeButton.addEventListener("click",function(t){i.$H(),i.LH()}),this.mH.calendarYearSection.nextYearRangeButton.addEventListener("click",function(t){i.tz(),i.LH()}),this.mH.calendarYearSection.currentYearRangeTable.addEventListener("click",function(t){i.az(t)})},O.prototype.$H=function(){var t=this.jS._data;t.focusDateYearRangeStart-=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()-10)},O.prototype.tz=function(){var t=this.jS._data;t.focusDateYearRangeStart+=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()+10)},O.prototype.qH=function(){this.showCalendarPage(r.CalendarPage.month)},O.prototype.az=function(t){var t,t,i,i,t=t.srcElement||t.target;t&&(t=+t.getAttribute(yt),0!==(i=this.jS._data.yearItems).length)&&(i=i[t],this.jS._data.focusDate.setFullYear(i.year),this.qH())},O.prototype.attachMonthEvent=function(){var i=this;this.mH.calendarMonthSection.lastYearButton.addEventListener("click",function(t){i.JH(),i.LH()}),this.mH.calendarMonthSection.nextYearButton.addEventListener("click",function(t){i.XH(),i.LH()}),this.jS.A1e||this.mH.calendarMonthSection.currentYearName.addEventListener("click",function(t){i.iz()}),this.mH.calendarMonthSection.currentYearTable.addEventListener("click",function(t){i.uz(t)})},O.prototype.JH=function(t){var t,t,t=t||1,t=Math.max(this.jS._data.focusDate.getFullYear()-t,0);this.jS._data.focusDate.setFullYear(t)},O.prototype.XH=function(t){var t,t,t=t||1,t=Math.min(this.jS._data.focusDate.getFullYear()+t,9999);this.jS._data.focusDate.setFullYear(t)},O.prototype.iz=function(){this.jS._data.updateYearRange(),this.showCalendarPage(r.CalendarPage.year)},O.prototype.rz=function(){this.showCalendarPage(r.CalendarPage.day)},O.prototype.uz=function(t){var t,t,t=t.srcElement||t.target;t&&(t=+t.getAttribute(zt),this.jS._data.focusDate.setMonth(t-1),this.rz())},O.prototype.attachDayEvent=function(){var i,t,i=this,t=this.mH.calendarDaySection;t.lastMonthButton.addEventListener("click",function(t){i.nz(),i.hH||(i.jS.A1e?(i.RangeCalendar.checkFocusDateValid(),i.RangeCalendar.updateRangeCalendarDom()):i.LH())}),t.nextMonthButton.addEventListener("click",function(t){i.ez(),i.hH||(i.jS.A1e?(i.RangeCalendar.checkFocusDateValid(),i.RangeCalendar.updateRangeCalendarDom()):i.LH())}),t.todayTable&&t.todayTable.addEventListener("click",function(t){i.fz()}),this.jS.A1e?t.dayContentTable.addEventListener("mouseover",function(t){i.j1e(t)}):t.currentMonthName.addEventListener("click",function(t){i.cz()}),t.dayContentTable.addEventListener("click",function(t){i.jS.A1e?i.O1e(t):i.lz(t)}),t.yearSelect.addEventListener("change",function(t){i.hz(t)}),this.mH.calendarDaySection.yearSelect.addEventListener("keydown",function(t){t.stopPropagation()})},O.prototype.nz=function(t){var i,t,n,t,e,s,n,i=this.jS._data,t=t||1,n=i.focusDate.getFullYear(),t=i.focusDate.getMonth()-t,e=i.focusDate.getDate();t<0&&(t+=12,--n),s=p.getMonthMaxDay(n,t+1),n=new Date(n,t,Math.min(e,s)),i.focusDate=n},O.prototype.ez=function(t){var i,t,n,t,e,s,n,i=this.jS._data,t=t||1,n=i.focusDate.getFullYear(),t=i.focusDate.getMonth()+t,e=i.focusDate.getDate();11<t&&(t-=12,n+=1),s=p.getMonthMaxDay(n,t+1),n=new Date(n,t,Math.min(e,s),i.focusDate.getHours(),i.focusDate.getMinutes(),i.focusDate.getSeconds()),i.focusDate=n},O.prototype.cz=function(){this.showCalendarPage(r.CalendarPage.month)},O.prototype.lz=function(t){var i,t,t,n,e,n,t,t,i=this.jS._data,t=t.srcElement||t.target;if(t){if(t=t.getAttribute(z),u(t))return;if(0===(n=i.dayItems).length)return;n=(e=n[+t]).date,t=(t=i.selectedDate)?new Date(t.valueOf()):new Date,i.selectedDate=new Date(n.getFullYear(),n.getMonth(),n.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),i.focusDate=new Date(i.selectedDate.valueOf()),this.LH(),this.jS.HG||this.oz()}this.mH.dateContainerDiv.focus()},O.prototype.O1e=function(t){var i,t,t,n,n,t,n,e,s,s,e,s,i,n,i=this.jS._data,t=t.srcElement||t.target;t&&(t=t.getAttribute(z),u(t)||0!==(n=i.dayItems).length&&(t=(n=n[+t]).date,n=n.disabled,s=(e=i.T1e)?new Date(e.start.valueOf()):p.getDefaultDate(),0===this.RangeCalendar.D1e?(e.start=new Date(t.getFullYear(),t.getMonth(),t.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()),e.end=e.start,this.RangeCalendar.D1e++):1===this.RangeCalendar.D1e&&(s=new Date(t.getFullYear(),t.getMonth(),t.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()),e.start<=s?(e.end=s,this.RangeCalendar.D1e=0):(e.end=e.start=s,this.RangeCalendar.D1e=1)),i.updateCalendarData(),n&&(e=this.jS._data.focusDate,s=this.jS.parent,i=p.getFirstDayOfMonth(t),1===this.jS.N1e?e<t?s.B1e._data.focusDate=i:t<this.jS._data.focusDate&&(this.jS._data.focusDate=i):2===this.jS.N1e&&(n=s.R1e,e<t?(n._data.focusDate=p.getPreviousMonth(t),this.jS._data.focusDate=i):t<this.jS._data.focusDate&&(n._data.focusDate=i))),this.RangeCalendar.updateRangeCalendarDom()))},O.prototype.j1e=function(t){var i,t,t,n,e,n,t,s,n,i=this.jS._data,t=t.srcElement||t.target;t&&(t=t.getAttribute(z),u(t)||0!==(n=i.dayItems).length&&(n=(e=n[+t]).date,t=i.T1e,i.E1e=null,t.start&&1===this.RangeCalendar.D1e&&(s=t?new Date(t.start.valueOf()):p.getDefaultDate(),(n=new Date(n.getFullYear(),n.getMonth(),n.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()))>t.start)&&(i.E1e=n),i.updateCalendarData(),this.RangeCalendar.updateRangeCalendarDom()))},O.prototype.fz=function(){var t,i,i,n,t=this.jS,i=t._data.selectedDate,i=i?new Date(i.valueOf()):null,n=new Date;i&&(n.setHours(i.getHours()),n.setMinutes(i.getMinutes()),n.setSeconds(0)),t._data.selectedDate=n,t._data.focusDate=new Date(n.valueOf()),this.LH(),t.HG||this.oz()},O.prototype.hz=function(t){var t=t.srcElement||t.target;t&&(this.jS._data.focusDate.setFullYear(+t.value),this.jS.A1e?(this.RangeCalendar.checkFocusDateValid(),this.RangeCalendar.updateRangeCalendarDom()):this.LH())},O.prototype.attachTimeEvent=function(){var i=this;this.mH.timeContainerDiv.addEventListener("click",function(t){i.setCalendarActivePart(C.Time)}),this.mH.okButton.addEventListener("click",function(t){i.oz()})},O.prototype.BH=function(t){var i,n,t,i=this.jS._data,n=i.selectedDate?new Date(i.selectedDate.valueOf()):new Date,t=t.value;n.setHours(t.getHours()),n.setMinutes(t.getMinutes()),n.setSeconds(t.getSeconds()),i.selectedDate=n,i.focusDate=new Date(n.valueOf())},O.prototype.oz=function(){var t=this.jS._data;this.fire(o.BaseDropdown.Event_ValueChanged,{oldValue:t.oldSelectedData,newValue:t.selectedDate}),t.oldSelectedData=t.selectedDate},O.prototype.showCalendarPage=function(t){var i,n,e,i=this.host.querySelector("."+it),n=this.host.querySelector("."+et),e=this.host.querySelector("."+st);switch(i.style.display="none",n.style.display="none",e.style.display="none",t){case r.CalendarPage.year:i.style.display="";break;case r.CalendarPage.month:n.style.display="";break;case r.CalendarPage.day:e.style.display=""}this.jS._data.calendarPage=t,this.updateCalendarDom()},O.prototype.setCalendarActivePart=function(t){switch(this.jS._data.calendarActivePart=t,this.mH.dateContainerDiv.classList.remove(s),this.jS.HG&&this.mH.timeContainerDiv.classList.remove(s),t){case C.Date:this.jS.HG&&this.mH.dateContainerDiv.classList.add(s),this.mH.outerContainerDiv.focus();break;case C.Time:this.jS.HG&&this.mH.timeContainerDiv.classList.add(s),this.mH.outerContainerDiv.focus()}},O.Event_GetHost="GetHost",Zt=O,Pt=o.BaseDropdown,n(k,Pt),k.prototype.setOptions=function(t){var i,t;t&&(t.showTime||this.A1e||(this.HG=t.showTime,this.Ti.innerHTML="",this.Ti.appendChild(this.Dn.createCalendarDom()),this.Dn.attachEvent()),i=t&&t.calendarPage?t.calendarPage:r.CalendarPage.day,(t=t&&t.startDay?t.startDay:r.CalendarStartDay.saturday)!==this.dH&&(this.dH=t,this.Ti.innerHTML="",this.Ti.appendChild(this.Dn.createCalendarDom()),this.Dn.attachEvent()),this.Dn.showCalendarPage(i),this.Dn.setCalendarActivePart(C.Date))},k.prototype.setValue=function(t){var i=this._data;if(t){if(this.A1e&&t instanceof Object){if(!t.start||!t.end)return;i.S1e={start:t.start,end:t.end},i.T1e={start:t.start,end:t.end},i.updateCalendarData()}else t instanceof Date&&(i.selectedDate=t,i.oldSelectedData=new Date(t.valueOf()),i.focusDate=new Date(t.valueOf()),i.updateYearRange());i.updateDayFocusDate()}},k.prototype.scrollToSelect=function(){this.Dn.updateCalendarDom()},Gt=k,t.Calendar=Gt,Rt=o.BaseDropdown,n(E,Rt),E.prototype.setOptions=function(t){u(t.showBuiltInDateRange)&&(t.showBuiltInDateRange=!0),t.showTime=!1,t.calendarPage=r.CalendarPage.day,this.R1e.setOptions(t),this.B1e.setOptions(t)},E.prototype.setValue=function(t){this.R1e.setValue(t),this.B1e.setValue(t),this.updateRangeCalendarDom()},E.prototype.updateRangeCalendarDom=function(){this.R1e.Dn.updateCalendarDom(),this.B1e.Dn.updateCalendarDom(),this.updateDataRangeResult(this.T1e)},E.prototype.L1e=function(){var t,e,t=p.getBuiltInDateRanges(),e=L("div");return e.className=a+" "+It,t.forEach(function(t,i){var n,i,n=L("div");n.className=ht,n.setAttribute(mt,i+""),i=B.createTextNode(t[0]),n.appendChild(i),e.appendChild(n)}),this.P1e=e},E.prototype._1e=function(t){var i,n,n;this.Ti.innerHTML="",(i=L("div")).className=a+" "+Y,t&&!1===t.showBuiltInDateRange||i.appendChild(this.L1e()),(n=L("div")).classList.add(Q),this.R1e=new Gt(n,t,this,1),i.appendChild(n),(n=L("div")).classList.add(Q),this.B1e=new Gt(n,t,this,2),i.appendChild(n),this.Ti.appendChild(i),this.Ti.appendChild(this.G1e())},E.prototype.aY=function(){var i=this;this.P1e&&this.P1e.addEventListener("click",function(t){i.U1e(t)}),this.H1e.addEventListener("click",function(t){i.onOkButtonClick(t)}),this.z1e.addEventListener("click",function(t){i.onCancelButtonClick(t)}),this.on(Zt.Event_GetHost,function(t){t.host=i.Ti})},E.prototype.G1e=function(){var t,i,i,n,i,n,t=L("div");return t.className=Nt,(i=L("div")).classList.add(vt),t.appendChild(i),this.V1e=i,this.updateDataRangeResult(this.T1e),(i=L("div")).className=dt,(n=L("button")).textContent=N().Cancel,n.className=ft,i.appendChild(n),t.appendChild(i),this.z1e=n,(i=L("div")).className=dt,(n=L("button")).textContent=N().OK,n.className=ft,i.appendChild(n),t.appendChild(i),this.H1e=n,t},E.prototype.U1e=function(t){var t,t,i,t,t=t.srcElement||t.target;t&&(t=t.getAttribute(mt),u(t)||(t=(i=p.getBuiltInDateRanges())[t],this.T1e={start:t[1].start,end:t[1].end},this.notifyCalendarData(),this.fire(o.BaseDropdown.Event_ValueChanged,{text:p.getShortDate(this.T1e)})))},E.prototype.updateDataRangeResult=function(t){var i,n,e,s,s;if(t&&t.start instanceof Date&&t.end instanceof Date&&(this.V1e.innerHTML="".concat(t.start.toLocaleDateString("en-US"),"-").concat(t.end.toLocaleDateString("en-US"))),this.P1e)for(i=p.getBuiltInDateRanges(),n=0;n<this.P1e.children.length;n++)e=this.P1e.children[n],s=parseInt(e.getAttribute(mt),10),e.className=ht,s=i[s]&&i[s][1],p.dateEqual(s.start,t.start)&&p.dateEqual(s.end,t.end)&&(e.className=ht+" "+Dt)},E.prototype.onOkButtonClick=function(t){this.fire(o.BaseDropdown.Event_ValueChanged,{text:p.getShortDate(this.T1e)})},E.prototype.onCancelButtonClick=function(t){this.fire(o.BaseDropdown.Event_ValueChanged,{text:p.getShortDate(this.S1e)})},E.prototype.checkFocusDateValid=function(){var t,i,t,t=this.R1e._data.focusDate,i;this.B1e._data.focusDate<=t&&(t=p.getNextMonth(t),this.B1e._data.focusDate=t)},E.prototype.notifyCalendarData=function(t){t?(this.T1e=t.selectedDateRange,this.S1e=t.oldSelectedDateRange,this.E1e=t.hoverDate):t={selectedDateRange:this.T1e,oldSelectedDateRange:this.S1e,hoverDate:this.E1e},this.R1e&&this.R1e._data.updateCalendarData(t),this.B1e&&this.B1e._data.updateCalendarData(t)},t.RangeCalendar=E},"./dist/plugins/celltype/editor/colorpicker.js":function(t,i,n){"use strict";var e,s,o,c,r,n,u,l,n,a,M,g,h;function I(t,i){var t=h.call(this,t)||this;return t.Hc(),t.setOptions(i),t}e=this&&this.__extends||(g=function(t,i){return(g=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}g(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.ColorPicker=void 0,s=n("./dist/plugins/celltype/editor/listControl.js"),o=n("Core"),c=n("./dist/plugins/celltype/editor/baseControl.js"),r=n("./dist/plugins/celltype/celltypes.ns.js"),n=n("Common"),u=n.Common.lt.ht,l="group-name",n=new n.Common.ResourceManager(r.SR,"CellTypes"),a=n.getResource.bind(n),h=c.BaseDropdown,e(I,h),I.prototype.setOptions=function(t){var i;t&&(this.options=this.options||{},u(t.colorBlockSize)||(i=parseInt(t.colorBlockSize,10),!isNaN(i)&&0<=i&&(this.options.colorBlockSize=t.colorBlockSize)),u(t.groups)||(this.options.groups=t.groups)),this._6()},I.prototype.setValue=function(t){u(t)||(this.vz=t,this.mz=null,this._6())},I.prototype.Hc=function(){for(var i,t,n,e,i=this,t=I.DefaultColorGroup(),n=[],e=0;e<t.length;e++)n.push({name:t[e].name,colors:t[e].colors,needScaleColor:t[e].needScaleColor});this.options={colorBlockSize:I.DefaultCellWidth,groups:n},this.gz=document.createElement("div"),this.gz.classList.add("gc-color-picker-outer-div"),this.gz.addEventListener("click",function(t){i.pz(t)}),this.Ti.appendChild(this.gz)},I.prototype._6=function(){this.gz.innerHTML="",new s.List(this.gz,this.bz()),this.yz()},I.prototype.yz=function(){var t,i,n,e,t=this.gz.querySelectorAll(".gc-color-picker-color-cell");if(0<t.length)for(i=0;i<t.length;i++)t[i].classList.remove("selected"),n=t[i].getAttribute("color"),e=t[i].getAttribute(l),this.vz===n&&(!this.mz||this.mz&&this.mz===e)&&t[i].classList.add("selected")},I.prototype.wz=function(){for(var t,i,n,e,s,o,t=0,i=this.options.groups,n=0;n<i.length;n++)for(e=i[n],s=0;s<e.colors.length;s++)o=e.colors[s],t=Math.max(t,o.length);return t},I.prototype.bz=function(){for(var t,i,n,e,s,o,o,t=[],i=this.options.colorBlockSize||I.DefaultCellWidth,n=this.wz(),e=this.options.groups,s=0;s<e.length;s++)o=this.Mz(e[s],i,n),t.push(o),e[s].needScaleColor&&(o=this.Cz(e[s].colors[0]),t.push(this.Mz(o,i,n)));return{items:t}},I.prototype.Cz=function(t){var i,n,e,s,o,c,r,u,a,l,M,g,h,I,N,f,i={},n=[],s=[-(e=n.length=5),-15,-25,-35,-50],o=[-10,-25,-50,-75,-90],c=[80,60,40,-25,-50],r=document.createElement("span"),u=t.length;r.style.display="none",document.body.appendChild(r);try{for(a=0;a<u;a++)for(M=(l=this.Sz(t[a],r))[0],g=l[1],h=l[2],I=this.Tz(M,g,h),N=0;N<5;N++)n[N]||((f=[]).length=u,n[N]=f),n[N][a]=1===I?this.Az(M,g,h,s[N]):.8<=I?this.Az(M,g,h,o[N]):0===I?this.Az(M,g,h,Math.abs(s[5-N-1])):I<=.2?this.Az(M,g,h,Math.abs(o[5-N-1])):this.Az(M,g,h,c[N]);i.colors=n}finally{document.body.removeChild(r)}return i},I.prototype.Sz=function(t,i){var n,e,s,o,t;return i.style.color=t,t=(o=window.getComputedStyle(i).color).replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(","),[n=parseInt(t[0],10),e=parseInt(t[1],10),s=parseInt(t[2],10)]},I.prototype.Az=function(t,i,n,e){var t,i,n;return e/=100,t=this.Iz(t,i,n),i=parseInt((0<e?(240-t.luminosity)*e:t.luminosity*e).toString(),10),n=this.xz(t.hue,t.luminosity+i,t.saturation),this.Nz(n.r,n.g,n.b)},I.prototype.kz=function(t){var t=t.toString(16);return 1===t.length?"0"+t:t},I.prototype.Nz=function(t,i,n){return"#"+this.kz(t)+this.kz(i)+this.kz(n)},I.prototype.xz=function(t,i,n){var e,s,o,c,r;return 0===n?e=s=o=parseInt((255*i/240).toString(),10):(r=c=void 0,c=2*i-(r=i<=120?(i*(240+n)+120)/240:i+n-(i*n+120)/240),e=parseInt(((255*this.Dz(c,r,t+80)+120)/240).toString(),10),s=parseInt(((255*this.Dz(c,r,t)+120)/240).toString(),10),o=parseInt(((255*this.Dz(c,r,t-80)+120)/240).toString(),10)),{a:255,r:e,g:s,b:o}},I.prototype.Dz=function(t,i,n){return n<0&&(n+=240),240<n&&(n-=240),n<40?t+((i-t)*n+20)/40:n<120?i:n<160?t+((i-t)*(160-n)+20)/40:t},I.prototype.Tz=function(t,i,n){var e;return this.Iz(t,i,n).luminosity/240},I.prototype.Iz=function(t,i,n){var e,s,o,c,r,u,r,u,a,n,c=Math.max(Math.max(t,i),n),r=Math.min(Math.min(t,i),n),u=c+r,e=parseInt(((240*u+255)/510).toString(),10),r=c-r;return 0==r?(s=0,o=160):(s=e<=120?parseInt(((240*r+u/2)/u).toString(),10):parseInt(((240*r+(510-u)/2)/(510-u)).toString(),10),u=(40*(c-t)+r/2)/r,a=(40*(c-i)+r/2)/r,n=(40*(c-n)+r/2)/r,(o=t===c?parseInt((n-a).toString(),10):i===c?parseInt((80+u-n).toString(),10):parseInt((160+a-u).toString(),10))<0&&(o+=240),240<o&&(o-=240)),{luminosity:e,saturation:s,hue:o}},I.prototype.Mz=function(c,r,u){var a,t,a=this,t={items:function(){var t,i,n,e,s,o,t=document.createElement("div");for(t.classList.add("gc-color-picker-group-row"),t.style.width=(r+7)*u+"px",i=0;i<c.colors.length;i++){for((n=document.createElement("div")).classList.add("gc-color-picker-color-row"),e=c.colors[i],s=0;s<e.length;s++)(o=document.createElement("div")).setAttribute(l,c.name),o.setAttribute("color",e[s]),o.style.backgroundColor=e[s],o.style.width=r+"px",o.style.height=r+"px",o.classList.add("gc-color-picker-color-cell"),a.vz===e[s]&&a.mz===c.name&&o.classList.add("selected"),n.appendChild(o);t.appendChild(n)}return t},layout:{direction:o.LayoutDirection.horizontal,displayAs:o.LayoutDisplayAs.inline}};return c.name&&(t.text=c.name),t},I.prototype.pz=function(t){var t,i,t,t=t.srcElement||t.target;t&&(i=t.getAttribute("color"),t=t.getAttribute(l),i)&&t&&(this.vz=i,this.mz=t,this._z(i),this.yz())},I.prototype._z=function(t){this.fire(c.BaseDropdown.Event_ValueChanged,{value:t,text:t})},I.DefaultCellWidth=10,I.DefaultColorGroup=function(){return[{name:a().ThemeColor,colors:[["#ffffff","#000000","#e7e6e6","#44546a","#5b9bd5","#ed7d31","#a5a5a5","#ffc000","#4472c4","#70ad47"]],needScaleColor:!0},{name:a().StandardColor,colors:[["#C00000","#FF0000","#FFC000","#FFFF00","#92D050","#00B050","#00B0F0","#0070C0","#002060","#7030A0"]]}]},i.ColorPicker=I},"./dist/plugins/celltype/editor/eventbase.js":function(t,i){"use strict";var n;function e(){this.Ez={}}Object.defineProperty(i,"__esModule",{value:!0}),i.EventBase=void 0,e.prototype.on=function(t,i){var n=this.Ez[t];(n=null==n?this.Ez[t]=[]:n).push(i)},e.prototype.off=function(t,i){var n,i;t?null!=(n=this.Ez[t])&&(i?(i=n.indexOf(i),n.splice(i,1)):n=[],this.Ez[t]=n):this.Ez={}},e.prototype.fire=function(t,i){var n,t,n=this,t=this.Ez[t];null!=t&&t.forEach(function(t){try{t.call(n,i)}catch(t){}})},i.EventBase=e},"./dist/plugins/celltype/editor/listControl.js":function(U,t,i){"use strict";var n,r,u,o,M,g,c,e,s,a,l,h,I,N,f,D,d,v,w,j,A,T,b,y,z,C,m,Z,G,p,B,L,x;function S(t){return e.createElement(t)}function Q(t,i){return t.substring(0,i)+t.substring(i+1,t.length)}function Y(t,i){if(o.Common.Uf.OS(t,i))return 1;if(o.Common.ct.W0(i))for(var n=0;n<t.length;n++)if(t[n]-i==0)return 1}function P(t,i){for(var n,e,n=o.Common.ct.W0(i),e=t.length-1;0<=e;e--)(t[e]===i||n&&t[e]-i==0)&&t.splice(e,1)}function R(t){var i,n,e,s,o;if(g(t)||0===t.length)return[];for(i=[],e=n=0;e<t.length;e++)"\\"===(s=t.charAt(e))?","!==(o=t.charAt(e+1))&&"\\"!==o||(t=Q(t,e)):","===s&&(i.push(t.substring(n,e)),n=e+1);return i.push(t.substring(n,t.length)),i}function W(t){for(var i,n,e,i=[],n=0;n<t.length;n++)(e=t[n])&&"string"==typeof e&&(e=e.replace(/\\/g,"\\\\").replace(/,/g,"\\,")),i[n]=e;return i.join(",")}function O(){this.jz=new WeakMap}function k(t,i,n){var e=x.call(this,t)||this;return e.Ti=S("div"),e.Ti.classList.add(a),t.appendChild(e.Ti),e.cE=new s,e.Oz=n&&n.Oz||{y4:void 0},e.Rz={items:[],doms:[]},e.setOptions(i),e}function E(t){if(t.hasOwnProperty("items"))E(t.items);else if(Array.isArray(t))for(var i=0;i<t.length;i++)t[i].hasOwnProperty("items")?E(t[i]):t[i].hasOwnProperty("text")&&!t[i].hasOwnProperty("value")&&(t[i].value=t[i].text);return t}n=this&&this.__extends||(L=function(t,i){return(L=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}L(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.List=void 0,r=i("./dist/plugins/celltype/editor/popupControl.js"),u=i("./dist/plugins/celltype/editor/baseControl.js"),o=i("Common"),M=i("Core"),g=o.Common.lt.ht,c=o.Common.Uf.hD,e=document,O.prototype.set=function(t,i,n){var e=this.jz.get(t);e||this.jz.set(t,e={}),e[i]=n},O.prototype.get=function(t,i){var t=this.jz.get(t);return t&&t[i]},O.prototype.clear=function(){this.jz=new WeakMap},s=O,a="gc-list-control",l="gc-list-control-container",h="gc-list-control-group",I="gc-list-control-group-text",N="gc-list-control-item",f="gc-list-control-hassubitem",D="gc-list-control-selected-item",d="gc-list-control-item-text",v="gc-list-control-item-text-ellipsis",w="gc-list-control-item-ellipsis",j="gc-list-control-item-icon",A="gc-list-control-emptyicon",T="gc-list-control-subitem",b="gc-list-alignment-horizontal",y="gc-list-alignment-vertical",z="gc-list-control-noitem",C="gc-list-control-listseparator",m="hide-children",Z="gc-list-control-tree",G="gc-list-control-tree-text",p="gc-list-control-tree-content",x=u.BaseDropdown,n(k,x),k.prototype.setOptions=function(t){g(t)||(this.MU=E(t),this.Ti.innerHTML="",this.Dn())},k.prototype.setValue=function(t){if(this.MU&&this.MU.multiSelect)if("string"==typeof t)t=R(t);else if(g(t))t=[];else if(o.Common.lt.Nh(t)){if(1!==this.MU.valueType){t=t.slice(0);for(var i=0;i<t.length;i++)t[i]=""+t[i]}}else t=[t];this.Oz.y4=t,this.Bz()},k.prototype.scrollToSelect=function(){},k.prototype.updateStyle=function(t,i,n){this.Ti.style.font=n},k.prototype.Dn=function(){var t=S("div");t.classList.add(l),this.MU.Oue&&(t.setAttribute("role","listbox"),t.setAttribute("tabindex","-1")),this.Lz(t,this.MU),this.Ti.appendChild(t),this.Fz()},k.prototype.Lz=function(t,i){var n;i&&(this.Pz(t,i.layout),i.items)&&(Array.isArray(i.items)?this.Gz(t,i.items):(n=i.items())instanceof HTMLElement&&(t.appendChild(n),t.classList.add(N),this.Pz(n,i.layout)))},k.prototype.Pz=function(t,i){i&&i.direction===M.LayoutDirection.horizontal?t.classList.add(b):t.classList.add(y)},k.prototype.Gz=function(t,i){for(var n,e,s,o,c,r,u,o,a,l,l,n=i.some(function(t){return!!t.icon}),e=0;e<i.length;e++)i[e].items?(s=i[e]).layout&&s.layout.displayAs===M.LayoutDisplayAs.inline?((o=S("div")).classList.add(h),(c=S("span")).innerText=s.text,!g(s.text)&&""!==s.text||c.classList.add(m),c.classList.add(I),o.appendChild(c),Array.isArray(s.items)?this.Lz(o,s):(r=s.items())instanceof HTMLElement&&((u=S("div")).classList.add(N),this.Pz(r,s.layout),u.appendChild(r),o.appendChild(u)),t.appendChild(o)):s.layout&&s.layout.displayAs===M.LayoutDisplayAs.tree?((o=S("div")).classList.add(Z),(a=S("div")).classList.add(N),a.classList.add(f),(c=S("span")).innerText=s.text,c.classList.add(G),a.appendChild(c),s.layout.collapsible&&((l=S("span")).classList.add(T),a.appendChild(l),this.Uz(a)),o.appendChild(a),(l=S("div")).classList.add(p),Array.isArray(s.items)?this.Lz(l,s):(r=s.items())instanceof HTMLElement&&((u=S("div")).classList.add(N),this.Pz(r,s.layout),u.appendChild(r),l.appendChild(u)),o.appendChild(l),t.appendChild(o)):this.Hz(t,i[e],!1,!0):this.Hz(t,i[e],n)},k.prototype.Hz=function(t,i,n,e){var s,o,o,n,o,n,o,n,o;void 0===e&&(e=!1),(s=S("div")).classList.add(N),this.MU.textEllipsis&&s.classList.add(w),"-"===i.text?(s.classList.add(z),(o=S("div")).classList.add(C),s.appendChild(o)):(n&&((o=S("div")).classList.add(j),i.icon?o.style.backgroundImage="url(".concat(i.icon,")"):o.classList.add(A),s.appendChild(o)),(n=S("span")).classList.add(d),this.MU.textEllipsis&&n.classList.add(v),o=i.text,g(i.text)&&(o=g(i.value)?"":i.value),n.innerText=o,s.appendChild(n),s.setAttribute("text",o),n=g(i.value)?null:i.value,(o=c(this.Rz.items,n))<0&&(o=this.Rz.items.length,this.Rz.doms.push([]),this.Rz.items.push(n)),this.Rz.doms[o].push(s),this.cE.set(s,"items",i),e&&((n=S("span")).classList.add(T),s.classList.add(f),this.cE.set(s,"sub-items",i),s.appendChild(n),this.zz(s))),this.MU.Oue&&(s.setAttribute("role","option"),s.setAttribute("tabindex","0"),o=i.text||i.value,g(o)||s.setAttribute("aria-label",o)),t.appendChild(s)},k.prototype.qj=function(t,i){var n,e,n=this.Rz.doms[t];if(i)for(e=0;e<n.length;e++)n[e].classList.contains(f)||n[e].classList.add(D);else for(e=0;e<n.length;e++)n[e].classList.contains(D)&&n[e].classList.remove(D)},k.prototype.Bz=function(){for(var t,i,n,e,s,o,i=this,n=i.MU,t=g(i.formula)?n&&n.multiSelect?e=i.Oz.y4:[i.Oz.y4]:["="+i.formula],s=0;s<i.Rz.items.length;s++)o=i.Rz.items[s],Y(t,o=n&&n.multiSelect&&1!==n.valueType?""+o:o)?i.qj(s,!0):i.qj(s,!1)},k.prototype.Fz=function(){var s=this;this.Ti.querySelector("."+l).addEventListener("click",function(t){var i,i,n,t,i,e,i=s.Vz(t.target,".".concat(N));i&&(i.classList.contains(f)?s.Yz(t):(i=s.cE.get(i,"items"),n=s.MU,!i&&o.Common.lt.Eh(n&&n.onItemSelected)&&(i={value:n.onItemSelected(t)}),g(i)||(t=i.value,i=i.path,n&&n.multiSelect&&(Y(e=(e=s.Oz.y4).slice(0),t=n.multiSelect&&1!==n.valueType?""+t:t)?P(e,t):o.Common.Uf.ZP(e,t),s.Oz.y4=t=e,s.Bz(),1!==n.valueType)&&(t=W(t)),s.fire(u.BaseDropdown.Event_ValueChanged,{path:i,value:t,text:t,notCloseDropDown:n&&n.multiSelect,noAutoFormat:!0}))))})},k.prototype.Vz=function(t,i){Element.prototype.matches||(Element.prototype.matches=Element.prototype.webkitMatchesSelector||function(t){for(var i=(this.document||this.ownerDocument).querySelectorAll(t),n=i.length;0<=n&&i.item(n)!==this;)--n;return-1<n});for(var n=t;n&&!n.matches(i);)n=n.parentElement;return n},k.prototype.Yz=function(t){var i,n,e,s,o,o,c,i=this,n=this.Vz(t.target,".".concat(N));n.classList.contains(f)&&(e=this.cE.get(n,"sub-items"))&&e.items&&(s=S("div"),o=this.MU,e.multiSelect=o&&o.multiSelect,e.valueType=o&&o.valueType,e.onItemSelected=o&&o.onItemSelected,(o=new k(s,e,this)).Bz(),(c=new r.PopupControl(s,n,{align:M.DropDownAlignment.Near,hostElement:n,direction:M.DropDownDirection.Right})).open(),o.on(u.BaseDropdown.Event_ValueChanged,function(t){i.fire(u.BaseDropdown.Event_ValueChanged,t),i.MU&&i.MU.multiSelect?i.Bz():c.close()}),this.cE.set(n,"sub-items-popup",c),t.stopPropagation(),t.preventDefault())},k.prototype.zz=function(t){var n=this;t.addEventListener("mouseenter",function(t){n.Yz(t)}),t.addEventListener("mouseleave",function(t){var t,i,t=t.target;t.classList.contains(f)&&(i=n.cE.get(t,"sub-items-popup"))&&(i.close(),n.cE.set(t,"sub-items-pop",void 0))})},k.prototype.Uz=function(t){var e=this;t.addEventListener("click",function(t){var i,i,n,i=t.target,i=e.Vz(i,".".concat(f));i&&(n=i.parentElement.querySelector("."+p))&&(i.parentElement.classList.contains(m)?i.parentElement.classList.remove(m):i.parentElement.classList.add(m),t.stopPropagation(),t.preventDefault())})},t.List=k},"./dist/plugins/celltype/editor/monthPicker.js":function(t,i,n){"use strict";var e,r,s,u,o,n,a,c,l,M,g,h,I,N,f,D,d,v;function w(t){return c.createElement(t)}function j(t,i){var t=v.call(this,t)||this;return t.setOptions(i),t.Fz(),t}e=this&&this.__extends||(d=function(t,i){return(d=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}d(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.MonthPicker=void 0,r=n("./dist/plugins/celltype/editor/baseControl.js"),s=n("./dist/plugins/celltype/celltypes.ns.js"),u=n("Common"),o=u.Common.lt.ht,n=new u.Common.ResourceManager(s.SR,"CellTypes"),a=n.getResource.bind(n),c=document,l="gc-month-picker-separator",M="gc-month-picker-year-item",g="gc-month-picker-month-item",h="gc-month-picker-qtr-item",I="selected",N="data-month",f="data-qtr",v=r.BaseDropdown,e(j,v),j.prototype.setOptions=function(t){var i,n,n,e,e,e,i=this,n=new Date,n={startYear:n.getFullYear()-10,stopYear:n.getFullYear(),height:300};t&&(o(t.startYear)||(e=parseInt(t.startYear,10),isNaN(e))||(n.startYear=e),!o(t.stopYear)&&0<t.stopYear&&(e=parseInt(t.stopYear,10),isNaN(e)||(n.stopYear=e)),n.stopYear<n.startYear&&(n.stopYear=t.startYear),o(t.height)||(e=parseInt(t.height,10),isNaN(e))||(n.height=e)),n.height=Math.max(1,n.height),i.MU=n,i.Ti.innerHTML="",i.Zz()},j.prototype.setValue=function(t){var i,n,e,s,t,o,i=this;t&&(n=t.getMonth()+1,e=t.getFullYear()),this.MU.startYear&&this.MU.stopYear&&this.MU.startYear<this.MU.stopYear&&e>this.MU.stopYear&&(e=this.MU.stopYear),"number"==typeof n&&(t=i.Ti.querySelector("[".concat(N,"='").concat(e,"-").concat(n,"']")))&&(t.classList.add(I),i.Wz&&i.Wz.classList.remove(I),i.Wz=t)},j.prototype.scrollToSelect=function(){var t,t,t=this.Wz;t&&(t=t.offsetTop,this.Ti.scrollTop=t)},j.prototype.Qz=function(t,i){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var i=(this.document||this.ownerDocument).querySelectorAll(t),n=i.length;0<=n&&i.item(n)!==this;)--n;return-1<n});for(var n=t;n&&!n.matches(i);)n=n.parentElement;return n},j.prototype.Fz=function(){var c=this;this.Ti.addEventListener("click",function(t){var i,t,n,e,s,t,t,e,o,n,i=c,t=i.Qz(t.target,".".concat(g,",.").concat(h));t&&!t.getAttribute(f)&&(t.classList.add(I),i.Wz&&i.Wz.classList.remove(I),e=n=null,(i.Wz=t).getAttribute(N)&&(n=+(t=(s=t.getAttribute(N)).split("-"))[1],e=+t[0]),t=new Date(e,n-1,1,0,0,0,0),e=u.Common.CultureManager.Fe().DateTimeFormat,n=(o=new u.Formatter.GeneralFormatter(e.shortDatePattern)).format(t),i.fire(r.BaseDropdown.Event_ValueChanged,{text:n,value:t}))})},j.prototype.Zz=function(){var t,i,n,e,s,t=this;for(0<=this.MU.height?t.Ti.style.maxHeight=this.MU.height+"px":t.Ti.style.height="auto",t.Ti.classList.add("gc-month-picker-container"),i=t.MU.startYear;i<=t.MU.stopYear;i++)n=document.createElement("div"),t.Jz(n),(e=document.createElement("div")).classList.add("gc-month-picker-year-container"),t.Xz(i,e),(s=document.createElement("div")).classList.add("gc-month-picker-month-container"),t.qz(i,1,s),t.qz(i,2,s),t.qz(i,3,s),t.qz(i,4,s),n.appendChild(e),n.appendChild(s),this.Ti.appendChild(n)},j.prototype.Jz=function(t){var i=w("div");i.classList.add(l),t.appendChild(i)},j.prototype.Xz=function(t,i){var n=w("div");n.classList.add(M),n.innerText="".concat(t),i.appendChild(n)},j.prototype.qz=function(t,i,n){var e,s,o,c,r,e=document.createElement("div"),s=w("div"),o=w("div"),c=w("div"),r=w("div");switch(s.classList.add(g),o.classList.add(g),c.classList.add(g),r.classList.add(h),i){case 1:s.innerText=a().Calendar_ShortMonths_1,s.setAttribute(N,"".concat(t,"-").concat(1)),o.innerText=a().Calendar_ShortMonths_2,o.setAttribute(N,"".concat(t,"-").concat(2)),c.innerText=a().Calendar_ShortMonths_3,c.setAttribute(N,"".concat(t,"-").concat(3)),r.innerText=a().Quarter_Format_1,r.setAttribute(f,"".concat(t,"-").concat(1));break;case 2:s.innerText=a().Calendar_ShortMonths_4,s.setAttribute(N,"".concat(t,"-").concat(4)),o.innerText=a().Calendar_ShortMonths_5,o.setAttribute(N,"".concat(t,"-").concat(5)),c.innerText=a().Calendar_ShortMonths_6,c.setAttribute(N,"".concat(t,"-").concat(6)),r.innerText=a().Quarter_Format_2,r.setAttribute(f,"".concat(t,"-").concat(2));break;case 3:s.innerText=a().Calendar_ShortMonths_7,s.setAttribute(N,"".concat(t,"-").concat(7)),o.innerText=a().Calendar_ShortMonths_8,o.setAttribute(N,"".concat(t,"-").concat(8)),c.innerText=a().Calendar_ShortMonths_9,c.setAttribute(N,"".concat(t,"-").concat(9)),r.innerText=a().Quarter_Format_3,r.setAttribute(f,"".concat(t,"-").concat(3));break;case 4:s.innerText=a().Calendar_ShortMonths_10,s.setAttribute(N,"".concat(t,"-").concat(10)),o.innerText=a().Calendar_ShortMonths_11,o.setAttribute(N,"".concat(t,"-").concat(11)),c.innerText=a().Calendar_ShortMonths_12,c.setAttribute(N,"".concat(t,"-").concat(12)),r.innerText=a().Quarter_Format_4,r.setAttribute(f,"".concat(t,"-").concat(4))}e.appendChild(s),e.appendChild(o),e.appendChild(c),e.appendChild(r),n.appendChild(e),i<4&&this.Jz(n)},i.MonthPicker=j},"./dist/plugins/celltype/editor/multiColumnPicker.js":function(t,i,n){"use strict";var e,a,l,s,M,o,c,r,n,d,o,g,h,u,I,N,f;function D(t){return Array.isArray(t)}function v(t){return"string"==typeof t}function w(t){t.suspendPaint(),t.suspendEvent(),t.suspendCalcService()}function j(t){t.resumeCalcService(!1),t.resumeEvent(),t.resumePaint()}function A(t,i){var n,s,o,c,e,r,u,n=t[0],s=[];if(D(n))for(c=T(o=t,i),e=function(t,i){var n=o[t],e={};c.forEach(function(t,i){e[t]=n[i]}),s.push(e)},r=0,u=o.length;r<u;r++)e(r,u);else s=t;return s}function T(t,i){var n=[];return i&&0<i.length?i.forEach(function(t){n.push(t.name)}):n=t.shift(),n}function b(t,i,n){return f.call(this,t,i,n)||this}function y(t,i){var n=[];return t.yMt(i,0,0,n),n=z(n)}function z(t){for(var i,n,e,s,o,i=[],n=[],e=0;e<t.length;e++)o=""+(s=t[e]).row+s.col+s.rowCount+s.colCount+s.sheetName,i.indexOf(o)<0&&(i.push(o),n.push(s));return n}function C(s,t,o,c,r,u){var a={row:o,col:c,dataSource:r,dependSheetName:void 0,targetSheetName:u.name()};t.forEach(function(t){var t,i,n,e,i=t.row,n=t.col,e=null!=(t=t.sheetName)?t:u.name();void 0===s[i]&&(s[i]=[]),void 0===s[i][n]&&(s[i][n]=[]),s[i][n].some(function(t){return t.row===o&&t.col===c&&t.dataSource===r&&t.dependSheetName===e})||(a.dependSheetName=e,s[i][n].push(a))})}function m(t,i,n){var e,s,o,c,r,u,a;if(t)for(e in t)if(t.hasOwnProperty(e)&&(s=t[e]))for(o in s)if(s.hasOwnProperty(o)&&(c=s[o]))for(r=0,u=c;r<u.length;r++)(a=u[r]).row>=i&&(a.row+=n)}function p(t,i,n){var e,s,o,c,r,u,a,l;if(t)for(e in t)if(t.hasOwnProperty(e)&&(s=t[e]))for(o in s)if(s.hasOwnProperty(o)&&(c=s[o])){for(r=[],u=0,a=c;u<a.length;u++)(l=a[u]).row<i?r.push(l):l.row<i+n||(l.row-=n,r.push(l));s[o]=r}}function L(t,i,n){var e,s,o,c,r,u,a;if(t)for(e in t)if(t.hasOwnProperty(e)&&(s=t[e]))for(o in s)if(s.hasOwnProperty(o)&&(c=s[o]))for(r=0,u=c;r<u.length;r++)(a=u[r]).col>=i&&(a.col+=n)}function x(t,i,n){var e,s,o,c,r,u,a,l;if(t)for(e in t)if(t.hasOwnProperty(e)&&(s=t[e]))for(o in s)if(s.hasOwnProperty(o)&&(c=s[o])){for(r=[],u=0,a=c;u<a.length;u++)(l=a[u]).col<i?r.push(l):l.col<i+n||(l.col-=n,r.push(l));s[o]=r}}e=this&&this.__extends||(N=function(t,i){return(N=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}N(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.MultiColumn=void 0,a=n("Core"),l=n("SheetsCalc"),s=n("CalcEngine"),M=n("CalcEngine"),o=n("Common"),c=n("./dist/plugins/celltype/editor/baseControl.js"),r=n("./dist/plugins/celltype/editor/baseSpreadPicker.js"),n=n("./dist/plugins/celltype/celltypes.ns.js"),d=o.Common.lt.ht,o=new o.Common.ResourceManager(n.SR,"CellTypes"),g=o.getResource.bind(o),h=!!s,u=".multiColumnNS",f=r.BaseSpreadPicker,e(b,f),b.prototype.setOptions=function(t){var i,n,e,s,t,o,n,c,e;if(f.prototype.setOptions.call(this,t),(i=this).MU=t){if(n=i.TU,e=t.dataSource,s=t.bindingInfos,t=t.border,o=i.SU,n=n.getActiveSheet(),e){c=!0,w(n),n.options.isProtected=!0,n.options.rowHeaderVisible=!1,n.selectionPolicy(a.SelectionPolicy.single),n.selectionUnit(a.SelectionUnit.row);try{i.$z(n,e,s)}catch(t){c=!1,i.dispose()}finally{c&&n&&((e=new a.Style)._showTip=!1,n.setStyle(-1,-1,e,a.SheetArea.viewport),j(n))}}d(t)||(o.style.border=t)}},b.prototype.setValue=function(t){var i,n,e,n,i,i=this;i.MU&&(f.prototype.setValue.call(this,t),n=i.TU,e=n.getActiveSheet(),n=i.tV(t),e.suspendPaint(),-1!==n?(e.clear(0,-1,-1,-1,a.SheetArea.colHeader,a.StorageType.style),e.setSelection(n,-1,1,-1)):(e.clearSelection(),(i=new a.Style).backColor="rgb(225, 225, 225)",i.foreColor="rgb(33, 115, 70)",i.font="bold 11pt Calibri",i.borderBottom=new a.LineBorder("rgb(33, 115, 70)",a.LineStyle.medium),e.setStyle(0,-1,i,a.SheetArea.colHeader),e.D3(a.Events.ActiveCellChanged+u,function(t,i){e.setSelection(0,-1,1,-1),e._3(a.Events.ActiveCellChanged+u)})),e.resumePaint())},b.prototype.dispose=function(){var t,i,n,t,i,n;this.TU.getActiveSheet()._3(a.Events.ActiveCellChanged+u),f.prototype.dispose.call(this)},b.prototype.$z=function(t,i,n){var e,i;i&&(i=this.nV(i))&&(t.setDataSource(A(i,n)),n)&&t.bindColumns(n)},b.prototype.nV=function(t){var t,i,n,e,s,e,n,o,c,r,s,u,e,o,s,e,o,t=t,i=this.CU;if(v(t)){if(h){if(s=(e=this.MU).row,e=e.col,n=(0,l.formulaToExpression)(i,t),o=void 0,i.reportDataModel?(o=i.reportDataModel.xCi.POt)&&o.setContext&&o.setContext({row:s,col:e,formula:t,triggerUpdatePrecedents:!0}):(o=i.Uw(),C(c=i.Rpe(),r=y(i,n),s,e,t,i)),s=i.getCalcService().evaluateParsedFormula(o,n,(0,M.eV)(0,0),!0),e=!1,o=void 0,!(e=!(u=M.Convert.LE(s)||M.Convert.Nh(s))||(o=M.Convert.iV(s,0,!1,!1,!1)).isError||o.isConvertError?e:!0))throw new Error(g().MultiColumn_InvalidDataSource);n=o}}else t instanceof a.Range?n=i.getArray(t.row,t.col,t.rowCount,t.colCount):D(t)?n=t:t.viewName&&(n=(o=(e=(s=i.parent)&&s.dataManager().rV)&&e[t.viewName])&&o.oV());return n},b.prototype.tV=function(t){var i,n,e,s,o,c,r,u,a,l,M,g,h,I,N,f,D,i=this,n=-1;if(t)if(s=(e=i.TU).getActiveSheet(),c=(o=Object.keys(t)).length,u=(r=s.getDataSource()).length,a=!1,l=i.MU.valuePath,d(l))for(M=0;M<u;M++){for(g=r[M],a=!0,h=0;h<c;h++)if(g[l=o[h]]!==t[l]&&void 0!==g[l]){a=!1;break}if(a){n=M;break}}else for(N=(I=t instanceof Date)?t+"":t,M=0;M<u;M++)if(f=r[M][l],(D=I&&f instanceof Date?f+"":f)===N){n=M;break}return n},b.prototype.submitData=function(t){var i,n,e,s,o,t,n,t,i=this,n=t.sheet,e;t.isEsc?s={notSubmit:!0}:-1<(t=(o=n.getSelections()[0]).row)&&(n=n.getDataItem(t),t=i.MU.valuePath,s={value:n=d(t)?n:n[t],text:n}),d(s)||i.fire(c.BaseDropdown.Event_ValueChanged,s)},i.MultiColumn=b,a.Worksheet.ch("dropDowns",{onLayoutChanged:function(t){var i,n,e,s,o,c,t;!d(t.sheetArea)&&3!==t.sheetArea||(n=(i=this).Rpe(),e=t.changeType,s=t.row,o=t.rowCount,c=t.col,t=t.colCount,"addRows"===e?m(n,s,o):"deletingRows"===e?p(n,s,o):"addColumns"===e?L(n,c,t):"deletingColumns"===e&&x(n,c,t))},updatePrecedents:function(t){var i,n,e,s,o,c,t,i=this,n=i.Rpe(),e=t.row,s=t.col,o=t.cells,c=t.formula,t=i.getStyle(e,s);t&&t.dropDowns&&t.dropDowns.some(function(t){return t.type===a.DropDownType.multiColumn&&t.option.dataSource===c})&&C(n,o,e,s,c,i)}})},"./dist/plugins/celltype/editor/popupControl.js":function(t,i,n){"use strict";var e,w,n,j,A,s,o,c,r,u;function a(t,i,n,e){this._x=t,this._y=i,this.YC=n,this.ZC=e}function l(t,i,n){var e=u.call(this,null)||this;return e.sourceElement=t,e.target=i,e.defaultOption={closeAfterResize:!0,closeAfterClickOutside:!0,direction:w.DropDownDirection.Down,align:w.DropDownAlignment.Near,horAdj:j.Flip|j.Slide,verAdj:j.Flip|j.Slide},e.globalMousedownEventHandler=function(t){var i,n;if(e.rf){for(n=i=t.target;n&&n!==e.sourceElement;)n=n.parentElement;n||(e.close(),t.stopPropagation(),t.preventDefault())}},e.windowResizeEventHandler=function(){e.rf&&e.close()},e.MU=e.defaultOption,e.rf=!1,n&&e.mergeOption(n),e.aV=null===e.MU.hostElement||void 0===e.MU.hostElement||!(e.MU.hostElement instanceof HTMLElement),e}e=this&&this.__extends||(c=function(t,i){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}c(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PopupControl=i.Rectangle=i.DropDownAdjustment=void 0,w=n("Core"),n=n("./dist/plugins/celltype/editor/baseControl.js"),(r=j=i.DropDownAdjustment||(i.DropDownAdjustment={}))[r.None=0]="None",r[r.Flip=1]="Flip",r[r.Slide=2]="Slide",a.CreateFromDom=function(t){return new a(t.left,t.top,t.width,t.height)},Object.defineProperty(a.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"width",{get:function(){return this.YC},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.ZC},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"left",{get:function(){return this._x},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"right",{get:function(){return this._x+this.YC},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"top",{get:function(){return this._y},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"bottom",{get:function(){return this._y+this.ZC},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"Location",{get:function(){return{X:this._x,Y:this._y}},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"Size",{get:function(){return{width:this.YC,height:this.ZC}},enumerable:!1,configurable:!0}),a.prototype.Offset=function(){for(var t,i,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];1===t.length&&"number"==typeof t[0].X&&"number"==typeof t[0].X?(this._x+=t[0].X,this._y+=t[0].Y):2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&(this._x+=t[0],this._y+=t[1])},A=a,i.Rectangle=A,s="ribbon-dropdowngroup-popup",u=n.BaseControl,e(l,u),l.prototype.open=function(){this.rf||(this.MU.Oue&&this.target.setAttribute&&this.target.setAttribute("aria-expanded","true"),this.beforeOpen(),this.render(),this.clearPosition(),this.calcPosition(),this.rf=!0,this.sourceElement.tabIndex=-1,this.sourceElement.style.cssText+="outline:none",this.sourceElement.focus())},l.prototype.beforeOpen=function(){this.bindEvent()},l.prototype.dispose=function(){var i=this;this.MU.closeAfterResize&&document.removeEventListener("resize",this.windowResizeEventHandler),this.MU.closeAfterClickOutside&&(document.removeEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){document.removeEventListener(t,i.globalMousedownEventHandler,!0)})),this.aV?(this.sourceElement.classList.remove(s),this.sourceElement.style.display=this.uV,this.sourceElement.style.position=this._oldPosition):this.sV&&this.sV.parentNode&&(this.MU.hostElement.removeChild(this.sV),this.sV=null)},l.prototype.close=function(){var t;this.rf&&(this.rf=!1,this.MU.Oue&&(t=this.target).setAttribute&&(t.setAttribute("aria-expanded","false"),setTimeout(function(){t.focus()})),this.dispose(),this.fire("close"))},l.prototype.mergeOption=function(t){for(var i in t)void 0!==t[i]&&(this.MU[i]=t[i])},l.prototype.clearPosition=function(){this.cV.style.top=this.cV.style.bottom=this.cV.style.left=this.cV.style.right=""},l.prototype.calcPosition=function(){var t,i,n,n,t,e,s,o,c,o,c,n,i=this.target instanceof A,t=i?this.target:A.CreateFromDom(this.target.getBoundingClientRect()),n=new A(0,0,window.innerWidth,window.innerHeight),n=this.calculateDropDownLocation(n,t,{width:this.sourceElement.offsetWidth,height:this.sourceElement.offsetHeight},this.MU.direction,this.MU.align,this.MU.horAdj,this.MU.verAdj),t=this.cV.offsetParent,e=t.getBoundingClientRect(),s=t===document.body,o=document.documentElement,c=(window.pageXOffset||o.scrollLeft)-(o.clientLeft||0),o=(window.pageYOffset||o.scrollTop)-(o.clientTop||0),c=n.X-(s?-c:e.left-t.scrollLeft),n=n.Y-(s?-o:e.top-t.scrollTop);i&&(c<0&&(c=0),n<0)&&(n=0),this.cV.style.left="".concat(c,"px"),this.cV.style.top="".concat(n,"px")},l.prototype.calculateDropDownLocation=function(t,i,n,e,s,o,c){var r,u,a,l,M,g,h,I,N,f,D,c,o,d,v,i,r={X:t.x,Y:t.y};switch(t.Offset(-r.X,-r.Y),i.Offset(-r.X,-r.Y),u=i.left,a=i.right,l=i.top,M=i.bottom,g=l,h=t.height-M,I=u,N=t.width-a,f=(c&j.Flip)===j.Flip,D=(o&j.Flip)===j.Flip,c=(c&j.Slide)===j.Slide,o=(o&j.Slide)===j.Slide,e){case w.DropDownDirection.Up:n.height>g&&f&&(e=w.DropDownDirection.Down);break;case w.DropDownDirection.Down:n.height>h&&f&&(e=w.DropDownDirection.Up);break;case w.DropDownDirection.Left:n.width>I&&D&&(e=w.DropDownDirection.Right);break;case w.DropDownDirection.Right:n.width>N&&D&&(e=w.DropDownDirection.Left)}switch(v=d=0,e){case w.DropDownDirection.Up:v=l-n.height;break;case w.DropDownDirection.Down:v=M;break;case w.DropDownDirection.Left:d=u-n.width;break;case w.DropDownDirection.Right:d=a}return e===w.DropDownDirection.Up||e===w.DropDownDirection.Down?s===w.DropDownAlignment.Near?d=u:s===w.DropDownAlignment.Center?d=u-(n.width-i.width)/2:s===w.DropDownAlignment.Far&&(d=a-n.width):e!==w.DropDownDirection.Right&&e!==w.DropDownDirection.Left||(s===w.DropDownAlignment.Near?v=l:s===w.DropDownAlignment.Center?v=l-(n.height-i.height)/2:s===w.DropDownAlignment.Far&&(v=M-n.height)),i=new A(d,v,n.width,n.height),o&&(i.width>t.width?i.x=0:(i.x=Math.max(i.x,0),i.x=Math.min(i.x,t.width-i.width))),c&&(i.height>t.height?i.y=0:(i.y=Math.max(i.y,0),i.y=Math.min(i.y,t.height-i.height))),i.Offset(r),i.Location},l.prototype.render=function(){var i=this;this.aV?(this._oldPosition=this.sourceElement.style.position,this.sourceElement.style.position="absolute",this.uV=this.sourceElement.style.display,this.sourceElement.style.display="",this.sourceElement.style.zIndex="10000",this.sourceElement.classList.add(s),this.cV=this.sourceElement):(this.sV=document.createElement("div"),this.sV.style.cssText="position:absolute; z-index:10000; box-shadow:rgba(0, 0, 0, 0.4) 2px 4px 5px; outline:none",this.sV.classList.add(s),this.sV.appendChild(this.sourceElement),this.MU.hostElement.appendChild(this.sV),this.cV=this.sV),this.MU.Oue&&setTimeout(function(){var t;i.cV&&(t=i.cV.querySelector("[role=menu],[role=listbox]"))&&t.focus()},500)},l.prototype.bindEvent=function(){var i=this;this.MU.closeAfterClickOutside&&(document.addEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){document.addEventListener(t,i.globalMousedownEventHandler,!0)})),this.MU.closeAfterResize&&document.addEventListener("resize",this.windowResizeEventHandler)},i.PopupControl=l},"./dist/plugins/celltype/editor/slider.js":function(t,i,n){"use strict";var e,s,o,c,r,u,a,l,M,g,h,I,N,f,D,d,v,w,j,A;function T(t){return document.createElement(t)}function b(t){var i=t.toExponential().match(/\d(?:\.(\d*))?e([+-]\d+)/);return t.toFixed(l(0,(i[1]||"").length-parseInt(i[2],10)))}function y(t){var t,i,t=b(t||0),i=0;return i=0<=t.indexOf(".")?t.length-t.indexOf(".")-1:i}function z(){}function C(t,i){this.Wc=i,this.fV={},this.fV=h.extend(this.fV,t)}function m(t,i){this.Wc=i,this.lV={},this.lV=h.extend(this.lV,t)}function p(t,i){this.Wc=t,this.hV={},this.dV="",this.hV=h.extend(this.hV,i),this.dV='\n        <div class="'.concat(this.hV.prefixCls,"-tooltip ").concat(this.hV.prefixCls,'-tooltip-placement-top">\n            <div class="').concat(this.hV.prefixCls,'-tooltip-content">\n                <div class="').concat(this.hV.prefixCls,'-tooltip-arrow"></div>\n                <div class="').concat(this.hV.prefixCls,'-tooltip-inner">{{value}}</div>\n            </div>\n        </div>\n        ')}function L(t,i){this.Wc=i,this.vV={},this.mV=!1,this.gV=a,this.isSelected=!1,this.yme=a,this.vV=h.extend(this.vV,t),this.gV=new f(this.Wc,this.pV())}function x(t,i){this.Wc=i,this.bV={},this.bV=h.extend(this.bV,t)}function S(t,i,n,e,s){this.Wc=t,this.yV=i,this.wV=n,this.endHandle=e,this.MU=s,this.MV=a,this.CV=a,this.MV=new N(this.SV(),this.Wc),this.CV=new d(this.TV(),this.Wc)}function O(t,i){var e=A.call(this,t)||this;return e.yV=a,e.wV=a,e.Y1e=a,e.Z1e=a,e.AV=a,e.Mme=function(t){var t,t,t;h.pauseEvent(t),t=e.AV.getKeyboardValueMutator(t),h.isEmpty(t)||(t=t(e._V.value),(t=e.AV.trimAlignValue(t))!==e._V.value&&(e.setValue(t),e._V.onChange(t),e._V.onAfterChange(t),e.fire(s.BaseDropdown.Event_ValueChanged,{value:t,text:t.toString(),notCloseDropDown:!0})))},e.IV=function(t){0===t.button&&(document.addEventListener("mouseup",e.xV,!1),document.addEventListener("pointerup",e.xV,!1),document.addEventListener("MSPointerUp",e.xV,!1),document.addEventListener("mousemove",e.NV,!1),document.addEventListener("pointermove",e.NV,!1),document.addEventListener("MSPointerMove",e.NV,!1),e.NV(t))},e.NV=function(t){var t,i,t=e.kV(t,!0),i=e.AV.trimAlignValue(t);e._V.showNumberRange?e.Cme(i,t):e.DV!==i&&(e.setValue(i),e._V.onChange(i))},e.xV=function(t){var i,n;e.NV(t),document.removeEventListener("mousemove",e.NV),document.removeEventListener("mouseup",e.xV),document.removeEventListener("pointermove",e.NV),document.removeEventListener("pointerup",e.xV),document.removeEventListener("MSPointerMove",e.NV),document.removeEventListener("MSPointerUp",e.xV),i=e.kV(t,!0),n=e.AV.trimAlignValue(i),e._V.showNumberRange?(e.Cme(n,i),e._V.onAfterChange(e._V.numberRange),e.fire(s.BaseDropdown.Event_ValueChanged,{value:e._V.numberRange,text:e._V.numberRange,notCloseDropDown:!0})):(e.DV=n,e._V.onAfterChange(e._V.value),e.fire(s.BaseDropdown.Event_ValueChanged,{value:n,text:n.toString(),notCloseDropDown:!0})),h.pauseEvent(t)},e.EV=function(t){var i=t.target||t.srcElement;document.addEventListener("touchend",e.jV,!1),i.classList.contains("".concat(e._V.prefixCls,"-handle"))?document.addEventListener("touchmove",e.OV,!1):e.OV(t)},e.OV=function(t){var t,t,i,t=t.targetTouches[0],t=e.kV(t,!0),i=e.AV.trimAlignValue(t);e._V.showNumberRange?e.Cme(i,t):e.DV!==i&&(e.setValue(i),e._V.onChange(i))},e.jV=function(t){var i,i,n;document.removeEventListener("touchmove",e.OV),document.removeEventListener("touchend",e.jV),i=t.changedTouches[0],i=e.kV(i,!0),n=e.AV.trimAlignValue(i),e._V.showNumberRange?(e.Cme(n,i),e._V.onAfterChange(e._V.numberRange),e.fire(s.BaseDropdown.Event_ValueChanged,{value:e._V.numberRange,text:e._V.numberRange,notCloseDropDown:!0})):(e.DV=n,e._V.onAfterChange(e._V.value),e.fire(s.BaseDropdown.Event_ValueChanged,{value:n,text:n.toString(),notCloseDropDown:!0})),h.pauseEvent(t)},e.init(i),e}e=this&&this.__extends||(j=function(t,i){return(j=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}j(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.Slider=void 0,s=n("./dist/plugins/celltype/editor/baseControl.js"),o=n("Common"),c=n("Core"),r=o.Common.lt.ht,u=o.Common.zf.j0,a=null,l=Math.max,M=Math.min,g=Math.abs,z.isEmpty=function(t){return void 0===t||t===a||""===t||Array.isArray(t)&&0===t.length},z.isEmptyObject=function(t){var i,n,i=!0;for(n in t)if(n){i=!1;break}return i},z.pauseEvent=function(t){t.stopPropagation(),t.preventDefault()},z.isObject=function(t){var i=typeof t;return"function"==i||"object"==i&&!!t},z.allKeys=function(t){var i,n,i=[];if(!z.isObject(t))return[];for(n in t)t.hasOwnProperty(n)&&i.push(n);return i},z.parseStyleObject=function(t){var i,n,e,s,o,c,o;if(!z.isObject(t))return"";for(i="",e=0,s=(n=z.allKeys(t)).length;e<s;e++)c=t[o=n[e]],o=o.replace(/([A-Z])/g,"-$1"),i+="".concat(o.toLowerCase(),": ").concat(c,"; ");return i.trim()},z.extend=function(t,i,n){var e,s,o,c,r;for(void 0===n&&(n={}),e=z.allKeys(t),o=0,c=(s=z.allKeys(i)).length;o<c;o++)n[r=s[o]]=i[r];for(o=0,c=e.length;o<c;o++)void 0===n[r=e[o]]&&(n[r]=t[r]);return n},z.noop=function(){},z.measureWidth=function(t,i){var n,e,n=0,e=T("span");e.classList.add(i);try{e.innerText=t,e.style.display="none",document.body.appendChild(e),n=(0,c.GC$)(e).width()}finally{document.body.removeChild(e)}return n},h=z,C.prototype.render=function(){var t,i;if(!this.fV.included)return a;t=this.RV(),(i=this.Wc.querySelector(".".concat(this.fV.className)))===a&&((i=T("div")).classList.add("".concat(this.fV.className)),this.Wc.appendChild(i)),i.setAttribute("style",h.parseStyleObject(t))},C.prototype.setLength=function(t,i){this.fV.length=t,r(i)||(this.fV.offset=i),this.render()},C.prototype.RV=function(){return this.fV.direction===c.LayoutDirection.vertical?{bottom:"".concat(this.fV.offset,"%"),height:"".concat(this.fV.length,"%")}:{left:"".concat(this.fV.offset,"%"),width:"".concat(this.fV.length,"%")}},I=C,m.prototype.render=function(){var t,i,n,e,s,t=this.Wc.querySelector(".".concat(this.lV.className));if(t===a){for((t=T("div")).className="".concat(this.lV.className),n=0,e=(i=this.BV()).length;n<e;n++)s=this.LV(i[n]),t.appendChild(s);this.Wc.appendChild(t)}},m.prototype.LV=function(t){var i,n,n,n,i=T("span"),n=this.lV.max-this.lV.min,n=g(t-this.lV.min)/n*100+"%",n=this.lV.direction===c.LayoutDirection.vertical?{bottom:n}:{left:n};return i.classList.add("".concat(this.lV.prefixCls,"-dot")),i.setAttribute("style",h.parseStyleObject(n)),i.setAttribute("key",t.toString()),i},m.prototype.BV=function(){var t,i,n,t=Object.keys(this.lV.marks).map(function(t){return Number(t)});if(t.sort(function(t,i){return t-i}),i=t,this.lV.dots)for(n=this.lV.min;n<=this.lV.max;n+=this.lV.step)-1===i.indexOf(n)&&i.push(n);return i},N=m,p.prototype.render=function(t,i){var t,i,n,n,e,n;this.hV.offset=t,t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip")),i=new o.Formatter.GeneralFormatter(this.hV.formatString).format(i),h.isEmpty(t)&&(n=u(i),this.dV=this.dV.replace(/{{value}}/,n),(n=T("div")).innerHTML=this.dV,this.Wc.appendChild(n.firstElementChild),t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"))),(e=t.querySelector(".".concat(this.hV.prefixCls,"-tooltip-inner"))).textContent=i,n=this.GV(i),t.setAttribute("style",h.parseStyleObject(n)),this.hV.tooltipVisible?this.show():this.hide()},p.prototype.show=function(){var t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"));h.isEmpty(t)||(t.style.display="inline-block")},p.prototype.hide=function(){var t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"));h.isEmpty(t)||(t.style.display="none")},p.prototype.GV=function(t){var t,t=0===(t=h.measureWidth(t,"".concat(this.hV.prefixCls,"-tooltip")))?12:t/2+4;return this.hV.direction===c.LayoutDirection.vertical?{left:"-".concat(t,"px"),bottom:"calc(".concat(this.hV.offset,"% + 10px)")}:{top:"-28px",left:"calc(".concat(this.hV.offset,"% - ").concat(t+4,"px)")}},f=p,L.prototype.render=function(){var t,i,n,e,t=this.UV(),i=this.GV(),n=this.vV.tabIndex||0;!this.vV.disabled&&n!==a||(n=a),(e=this.Wc.querySelector(".".concat(this.vV.className)))===a&&((e=T("div")).className=t,this.Wc.appendChild(e),e.setAttribute("role","slider"),e.setAttribute("aria-valuemin",this.vV.min.toString()),e.setAttribute("aria-valuemax",this.vV.max.toString()),e.setAttribute("aria-valuenow",this.vV.value.toString()),e.setAttribute("aria-disabled",String(this.vV.disabled)),e.addEventListener("blur",this.Sme.bind(this)),e.addEventListener("mouseenter",this.Tme.bind(this)),e.addEventListener("keydown",this.Sme.bind(this)),e.addEventListener("mousedown",this.Ame.bind(this)),e.addEventListener("touchstart",this.Ame.bind(this)),document.addEventListener("touchend",this.Ime.bind(this)),document.addEventListener("mouseup",this.Ime.bind(this))),e.tabIndex=n,e.setAttribute("style",h.parseStyleObject(i)),this.yme=e},L.prototype.Ame=function(t){this.yme.focus(),this.isSelected=!0,this.gV.show()},L.prototype.Ime=function(t){var i=this.yme;document.activeElement===i&&(this.HV(!1),i.blur(),this.isSelected=!1)},L.prototype.Sme=function(){this.HV(!1)},L.prototype.Tme=function(){this.gV.show()},L.prototype.isSelectedByMouse=function(t){return r(t)||(this.isSelected=t),this.isSelected},L.prototype.setOffset=function(t,i){this.vV.offset=t,this.render(),this.gV.render(t,i)},L.prototype.HV=function(t){this.mV=t},L.prototype.UV=function(){return this.mV?"".concat(this.vV.className," ").concat(this.vV.prefixCls,"-handle-click-focused"):"".concat(this.vV.className)},L.prototype.GV=function(){return this.vV.direction===c.LayoutDirection.vertical?{bottom:"".concat(this.vV.offset,"%")}:{left:"".concat(this.vV.offset,"%")}},L.prototype.pV=function(){return{prefixCls:"gc-slider",tooltipVisible:this.vV.tooltipVisible,direction:this.vV.direction,offset:this.vV.offset,formatString:this.vV.formatString}},L.prototype.dispose=function(){this.yme&&(this.yme.removeEventListener("blur",this.Sme.bind(this)),this.yme.removeEventListener("mouseenter",this.Tme.bind(this)),this.yme.removeEventListener("keydown",this.Sme.bind(this)),this.yme.removeEventListener("mousedown",this.Ame.bind(this)),this.yme.removeEventListener("touchstart",this.Ame.bind(this))),this.yme=a,document.removeEventListener("touchend",this.Ime.bind(this)),document.removeEventListener("mouseup",this.Ime.bind(this))},D=L,x.prototype.render=function(){var t,i,n,e,s,s,t=this.Wc.querySelector(".".concat(this.bV.className));if(t===a){for((t=T("div")).className="".concat(this.bV.className),i=this.zV(),this.VV(i),n=0,e=i.length;n<e;n++)s=i[n],(s=this.YV(s))!==a&&t.appendChild(s);this.Wc.appendChild(t)}},x.prototype.VV=function(t){var i,n,e,e;for(this.ZV=0,i=1,n=t.length;i<n;i++)(e=this.bV.marks[t[0]])&&(e=h.measureWidth(e.label,"".concat(this.bV.className,"-text")),!this.ZV||this.ZV<e)&&(this.ZV=e)},Object.defineProperty(x.prototype,"maxWidth",{get:function(){return this.ZV},enumerable:!1,configurable:!0}),x.prototype.zV=function(){var t;return h.allKeys(this.bV.marks).sort(function(t,i){return t-i})},x.prototype.YV=function(i){var n,t,e,s,o,o,t,n=this,t=this.bV.marks[i],e=h.isObject(t)?t.label:t;return h.isEmptyObject(e)?a:(s="".concat(this.bV.className,"-text"),o=this.WV(i),o=h.extend(o,t.style),(t=T("span")).classList.add(s),t.setAttribute("style",h.parseStyleObject(o)),t.setAttribute("key",i.toString()),t.addEventListener("mousedown",function(t){n.bV.onClickLabel(t,i)}),t.innerHTML=u(e),t)},x.prototype.WV=function(t){var i=this.bV.max-this.bV.min;return this.bV.direction===c.LayoutDirection.vertical?{"margin-bottom":"-50%",bottom:(t-this.bV.min)/i*100+"%"}:{left:(t-this.bV.min)/i*100+"%",transform:"translateX(-50%)"}},d=x,S.prototype.render=function(){var t=T("div");t.className="".concat(this.MU.prefixCls,"-rail"),this.Wc.appendChild(t),this.yV.render(),this.MV.render(),this.wV.render(),this.endHandle&&this.endHandle.render(),this.CV.render(),this.CV.maxWidth&&this.MU.direction===c.LayoutDirection.vertical&&(this.Wc.style.paddingRight=this.CV.maxWidth+"px")},S.prototype.calcValueByPosition=function(t,i){var t,t,t=t-this.QV(),t=this.KV(t);return i?t:this.trimAlignValue(t)},S.prototype.trimAlignValue=function(t){return h.isEmpty(t)?a:this.JV(t)},S.prototype.calcOffset=function(){var t;return 100*(l(this.MU.value-this.MU.min,0)/(this.MU.max-this.MU.min))},S.prototype.getKeyboardValueMutator=function(t){var i=this;switch(t.keyCode){case 38:case 39:return function(t){return i.calculateNextValue("increase",t)};case 40:case 37:return function(t){return i.calculateNextValue("decrease",t)};case 35:return function(t){return i.MU.max};case 36:return function(t){return i.MU.min}}},S.prototype.calculateNextValue=function(t,i){var n,e,e,e,n={increase:function t(i,n){return i+n},decrease:function t(i,n){return i-n}},e=Object.keys(this.MU.marks).indexOf(String(i)),e=n[t](e,1),e=Object.keys(this.MU.marks)[e];return this.MU.step?n[t](i,this.MU.step):!h.isEmptyObject(this.MU.marks)&&this.MU.marks[e]?this.MU.marks[e]:i},S.prototype.JV=function(t){var t=isFinite(this.XV(t))?this.XV(t):0;return this.MU.step===a?t:parseFloat(t.toFixed(this.qV()))},S.prototype.qV=function(){var t,i;if(r(this.MU.precision)){for(i in t=l(y(this.MU.max),y(this.MU.min),y(this.MU.step)),this.MU.marks)t=l(y(parseFloat(i)),t);this.MU.precision=t}return this.MU.precision},S.prototype.XV=function(i){var t,n,n,n,n,t=Object.keys(this.MU.marks).map(parseFloat);return this.MU.step!==a&&(n=Math.ceil((this.MU.max-this.MU.min)/this.MU.step),n=M((i-this.MU.min)/this.MU.step,n),n=Math.round(n)*this.MU.step+this.MU.min,t.push(M(n,this.MU.max))),n=t.map(function(t){return g(i-t)}),t[n.indexOf(M.apply(void 0,n))]},S.prototype.SV=function(){return{prefixCls:this.MU.prefixCls,className:"".concat(this.MU.prefixCls,"-step"),direction:this.MU.direction,marks:this.MU.marks,dots:this.MU.dots,step:this.MU.step,included:this.MU.included,max:this.MU.max,min:this.MU.min}},S.prototype.TV=function(){var n=this;return{className:"".concat(this.MU.prefixCls,"-mark"),onClickLabel:this.MU.disabled?h.noop:function(t,i){n.$V(t,i)},direction:this.MU.direction,marks:this.MU.marks,included:this.MU.included,max:this.MU.max,min:this.MU.min}},S.prototype.$V=function(t,i){},S.prototype.QV=function(){var t=this.Wc.getBoundingClientRect();return this.MU.direction===c.LayoutDirection.vertical?t.top:t.left},S.prototype.tY=function(){var t=this.Wc.getBoundingClientRect();return this.MU.direction===c.LayoutDirection.vertical?t.height:t.width},S.prototype.KV=function(t){var i,n,t,i=this.MU.min,n=this.MU.max,t=g(l(t,0)/this.tY());return(t=this.MU.direction===c.LayoutDirection.vertical?l(1-t,0):t)*(n-i)+i},v=S,A=s.BaseDropdown,e(O,A),O.prototype.setValue=function(t){var i,n,i;this._V.disabled||(this._V.showNumberRange?(r(this.W1e)&&(this.W1e={}),i=t.start,n=t.end,i=parseFloat(i),i=isNaN(i)?this._V.min:(i=l(this._V.min,i),M(this._V.max,i)),this._V.numberRange.start=i,this.W1e.start=i,this.Y1e.setOffset(this.calcOffset(i),i),n=parseFloat(n),n=isNaN(n)?this._V.max:(n=l(this._V.min,n),M(this._V.max,n)),n=l(i,n),this._V.numberRange.end=n,this.W1e.end=n,this.yV.setLength(this.calcRangeOffset(),this.calcOffset(i)),this.Z1e.setOffset(this.calcOffset(n),n)):(i=parseFloat(t),i=isNaN(i)?this._V.min:(i=l(this._V.min,i),M(this._V.max,i)),this._V.value=i,this.DV=this._V.value,this.yV.setLength(this.calcOffset()),this.wV.setOffset(this.calcOffset(),i)))},O.prototype.calcOffset=function(t){var t,t,t=r(t)?this._V.value:t,t=l(t-this._V.min,0)/(this._V.max-this._V.min);return 100*(t=M(t,1))},O.prototype.calcRangeOffset=function(){var t,t,t=this._V.numberRange.end-this._V.numberRange.start,t=l(t,0)/(this._V.max-this._V.min);return 100*(t=M(t,1))},O.prototype.setOptions=function(t){this.init(t)},O.prototype.init=function(t){var t,i,t,n,n;this.nY(t),this.eY(),this.Ti.innerHTML="",(t=T("div")).className="gc-slider-container",this.Ti.appendChild(t),this._V.direction===c.LayoutDirection.vertical?(t.classList.add("".concat(this._V.prefixCls,"-vertical")),t.style.height=this._V.height+"px"):t.style.width=this._V.width+"px",(i=T("div")).className=this.UV(),t.appendChild(i),this.yV=new I(this.iY(),i),this._V.showNumberRange?((t=this.rY()).value=this._V.numberRange.start,n=T("div"),i.appendChild(n),this.Y1e=new D(t,n),t.tabIndex++,t.value=this._V.numberRange.end,n=T("div"),i.appendChild(n),this.Z1e=new D(t,n),this.AV=new v(i,this.yV,this.Y1e,this.Z1e,this.oY())):(this.wV=new D(this.rY(),i),this.AV=new v(i,this.yV,this.wV,a,this.oY())),this.AV.render(),this.aY(i)},O.prototype.aY=function(t){this._V.disabled||(t.addEventListener("mousedown",this.IV),t.addEventListener("pointerdown",this.IV),t.addEventListener("MSPointerDown",this.IV),t.addEventListener("touchstart",this.EV),t.addEventListener("keyup",this.Mme))},O.prototype.Cme=function(t,i){var n,e,n,s,i,o,c,o,c,n=this._V.numberRange,e=n.start,n=n.end,s=g(i-e),i=g(n-i),o=this.Y1e,c=this.Z1e;e===n?(n<t?(this.setValue({start:e,end:t}),this._V.onChange({start:e,end:t})):t<e&&(this.setValue({start:t,end:n}),this._V.onChange({start:t,end:n})),o.isSelectedByMouse(!1),c.isSelectedByMouse(!1)):(o=this.Z1e.isSelectedByMouse(),c=this.Y1e.isSelectedByMouse(),(o&&s<i||i<s&&!c)&&n!==t&&(this.setValue({start:e,end:t}),this._V.onChange({start:e,end:t})),(c&&i<s||s<i&&!o)&&e!==t&&(this.setValue({start:t,end:n}),this._V.onChange({start:t,end:n})))},O.prototype.kV=function(t,i){var n=0,n;return n=this._V.direction===c.LayoutDirection.vertical?this.AV.calcValueByPosition(t.clientY,i):this.AV.calcValueByPosition(t.clientX,i)},O.prototype.uY=function(){var t=function(t){};return{prefixCls:"gc-slider",dots:!1,range:!1,disabled:!1,max:100,min:0,step:1,value:0,direction:c.LayoutDirection.horizontal,included:!0,width:350,height:350,marks:{},tooltipVisible:!1,onChange:t,onAfterChange:t,formatString:"General",showNumberRange:!1,numberRange:{start:0,end:100}}},O.prototype.eY=function(){(h.isEmpty(this._V)||h.isEmptyObject(this._V))&&(this._V={}),this._V=h.extend(this.uY(),this._V)},O.prototype.nY=function(t){var n=this;t&&(r(t.scaleVisible)||(this._V.dots=t.scaleVisible),r(t.direction)||(this._V.direction=t.direction),r(t.formatString)||(this._V.formatString=t.formatString),this.sY(t.min,"min"),this.sY(t.max,"max"),this.sY(t.step,"step"),this.sY(t.width,"width"),this.sY(t.height,"height"),this._V.step<=0&&(this._V.step=1),this._V.min>this._V.max&&(this._V.max=this._V.min),r(t.tooltipVisible)||(this._V.tooltipVisible=t.tooltipVisible),r(t.showNumberRange)||(this._V.showNumberRange=!!t.showNumberRange),this._V.marks={},t.marks)&&t.marks.forEach(function(t){var t,i,t=parseFloat(t);isNaN(t)||t>=n._V.min&&t<=n._V.max&&(i=new o.Formatter.GeneralFormatter(n._V.formatString),n._V.marks[t]={label:i.format(t)})})},O.prototype.sY=function(t,i){var t;r(t)||(t=parseFloat(t),isNaN(t))||(this._V[i]=t)},O.prototype.iY=function(){return{className:"".concat(this._V.prefixCls,"-track"),included:this._V.included,direction:this._V.direction,offset:0,length:0}},O.prototype.rY=function(){return{prefixCls:this._V.prefixCls,className:"".concat(this._V.prefixCls,"-handle"),direction:this._V.direction,disabled:this._V.disabled,min:this._V.min,max:this._V.max,value:this._V.value,offset:0,tabIndex:0,tooltipVisible:this._V.tooltipVisible,formatString:this._V.formatString,showNumberRange:this._V.showNumberRange,numberRange:this._V.numberRange}},O.prototype.oY=function(){return{prefixCls:this._V.prefixCls,min:this._V.min,max:this._V.max,value:this._V.value,disabled:this._V.disabled,direction:this._V.direction,dots:this._V.dots,step:this._V.step,included:this._V.included,marks:this._V.marks,showNumberRange:this._V.showNumberRange}},O.prototype.UV=function(){var t="".concat(this._V.prefixCls);return this._V.direction===c.LayoutDirection.vertical&&(t+="  ".concat(this._V.prefixCls,"-vertical")),h.isEmptyObject(this._V.marks)||(t+=" ".concat(this._V.prefixCls,"-with-marks")),this._V.disabled&&(t+=" ".concat(this._V.prefixCls,"-disabled")),t},O.prototype.dispose=function(){var t=this.yV.Wc;t&&(t.removeEventListener("mousedown",this.IV),t.removeEventListener("pointerdown",this.IV),t.removeEventListener("MSPointerDown",this.IV),t.removeEventListener("touchstart",this.EV),t.removeEventListener("keyup",this.Mme)),this.yV.Wc=a,this.wV&&this.wV.dispose(),this.wV=a,this.Y1e&&this.Y1e.dispose(),this.Y1e=a,this.Z1e&&this.Z1e.dispose(),this.Z1e=a,A.prototype.dispose.call(this)},i.Slider=O},"./dist/plugins/celltype/editor/timepicker.js":function(t,i,n){"use strict";var e,s,o,c,r,u,a,l,M;function g(t,i){var t=M.call(this,t)||this;return t.Hc(),t.setOptions(i),t}e=this&&this.__extends||(l=function(t,i){return(l=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}l(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.TimePicker=void 0,s=n("./dist/plugins/celltype/editor/listControl.js"),o=n("./dist/plugins/celltype/editor/baseControl.js"),c="undefined",r=n("Common"),u=r.Common.lt.ht,M=o.BaseDropdown,e(g,M),g.prototype.setOptions=function(t){var i,i,i,i;t&&(null!==(i=this.cY(t.min))&&(this.MU.min=i),null!==(i=this.cY(t.max))&&(this.MU.max=i),null!==(i=this.cY(t.step))&&(this.MU.step=i),u(t.formatString)||(this.MU.formatString=t.formatString),u(t.height)||(i=parseInt(t.height,10),isNaN(i))||(this.MU.height=i),this.MU.height=Math.max(1,this.MU.height)),this._6()},g.prototype.setValue=function(t){void 0!==t&&(this.Bz={hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()},this.fY=t,this.yz(),this.scrollToSelect())},g.prototype.scrollToSelect=function(){var t,t,t=this.gz.querySelector(".selected");null!==t&&(t=t.offsetTop,this.Wc.scrollTop=t)},g.prototype.Hc=function(){var i=this;this.MU={min:{},max:{hour:23,minute:59,second:59},step:{hour:1},formatString:"hh:mm",height:200},this.gz=document.createElement("div"),this.gz.classList.add("gc-time-picker-outer-div"),this.gz.addEventListener("click",function(t){i.pz(t)}),this.Ti.appendChild(this.gz)},g.prototype.cY=function(t){var i,n,n,n,i=null;return u(t)||(i={},u(t.hour)||(n=parseInt(t.hour,10),isNaN(n))||(i.hour=n),u(t.minute)||(n=parseInt(t.minute,10),isNaN(n))||(i.minute=n),u(t.second))||(n=parseInt(t.second,10),isNaN(n))||(i.second=n),i},g.prototype._6=function(){this.gz.innerHTML="",new s.List(this.gz,this.lY()),this.yz()},g.prototype.yz=function(){var t,i,n,e,s,t=this.gz.querySelectorAll(".gc-time-picker-li");if(0<t.length)for(i=0;i<t.length;i++)t[i].classList.remove("selected"),n=+t[i].getAttribute("hour"),e=+t[i].getAttribute("minute"),s=+t[i].getAttribute("second"),this.hY(this.Bz,{hour:n,minute:e,second:s})&&t[i].classList.add("selected")},g.prototype.lY=function(){var s=this;return{items:function(){var t,i,n,e,t=s.dY(),i=document.createElement("div");for(i.classList.add("gc-time-picker-container"),s.Wc=i,s.MU.height<0?i.style.height="auto":i.style.maxHeight=s.MU.height+"px",(n=document.createElement("ul")).classList.add("gc-time-picker-ul"),e=0;e<t.length;e++)n.appendChild(s.vY(t[e]));return 24*t.length>s.MU.height&&0<=s.MU.height?i.style.overflowY="scroll":i.style.overflowY="hidden",i.appendChild(n),i}}},g.prototype.vY=function(t){var i=document.createElement("li");return i.classList.add("gc-time-picker-li"),i.setAttribute("hour",t.hour.toString()),i.setAttribute("minute",t.minute.toString()),i.setAttribute("second",t.second.toString()),i.innerText=this.mY(t),i},g.prototype.dY=function(){for(var t,i,n,t=this.gY(this.MU.min),i=this.gY(this.MU.max),n=[];t<=i;)n.push({hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()}),t=this.pY(t,this.MU.step);return n},g.prototype.pY=function(t,i){return typeof i.hour!=c&&t.setHours(t.getHours()+i.hour),typeof i.minute!=c&&t.setMinutes(t.getMinutes()+i.minute),typeof i.second!=c&&t.setSeconds(t.getSeconds()+i.second),t},g.prototype.mY=function(t){var i,n,t,i=new Date;return i.setHours(t.hour),i.setMinutes(t.minute),i.setSeconds(t.second),(t=(n=new r.Formatter.GeneralFormatter(this.MU.formatString)).format(i))&&""!==t&&null!==t?t:this.bY(i)},g.prototype.bY=function(t){var i,t,n,e,s,i=t.getHours(),t=t.getMinutes(),n,e,s;return(i<12?"AM":"PM")+" "+(0===i||12===i?"12":(i%12).toString())+":"+(t<10?"0"+t.toString():t.toString())},g.prototype.gY=function(t){var i=new Date;return i.setHours(t.hour||0),i.setMinutes(t.minute||0),i.setSeconds(t.second||0),i},g.prototype.hY=function(t,i){return!(!t||!i)&&(t=this.yY(t),i=this.yY(i),t.hour===i.hour)&&t.minute===i.minute&&t.second===i.second},g.prototype.yY=function(t){return{hour:t.hour||0,minute:t.minute||0,second:t.second||0}},g.prototype.pz=function(t){var t,i,n,t,e,s,s,t=t.target;t&&(i=+t.getAttribute("hour"),n=+t.getAttribute("minute"),t=+t.getAttribute("second"),(e=this.fY||new Date).setHours(i),e.setMinutes(n),e.setSeconds(t),e.setMilliseconds(0),s=(new r.Common.CultureInfo).DateTimeFormat,s=new r.Formatter.GeneralFormatter(s.defaultDatePattern).format(e),this.fire(o.BaseDropdown.Event_ValueChanged,{value:e,text:s}),this.Bz={hour:i,minute:n,second:t},this.yz())},i.TimePicker=g},"./dist/plugins/celltype/editor/workflowPicker.js":function(t,i,n){"use strict";var e,s,o,n,u,c,r,a;function l(t,i){var n=a.call(this,t)||this;return n.wY=new o.List(t),n.wY.on(s.BaseDropdown.Event_ValueChanged,function(t){n.fire(s.BaseDropdown.Event_ValueChanged,t)}),n.setOptions(i),n}function M(t,i){var e,s,o,n,c,r,e={items:[]},s=t.items,o=s.filter(function(t){return t.value===i})[0];if(u(o)&&s&&0<s.length)(n=e.items).push({text:s[0].value,value:s[0].value});else if(o&&o.transitions&&0<o.transitions.length)for(c=function(t){var i,t,n,i=o.transitions[t];"number"==typeof i&&s[i]&&(i=s[i].value),(t=s.filter(function(t){return t.value===i})[0])&&(n=e.items).push({text:t.value,value:t.value})},r=0;r<o.transitions.length;r++)c(r);return e}e=this&&this.__extends||(r=function(t,i){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.WorkFlow=void 0,s=n("./dist/plugins/celltype/editor/baseControl.js"),o=n("./dist/plugins/celltype/editor/listControl.js"),n=n("Common"),u=n.Common.lt.ht,a=s.BaseDropdown,e(l,a),l.prototype.setOptions=function(t){this.MU=t},l.prototype.setValue=function(t){var t;this.MU&&(t=M(this.MU,t),this.wY.setOptions(t))},l.prototype.updateStyle=function(t,i,n){this.wY.updateStyle(t,i,n)},i.WorkFlow=l},"./dist/plugins/celltype/fileUploadCellType/action.js":function(t,i,n){"use strict";var I,N,f,e;function s(t,i){this.X5=N.beforeAction,this.q5=N.afterAction;var n=this;n.Mf=t,n.tT=i}Object.defineProperty(i,"__esModule",{value:!0}),i.UPLOAD_FILE=void 0,I=n("Core"),N=n("./dist/plugins/celltype/actionUtils.js"),f=n("./dist/plugins/celltype/fileUploadCellType/utils.js"),s.prototype.execute=function(){var t,i,n,e,s,o,c,r,u,a,l,M,g,h,t=this,i=t.Mf,n=t.tT,e=i.parent.i4(),s=!0;I.Commands.II(e),t.X5(i,!0),(0,N.suspendCalcService)(i);try{o=n.row,c=n.col,r=n.newValue,u=n.fileGUID,a=n.newFileWrapper,l=n.oldFileWrapper,M=n.valuePath,g=i.getValue(o,c),(h=(0,f.getValueByValuePath)(r,M))?(a.id=u,i.Ut.setFileGUID(o,c,u),i.setValue(o,c,h),i.Ut.UHe(a)):(i.setValue(o,c,h),i.Ut.setFileGUID(o,c,void 0),i.Ut.GHe(l)),i.eT(n.row,n.col,g,h)}catch(t){s=!1}finally{I.Commands.xI(e,n),(0,N.resumeCalcService)(i,!1),t.q5(i,!0)}return s},s.prototype.undo=function(){var t,i,n,e,s,t=this,i=t.Mf,n=t.tT,e=!0;t.X5(i,!0),(0,N.suspendCalcService)(i);try{s=I.Commands.TI(i.name()),i.Ut.undo(n[s]),i.eT(n.row,n.col,n.newValue,n.oldValue)}catch(t){e=!1}finally{(0,N.resumeCalcService)(i,!1),t.q5(i,!0)}return e},s.prototype.canExecute=function(){return!0},s.prototype.canUndo=function(){return!0},e=s,i.UPLOAD_FILE="uploadFile",I.Commands[i.UPLOAD_FILE]={canUndo:!0,execute:function(t,i,n){return(0,N.executeCommand)(t,e,i,n)}}},"./dist/plugins/celltype/fileUploadCellType/definition-comments.js":function(){},"./dist/plugins/celltype/fileUploadCellType/feature-register.js":function(t,i,n){"use strict";var e,s;function o(){e.Worksheet.ch("fileUploadCellType",{preUploadFile:function(t){var i,i,i,n,i,n=t.sheet.isReportTemplateSheet,i="19"===(null==(i=null==(i=null==(i=t.sheet.sw.cellTypeHitInfo)?void 0:i.cellStyle)?void 0:i.cellType)?void 0:i.typeName);t.cancel=n&&i}}),e.Workbook.ch("registerUploadFileCommand",{init:function(){this.commandManager().register(s.UPLOAD_FILE,e.Commands[s.UPLOAD_FILE])}})}Object.defineProperty(i,"__esModule",{value:!0}),i.registerFeatures=void 0,e=n("Core"),s=n("./dist/plugins/celltype/fileUploadCellType/action.js"),i.registerFeatures=o},"./dist/plugins/celltype/fileUploadCellType/filePreviewDialog.js":function(t,i,n){"use strict";var e,n,s,o,c;function r(){return null!==c&&c.apply(this,arguments)||this}e=this&&this.__extends||(o=function(t,i){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}o(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.T9e=void 0,n=n("Core"),c=n.Ase,e(r,c),r.prototype.rQ=function(t,i){this.Dn(),this.I9e(t,i),this.q2e(),this.$2e(i)},r.prototype.Dn=function(){this.Wc.html(this.k9e())},r.prototype.I9e=function(t,i){var n,e,s,n;c.prototype.$c.call(this),e=(n=this.Wc.get(0)).querySelector(".gc-sjs-file-preview-dialog-title-text"),s=n.querySelector(".gc-sjs-file-preview-dialog-image"),n=n.querySelector(".gc-sjs-file-preview-dialog-container"),e.textContent=t,s.src=i,s.alt=i,n.style.maxHeight=this.Fc.height()-50+"px"},r.prototype.rpe=function(t){var i,t,i,t=t.target.dataset.cmd;t&&"close"===t&&this.close()},r.prototype.q2e=function(){var i,t,n,e,i=this,t=function(t){i.rpe(t)},n=function(t){"Escape"!==t.key&&27!==t.keyCode||i.close()};this.Wc.bind("click",t),document.addEventListener("keyup",n),e=this.bindMoveEvent(this.Wc[0].querySelector(".gc-sjs-file-preview-dialog-title")),this.wpt=function(){i.Wc.unbind("click",t),document.removeEventListener("keyup",n),e()}},r.prototype.$2e=function(t){var o,c,o=this,c=new Image;o.Wc.css(["display"],["none"]),c.onload=function(){var t,i,n,i,t,e,s,i,t=c.width,i=c.height,n=o.Wc.width(),i=i/t*n,t=o.Fc.width(),e,s,i=(o.Fc.height()-i)/2;o.Wc.css(["position","left","top","display"],["absolute",(t-n)/2+"px",(0<i?i:20)+"px","block"])},c.src=t},r.prototype.close=function(){this.wpt&&this.wpt(),c.prototype.close.call(this)},r.prototype.k9e=function(){return'\n<div class="gc-sjs-file-preview-dialog-container">\n  <div class="gc-sjs-file-preview-dialog-title">\n      <span class="gc-sjs-file-preview-dialog-title-text"></span>\n      <span class="cancel-icon" data-cmd="close">\xd7</span>\n  </div>\n  <div class="gc-sjs-file-preview-dialog-content">\n        <img class="gc-sjs-file-preview-dialog-image" src="#" alt="#" width="100%" />\n  </div>\n</div>\n      '},i.T9e=r},"./dist/plugins/celltype/fileUploadCellType/fileUploadCellType.js":function(t,i,n){"use strict";var e,s,o,g,c,r,w,l,j,n,o,u,M,a,h,I;function N(){var t=I.call(this)||this;return t.typeName="19",t._text=(0,w.getSR)().FileUpload_Title,t.N9e=M,t.j9e=M,t._9e=22,t.Hc(),t}e=this&&this.__extends||(h=function(t,i){return(h=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}h(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var i,n,e,s,n=1,e=arguments.length;n<e;n++)for(s in i=arguments[n])Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s]);return t}).apply(this,arguments)},Object.defineProperty(i,"__esModule",{value:!0}),i.FileUpload=void 0,o=n("Common"),g=n("Core"),c=n("./dist/plugins/celltype/fileUploadCellType/filePreviewDialog.js"),r=n("./dist/plugins/celltype/fileUploadCellType/feature-register.js"),w=n("./dist/plugins/celltype/fileUploadCellType/utils.js"),n("./dist/plugins/celltype/fileUploadCellType/definition-comments.js"),l=o.Common.lt.ht,j=g.CellTypes.Text,n=g.CellTypes.Base,o=g.GC$,u=o.each,M=null,e(N,I=n),N.prototype.x9e=function(t,i){(0,w.x9e)(t,i)},N.prototype.thumbnailSize=function(t){return t&&(t.width?this.D9e.width=t.width:delete this.D9e.width,t.height?this.D9e.height=t.height:delete this.D9e.height),this.D9e},N.prototype.Hc=function(){var n=this;u(w.defaultFileUploadProps,function(t,i){n["_"+t]=i}),n.D9e={}},N.prototype.O9e=function(t,i,n){var e;return this.E9e(this.R9e(t,i,n))&&(this._isPreviewEnabled||this._isDownloadEnabled||this._isClearEnabled)},N.prototype.F9e=function(t,i,n){var e,e,s,o,c,s,o=t.Oi&&t.HO(i,n),c;return((null==(e=this.N9e)?void 0:e.row)===i&&(null==(e=this.N9e)?void 0:e.col)===n||o)&&this.O9e(t,i,n)},N.prototype.B9e=function(t,i){var t,n,t,n="",t=null==t?void 0:t.split(".");return(n=t&&1<t.length?t.pop():null!=(t=w.MIMETYPE_TO_FILE_EXTENSION_MAP[i])?t:"").toLowerCase()},N.prototype.L9e=function(t,i,n){var t,t,t,n,t,t=null!=(t=null==(t=null==(t=t.getParent())?void 0:t.options)?void 0:t.builtInFileIcons)?t:n;return null!=(n=null==t?void 0:t[i])?n:w.ICON_MAP.commonFile},N.prototype.E9e=function(t){return(0,w.E9e)(t)},N.prototype.P9e=function(t,i,n){var e,i,s,n,t,t,e=[],i=this.R9e(t,i,n,!0);return i?(s=this.B9e(i.name,i.type),n=-1!==w.IMAGE_FILE_EXTENSIONS.findIndex(function(t){return s===t}),t=(t=t.BO()).getState(i.dataUrl)&&!t.qh(i.dataUrl),this._isPreviewEnabled&&(n&&!t||this.previewCommand)&&e.push("preview"),!this._isDownloadEnabled||n&&t||e.push("download"),e):[]},N.prototype.G9e=function(t,i,n){return this.P9e(t,i,n).map(function(t){return w.ICON_MAP[t]})},N.prototype.U9e=function(t,i,n,e){var t,i,s,t=this.G9e(t,i,n).length,i=.2*e>this._9e?this._9e:.2*e,s;return{iconSize:i,space:(e-i*t)/(t+1)}},N.prototype.H9e=function(t){var i=t.BO();Object.values(w.ICON_MAP).forEach(function(t){i.addImage(t,"anonymous")})},N.prototype.R9e=function(t,i,n,e,s){var o,c,r,u,c,a,c,e,o=t.Ut.getFileGUID(i,n),c=t.VTe(),r=t.getValue(i,n),u=c.Wxn(o,!0),c=c.FHe(o),a=this._valuePath;if(c||!r)return u&&(e?u:(c={dataUrl:u.dataUrl,blob:u.blob,name:u.name},e=(0,w.getValueByValuePath)(c,a,u),(0,w.isFileInfoEqual)(e,r)||s?c:void(0,w.x9e)({row:i,col:n,value:r,valuePath:a,fileGUID:o},t,void 0,!0)));(0,w.x9e)({row:i,col:n,value:r,fileGUID:o,valuePath:a},t,void 0,!0)},N.prototype.paintValue=function(t,i,n,e,s,o,c,r){var u,a,l,M,g,h,I,N,N,u=this;t&&(a=n+u._marginLeft,l=e+u._marginTop,M=s-u._marginLeft-u._marginRight,g=o-u._marginTop-u._marginBottom,h=n<a+M&&a<n+s&&e<l+g&&l<e+o,I=u._text,N=u.R9e(r.sheet,r.row,r.col,void 0,r.isPrinting),N=u.E9e(N),0<M-2)&&0<g-2&&h&&(t.save(),(a<n||n+s<a+M||l<e||e+o<l+g)&&(t.rect(n,e,s,o),t.clip()),t.beginPath(),N?(u.V9e(t,a,l,M,g,c,r),this.F9e(r.sheet,r.row,r.col)&&u.z9e(t,n,e,s,o,c,r)):u.Y9e(t,I,a,l,M,g,c,r),t.restore())},N.prototype.getText=function(t){return t},N.prototype.Fn=function(t,i,n,e,s){var o,c,r,r,u,n,a,e,l,M,o=s.sheet,c=s.row,r=s.col,r=this.R9e(o,c,r,!0),u=this.marginTop()+this.marginBottom(),n=I.prototype.Fn.call(this,t,r&&t?r.name:(0,w.getSR)().FileUpload_Title,n,e,s)+u;return r&&t&&(a=3,e=parseFloat(o.getRowHeight(c,g.SheetArea.viewport)+"")-3,l=this.B9e(r.name,r.type),(M=-1!==w.IMAGE_FILE_EXTENSIONS.findIndex(function(t){return l===t}))?n=e:n*=2.5),n},N.prototype.Ln=function(t,i,n,e,s){var o,c,r,c,u,n,a,e,l,M,o=s.sheet,c=s.row,r=s.col,c=this.R9e(o,c,r,!0),u=this.marginTop()+this.marginBottom(),n=I.prototype.Ln.call(this,t,c&&t?c.name:(0,w.getSR)().FileUpload_Title,n,e,s)+u;return n=c&&t&&(a=3,e=parseFloat(o.getColumnWidth(r,g.SheetArea.viewport)+"")-3,l=this.B9e(c.name,c.type),M=-1!==w.IMAGE_FILE_EXTENSIONS.findIndex(function(t){return l===t}))?e:n},N.prototype.Y9e=function(t,i,n,e,s,o,c,r){var u,u,a,l,u,M,g,h,I,M,u,g,h,I,M,I,M,g,h,u,a=this,l=3,u=(null==(u=a.N9e)?void 0:u.row)===r.row&&(null==(u=a.N9e)?void 0:u.col)===r.col,M=r.sheet.currentTheme().colors().accent1(),g=M.r,h=M.g,I=M.b,M=M.a,u=u?"rgba(".concat(g,",").concat(h,",").concat(I,",").concat(M,")"):"rgb(217,217,217)",g=n+1,h=e+1,I=s-2,M=o-2;t.setLineDash([3,2]),t.moveTo(g+3,h),t.lineTo(g+I-3,h),t.arc(g+I-3,h+3,3,1.5*Math.PI,2*Math.PI),t.lineTo(g+I,h+M-3),t.arc(g+I-3,h+M-3,3,0,.5*Math.PI),t.lineTo(g+3,h+M),t.arc(g+3,h+M-3,3,.5*Math.PI,Math.PI),t.lineTo(g,h+3),t.arc(g+3,h+3,3,Math.PI,1.5*Math.PI),t.lineTo(g,h+3),t.closePath(),u&&t.strokeStyle!==u&&(t.strokeStyle=u),t.lineWidth=2,t.stroke(),M=(I=r.sheet.currentTheme().colors().background2()).r,g=I.g,h=I.b,u=I.a,t.fillStyle="rgba(".concat(M,", ").concat(g,", ").concat(h,", ").concat(u,")"),t.fill(),j.prototype.paintValue.call(a,t,i,n,e,s,o,c,r)},N.prototype.V9e=function(t,i,n,e,s,o,c){var r,u,u,r,r,a,l,M,g,h,a,g,h,I,u,M,h,I,M,r,N,f,r,D,u,r,a,u,d,v,l=this,M=c.sheet,g=c.row,h=c.col;this.H9e(M),a=l.thumbnailSize(),(g=this.R9e(M,g,h,!0))&&(h=g.dataUrl,u=(I=l.B9e(g.name,g.type))&&-1<w.IMAGE_FILE_EXTENSIONS.indexOf(I),M=l.L9e(M,I,c.builtInFileIcons),(M=(I=c.imageLoader).getImage(h=u?h:M))||I.addImage(h,"anonymous"),r=I.getState(h),"string"!=typeof h&&h&&h.toString&&!r&&(h=h.toString(),r=u=!0),r)&&(u?I.qh(h)?(N=null!=(r=a.width)?r:e-2,f=null!=(u=a.height)?u:s-2,t.drawImage(M,0,0,M.width,M.height,i+1,n+1,N,f)):(r=I.getImage(w.ICON_MAP.errorFile))&&t.drawImage(r,0,0,r.width,r.height,i+1,n+1,null!=(u=a.width)?u:e-2,null!=(r=a.height)?r:s-2):(D=4,u=e<.6*(s-2)?.6*(e-2):.6*(s-2)-8,r=(e-2-(N=null!=(r=a.width)?r:u))/2+1,a=(.6*(s-2)-(f=null!=(a=a.height)?a:u))/2+1,I.qh(h)?t.drawImage(M,0,0,M.width,M.height,i+r,n+a,N,f):(u=I.getImage(w.ICON_MAP.commonFile),t.drawImage(u,0,0,u.width,u.height,i+r,n+a,N,f)),j.prototype.paintValue.call(l,t,g.name,i,v=n+.6*(s-2),e,.4*(s-2),o,c)))},N.prototype.z9e=function(t,i,n,e,s,o,c){this.Z9e(t,i,n,e,s),this.Q9e(t,i,n,e,s,o,c)},N.prototype.Z9e=function(t,i,n,e,s){t.save(),t.beginPath(),t.rect(i,n,e,s),t.fillStyle="rgba(0, 0, 0, 0.3)",t.fillRect(i,n,e,s),t.restore()},N.prototype.Q9e=function(t,i,n,e,s,o,c){this.W9e(t,i,n,e,s,c),this.J9e(t,i,n,e,s,c)},N.prototype.W9e=function(e,s,t,o,i,c){var r,u,n,a,l,M,g,r=this,u=c.sheet.BO();e.save(),e.beginPath(),n=this.U9e(c.sheet,c.row,c.col,o),a=n.iconSize,l=n.space,M=t+(i-a)/2,g=this.P9e(c.sheet,c.row,c.col),this.G9e(c.sheet,c.row,c.col).forEach(function(t,i){var t,n,i;u.getImage(t)||r.H9e(c.sheet),u.getState(t)&&u.qh(t)&&(t=u.getImage(t),n=s+(i+1)*l+i*a,g[i]===r.j9e&&(e.fillStyle="rgba(255, 255, 255, 0.3)",i=.2*o>r._9e?4:2,e.fillRect(n-i,M-i,a+2*i,a+2*i)),e.drawImage(t,n,M,a,a))}),e.restore()},N.prototype.J9e=function(t,i,n,e,s,o){var c,i,r,u,e,n,a,o;this.isClearEnabled()&&(c=o.sheet.BO(),t.save(),t.beginPath(),e=i+e-(i=this.U9e(o.sheet,o.row,o.col,e).iconSize)-4,n=n+(u=r=2)+2,a=w.ICON_MAP.clear,c.getImage(a)||this.H9e(o.sheet),c.getState(a)&&c.qh(a)&&(o=c.getImage(a),"clear"===this.j9e&&(t.fillStyle="rgba(255, 255, 255, 0.3)",t.fillRect(e-2,n-2,i+4,i+4)),t.drawImage(o,e,n,i,i)),t.restore())},N.prototype.processMouseUp=function(t){var i,i,n,e,s,i={cancel:!1,sheet:t.sheet};if(g.Worksheet.et(t.sheet,"preUploadFile",i),!i.cancel&&this.K9e(t))return i=t.sheet,n=t.row,e=t.col,this.F9e(i,n,e)?(this.X9e(t),!0):!(this.O9e(i,n,e)||(this.H9e(i),!i)||!t.isReservedLocation||((s=this.q9e(t)).click(),0))},N.prototype.processMouseEnter=function(t){var i,n,t;return!!this.K9e(t)&&(i=t.sheet,n=t.row,t=t.col,this.N9e={row:n,col:t},i.zw(),!0)},N.prototype.processMouseLeave=function(t){return this.K9e(t)&&(this.N9e=M,t.sheet.zw()),!1},N.prototype.processMouseMove=function(t){var i,i,n,e,s,i;return!!this.K9e(t)&&(n=t.sheet,e=t.row,s=t.col,this.N9e&&(null==(i=this.N9e)?void 0:i.col)===s&&(null==(i=this.N9e)?void 0:i.row)===e||(this.N9e={row:e,col:s}),!!this.F9e(n,e,s))&&((i=this.$9e(t))!==this.j9e&&(this.j9e=i,n.zw()),!0)},N.prototype.getHitInfo=function(t,i,n,e,s){var o,c,r,u,a,o,e,o=this;return s&&(c=s.sheetArea,l(c)||3===c)&&e?(r=e.x+o._marginLeft,u=e.x+e.width-o._marginRight,a=e.y+o._marginTop,o=e.y+e.height-o._marginBottom,e={x:t,y:i,row:s.row,col:s.col,cellRect:e,sheetArea:c,sheet:s.sheet,cellStyle:n},r<=t&&t<=u&&a<=i&&i<=o&&(e.isReservedLocation=!0),e):M},N.prototype.$9e=function(t){var i,n,e,s,o,s,i,n,e,s,n,t,o,i=t.sheet,n=t.row,e=t.col,s=this.U9e(i,n,e,t.cellRect.width),o=s.iconSize,s=s.space,i=this.P9e(i,n,e),n=t.cellRect.y+(t.cellRect.height-o)/2,e=t.x>=t.cellRect.x+s-2&&t.x<=t.cellRect.x+o+s+2,s=t.x>=t.cellRect.x+o+2*s-2&&t.x<=t.cellRect.x+2*o+2*s+2,n=t.y>=n-2&&t.y<=n+o+2,t=t.x>=t.cellRect.x+t.cellRect.width-o-6&&t.x<=t.cellRect.x+t.cellRect.width-2&&t.y>=t.cellRect.y-2&&t.y<=t.cellRect.y+o+6&&this.isClearEnabled(),o=e&&n?i[0]:s&&n?i[1]:t?"clear":M;return o},N.prototype.q9e=function(t){var i,n,e,i=this,n="sjs-fake-file-upload-dom";return document.getElementById(n)&&document.getElementById(n).remove(),(e=document.createElement("input")).type="file",e.style.display="none",e.accept=i.accept(),e.id=n,e.addEventListener("change",function(){i.D7e(t,e),e.remove()}),document.body.appendChild(e),e},N.prototype.G7e=function(t,i,n,e){var s=this.R9e(t,i,n);(0,w.x9e)({row:i,col:n,value:e,oldValue:s,valuePath:this._valuePath},t,!0)},N.prototype.D7e=function(t,i){var n,e,t,i,s,s,n=t.sheet,e=t.row,t=t.col,i=i.files[0];i&&(i.size>1024*this.maxSize()?(s={row:e,col:t,maxSize:this.maxSize(),fileSize:i.size},n.jT(g.InvalidOperationType.sizeLimitExceeded,n.A9e(),s)):(s={name:i.name,blob:i},this.G7e(n,e,t,s)))},N.prototype.U7e=function(t,i){var n,e,s,o,n=t.sheet,e=t.col,s=t.row,o=this.R9e(n,s,e);if(this.E9e(o)){switch(i){case"preview":this.V7e(o,t);break;case"download":this.Y7e(n,s,e);break;case"clear":this.Z7e(n,s,e)}this.N9e=M,this.j9e=M}},N.prototype.K9e=function(t){var i=t.sheet,n=t.col,t=t.row;return!(i.isActualProtected()&&i.getCell(t,n).locked())},N.prototype.Q7e=function(t){var i;new c.T9e(document.body,2e3,!0).rQ(t.name,t.dataUrl)},N.prototype.V7e=function(t,i){var n,e,i,i,e;this.previewCommand?(n=i.sheet,e=i.col,i=i.row,i=s(s({},t),{sheetName:n.name(),row:i,col:e}),"function"==typeof this.previewCommand?this.previewCommand(i):"string"==typeof this.previewCommand&&null!=(e=n.getParent())&&e.commandManager().execute(s({cmd:this.previewCommand},i))):this.Q7e(t)},N.prototype.Y7e=function(t,i,n){var t,i,t=this.R9e(t,i,n,!0);t&&((i=document.createElement("a")).href=t.dataUrl,i.download=t.name,i.type=t.type,i.click())},N.prototype.Z7e=function(t,i,n){this.G7e(t,i,n)},N.prototype.X9e=function(t){this.j9e===M&&(this.j9e=this.$9e(t)),this.U7e(t,this.j9e)},N.prototype.Je=function(t){var t,i,i={marginTop:t.marginTop,marginRight:t.marginRight,marginBottom:t.marginBottom,marginLeft:t.marginLeft,maxSize:t.maxSize,accept:t.accept,isPreviewEnabled:t.isPreviewEnabled,isDownloadEnabled:t.isDownloadEnabled,isClearEnabled:t.isClearEnabled};t.hasOwnProperty("valuePath")&&(i.valuePath=null!=(t=t.valuePath)?t:null),this.fromJSON(i)},N.prototype.toJSON=function(){var n,e,s,n=this,e={typeName:n.typeName};return u(w.defaultFileUploadProps,function(t,i){(s=n["_"+t])!==i&&(e[t]=s)}),e},N.prototype.fromJSON=function(n){var e=this;u(w.defaultFileUploadProps,function(t){var i=n[t];void 0!==i&&(e["_"+t]=i)})},a=N,i.FileUpload=a,u(w.defaultFileUploadProps,function(i){a.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:(this["_"+i]=t="valuePath"===i&&void 0===t?null:t,this)}}),(0,r.registerFeatures)(),g.CellTypes.ti[19]=a},"./dist/plugins/celltype/fileUploadCellType/utils.js":function(t,N,i){"use strict";var n,i,i,e,s,f,o,c;function r(t,i,n){if(n||t){if("string"==typeof i)return(n||t)[i];if(n&&n.hasOwnProperty(i))return n[i];if(e(i)&&n)return n.cellValue}return t}function u(t,i){var n,e,s,o,n=typeof t,e;if(n!=typeof i)return!1;if("string"==n)return t===i;if("object"==n){if(t instanceof Blob||i instanceof Blob)return t===i;if(t&&i)return t.blob===i.blob&&t.dataUrl===i.dataUrl&&t.name===i.name}return!0}Object.defineProperty(N,"__esModule",{value:!0}),N.isFileInfoEqual=N.getValueByValuePath=N.x9e=N.Hne=N.E9e=N.defaultFileUploadProps=N.MIMETYPE_TO_FILE_EXTENSION_MAP=N.IMAGE_FILE_EXTENSIONS=N.ICON_MAP=N.getSR=void 0,n=i("Common"),i=i("./dist/plugins/celltype/celltypes.ns.js"),i=new n.Common.ResourceManager(i.SR,"CellTypes"),e=n.Common.lt.ht,N.getSR=i.getResource.bind(i),N.ICON_MAP={commonFile:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNjRweCIgaGVpZ2h0PSI2NHB4IiB2aWV3Qm94PSIwIDAgNjQgNjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+Y29tbW9uIGZpbGUgaW1hZ2U8L3RpdGxlPgogICAgPGcgaWQ9ImNvbW1vbi1maWxlLWltYWdlIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNTAsMiBDNTIuMjA5MTM5LDIgNTQsMy43OTA4NjEgNTQsNiBMNTQsNTggQzU0LDYwLjIwOTEzOSA1Mi4yMDkxMzksNjIgNTAsNjIgTDE0LDYyIEMxMS43OTA4NjEsNjIgMTAsNjAuMjA5MTM5IDEwLDU4IEwxMCwxOC4xMDEwNzQyIEwyMS45NjMzNzg5LDE4LjEwMTA3NDIgQzI0LjE3MjUxNzksMTguMTAxMDc0MiAyNS45NjMzNzg5LDE2LjMxMDIxMzIgMjUuOTYzMzc4OSwxNC4xMDEwNzQyIEwyNS45NjMzNzg5LDIgTDUwLDIgWiBNMjMsMiBMMjMsMTUgTDEwLDE1IEwyMywyIFoiIGlkPSLlvaLnirbnu5PlkIjlpIfku70iIGZpbGw9IiM1MTUxNTEiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+",errorFile:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNjRweCIgaGVpZ2h0PSI2NHB4IiB2aWV3Qm94PSIwIDAgNjQgNjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+ZXJyb3IgSW1hZ2U8L3RpdGxlPgogICAgPGcgaWQ9ImVycm9yLUltYWdlIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0i57yW57uEIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyLjAwMDAwMCwgOC4wMDAwMDApIiBmaWxsLXJ1bGU9Im5vbnplcm8iPgogICAgICAgICAgICA8cG9seWdvbiBpZD0i5b2i54q257uT5ZCILXBhdGjlpIfku70tMiIgZmlsbD0iI0ZGRkZGRiIgcG9pbnRzPSI2MCA0LjI2MzI1NjQxZS0xNCAwIDQuMjYzMjU2NDFlLTE0IDAgNDguOTQ3MzY4NCA2MCA0OC45NDczNjg0Ij48L3BvbHlnb24+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0yNi44MjYsMCBMMzIsMTEuMzMwMDc4MSBMMjIsMjMuMTIxMDkzNyBMMjksMzguODQzNzUgTDI0LjEyOCw0OCBMNCw0OCBDMS43OTA4NjEsNDggLTEuMTk2OTk2ODhlLTE1LDQ2LjIwOTEzOSAwLDQ0IEwwLDQgQy0yLjcwNTQxNWUtMTYsMS43OTA4NjEgMS43OTA4NjEsLTEuMDYxNzI2MTNlLTE1IDQsMCBMMjYuODI2LDAgWiBNNTYsMCBDNTguMjA5MTM5LC00LjA1ODEyMjUxZS0xNiA2MCwxLjc5MDg2MSA2MCw0IEw2MCw0NCBDNjAsNDYuMjA5MTM5IDU4LjIwOTEzOSw0OCA1Niw0OCBMMzEuMDk0LDQ4IEwzNiwzOC42MjY5NTMxIEwyOSwyMy40OTgwNDY5IEwzOSwxMS4yNTM5MDYyIEwzMy44MzYsMCBMNTYsMCBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjRTVFNUU1Ij48L3BhdGg+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNi4zNjU2ODUxLDE1IEwyMy4wMzEsMjIuMDA3IEwyMiwyMy4xMjEwOTM3IEwyOSwzOC44NDM3NSBMMjQuMTI3LDQ4IEw0LDQ4IEMxLjc5MDg2MSw0OCAyLjc2Njg4MDE4ZS0xNCw0Ni4yMDkxMzkgMi44NDIxNzA5NGUtMTQsNDQgTDIuODQyMTcwOTRlLTE0LDMxLjIxMTA3MTIgTDE2LjM2NTY4NTEsMTUgWiBNNDguMzkxNjc2OCwyNi4wMTg3NTQyIEw2MCwzNS42NDIyNzM1IEw2MCw0NCBDNjAsNDYuMjA5MTM5IDU4LjIwOTEzOSw0OCA1Niw0OCBMMzEuMDkzLDQ4IEwzNiwzOC42MjY5NTMxIEwzMy4zMDcsMzIuODA4IEwzNy44MjA3NjkyLDM3LjU1MjcyODggTDM3LjgyMjI2NTUsMzcuMDA5MzkxNCBMNDguMzkxNjc2OCwyNi4wMTg3NTQyIFogTTQ4LDcgQzUwLjIwOTEzOSw3IDUyLDguNzkwODYxIDUyLDExIEM1MiwxMy4yMDkxMzkgNTAuMjA5MTM5LDE1IDQ4LDE1IEM0NS43OTA4NjEsMTUgNDQsMTMuMjA5MTM5IDQ0LDExIEM0NCw4Ljc5MDg2MSA0NS43OTA4NjEsNyA0OCw3IFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNEM0QzRDMiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",preview:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjBweCIgaGVpZ2h0PSIyMHB4IiB2aWV3Qm94PSIwIDAgMjAgMjAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+cHJldmlldyBpbWFnZTwvdGl0bGU+CiAgICA8ZyBpZD0icHJldmlldy1pbWFnZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTEwLjAwMDE0NzMsMyBDMTIuMjM1MDA1NSwzIDE0LjI1ODM2MzUsMy45OTU2OCAxNS44Njk3MjE0LDUuMTYyMDIgQzE3LjQ4NzcyMjEsNi4zMzMyNiAxOC43NTY4NjU1LDcuNzI0NTggMTkuNDk4NTA4Nyw4LjYyNjYgTDE5LjMxMiw4Ljc3MyBMMTkuNDk4OTM3Myw4LjYyNzE2IEMyMC4xMjc1NzYyLDkuMzkzMjQgMjAuMTY0OTM0NiwxMC40MjkxMTIxIDE5LjYwOTY0MjgsMTEuMjI2Njk4OSBMMTkuNDk4NTgwMSwxMS4zNzMzMyBMMTkuMzQzMTk5NywxMS41NjAxMTc4IEMxOC41ODYwOTU5LDEyLjQ1OTk1MTIgMTcuMzc5ODU1NCwxMy43NDQ4MjI3IDE1Ljg2OTcyMTQsMTQuODM3OTggQzE0LjI1ODM2MzUsMTYuMDA0MzIgMTIuMjM1MDA1NSwxNyAxMC4wMDAxNDczLDE3IEM3Ljc2NTI4OTE4LDE3IDUuNzQxOTMxMTMsMTYuMDA0MzIgNC4xMzA2NDQ3LDE0LjgzNzk4IEMyLjUxMzU3MjU1LDEzLjY2NzQ0IDEuMjQ1MDAwNTYsMTIuMjc3MSAwLjUwMzE0MzA4MiwxMS4zNzUwOCBDMC4xNzk1MDAwOCwxMC45ODU5NSAwLDEwLjUwMjMyIDAsMTAgQzAsOS40OTc2OCAwLjE3OTUwMDA4LDkuMDE0MDUgMC41MDMyMTQ1MSw4LjYyNDkyIEMxLjI0NTAwMDU2LDcuNzIyODMgMi41MTM2NDM5OCw2LjMzMjU2IDQuMTMwNjQ0Nyw1LjE2MjAyIEM1Ljc0MTkzMTEzLDMuOTk1NjggNy43NjUyODkxOCwzIDEwLjAwMDE0NzMsMyBaIE0xMC4wMDAxNTQ3LDQgQzguMTA1MDUzNyw0IDYuMjkyMDc3NzYsNC44NjgwNSA0LjcyODMyNjk0LDYuMDIzMDUgQzMuMTcxNjI2MTMsNy4xNzI4NzUgMS45MzA1MjU0OCw4LjU1NjcgMS4xOTQ5MjUxLDkuNDY5Njc1IEMxLjA2NDgwMDAzLDkuNjI4ODI1IDEsOS44MTQxNSAxLDEwIEMxLDEwLjE4NTg1IDEuMDY0ODAwMDMsMTAuMzcxMTc1IDEuMTkxNjI1MSwxMC41MjYzNSBDMS45MzA1MjU0OCwxMS40NDMzIDMuMTcxNjI2MTMsMTIuODI3MTI1IDQuNzI4MzI2OTQsMTMuOTc2OTUgQzYuMjkyMDc3NzYsMTUuMTMxOTUgOC4xMDUwNTM3LDE2IDEwLjAwMDE1NDcsMTYgQzExLjg5NTMzMDcsMTYgMTMuNzA4MjMxNiwxNS4xMzE5NSAxNS4yNzE5ODI0LDEzLjk3Njk1IEMxNi44Mjg2MDgyLDEyLjgyNzIgMTguMDY5NzA4OSwxMS40NDM0NSAxOC44MDUzMDkzLDEwLjUzMDQ3NSBDMTkuMDY0NzM0NCwxMC4yMDg0MjUgMTkuMDY1MTg0NCw5Ljc5MjcgMTguODA0OTM0Myw5LjQ2OTA3NSBDMTguMDY5MjU4OSw4LjU1NjEgMTYuODI4MzgzMiw3LjE3MjY1IDE1LjI3MTk4MjQsNi4wMjMwNSBDMTMuNzA4MjMxNiw0Ljg2ODA1IDExLjg5NTMzMDcsNCAxMC4wMDAxNTQ3LDQgWiBNOS45OTk5NjA0NSw2IEMxMi4xNzA5ODU2LDYgMTQsNy43NTIwNzQyOCAxNCwxMCBDMTQsMTIuMjQ3OTI1NyAxMi4xNzA5ODU2LDE0IDkuOTk5OTYwNDUsMTQgQzcuODI5MDE0MzcsMTQgNiwxMi4yNDc5MjU3IDYsMTAgQzYsNy43NTIwNzQyOCA3LjgyOTAxNDM3LDYgOS45OTk5NjA0NSw2IFogTTkuOTk5OTUwOTMsNyBDOC4yOTU3MTY2LDcgNyw4LjM5MjUzMDg5IDcsMTAgQzcsMTEuNjA3NDY5MSA4LjI5NTcxNjYsMTMgOS45OTk5NTA5MywxMyBDMTEuNzA0MTg1MywxMyAxMywxMS42MDc0NjkxIDEzLDEwIEMxMyw4LjM5MjUzMDg5IDExLjcwNDE4NTMsNyA5Ljk5OTk1MDkzLDcgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgPC9nPgo8L3N2Zz4=",download:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjBweCIgaGVpZ2h0PSIyMHB4IiB2aWV3Qm94PSIwIDAgMjAgMjAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+ZG93bmxvYWQgZmlsZXM8L3RpdGxlPgogICAgPGcgaWQ9ImRvd25sb2FkLWZpbGVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTEuMDg4Nzc5NSwyLjM3ODY0NTkgTDE1Ljk2NTI4NTUsNyBMMTUuOTY1Mjg1NSw3IEwxNS45NjUyODU1LDggTDExLjA4ODc3OTUsMTIuNjIxMzU0MSBDMTAuODg2Nzg2NiwxMi44MTI3NzgxIDEwLjU2OTA4NTEsMTIuODA4NTExNSAxMC4zNzIzMDU3LDEyLjYxMTczMjEgQzEwLjE4MDkxNTIsMTIuNDIwMzQxNiAxMC4xODA5MTUyLDEyLjExMDAzNjQgMTAuMzcyMzA1NywxMS45MTg2NDU5IEMxMC4zNzQ2MTksMTEuOTE2MzMyNiAxMC4zNzY5NTU0LDExLjkxNDA0MjUgMTAuMzc5MzE0NiwxMS45MTE3NzYgTDE0LjQ1MTI4NTUsNy45OTk3MTQ1IEwxNC40NTEyODU1LDcuOTk5NzE0NSBMNS40NjUyODU1LDcuOTk5OTg0OTUgQzUuMTg5MTUxNDQsNy45OTk5OTMyNiA0Ljk2NTI5MzgxLDcuNzc2MTQ5MTEgNC45NjUyODU1LDcuNTAwMDE1MDUgQzQuOTY1Mjg1NSw3LjUwMDAxMDAzIDQuOTY1Mjg1NSw3LjUwMDAwNTAyIDQuOTY1Mjg1NSw3LjUgQzQuOTY1Mjg1NSw3LjIyMzg1NTE5IDUuMTg5MTQwNjksNi45OTk5OTMyNiA1LjQ2NTI4NTUsNi45OTk5ODQ5NSBMMTQuNDUxMjg1NSw2Ljk5OTcxNDUgTDE0LjQ1MTI4NTUsNi45OTk3MTQ1IEwxMC4zNzkzMzc4LDMuMDg4MTk5ODcgQzEwLjE4NDE1MzcsMi45MDA3MDU5NCAxMC4xNzc5MTk2LDIuNTkwNDg0MDkgMTAuMzY1NDEzNSwyLjM5NTI5OTk5IEMxMC4zNjc2ODczLDIuMzkyOTMyOTQgMTAuMzY5OTg0OCwyLjM5MDU4ODc5IDEwLjM3MjMwNTcsMi4zODgyNjc5IEMxMC41NjkwODUxLDIuMTkxNDg4NDcgMTAuODg2Nzg2NiwyLjE4NzIyMTg1IDExLjA4ODc3OTUsMi4zNzg2NDU5IFoiIGlkPSLlvaLnirbnu5PlkIjlpIfku70tM+Wkh+S7vSIgZmlsbD0iI0ZGRkZGRiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAuNDY1Mjg1LCA3LjUwMDAwMCkgc2NhbGUoLTEsIC0xKSByb3RhdGUoLTkwLjAwMDAwMCkgdHJhbnNsYXRlKC0xMC40NjUyODUsIC03LjUwMDAwMCkgIj48L3BhdGg+CiAgICAgICAgPHBhdGggZD0iTTE3LjE0NjM2MzYsMTEuMTQ2MzYzNSBDMTcuMDUyNTc5MSwxMS4yNDAxNDggMTYuOTk5OTI0OSwxMS4zNjczNjg2IDE3LDExLjQ5OTk5OSBMMTcsMTUuOTk5OTk5IEw0LDE1Ljk5OTk5OSBMNCwxMS40OTk5OTkgQzQsMTEuMjIzODU3NSAzLjc3NjE0MjQ2LDEwLjk5OTk5OSAzLjUsMTAuOTk5OTk5IEMzLjIyMzg1NzcxLDEwLjk5OTk5OSAzLDExLjIyMzg1NzUgMywxMS40OTk5OTkgTDMsMTYuNDk5OTk5IEMzLDE2LjYzMjYzMTIgMy4wNTI1NzkxMiwxNi43NTk4NTE5IDMuMTQ2MzYzNjIsMTYuODUzNjM2NCBDMy4yNDAxNDgxMiwxNi45NDc0MjA5IDMuMzY3MzY4NzksMTcuMDAwMDc1MSAzLjUsMTYuOTk5OTk5IEwxNy41LDE2Ljk5OTk5OSBDMTcuNjMyNjMxNCwxNy4wMDAwNzUxIDE3Ljc1OTg1MiwxNi45NDc0MjA5IDE3Ljg1MzYzNjUsMTYuODUzNjM2NCBDMTcuOTQ3NDIxLDE2Ljc1OTg1MTkgMTgsMTYuNjMyNjMxMiAxOCwxNi40OTk5OTkgTDE4LDExLjQ5OTk5OSBDMTgsMTEuMzY3MzY4NiAxNy45NDc0MjEsMTEuMjQwMTQ4IDE3Ljg1MzYzNjUsMTEuMTQ2MzYzNSBDMTcuNzU5ODUyLDExLjA1MjU3OSAxNy42MzI2MzE0LDEwLjk5OTkyNDcgMTcuNSwxMC45OTk5OTkgQzE3LjM2NzM2ODgsMTAuOTk5OTI0NyAxNy4yNDAxNDgxLDExLjA1MjU3OSAxNy4xNDYzNjM2LDExLjE0NjM2MzUgWiIgaWQ9Iui3r+W+hCIgZmlsbD0iI0ZGRkZGRiIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==",clear:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjBweCIgaGVpZ2h0PSIyMHB4IiB2aWV3Qm94PSIwIDAgMjAgMjAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+Y2xlYXIgdXBsb2FkZWQgZmlsZTwvdGl0bGU+CiAgICA8ZyBpZD0iY2xlYXItdXBsb2FkZWQtZmlsZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTE2LjgyNTEzNjUsNC4wMTU0OCBDMTcuMDU4Mjg3OCwzLjc4MzE4NTQgMTcuMDU4Mjg3OCwzLjQwNjUxODQzIDE2LjgyNTEzNjUsMy4xNzQyMjA5NSBDMTYuNTkzMzMyLDIuOTQxOTI2MzUgMTYuMjE3MTU1MSwyLjk0MTkyNjM1IDE1Ljk4NDQ5NDUsMy4xNzQyMjA5NSBMMTAuMDAwMjM0OCw5LjE1ODcyNDYyIEw0LjAxNTQ4LDMuMTc0MjIwOTUgQzMuNzgzMTg1NCwyLjk0MTkyNjM1IDMuNDA2NTE4NDMsMi45NDE5MjYzNSAzLjE3NDIyMDk1LDMuMTc0MjIwOTUgQzIuOTQxOTI2MzUsMy40MDY1MTU1NiAyLjk0MTkyNjM1LDMuNzgzMTgyNTMgMy4xNzQyMjA5NSw0LjAxNTQ4IEw5LjE1ODg1Mzc4LDEwLjAwMDExMjggTDMuMTc0MjIwOTUsMTUuOTg1MTExNiBDMi45NDE5MjYzNSwxNi4yMTc1MjgyIDIuOTQxOTI2MzUsMTYuNTkzNDYwNCAzLjE3NDIyMDk1LDE2LjgyNTg3NTYgQzMuNDA2NTE1NTYsMTcuMDU4MjkyMiAzLjc4MzE4MjUzLDE3LjA1ODI5MjIgNC4wMTU0OCwxNi44MjU4NzU2IEwxMC4wMDAyMzQ4LDEwLjg0MTM3MTkgTDE1Ljk4NDQ5NDUsMTYuODI1ODc1NiBDMTYuMjE3MTU2NSwxNy4wNTgyOTIyIDE2LjU5MzQ1NjEsMTcuMDU4MjkyMiAxNi44MjUxMzY1LDE2LjgyNTg3NTYgQzE3LjA1ODI4NzgsMTYuNTkzODI2MyAxNy4wNTgyODc4LDE2LjIxNzUyNjcgMTYuODI1MTM2NSwxNS45ODUxMTE2IEwxMC44NDEzNjQ3LDEwLjAwMDExMjggTDE2LjgyNTEzNjUsNC4wMTU0OCBaIiBpZD0i6Lev5b6EIiBmaWxsPSIjRkZGRkZGIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+"},N.IMAGE_FILE_EXTENSIONS=["jpg","jpeg","png","gif","bmp","svg","ico","webp"],N.MIMETYPE_TO_FILE_EXTENSION_MAP={"image/jpeg":N.IMAGE_FILE_EXTENSIONS[1],"image/jpg":N.IMAGE_FILE_EXTENSIONS[0],"image/png":N.IMAGE_FILE_EXTENSIONS[2],"image/gif":N.IMAGE_FILE_EXTENSIONS[3],"image/bmp":N.IMAGE_FILE_EXTENSIONS[4],"image/svg+xml":N.IMAGE_FILE_EXTENSIONS[5],"image/x-icon":N.IMAGE_FILE_EXTENSIONS[6],"image/webp":N.IMAGE_FILE_EXTENSIONS[7]},N.defaultFileUploadProps={marginTop:2,marginRight:2,marginBottom:2,marginLeft:2,maxSize:2048,accept:"",isPreviewEnabled:!0,isDownloadEnabled:!0,isClearEnabled:!0,valuePath:"dataUrl"},N.E9e=s=function(t){return t&&"string"==typeof t.name&&(t.blob&&t.blob instanceof Blob||t.dataUrl&&"string"==typeof t.dataUrl)},f=function(t){var i,i,n,n={name:""};return"string"==typeof t?n.dataUrl=t:t instanceof Blob?(n.blob=t,n.name=null!=(i=t.name)?i:""):t instanceof Object&&(n=t)&&t.hasOwnProperty("blob")&&t.blob instanceof Blob&&!t.hasOwnProperty("name")&&(t.name=null!=(i=t.blob.name)?i:""),(0,N.E9e)(n)?n:void 0},N.Hne=o=function(t){var i=crypto&&crypto.randomUUID&&crypto.randomUUID();return n.Common.lt.ht(i)&&(i="10000000-1000-4000-8000-100000000000".replace(/[018]/g,function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})),i=32===t?i.split("-").join(""):i},N.x9e=c=function(t,r,u,a){var l,M,g,h,I,t,i,n,e,s,t,o,c,c,l=t.row,M=t.col,g=t.value,h=t.oldValue,I=t.valuePath,t=t.fileGUID,i=r.VTe(),n=r.Ut.getFileGUID(l,M),e=i.Wxn(n);e&&i.FAe([n]),(s=f(g))?(t=null!=t?t:(0,N.Hne)(),o=function(t){var i,i,n,e,s,o,c,i,n,i,n,n=t.name,e=t.dataUrl;a&&(t[s=null===(s=I)?"cellValue":I]=g),o=!1,c=r.BO(),-1<t.type.indexOf("image")?(c.getImage(e)&&(o=!0),c.addImage(e,"anonymous")):(o=!0,i=null==(i=null==(i=r.getParent())?void 0:i.options)?void 0:i.builtInFileIcons,n=n.split(".").pop(),(i=null==i?void 0:i[n])&&(c.getImage(i)||(o=!1),c.addImage(i,"anonymous"))),u&&(n={name:t.name,blob:t.blob,dataUrl:e},r.getParent().commandManager().execute({cmd:"uploadFile",sheetName:r.name(),row:l,col:M,newValue:n,oldValue:h,fileGUID:t.id,oldFileWrapper:null,newFileWrapper:t,valuePath:I})),o&&c.Zh()},s.blob&&s.dataUrl?(c=i.EAe(s.name,s.blob,s.dataUrl,t),u||r.Ut.setFileGUID(l,M,t),o(c)):(c=i.oZn({id:t,name:s.name,dataUrl:s.dataUrl,blob:s.blob,postCreateFile:function(t){a&&(t.cellValue=g)}}))&&(u||r.Ut.setFileGUID(l,M,t),c.then(function(t){o(t)}))):u?r.getParent().commandManager().execute({cmd:"uploadFile",sheetName:r.name(),row:l,col:M,newValue:void 0,oldValue:h,fileGUID:n,oldFileWrapper:e,newFileWrapper:null,valuePath:I}):r.Ut.setFileGUID(l,M,void 0)},N.getValueByValuePath=r,N.isFileInfoEqual=u},"./dist/plugins/celltype/hyperlinkcelltype.js":function(U,t,i){"use strict";var n,e,j,i,f,i,s,v,o,r,T,b,c,u,a,A,D,y,l,M,g,h,I,z,N,d,w,C,Z,G,m,B,Q,p,Y,L,x,S,e,O;function P(t,i){t.removeChild(i)}function k(){var t,n,t=O.call(this)||this;return t.typeName="8",t.W7e=!1,t.allowOverflow=!1,(n=t)._id=t.MY(),u(L,function(t,i){n["_"+t]=i}),t._onAction=function(t){var i,t,n,e,s,i,t,n,s,n=t&&t.sheet,e=n&&n.getParent(),s=t.row,i=t.col,t=t.sheetArea,n=n.getValue(s,i,t),s=R(this._target);n&&(e&&null!=(t=null==(i=e.docProps)?void 0:i.appDocProps)&&t.hyperlinkBase&&(n=q(e.docProps.appDocProps.hyperlinkBase,n)),l(o(n),s))},t}function R(t){return["_blank","_self","_parent","_top"][t]}function W(t,i,n,e,s,o){var c,r,u,t,c=0,r=0,u=t.width,t=t.height;return c=o=o||0,1===e?c=(u-i)/2:2===e?c=u-i-o:5===e&&(c=(u-i)/2),1===s?r=(t-n)/2:2===s&&(r=t-n),{x:c,y:r}}function H(t,i,n,e){var t,n,t=X(t,n,i),n=t.width;return n+=!0==(1!==i.hAlign&&!v(e))?e:0,t.width=n,t}function V(t,i,n,e,s){var t,n,t=X(t,n,i,e.width),n=W(e,t.width,t.height,i.hAlign,i.vAlign,s);return t.x=n.x,t.y=n.y,t}function J(t,i){var n,t,n=E(i),t=t-3-n;return 5===i.hAlign&&(t-=n),--t}function F(t,i,n,e){var i,n,i=J(i,n),n=j.q.Gge(t);return 1===n.length&&0===n[0].prefixSpaceCount?A(0,j.q.Wt(n[0].word,e,!0)):i}function X(t,i,n,e){var s,o,c,s=r(i),o,c;return{x:0,y:0,width:5===n.hAlign&&e?F(t,e,n,i):Math.max(0,j.q.Wt(t,i,!0)),height:t.split(/\r\n|\r|\n/).length*s}}function _(t,i,n,e,s,o){var c,r,s,u,a,l,s,c,M,g,h,I,N,f,c=s.sheet,r=c.Dn;if(!v(n)&&(o=o||(s=c.getValue(s.row,s.col,s.sheetArea),v(s))?o:s+""))for(e=n.cellType.An(e,n,c.zoom()),o=o.replace(/\s+/g," "),u=n&&n.font?n.font:r.Nn(),u=r._n(u),a=[o],l=E(n),!n.wordWrap&&5!==n.hAlign||(s=e.width-3-l,5===n.hAlign&&(s-=l),o=(a=j.q.un(o,s,u)).join("\r\n")),c=V(o,n,u,e,l),M=e.y+c.y,g=0;g<a.length;g++)if(h=V(a[g],n,u,e,l),I=e.x+h.x,N=D(I+h.width,e.x+e.width),M=D((f=M)+h.height,e.y+e.height),I<=t&&t<N&&f<=i&&i<M)return!0;return!1}function E(t){return 8*(t.textIndent||0)}function K(t,i,n,e,s){var o,e,c,c,r,n,c,u,a,l,M,g,h,I,N,c,o=e&&e.sheet;if(o){if(c=o.Dn,r=i.font||c.Nn(),1<n&&(r=c._n(r)),n=E(i),i.wordWrap||s){if(i.wordWrap){if(c=e.row,u=e.col,a=e.sheetArea,l=0,M=o.Ut.findSpan(c,u,a)){if(M.row>=c&&M.rowCount<=1&&M.col>=u&&u===M.col&&(l=o.nn(u,a),1<M.colCount))for(g=u+1;g<u+M.colCount;g++)l+=o.nn(g,a)}else l=o.nn(u,a);if(e=f(i,1),0<(c=f(i,3))&&(l-=c),0<e&&(l-=e),h=j.q.un(t,l-3-n,r),s&&1<t.split(/\r\n|\r|\n/).length){for(N=I=0;N<h.length;N++)I=Math.max(I,H(h[N],i,r,E(i)).width);return I}s||(t=h.join("\r\n"))}}else t=t.replace(/\s+/g," ");return c=H(t,i,r,E(i)),s?c.width:c.height}return 0}function q(t,i){var t,n,i,t=t.replace(/:\/*/,"://"),n=(t=t.endsWith("://")?t:t.replace(/\/+$/,"")).endsWith("/")?"":"/",i=i.replace(/^\/+/,"");return"".concat(t).concat(n).concat(i)}n=this&&this.__extends||(S=function(t,i){return(S=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}S(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.HyperLink=t.HyperLinkTargetType=void 0,e=i("Common"),i=(j=i("Core")).CellTypes.Context,f=i.gn,i=j.CellTypes.Text,s=j.mt.En,v=e.Common.lt.ht,o=e.Common.zf.TY,r=j.mt.vt,T=j.mt.Tt,b=T.mozilla,c=j.GC$,u=c.each,a=null,A=Math.max,D=Math.min,y=Math.floor,l=window.open,M="position",g="absolute",h="margin",I="font",z="left",N="top",d="padding",w="border",C="box-sizing",Z="background-color",G="content-box",m="default",B="white",Q="div",p="hyperlinkInfo",(e=Y=t.HyperLinkTargetType||(t.HyperLinkTargetType={}))[e.blank=0]="blank",e[e.self=1]="self",e[e.parent=2]="parent",e[e.top=3]="top",L={linkColor:"#0066cc",visitedLinkColor:"#3399ff",text:"",linkToolTip:"",target:0,activeOnClick:!0},n(k,O=i),k.prototype.MY=function(){var t,i;return v(this._id)&&(this._id="0"),i="id_"+(t=parseInt(this._id,10)),this._id=++t+"",i},k.prototype.AY=function(t,i,n,e,s,o,c,r,u,a){var l,M,g,h,l,I,N,g,f,D,d,r,v,o,w,j,A,M=1,g=z,h=c.hAlign,l=c.vAlign,I=r.lineHeight,N=u.length;if(M+=i,1===h?(M=s/2,g="center"):2===h&&(M=s-1,M-=i,g="right"),t.textAlign!==g&&(t.textAlign=g),g=1,f="alphabetic",g+=I-(r=I/2-(D=parseInt(r.fontInfo.fontSize,10))/2+(d=8<D?y((D-8)/5+2):1)-1),1===l?I<o&&(g=b?(o-a)/2+1:T.msie?(o-a)/2+.5:(o-a)/2,y(g)!==g&&(g+=.5),g+=I/2-r):2===l&&(g=o-a-2.5-r),t.textBaseline!==f&&(t.textBaseline=f),v=e+g,5===h)c.textDecoration=null!=(l=c.textDecoration)?l:1,o=s-3-2*i,O.prototype.Pge.call(this,t,u,n,v,--o,s/2,1+i,I,c,D,d);else for(w=0;w<N;w++)t.fillText(u[w],n+M,v),j=t.measureText(u[w]).width,(A=c.textDecoration)&&this.le(t,A,n+M,v,j,D,d),v+=I},k.prototype.IY=function(t,i,n,e,s,o,c,r,u){var a,l,M,g,h,I,g,N,f,D,d,v,c,r,w,a=c.hAlign,l=c.vAlign,M=r.lineHeight,h=u.length,N=0,f=0,d=0,v=0;for(2!==a&&(d=1),2===c.vAlign&&(v=-2.5),v-=A(0,Math.round(M/9)-1),t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),c=r.fontInfo.fontSize,r=y((c-12)/21+1),t.lineWidth=r,t.beginPath(),w=0;w<h;w++)g=t.measureText(u[w]).width,g=(I=d+n+(D=W(new j.Rect(n,e,s,o),g,M*h,a,l,i)).x)+g,N=v+e+D.y+M,y(N)===N&&(N+=.5),f=N,t.moveTo(I,N),t.lineTo(g,f),t.stroke(),v+=M},k.prototype.paintValue=function(t,i,n,e,s,o,c,r){var u,i,a,l,M,g,h,I,N,f,f,g,h,D,I,N,M,f,d,u=this;if(t&&(i=u.getText(i,r),!v(i))){for(a=(i+="").split(/\r\n|\r|\n/),l=0;l<a.length;)a[l]=a[l].replace(/\s+/g," "),l++;i=a.join("\r\n"),M=!1,g=r.sheet.Ut,h=r.row,I=r.col,N=r.sheetArea,(f=u.W7e?u.J7e(r.sheet,h,I,N):g.getValueForKey(h,I,p,N))&&(u._id===f.id?M=f.visited:g.do("setValueForKey",h,I,p,void 0,N)),t.save(),t.beginPath(),(f=M?u._visitedLinkColor:u._linkColor)&&t.fillStyle!==f&&(t.fillStyle=f),(g=c.font)&&t.font!==g&&j.mt.bt(t,g),h=E(c),r.sheet.outlineColumn&&r.sheet.outlineColumn.Un(r.col)&&(h=0),I=[],M=N=0,(D=c.wordWrap)||5===c.hAlign?(f=s-3-h,5===c.hAlign&&(f-=h),1<(N=(I=j.q.un(i,--f,g)).length)&&0!==c.vAlign&&(M=(N-1)*(d=r.lineHeight))):I.push(i),t.rect(n,e,s,o),t.clip(),t.beginPath(),u.AY(t,h,n,e,s,o,c,r,I,M),5!==c.hAlign&&u.IY(t,h,n,e,s,o,c,r,I),t.restore()}},k.prototype.Rn=function(t,i,n,e){this.yZe&&(v(i.textDecoration)?i.textDecoration=1:2!==i.textDecoration&&4!==i.textDecoration||(i.textDecoration+=1),O.prototype.Rn.call(this,t,i,n,e))},k.prototype.getText=function(t,i){var n=this._text||t;return n=(v(n)||""===n)&&i.sheet&&i.sheet.getActualText?i.sheet.getActualText(t,i):n},k.prototype.j3=function(t,i,n,e){var s;t.Ai||(s=t.parent)&&s.j3(t,i,n,e)},k.prototype.getHitInfo=function(t,i,n,e,s){var o,c,o=this;return s&&(c=s.sheetArea,v(c)&&(c=3),n)&&e?{x:t,y:i,row:s.row,col:s.col,cellStyle:n,cellRect:e,sheetArea:c,isFocusAware:!0,sheet:s.sheet,isReservedLocation:_(t,i,n,e,s,o._text)}:a},k.prototype.processMouseDown=function(t){var i=t&&t.sheet,n=this;i&&!i.isEditing()&&t.isReservedLocation&&(n.xY=!0)},k.prototype.processMouseUp=function(t){var i,i,i=t&&t.sheet;i&&!i.isEditing()&&(i=this,t.isReservedLocation&&i.xY&&i.NY(t),i.xY=!1)},k.prototype.processMouseMove=function(t){var i,n,e,s,i,i=t.row,n=t.col,e=t.sheet,s=this;!e||e.isEditing()&&e.getActiveRowIndex()===i&&e.getActiveColumnIndex()===n||(i=e.Dg(),t.isReservedLocation?i&&(s.kY(e,t),i.style.cursor="pointer"):(s.DY(e),i&&(i.style.cursor=m)))},k.prototype.processMouseLeave=function(t){var t,i,i,t=t.sheet,i=this;i.xY=!1,i.DY(t),t&&(i=t.Dg())&&(i.style.cursor=m)},k.prototype.kY=function(t,i){var n,e,s,n,o,n,i,n=this;n._linkToolTip&&((e=n._Y()).className="gc-spread-hyperlink-celltype-tooltip",(s=c(e)).text(n._linkToolTip),o=(n=t.rt.it()).left+i.x,n=n.top+i.y+20,0===s.parent().length)&&((i=t&&t.qc())&&i.insertBefore(e,a),s.css(N,n).css(z,o))},k.prototype.DY=function(t){var i,t,i=this;i.EY&&((t=t&&t.qc())&&i.EY.parentElement===t&&P(t,i.EY),i.EY=a)},k.prototype._Y=function(){var t,i,t=this;return t.EY||(i=s(Q),c(i).css(M,g).css(h,0).css(d,2).css(w,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(C,G).css(Z,B).css(I,"9pt Arial"),t.EY=i),t.EY},k.prototype.isReservedKey=function(t,i){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},k.prototype.processKeyUp=function(t,i){var n,e;return!!i.sheet&&(this.NY(i),!0)},k.prototype.getAutoFitWidth=function(t,i,n,e,s){return K(this._text||t,n,e,s,!0)},k.prototype.getAutoFitHeight=function(t,i,n,e,s){return K(this._text||t,n,e,s)},k.prototype.isImeAware=function(t){return!!this.yZe&&O.prototype.isImeAware.call(this,t)},k.prototype.NY=function(t){var i,n,e,s,o,c,i=t&&t.sheet,n=this,e=t.row,s=t.col,o=t.sheetArea,c;n.onClickAction().call(this,t),this.W7e?n.K7e(i,e,s,o):i.Ut.do("setValueForKey",e,s,p,{id:n._id,visited:!0},o),i.repaint(i.getCellRect(e,s,1===o?-1:a,2===o?-1:a)),n.j3(i,e,s,o)},k.prototype.J7e=function(t,i,n,e){return a},k.prototype.K7e=function(t,i,n,e){},k.prototype.onClickAction=function(t){return 0===arguments.length?this._onAction:(t&&(this._onAction=t),this)},k.prototype.Je=function(t){var t={linkColor:t.linkColor,visitedLinkColor:t.visitedLinkColor,text:t.text,linkToolTip:t.linkToolTip,target:t.target&&Y[t.target],activeOnClick:t.activeOnClick};this.fromJSON(t)},k.prototype.toJSON=function(){var n,e,s,n=this,e={typeName:n.typeName};return u(L,function(t,i){(s=n["_"+t])!==i&&(e[t]=s)}),e},k.prototype.fromJSON=function(n){var e=this;u(L,function(t){var i=n[t];v(i)||(e["_"+t]=i)})},k.prototype.jn=function(t){if(this.yZe)return O.prototype.jn.call(this,t)},k.prototype.Ke=function(){var n,e,s,n=this,s=new k;return u(L,function(t,i){(e=n["_"+t])!==i&&(s["_"+t]=e)}),s._onAction=n._onAction,s},x=k,t.HyperLink=x,u(L,function(i){x.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:(this["_"+i]=t,this)}}),j.CellTypes.ti[8]=x},"./dist/plugins/celltype/radiochecklistcelltype.js":function(j,t,i){"use strict";var n,Q,i,A,T,Y,P,a,it,M,l,g,h,nt,i,e,c,R,W,v,b,o,H,V,J,r,s,e,i,y,u,I,z,e,e,C,m,p,N,f;function F(t,i){return t.hasOwnProperty(i)}function D(t,i){return t instanceof Date&&i instanceof Date?T(t)===T(i):!h(t)&&!h(i)&&t.toString&&i.toString?t.toString()===i.toString():t===i}function L(t){var i,t,n,e,s,i=["0","0","0","0"];return typeof t===b&&(s=e=void 0,1===(n=(t=t.split(" ",4)).length)?i=[e=t[0],e,e,e]:2===n?i=[e=t[0],s=t[1],e,s]:3===n?(s=t[1],i=[t[0],s,t[2],s]):4===n&&(i=[t[0],t[1],t[2],t[3]])),i}function d(){var t,n,t=C.call(this)||this;return t.typeName="11",t.defaultPadding=5,n=t,c(r,function(t,i){n["_"+t]=i="items"===t?[]:i}),t}function x(){return null!==m&&m.apply(this,arguments)||this}function S(){var t=null!==p&&p.apply(this,arguments)||this;return t.typeName="12",t}function w(){var t,n,t=f.call(this)||this;return t.typeName="13",t.defaultPadding=0,n=t,c(u,function(t,i){n["_"+t]=i="items"===t?[]:i}),n._boxSize=0,delete n.boxSize,t}function O(t,i,n,e,s,o){var c,c,s,c=i.getValue(n,e,o),c=t.wG(c,s),s={cmd:"editCell",sheetName:i.name(),row:n,col:e,newValue:c,autoFormat:!1};i.Qy().execute(s),t.triggerButtonClicked(i,n,e,o)}function X(t,i,n,e,s){var i,o,n,c,r,i=i.zoom(),o=K(t._boxSize,n.font,i),n=st(t,n),c,r=e;return P(n,o)*(r=t._items.length<e?t._items.length:r)+t._itemSpacing.vertical*i*(r-1)}function _(t,i,n,e,s){var o,c,r,i,u,o=i.zoom(),c=K(t._boxSize,n.font,o),r=t.defaultPadding*o,i=et(t,i,n,e,s),u=0;return i.forEach(function(t){u+=t}),u+=s*(c+r)+(s-1)*t._itemSpacing.horizontal*o}function et(t,i,n,e,s){for(var o,c,r,r,u,u,o=[],c=0;c<t._items.length;c++)r=F(t._items[c],W)?t._items[c].text:t._items[c],r=i.Qt(r,n.font),(u=t.jY()).hasMargin&&(r=r+u.paddingLeft+u.paddingRight),u=Y(c%s),o[u=t._direction===V.vertical?Y(c/e):u]=o[u]===g?r:Math.max(o[u],r);return o}function K(t,i,n){var e=H*n;return"number"==typeof t&&0<=t?e=t*n:"auto"===t&&(e=R(i)/2),e}function st(t,i){var i,t,i=R(i.font),t=t.jY();return i=t.hasMargin?i+t.paddingTop+t.paddingBottom:i}function q(t,i,n,e){var n,s,n=k(t)*n,s=n;return 1===t.hAlign?s=(i.width-e)/2:2===t.hAlign&&(s=i.width-n-e),s}function $(t,i,n,e){var n,s,n=2*n,s=n;return 1===t.vAlign?i.height-n>e&&(s=(i.height-e-n)/2+n):2===t.vAlign&&(s=i.height-e-n),s}function tt(t,i,n,e,s){var o,c,r,u;if(t._direction===V.vertical){if(t._isFlowLayout){if(s!==g)for(o=t._items.length;0<o;){if(!(s<(c=X(t,i,n,o,a(t._items.length/o)))))return[o=P(o,1),a(t._items.length/o)];o-=1}return[t._items.length,1]}return[o=P(1,t._maxRowCount),a(t._items.length/o)]}if(t._isFlowLayout){if(e!==g)for(r=t._items.length;0<r;){if(!(e<(u=_(t,i,n,a(t._items.length/r),r))))return r=P(r,1),[a(t._items.length/r),r];r-=1}return[1,t._items.length]}return r=P(1,t._maxColumnCount),[a(t._items.length/r),r]}function k(t){var i=t.textIndent;return 1===t.hAlign||0===i||i===l||i===g?2:8*i}function E(r,u){for(var t,i,a,l,n,n,t,M,g,h,I,N,f,i,t,D,d,e,s,o,t=u.cellRect.width,i=u.cellRect.height,a=u.sheet,l=a.zoom(),n=a.Z_(u.row,u.col),n=n&&n.font,t=tt(r,a,u.cellStyle,t-1,i),M=t[0],g=t[1],h=et(r,a,u.cellStyle,M,g),I=K(r._boxSize,n,l),N=r.defaultPadding*l,f=P(st(r,u.cellStyle),I),i=_(r,a,u.cellStyle,M,g),t=X(r,a,u.cellStyle,M,g),D=q(u.cellStyle,u.cellRect,l,i),d=$(u.cellStyle,u.cellRect,l,t),e=function(t){var i,i,n,e,s,o,c,n,n,i,i=F(r._items[t],W)?r._items[t].text:r._items[t],i=a.Qt(i,u.cellStyle.font),n=Y(t/g),e=t%g;if(r._direction===V.vertical&&(n=t%M,e=Y(t/M)),s=new Q.Rect,o=0,(c=h.filter(function(t,i){return i<e})).forEach(function(t){o+=t}),s.x=D+o+e*(I+N+r._itemSpacing.horizontal*l),s.y=d+n*f+r._itemSpacing.vertical*l*n,n=r.jY(),s.width=(r._textAlign!==J.right||n.hasMargin?h[e]:i)+I+N,s.height=f,n=u.x-u.cellRect.x,i=u.y-u.cellRect.y,s&&s.contains(n,i))return{value:{value:F(r._items[t],v)?r._items[t].value:r._items[t]}}},s=0;s<r._items.length;s++)if("object"==typeof(o=e(s)))return o.value}function U(t,i){var n,e,s,n=!1,e=F(t,v)?t.value:t;if(i!==l)if(Array.isArray(i)){for(s=0;s<i.length;s++)if(D(i[s],e)){n=!0;break}}else n=D(i,e);return n}function Z(t,i,n,e){var s,o,c,r,u;if(e)return i;for(t===l&&(t=[]),Array.isArray(t)||(t=[t]),s={},n.forEach(function(t){s[F(t,v)?t.value:t]=!0}),o=t.length-1;0<=o;o--)s[t[o]]||t.splice(o,1);if(-1===(r=(c=t.slice()).indexOf(i)))c.push(i);else for(o=c.length-1;0<=o;o--)D(c[o],i)&&c.splice(o,1);return u=[],n.forEach(function(t){-1!==c.indexOf(t.value)&&u.push(t.value)}),u}n=this&&this.__extends||(z=function(t,i){return(z=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}z(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonList=t.CheckBoxList=t.RadioButtonList=t.SelectionMode=t.TextAlign=t.Direction=void 0,Q=i("Core"),i=i("Common"),A=i.Common.lt.tv,T=i.Common.ct.o0,Y=Math.floor,P=Math.max,a=Math.ceil,it="left",M="alphabetic",l=null,g=void 0,h=i.Common.lt.ht,nt=Q.mt.bt,i=Q.CellTypes.Base,e=Q.GC$,c=e.each,R=Q.mt.vt,W="text",v="value",b="string",o="number",H=12,(e=V=t.Direction||(t.Direction={}))[e.horizontal=0]="horizontal",e[e.vertical=1]="vertical",(e=J=t.TextAlign||(t.TextAlign={}))[e.left=2]="left",e[e.right=3]="right",r={items:l,direction:V.horizontal,maxColumnCount:1,maxRowCount:1,isFlowLayout:!0,itemSpacing:{horizontal:20,vertical:5},textAlign:J.right,boxSize:H},n(d,C=i),d.prototype.paintValue=function(t,i,n,e,s,o,c,r){var u,a,U,l,M,g,h,I,N,f,D,d,g,v,w,j,A,T,b,y,z,h,C,m,Z,p,L,x,S,O,k,E,E,G,B,u=this;if(t){for(t.save(),t.rect(n+1,e+1,s-2,o-2),t.clip(),t.beginPath(),U=a=0,M=(l=r.sheet).zoom(),g=c.font,h=r.isPrinting,I=r.printZoomFactor,N=K(u._boxSize,g,M=h&&"number"==typeof I&&1!==I?I:M),f=u.defaultPadding*M,D=N/2,d=new Q.Rect(n+1,e+1,s-2,o-2),j=_(u,l,c,v=(g=tt(u,l,c,s-2,o-2))[0],w=g[1]),A=X(u,l,c,v,w),T=et(u,l,c,v,w),b=st(u,c),y=n+q(c,d,M,j),z=e+$(c,d,M,A),(h=c.font)&&t.font!==h&&nt(t,r.fontInfo.font),c.foreColor&&(t.fillStyle=c.foreColor),C=c.textDecoration,Z=8<(m=r.fontInfo.fontSize)?Y((m-8)/5+2):1,p=0,p=(U=R(c.font))/2-m/2+Z-1,L=y,x=z,O=S=0,N<m&&(S=u.OY(N),O=(b-p-H)/2+1),k=0;k<u._items.length;k++)n+s<y||e+o<z||(E=F(u._items[k],W)?u._items[k].text:u._items[k],a=l.Qt(E,c.font),t.textAlign=it,E=u._direction===V.vertical?T[Y(k/v)]:T[k%w],G=0,G=u._textAlign===J.left?(u.RY(t,u._items[k],i,a,y,z+S,E,b,p),y=y+E+f,t.save(),u.BY(t,i,u._items[k],y,z+O,D),t.restore(),N):(t.save(),u.BY(t,i,u._items[k],y,z+O,D),y=y+N+f,t.restore(),u.RY(t,u._items[k],i,a,y,z+S,E,b,p),E),C&&(B=this.jY(),u.le(t,C,y-(u._textAlign===J.right?0:E+f)+B.paddingLeft,z+b-p-B.paddingBottom,a,m,Z)),u._direction===V.vertical?(z+=P(b,N)+u._itemSpacing.vertical*M,(k+1)%v==0&&(L=L+E+N+f+u._itemSpacing.horizontal*M,z=e+$(c,d,M,A)),y=L):(y=y+G+u._itemSpacing.horizontal*M,(k+1)%w==0&&(y=n+q(c,d,M,j),x=x+P(b,N)+u._itemSpacing.vertical*M),z=x));t.restore()}},d.prototype.OY=function(t){return(t-H)/2},d.prototype.getText=function(t,i){return t},d.prototype.RY=function(t,i,n,e,s,o,c,r,u){var i=F(i,W)?i.text:i;t.textBaseline!==M&&(t.textBaseline=M),t.fillText(i,s,o+r-u)},d.prototype.getItemsBound=function(r,t,i,n){var u,a,l,e,s,o,c,M,t,i,n,g,h,I,N,f,D,t,i,d,v,w,j,A,u=this,a=r.zoom(),l=r.getActualStyle(t,i,n),e,s=Q.W.V("11pt "+r.currentTheme().bodyFont(),a);for(l.font&&(s=Q.W.Lge(l,a)),l.font=s.font,t=(M=r.getCellRect(t,i,o=1===n?-1:void 0,c=2===n?-1:void 0)).width,i=M.height,n=tt(u,r,l,t-1,i),g=n[0],h=n[1],I=et(u,r,l,g,h),N=K(u._boxSize,s.font,a),f=u.defaultPadding*a,D=P(st(u,l),N),t=_(u,r,l,g,h),i=X(u,r,l,g,h),d=q(l,M,a,t),v=$(l,M,a,i),w=[],j=function(t){var i,i,n,e,s,o,c,n,i=F(u._items[t],W)?u._items[t].text:u._items[t],i=r.Qt(i,l.font),n=Y(t/h),e=t%h;u._direction===V.vertical&&(n=t%g,e=Y(t/g)),s=new Q.Rect,o=0,(c=I.filter(function(t,i){return i<e})).forEach(function(t){o+=t}),s.x=d+o+e*(N+f+u._itemSpacing.horizontal*a)+M.x,s.y=v+n*D+u._itemSpacing.vertical*a*n+M.y,n=u.jY(),s.width=(u._textAlign!==J.right||n.hasMargin?I[e]:i)+N+f,s.height=D,s.x>M.x+M.width||s.y>M.y+M.height?w[t]=null:w[t]=s},A=0;A<u._items.length;A++)j(A);return w},d.prototype.BY=function(t,i,n,e,s,o){},d.prototype.jY=function(){return{hasMargin:!1,paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}},d.prototype.getAutoFitWidth=function(t,i,n,e,s){var s,o,c,r,u,s=s&&s.sheet,o=k(n),c=tt(this,s,n),r,u;return(_(this,s,n,c[0],c[1])+o)/e},d.prototype.getAutoFitHeight=function(t,i,n,e,s){var o,s,c,r,o=s&&s.sheet,s=tt(this,o,n,+o.getColumnWidth(s.col)*e),c,r;return X(this,o,n,s[0],s[1])/e},d.prototype.getHitInfo=function(t,i,n,e,s){var o,c,r,t,i,s,c,s,u,o,r,c,a,o=this;return s&&(c=s.sheetArea,r=s.sheet,e=n.cellType.An(e,n,r.zoom()),h(c)||3===c)&&e?(t={x:t,y:i,row:s.row,col:s.col,cellStyle:n,cellRect:e,sheetArea:c,sheet:r},i=r.zoom(),n.font&&(n.font=Q.W.Lge(n,i).font),u=_(o,r,n,c=(s=tt(o,r,n,e.width-1,e.height-2))[0],s=s[1]),o=X(o,r,n,c,s),r=e.x+q(n,e,i,u),c=e.y+$(n,e,i,o),(a=new Q.Rect(r,c,u,o)).contains(t.x,t.y)&&(t.isReservedLocation=!0),t):l},d.prototype.processMouseDown=function(t){if(!t)return!1;t.isReservedLocation&&(this.pG=!0)},d.prototype.processMouseLeave=function(t){if(C.prototype.processMouseLeave.call(this,t),!t)return!1;this.pG=!1},d.prototype.processMouseUp=function(t){var i,n,e,s,o,c;return!!t&&(n=t.sheet,!!((i=this).pG&&n&&t.isReservedLocation&&(i.pG=!1,e=t.row,s=t.col,o=t.sheetArea,c=E(i,t))))&&(O(i,n,e,s,c.value,o),!0)},d.prototype.wG=function(t,i){return Z(t,i,this._items,!0)},d.prototype.triggerButtonClicked=function(t,i,n,e){var s=t.parent;s&&s.j3(t,i,n,e)},d.prototype.Je=function(t){var t={items:t.items,direction:t.direction&&V[t.direction],maxColumnCount:t.maxColumnCount,maxRowCount:t.maxRowCount,isFlowLayout:t.isFlowLayout,itemSpacing:t.itemSpacing,textAlign:t.textAlign&&J[t.textAlign],boxSize:t.boxSize};this.fromJSON(t)},d.prototype.toJSON=function(){var e,s,o,e=this,s={typeName:e.typeName};return c(r,function(t,i){var n;o=e["_"+t],("items"===t?o&&0<o.length:o!==i)&&(s[t]="object"==typeof o?A(o,!1):o)}),s},d.prototype.fromJSON=function(n){var e=this;c(r,function(t){var i=n[t];h(i)||(e["_"+t]=i)})},n(x,m=s=d),x.prototype.BY=function(t,i,n,e,s,o){var n=F(n,v)?n.value:n;t.beginPath(),t.fillStyle="white",t.arc(e+o,s+o,o,0,2*Math.PI),t.fill(),t.beginPath(),t.strokeStyle="black",t.arc(e+o,s+o,o,0,2*Math.PI),t.stroke(),i!==l&&D(i,n)&&(t.beginPath(),t.strokeStyle="black",t.arc(e+o,s+o,.5*o,0,2*Math.PI),t.fillStyle="black",t.fill(),t.stroke())},t.RadioButtonList=e=x,n(S,p=s),S.prototype.BY=function(t,i,n,e,s,o){t.strokeStyle="black",t.strokeRect(e+.5,s+.5,2*o+.05,2*o+.05),t.fillStyle="white",t.fillRect(e+1,s+1,2*o-1,2*o-1);var n=U(n,i);i!==l&&n&&(t.beginPath(),t.lineWidth=2.5,t.moveTo(e+3,s+o),t.lineTo(e+o,s+2*o-3.5),t.lineTo(e+2*o-1.5,s+3),t.stroke())},S.prototype.wG=function(t,i){return Z(t,i,this._items,!1)},t.CheckBoxList=i=S,(N=y=t.SelectionMode||(t.SelectionMode={}))[N.single=0]="single",N[N.multiple=1]="multiple",u={selectedBackColor:"rgb(227,119,0)",selectedForeColor:"white",padding:"5",items:l,itemSpacing:{horizontal:5,vertical:5},selectionMode:y.multiple},n(w,f=s),w.prototype.RY=function(t,i,n,e,s,o,c,r,u){var n,i,a,l,n;t.save(),t.beginPath(),n=U(i,n),i=F(i,W)?i.text:i,a=this._selectedBackColor,l=this._selectedForeColor,n&&(t.fillStyle=a,t.fillRect(s+1,o+1,c-1,r-1),t.fillStyle=l),t.textAlign="center",t.textBaseline!==M&&(t.textBaseline=M),n=this.jY(),t.fillText(i,s+n.paddingLeft+(c-n.paddingLeft-n.paddingRight)/2,o+n.paddingTop+r-n.paddingTop-n.paddingBottom-u),t.restore()},w.prototype.wG=function(t,i){return Z(t,i,this._items,this._selectionMode===y.single)},w.prototype.jY=function(){var t,i,n,e,s,t=0,i=0,n=0,e=0;return this._padding&&(s=L(this._padding),t=typeof(t=parseInt(s[0],10))==o&&0<t?t:0,e=typeof(e=parseInt(s[1],10))==o&&0<e?e:0,i=typeof(i=parseInt(s[2],10))==o&&0<i?i:0,n=typeof(n=parseInt(s[3],10))==o&&0<n?n:0),{hasMargin:!0,paddingTop:t,paddingBottom:i,paddingLeft:n,paddingRight:e}},w.prototype.OY=function(t){return 0},w.prototype.toJSON=function(){var e,s,o,e=this,o=f.prototype.toJSON.call(this);return c(u,function(t,i){var n;s=e["_"+t],("items"===t?s&&0<s.length:s!==i)&&(o[t]="object"==typeof s?A(s):s)}),o},w.prototype.fromJSON=function(n){f.prototype.fromJSON.call(this,n);var e=this;c(u,function(t){var i=n[t];h(i)||(e["_"+t]=i)})},I=w,t.ButtonList=I,c(r,function(r){s.prototype[r]=function(t){var i,n,e,s,o,c,c,c,i="_"+r,n=this;if(0===arguments.length)return n[i];if("items"===r){for(e=[],s=0;s<t.length;s++)o=t[s],h(o.text)||h(o.value)?h(o.text)?h(o.value)?h(o)||"object"==typeof o||e.push({text:o,value:o}):(o.text=o.value,e.push(o)):(o.value=o.text,e.push(o)):e.push(o);t=e}if("itemSpacing"===r)c=n[i],n[i]={horizontal:c.horizontal,vertical:c.vertical},h(t.horizontal)||(c=parseInt(t.horizontal,10),isNaN(c))||(n[i].horizontal=c),h(t.vertical)||(c=parseInt(t.vertical,10),isNaN(c))||(n[i].vertical=c);else if("boxSize"===r){if(h(t))return n[i];"number"==typeof t&&0<=t&&(n[i]=t),"auto"===t&&(n[i]=t)}else n[i]=t;return n}}),Q.CellTypes.ti[11]=e,Q.CellTypes.ti[12]=i,c(u,function(r){I.prototype[r]=function(t){var i,n,e,s,o,c,c,c,i="_"+r,n=this;if(0===arguments.length)return n[i];if("items"===r){for(e=[],s=0;s<t.length;s++)o=t[s],h(o.text)||h(o.value)?h(o.text)?h(o.value)?h(o)||"object"==typeof o||e.push({text:o,value:o}):(o.text=o.value,e.push(o)):(o.value=o.text,e.push(o)):e.push(o);t=e}return"itemSpacing"===r?(c=n[i],n[i]={horizontal:c.horizontal,vertical:c.vertical},h(t.horizontal)||(c=parseInt(t.horizontal,10),isNaN(c))||(n[i].horizontal=c),h(t.vertical)||(c=parseInt(t.vertical,10),isNaN(c))||(n[i].vertical=c)):n[i]=t,n}}),Q.CellTypes.ti[13]=I},"./dist/plugins/celltype/rangecelltype.js":function(t,i,n){"use strict";var e,jt,s,u,At,Tt,n,bt,yt,zt,c,r,e,o,a;function g(t){return t.map(function(t){return{start:t.start,size:t.size}})}function l(){this.FY=0,this.PY=0,this.Sx=0,this.Tx=0}function M(){}function h(t,i,n,e,s){var o,i,o=a.call(this)||this;return o.allowOverflow=!1,o.typeName="16",i=1===arguments.length?new jt.Range(0,0,t.getRowCount(),t.getColumnCount()):new jt.Range(i,n,e,s),t&&i&&(o.GY=(new c).yN(t,i),o.UY=(new r).yN(t,i)),o}function I(t,i,U,n,e,s,Z){var o,c,r,u,a,G,l,B,Q,i,M,g,h,Y,I,P,R,W,N,f,D,H,s,V,J,d,F,X,_,K,q,$,tt,it,v,nt,w,et,st,j,A,T,b,A,ot,y,z,C,m,p,L,x,A,A,m,p,ct,rt,ut,S,O,at,lt,Mt,gt,ht,It,k,b,p,Nt,p,b,p,E,ft,Dt,dt,vt,wt,E;if(void 0===Z&&(Z=1),o=i.x,c=i.y,r=i.width,u=i.height,a=n.sheet,G=n.sheetArea,l=n.isPrinting,B=n.needTopGridline,Q=n.needLeftGridline,i=null!=(i=n.printZoomFactor)?i:1,M=[],g=[],h=[],Y=!0,I=[],P=a.BO(),R=s.rowCount,W=s.colCount,N=s.rowSize,f=s.colSize,D=s.cellStyleList,H=s.sparklines,e.HY(U),V=(s=e.zY()).baseRow,J=s.baseCol,F=(d=e.VY).hl,d.cg(new jt.Rect(0,0,r,u)),(X=new jt.Yx(d,d._y(1,3),d.Yy(1,3),3)).JCe.oTe(!0),_=e.YY(!0),c+=1,--u,o+=1,--r,q=K=0,N=N.map(function(t){var i=t.size*u,n=zt(i);return 1<=(q+=i-n)&&(n++,q--),{start:zt(t.start*u),size:n}}),f=f.map(function(t){var i=t.size*r,n=zt(i);return 1<=(K+=i-n)&&(n++,K--),{start:zt(t.start*r),size:n}}),$=d.options.rightToLeft){for(tt=[],it=0,v=W-1;0<=v;v--)tt.push({start:it,size:f[v].size}),it+=f[v].size;tt.reverse(),f=tt}for(nt=d.conditionalFormats,w=0;w<R;w++){for(et={row:w+V,y:c,height:u},st=[],j=0;j<W;j++)if(D[w][j]&&(T=(A=D[w][j]).style,b=A.isSpan,A=A.span,ot=!1,y=_[w][j],!b||A)){if(T=T.clone(!0),z=zt(o+f[j].start),C=zt(c+N[w].start),p=m=void 0,L=b?A.colCount:1,x=b?A.rowCount:1,m=f[A=$?j-L:j+L]?f[A].start:r,A=zt(m-f[j].start),p=N[w+x]?N[w+x].start:u,m=zt(p-N[w].start),et.y=C,et.height=m,y.formatStyle&&(y.formatStyle.h5(T),T=y.formatStyle),T.v5(F),p=yt,b){for(p={row:w,col:j,x:zt(z),y:zt(C),width:zt(A),height:zt(m),rowCount:x,colCount:L},ct={},rt={},ut=[],O=S=void 0,S=lt=at=0;S<L-1;S++)gt=(Mt=f[j+S])?Mt.size:0,at+=rt[S]=gt;for(rt[S]=zt(A)-at,O=0;O<x-1;O++)gt=(ht=N[w+O])?ht.size:0,lt+=ct[O]=gt;for(ct[O]=zt(m)-lt,O=0;O<x;O++){for(It=[],k=0;k<L;k++)D[O+w]&&D[O+w][j+k]&&It.push(D[O+w][j+k].style);ut.push(It)}p.spanSizeInfo={styleList:ut,rowSizes:ct,colSizes:rt}}X.PN(w,j,zt(z),zt(C),zt(A),zt(m),T,p,B&&0===w,Q&&0===j),(b=T.formatter)&&jt.util.St(b)&&(p=a.parent&&a.parent.xO(b))&&(Nt=p.getExpression())&&(p=(0,Tt.formulaToExpression)(a,b.replace("@",JSON.stringify(y.value)),0,0,void 0,!1),(b=(0,Tt.evaluateExpression)(a,p,0,0))instanceof At.CalcError||(y.value=b)),p=null,H[w][j]&&(p=H[w][j].clone())&&(p.ZY=d.name(),p.WY=p.QY(d),p.KY=p.JY(d),p.XY=d),y&&y.value&&"SparklineExValue"===y.value.typeName&&(I.push({value:y.value,x:z,y:C,width:A,height:m,option:n}),ot=!0),y.validStyle&&g.push({style:y.validStyle,x:z,y:C,width:A,height:m}),st.push({col:j+J,x:z,y:C,width:A,height:m}),M.push({data:ot?null:y.value,row:w,col:j,x:z,y:C,width:A,height:m,style:T,sparkline:p,baseRow:w+V,baseCol:j+J,conditionalFormats:nt,imageLoader:P,cellLayout:{row:w,col:j,x:z,y:C,width:A,height:m}}),T&&T.decoration&&T.decoration.icons&&0<T.decoration.icons.length&&h.push({style:T,x:z,y:C,width:A,height:m})}0<st.length&&d.Dn.mfe(h,st,et,l,a,G)}for(t.save(),B&&(c-=2,u+=4),Q&&(o-=2,r+=4),t.rect(o,c,r,u),t.clip(),0<M.length&&d.Dn.eO(t,M,G,l,i,a,V,J,Z),X.paint(t),0<g.length&&d.Dn.EO(t,g),0<h.length&&d.Dn.que(t,h,{isPrinting:l,printZoomFactor:i,sheet:a,imageLoader:P}),t.restore(),w=0;w<I.length;w++)ft=(E=I[w]).value,Dt=E.x,dt=E.y,vt=E.width,wt=E.height,E=E.option,bt.dn(t,ft,Dt,dt,vt,wt,E)}e=this&&this.__extends||(o=function(t,i){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}o(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.paintRangeTemplate=i.RangeTemplate=i.qY=i.$Y=void 0,jt=n("Core"),s=n("Bindings"),u=n("Sparkline"),At=n("CalcEngine"),Tt=n("SheetsCalc"),n=jt.CellTypes.Base,bt=jt.CellTypes.Context,yt=null,zt=Math.floor,l.prototype.yN=function(t,i){var n=this,e=i.row,s=i.col,o=i.rowCount,c=i.colCount;return n.FY=e,n.PY=s,n.Sx=o,n.Tx=c,n.TP=n.ZF(t,i),n.tZ=n.nZ(t,i),n},l.prototype.eZ=function(){return this.tZ},l.prototype.nZ=function(t,i){for(var n,e,s,o,c,r,u,a,l,M,g,h,I,N,e,s,f,D,d,n=this,e=i.row,s=i.col,o=i.rowCount,c=i.colCount,r=0,u=[],a=0,l=[],M=0,g=e+o,h=s+c,I=e;I<g;I++)M=t.getRowHeight(I),a+=M,l.push(M);for(N=s;N<h;N++)M=t.getColumnWidth(N),r+=M,u.push(M);return M=0,e=l.map(function(t){var i=M/a,n;return M+=t,{start:i,size:t/a}}),M=0,s=u.map(function(t){var i=M/r,n;return M+=t,{start:i,size:t/r}}),f=n.ZF(t,i),{rowCount:o,colCount:c,rowSize:e,colSize:s,cellStyleList:D=n.iZ(t,i,f,e,s),sparklines:d=n.rZ(t,i),totalHeight:a,totalWidth:r}},l.prototype.oZ=function(t,i,n,e,s){for(var o,c,r,u,a,l,M,g,h,o=null,c=0,r=s;c<r.length;c++)if(a=(u=r[c]).rowOffset,l=u.colOffset,M=u.rowCount,g=u.colCount,(h=new jt.Range(a+n,l+e,M,g)).contains(t,i)){o=u;break}return o},l.prototype.aZ=function(t,i,n){for(var e,s,o,e,c,r,u,a,l,M,e=[0,0],s=e[0],o=e[1],e=t.rowOffset,c=t.colOffset,r,u,a=e+t.rowCount,l=c+t.colCount,M=e;M<a;M++)o+=i[M]?i[M].size:0;for(M=c;M<l;M++)s+=n[M]?n[M].size:0;return{width:s,height:o}},l.prototype.iZ=function(t,i,n,e,s){for(var o,c,r,u,a,l,M,g,h,I,o=i.row,c=i.col,r=i.rowCount,u=i.colCount,a=[],l=o;l<o+r;l++){for(M=[],g=c;g<c+u;g++)(h=this.oZ(l,g,o,c,n))&&h.rowOffset+o===l&&h.colOffset+c===g?(I=this.aZ(h,e,s),M.push({style:t.getActualStyle(l,g,3,!0),spanWidth:I.width,spanHeight:I.height,isSpan:!0,span:h})):M.push(h?{style:t.getActualStyle(l,g,3,!0),isSpan:!0}:{style:t.getActualStyle(l,g,3,!0)});a.push(M)}return a},l.prototype.ZF=function(t,i){for(var t,n,e,s,o,c,r,u,a,t=t.Ut.getSpans(),n=[],e=i.row,s=i.col,o=i.rowCount,c=i.colCount,r=0,u=t;r<u.length;r++)(a=u[r]).intersect(e,s,o,c)&&n.push({rowOffset:a.row-e,colOffset:a.col-s,rowCount:a.rowCount,colCount:a.colCount});return n},l.prototype.rZ=function(t,i){for(var n,e,s,o,c,r,u,a,l,n=i.row,e=i.col,s=i.colCount,o=i.rowCount,c=[],r=n;r<n+o;r++){for(u=[],a=e;a<e+s;a++)l=t.getSparkline(r,a),u.push(l?l.clone():null);c.push(u)}return c},l.prototype.toJSON=function(){var t,i,n,e,s,o,c,r,t,u,a,l,M,t=this.eZ(),i=t.rowCount,n=t.colCount,e=t.rowSize,s=t.colSize,o=t.cellStyleList,c=t.sparklines,r=t.totalWidth,t=t.totalHeight,u,a,l,M;return{rowCount:i,colCount:n,rowSize:g(e),colSize:g(s),cellStyleList:o.map(function(t){return t.map(function(t){var i,n,e,s,t;return t?(i=t.style,n=t.spanWidth,e=t.spanHeight,s=t.isSpan,t=t.span,{style:i.toJSON(),spanWidth:n,spanHeight:e,isSpan:s,span:t}):null})}),sparklines:c.map(function(t){return t.map(function(t){if(t)return{sparklineType:t.sparklineType(),sp:t.toJSON(),setting:t.setting().toJSON()}})}),totalWidth:r,totalHeight:t}},l.prototype.fromJSON=function(t){var i,n,e,s,o,c,r,t,e,s,o,c;t&&(i=t.rowCount,n=t.colCount,e=t.rowSize,s=t.colSize,o=t.cellStyleList,c=t.sparklines,r=t.totalWidth,t=t.totalHeight,e=g(e),s=g(s),o=o.map(function(t){return t.map(function(t){var i,n,e,s,t,o;return t?(i=t.style,n=t.spanWidth,e=t.spanHeight,s=t.isSpan,t=t.span,o=null,i&&(o=new jt.Style).fromJSON(i),{style:o,spanWidth:n,spanHeight:e,span:t,isSpan:s}):null})}),c=c.map(function(t){return t.map(function(t){var i,n;if(t&&u.SparklineSetting)return i=new u.Sparkline,n=new u.SparklineSetting(t.setting),i.fromJSON(t.sp),i.setting(n),i.sparklineType(t.sparklineType),i})}),this.tZ={rowCount:i,colCount:n,rowSize:e,colSize:s,cellStyleList:o,sparklines:c,totalWidth:r,totalHeight:t})},l.prototype.L0=function(){this.tZ=null},c=l,i.$Y=c,M.prototype.yN=function(t,i,n){var e=this;return e.Z5=i,e.VY=new jt.Worksheet,e.uZ=t.parent&&t.parent.options.allowDynamicArray,e.VY.getCalcService&&(e.VY.getCalcService().allowDynamicArray=e.uZ,e.sZ=e.cZ(t)),e.fZ(t,n),e},M.prototype.cZ=function(t){for(var i,n,e,s,o,c,r,u,a,l,M,g,h,I,M,i=this.Z5,n=i.row,e=i.col,s=i.colCount,o=i.rowCount,c=[],r=t.b3&&t.b3(),u=n;u<n+o;u++)for(a=e;a<e+s;a++)(l=t.getFormula(u,a))&&(M=r&&r.sT(u,a))&&M.isDynamicArray&&(g=M.row,h=M.col,I=M.rowCount,M=M.colCount,1<I&&c.push({row:g+1,col:h,rowCount:I-1,colCount:M}),1<M)&&c.push({row:g,col:h+1,rowCount:1,colCount:M-1});return c},M.prototype.lZ=function(){var t,i,n,e,s,o,c,r,u,o,t,i=this.sZ,n=this.VY;if(i)for(e=0,s=i;e<s.length;e++)c=(o=s[e]).row,r=o.col,u=o.rowCount,o=o.colCount,n.clear(c,r,u,o,3,1)},M.prototype.HY=function(t){var i,t;s.CellBindingSource&&((i=this.VY).suspendEvent(),t=new s.CellBindingSource(t),this.lZ(),i.setDataSource(t),i.resumeEvent())},M.prototype.fZ=function(t,i){var n,e,t,n,e=this.VY,t=t.toJSON({includeBindingSource:!0,ignoreFormula:!!i});delete t.charts,delete t.shapes,e.suspendCalcService(),e.fromJSON(JSON.parse(JSON.stringify(t))),e.resumeCalcService(),this.hZ()},M.prototype.hZ=function(){for(var t,i,n,e,s,o,c,r,u,a,t=this,i=t.Z5,n=i.row,e=i.col,s=i.colCount,o=i.rowCount,c=[],r=[],u=n;u<n+o;u++){for(r=[],a=e;a<e+s;a++)r.push(t.dZ(u,a,3));c.push(r)}this.vZ=c},M.prototype.zY=function(){var t=this.Z5,i,n;return{baseRow:t.row,baseCol:t.col}},M.prototype.YY=function(t){for(var i,n,e,s,o,c,r,u,a,l,M,g,h,I,N,f,i=this.VY,n=this.Z5,e=n.row,s=n.col,o=n.colCount,c=n.rowCount,r=[],u=e;u<e+c;u++){for(a=[],M=l=void 0,g=s;g<s+o;g++)h=i.getText(u,g),I=i.getValue(u,g,3,1),N=i.Jt.$t(u,g,3,1),f=i.getBindingPath(u,g),l=this.mZ(u,g,3),M=this.gZ(i,u,g,I,t),a.push({value:N,formatStyle:l,text:h,validStyle:M,bindingPath:f});r.push(a)}return r},M.prototype.dZ=function(t,i,n){var e,t,e;return this.VY.b8&&(t=this.VY.getDataValidator(t,i,n))?t.highlightStyle():null},M.prototype.gZ=function(t,i,n,e,s){var s,t,e;return s&&t.isValid&&!t.isValid(i,n,e)?(t=(s=this.Z5).row,e=s.col,this.vZ[i-t][n-e]):null},M.prototype.mZ=function(t,i,n){var e=this.VY.conditionalFormats;return e?e.bL(new jt.Style,t,i,n):null},M.prototype.getCellValueInfo=function(t){for(var i,n,e,s,o,c,r,u,a,l,i=this.Z5,n=i.row,e=i.col,s=i.colCount,o=i.rowCount,c=[],r=t.Ut,u=n;u<n+o;u++){for(a=[],l=e;l<e+s;l++)a.push({bindPath:t.getBindingPath(u,l),formula:t.getFormula(u,l),value:r.getValue(u,l,3,yt,1)});c.push(a)}return c},M.prototype.setValueToDataStruct=function(t,i,n,e){e[t]||(e[t]={}),e[t][i]=n},M.prototype.toJSON=function(){var t,i,n,e,s,o,c,r,t=this.VY,i=this.uZ,n=this.sZ.map(function(t){var i,n,e,s;return{row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount}}),e=this.Z5,s,o,c,r;return{spillRanges:n,allowDynamicArray:i,range:{row:e.row,col:e.col,rowCount:e.rowCount,colCount:e.colCount},templatejson:JSON.stringify(t.toJSON({includeBindingSource:!0}))}},M.prototype.fromJSON=function(t){var i,n,t,e,s,o,t;t&&((n=(i=this).VY=new jt.Worksheet).suspendCalcService&&n.suspendCalcService(),i.sZ=t.spillRanges||t.spillRangs,i.uZ=t.allowDynamicArray,n.getCalcService&&(n.getCalcService().allowDynamicArray=i.uZ),n.fromJSON(JSON.parse(t.templatejson)),i.lZ(),e=(t=t.range).row,s=t.col,o=t.rowCount,t=t.colCount,i.Z5=new jt.Range(e,s,o,t),this.hZ(),n.resumeCalcService)&&n.resumeCalcService()},M.prototype.L0=function(){this.VY.L0(),this.VY=null,this.Z5=null},r=M,i.qY=r,e(h,a=n),h.prototype.getAutoFitWidth=function(){return this.GY.tZ.totalWidth},h.prototype.getAutoFitHeight=function(){return this.GY.tZ.totalHeight},h.prototype.updateTemplate=function(t,i){t&&i&&(this.GY.yN(t,i),this.UY.yN(t,i))},h.prototype.paintContent=function(t,i,n,e,s,o,c,r){var u,a,a,u=this.UY,a=this.GY;u&&a&&(a=this.GY.eZ(),c.cellPadding&&(r.needTopGridline=!0,r.needLeftGridline=!0),I(t,{x:n,y:e,width:s,height:o},i,r,u,a))},h.prototype.toJSON=function(){return{typeName:this.typeName,layout:this.GY.toJSON(),resolver:this.UY.toJSON()}},h.prototype.fromJSON=function(t){t.layout&&(this.GY=new c,this.GY.fromJSON(t.layout)),t.resolver&&(this.UY=new r,this.UY.fromJSON(t.resolver))},i.RangeTemplate=e=h,jt.CellTypes.ti[16]=e,i.paintRangeTemplate=I},Common:function(t){"use strict";t.exports=GC.Spread},CalcEngine:function(t){"use strict";t.exports=GC.Spread.CalcEngine},Core:function(t){"use strict";t.exports=GC.Spread.Sheets},Bindings:function(t){"use strict";t.exports=GC.Spread.Sheets.Bindings},SheetsCalc:function(t){"use strict";t.exports=GC.Spread.Sheets.CalcEngine},Sparkline:function(t){"use strict";t.exports=GC.Spread.Sheets.Sparklines}},e={},t=s("./dist/plugins/celltype/celltypes.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).CellTypes=t}();
;var GC;!function(){"use strict";var t,o,e;function r(e){var n,n,n=o[e];return void 0!==n||(n=o[e]={exports:{}},t[e].call(n.exports,n,n.exports,r)),n.exports}t={"./dist/plugins/contextMenu/context-menu-dialog.js":function(e,n,t){var o,r,a,t,i,u,c,s,l,m,f;function d(e,n){var e,t,e=f.call(this,e,a(e))||this;return e.jTe=r.DialogFeatureType.contextMenu,e.zX=n,e}o=this&&this.__extends||(m=function(e,n){return(m=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,n){e.__proto__=n}:function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}))(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function t(){this.constructor=e}m(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}),Object.defineProperty(n,"__esModule",{value:!0}),n.ContextMenuViewDialog=void 0,r=t("Core"),a=r.mt.gi,t=r.zc,i=r.GC$,u="gc.command.executed",c="left",s="top",o(d,f=t),d.prototype.VX=function(e,n,t){var o,e,o=this,e=e[0];o.YX&&o.YX.ZX&&o.YX.ZX(e,n,t,o.zX)},d.prototype.rQ=function(e,n,t,o,r){var a,t,a=this,t=a.WX(t,o);a.YX=e,a.VX(t,n,r)},d.prototype.WX=function(e,n){var t,o,t=this,o=t.Xc();return o.css([c,s],[e,n]),o.empty(),f.prototype.$c.call(this),t.aY(),o},d.prototype.QX=function(e){var n,t,o,r,e,n,t=this.Xc();return"block"!==t.css("display")||((o=t.offset()).top+=document.body.clientTop||0,o.left+=document.body.clientLeft||0,r=e.x,e=e.y,r<o.left)||r>t.width()+o.left||e<o.top||e>t.height()+o.top},d.prototype.aY=function(){var e=this;e.zX.bind(u,function(){e.close()})},d.prototype.KX=function(){var e;this.zX.unbind(u)},d.prototype.close=function(){var e,n,t,t,e=this,n=e.YX;n&&n.DJ&&((t=n.JX)&&t.menuItemData.needKeepFocus||(t=n.DJ.getActiveSheet())&&t.rt&&!t.il&&t.rt.aA(),e.YX.L0()),e.KX(),e.Yc(e.Zc)&&i("#"+e.Zc).remove(),f.prototype.close.call(this)},n.ContextMenuViewDialog=d},"./dist/plugins/contextMenu/context-menu.entry.js":function(e,n,t){var o,r,r,o=this&&this.__createBinding||(Object.create?function(e,n,t,o){void 0===o&&(o=t);var r=Object.getOwnPropertyDescriptor(n,t);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(e,o,r)}:function(e,n,t,o){e[o=void 0===o?t:o]=n[t]}),r=this&&this.__exportStar||function(e,n){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(n,t)||o(n,e,t)};Object.defineProperty(n,"__esModule",{value:!0}),n.XX=void 0,r(t("./dist/plugins/contextMenu/context-menu.js"),n),r(t("./dist/plugins/contextMenu/menu-view.js"),n),r(t("./dist/plugins/contextMenu/context-menu.ns.js"),n),r=t("./dist/plugins/contextMenu/context-menu-dialog.js"),n.XX=r.ContextMenuViewDialog},"./dist/plugins/contextMenu/context-menu.js":function(v,h,e){var x,b,k,A,ue,S,y,m,ce,ye,T,se,w,n,g,F,t,le,me,o,M,R,r,O,V,a,N,U,I,D,L,P,E,j,H,G,_,B,W,K,Z,z,J,q,i,Q,X,Y,$,ee,ne,te,oe,re,ae,ie,Te,Fe,Me,Re,Oe,Ve,Ne,Ue,Ie,De,Le,Pe,Ee,je,He,Ge,_e,Be,We,Ke,Ze,ze,u,Je,qe,Qe,Xe,Ye,$e,en,fe,de,nn,tn,on,rn,an,un,cn,sn,ln,mn,fn,dn,pn,vn,hn,xn,wn,gn,Cn,bn,kn,An,Sn,yn,Tn,Fn,Mn,Rn,On,Vn,Nn,Un,pe,ve,In,Dn,Ln,he,Pn,En,xe,jn,Hn,Gn,_n,Bn,Wn,c,Kn,we,Zn,zn,Jn,qn,Qn,Xn,Yn,f,$n,et,nt,tt,ot,rt,at,it,ut,ct,st,lt,mt,ft,ge,Ce,be,ke,dt,pt,vt,ht,xt,wt,gt,Ct,bt,kt,At,St,yt,Tt,Ft,Mt,Rt,Ot,Vt,Nt,Ut,Ae,It,s,Dt,Lt,l,d,Pt,e,C,Et,jt,Ht;function Gt(e){var n,t;if(e.slicers&&(n=e.slicers.all())&&!ye(n))for(t in n)if(n[t].isSelected())return 1}function _t(e,n,t){for(var o,r,a,i,u,o=n===Nt?"rowCount":"colCount",r=0;r<e.length;r++)for(i=-1===(a=e[r])[n]?0:a[n],u=0;u<a[o];u++)t(i+u)}function Bt(e,n){for(var t=[],o=-1,r,r=e.row;r<e.row+e.rowCount;r++)!1!==n[r]&&-1===o&&(o=r),!1===n[r]&&-1!==o&&(t.push([o,r-o]),o=-1);return-1!==o&&t.push([o,r-o]),t}function Wt(e,n){var t,t,t,n;if(1===n.colCount&&-1===n.row){if((t=n.col)===e.k9()&&0<=(t=t-1)&&!e.getColumnVisible(t))return!0}else if(1===n.rowCount&&-1===n.col&&(t=n.row)===e.N9()&&0<=(n=t-1)&&!e.getRowVisible(n))return!0}function Kt(e){var n,t,o;if(e.slicers){if(!(n=e.slicers.all())||ye(n))return null;for(o in t=[],n)n[o].isSelected()&&t.push(n[o]);return t}}function Zt(e,n){var t,n,o,t=n.name,n=n.group;if(!([w+Qn,w+qn,w+c].indexOf(t)<0&&w+c!==n&&t!==d(It))){if((o=(0,ue.jf)(e))&&o.NMi&&(w+c===t||w+c===n))return!1;if(t===d(It)&&!ue.mt.isEnablePasteSpecial(o))return!1;switch(t){case w+zn:case w+Kn:case w+Yn:case w+we:case w+Xn:if(o&&!0===o.ST().ES)return!1}}return!0}function zt(e,n){var n;return[w+_n].indexOf(n.name)<0||!(n=(0,ue.jf)(e))||!n.NMi}function Jt(e,n){var n;return[w+jn,w+Gn,w+xe,w+Hn].indexOf(n.name)<0||!(n=(0,ue.jf)(e))||!n.NMi}function qt(e,n){var n,e,n=n.name;return[w+Un,w+rn,w+an,w+on].indexOf(n)<0||!(e=(0,ue.jf)(e))||!e.NMi||n!==w+an&&n!==w+on}function Qt(e,n){var t,n,o,t,e,r,a,i,u,t=[w+he,w+de,w+en,w+fe],n=n.name;if(t.indexOf(n)<0)return!0;if(t=(o=(0,ue.jf)(e)).getActiveRowIndex(),e=o.getActiveColumnIndex(),o&&o.comments){if(r=o.comments.get(t,e))return n!==w+he;if(n!==w+de&&n!==w+en){if(n===w+he)return!0;for(a=o.getSelections(),i=0;i<a.length;i++)if(Yt(u=a[i],o))return!0}return!1}}function Xt(e,n){var t,o,r,a,i,u;if(n.comments)for(t=n.comments.all(),r=o=void 0,a=0;a<e.length;a++)for(i=e[a],u=0;u<t.length;u++)if(!t[u].locked()&&(r=t[u].bZ,o=t[u].yZ,r>=i.row)&&r<i.row+i.rowCount&&o>=i.col&&o<i.col+i.colCount)return 1}function Yt(e,n){var t,o,r,a;if(n.comments)for(t=n.comments.all(),r=o=void 0,a=0;a<t.length;a++)if(r=t[a].bZ,o=t[a].yZ,r>=e.row&&r<e.row+e.rowCount&&o>=e.col&&o<e.col+e.colCount)return 1}function $t(e,n){var n,e,n,e,e;return[w+Dn,w+Ln].indexOf(n.name)<0||!((n=(0,ue.jf)(e))&&n.NMi||!(e=n.getSelections())||1!==e.length||(e=co(n,n=e[0]))&&(e=e.range(),n.row<e.row||n.col<e.col||n.row+n.rowCount>e.row+e.rowCount||n.col+n.colCount>e.col+e.colCount))}function eo(e,n){var n,e;return[w+ge].indexOf(n.name)<0||(e=(n=(0,ue.jf)(e))&&n.ST())&&!e.ES&&e._S&&1===e._S.length&&1===n.getSelections().length&&to(n)}function no(e,n){var n,e;return[w+Ce].indexOf(n.name)<0||(e=(n=(0,ue.jf)(e))&&n.ST())&&e.ES&&e._S&&1===e._S.length&&1===n.getSelections().length&&to(n)}function to(e){var n,t,o,r,a,i;if(e.NMi)return!1;if(n=e.getActiveRowIndex(),t=e.getActiveColumnIndex(),!(o=e.ST()).TT)return!1;if(e.tables&&e.tables.find(n,t))return!1;for(r=e.Ut.getSpans(),a=0;a<r.length;a++)if(n>=(i=r[a]).row&&n<i.row+i.rowCount&&t>=i.col&&t<i.col+i.colCount)return!1;return!0}function oo(e,n){var e,t,n,o,r,e,a,i,u,i,e=(0,ue.jf)(e),t=[w+me+sn,w+me+ln].indexOf(n.name),n=[w+me+dn,w+me+mn,w+me+fn,w+me+pn,w+me+vn,w+me+hn].indexOf(n.name),o=-1<t,r=-1<n;return e&&e.NMi&&(e=e.NMi,o||r)?!(a=e.qNi())||(u=[(i=e.options.menuItemVisibility).promoteMenuItemVisible,i.demoteMenuItemVisible],i=[i.addAboveMenuItemVisible,i.addAfterMenuItemVisible,i.addBeforeMenuItemVisible,i.addBelowMenuItemVisible,i.moveUpMenuItemVisible,i.moveDownMenuItemVisible],a=o&&u[t])||!e.qX()?a:r&&i[n]:!(o||r)}function ro(e,n,t){var e,o,r,a,i,u,c,s,l,m,f,d,t,p,n,e=(0,ue.jf)(e),o=9,r=w+le,a,i=-1<[On,Vn,Nn].map(function(e){return r+e}).indexOf(n.name),u=[xn,wn].map(function(e){return r+e}).indexOf(n.name),c,s=-1<u,l=-1<ao(9,function(e){return r+gn+(e+1)}).indexOf(n.name);if(e&&e.NMi){if((m=e.NMi).qNi()&&(l||s))return d=[(f=m.options.menuItemVisibility).expandAllLevelMenuItemVisible,f.collapseAllLevelMenuItemVisible],l?(t=t.$X=t.$X||m.MDi()+1,(p=parseInt(n.name.charAt((r+gn).length),10))<=Math.min(9,t)&&f.expandToLevelMenuItemVisible):s&&d[u];if(i&&m.options.enableDefineColumn)return 0<(n=e.getSelections()).length&&1===n[0].colCount}return!(l||s||i)}function ao(e,n){for(var t,o,t=[],o=0;o<e;o++)t.push(n(o,t));return t}function io(e,n){var e,t,o,r,a,i,u,c,s;if([w+me+ge,w+me+Ce].indexOf(n.name)<0)return!0;if(!(e=(0,ue.jf)(e))||!e.NMi){if(t=e.ST(),o=e.getActiveRowIndex(),r=!1,e.tables)for(a=e.tables.all(),i=0;i<a.length;i++)if(o>=(u=a[i]).Ky&&o<u.Ky+u.Sx){r=!0;break}for(c=e.Ut.getSpans(),i=0;i<c.length;i++)if(o>(s=c[i]).row&&o<s.row+s.rowCount)return!1;if(t.TT&&(!t._S||1===t._S.length)&&1===e.getSelections().length)if(n.name===w+me+Ce){if(t.ES&&(r||t._S&&e.getColumnCount()%t._S[0].colCount==0))return!0}else if(n.name===w+me+ge&&!t.ES&&(r||t._S&&e.getColumnCount()%t._S[0].colCount==0))return!0}return!1}function uo(e,n){var e,t,o,r,a,i,u,c,s;if([w+le+ge,w+le+Ce].indexOf(n.name)<0)return!0;if(!(e=(0,ue.jf)(e))||!e.NMi){if(t=e.ST(),o=e.getActiveColumnIndex(),r=!1,e.tables)for(a=e.tables.all(),i=0;i<a.length;i++)if(o>=(u=a[i]).iw&&o<u.iw+u.Tx){r=!0;break}for(c=e.Ut.getSpans(),i=0;i<c.length;i++)if(o>(s=c[i]).col&&o<s.col+s.colCount)return!1;if(t.TT&&(!t._S||1===t._S.length)&&1===e.getSelections().length)if(n.name===w+le+ge){if(!t.ES&&(r||t._S&&e.getRowCount()%t._S[0].rowCount==0))return!0}else if(n.name===w+le+Ce&&t.ES&&(r||t._S&&e.getRowCount()%t._S[0].rowCount==0))return!0}return!1}function co(e,n){var t,o,r;if(n)for(ue.mt.J0(n,e.getRowCount(),e.getColumnCount()),t=n.row;t<n.row+n.rowCount;t++)for(o=n.col;o<n.col+n.colCount;o++)if(e.tables&&(r=e.tables.find(t,o)))return r;return null}function so(e,n,t,o){for(var r,a,r=0;r<n.length;r++)(a=n[r]).jj(t,o,!0,Ae,a.tq())}function lo(e){for(var n,t,o,r,n=e,t=0;t<n.length-1;t++)for(o=t+1;o<n.length;o++)n[t].row<n[o].row&&(r=n[t],n[t]=n[o],n[o]=r);return n}function mo(e){for(var n,t,o,r,n=e,t=0;t<n.length-1;t++)for(o=t+1;o<n.length;o++)n[t].col<n[o].col&&(r=n[t],n[t]=n[o],n[o]=r);return n}function fo(e,n,t,o){var r=e.Ut.getSpans(Ae,3);0<=n?(ho(e,r,n,o,3),ho(e,e.Ut.getSpans(Ae,2),n,o,2)):0<=t&&(po(e,r,t,o,3),po(e,e.Ut.getSpans(Ae,1),t,o,1))}function po(e,n,t,o,r){for(var a,i,u,c,s,l,a=0,i=n.length;a<i;a++)if(t>(u=n[a]).col&&t<u.col+u.colCount)for(c=u.row;c<u.row+u.rowCount;c++)if(s=xo(e,c,t,o,r,!0))for(l=t;l<t+o;l++)e.setStyle(c,l,s,r)}function vo(e,n){return e.style===n.style&&e.color===n.color}function ho(e,n,t,o,r){for(var a,i,u,c,s,l,a=0,i=n.length;a<i;a++)if(t>(u=n[a]).row&&t<u.row+u.rowCount)for(c=u.col;c<u.col+u.colCount;c++)if(s=xo(e,t,c,o,r,!1))for(l=t;l<t+o;l++)e.setStyle(l,c,s,r)}function xo(e,n,t,o,r,a){var i,u,c,s,l,m,f,d,p,v,l=["borderLeft","borderTop","borderRight","borderBottom","diagonalDown","diagonalUp"];if(a){if(i=e.Z_(n,t-1,r),(u=e.Z_(n,t+o,r))&&i){for(i=i.clone(),m=0,f=l;m<f.length;m++)i[d=f[m]]&&u[d]&&vo(i[d],u[d])||(i[d]=void 0);return i}}else if(c=e.Z_(n-1,t,r),s=e.Z_(n+o,t,r),c&&s){for(c=c.clone(),p=0,v=l;p<v.length;p++)c[d=v[p]]&&s[d]&&vo(c[d],s[d])||(c[d]=void 0);return c}}function Se(e,n,t,o,r,a){var i,u,c,s,l,t,r,i=(0,ue._f)(e,n.sheetName);return!!i&&(u=n.considerAllSheets,c=e.i4(),i.suspendPaint(),s=ue.Commands.TI(i.name()),t?(t=void 0,(t=r?r(i,n):t)&&t.cancel||(u?ue.Commands.NI(c,n):i.Mtt(n[s]),a&&a(i,n,t))):(u?ue.Commands.II(c):i.VAe(),l=o(i,n),u?ue.Commands.xI(c,n):n[s]=i.zAe()),i.resumePaint(),u&&(r=(0,ue.jf)(e))&&i!==r&&r.repaint(),l)}function wo(e,n,t){var o;if(0<t){for(o=n+1;o<e.getRowCount();o++)if((t-=e.getRowHeight(o))<=0)return o-n}else if(t<0)for(o=n-1;0<=o;o--)if(0<=(t+=e.getRowHeight(o)))return o-n;return 0}function go(e,n,t){var o;if(0<t){for(o=n+1;o<e.getColumnCount();o++)if((t-=e.getColumnWidth(o))<=0)return o-n}else if(t<0)for(o=n-1;0<=o;o--)if(0<=(t+=e.getColumnWidth(o)))return o-n;return 0}function Co(e,n,t,o,r){var e=(0,ue._f)(e,n.sheetName);e&&t.execute({cmd:Bn,sheetName:e.name(),pasteOption:o,pasteSpecialOptions:r})}function bo(o,r,e,a){return Se(o,r,e,function(e){var n,t,n=Kt(e);if(n&&0!==n.length){for(t in n)n.hasOwnProperty(t)&&n[t].sortState(a);o.changeSelectionInCommandExecuting(r,null,null,[],n)}})}function ko(e){e.jT(8,C().hideSheetFailureInfo)}function Ao(e,n){var t,o,r,t=n.name(),o=e.Ese(t),r={sheetName:t,propertyName:"isVisible",cancel:!1,sheetIndex:o,sheetPosition:e.getSheetPosition(t),oldValue:!1,newValue:!0};if(e.ki(ue.Events.SheetChanging,r),r.cancel)return!1;n.visible(!0),e.ki(ue.Events.SheetChanged,{sheetName:t,propertyName:"isVisible",sheetIndex:o,sheetPosition:e.getSheetPosition(t),oldValue:!1,newValue:!0})}function So(e,n,t){var o,o,o={oldSheet:n,newSheet:t,cancel:!1};return e.ki(ue.Events.ActiveSheetChanging,o),!o.cancel&&(o={oldValue:!0,newValue:!1,sheetName:n.name(),propertyName:"isSelected",cancel:!1,sheetIndex:e.Ese(n.name()),sheetPosition:e.getSheetPosition(n.name())},e.ki(ue.Events.SheetChanging,o),!o.cancel)&&(o={oldValue:!1,newValue:!0,sheetName:t.name(),propertyName:"isSelected",cancel:!1,sheetIndex:e.Ese(t.name()),sheetPosition:e.getSheetPosition(t.name())},e.ki(ue.Events.SheetChanging,o),!o.cancel)&&void 0}function yo(e,n){var t,n,t=(0,ue.jf)(e);e.ki(ue.Events.ActiveSheetChanged,{oldSheet:n,newSheet:t}),n={oldValue:!0,newValue:!1,sheetName:n.name(),propertyName:"isSelected",sheetIndex:e.Ese(n.name()),sheetPosition:e.getSheetPosition(n.name())},e.ki(ue.Events.SheetChanged,n),n={oldValue:!1,newValue:!0,sheetName:t.name(),propertyName:"isSelected",sheetIndex:e.Ese(t.name()),sheetPosition:e.getSheetPosition(t.name())},e.ki(ue.Events.SheetChanged,n)}function To(e,n,t){var e,o,n,r,a,i,u,e,c,s;if(void 0===t&&(t=!1),0<(e=e.selections).length&&(o=n.NMi,r=(n=e[0]).col,a=n.colCount,e=(u=(i=o.getDataView()).getColumnInfos()).filter(function(e){return!e.isFreeColumn}).length,!(r<0||e<=r||(a=Math.min(a,e-r))<=0))){for(c=r;c<r+a;c++)(s=u[c]).visible=t;try{i.setColumnInfos(u),o.setDataView(i)}catch(e){return!1}}}function Fo(e){var e=e.slice(e.lastIndexOf(".")+1);return e===me+Ce||e===me+ge||e===le+Ce||e===le+ge}function Mo(a){var e=function(o,r){return{canUndo:!1,execute:function(e,n,t){Co(e,n,a,o,r)}}};a.register(l.pasteFormulaAndNumberFormat,e(ue.ClipboardPasteOptions.formulasAndNumberFormatting),null,!1,!1,!1,!1),a.register(l.pasteKeepSourceFormatting,e(ue.ClipboardPasteOptions.usingSourceTheme),null,!1,!1,!1,!1),a.register(l.pasteNoBorders,e(ue.ClipboardPasteOptions.noBorder),null,!1,!1,!1,!1),a.register(l.pasteColumnWidth,e(ue.ClipboardPasteOptions.allAndColumnWidth),null,!1,!1,!1,!1),a.register(l.pasteTranspose,e(ue.ClipboardPasteOptions.all,{transpose:!0}),null,!1,!1,!1,!1),a.register(l.pasteValueAndNumberFormats,e(ue.ClipboardPasteOptions.valuesAndNumberFormatting),null,!1,!1,!1,!1),a.register(l.pasteValueAndSourceFormats,e(ue.ClipboardPasteOptions.valuesAndSourceFormatting),null,!1,!1,!1,!1),a.register(l.pasteLink,e(ue.ClipboardPasteOptions.all,{pasteLink:!0}),null,!1,!1,!1,!1)}function p(){var e=this;e.menuView=new A.MenuView,e.menuData=e.nq()}x=this&&this.__spreadArray||function(e,n,t){if(t||2===arguments.length)for(var o=0,r=n.length,a;o<r;o++)!a&&o in n||((a=a||Array.prototype.slice.call(n,0,o))[o]=n[o]);return e.concat(a||Array.prototype.slice.call(n))},Object.defineProperty(h,"__esModule",{value:!0}),h.ContextMenu=void 0,b=e("Common"),k=e("./dist/plugins/contextMenu/context-menu-dialog.js"),A=e("./dist/plugins/contextMenu/menu-view.js"),ue=e("Core"),S=e("./dist/plugins/contextMenu/context-menu.ns.js"),y=e("./dist/plugins/contextMenu/menuItems/index.js"),m=ue.GC$,ce=b.Common.lt.ht,ye=b.Common.lt._h,T=ue.mt.vi,n="gc-spread-",g="gc.spread.pivot",F="gc-spread-pivot-selected",t="viewport",le="colHeader",me="rowHeader",o="slicer",M="timeline",R="sheetTab",r="corner",O="pivotPageFilter",V="pivotTopLeft",a="pivotHeader",N="pivotEmptyLabel",U="pivotContent",I="pivotGrandTotal",D="FieldName",L="SortType",P="pivotSummarizeValuesBy",E="pivotExpandOrCollapse",j="pivotTableGroup",H="OpenPivotGroupDialog",G="pivotTableUnGroup",_="pivotShowValueAs",B="pivotShowDetails",W="pivotRefresh",K="removeField",Z="pivotTable",z="removePivotGrandTotal",J="openValueFieldSettingDialogCmd",q="pivotSum",i="UpdatePivotValueFieldCmd",Q="pivotCount",X="pivotAverage",Y="pivotMax",$="pivotMin",ee="pivotProduct",ne="pivotNoCalculation",te="pivotGrandtotal",oe="pivotColumnTotal",re="pivotRowTotal",ae="pivotOf",ie="pivotParentRowTotal",Te="pivotDifferenceFrom",Fe="pivotPercentDifferenceFro",Me="pivotRunningTotalIn",Re="pivotPercentRunningTotalIn",Oe="pivotRankSmallestToLargest",Ve="pivotOfParentTotal",Ne="pivotParentColumnTotal",Ue="pivotRankLargestToSmallest",Ie="pivotIndex",De="pivotFilter",Le="pivotClearFilterFrom",Pe="pivotKeepOnlySelectedItems",Ee="pivotHideSelectedItems",je="pivotTop10",He="pivotLabelFilters",Ge="pivotValueFilters",_e="pivotExpand",Be="pivotCollapse",We="pivotExpandEntireField",Ke="pivotCollapseEntireField",Ze="createDialogForValueFilter",ze="createDialogForLabelFilter",u="OpenPivotShowValueAsDialog",Je="filterFieldLabelValue",qe="ClearCommand",Qe="pivotSort",Xe="createDialogForPivotSort",Ye="openPasteSpecialDialog",$e="removeSlicer",en="toggleComment",fe="deleteComment",de="editComment",nn="unhideSheet",tn="hideSheet",on="unhideRows",rn="unhideColumns",an="hideRows",un="pinRows",cn="pinColumns",sn="promote",ln="demote",mn="addAfter",fn="addBefore",dn="addAbove",pn="addBelow",vn="moveUp",hn="moveDown",xn="expandAllLevels",wn="collapseAllLevels",gn="expandLevel",Cn="expandLevel1",bn="expandLevel2",kn="expandLevel3",An="expandLevel4",Sn="expandLevel5",yn="expandLevel6",Tn="expandLevel7",Fn="expandLevel8",Mn="expandLevel9",Rn="defineColumn",On="modifyColumn",Vn="removeColumn",Nn="setPrimaryKey",Un="hideColumns",pe="sortAscend",ve="sortDescend",In="sortMoreOptions",Dn="sort",Ln="filter",he="insertComment",Pn="deleteSheet",En="insertSheet",xe="insertRows",jn="insertColumns",Hn="deleteRows",Gn="deleteColumns",_n="clearContents",Bn="paste",Wn="ganttSheetPaste",c="pasteOptions",Kn="pasteFormatting",we="pasteValues",Zn="pasteGanttValues",zn="pasteFormula",Jn="pasteAll",qn="cut",Qn="copy",Xn="pasteValuesFormatting",Yn="pasteFormulaFormatting",f="separator",$n="groupHeader",et="slicerSortAscend",nt="slicerSortDescend",tt="table",ot="tableInsert",rt="tableDelete",at="tableInsertRowsAbove",it="tableInsertRowsBelow",ut="tableInsertColumnsLeft",ct="tableInsertColumnsRight",st="tableDeleteRows",lt="tableDeleteEntireSheetRows",mt="tableInsertEntireSheetRows",ft="tableDeleteColumns",ge="insertCopiedCells",Ce="insertCutCells",be="shiftCellsDown",ke="shiftCellsRight",dt="allSheets",pt="tableInsertRowsAboveForContextMenu",vt="tableInsertRowsBelowForContextMenu",ht="tableDeleteRowsForContextMenu",xt="tableInsertColumnsLeftForContextMenu",wt="tableInsertColumnsRightForContextMenu",gt="tableDeleteColumnsForContextMenu",Ct="GanttRowHeader",bt="GanttField",kt="insertTask",At="deleteTask",St="scrollToTask",yt="manuallySchedule",Tt="autoSchedule",Ft="GanttColumn",Mt="hideGanttColumn",Rt="unHideGanttColumn",Ot="indentGanttTask",Vt="outdentGanttTask",Nt="row",Ut="col",Ae=void 0,It="pasteSpecial",s=(w="gc.spread.")+"pasteSpecialPasteGroup",Dt=w+"pasteSpecialPasteValueGroup",Lt=w+"pasteSpecialOtherOptionsGroup",l={pasteFormulaAndNumberFormat:(se="gc.spread.contextMenu.")+"pasteFormulaAndNumberFormat",pasteKeepSourceFormatting:se+"pasteKeepSourceFormatting",pasteNoBorders:se+"pasteNoBorders",pasteColumnWidth:se+"pasteColumnWidth",pasteTranspose:se+"pasteTranspose",pasteValueAndNumberFormats:se+"pasteValueAndNumberFormats",pasteValueAndSourceFormats:se+"pasteValueAndSourceFormats",pasteLink:se+"pasteLink"},d=function(e){return w+e},Pt=function(e){return n+e},e=new b.Common.ResourceManager(S.SR,"GanttSheet"),C=e.getResource.bind(e),Et={sheetTab:function(e,n,t){return new RegExp("sheetTab","i").test(t.workArea)&&e.tabStripHitInfo&&e.tabStripHitInfo.sheetTab&&"newSheet"!==e.tabStripHitInfo.sheetTab.sheetName&&"allSheets"!==e.tabStripHitInfo.sheetTab.sheetName},outline:function(e,n,t){return!!(new RegExp("outline","i").test(t.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.outlineHitInfo)},viewport:function(e,n,t){if(new RegExp("viewport","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&!e.worksheetHitInfo.floatingObjectHitInfo&&!e.worksheetHitInfo.shapeHitInfo&&!e.worksheetHitInfo.pivotTableInfo&&!e.worksheetHitInfo.commentHitInfo)return Zt(n,t)&&zt(n,t)&&Qt(n,t)&&$t(n,t)&&eo(n,t)&&no(n,t)},rowHeader:function(e,n,t){if(new RegExp("rowHeader","i").test(t.workArea)&&e.worksheetHitInfo&&2===e.worksheetHitInfo.hitTestType)return Zt(n,t)&&zt(n,t)&&Jt(n,t)&&qt(n,t)&&io(n,t)&&oo(n,t)},colHeader:function(e,n,t){var o,r,r,a,o=e.worksheetHitInfo;if(new RegExp("colHeader","i").test(t.workArea)&&o&&1===o.hitTestType&&(r=(r=(0,ue.jf)(n))&&r.Ut.getFreeAreaRowCount(1),!(a=o.row<r)))return Zt(n,t)&&zt(n,t)&&Jt(n,t)&&qt(n,t)&&uo(n,t)&&ro(n,t,e)},corner:function(e,n,t){if(new RegExp("corner","i").test(t.workArea)&&e.worksheetHitInfo&&0===e.worksheetHitInfo.hitTestType)return Zt(n,t)&&zt(n,t)&&Qt(n,t)&&$t(n,t)},slicer:function(e,n,t){return new RegExp("slicer","i").test(t.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.shapeHitInfo&&e.worksheetHitInfo.shapeHitInfo.shape&&"Slicer"===e.worksheetHitInfo.shapeHitInfo.shape.drawingType},timeline:function(e,n,t){var t,e,t=new RegExp("timeline","i").test(t.workArea),e=e.worksheetHitInfo&&e.worksheetHitInfo.shapeHitInfo&&e.worksheetHitInfo.shapeHitInfo.shape&&"Timeline"===e.worksheetHitInfo.shapeHitInfo.shape.drawingType;return t&&e},chart:function(e,n,t){return new RegExp("chart","i").test(t.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.floatingObjectHitInfo&&e.worksheetHitInfo.floatingObjectHitInfo.floatingObject&&"2"===e.worksheetHitInfo.floatingObjectHitInfo.floatingObject.typeName},shape:function(e,n,t){return new RegExp("shape","i").test(t.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.shapeHitInfo},table:function(e,n,t){var n=(0,ue.jf)(n),n=n&&n.tables;return new RegExp("table","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&!e.worksheetHitInfo.floatingObjectHitInfo&&!e.worksheetHitInfo.shapeHitInfo&&!e.worksheetHitInfo.pivotTableInfo&&!e.worksheetHitInfo.commentHitInfo&&n&&n.eq()},vpWithoutTb:function(e,n,t){var o,e,r;if(new RegExp("vpWithoutTb","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&!e.worksheetHitInfo.floatingObjectHitInfo&&!e.worksheetHitInfo.shapeHitInfo&&!e.worksheetHitInfo.pivotTableInfo&&!e.worksheetHitInfo.commentHitInfo)return!((e=(0,ue.jf)(n).tables)&&e.eq())&&Zt(n,t)&&zt(n,t)&&Qt(n,t)&&$t(n,t)},pivotTablePageFilterArea:function(e,n,t){var n=(0,ue.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotPageFilter","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&n&&e.worksheetHitInfo.pivotTableCellInfo&&0===e.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableCornerArea:function(e,n,t){var n=(0,ue.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotTopLeft","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&n&&e.worksheetHitInfo.pivotTableCellInfo&&1===e.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableEmptyLabelArea:function(e,n,t){var n=(0,ue.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotEmptyLabel","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&n&&e.worksheetHitInfo.pivotTableCellInfo&&3===e.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableHeaderArea:function(e,n,t){var n=(0,ue.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotHeader","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&n&&e.worksheetHitInfo.pivotTableCellInfo&&2===e.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableGrandTotalArea:function(e,n,t){var n=(0,ue.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotGrandTotal","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&n&&e.worksheetHitInfo.pivotTableCellInfo&&5===e.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableContentArea:function(e,n,t){var n=(0,ue.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotContent","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&n&&e.worksheetHitInfo.pivotTableCellInfo&&4===e.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTable:function(e,n,t){var n=(0,ue.jf)(n),n=n&&n.pivotTables;return new RegExp("pivotTable","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&n&&e.worksheetHitInfo.pivotTableCellInfo}},jt=[],p.prototype.nq=function(){var e=C();return x(x([],(0,y.createReportSheetMenuItems)(e),!0),[{text:C().copy,name:w+Qn,command:se+Qn,iconClass:n+Qn,workArea:t+le+me+o+r+Z+M},{text:C().cut,name:w+qn,command:se+qn,iconClass:n+qn,workArea:t+le+me+o+r+M},{text:C().pasteOptions,name:w+c,iconClass:n+c,type:$n,workArea:t+le+me+o+r+M},{command:se+Jn,name:w+Jn,iconClass:n+Jn,group:w+c,text:C().pasteAll,workArea:t+le+me+o+r+M},{command:se+zn,name:w+zn,iconClass:n+zn,group:w+c,text:C().pasteFormula,workArea:t+le+me+r},{command:se+we,name:w+we,iconClass:n+we,group:w+c,text:C().pasteValues,workArea:t+le+me+r},{command:se+Kn,name:w+Kn,iconClass:n+Kn,group:w+c,text:C().pasteFormatting,workArea:t+le+me+r},{command:se+Xn,name:w+Xn,iconClass:n+Xn,group:w+c,text:C().pasteValuesFormatting,workArea:t+le+me+r},{command:se+Yn,name:w+Yn,iconClass:n+Yn,group:w+c,text:C().pasteFormulaFormatting,workArea:t+le+me+r},{text:C().pasteSpecial.title,name:d(It),command:Ye,workArea:t+le+me+r,type:"splitSubMenu",subMenu:[{text:C().paste,name:s,type:"groupHeader"},{command:se+Jn,name:d("pasteSpecial.pasteAll"),iconClass:n+Jn,group:s,text:C().pasteAll},{command:se+zn,name:d("pasteSpecial.pasteFormula"),iconClass:n+"pasteFormula",group:s,text:C().pasteFormula},{command:l.pasteFormulaAndNumberFormat,name:d("formulaAndNumberFormat"),iconClass:n+"pasteFormulaAndNumberFormat",group:s,text:C().pasteSpecial.formulaAndNumberFormat},{command:l.pasteKeepSourceFormatting,name:d("keepSourceFormatting"),iconClass:n+"pasteKeepSourceFormat",group:s,text:C().pasteSpecial.keepSourceFormatting},{command:l.pasteNoBorders,name:d("noBorders"),iconClass:n+"pasteNoBorders",group:s,text:C().pasteSpecial.noBorders},{command:l.pasteColumnWidth,name:d("keepSourceColumnWidth"),iconClass:n+"pasteColumnWidth",group:s,text:C().pasteSpecial.columnWidth},{command:l.pasteTranspose,name:d("transpose"),iconClass:n+"pasteTranspose",group:s,text:C().pasteSpecial.transpose},{text:C().pasteValues,name:Dt,type:"groupHeader"},{command:se+we,name:d("pasteSpecial.pasteValues"),iconClass:n+"pasteValues",group:Dt,text:C().pasteValues},{command:l.pasteValueAndNumberFormats,name:d("pasteValueAndNumberFormat"),iconClass:n+"pasteValueAndNumberFormats",group:Dt,text:C().pasteSpecial.valuesAndNumberFormat},{command:l.pasteValueAndSourceFormats,name:d("pasteValueAndSourceFormat"),iconClass:n+"valueAndSourceFormats",group:Dt,text:C().pasteSpecial.valueAndSourceFormat},{text:C().pasteSpecial.otherPasteOptions,name:Lt,type:"groupHeader"},{command:se+Kn,name:d("pasteSpecial.pasteFormatting"),iconClass:n+"pasteValuesFormatting",group:Lt,text:C().pasteFormatting},{command:l.pasteLink,name:d("pasteLink"),iconClass:n+"pasteLink",group:Lt,text:C().pasteSpecial.pasteLink},{type:"separator"},{command:Ye,name:d("pasteSpecial.pasteSpecial"),text:C().pasteSpecial.title}]},{text:C().paste,name:w+Bn,command:se+we,iconClass:n+c,workArea:t+le+me+r},{text:C().paste,name:w+Wn,command:se+Zn,iconClass:n+c,workArea:t+le+me+r},{type:f},{text:C().pinRows,name:w+un,command:se+un,workArea:me},{text:C().pinColumns,name:w+cn,command:se+cn,workArea:le},{type:f},{text:C().modifyColumn,name:w+le+On,command:se+On,workArea:le},{text:C().removeColumn,name:w+le+Vn,command:se+Vn,workArea:le},{text:C().setPrimaryKey,name:w+le+Nn,command:se+Nn,workArea:le},{type:f},{text:C().scrollToTasks,name:w+St,command:se+St,workArea:Ct+bt},{type:f},{text:C().insertTasks,name:w+kt,command:se+kt,workArea:Ct+bt},{text:C().deleteTasks,name:w+At,command:se+At,workArea:Ct+bt},{type:f},{text:C().indentTasks,name:w+Ot,command:se+Ot,workArea:Ct+bt},{text:C().outdentTasks,name:w+Vt,command:se+Vt,workArea:Ct+bt},{type:f},{text:C().manuallySchedule,name:w+yt,command:se+yt,workArea:Ct+bt},{text:C().autoSchedule,name:w+Tt,command:se+Tt,workArea:Ct+bt},{type:f},{text:C().hideColumn,name:w+Mt,command:se+Mt,workArea:Ft},{text:C().unhideColumn,name:w+Rt,command:se+Rt,workArea:Ft},{type:f},{text:C().promote,name:w+me+sn,command:se+sn,workArea:me},{text:C().demote,name:w+me+ln,command:se+ln,workArea:me},{type:f},{text:C().moveUp,name:w+me+vn,command:se+vn,workArea:me},{text:C().moveDown,name:w+me+hn,command:se+hn,workArea:me},{type:f},{text:C().addAfter,name:w+me+mn,command:se+mn,workArea:me},{text:C().addBefore,name:w+me+fn,command:se+fn,workArea:me},{text:C().addAbove,name:w+me+dn,command:se+dn,workArea:me},{text:C().addBelow,name:w+me+pn,command:se+pn,workArea:me},{type:f},{text:C().expandAllLevels,name:w+le+xn,command:se+xn,workArea:le},{text:C().collapseAllLevels,name:w+le+wn,command:se+wn,workArea:le},{text:C().expandLevel1,name:w+le+Cn,command:se+Cn,workArea:le},{text:C().expandLevel2,name:w+le+bn,command:se+bn,workArea:le},{text:C().expandLevel3,name:w+le+kn,command:se+kn,workArea:le},{text:C().expandLevel4,name:w+le+An,command:se+An,workArea:le},{text:C().expandLevel5,name:w+le+Sn,command:se+Sn,workArea:le},{text:C().expandLevel6,name:w+le+yn,command:se+yn,workArea:le},{text:C().expandLevel7,name:w+le+Tn,command:se+Tn,workArea:le},{text:C().expandLevel8,name:w+le+Fn,command:se+Fn,workArea:le},{text:C().expandLevel9,name:w+le+Mn,command:se+Mn,workArea:le},{type:f},{text:C().clearContents,command:se+_n,name:w+_n,workArea:t+le+me+r},{type:f},{text:C().headerInsertCopiedCells,name:w+me+ge,command:se+me+ge,workArea:me},{text:C().headerInsertCutCells,name:w+me+Ce,command:se+me+Ce,workArea:me},{text:C().headerInsertCopiedCells,name:w+le+ge,command:se+le+ge,workArea:le},{text:C().headerInsertCutCells,name:w+le+Ce,command:se+le+Ce,workArea:le},{text:C().insertCopiedCells,name:w+ge,subMenu:[{text:C().shiftCellsRight,name:w+ge+ke,command:se+ge+ke,iconClass:n+ke},{text:C().shiftCellsDown,name:w+ge+be,command:se+ge+be,iconClass:n+be}],workArea:t},{text:C().insertCutCells,name:w+Ce,subMenu:[{text:C().shiftCellsRight,name:w+Ce+ke,command:se+Ce+ke,iconClass:n+ke},{text:C().shiftCellsDown,name:w+Ce+be,command:se+Ce+be,iconClass:n+be}],workArea:t},{text:C().insertRows,name:w+xe,command:se+xe,workArea:me},{text:C().insertColumns,name:w+jn,command:se+jn,workArea:le},{text:C().deleteRows,name:w+Hn,command:se+Hn,workArea:me},{text:C().deleteColumns,name:w+Gn,command:se+Gn,workArea:le},{type:f},{text:C().tableInsert,name:w+ot,subMenu:[{text:C().tableInsertColumnsLeft,name:w+ut,command:xt,iconClass:n+ut},{text:C().tableInsertColumnsRight,name:w+ct,command:wt,iconClass:n+ct},{text:C().tableInsertRowsAbove,name:w+at,command:pt,iconClass:n+at},{text:C().tableInsertRowsBelow,name:w+it,command:vt,iconClass:n+it},{text:C().tableDeleteOrInsertEntireSheetRow,name:w+mt,command:se+xe,iconClass:n+at}],workArea:tt},{text:C().tableDelete,name:w+rt,subMenu:[{text:C().tableDeleteColumns,name:w+ft,command:gt,iconClass:n+ft},{text:C().tableDeleteRows,name:w+st,command:ht,iconClass:n+st},{text:C().tableDeleteOrInsertEntireSheetRow,name:w+lt,command:se+Hn,iconClass:n+st}],workArea:tt},{type:f},{text:C().insertSheet,name:w+En,command:se+En,workArea:R},{text:C().deleteSheet,name:w+Pn,command:se+Pn,workArea:R},{type:f},{text:C().filter,name:w+Ln,command:se+Ln,workArea:t+r},{text:C().sort,name:w+Dn,subMenu:[{text:C().sortAscend,name:w+pe,command:se+pe,iconClass:n+pe},{text:C().sortDescend,name:w+ve,command:se+ve,iconClass:n+ve}],workArea:t+r},{text:C().slicerSortAscend,name:w+et,command:se+et,iconClass:n+pe,workArea:o},{text:C().slicerSortDescend,name:w+nt,command:se+nt,iconClass:n+ve,workArea:o},{type:f},{text:C().insertComment,name:w+he,command:se+he,iconClass:n+he,workArea:t+r,needKeepFocus:!0},{text:C().editComment,name:w+de,command:se+de,iconClass:n+de,workArea:t+r,needKeepFocus:!0},{text:C().deleteComment,name:w+fe,command:se+fe,iconClass:n+fe,workArea:t+r},{text:C().toggleComment,name:w+en,command:se+en,workArea:t+r},{type:f},{text:C().hideRows,name:w+an,command:se+an,workArea:me},{text:C().unhideRows,name:w+on,command:se+on,workArea:me},{text:C().hideColumns,name:w+Un,command:se+Un,workArea:le},{text:C().unhideColumns,name:w+rn,command:se+rn,workArea:le},{type:f},{text:C().hideSheet,name:w+tn,command:se+tn,workArea:R},{text:C().unhideSheet,name:w+nn,command:se+nn,workArea:R},{type:f},{text:C().removeSlicer,name:w+$e,command:se+$e,workArea:o+M},{type:f},{text:C().sort,name:w+Dn,subMenu:[{text:C().sortAscend,name:w+pe,command:Qe,iconClass:n+pe,commandOptions:{subType:0},placeholder:L},{text:C().sortDescend,name:w+ve,command:Qe,iconClass:n+ve,commandOptions:{subType:1},placeholder:L},{text:C().pivotTableSortMoreOptions,name:w+In,command:Xe}],workArea:a+U},{text:C().pivotTableRefresh,name:g+W,command:W,iconClass:n+W,workArea:O+V+U+a+I+N},{text:C().pivotTableRemove_,name:g+K,command:K,iconClass:n+K,workArea:O+V+U+a,placeholder:D},{text:C().pivotTableRemoveGrandTotal,name:g+z,command:z,workArea:I},{text:C().pivotTableSummarizeValuesBy,name:g+P,subMenu:[{text:C().pivotTableSum,name:w+q,command:i,commandOptions:{subTotalType:8}},{text:C().pivotTableCount,name:w+Q,command:i,commandOptions:{subTotalType:1}},{text:C().pivotTableAverage,name:w+X,command:i,commandOptions:{subTotalType:0}},{text:C().pivotTableMax,name:w+Y,command:i,commandOptions:{subTotalType:3}},{text:C().pivotTableMin,name:w+$,command:i,commandOptions:{subTotalType:4}},{text:C().pivotTableProduct,name:w+ee,command:i,commandOptions:{subTotalType:5}}],workArea:V+U+I},{text:C().pivotTableShowValueAs,name:g+_,subMenu:[{text:C().pivotTableNoCalculation,name:w+ne,command:i,commandOptions:{showValueAsType:0}},{text:C().pivotTableGrandTotal,name:w+te,command:i,commandOptions:{showValueAsType:1}},{text:C().pivotTableColumnTotal,name:w+oe,command:i,commandOptions:{showValueAsType:3}},{text:C().pivotTableRowTotal,name:w+re,command:i,commandOptions:{showValueAsType:2}},{text:C().pivotTableOf,name:w+ae,command:u,commandOptions:{showValueAsType:4}},{text:C().pivotTableParentRowTotal,name:w+ie,command:i,commandOptions:{showValueAsType:5}},{text:C().pivotTableParentColumnTotal,name:w+Ne,command:i,commandOptions:{showValueAsType:6}},{text:C().pivotTableOfParentTotal,name:w+Ve,command:u,commandOptions:{showValueAsType:7}},{text:C().pivotTableDifferenceFrom,name:w+Te,command:u,commandOptions:{showValueAsType:8}},{text:C().pivotTablePercentDifferenceFrom,name:w+Fe,command:u,commandOptions:{showValueAsType:9}},{text:C().pivotTableRunningTotalIN,name:w+Me,command:u,commandOptions:{showValueAsType:10}},{text:C().pivotTablePercentRunningTotalIn,name:w+Re,command:u,commandOptions:{showValueAsType:11}},{text:C().pivotTableRankSmallestToLargest,name:w+Oe,command:u,commandOptions:{showValueAsType:12}},{text:C().pivotTableRankLargestToSmallest,name:w+Ue,command:u,commandOptions:{showValueAsType:13}},{text:C().pivotTableIndex,name:w+Ie,command:i,commandOptions:{showValueAsType:14}}],workArea:V+U},{text:C().pivotTableFilter,name:g+De,iconClass:n+De,subMenu:[{text:C().pivotTableClearFilterFrom_,name:w+Le,command:qe,iconClass:n+Le,placeholder:D,commandOptions:{clearType:0}},{text:C().pivotTableKeepOnlySelectedItems,name:w+Pe,command:Je,commandOptions:{subType:1}},{text:C().pivotTableHideSelectedItems,name:w+Ee,command:Je,commandOptions:{subType:2}},{text:C().pivotTableTop10,name:w+je,command:Ze,commandOptions:{isTop10:!0}},{text:C().pivotTableLabelFilters,name:w+He,command:ze},{text:C().pivotTableValueFilters,name:w+Ge,command:Ze}],workArea:a},{text:C().pivotTableExpandOrCollapse,name:g+E,subMenu:[{text:C().pivotTableExpand,name:w+_e,command:_e,iconClass:n+_e},{text:C().pivotTableCollapse,name:w+Be,command:Be,iconClass:n+Be},{text:C().pivotTableExpandEntireField,name:w+We,command:We,iconClass:n+We},{text:C().pivotTableCollapseEntireField,name:w+Ke,command:Ke,iconClass:n+Ke}],workArea:a},{text:C().pivotTableGroup,name:g+j,command:H,iconClass:n+j,workArea:a},{text:C().pivotTableUnGroup,name:g+G,command:G,iconClass:n+G,workArea:a},{text:C().pivotTableShowDetails,name:g+B,command:B,iconClass:n+B,workArea:U},{text:C().pivotTableValueFieldSettings,name:g+J,command:J,iconClass:n+J,workArea:V+U+I}],!1)},p.prototype.Hc=function(e){var n=this;n.iq||(n.Qy=e.commandManager(),ce(n.rq)&&(n.rq=new k.ContextMenuViewDialog(e.j2(),m(e.oM))),n.oq(e),n.aq={filter:{menuDataDict:[w+Ln],checkFunction:function(e){if(e&&e.rowFilter)return!0}},comments:{menuDataDict:[w+he,w+de,w+fe,w+en],checkFunction:function(e){if(e&&e.comments)return!0}},slicer:{menuDataDict:[w+et,w+nt,w+$e],checkFunction:function(e){if(e&&e.slicers)return!0}},floatingObject:{menuDataDict:[w+we,w+Kn,w+zn],checkFunction:function(e){var n,e,t;return!(e&&e.uq&&(e=(n=e.uq()).fromSheet)&&e.dP)||void 0}},table:{menuDataDict:[w+ot,w+rt],checkFunction:function(e){if(e&&e.tables)return!0}},tableSheet:{menuDataDict:[w+Bn,w+un,w+cn,w+On,w+Vn,w+Nn,w+sn,w+ln,w+dn,w+mn,w+fn,w+pn,w+vn,w+hn,w+xn,w+wn,w+Cn,w+bn,w+kn,w+An,w+Sn,w+yn,w+Tn,w+Fn,w+Mn],checkFunction:function(e){if(e&&e.NMi&&0===e.NMi._gi)return!0}},ganttSheet:{menuDataDict:[w+Wn,w+kt,w+At,w+Ot,w+Vt,w+St,w+yt,w+Tt],checkFunction:function(e){if(e&&e.NMi&&1===e.NMi._gi)return!0}}},n.iq=!0)},p.prototype.cq=function(e,n){var t,o,r,a,i,u,c,c,u,i,u,i,r,s,t=this;if(n.focus(),o=t.fq(e,n),ce(o))T(e);else if((r=(0,ue.jf)(n))&&r.options.disableContextMenu&&o.worksheetHitInfo)T(e);else{if(r){if(i=r.getActiveRowIndex(),u=r.getActiveColumnIndex(),ue.Worksheet.et(r,"preProcessContextMenu",c={r:!1,hitInfo:o}),c.r)return;if(r.isEditing()&&o.worksheetHitInfo&&o.worksheetHitInfo.col===u&&o.worksheetHitInfo.row===i||n.getTab()&&n.getTab().Og)return}t.Hc(n),t.lq(o,n),(r=(0,ue.jf)(n))&&(c=r.getSelections()[0],ce(c)||ce(r.pivotTables)||(u=r.floatingObjects&&r.floatingObjects.all().some(function(e){return e.isSelected()}),i=r.shapes&&r.shapes.all().some(function(e){return e.isSelected()}),u)||i||(u=r.pivotTables.findPivotTable(c.row,c.col),!ce(u)&&o.worksheetHitInfo&&(i=(o.worksheetHitInfo.pivotTableInfo=u).getPivotInfoImp(c.row,c.col,!1,!1,!0),ce(i)||(o.worksheetHitInfo.pivotTableCellInfo=i)))),r=t.hq(t.menuData,o,n),(s=t.onOpenMenu(t.menuData,r,o,n))||(T(e),r.length&&t.dq(r,o,n),t.onMenuOpened())}},p.prototype.lq=function(e,n){var t=this;t.rq.QX(e)&&t.vq(e,n)},p.prototype.vq=function(e,n){var t,o,t=this,o=(0,ue.jf)(n);o&&o.isEditing()&&o.endEdit(void 0,!1),t.mq(e)?t.gq(e,n):t.pq(e)&&t.bq(e,n)},p.prototype.pq=function(e){return!!e.worksheetHitInfo},p.prototype.yq=function(e,n,t,o){var r=!0,a,i;if(1===o){for(a=0;a<e.length;a++)-1===(i=e[a]).row&&t>=i.col&&t<i.col+i.colCount&&(r=!1);return r}if(2===o){for(a=0;a<e.length;a++)-1===(i=e[a]).col&&n>=i.row&&n<i.row+i.rowCount&&(r=!1);return r}for(a=0;a<e.length;a++)if((i=e[a]).contains(n,t))return!1;return!0},p.prototype.mq=function(e){return!(!e.tabStripHitInfo||!e.tabStripHitInfo.sheetTab)},p.prototype.wq=function(e){return e.tabStripHitInfo.sheetTab.sheetName},p.prototype.Mq=function(e){return e.tabStripHitInfo.sheetTab.sheetIndex},p.prototype.bq=function(e,n){var t,n,e,t=this,n=(0,ue.jf)(n),e=e.worksheetHitInfo;e.floatingObjectHitInfo||e.commentHitInfo||e.shapeHitInfo||(t.kk(n,e),t.Cq(n))},p.prototype.Cq=function(e){var n,t,e,n,n=e.getActiveRowIndex(),t=e.getActiveColumnIndex(),e=e.comments;e&&(n=e.get(n,t))&&e.PW===n&&e.NK(n)},p.prototype.Sq=function(e){return 3===e.hitTestType},p.prototype.PA=function(e,n,t){e.PA&&e.PA(n,t)},p.prototype.kk=function(e,n){var t,o,r,a,i,u,t,o,t=this,o=e.Ut.getSelections(),r=n.row,a=n.col;e.JA(n.rowViewportIndex<0?-1:n.row,n.colViewportIndex<0?-1:n.col)&&(i=!1,t.yq(o,r,a,n.hitTestType)?i=!0:0<(t=(u=e.shapes&&e.shapes.all()||[]).filter(function(e){return e.isSelected()})).length&&(t.forEach(function(e){return e.isSelected(!1)}),i=!0),i)&&((o=e.rt).kk(e,n,r,a),o.X9())},p.prototype.gq=function(e,n){var t,o,r,a,i,u,c,s,l,m,f,t=this.Mq(e),o=n.e2(t);if(o){if(o.b2()){for(i=[],u=a=0,c=(r=n.qv()).length;u<c;u++)(s=r[u]).b2()&&(a++,ce(s._gi)||i.push(s));if(1<a)for(l=0,m=i.length;l<m;l++)(f=i[l]).b2(!1,!0)}else(r=n.qv()).forEach(function(e){e.b2()&&e.b2(!1,!0)}),o.b2(!0,!0);n.I2(t,2,!1,!0),this.Tq(this.menuData,e,n)}},p.prototype.fq=function(e,n){var t,o,e,t=n.wM(),o=e.pageX-t.left,e=e.pageY-t.top;return n.hitTest(o=0<=o?o:1,e=0<=e?e:1,!0)},p.prototype.onOpenMenu=function(e,n,t,o){},p.prototype.onMenuOpened=function(){},p.prototype.dq=function(e,n,t){var o=this;o.rq.QX(n)&&(o.Aq(),t.iy(),o.Iq(e,n,t))},p.prototype.Aq=function(){this.rq.close()},p.prototype.Iq=function(e,n,t){var o,r,a,n,o=this,r=t.uC(),a=n.x,n=n.y;a-=r.left,n-=r.top,o.rq.rQ(o.menuView,e,a,n,t)},p.prototype.hq=function(e,n,t){var o,r,e,o=this,r={};return m.extend(!0,r,e),e=o.xq(r,n,t),o.Nq(e,n),o.kq(e,t),o.Dq(e,t),o._q(e,t,n),o.Eq(e),o.Oq(e),e=(0,y.filterReportSheetMenuItems)(e,t,n),e=o.jq(e)},p.prototype.xq=function(e,i,u){var c,s,l,c=this,s=[],l=Object.keys(Et);return m.each(e,function(e,n){var t,o,r,a;if(!ce(n))for(n.type===f&&s.push(n),t=0;t<l.length;t++)if(o=l[t],(r=Et[o])(i,u,n)&&(a=c.Rq(n,i)))return void s.push(n)}),s},p.prototype.Bq=function(e,n,t){var o,r,a,i,u,c,s,l,m,f,d,p,v,h,r,h,x,o=t.placeholder,r=t.name,a=n.area,i=n.value,u=n.menuArea,c=n.colHeadFieldInfo,s=n.rowInfos,l=n.colInfos,m=n.cornerFieldInfo,f=n.activeRowFieldInfo,d=n.activeColFieldInfo;if(ce(o))r===w+He&&(r=f&&f.name||d&&d.name||c&&c.fieldName||m&&m.fieldName,h=e.dh,x=r&&h.getFieldInfoByName(r)&&2===h.getFieldInfoByName(r).W5)&&(t.text=C().pivotTableLabelFilters_Date);else if(o===D){if(p=void 0,0===u)p=n.pageFieldInfo.fieldName;else if(2===a&&2===u){if(c)p=c.fieldName;else if(p=d&&d.name,ce(p)){for(v=d.index;0<=v&&l[v]&&ce(l[v].itemName);)v-=1;p=l[v].fieldName}}else if(3===a&&2===u){if(p=f&&f.name,ce(p)){for(v=f.index;0<=v&&s[v]&&ce(s[v].itemName);)v-=1;p=s[v].fieldName}}else 1===a?1===u?p=n.value:2===u&&m&&(p=m.fieldName):4===u&&(p=n.valueFieldName,2===a?p=d&&d.name||i:3===a&&(p=f&&f.name||i));t.text=t.text.replace("{0}",'"'+p+'"')}else o===L&&4===u&&(p=void 0,0===(h=t.commandOptions.subType)?p=C().pivotTableSortAscend:1===h&&(p=C().pivotTableSortDescend),t.text=p);ce(t.commandOptions)&&(t.commandOptions={}),t.commandOptions.pivotTableName=e.name(),t.commandOptions.pivotTableCellInfo=n},p.prototype.Oq=function(e){for(var n,t,o,r,n=0,t=!1,o=0;o<e.length&&((r=e[o].name)!==w+me+ge&&r!==w+me+Ce&&r!==w+le+ge&&r!==w+le+Ce||(t=!0),r!==w+xe&&r!==w+jn||(n=o,!t));o++);t&&e.splice(n,1)},p.prototype.Nq=function(e,n){var n,t,n=n.worksheetHitInfo,t;!n||n.row!==Ae&&n.col!==Ae||e.splice(0,e.length)},p.prototype.kq=function(a,e){var i,u,e,i=this,u=(0,ue.jf)(e),e=i.aq;return m.each(e,function(e,n){var t,o,r;if(!n.checkFunction(u))for(o=0,r=(t=n.menuDataDict).length;o<r;o++)i.Lq(a,t[o],function(e,n){e[n]=null})}),a},p.prototype.Rq=function(e,n){var t,o,r,n,a,i,u,c,s,l,m,f,d,p,v,h,x,t=this,o=n.worksheetHitInfo&&n.worksheetHitInfo.pivotTableInfo;if(o&&(r=n.worksheetHitInfo&&n.worksheetHitInfo.pivotTableCellInfo)){if(n=o.options.subtotalsPosition,a=r.value,i=r.area,u=r.menuArea,c=r.cornerFieldInfo,s=r.colHeadFieldInfo,l=r.activeRowFieldInfo,m=r.activeColFieldInfo,f=r.rowInfos,d=r.colInfos,p=r.valueFieldName,-1<(v=[g+E,g+De,g+B]).indexOf(e.name)&&((2===i||3===i)&&4===u||(!ce(c)||!ce(s))&&a===C().sigmaValueTemp||3===i&&l&&f[l.index].isSubtotal&&void 0===f[l.index].collapseIndex&&1!==n||2===i&&m&&d[m.index].isSubtotal&&void 0===d[m.index].collapseIndex&&1!==n))return!1;if(-1<(h=[g+j,g+G]).indexOf(e.name)&&(!ce(c)||!ce(s)))return!1;if(-1<(x=[g+J,g+K,g+P,g+_]).indexOf(e.name)&&ce(p)&&4===u&&4===i)return!1;e&&e.subMenu?e.subMenu.forEach(function(e){t.Bq(o,r,e),t.Fq(o,r,e)}):t.Bq(o,r,e)}return!0},p.prototype.Fq=function(e,n,t){var o,r,a,i,n,o,r,u,c,n,e,s,l,m,f,m,o=n.activeRowFieldInfo,r=n.activeColFieldInfo,a=n.cornerFieldInfo,i=n.colHeadFieldInfo,n=n.valueFieldName,o=o&&o.name||r&&r.name||i&&i.fieldName||a&&a.fieldName||n,r=e.dh,u=o&&r.getFieldInfoByName(o),c=r.K;switch(t.commandOptions&&u&&(n=t.commandOptions.showValueAsType,e=t.commandOptions.subTotalType,ce(n)||(s=u.Or&&u.Or.showDataAs||0)===n&&(t.iconClass=F),ce(e)||(l=u.getSubTotalType())===e&&(t.iconClass=F)),t.name){case w+Le:f=!1,(m=c.Pq[u.a])&&m.C()&&(f=!0),m=!!m&&m.on(),f||m||(t.disable=!0);break;case w+Pe:case w+Ee:ce(a)&&ce(i)||(t.disable=!0)}},p.prototype.Dq=function(e,n){var n,t,r,a,i,n=(0,ue.jf)(n),t=n&&n.getSelections();t&&0<t.length&&(r=co(n,t[0]),a=n.getActiveRowIndex(),i=n.getActiveColumnIndex(),r)&&m.each(e,function(e,n){var t,o;ce(n)||(n.name===w+ot?(t=n.subMenu,(o=r.rowFilter()).isFiltered()?r.checkTableLastRow(a)?t.splice(2,2):t.splice(2,1):(t.splice(4,1),r.checkTableLastRow(a)&&t.splice(3,1)),r.checkTableLastCol(i)&&t.splice(1,1)):n.name===w+rt&&(t=n.subMenu,(o=r.rowFilter()).isFiltered()?t.splice(1,1):t.splice(2,1)))})},p.prototype.Eq=function(e){for(var n,t,o,n=this,o,t=e.length-1;0<=t;t--)e[t]?e[t].subMenu&&n.Eq(e[t].subMenu):e.splice(t,1);return e},p.prototype.jq=function(e){for(var n,t,o,r,a,i,u,n=[],o=e.length,t=0;t<o;t++)e[t]&&e[t].type===f&&e[t+1]&&e[t+1].type===f||n.push(e[t]);for(o=n.length,u=i=!(a=r=0),t=0;t<o&&(i&&n[t].type===f?r++:i=!1,u&&n[o-1-t].type===f?a++:u=!1,i||u);t++);return n.splice(o-a,a),n.splice(0,r),n},p.prototype._q=function(e,n,t){var o=this;o.Gq(e,n,t),o.Uq(e,n)},p.prototype.Gq=function(e,n,t){for(var o,r,a,i,u,c,o,r=this,a=(0,ue.jf)(n),i=a&&a.tables,u=a&&a.NMi,c=0;c<e.length;c++)if(e[c]){switch(e[c].name){case w+xe:a.rR()||(e[c].disable=!0),a.isActualProtected()&&!a.options.protectionOptions.allowInsertRows&&(e[c].disable=!0);break;case w+Hn:a.rR()||(e[c].disable=!0),a.isActualProtected()&&!a.options.protectionOptions.allowDeleteRows&&(e[c].disable=!0),i&&i.containTableHeaderTotalRowForSheet()&&(e[c].disable=!0);break;case w+jn:a.oR()||(e[c].disable=!0),a.isActualProtected()&&!a.options.protectionOptions.allowInsertColumns&&(e[c].disable=!0);break;case w+Gn:a.oR()||(e[c].disable=!0),a.isActualProtected()&&!a.options.protectionOptions.allowDeleteColumns&&(e[c].disable=!0);break;case w+at:i&&(i.isAcrossTables()||i.containTableHeader()||i.noRoomToInsertRow())&&(e[c].disable=!0);break;case w+it:i&&(i.isAcrossTables()||i.noRoomToInsertRow())&&(e[c].disable=!0);break;case w+st:i&&(i.checkTableRow()||i.isAcrossTables()||i.containTableHeaderTotalRow())&&(e[c].disable=!0);break;case w+ut:case w+ct:i&&(i.isAcrossTables()||i.noRoomToInsertColumn())&&(e[c].disable=!0);break;case w+ft:i&&(i.checkTableCol()||i.isAcrossTables()||i.isWholeTableCol())&&(e[c].disable=!0);break;case w+le+On:case w+le+Vn:case w+le+Nn:u&&(o=null==(o=null==t?void 0:t.worksheetHitInfo)?void 0:o.col,e[c].disable=u.xRe(o));break;case w+cn:u&&(e[c].disable=!u.enablePinColumn());break;case w+un:u&&(e[c].disable=!u.enablePinRow())}e[c]&&e[c].subMenu&&r.Gq(e[c].subMenu,n)}},p.prototype.Uq=function(e,n){var t,o,r,a,i,u,c,c,t=this,o=(0,ue.jf)(n),r=o&&o.isActualProtected(),a=o&&o.options.protectionOptions;if(r&&a)for(i=void 0,u=0;u<e.length;u++)if(e[u]){switch(e[u].name){case w+xe:a.allowInsertRows||(e[u].disable=!0);break;case w+jn:a.allowInsertColumns||(e[u].disable=!0);break;case w+Hn:a.allowDeleteRows||(e[u].disable=!0);break;case w+Gn:a.allowDeleteColumns||(e[u].disable=!0);break;case w+Ln:a.allowFilter||(e[u].disable=!0);break;case w+pe:case w+ve:a.allowSort||(e[u].disable=!0);break;case w+an:case w+on:case w+Un:case w+rn:o.NMi||(e[u].disable=!0);break;case w+et:case w+nt:a.allowEditObjects||e.splice(0,e.length);break;case w+he:a.allowEditObjects||(e[u]=null);break;case w+de:c=void 0,o.comments&&(c=(i=o.comments.get(o.getActiveRowIndex(),o.getActiveColumnIndex()))&&i.lockText()),!a.allowEditObjects&&c&&(e[u]=null);break;case w+fe:c=void 0,o.comments&&(c=!Xt(o.getSelections(),o)),!a.allowEditObjects&&c&&(e[u]=null);break;case w+at:case w+it:case w+ut:case w+ct:case w+st:case w+ft:e[u].disable=!0}e[u]&&e[u].subMenu&&t.Uq(e[u].subMenu,n)}},p.prototype.Tq=function(e,n,t){var n,o,r,a;if(n.tabStripHitInfo&&(n=this,o=t.qv(),r=n.Hq(w+nn))){for(a=0;a<o.length;a++)if(o[a].visible()===ue.SheetTabVisible.hidden)return void(r.disable=!1);r.disable=!0}},p.prototype.Hq=function(e){var n=this;return n.zq(n.menuData,e)},p.prototype.zq=function(e,n){var t,o,t;return this.Lq(e,n,function(e,n){o=e[n]}),o},p.prototype.Lq=function(e,n,t){for(var o,r,a,o=this,r=e.length,a=0;a<r;a++)if(!ce(e[a])){if(n===e[a].name)return void t(e,a);e[a].subMenu&&o.Lq(e[a].subMenu,n,t)}},p.prototype.Vq=function(e,n){for(var t,o,r,a,t=this,o=e.length,r=0;r<o;r++)a=e[r],ce(a)||(n(a),a.subMenu&&t.Vq(a.subMenu,n))},p.prototype.oq=function(d){var s,e,n,t,o,o,r,a,i,u,c,l,m,f,p,v,h,o,x,o,w,g,C,b,k,A,S,y,T,F,M,R,O,V,N,U,L,P,E,j,H,G,_,B,W,K,Z,z,J,q,Q,X,Y,I,$,ee,ne,te,oe,re,ae,ie;function D(e,n,t){for(var o,r,o=0;o<t;o++)-1===e.indexOf(r=n+o)&&e.push(r)}this.Yq||((s=d.commandManager()).register(se+Qn,e={canUndo:!1,execute:function(e,n){var e=(0,ue._f)(e,n.sheetName);e&&(Gt(e)?s.execute({cmd:"copyShapes",sheetName:e.name()}):s.execute({cmd:Qn,sheetName:e.name(),ignoreClipboard:!0}))}},null,!1,!1,!1,!1),s.register(se+qn,n={canUndo:!1,execute:function(e,n){var e=(0,ue._f)(e,n.sheetName);e&&(Gt(e)?s.execute({cmd:"cutShapes",sheetName:e.name()}):s.execute({cmd:qn,sheetName:e.name(),ignoreClipboard:!0}))}},null,!1,!1,!1,!1),s.register(se+Jn,t={canUndo:!1,execute:function(e,n){var e=(0,ue._f)(e,n.sheetName);e&&(e.isPasteFloatingObject&&e.isPasteFloatingObject()?s.execute({cmd:"pasteFloatingObjects",sheetName:e.name()}):e.isPasteShapes&&e.isPasteShapes()?s.execute({cmd:"pasteShapes",sheetName:e.name()}):s.execute({cmd:Bn,sheetName:e.name(),pasteOption:0}))}},null,!1,!1,!1,!1),s.register(se+ge+ke,o={canUndo:!1,execute:function(e,n){var e=(0,ue._f)(e,n.sheetName);e&&s.execute({cmd:Bn,sheetName:e.name(),pasteOption:0,shiftCells:ue.InsertShiftCell.right,isHeaderPaste:Fo(n.itemName)})}},null,!1,!1,!1,!1),s.register(se+Ce+ke,o,null,!1,!1,!1,!1),s.register(se+le+ge,o,null,!1,!1,!1,!1),s.register(se+le+Ce,o,null,!1,!1,!1,!1),s.register(se+ge+be,o={canUndo:!1,execute:function(e,n){var e=(0,ue._f)(e,n.sheetName);e&&s.execute({cmd:Bn,sheetName:e.name(),pasteOption:0,shiftCells:ue.InsertShiftCell.down,isHeaderPaste:Fo(n.itemName)})}},null,!1,!1,!1,!1),s.register(se+Ce+be,o,null,!1,!1,!1,!1),s.register(se+me+ge,o,null,!1,!1,!1,!1),s.register(se+me+Ce,o,null,!1,!1,!1,!1),s.register(se+zn,r={canUndo:!1,execute:function(e,n){var t=3;Co(e,n,s,3)}},null,!1,!1,!1,!1),s.register(se+we,a={canUndo:!1,execute:function(e,n){var t=1;Co(e,n,s,1)}},null,!1,!1,!1,!1),s.register(se+Zn,i={canUndo:!1,execute:function(e,n){var t=1;Co(e,n,s,1)}},null,!1,!1,!1,!1),s.register(se+Kn,u={canUndo:!1,execute:function(e,n){var e=(0,ue._f)(e,n.sheetName);e&&s.execute({cmd:Bn,sheetName:e.name(),pasteOption:2})}},null,!1,!1,!1,!1),s.register(se+Xn,c={canUndo:!1,execute:function(e,n){var t=4;Co(e,n,s,4)}},null,!1,!1,!1,!1),s.register(se+Yn,l={canUndo:!1,execute:function(e,n){var t=5;Co(e,n,s,5)}},null,!1,!1,!1,!1),s.register(se+_n,m={canUndo:!1,execute:function(e,n){var e=(0,ue._f)(e,n.sheetName);e&&s.execute({cmd:"clear",sheetName:e.name()})}},null,!1,!1,!1,!1),s.register(se+he,f={canUndo:!0,execute:function(p,e,n){return Se(p,e,n,function(e,n){var t,o,r,n,a,t,o,i,u,t,o,c,a,s,l,m,f,d,t=n.commentState||2,o=n.displayMode,r=n.activeRow,n=n.activeCol,a=e.comments.add(r,n,"");a&&(a.commentState(t),o&&a.displayMode(o),t=e.C0(r),o=e.S0(n),i=e.getCellRect(r,n,t,o),t=(u=e.Fi()).c9(t,o),o=a.location(),c=a.width(),a=a.height(),f=m=l=s=void 0,d=p.ib,i.y+o.y<t.y?(m=wo(e,r,i.y+o.y-t.y),s=d.Jy(e,m),d.yy(e,s.Ky,0),e.tw()):i.y+o.y+a>t.y+t.height&&(m=wo(e,r,i.y+o.y+a-(t.y+t.height)),s=d.Jy(e,m),d.yy(e,s.Ky,0),e.tw()),i.x+o.x+c>t.x+t.width)&&(f=go(e,n,i.x+o.x+c-(t.x+t.width)),l=d.rw(e,f),d.wy(e,l.iw,0),e.ow())},function(e,n){var t,o,t,o,t=n.activeRow,o=n.activeCol,t=e.comments.get(t,o);if(t)return n.displayMode=t.displayMode(),n.commentState=t.commentState(),o={sheet:e,sheetName:e.name(),comment:t,cancel:!1},e.ki(ue.Events.CommentRemoving,o),{cancel:o.cancel,comment:t}},function(e,n,t){e.ki(ue.Events.CommentRemoved,{sheet:e,sheetName:e.name(),comment:t.comment})})}},null,!1,!1,!1,!1),s.register(se+de,p={canUndo:!1,execute:function(e,n){var e,t,n,e,e=(0,ue._f)(e,n.sheetName);e&&(t=n.activeRow,n=n.activeCol,e=e.comments.get(t,n))&&e.commentState(2,!0)}},null,!1,!1,!1,!1),s.register(se+fe,v={canUndo:!0,execute:function(e,c,n){return Se(e,c,n,function(e){var n,t,o,r,a,i,u,n=c.selections,t=n.length;if(!(t<=0))for(o=0;o<t;o++)for(a=(r=n[o]).row;a<r.row+r.rowCount;a++)for(i=r.col;i<r.col+r.colCount;i++)!(u=e.comments.get(a,i))||e.isActualProtected()&&!e.options.protectionOptions.allowEditObjects&&u.locked()||s.execute({cmd:fe,sheetName:e.name(),row:u.bZ,col:u.yZ})})}},null,!1,!1,!1,!1),s.register(se+en,h={canUndo:!1,execute:function(e,n){var e,t,n,e,e=(0,ue._f)(e,n.sheetName);e&&(t=n.activeRow,n=n.activeCol,e=e.comments.get(t,n))&&(2===e.displayMode()?e.displayMode(1):e.displayMode(2))}},null,!1,!1,!1,!1),s.register(se+xe,o={canUndo:!0,execute:function(e,p,n){return p.considerAllSheets=!0,Se(e,p,n,function(e){for(var n,t,o,r,a,i,u,c,s,l,m,f,d,n=lo(p.selections),o=0;o<n.length;o++){for(t=n[o],r=e.getRange(t.row-1,0,1,t.colCount),a=[],i=0;i<r.colCount;i++)e.getCell(r.row,i).locked()||a.push(i);for(u=t.row,c=t.rowCount,e.addRows(u,c),s=0;s<a.length;s++)for(l=n[o].row;l<n[o].row+n[o].rowCount;l++)e.getCell(l,a[s]).locked(!1);if(e.tables&&0<c)for(m=e.tables.AB(u,-1,c,-1),f=0;f<m.length;f++)(d=m[f]).jj(u,c,!1,!1);fo(e,u,-1,c)}})}},null,!1,!1,!1,!1),s.register(se+"insertEntireSheetRows",o,null,!1,!1,!1,!1),s.register(se+jn,x={canUndo:!0,execute:function(e,p,n){return p.considerAllSheets=!0,Se(e,p,n,function(e){for(var n,t,o,r,a,i,u,c,s,l,m,f,d,n=mo(p.selections),o=0;o<n.length;o++){for(t=n[o],r=e.getRange(0,t.col-1,t.rowCount,1),a=[],i=0;i<r.rowCount;i++)e.getCell(i,r.col).locked()||a.push(i);for(u=t.col,c=t.colCount,e.addColumns(u,c),s=0;s<a.length;s++)for(l=u;l<u+c;l++)e.getCell(a[s],l).locked(!1);if(e.tables&&0<c)for(m=e.tables.AB(-1,u,-1,c),f=0;f<m.length;f++)(d=m[f]).Ej(u,c,!1,!1);fo(e,-1,u,c)}})}},null,!1,!1,!1,!1),s.register(se+Hn,o={canUndo:!0,execute:function(e,f,n){if(!n){var t=(0,ue._f)(e,f.sheetName);if(t.isActualProtected()&&ue.mt.wme(t))return t.jT(ue.InvalidOperationType.editProtected,t.FT()),!1}return f.considerAllSheets=!0,Se(e,f,n,function(e){for(var n,t,o,r,a,i,u,c,s,l,m,n=lo(f.selections),t=e.filterRowsVisibleInfo&&e.filterRowsVisibleInfo.rowsVisibleInfo,o=t&&0<Object.keys(t).length,r=0;r<n.length;r++)if(i=(a=n[r]).row,u=a.rowCount,c=e.getRowCount(),o)for(l=(s=Bt(a,t)).length-1;0<=l;l--)i=s[l][0],u=s[l][1],m=e.tables&&e.tables.AB(i,-1,u,-1),e.deleteRows(i,u),0<m.length&&0<c-e.getRowCount()&&(c=e.getRowCount(),so(e,m,i,u));else m=e.tables&&e.tables.AB(i,-1,u,-1),e.deleteRows(i,u),0<m.length&&0<c-e.getRowCount()&&so(e,m,i,u)})}},null,!1,!1,!1,!1),s.register(se+"deleteEntireSheetRows",o,null,!1,!1,!1,!1),s.register(se+Gn,w={canUndo:!0,execute:function(e,s,n){if(!n){var t=(0,ue._f)(e,s.sheetName);if(t.isActualProtected()&&ue.mt.wme(t))return t.jT(ue.InvalidOperationType.editProtected,t.FT()),!1}return s.considerAllSheets=!0,Se(e,s,n,function(e){for(var n,t,o,r,a,i,u,c,n=mo(s.selections),t=0;t<n.length;t++)if(o=e.getColumnCount(),r=n[t].col,a=n[t].colCount,i=void 0,e.tables&&(i=e.tables.AB(-1,r,-1,a)),e.deleteColumns(r,a),e.tables&&0<o-e.getColumnCount())for(u=0;u<i.length;u++)(c=i[u]).Ej(r,a,!0)})}},null,!1,!1,!1,!1),s.register(se+En,g={canUndo:!1,execute:function(e){var n,t,o,r,a,o,i,u,c,n=e.getActiveSheetIndex(),t=e.getActiveSheetTabIndex(),o=e.getActiveSheetTab(),r=[],a=(0,ue.jf)(e),o=o?e.bb("",o._gi):e.S2(e.T2(n)),i;e.qv().forEach(function(e){e.b2()&&r.push(e)}),r.forEach(function(e){e.b2(!1,!0)}),u={sheetName:o.name(),propertyName:"insertSheet",cancel:!1,sheetIndex:-1!==n?n:t,sheetPosition:e.getSheetPosition(o.name())},e.ki(ue.Events.SheetChanging,u),u.cancel||(e.ki(ue.Events.ActiveSheetChanging,c={oldSheet:a,newSheet:o}),0<=t?(e.yb(t,2,o),e.setActiveSheetTab(t)):e.A2(Math.max(0,n),2,o),o.b2(!0,!0),ue.Workbook.et(e,"afterContextMenuInsertSheet",{sheetOrSheetTab:o}),e.ki(ue.Events.SheetChanged,{sheetName:o.name(),propertyName:"insertSheet",sheetIndex:-1!==n?n:t,sheetPosition:e.getSheetPosition(o.name())}),e.ki(ue.Events.ActiveSheetChanged,{oldSheet:a,newSheet:o}))}},null,!1,!1,!1,!1),s.register(se+Pn,C={canUndo:!1,execute:function(r,e){var a,n,t,i,u,n,c,n,a=(0,ue.jf)(r),n=r.qv();1<n.length&&(t=[],i=[],n.forEach(function(e,n){var e,e;e.b2()&&(e=e.name(),t.push(e),e=r.Ese(e),i.push(e))}),t.length!==n.length)?1<=t.length&&(r.suspendPaint(),r.suspendCalcService(),u={oldSheet:a,cancel:!1},n=r.i4(),r.options&&r.options.saveChangesForSheet&&ue.Commands.II(n),c=[],t.forEach(function(e,n){var n,t,o,o,o,n=i[n],t=(0,ue._f)(r,e),o={sheetName:e,propertyName:"deleteSheet",cancel:!1,sheetIndex:n,sheetPosition:r.getSheetPosition(e)};t===a&&r.ki(ue.Events.ActiveSheetChanging,u),r.ki(ue.Events.SheetChanging,o),u.cancel||o.cancel||(o=r.getSheetIndex(e),!ce(o)&&0<=o?(r.m3(o,2),-1===r.getActiveSheetIndex()&&r.setActiveSheetTab(0)):(o=r.getSheetTabIndex(e),!ce(o)&&0<=o&&(r.g3(o,2),-1===r.getActiveSheetTabIndex())&&r.setActiveSheetIndex(0)),c.push(e),r.ki(ue.Events.SheetChanged,{sheetName:e,propertyName:"deleteSheet",sheetIndex:n,sheetPosition:r.getSheetPosition(e)}),o=(0,ue.jf)(r),t===a&&r.ki(ue.Events.ActiveSheetChanged,{oldSheet:t,newSheet:o}))}),e.deletedSheets=c,r.options&&r.options.saveChangesForSheet&&ue.Commands.xI(n,e),(n=(0,ue.jf)(r))&&!n.isSelected()&&n.b2(!0,!0),r.resumeCalcService(!1),r.resumePaint()):ko(a),r.undoManager().clear()}},null,!1,!1,!1,!1),s.register(se+Ln,b={canUndo:!0,execute:function(e,u,n){return Se(e,u,n,function(e){var n,t,o,r,a,i,o,n,t=u.selections[0],o=co(e,t),r=u.activeRow,a=u.activeCol;o?(i=o.range()).contains(r,a,1,1)&&(o=o.name(),s.execute({cmd:"contextmenuFilterForTable",sheetName:e.name(),cmdOption:{tableName:o,activeRow:r,activeCol:a,expectedText:e.getText(r,a)}})):e.rowFilter&&s.execute({cmd:"contextmenuFilterForSheet",sheetName:e.name(),cmdOption:{activeRow:r,activeCol:a,selection:t,expectedText:e.getText(r,a)}})})}},null,!1,!1,!1,!1),s.register(se+pe,k={canUndo:!0,execute:function(e,a,n){if(!n){var t=(0,ue._f)(e,a.sheetName);if(t.isActualProtected()&&ue.mt.wme(t))return t.jT(ue.InvalidOperationType.sort,t.FT()),!1}return Se(e,a,n,function(e){var n,t,o,t,r,r,n=a.activeCol,t=a.selections,o=co(e,t[0]),t=o?o.dataRange():t[0],r=e.TB(t,!0,null),r={sheet:e,sheetName:e.name(),col:n,ascending:!0,range:t,compareFunction:Ae,groupSort:r.groupSort,ignoreHidden:r.ignoreHidden,cancel:!1};e.ki(ue.Events.RangeSorting,r),!1===r.cancel&&(e.sortRange(t.row,t.col,t.rowCount,t.colCount,!0,[{index:n,ascending:!0,compareFunction:r.compareFunction}],{groupSort:r.groupSort,ignoreHidden:r.ignoreHidden},Ae,!!o),e.ki(ue.Events.RangeSorted,r))})}},null,!1,!1,!1,!1),s.register(se+ve,A={canUndo:!0,execute:function(e,a,n){if(!n){var t=(0,ue._f)(e,a.sheetName);if(t.isActualProtected()&&ue.mt.wme(t))return t.jT(ue.InvalidOperationType.sort,t.FT()),!1}return Se(e,a,n,function(e){var n,t,o,t,r,r,n=a.activeCol,t=a.selections,o=co(e,t[0]),t=o?o.dataRange():t[0],r=e.TB(t,!0,null),r={sheet:e,sheetName:e.name(),col:n,ascending:!1,range:t,compareFunction:Ae,groupSort:r.groupSort,ignoreHidden:r.ignoreHidden,cancel:!1};e.ki(ue.Events.RangeSorting,r),!1===r.cancel&&(e.sortRange(t.row,t.col,t.rowCount,t.colCount,!0,[{index:n,ascending:!1,compareFunction:r.compareFunction}],{groupSort:r.groupSort,ignoreHidden:r.ignoreHidden},Ae,!!o),e.ki(ue.Events.RangeSorted,r))})}},null,!1,!1,!1,!1),s.register(se+et,S={canUndo:!0,execute:function(e,n,t){return bo(e,n,t,1)}},null,!1,!1,!1,!1),s.register(se+nt,y={canUndo:!0,execute:function(e,n,t){return bo(e,n,t,2)}},null,!1,!1,!1,!1),s.register(se+un,T={canUndo:!0,execute:function(e,i,n){return Se(e,i,n,function(e){var n,t,o,r,a,n=i.selections;if(0<n.length){for(t=[],o=0,r=n;o<r.length;o++)D(t,(a=r[o]).row,a.rowCount);try{e.NMi.togglePinnedRows(t)}catch(e){return!1}}})}},null,!1,!1,!1,!1),s.register(se+cn,F={canUndo:!0,execute:function(e,i,n){return Se(e,i,n,function(e){var n,t,o,r,a,n=i.selections;if(0<n.length){for(t=[],o=0,r=n;o<r.length;o++)D(t,(a=r[o]).col,a.colCount);try{e.NMi.togglePinnedColumns(t)}catch(e){return!1}}})}},null,!1,!1,!1,!1),s.register(se+Rn,M={canUndo:!0,execute:function(e,r,n){return Se(e,r,n,function(e){try{var n=r.hitInfo.cellRect,t=n.x,o=n.y+n.height;e.NMi.AZe(t,o)}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(se+On,R={canUndo:!0,execute:function(e,i,n){return Se(e,i,n,function(e){var n,t,o,r,a,n=i.selections;if(0<n.length)try{t=n[0].col,r=(o=e.getCellRect(e.getRowCount(ue.SheetArea.colHeader)-1,t,-1)).x,a=o.y+o.height,e.NMi.AZe(r,a,t)}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(se+Vn,O={canUndo:!0,execute:function(e,t,n){return Se(e,t,n,function(e){var n=t.selections;if(0<n.length)try{return e.NMi.zA({cmd:"RemoveColumn",col:n[0].col})}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(se+Nn,V={canUndo:!0,execute:function(e,o,n){return Se(e,o,n,function(e){var n,t,n=o.selections;if(0<n.length)try{return t=n[0].col,e.NMi.zA({cmd:"ModifyColumn",col:t,column:{isPrimaryKey:!e.NMi.jOt(t)}})}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(se+kt,N={canUndo:!0,execute:function(e,n,t){return Se(e,n,t,function(e){s.execute({cmd:"ganttSheetInsertTask"})})}},null,!1,!1,!1,!1),s.register(se+At,U={canUndo:!0,execute:function(e,n,t){return Se(e,n,t,function(){return Se(e,n,t,function(){s.execute({cmd:"ganttSheetDeleteTask"})})})}},null,!1,!1,!1,!1),s.register(se+St,L={canUndo:!0,execute:function(e,n,t){return Se(e,n,t,function(e){s.execute({cmd:"ganttSheetScrollToTask"})})}},null,!1,!1,!1,!1),s.register(se+yt,P={canUndo:!0,execute:function(e,n,t){return Se(e,n,t,function(e){s.execute({cmd:"ganttSheetChangeTaskMode",taskMode:"Manual"})})}},null,!1,!1,!1,!1),s.register(se+Tt,E={canUndo:!0,execute:function(e,n,t){return Se(e,n,t,function(e){s.execute({cmd:"ganttSheetChangeTaskMode",taskMode:"Auto"})})}},null,!1,!1,!1,!1),s.register(se+Mt,j={canUndo:!0,execute:function(e,n,t){return Se(e,n,t,function(e){return To(n,e)})}},null,!1,!1,!1,!1),s.register(se+Rt,H={canUndo:!0,execute:function(e,n,t){return Se(e,n,t,function(e){return To(n,e,!0)})}},null,!1,!1,!1,!1),s.register(se+Ot,G={canUndo:!0,execute:function(e,n,t){return Se(e,n,t,function(e){s.execute({cmd:"ganttSheetIndentTasks"})})}},null,!1,!1,!1,!1),s.register(se+Vt,_={canUndo:!0,execute:function(e,n,t){return Se(e,n,t,function(e){s.execute({cmd:"ganttSheetOutdentTasks"})})}},null,!1,!1,!1,!1),s.register(se+sn,B={canUndo:!0,execute:function(e,n,t){return Se(e,n,t,function(e){try{e.NMi.promoteHierarchyLevel(n.activeRow)}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(se+ln,W={canUndo:!0,execute:function(e,n,t){return Se(e,n,t,function(e){try{e.NMi.demoteHierarchyLevel(n.activeRow)}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(se+mn,K={canUndo:!0,execute:function(e,n,t){return Se(e,n,t,function(e){try{e.NMi.addHierarchyItemAfter(n.activeRow)}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(se+fn,Z={canUndo:!0,execute:function(e,n,t){return Se(e,n,t,function(e){try{e.NMi.addHierarchyItemBefore(n.activeRow)}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(se+dn,z={canUndo:!0,execute:function(e,n,t){return Se(e,n,t,function(e){try{e.NMi.addHierarchyItemAbove(n.activeRow)}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(se+pn,J={canUndo:!0,execute:function(e,n,t){return Se(e,n,t,function(e){try{e.NMi.addHierarchyItemBelow(n.activeRow)}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(se+vn,q={canUndo:!0,execute:function(e,n,t){return Se(e,n,t,function(e){try{e.NMi.moveUp(n.activeRow)}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(se+hn,Q={canUndo:!0,execute:function(e,n,t){return Se(e,n,t,function(e){try{e.NMi.moveDown(n.activeRow)}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(se+xn,X={canUndo:!0,execute:function(e,n,t){return Se(e,n,t,function(e){try{e.NMi.expandAllHierarchyLevels()}catch(e){return!1}})}},null,!1,!1,!1,!1),s.register(se+wn,Y={canUndo:!0,execute:function(e,n,t){return Se(e,n,t,function(e){try{e.NMi.collapseAllHierarchyLevels()}catch(e){return!1}})}},null,!1,!1,!1,!1),I={canUndo:!0,execute:function(e,t,n){return Se(e,t,n,function(e){try{var n=parseInt(t.cmd.charAt((se+gn).length),10)-1;e.NMi.expandHierarchyLevel(n)}catch(e){return!1}})}},ao(9,function(e){s.register(se+gn+(e+1),I,null,!1,!1,!1,!1)}),s.register(se+dt,$={canUndo:!1,execute:function(e,n){var n,t,n,o,n=n.itemName.substr(10),t=e.ep(),n=e.getSheetPosition(n);e.w2.g2(n),(o=e.getTab()).scrollTabToActive(t,n)}},null,!1,!1,!1,!1),s.register(se+an,ee={canUndo:!0,execute:function(e,t,n){return Se(e,t,n,function(n){e.suspendCalcService(),_t(t.selections,Nt,function(e){n.setRowVisible(e,!1)}),e.resumeCalcService(!1)})}},null,!1,!1,!1,!1),s.register(se+Un,ne={canUndo:!0,execute:function(e,t,n){return Se(e,t,n,function(n){e.suspendCalcService(),_t(t.selections,Ut,function(e){n.setColumnVisible(e,!1)}),e.resumeCalcService(!1)})}},null,!1,!1,!1,!1),s.register(se+tn,te={canUndo:!1,execute:function(e){var n,t,o,r,a,i,u,c,s,l,m,l,m,t,f,f,n=0,t=e.qv();if(t.forEach(function(e){e.visible()===ue.SheetTabVisible.visible&&(n+=1)}),o=(0,ue.jf)(e),n<=1)ko(o);else{if(a=[],t.forEach(function(e){e.b2()&&a.push(e)}),n!==a.length){for(i=0;i<a.length;i++)l={sheetName:c=(u=a[i]).name(),propertyName:"isVisible",cancel:!1,sheetIndex:s=e.Ese(c),sheetPosition:e.getSheetPosition(c),oldValue:!0,newValue:!1},e.ki(ue.Events.SheetChanging,l),m={cancel:!1,oldSheet:u},c===o.name()&&e.ki(ue.Events.ActiveSheetChanging,m),l.cancel||m.cancel||(u.b2(!1,!0),jt.push(u),u.visible(!1),l=(0,ue.jf)(e),i===a.length-1&&l&&!l.isSelected()&&(r={oldValue:!1,newValue:!0,sheetName:m=l.name(),propertyName:"isSelected",cancel:!1,sheetIndex:e.Ese(m),sheetPosition:d.getSheetPosition(m)},e.ki(ue.Events.SheetChanging,r)),e.ki(ue.Events.SheetChanged,{sheetName:c,propertyName:"isVisible",sheetIndex:s,sheetPosition:e.getSheetPosition(c),oldValue:!0,newValue:!1}));f=(t=(0,ue.jf)(e))&&t.name(),r&&(r.cancel?t.Ut.qj(!1):(t.Ut.qj(!0),e&&e.w2&&e.w2.repaint(),f={oldValue:!1,newValue:!0,sheetName:f,propertyName:"isSelected",sheetIndex:e.Ese(f),sheetPosition:e.getSheetPosition(f)},e.ki(ue.Events.SheetChanged,f))),o!==t&&e.ki(ue.Events.ActiveSheetChanged,{oldSheet:o,newSheet:t})}else ko(o);e.undoManager().clear()}}},null,!1,!1,!1,!1),s.register(se+on,oe={canUndo:!0,execute:function(o,r,e){return Se(o,r,e,function(n){var e,t,e=r.selections,t=r.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;ce(t)&&(t=r.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=Wt(n,e[0])),1===e.length&&t?(n.setRowVisible(e[0].row-1,!0),n.$A(e[0].row-1)):(o.suspendCalcService(),_t(e,Nt,function(e){n.setRowVisible(e,!0),e===n.pw()&&(n.Tb=0,n.tw())}),o.resumeCalcService(!1))})}},null,!1,!1,!1,!1),s.register(se+rn,re={canUndo:!0,execute:function(o,r,e){return Se(o,r,e,function(n){var e,t,e=r.selections,t=r.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;ce(t)&&(t=r.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=Wt(n,e[0])),1===e.length&&t?(n.setColumnVisible(e[0].col-1,!0),n.o9(e[0].col-1)):(o.suspendCalcService(),_t(e,Ut,function(e){n.setColumnVisible(e,!0),e===n.Sw()&&(n.Ab=0,n.ow())}),o.resumeCalcService(!1))})}},null,!1,!1,!1,!1),s.register(se+nn,ae={canUndo:!1,execute:function(t,e){var o,n,r,a,i,e,u,o=t.qv();if(0===jt.length)for(n=0;n<o.length;n++)o[n].visible()===ue.SheetTabVisible.hidden&&(jt.push(o[n]),o[n].b2(!1));if(r=(0,ue.jf)(t),0<jt.length){if(o.forEach(function(e){e!==r&&e.b2(!1,!0)}),a=void 0,e&&!ce(e.activeSheetIndex)&&(a=o[e.activeSheetIndex]),e&&e.unhideSheetIndexes&&0<e.unhideSheetIndexes.length&&((e=e.unhideSheetIndexes).forEach(function(e){var n,n,n=o[e];!1!==(i=Ao(t,n))&&-1<(n=jt.indexOf(o[e]))&&jt.splice(n,1)}),a=a||o[e[e.length-1]]),!a){if(!(a=jt.pop()))return;if(!1===(i=Ao(t,a)))return}if(!a)return;if(!1===(u=So(t,r,a)))return;t.setActiveSheet(a.name())}(0,ue.jf)(t)!==r&&yo(t,r)}},null,!1,!1,!1,!1),s.register(se+$e,ie={canUndo:!1,execute:function(e,n){var n,t,o,r,a,n=(0,ue._f)(e,n.sheetName);if(n&&(e.suspendPaint(),t=[],o=n.slicers.all())&&!ye(o)){for(r in o)o.hasOwnProperty(r)&&(a=o[r]).isSelected()&&t.push(a.name());s.execute({cmd:"deleteSlicers",sheetName:n.name(),slicerNames:t}),e.resumePaint()}}},null,!1,!1,!1,!1),Mo(s),this.Yq=!0)},p.prototype.openAllSheetsListContextMenu=function(e,n,t,o){var r,t,r=this.menuView.maxHeight();!ce(r)&&-1!==r||this.menuView.maxHeight(400),t=this.Zq(n,t),this.Hc(n),this.lq(t,n),this.rq.jTe=ue.DialogFeatureType.sheetList,this.dq(e,t,n),this.rq.jTe=ue.DialogFeatureType.contextMenu,ce(r)?this.menuView.maxHeight(-1):this.menuView.maxHeight(r),this.menuView.Wq&&this.menuView.Wq.hU(o)},p.prototype.Zq=function(e,n){var n,t,n=this.fq(n,e),t=2;return 0===e.options.tabStripPosition&&(n.x=n.x+2,n.y=n.y-2),n},Ht=p,h.ContextMenu=Ht,ue.Workbook.ch("contextmenu",{init:function(){var e=this;e.contextMenu||(e.contextMenu=new Ht),e.contextMenu.oq(this)},setHost:function(){var n,e,n=this,e=n.Ti;n.contextMenu||(n.contextMenu=new Ht),m(e).bind("contextmenu.gcSheet",function(e){return"touch"!==e.pointerType&&n.options.allowContextMenu?n.contextMenu.cq(e,n):void 0})},dispose:function(){m(this.Ti).unbind("contextmenu.gcSheet")},onCultureChanged:function(){var e,n,t,o,e=this.contextMenu;e&&(n=e.menuData,t=e.nq(),o={},e.Vq(t,function(e){ce(e.name)||(o[e.name]=e.text)}),e.Vq(n,function(e){ce(e.name)||ce(o[e.name])||(e.text=o[e.name])}))},fromJson:function(e){var n=this.contextMenu&&this.contextMenu.menuView,t=e.contextMenu;n&&!ce(t)&&(n.Qq=e.scrollable,n.Kq=e.maxHeight)},toJson:function(e){var n=this.contextMenu&&this.contextMenu.menuView;!n||ce(n.Qq)&&ce(n.Kq)||(e.contextMenu={},e.contextMenu.scrollable=n.Qq,e.contextMenu.maxHeight=n.Kq)}})},"./dist/plugins/contextMenu/context-menu.ns.js":function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var t=t("./dist/plugins/contextMenu/context-menu.res.en.js");n.SR={en:t}},"./dist/plugins/contextMenu/context-menu.res.en.js":function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.tableDeleteColumns=n.tableDeleteOrInsertEntireSheetRow=n.tableDeleteRows=n.tableDelete=n.tableInsertColumnsRight=n.tableInsertColumnsLeft=n.tableInsertRowsBelow=n.tableInsertRowsAbove=n.tableInsert=n.removeFloatingObject=n.removeSlicer=n.toggleComment=n.deleteComment=n.editComment=n.unhideRows=n.unhideColumns=n.unhideSheet=n.hideSheet=n.hideColumns=n.hideRows=n.sortDescend=n.sortAscend=n.slicerSortDescend=n.slicerSortAscend=n.headerInsertCutCells=n.headerInsertCopiedCells=n.shiftCellsDown=n.shiftCellsRight=n.insertCutCells=n.insertCopiedCells=n.sort=n.filter=n.insertComment=n.deleteSheet=n.insertSheet=n.deleteColumns=n.deleteRows=n.insertColumns=n.insertRows=n.clearContents=n.pasteSpecial=n.pasteFormulaFormatting=n.pasteValuesFormatting=n.pasteFormatting=n.pasteValues=n.pasteFormula=n.pasteAll=n.pasteOptions=n.cut=n.copy=void 0,n.pivotTableExpand=n.pivotTableValueFilters=n.pivotTableLabelFilters_Date=n.pivotTableLabelFilters=n.pivotTableTop10=n.pivotTableHideSelectedItems=n.pivotTableKeepOnlySelectedItems=n.pivotTableClearFilterFrom_=n.pivotTableFieldSettings=n.pivotTableHideFieldList=n.pivotTableSubtotal_=n.pivotTableFilter=n.pivotTableExpandOrCollapse=n.pivotTableUnGroup=n.pivotTableGroup=n.pivotTableShowDetails=n.pivotTableIndex=n.pivotTableRankLargestToSmallest=n.pivotTableRankSmallestToLargest=n.pivotTablePercentRunningTotalIn=n.pivotTableRunningTotalIN=n.pivotTablePercentDifferenceFrom=n.pivotTableDifferenceFrom=n.pivotTableOfParentTotal=n.pivotTableParentColumnTotal=n.pivotTableParentRowTotal=n.pivotTableOf=n.pivotTableRowTotal=n.pivotTableColumnTotal=n.pivotTableGrandTotal=n.pivotTableNoCalculation=n.pivotTableShowValueAs=n.pivotTableMoreOptions=n.pivotTableDistinctCount=n.pivotTableProduct=n.pivotTableMin=n.pivotTableMax=n.pivotTableAverage=n.pivotTableCount=n.pivotTableSum=n.pivotTableSummarizeValuesBy=n.pivotTableSort=n.pivotTableNumberFormat=n.pivotTableOptions=n.pivotTableValueFieldSettings=n.pivotTableRemoveGrandTotal=n.pivotTableRemove_=n.pivotTableMove=n.pivotTableRefresh=n.hideSheetFailureInfo=void 0,n.deleteTasks=n.insertTasks=n.scrollToTasks=n.reportSheetResetCellValue=n.reportSheetSubmit=n.reportSheetDeleteRecord=n.reportSheetAddRecord=n.paste=n.expandLevel9=n.expandLevel8=n.expandLevel7=n.expandLevel6=n.expandLevel5=n.expandLevel4=n.expandLevel3=n.expandLevel2=n.expandLevel1=n.collapseAllLevels=n.expandAllLevels=n.addBelow=n.addAbove=n.addBefore=n.addAfter=n.moveDown=n.moveUp=n.demote=n.promote=n.setPrimaryKey=n.removeColumn=n.modifyColumn=n.defineColumn=n.pinColumns=n.pinRows=n.pivotTableSortMoreOptions=n.pivotTableSortDescend=n.pivotTableSortAscend=n.sigmaValueTemp=n.sigmaValue=n.pivotTableMove_ToColumns=n.pivotTableMove_ToRight=n.pivotTableMove_ToLeft=n.pivotTableMove_ToEnd=n.pivotTableMove_Down=n.pivotTableMove_Up=n.pivotTableMove_ToBeginning=n.pivotTableExpandTo_=n.pivotTableCollapseTo_=n.pivotTableCollapseEntireField=n.pivotTableExpandEntireField=n.pivotTableCollapse=void 0,n.unhideColumn=n.hideColumn=n.autoSchedule=n.manuallySchedule=n.outdentTasks=n.indentTasks=void 0,n.copy="Copy",n.cut="Cut",n.pasteOptions="Paste Options:",n.pasteAll="All",n.pasteFormula="Formulas",n.pasteValues="Values",n.pasteFormatting="Formatting",n.pasteValuesFormatting="Values&Formatting",n.pasteFormulaFormatting="Formula&Formatting",n.pasteSpecial={title:"Paste Special...",formulaAndNumberFormat:"Formula & Number Formatting",keepSourceFormatting:"Keep Source Formatting",noBorders:"No Borders",columnWidth:"Keep Source Column Widths",transpose:"Transpose",valuesAndNumberFormat:"Values & Number Formatting",valueAndSourceFormat:"Values & Source Formatting",pasteLink:"Paste Link",otherPasteOptions:"Other Paste Options"},n.clearContents="Clear Contents",n.insertRows="Insert",n.insertColumns="Insert",n.deleteRows="Delete",n.deleteColumns="Delete",n.insertSheet="Insert",n.deleteSheet="Delete",n.insertComment="Insert Comment",n.filter="Filter",n.sort="Sort",n.insertCopiedCells="Insert Copied Cells...",n.insertCutCells="Insert Cut Cells...",n.shiftCellsRight="Shift Cells Right",n.shiftCellsDown="Shift Cells Down",n.headerInsertCopiedCells="Insert Copied Cells",n.headerInsertCutCells="Insert Cut Cells",n.slicerSortAscend="Sort A to Z",n.slicerSortDescend="Sort Z to A",n.sortAscend="Sort A to Z",n.sortDescend="Sort Z to A",n.hideRows="Hide",n.hideColumns="Hide",n.hideSheet="Hide",n.unhideSheet="Unhide",n.unhideColumns="Unhide",n.unhideRows="Unhide",n.editComment="Edit Comment",n.deleteComment="Delete Comment",n.toggleComment="Show/Hide Comment",n.removeSlicer="Remove",n.removeFloatingObject="Remove",n.tableInsert="Insert",n.tableInsertRowsAbove="Table Rows Above",n.tableInsertRowsBelow="Table Row Below",n.tableInsertColumnsLeft="Table Columns to the Left",n.tableInsertColumnsRight="Table Columns to the Right",n.tableDelete="Delete",n.tableDeleteRows="Table Rows",n.tableDeleteOrInsertEntireSheetRow="Entire Sheet Row",n.tableDeleteColumns="Table Columns",n.hideSheetFailureInfo="A workbook must contain at least one visible worksheet.\nTo hide, delete or move the selected sheet(s), you must first insert a new sheet or unhide a sheet that is already hidden.",n.pivotTableRefresh="Refresh",n.pivotTableMove="Move",n.pivotTableRemove_="Remove {0}",n.pivotTableRemoveGrandTotal="Remove GrandTotal",n.pivotTableValueFieldSettings="Value Field Settings...",n.pivotTableOptions="PivotTable Options...",n.pivotTableNumberFormat="Number Format...",n.pivotTableSort="Sort",n.pivotTableSummarizeValuesBy="Summarize Values By",n.pivotTableSum="Sum",n.pivotTableCount="Count",n.pivotTableAverage="Average",n.pivotTableMax="Max",n.pivotTableMin="Min",n.pivotTableProduct="Product",n.pivotTableDistinctCount="Distinct Count",n.pivotTableMoreOptions="More Options",n.pivotTableShowValueAs="Show Value As",n.pivotTableNoCalculation="No Calculation",n.pivotTableGrandTotal="% of Grand Total",n.pivotTableColumnTotal="% of Column Total",n.pivotTableRowTotal="% of Row Total",n.pivotTableOf="% Of...",n.pivotTableParentRowTotal="% of Parent Row Total",n.pivotTableParentColumnTotal="% of Parent Column Total",n.pivotTableOfParentTotal="% of Parent Total...",n.pivotTableDifferenceFrom="Difference From...",n.pivotTablePercentDifferenceFrom="% Difference From...",n.pivotTableRunningTotalIN="Running Total In...",n.pivotTablePercentRunningTotalIn="% Running Total In...",n.pivotTableRankSmallestToLargest="Rank Smallest to Largest...",n.pivotTableRankLargestToSmallest="Rank Largest to Smallest...",n.pivotTableIndex="Index",n.pivotTableShowDetails="Show Details",n.pivotTableGroup="Group...",n.pivotTableUnGroup="Ungroup...",n.pivotTableExpandOrCollapse="Expand/Collapse",n.pivotTableFilter="Filter",n.pivotTableSubtotal_="Subtotal {0}",n.pivotTableHideFieldList="Hide Field List",n.pivotTableFieldSettings="Field Settings...",n.pivotTableClearFilterFrom_="Clear Filter From {0}",n.pivotTableKeepOnlySelectedItems="Keep Only Selected Items",n.pivotTableHideSelectedItems="Hide Selected Items",n.pivotTableTop10="Top 10...",n.pivotTableLabelFilters="Label Filters...",n.pivotTableLabelFilters_Date="Date Filters...",n.pivotTableValueFilters="Value Filters...",n.pivotTableExpand="Expand",n.pivotTableCollapse="Collapse",n.pivotTableExpandEntireField="Expand Entire Field",n.pivotTableCollapseEntireField="Collapse Entire Field",n.pivotTableCollapseTo_="Collapse to {0}",n.pivotTableExpandTo_="Expand to {0}",n.pivotTableMove_ToBeginning="Move {0} to Beginning",n.pivotTableMove_Up="Move {0} Up",n.pivotTableMove_Down="Move {0} Down",n.pivotTableMove_ToEnd="Move {0} to end",n.pivotTableMove_ToLeft="Move {0} to left",n.pivotTableMove_ToRight="Move {0} to Right",n.pivotTableMove_ToColumns="Move {0} to columns",n.sigmaValue="\u2211 Values",n.sigmaValueTemp="Values",n.pivotTableSortAscend="Sort Smallest to Largest",n.pivotTableSortDescend="Sort Largest to Smallest",n.pivotTableSortMoreOptions="More Sort Options...",n.pinRows="Pin/Unpin Rows",n.pinColumns="Pin/Unpin Columns",n.defineColumn="Define Column",n.modifyColumn="Modify Column",n.removeColumn="Remove Column",n.setPrimaryKey="Set/Unset Primary Key",n.promote="Promote",n.demote="Demote",n.moveUp="Move Up",n.moveDown="Move Down",n.addAfter="Add After",n.addBefore="Add Before",n.addAbove="Add Above",n.addBelow="Add Below",n.expandAllLevels="Expand All Levels",n.collapseAllLevels="Collapse All Levels",n.expandLevel1="Expand to Level 1",n.expandLevel2="Expand to Level 2",n.expandLevel3="Expand to Level 3",n.expandLevel4="Expand to Level 4",n.expandLevel5="Expand to Level 5",n.expandLevel6="Expand to Level 6",n.expandLevel7="Expand to Level 7",n.expandLevel8="Expand to Level 8",n.expandLevel9="Expand to Level 9",n.paste="Paste",n.reportSheetAddRecord="Add Record",n.reportSheetDeleteRecord="Delete Record",n.reportSheetSubmit="Submit",n.reportSheetResetCellValue="Reset Current Cell",n.scrollToTasks="Scroll To Task",n.insertTasks="Insert Task",n.deleteTasks="Delete Task",n.indentTasks="Indent Task",n.outdentTasks="Outdent Task",n.manuallySchedule="Manually Schedule",n.autoSchedule="Auto Schedule",n.hideColumn="Hide Column",n.unhideColumn="Unhide Column"},"./dist/plugins/contextMenu/menu-view.js":function(L,e,n){var o,l,b,m,n,w,P,E,u,g,t,i,j,k,H,G,c,s,f,_,B,W,r,K,d,a,Z,z,J,p,v,n,q,Q,X,Y,$,ee,ne,te,oe,re,ae,ie,ue,ce,se,le,h,me,x,fe,C,A,S,de,pe,ve,y,T,F,M,he,xe,R,O,V,we,ge,Ce,be,ke,Ae,Se,ye,Te,Fe,N,U,Me,Re,n;function Oe(e){return e instanceof Object}function I(e,n,t){var o=this;o.Ti=e,o.Jq=n,o.Xq(e,n,t)}function D(){}function Ve(e,n,t,o,r){var a,i,t;w(n.pivotTableName)&&(n.pivotTableName=e.name()),w(n.pivotTableCellInfo)&&(n.pivotTableCellInfo=e.getPivotInfoImp(t,o,!1,!1,!0)),"gc.spread.sortAscend"!==r&&"gc.spread.sortDescend"!==r||!e.isSortValueField(n.pivotTableCellInfo)||(a="gc.spread.sortAscend"===r?0:1,(t=(i=e.dh).Q.map(function(e){return e.Zc})).sort(function(e,n){var e=e.localeCompare(n);return 1==a?-1*e:e}),n.sortValueInfo={sortedFieldNames:t,sortType:a})}Object.defineProperty(e,"__esModule",{value:!0}),e.MenuView=void 0,o=n("Common"),l=n("Core"),b=l.GC$,m=l.mt.En,n=o.Common.lt,w=n.ht,P=n.Eh,E=n.tv,u=void 0,g=null,t=document,i=window,j=Math.max,k=Math.min,H=Math.floor,c="mouseenter",s="mouseleave",f="click",_="mousewheel",B="DOMMouseScroll",W="gc.command.executed",r=".",K="gc-ui-contextmenu",d=".gcScrollWrapper",a="-",Z="container",J="disable-hover",p="text",v="icon",n="menuitem",q="nonselective-menuitem",Q="menuitem-content",X="sup-container",Y="separator",$="sup-indicator",ee="subitems-container",ne="group-container",te="title",oe="group-header",re="groupitems-container",ae="groupitem",ie="nonexecutable",ue="executable",ce="disable",se="gcUIElement",le="gcContextMenu",h="gc-statusbar-contextmenu",me=" ui-widget",x=" ui-state-hover",fe=" ui-icon ui-icon-triangle-1-e",C="DIV",A="SPAN",S="keydown.ctx.gcSheet",pe="inline-block",ve="visible",y="hidden",T="block",F=de="none",M="overflow",he="split-item-container",xe="splitMenu-content",O=(R=function(e){return K+a+e})(z="hover"),V=R(n),we=R(q),ge=R(Q),Ce=R(ue),be=R(X),ke=R(ee),Ae=h+a+"check",Se=h+a+"check-container",ye=h+a+"content",Te=h+a+"status",Fe=12,N="splitSubMenu",(n=U=U||{})[n.up=0]="up",n[n.down=1]="down",I.prototype.Xq=function(e,n,t){var o,r,a,i,o=this,r=o.qq=b(document.createElement("DIV")),a=o.$q=document.createElement("DIV"),i=o.t$=document.createElement("DIV");r[0].className="gc-ui-contextmenu-scroll-wrapper",a.className="gc-ui-contextmenu-scroll-indicator",a.innerText=String.fromCharCode(708),i.className="gc-ui-contextmenu-scroll-indicator",i.innerText=String.fromCharCode(709),e.append(b(a)),e.append(r),r.append(n),r.height(t.height-12),e.append(b(i)),o.n$=r.height()+12,o.e$=o.i$(n),o.NK(U.up),o.aY()},I.prototype.i$=function(e){var n=0;return e[0].childNodes.forEach(function(e){n+=e.offsetHeight}),n},I.prototype.r$=function(){return this.qq},I.prototype.o$=function(e){var n=this;if(w(e))return n.qq.scrollTop();n.qq.scrollTop(e),n.a$(e)},I.prototype.hU=function(e){for(var n,t,o,r,n,t=this.Jq[0].childNodes,o=0,r=0;r<e;r++)o+=t[r].offsetHeight;this.o$(o-12)},I.prototype.aY=function(){var t=this,e=t.$q,n=t.t$,o=t.qq,r=t.n$,a=t.e$;b(e).bind(c+d,function(){t.u$=i.setInterval(function(){var e,n,e=o.scrollTop(),n;t.o$(H(e<=10?0:e-10))},100)}),b(e).bind(s+d,function(){i.clearInterval(t.u$)}),b(e).bind(f+d,function(){t.o$(0)}),b(n).bind(c+d,function(){t.u$=i.setInterval(function(){var e,n,e=o.scrollTop(),n;t.o$(a-r-10<=e?a-r+2:e+10)},100)}),b(n).bind(s+d,function(){i.clearInterval(t.u$)}),b(n).bind(f+d,function(){t.o$(a-r)}),o.bind(_+d,function(e){t.a$(o.scrollTop()+(e.deltaY||-e.wheelDelta||0))}).bind(B+d,function(e){t.a$(o.scrollTop()+(e.deltaY||-e.wheelDelta||0))})},I.prototype.KX=function(){var e=this,n=e.$q,t=e.t$,e=e.qq;b(n).unbind(d),b(t).unbind(d),e.unbind(d)},I.prototype.eG=function(){var e=this;e.KX(),e.Ti.append(e.Jq),b(e.qq).remove(),b(e.$q).remove(),b(e.t$).remove(),e.Ti=u,e.Jq=u,e.qq=u,e.$q=u,e.t$=u},I.prototype.$c=function(e){switch(e){case U.up:this.$q.style.display=T;break;case U.down:this.t$.style.display=T}},I.prototype.NK=function(e){switch(e){case U.up:this.$q.style.display=F;break;case U.down:this.t$.style.display=F}},I.prototype.a$=function(e){var n=this,t=n.n$,o=n.e$;e<1?(n.$c(U.down),n.NK(U.up),n.s$(!0)):o-t-1<e?(n.$c(U.up),n.NK(U.down),n.s$(!1)):(n.$c(U.up),n.$c(U.down),n.s$(!0))},I.prototype.s$=function(e){var n=this,t=n.qq,n=n.n$;e&&(n-=12),t.height(n)},Me=I,D.prototype.ZX=function(e,n,t,o){var r=this;r.Ti=b(e),r.c$=E(n),r.Qy=t.commandManager(),r.DJ=t,r.zX=o,r.f$=[],r.l$={},r.h$=[],r.d$={},r.JX=g,r.v$()},D.prototype.m$=function(){var e,n,t,o,r,a,i,u,c,s,l,c,s,n,m,c,f,d,p,v,h,d,f,v,p,v,x,d,e=this,n=e.g$,t=e.Ti,o=e.hostInfo;n[0].style.maxHeight="",r=parseInt(t.css("left"),10),a=parseInt(t.css("top"),10),i=t.width(),u=t.height(),(c=e.U2(u))&&(s=e.Wq=e.p$(t,n),u=e.b$()),"number"==typeof e.Kq&&(c?((l=s.r$())[0].style.maxHeight=e.Kq+"px",n.css(M,g)):(n[0].style.maxHeight=e.Kq+"px",n.css(M,y),u=n.height()+2)),s=(c=e.y$()).windowTop,n=c.windowLeft,m=c.windowWidth,c=c.windowHeight,w(o)?(h=(v=e.w$()).contextTop,d=v.contextLeft,f=v.contextWidth,v=v.contextHeight,p=h+a-Math.max(s,h),v=k(s+c,h+v)-(h+a),x=s+c-h+a,d=k(n+m,d+f)-(d+r),f<r+i?t.css("left",r=0<r-i?r-i:r):d<i&&t.css("left",r-i),v<u&&(u<=p?t.css("top",a-u):u<=p+v?t.css("top",a+v-u):x<u?t.css("top",s+c-h-u):t.css("top",s<h?0:s-h))):(o.left+r+i>n+m&&t.css("left",r=0<r-i?r-i:r),d=((f=e.DJ&&e.DJ.getHost())&&f.getBoundingClientRect().top)<o.top,p=o.top,d?u<=p+a?t.css("top",a-u):t.css("top",-p):c-p-a<u&&t.css("top",c-p-u))},D.prototype.y$=function(){return{windowTop:i.scrollY||i.pageYOffset,windowLeft:i.scrollX||i.pageXOffset,windowWidth:i.clientWidth||i.innerWidth,windowHeight:i.clientHeight||i.innerHeight}},D.prototype.w$=function(){var e,n,t,o,r,e,t,e=this;return e.DJ&&(n=(t=(e=b(e.DJ.getHost())).offset()).top,t=t.left,o=e.width(),r=e.height()),{contextTop:n,contextLeft:t,contextWidth:o,contextHeight:r}},D.prototype.p$=function(e,n){return new Me(e,n,{height:this.b$()})},D.prototype.M$=function(){var e=this,n=e.g$;"number"==typeof e.Kq&&(n[0].style.maxHeight=e.Kq+"px",n.css(M,y))},D.prototype.v$=function(){var e,n,t,n,o,e=this,n=e.c$;w(n)||!Oe(n)||n.length<1||(n instanceof Array||(n=[n]),n=e.S$(t="menuView",n),e.l$.menuView=n,o=e.A$(e.c$),e.g$=o,e.M$(),o.appendTo(e.Ti),this.Gpe(n),e.m$(),e.aY(),e.h$.push({name:t,menuView:o}))},D.prototype.Gpe=function(e){e.forEach(function(e){e.menuItemData.type===N&&(e.host=e.host.find("."+R(xe)))})},D.prototype.S$=function(e,n){for(var t,o,r,a,i,u,t=this,o=n.length,r=[],a=0;a<o;a++)i=n[a],w(i)||"separator"===i.type||(i.type===N?(u=this.convertSplitSubMenuIconData(i),t.l$[u.name]=t.S$(u.name,u.subMenu),t.l$[u.name].push(t.x$(e,u))):i.subMenu?t.l$[i.name]=t.S$(i.name,i.subMenu):"groupHeader"===i.type&&(t.I$(i,n),t.l$[i.name]=t.S$(e,i.groups)),r.push(t.x$(e,i)));return r},D.prototype.convertSplitSubMenuIconData=function(e){var n={name:e.name+"-sub",subMenu:e.subMenu,type:"splitSubMenuIcon"};return e.subMenuIcon=n,e.subMenu=void 0,n},D.prototype.x$=function(e,n){var t,o,r,r,t=this,o="groupHeader"===n.type||n.type===N?t.N$():t.k$(),r=t.createMenuItemElement(n);if(!w(r))return r instanceof HTMLElement&&(r=b(r)),w(n.itemClass)||o.addClass(n.itemClass),w(n.title)||o.attr("title",n.title),r.appendTo(o),r={name:n.name,host:o,menuItemData:n,menuName:e},this.SpreadJSDesignerAutoTest&&this.SpreadJSDesignerAutoTest(r.host,r.menuItemData),t.f$.push(r),r},D.prototype.k$=function(){var e=b(m(C));return e.addClass(V),e},D.prototype.N$=function(){var e=b(m(C));return e.addClass(we),e},D.prototype.createMenuItemElement=function(e){var n=this;switch(e.type){case"groupHeader":return n.D$(e);case"groupItem":return n._$(e);case"statusBar":return n.E$(e);case N:return n.Upe(e);case"splitSubMenuIcon":return this.Hpe(e)}return e.subMenu?n.j$(e):n.O$(e)},D.prototype.O$=function(e){var n,t,t,n=b(m(C)).addClass(ge);return e.command?e.disable?n.addClass(R(ce)):n.addClass(Ce):n.addClass(R(ie)),t=b(m(A)).addClass(R(v)),e.iconClass&&t.addClass(e.iconClass),t.appendTo(n),e.text&&((t=b(m(A)).addClass(R(p)))[0].innerHTML=o.Common.zf.j0(e.text),t.appendTo(n)),n},D.prototype.B$=function(e){return b(m(C)).addClass(R(Y))},D.prototype.D$=function(e){var n,t,o,r,a,i,u,c,s,n=this,t=b(m(C)).addClass(R(ne));if(!(e.groups.length<=0)){for((o=n.O$(e)).addClass(R(oe)),o.appendTo(t),r=b(m(C)).addClass(R(re)),i=(a=e.groups).length,u=0;u<i;u++)(s=(c=n.L$("name",a[u].name)).host).addClass(R(ae)),s.appendTo(r);r.appendTo(t)}return t},D.prototype._$=function(e){var n,t,o,n,t=this.O$(e),o;return t.find(r+R(p)).remove(),t.attr(te,e.text),t},D.prototype.E$=function(e){var n,t,o,r,e,a,i,a,o,n=m("div"),t=b(n).addClass(ge),o=e.visible,r=e.menuContent,e=e.status,a=m("div");return b(a).addClass(Ae),i=m("div"),b(i).addClass(Se),i.appendChild(a),i.style.visibility=o?ve:y,(a=m("div")).innerText=r,b(a).addClass(ye),o=m("div"),b(o).addClass(Te),e?(o.innerText=e,o.style.display=pe):o.style.display=de,n.appendChild(i),n.appendChild(a),n.appendChild(o),t},D.prototype.j$=function(e,n){var t,o,r,a,i,u,t=this,o=b(m(C)).addClass(be),r=t.O$(e);return 0<e.subMenu.length&&((a=b(m(A)).addClass(R($+fe))).appendTo(r),i=t.A$(e.subMenu),u=b(m(C)).addClass(ke),n&&u.addClass(n),i.appendTo(u),u.appendTo(t.Ti),t.d$[e.name]=u),r.appendTo(o),o},D.prototype.Hpe=function(e){var n,e,n,e=this.j$(e,R("split-sub-menu"));return e.addClass(R("splitMenu-icon")),e.find("."+R(v)).remove(),e},D.prototype.Upe=function(e){var n,t,o,r,n=this,t=b(m(C)).addClass(R("splitMenu-container"));return e.subMenuIcon&&((o=n.O$(e)).addClass(R(xe)).addClass(V),o.appendTo(t),(r=n.L$("name",e.subMenuIcon.name)).host.appendTo(t)),t},D.prototype.A$=function(e){for(var n,t,o,r,a,i,i,u,n=this,t=b(m(C)).addClass(R(Z+me)),o=e.length,r=0;r<o;r++)w(e[r])||(a=e[r].name,w(a)?"separator"===e[r].type&&(i=n.N$(),(u=n.B$(e[r])).appendTo(i),i.appendTo(t)):(i=n.L$("name",a),w(i)||i.host.appendTo(t)));return t},D.prototype.L$=function(e,n){for(var t,o,r,a,t,o=this.f$,r=o.length,a=0;a<r;a++)if(n instanceof b?n[0]===o[a][e][0]:o[a][e]===n)return o[a]},D.prototype.I$=function(e,n){var t,o,r;for(e.groups=[],t=n.length,o=0;o<t;o++)(r=n[o])&&r.group&&r.group===e.name&&(r.type="groupItem",e.groups.push(r),n.splice(o,1),o--)},D.prototype.aY=function(){var a=this;b(r+V).bind(c,function(){var e,n,t,o,r,e=b(this),n=a.L$("host",e);for(a.JX=n,o=0,r=(t=a.h$).length;o<r&&n.menuName!==a.h$[r-o-1].name;o++)a.F$();a.P$(),a.G$(!1)}).bind(s,function(){a.JX=g,a.P$()}).bind(f,function(e){var n,n,t,n=b(this),n=a.L$("host",n);a.JX=n,(t=a.U$(!1,e))&&a.lQ()}),b(t).bind(S,function(e){var n,t,t;if(!e.target||b(e.target).attr(se)!==le){switch(e.keyCode){case 27:(n=a.F$())||a.lQ();break;case 32:case 13:(n=a.U$(!0,e))&&a.lQ();break;case 9:e.shiftKey?a.H$(!1,!0):a.H$(!0,!0);break;case 37:t=a.F$(),(t=a.L$("name",t))&&(a.JX=t),a.JX&&a.JX.menuItemData.group&&a.H$(!1,!0);break;case 38:a.H$(!1,!1);break;case 39:a.JX&&a.JX.menuItemData.group&&a.H$(!0,!0),a.G$(!0);break;case 40:a.H$(!0,!1)}e.preventDefault?e.preventDefault():e.returnValue=!1}})},D.prototype.z$=function(e,n){var t,o,r,a,i,o,u,c,s,l,u,m,f,d,n,f,p,v,h,x,v,w,d,s,l,g,a,C,t=this,o=t.w$(),r=o.contextTop,a=o.contextLeft,i=o.contextWidth,o=o.contextHeight,u=t.y$(),c=u.windowTop,s=u.windowLeft,l=u.windowWidth,u=u.windowHeight,m=n.parentRelatedLeft,f=n.parentRelatedTop,d=n.parentAbsoluteLeft,n=n.parentWidth;return e.css("top",f+2),f=e.width(),p=e.height(),v=e.position(),x=(h=e.offset()).top,v=v.top,d+n+f>k(s+l,a+i)?e.css("left",m-f-1):e.css("left",m+n),d=t.V$(),(s=t.U2(p))&&(l=b(e[0].firstChild),w=t.p$(e,l),p=t.b$()),"number"==typeof t.Kq&&(s?(g=w.r$())[0].style.maxHeight=t.Kq+"px":(e[0].style.maxHeight=t.Kq+"px",e.css(M,y),p=e.height())),(C=(a=k(c+u,r+o))-x)<p&&(d<p?e.css("top",c<r?0:c-r):e.css("top",v+a-x-p)),w},D.prototype.Y$=function(e){return e.command},D.prototype.getCommandOptions=function(e,n,t){},D.prototype.U$=function(e,n){var t,o,o,t=this,o=t.JX;if(o&&!o.menuItemData.disable){if(!(o=o.menuItemData).subMenu)return t.zA(n),!0;0<o.subMenu.length&&t.G$(e)}},D.prototype.zA=function(e){var n,t,o,e,r,n,a,i,u,c,s,e,n=this,t=n.JX,o=n.Y$(t.menuItemData);w(o)||(e=n.getCommandOptions(t.menuItemData,t.host[0],e),r=n.Qy,P(o)?o(n.DJ,e):(a=(n=(0,l.jf)(n.DJ))&&n.getActiveColumnIndex(),i=n&&n.getActiveRowIndex(),u=n&&n.tables&&n.tables.find(i,a),c=n&&n.pivotTables&&n.pivotTables.findPivotTable(i,a),s=t.menuItemData.name,w(c)?r.execute({cmd:o,sheetName:n&&n.name(),selections:n&&n.getSelections(),activeRow:i,activeCol:a,commandOptions:e,tableName:u?u.name():"",itemName:s}):(e=t.menuItemData.commandOptions,Ve(c,e=w(e)?{}:e,i,a,s),r.execute({cmd:o,sheetName:n.name(),selections:n.getSelections(),activeRow:i,activeCol:a,commandOptions:e,itemName:s}))))},D.prototype.KX=function(){b(r+V).unbind(c).unbind(s).unbind(f),b(t).unbind(S)},D.prototype.L0=function(){var e=this;e.Ti=g,e.c$=g,e.Qy=g,e.DJ=g,e.zX=g,e.f$=g,e.l$=g,e.JX=g,e.g$=g,e.d$=g,e.Wq&&(e.Wq.eG(),e.Wq=u),e.KX()},D.prototype.F$=function(){var e,e,n,t,e=this;if(1<e.h$.length)return(t=(n=(e=e.h$.pop()).menuView).find(r+V)).removeClass(O+x),e.menuView.hide(),e.subMenuWrapper&&(e.subMenuWrapper.eG(),e.subMenuWrapper=u),e.name},D.prototype.P$=function(){var e,n,t,o,r,e=this,n=e.Z$(!0);if(n){for(t=0,o=n.length;t<o;t++)n[t].host.removeClass(O+x);e.JX&&((r=e.JX.menuItemData).disable?e.JX.host.addClass(R(J+x)):e.JX.host.addClass(O+x))}},D.prototype.lQ=function(){var e=this;e.zX.trigger(W),e.L0()},D.prototype.H$=function(e,n){var t,n,o,r,r,r,e,r,a,t,n,i,t=this,n=t.Z$(n);t.JX&&!(o=t.W$(t.JX,n))&&(r=t.l$[t.JX.menuItemData.group])&&(r=r[0],o=t.W$(r,n)),o=e?"number"==typeof(o=o!==u&&o!==n.length-1?o:-1)?o+1:0:"number"==typeof(o=o!==u&&0!==o?o:n.length)?o-1:0,t.JX=n[o],t.P$(),r=t.h$[t.h$.length-1],e=n.length,(r=r&&("menuView"===r.name?t.Wq:r.subMenuWrapper))&&(n=(t=(a=r.o$())+t.JX.host.position().top)+n[o].host.height()+2,i=r.r$().height(),t<a+12?0===o?r.o$(0):r.o$(t-12):a+i<n&&(o===e-1?r.o$(r.r$().height()):r.o$(t-12),r.o$(n-i)))},D.prototype.Z$=function(e){for(var n,t,o,r,a,i,u,n=this,t=n.h$[n.h$.length-1].name,o=n.l$[t],r=[],a=0;a<o.length;a++)if("groupHeader"===o[a].menuItemData.type)if(i=n.l$[o[a].menuItemData.name],e)for(u=0;u<i.length;u++)r.push(i[u]);else r.push(i[0]);else r.push(o[a]);return r},D.prototype.W$=function(e,n){for(var t,o,t=n.length,o=0;o<t;o++)if(e.name===n[o].name)return o},D.prototype.G$=function(e){var n,t,o,r,a,t,i,u,c,c,n=this,t=n.JX;t&&(o=t.menuItemData).subMenu&&0<o.subMenu.length&&(o.name!==n.h$[n.h$.length-1].name&&((r=n.d$[o.name]).show(),a=t.host,t=n.d$[t.menuName],i=a.offset(),u=a.position(),c=t&&t.position(),c=n.z$(r,{parentRelatedLeft:(c||u).left,parentRelatedTop:c?u.top+c.top:u.top,parentAbsoluteLeft:i.left,parentWidth:t?t.width():a.width()+3}),n.h$.push({name:o.name,menuView:r,subMenuWrapper:c})),n.JX=g,e)&&n.H$(!0,!1)},D.prototype.b$=function(){var e=this,n=e.V$();return n="number"==typeof e.Kq&&!1!==e.Qq?k(n,e.Kq):n},D.prototype.V$=function(){var e,n,t,o,t,e,r,e,e=this,n=e.hostInfo,t=e.w$(),o=t.contextTop,t=t.contextHeight,e=e.y$(),r=e.windowTop,e=e.windowHeight;return n?e:k(r+e,o+t)-j(r,o)},D.prototype.U2=function(e){var n,t,n=this;return!1!==n.Qq&&((t=n.b$())<e||void 0)},D.prototype.scrollable=function(e){var n=this;if(w(e))return n.Qq;n.Qq=e},D.prototype.maxHeight=function(e){var n=this;if(w(e))return n.Kq;(n.Kq=e)<0&&(n.Kq=void 0)},D.prototype.getHost=function(){return this.Ti},e.MenuView=D},"./dist/plugins/contextMenu/menuItems/helpers/utils.js":function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.VIEWPORT=n.ICON_CLASS_PREFIX=void 0,n.ICON_CLASS_PREFIX="gc-spread-",n.VIEWPORT="viewport"},"./dist/plugins/contextMenu/menuItems/index.js":function(e,n,t){var o,r,o=this&&this.__createBinding||(Object.create?function(e,n,t,o){void 0===o&&(o=t);var r=Object.getOwnPropertyDescriptor(n,t);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(e,o,r)}:function(e,n,t,o){e[o=void 0===o?t:o]=n[t]}),r=this&&this.__exportStar||function(e,n){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(n,t)||o(n,e,t)};Object.defineProperty(n,"__esModule",{value:!0}),r(t("./dist/plugins/contextMenu/menuItems/report-sheet.js"),n)},"./dist/plugins/contextMenu/menuItems/report-sheet.js":function(e,n,t){var v,o,h;function r(n){return["".concat(h,"AddRecord"),"".concat(h,"DeleteRecord"),"".concat(h,"Submit"),"".concat(h,"ResetCellValue")].map(function(e){return{text:n[e],name:e,command:e,iconClass:o.ICON_CLASS_PREFIX+e,workArea:o.VIEWPORT}})}function a(e,n,t){var n,o,r,a,i,u,c,s,l,m,f,s,t,d,r,p,n=n.getActiveSheetTab(),o;if(n&&n._gi===v.SheetType.reportSheet){if(c=u=i=a=r=void 0,t.worksheetHitInfo&&(r=n.isExpandable(t.worksheetHitInfo.row,t.worksheetHitInfo.col),a=n.internalIsDirtyCell(t.worksheetHitInfo.row,t.worksheetHitInfo.col),c=n.internalCellIsProtected(t.worksheetHitInfo.row,t.worksheetHitInfo.col),i=(s=n.getTemplate().getDataEntrySetting())&&s.length,u=-1===t.worksheetHitInfo.rowViewportIndex?v.SheetArea.colHeader:-1===t.worksheetHitInfo.colViewportIndex?v.SheetArea.rowHeader:v.SheetArea.viewport),r){if(c)for(l=0,m=e;l<m.length;l++)(f=m[l]).name!=="".concat(h,"AddRecord")&&f.name!=="".concat(h,"DeleteRecord")||(f.disable=!0)}else e=e.filter(function(n){return!n.name||!["AddRecord","DeleteRecord"].find(function(e){return n.name==="".concat(h).concat(e)})});return a||(s=e.find(function(e){return e.name==="".concat(h,"ResetCellValue")}))&&(s.disable=!0),i&&n.isDirty()||(t=e.find(function(e){return e.name==="".concat(h,"Submit")}))&&(t.disable=!0),d=["gc.spread.filter","gc.spread.sort","gc.spread.insertComment"],r=e.filter(function(e){return!e.name||!d.includes(e.name)}),u!==v.SheetArea.rowHeader&&u!==v.SheetArea.colHeader||(p=["gc.spread.insertRows","gc.spread.deleteRows","gc.spread.hideRows","gc.spread.unhideRows","gc.spread.insertColumns","gc.spread.deleteColumns","gc.spread.hideColumns","gc.spread.unhideColumns","gc.spread.colHeaderinsertCopiedCells","gc.spread.rowHeaderinsertCopiedCells","gc.spread.colHeaderinsertCutCells","gc.spread.rowHeaderinsertCutCells"],r=r.filter(function(e){return!e.name||!p.includes(e.name)})),r}return e.filter(function(e){return!e.name||0!==e.name.indexOf(h)})}Object.defineProperty(n,"__esModule",{value:!0}),n.filterReportSheetMenuItems=n.createReportSheetMenuItems=void 0,v=t("Core"),o=t("./dist/plugins/contextMenu/menuItems/helpers/utils.js"),h="reportSheet",n.createReportSheetMenuItems=r,n.filterReportSheetMenuItems=a},Common:function(e){e.exports=GC.Spread},Core:function(e){e.exports=GC.Spread.Sheets}},o={},e=r("./dist/plugins/contextMenu/context-menu.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).ContextMenu=e}();
;var GC;!function(){"use strict";var i,r,n;function e(n){var t,t,t=r[n];return void 0!==t||(t=r[n]={exports:{}},i[n].call(t.exports,t,t.exports,e)),t.exports}i={"./dist/plugins/data/binding.js":function(n,t,i){var r,e,a,e,i,f,s,v,l,c,u,h,g,u,d,o,m,b;function p(n){this.rT=n}function j(n){this.Hc(n)}function w(n){var t=n&&n.H3;t&&t.Q$()&&r.Worksheet.et(n,"resetBinding",{sheet:n})}function C(n,t){var i=n&&n.H3;return!(!i||!i.Q$(t)||(n.clearPendingChanges(),r.Worksheet.et(n,"initBinding",{sheet:n,data:t}),0))}function y(n,t,i){var r,e,u,o,a,f,s,c,c,c,r,n,a,r=n,e=r._dataSource,u={value:v,hasBinding:!1};if(e)if(o=r.Mf,(a=r.K$)===g){if((c=o?o.getBindingPath(t,i):v)&&"object"!=typeof c)return{value:e.getValue(c),hasBinding:!0}}else{if(t<0||n.getRowCount()<=t)return u;if(c=(o||n).getColumnCount(),i<0||c<=i)return u;if(o?(r.J$||r.gTe(o.Ut.EE(!1,3)),(f=r.J$[i])&&(s=f.name)):n.Pq&&(r.J$?(f=r.J$[i])&&(s=f.dataField):s=n.Pq[i]),a)return c=h[a],n=V(r=f&&f.value)?r:v,a=o&&o.onItemGotten?o.onItemGotten.bind(o):l,c.getValue(e,n,s,t,i,a)}return u}function B(n,t,i,r){var e,u,o,a,f,s,c,d,d,d,a,e,e=n,u=e._dataSource,o=!1;if(u)if(a=e.Mf,(f=e.K$)===g)(d=a?a.getBindingPath(t,i):v)&&"object"!=typeof d&&(u.setValue(d,r),o=!0);else{if(t<0||n.getRowCount()<=t)return o;if(d=(a||n).getColumnCount(),i<0||d<=i)return o;a?(e.J$||e.gTe(a.Ut.EE(!1,3)),(s=e.J$[i])&&(c=s.name)):n.Pq&&(e.J$?(s=e.J$[i])&&(c=s.dataField):c=n.Pq[i]),f&&(d=h[f],e=V(a=s&&s.value)?a:v,o=d.setValue(u,e,c,t,i,r,l))}return o}function _(i){var r=v;return i&&(I(i)?r=g:a.each(h,function(n,t){if(t.isDataSource(i))return r=n,!1})),r}function O(n,t){return n&&t&&t!==g?h[t].getProperties(n):v}function I(n){return o&&n instanceof o}function V(n){return"function"==typeof n}function M(n,t,i){var r,e,u,o,a;if(n&&t)if(r=n[t],s(r))for(u=(e=t.split(".")).length,o=0;o<u&&(a=e[o],n);o++)o===u-1?V(n[a])?n[a](i):n[a]=i:n=V(n[a])?(s(n[a]())&&n[a]({}),n[a]()):(s(n[a])&&(n[a]={}),n[a]);else V(r)?n[t](i):n[t]=i}function S(n,t,i){var r,e,u,o,a;if(!n||!t)return v;if(r=n[t],!s(r))return V(r)?r():r;e=null,i?(e=i[t])||(e=t.split("."),i[t]=e):e=t.split("."),u=e.length,o=0;do{if(n=V(n[a=e[o]])?n[a]():n[a],s(n))return v}while(++o<u);return n}function G(){this.pathCache={}}Object.defineProperty(t,"__esModule",{value:!0}),t.X$=t.q$=t.setValueByPath=t.$$=t.CellBindingSource=void 0,r=i("Core"),e=i("Core"),a=e.GC$,e=i("Common"),i=i("./dist/plugins/data/data.ns.js"),f=a.isNumeric,s=e.Common.lt.ht,v=null,l=void 0,c="string",t.X$=u,h=t.X$=u={},g="cellBinding",u=new e.Common.ResourceManager(i.SR,"Bindings"),d=u.getResource.bind(u),r.Workbook.ch("binding",{onCultureChanged:function(){d()}}),p.prototype.setValue=function(n,t){M(this.rT,n,t)},p.prototype.getValue=function(n){return S(this.rT,n)},p.prototype.getSource=function(){return this.rT},o=p,t.CellBindingSource=o,j.prototype.bind=function(e,n){var t,i,r,n,r,u,o,t=this,i=t.Mf,r=t._dataSource;if(n&&t.ttt(n,{type:"bind",oldDataSource:r}),r&&(r.ntt&&(r.subscribe=r.ntt,delete r.ett,delete r.ntt),V(r.dispose))&&r.dispose(),t.itt(t.rtt),t.itt(t.ott),t.Hc(i),t._dataSource=e){if(!(n=t.K$=_(e)))throw new Error(d().Exp_NotSupportedDataSource);t.att=t.utt(),i&&(r=t.rtt,u=e.currentPosition,e.subscribe&&r.push(e.subscribe(t.stt,t)),u&&u.subscribe&&r.push(u.subscribe(t.ctt,t)),V(e.subscribe)&&!e.ntt&&(o=e.ntt=e.subscribe,e.ett=!1,e.subscribe=function(n,t){var i,r,i=[].concat.apply([],arguments),r;return i[0]=function(){if(!e.ett&&V(n))return n.apply(t,arguments)},o.apply(e,i)}),t.RA(),t.Mf.Ut.Spe()),t.Pq=O(e,n)}return C(i,e)},j.prototype.RA=function(){var n,t,i,r,e,r,u,o,n=this,t=n.Mf,i=n._dataSource;if(t&&i&&(r=n.K$,n.itt(n.ott),e=v,r!==g&&(r=t.getActiveRowIndex(),e=i.currentPosition?(-1<=r&&r<i.count()&&i.currentPosition(r),i.currentItem()):n.ftt(r)),e))for(o in u=function(){t&&t.repaint()},e)e[o]&&V(e[o].subscribe)&&n.ott.push(e[o].subscribe(u,v,v))},j.prototype.itt=function(n){var t,i;if(n)for(t=0;t<n.length;t++)(i=n[t])&&V(i.dispose)&&i.dispose()},j.prototype.getRowCount=function(){var n,t,n,i,n=this,t=n._dataSource,n=n.K$,i=0;return i=t&&n&&n!==g?h[n].getDataLength(t):i},j.prototype.getColumnCount=function(){var n,n,n,n,n=this.Pq;return n?n.length:(n=this._dataSource)&&(n=n[0],"null"===(n=a.getType(n))||n===c||"number"===n)?1:0},j.prototype.getSource=function(){return this._dataSource},j.prototype.ltt=function(){return this.Pq},j.prototype.htt=function(n){this.Pq=n},j.prototype.ftt=function(n){var t=this._dataSource,i=this.K$,r=v;return r=t&&i&&i!==g?h[i].getDataItem(t,n):r},j.prototype.utt=function(){var n,t,i,r,n=this;if(!n.att)for(t=n.getRowCount(),i=0;i<t;i++)if(r=n.ftt(i)){n.att=r.entityAspect&&r.entityType||r.constructor;break}return n.att},j.prototype.getValue=function(n,t){return y(this,n,t)},j.prototype.setValue=function(n,t,i,r){var e,u,e=this;return r&&(u=y(e,n,t).value,e.ttt(r,{type:"setValue",row:n,col:t,oldValue:u})),B(e,n,t,i)},j.prototype.pTe=function(){return this.J$},j.prototype.gTe=function(n,t){var i,r,i=this;t&&(r=i.J$,i.ttt(t,{type:"setColumnBindingInfo",oldColumnBindingInfo:r,columnBindingInfo:n})),i.J$=n},j.prototype.dtt=function(){var n=h[this.K$];return n&&n.canAdd&&n.canAdd()},j.prototype.vtt=function(){var n=h[this.K$];return n&&n.canInsert&&n.canInsert()},j.prototype.mtt=function(){var n=h[this.K$];return n&&n.canRemove&&n.canRemove()},j.prototype.allowSetCount=function(){var n,n,n=this.K$;return n===g||(n=h[n])&&n.allowSetCount&&n.allowSetCount()},j.prototype.kE=function(n,t,i){var r,e,u,o,r=this,e=r._dataSource;!e||n>r.getRowCount()||(u=r.K$,o=r.utt(),u&&u!==g&&!r.gtt&&(r.ptt=!0,i&&r.ttt(i,{type:"addItems",row:n,rowCount:t}),h[u].addItems(e,n,t,o,l),r.ptt=!1))},j.prototype.btt=function(n,t,i){var r,e,u,o,u,u,e,r=this,e=r.K$,u=r.getRowCount(),o=r._dataSource;!o||u<=n||e&&e!==g&&!r.gtt&&(r.ptt=!0,u=(u=r.Mf)&&u.onItemRemoved?u.onItemRemoved.bind(u):l,e=h[e].removeItems(o,n,t,u),i&&e&&0<e.length&&r.ttt(i,{type:"removeItems",row:n,removedItems:e}),r.ptt=!1)},j.prototype.ytt=function(n,t){var i,r,i,i=this,r=i._dataSource,i=i.K$;h[i].undoRemoveItems(r,n,t)},j.prototype.Q$=function(n){return I(n||this._dataSource)},j.prototype.Hc=function(n){var t=this;t._dataSource=v,t.K$="",t.att=v,t.Pq=v,t.rtt=[],t.ott=[],t.J$=v,w(t.Mf=n)},j.prototype.stt=function(n){var t,i,r,e,u,o,t=this,i=t.Mf;if(i&&!t.ptt){if(n){if(t.gtt=!0,!isNaN(n.length)&&(i.setRowCountCore(n.length),r=i.Ut,s(t.Pq))&&0===r._E(!1,3)&&(t.Pq=O(t._dataSource),i.setColumnCount(t.getColumnCount()),e=t.ltt()))for(u=0,o=e.length;u<o;u++)r.do("setItem",!1,3,u,{name:e[u]});t.gtt=!1}i.zw()}},j.prototype.ctt=function(){var n,t,n,n,n=this,t=n.Mf,n=n._dataSource;t&&n&&n.currentPosition&&(n=n.currentPosition(),t.ui!==n)&&(t.t4(n,t.ci,l,l,2),t.zw())},j.prototype.ttt=function(n,t){var i,i;this.Mf&&this.Mf.Ut&&!s(this.Mf.Ut.P8)&&this.Mf.Ut.P8<=0||(i=(i=n.bindingChanges)||(n.bindingChanges=[]),t.bindingManager=this,i.push(t))},j.prototype.wtt=function(n){var t,i,r,t=this,i=n.type,r=n.row;"bind"===i?t.bind(n.dataSource):"setValue"===i?t.setValue(r,n.col,n.value):"addItems"===i?t.kE(r,n.rowCount):"removeItems"===i?t.btt(r,n.rowCount):"setColumnBindingInfo"===i&&t.gTe(n.columnBindingInfo)},j.prototype.Mtt=function(n){var t,i,r,t=this,i=n.type,r=n.row;"bind"===i?t.bind(n.oldDataSource):"setValue"===i?t.setValue(r,n.col,n.oldValue):"addItems"===i?t.btt(r,n.rowCount):"removeItems"===i?t.ytt(r,n.removedItems):"setColumnBindingInfo"===i&&t.gTe(n.oldColumnBindingInfo)},j.prototype.toJSON=function(){var n,t,n=this._dataSource;return n?{type:t=this.K$,source:n=t===g?n.getSource():h[t].toJSON(n)}:v},j.prototype.fromJSON=function(n){var t,n,i,t=n&&n.source;t&&(i=void 0,i=(n=n.type)===g?new o(t):h[n].fromJSON(t))&&this.bind(i)},t.$$=j,t.setValueByPath=M,t.q$=S,G.prototype.isDataSource=function(n){return a.isArray(n)},G.prototype.getDataLength=function(n){return n.length},G.prototype.getDataItem=function(n,t){return n[t]},G.prototype.addItems=function(n,t,i,r){for(var e,u,e=0;e<i;e++)u={},r&&(u=r.createEntity?r.createEntity():new r),n.splice(t,0,u)},G.prototype.removeItems=function(n,t,i){var r=this.getDataLength(n);if(t<r)return n.splice(t,Math.min(i,r-t))},G.prototype.undoRemoveItems=function(n,t,i){for(var r=0,e=i.length;r<e;r++)n.splice(t+r,0,i[r])},G.prototype.getProperties=function(n){var t,i,r,e,t=n.length,i=v;if(0<t)for(e in i=[],r=n[0])V(r[e])||i.push(e);return i},G.prototype.getValue=function(n,t,i,r,e){var u=v,o=!1,n=this.getDataItem(n,r);return s(n)||(t?a.isEmptyObject(n)||(u=t(n),o=!0):i?(u=S(n,i,this.pathCache),o=!0):typeof n!=c&&!f(n)||0!==e||(u=n,o=!0)),{value:u,hasBinding:o}},G.prototype.setValue=function(n,t,i,r,e,u){var o=!1,a=this.getDataItem(n,r);return s(a)||(t?(a[i]=u,t(a,u),o=!0):i?(M(a,i,u),o=!0):typeof a!=c&&!f(a)||0!==e||(n[r]=u,o=!0)),o},G.prototype.fromJSON=function(n){return n},G.prototype.toJSON=function(n){return n},h.defaultBindingSource=new G},"./dist/plugins/data/data.dataview.js":function(n,t,i){var r,e,a,f,u;function o(){}Object.defineProperty(t,"__esModule",{value:!0}),t.X$=void 0,r=i("Common"),e=i("./dist/plugins/data/binding.js"),Object.defineProperty(t,"X$",{enumerable:!0,get:function(){return e.X$}}),a=r.Common.lt.ht,f=null,o.prototype.isDataSource=function(n){var t=window.wijmo;return t&&t.data&&t.data.isDataView&&t.data.isDataView(n)},o.prototype.getDataLength=function(n){return n.count()},o.prototype.getDataItem=function(n,t){return n.item(t)},o.prototype.addItems=function(n,t,i,r){if(r)for(var e=0;e<i;e++)n.ett=!0,n.add(r.createEntity?r.createEntity():new r),n.ett=!1,n.commitEdit()},o.prototype.removeItems=function(n,t,i){var r,e,u,o,a,r=this.getDataLength(n);if(t<r){for(e=[],u=Math.min(i,r-t),o=0;o<u;o++)a=n.item(t),n.remove(a),e.push(a);return e}},o.prototype.undoRemoveItems=function(n,t,i){for(var r,e,u,r=n.getSource(),e=0,u=i.length;e<u;e++)r.splice(t+e,0,i[e]);n.refresh()},o.prototype.getProperties=function(n){var t,i,r,e,t=0,i=f,r=n.getProperties();if(r&&0<r.length)for(t=r.length,i=[],e=0;e<t;e++)i.push(r[e].name);return i},o.prototype.canInsert=function(){return!1},o.prototype.getValue=function(n,t,i,r,e){var u=f,o=!1,r=this.getDataItem(n,r);return a(r)||(t?(u=t(r),o=!0):i&&(u=n.getProperty(r,i),o=!0)),{value:u,hasBinding:o}},o.prototype.setValue=function(n,t,i,r,e,u){var o=!1,r=this.getDataItem(n,r);return a(r)||(t?(t(r,u),o=!0):i&&(n.setProperty(r,i,u),o=!0)),o},o.prototype.fromJSON=function(n){return n},o.prototype.toJSON=function(n){return n.local},e.X$.dataViewBinding=new o},"./dist/plugins/data/data.entry.js":function(n,t,i){var r,e,u,r=this&&this.__createBinding||(Object.create?function(n,t,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(t,i);e&&("get"in e?t.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,r,e)}:function(n,t,i,r){n[r=void 0===r?i:r]=t[i]}),e=this&&this.__exportStar||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),t.q$=t.setValueByPath=t.$$=t.CellBindingSource=void 0,i("./dist/plugins/data/worksheet-databind.js"),u=i("./dist/plugins/data/binding.js"),Object.defineProperty(t,"CellBindingSource",{enumerable:!0,get:function(){return u.CellBindingSource}}),Object.defineProperty(t,"$$",{enumerable:!0,get:function(){return u.$$}}),Object.defineProperty(t,"setValueByPath",{enumerable:!0,get:function(){return u.setValueByPath}}),Object.defineProperty(t,"q$",{enumerable:!0,get:function(){return u.q$}}),e(i("./dist/plugins/data/data.ko.js"),t),e(i("./dist/plugins/data/data.dataview.js"),t),e(i("./dist/plugins/data/data.ns.js"),t)},"./dist/plugins/data/data.ko.js":function(n,t,i){var g,r,f,s,m,u,c,d,a,b,o,e,i;function v(){}Object.defineProperty(t,"__esModule",{value:!0}),t.X$=void 0,g=i("Core"),r=i("Common"),f=i("./dist/plugins/data/binding.js"),Object.defineProperty(t,"X$",{enumerable:!0,get:function(){return f.X$}}),s=r.Common.lt.ht,m=g.GC$,u=m.isFunction,c=m.getType,d=m.isNumeric,a=null,b="string",o=window.ko,v.prototype.isDataSource=function(n){return o&&o.isObservable(n)},v.prototype.getDataLength=function(n){return n().length},v.prototype.getDataItem=function(n,t){return n()[t]},v.prototype.addItems=function(n,t,i,r){for(var e,u,e=0;e<i;e++)u={},r&&(u=r.createEntity?r.createEntity():new r),n.splice(t,0,u)},v.prototype.removeItems=function(n,t,i){var r=this.getDataLength(n);if(t<r)return n.splice(t,Math.min(i,r-t))},v.prototype.undoRemoveItems=function(n,t,i){for(var r=0,e=i.length;r<e;r++)n.splice(t+r,0,i[r])},v.prototype.getProperties=function(n){var n,t,i,r,e,n=n(),t,i=[];if(0<n.length)for(e in r=n[0])(!u(r[e])||o&&o.isObservable(r[e]))&&i.push(e);return i},v.prototype.getValue=function(n,t,i,r,e){var u=a,o=!1,n=this.getDataItem(n,r);return s(n)||(t?(u=t(n),o=!0):i?(u=(0,f.q$)(n,i),o=!0):c(n)!==b&&!d(n)||0!==e||(u=n,o=!0)),{value:u,hasBinding:o}},v.prototype.setValue=function(n,t,i,r,e,u){var o=!1,a=this.getDataItem(n,r);return s(a)||(t?(t(a,u),o=!0):i?((0,f.setValueByPath)(a,i,u),o=!0):c(a)!==b&&!d(a)||0!==e||(n()[r]=u,o=!0)),o},v.prototype.fromJSON=function(n){return o?o.observableArray(n):a},v.prototype.toJSON=function(n){return n()},f.X$.koBinding=new v,o&&((i=o.bindingHandlers)["gc-spread-sheets"]=i["gcspread-sheets"]=i.wijspread={init:function(n,t,i,r){var t,e,u,o,a,f,s,c,d,v,l,h;if(!m(n).data("workbook")&&(e=(t=t())&&t.sheets,u=new g.Workbook(m("#"+n.id)[0],t),e)){for(a=o=void 0,f=e.length,s=u.getSheetCount();s<f;)o=u.S2(u.T2(s)),u.A2(s,0,o),s=u.getSheetCount();for(c=0;c<f;c++)o=u.getSheet(c),d=(a=e[c]).name,v=a.autoGenerateColumns,l=a.data,h=a.columns,typeof d==b&&0<d.length&&o.ub(d),"boolean"==typeof v&&(o.autoGenerateColumns=v),l&&o.setDataSource(l),h&&0<h.length&&(o.autoGenerateColumns=!1,o.bindColumns(h))}},update:function(n,t,i,r){}})},"./dist/plugins/data/data.ns.js":function(n,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.SR=void 0;var i=i("./dist/plugins/data/data.res.en.js");t.SR={en:i}},"./dist/plugins/data/data.res.en.js":function(n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Exp_NotSupportedDataSource=void 0,t.Exp_NotSupportedDataSource="The data source is not supported!"},"./dist/plugins/data/worksheet-databind.js":function(n,t,i){var h,t,s,v,f,i,r,l,u,o,g,e;function a(n,t,i){n.Ut.do("setItem",!1,3,t,i="string"==typeof i?{name:i}:i);var r=i&&i.formatter,e=i&&i.cellType;r&&n.setFormatter&&n.setFormatter(-1,t,r),e&&n.setCellType(-1,t,e),i&&!v(i.width)&&n.setColumnWidth(t,i.width)}function c(n,t,i,r,e,u){var o,a,f,s,c,d,v,l,v,o=n.H3,a="dataManagerBindingSource"===o.K$,f=n.NMi;if(f&&f._gi===h.SheetType.ganttSheet){for(s=0;s<i;s++)if(!f.zDi(s))for(c=0;c<r;c++)d=f.Rpi(s,c),u?n.c8(t,s,c,d,e):n.s8(t,s,c,d,a)}else for(s=0;s<i;s++)for(c=0;c<r;c++)l=(v=o.getValue(s,c)).value,v&&v.hasBinding&&(g.W0(v=l)&&(v=g.Q0(l)),u?n.c8(t,s,c,v,e):n.s8(t,s,c,v,a))}function d(n,t,i,r){var n=n.getSpan(t,i,r);return!(!n||n.row===t&&n.col===i)}function m(n,t,i,r){for(var e,u,o,a,f,a,e=n.options.colHeaderAutoTextIndex,u=0;u<i;u++)if(0<=e&&u===e||-1===e&&u===i-1)for(o=0;o<r;o++)a=t[u]&&t[u][o]&&t[u][o].value,f=n.Ut.q_(!1,3,o),v(a)&&f&&!d(n,u,o,1)&&(a=f.displayName||f.name)&&n.s8(t,u,o,a)}function b(n,t){var n,i;return"Object"===t.constructor.name&&(n=n.findByName(t.tableName))&&(n.H3?t=n.H3:((i=new s.$$).fromJSON(t),n.H3=t=i)),t}Object.defineProperty(t,"__esModule",{value:!0}),h=i("Core"),t=i("Common"),s=i("./dist/plugins/data/binding.js"),v=t.Common.lt.ht,f=h.GC$.isEmptyObject,i=h.GC$.extend,r=h.Worksheet.prototype,l=null,u="bindingPath",o=new RegExp("^\\d*(\\.\\d+)?\\*$"),g=t.Common.ct,i(r,e={getDataSource:function(){var n=this.H3;return n?n.getSource():l},setDataSource:function(n,t){var i,r,e,u,o,a,f,t,n,i=this,r=i.H3;if(r&&(r.getSource()!==n||i.NMi)){if(i.suspendPaint(),t&&i.sF(),i.suspendCalcService&&i.suspendCalcService(),n){if(e=i.Ut,(r=i.H3).Ctt=!0,!(u=r.bind(n,e.G8))){if(i.setRowCountCore(r.getRowCount()),i.autoGenerateColumns&&(i.setColumnCount(r.getColumnCount()),o=r.ltt()))for(a=0,f=o.length;a<f;a++)e.do("setItem",!1,3,a,{name:o[a]});e.yge(0,0,i.getRowCount(),i.getColumnCount())}}else i.H3=new s.$$(i);i.clearPendingChanges(),t=!1,r&&r.Ctt&&(t=r.Stt,delete r.Stt,delete r.Ctt),i.recalcAll&&i.recalcAll(t),i.resumeCalcService&&i.resumeCalcService(t),(n=i.ST())&&n.DS===i&&n.c5(),i.resumePaint()}},bindColumn:function(n,t){var i=this;i.suspendPaint();try{a(i,n,t)}finally{i.resumePaint()}},bindColumns:function(n){var t,i,r,e,u,t=this;t.suspendPaint();try{if(n)for(i=n.length,isNaN(i)||t.setColumnCount(i),r=0;r<i;r++)u=(e=n[r]).size,o.test(u)&&(e.starSize=u),a(t,r,e)}finally{t.resumePaint()}},getDataItem:function(n){var t,i,r,e,u,o,a,f,t=this,i=t.H3;if(!i||0===i.getRowCount())return l;if(r=t.getColumnCount(),e={},u=i.ftt(n))for(o in u)u.hasOwnProperty(o)&&"function"!=typeof o&&(e[o]=u[o]);for(a=0;a<r;a++)(f=t.Ut.q_(!1,3,a))&&f.name&&0<f.name.length&&v(e[f.name])&&(e[f.name]=t.getValue(n,a));return e},getDataColumnName:function(n){var t,t,t=this;return 0<=n&&n<t.getColumnCount()&&t.getDataSource()?(t=t.Ut.q_(!1,3,n))&&(t.displayName||t.name):l},getBindingPath:function(n,t){return this.Ut.getValueForKey(n,t,u)},setBindingPath:function(n,t,i){var r=this,e=r.Ut;return e.do("setValueForKey",n,t,u,i),e.gge(n,t,!i),r.ki(h.Events.WorksheetDataChanged,{type:"bindingPath"}),r.zw(),r}}),h.CellRange.prototype.bindingPath=h.CellRange.p0(r.getBindingPath,r.setBindingPath),h.Worksheet.ch("binding",{init:function(){var n=this;n.autoGenerateColumns=!0,n.H3=new s.$$(n)},dispose:function(n){var t;!1!==n.clearCache&&(this.H3=l)},onLayoutChanged:function(n){var t,i,r,e,u,o,a,f,s,c,d,t=this,i=n.changeType,r=n.row,e=n.rowCount,u=n.sheetArea;if(v(u)||3===u||2===u)if(o=t.H3,"addingRows"===i)o&&!1===o.dtt()?n.canAdd=!1:o&&!1===o.vtt()&&(n.newRow=t.getRowCount());else if("addRows"===i)o&&o.kE(r,e,t.Ut.G8);else if("deletingRows"===i){if(o)if(!1===o.mtt())n.canDelete=!1;else for(t.aj||(t.aj=[]),a=t.aj,f=t.Ut,s=o.getRowCount(),c=0;c<e&&r+c<f.getRowCount();c++)d=l,r+c<s&&(d=o.ftt(r+c)),a.push({row:r+c,data:d})}else"deleteRows"===i?o&&o.btt(r,e,t.Ut.G8):"settingRowCount"!==i||!o.getSource()||o.allowSetCount()||3!==u&&2!==u||(n.canSet=!1)},toJson:function(n,t){var i,r,e,t,e,u,i=this,r=i.getColumnCount(),e=i.getDataSource();t&&t.includeBindingSource&&e&&(c(i,t=n.data.dataTable||{},i.getRowCount(),r),f(t)||(n.data.dataTable=t),m(i,e=n.colHeaderData.dataTable||{},i.getRowCount(1),r),f(e)||(n.colHeaderData.dataTable=e)),!0!==(u=i.autoGenerateColumns)&&(n.autoGenerateColumns=i.autoGenerateColumns)},fromJson:function(n,t){var i,r,e,u,e,i=this;i.H3=new s.$$(i),t&&(r=i.H3,e=n.dataSource,u=n.dataBinding,e&&r.bind(e),u)&&r.fromJSON(u,t),e=n.autoGenerateColumns,v(e)||(i.autoGenerateColumns=e)},preFromJson:function(){this.H3=new s.$$(this)},wh:function(n,t,i){var r,e,u,o,i,a,r=this,e=r.getColumnCount(),u=r.getDataSource(),o=n.lossless;o=o||(n.lossless={}),i&&i.includeBindingSource&&u&&(c(r,n,r.getRowCount(),e,t.sharedStrings,!0),m(r,i=o.colHeaderData.dataTable||{},r.getRowCount(1),e),f(i)||(o.colHeaderData.dataTable=i)),!0!==(a=r.autoGenerateColumns)&&(o.autoGenerateColumns=r.autoGenerateColumns)},yh:function(n){var t,n,t=this;t.H3=new s.$$(t),n=n.lossless&&n.lossless.autoGenerateColumns,v(n)||(t.autoGenerateColumns=n)}}),h.Y8.ch("binding",{priority:6e3,isValid:function(n){var t,n,t,n=-1<["getValue","setValue"].indexOf(n),t=null==(t=this.Mf.H3)?void 0:t._dataSource;return!n||t},getValue:function(n){var t,i,r,e,r,e,t=n.row,i=n.col,r=n.sheetArea,e=this.Mf.H3;3===r&&e&&e._dataSource&&(r=e.getValue(t,i),n.isValueGet=r.hasBinding,e=r.value,1!==n.valueType&&(e=h.mt.wt(e)),n.value=e)},setValue:function(n){var t,i,r,e,u,o,a,a,f,t=n.row,i=n.col,r=n.value,e=n.sheetArea,u=this.Mf,o=u.H3;3===e&&o&&o._dataSource&&(a=o.getValue(t,i)).hasBinding&&(r!==(a=a.value)?(u.isDirtySuspended()||(f=u.getDataItem(t),this.dE(t,i,{gE:f,d6:a},e)),n.isValueSet=o.setValue(t,i,r,u.Ut.G8)):n.isValueSet="dataManagerBindingSource"!==o.K$)},applyChanges:function(n){var t,n,i,r,e,u,t=n.changes,n=n.isUndo,i=t&&t._bindingChanges;if(i)if(n)for(r=i.length-1;0<=r;r--)(e=i[r]).bindingManager&&(u=b(this.Mf.tables,e.bindingManager)).Mtt(e);else for(r=0;r<i.length;r++)e=i[r],(u=b(this.Mf.tables,e.bindingManager)).wtt&&u.wtt(e)},undoValue:function(n){var t,i,r,t=n.bindingChanges;if(t)for(i=t.length-1;0<=i;i--)(r=t[i]).bindingManager.Mtt(r)}})},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets}},r={},n=e("./dist/plugins/data/data.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Bindings=n}();
;var GC;!function(){"use strict";var i,r,t,n,e;function o(t){var n,n,n=r[t];return void 0!==n||(n=r[t]={exports:{}},i[t](n,n.exports,o)),n.exports}i={"./dist/plugins/validation/datavalidation-event.js":function(r,t,n){var t,i,U,q,R,Q,Y,J,P,W,X,G,Z,H,N,K,_,z,$,tt,nt,it,rt,et,ot,at,ut,st,ft,ct,lt,ht,vt,dt,gt,At,mt,pt;function bt(t){for(var n,i,r,e,n={},i=[],r=0;r<t.length;r++)n[e=t[r].text]||(n[e]=!0,i.push(t[r]));return i}Object.defineProperty(t,"__esModule",{value:!0}),t=n("Core"),i=n("Common"),U=n("CalcEngine"),q=n("./dist/plugins/validation/datavalidation.js"),R=i.Common.lt.ht,Q=i.Common.ct,Y=i.Common.zf,J=t.mt,P=t.Ec,W=J.pi(),X=J.Tt,G=t.GC$,Z=J.En,H=J.yt,N=J.vi,K=document,_=Math.max,z=Math.min,$="position",tt="absolute",nt="border",it="padding",rt="box-shadow",et="font",ot="background-color",at="top",ut="left",st="z-index",ft="outline",ct="auto",lt="white",ht="none",vt="size",dt="gcUIElement",gt="min-height",At="min-width",mt="max-width",pt="word-wrap",G.extend(t.nk.prototype,{PA:function(n,i){var r,e,t,o,a,u,s,f,c,l,h,u,a,t,u,a,v,d,g,A,m,p,b,w,C,O,k,M,t,u,a,t,s,u,t,s,T,V,S,s,D,j,y,x,F,F,a,x,L,E,s,I,y,a;function B(t,n){if(t&&t[n])return"function"==typeof t[n]?t[n]():t[n]}if((t=(e=(r=this).Mf)&&e.parent)&&(o=e.G1())&&((a=t.getActiveSheet())||(u=t.getActiveSheetTab())&&(a=u.Mf),a)&&e.name()===a.name()&&(s=e.getDataValidator(n,i))&&(f=e.getCellRect(n,i),!r.Ek(f))&&(c=t.j2(),l=t.getHost(),h=J.gi(l),B(s,"showInputMessage")&&B(s,"inputMessage")&&(t=(u=Y.Vi)((a=Y.j0)(B(s,"inputTitle")),"\n","<br/>"),u=u(a(B(s,"inputMessage")),"\n","<br/>"),a=Z("span"),G(a).css($,tt).css(nt,"1px #C0C0C0 solid").css(it,"3px 8px 3px 8px").css(ot,"#FFFFFF").css(rt,"1px 2px 5px rgba(0,0,0,0.4)").css(et,"normal normal normal 12px/normal Arial").width(ct).height(ct).css(at,f.y+f.height+5).css(ut,f.x+f.width/2).css(gt,"15px").css(At,"20px").css(mt,"200px").css(pt,"break-word").css(st,h).html((R(t)||""===t?"":"<b>"+t+"</b><br/>")+u).attr(dt,"gcValidationInputMessage").appendTo(c),e.KD=a),s)&&3===B(s,"type")&&B(s,"inCellDropdown")&&B(s,"condition")){for(v=bt(v=B(s,"condition").getValidListImp(e,n,i)),d=B(s,"condition").KJ(),g=v.length,A=Z("select"),m=e.getText(n,i),p=-1,b=K.createDocumentFragment(),w=new RegExp(String.fromCharCode(32),"g"),C=String.fromCharCode(160),O=0;O<g;O++)k=v[O].text,R(k)||U&&k instanceof U.CalcError||(p<0&&k===m&&(p=O),k instanceof Date&&(k=Q.Pe(k,"M/d/yyyy h:mm:ss")),(M=Z("option")).value=k,M.text=k.replace(w,C),b.appendChild(M));A.appendChild(b),A.selectedIndex=0<p?p:0,t=e.getActualStyle(n,i),u=e.Dn,a=t&&t.font?t.font:u.Nn(),1<e.zoom()&&(a=u._n(a)),(t=e.Ut.getSpans(P(n,i,s=1,1)))&&0<t.length&&t[0]&&(s=t[0].colCount),u=i+s-1==e.getColumnCount()-1,t=e.Gt(n),s=e.parent&&e.parent.options.useTouchLayout,t=z(s?50:15,t),V=X.safari&&(W.ipad||W.iphone),S=W.android,x=y=j=D=s=void 0,x=V?(s=f.width+3,D=f.height+3,j=f.y-1.5,y=f.x-1.5,lt):(s=_(f.width+(u?0:t),e.defaults.colWidth),D=8<g?140:ct,j=f.y+f.height,y=(F=f.x+f.width+(u?0:t)-s)<e.uw().left?f.x:F,""),F=G(A).css(ft,ht).css($,tt).css(et,H(a)).css(st,h).css(ot,x).width(s).height(D).css(ut,y).attr(dt,"gcValidationSelect").appendTo(c).attr(vt,2<g?g:2).hide().bind("click",function(){S||(r.jk(A,n,i,v,d),V&&G(e.a6t).show())}).bind("keydown",function(t){13!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey?27!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||G(A).hide():r.jk(A,n,i,v,d),V&&G(e.a6t).show()}).bind("change",function(){S&&r.jk(A,n,i,v,d)}),a=G(l).height(),D=F.outerHeight()+1,V||(a<D+j&&D<j?j=f.y-D:(x=l.getBoundingClientRect(),(s=(L=window.innerHeight)-((E=x.y)+j))<D&&F.height(s))),F.css(at,j),V&&F.bind("blur",function(){r.jk(A,n,i,v,d),G(e.a6t).show()}),e.gf=A,y=(I=e.options.rightToLeft)?f.x-(u?0:t+3):f.x+f.width-(u?t:0),(a=Z("input")).type="image",a.src=(0,q.Hrt)(),a.alt="v",G(a).css($,tt).width(t).height(t).css(at,f.y+f.height-(t+3)).css(ut,y).css(st,h).css(ot,lt).css(nt,"1px solid gray").attr(dt,"gcValidationButton").appendTo(c).bind("click",function(t){var n,n;e.isEditing()&&!e.endEdit()||(n=e.gf,G(n).toggle().focus(),n=n.options[n.selectedIndex],R(n)||n.scrollIntoView({behavior:"instant",block:"nearest",inline:"start"}),V&&G(e.a6t).toggle(),N(t))}),e.a6t=a}}})},"./dist/plugins/validation/datavalidation.js":function(S,t,n){var i,D,r,g,n,e,c,U,j,y,x,F,o,h,v,L,a,q,s,d,E,u,n,R,Q,Y,J,I,A,P,W,X,B,G,Z,T,H,N,K,_,z,m,p,b,$,f,e,tt,nt,it,rt,et,ot,at,ut,st,i,l,ft,ct,lt,ht,vt,w,e,dt,i,e,e,e,e,e,e;function gt(t){if(L(t))return 0;if("number"==typeof t)return t;if("string"==typeof t){var n=u.Xf(d,t,!0);if(!isNaN(n)&&n.toString()===t)return n}return d}function At(t){return!L(t)&&t instanceof Date?q(t):t}function mt(t,n){var i,r,e;if(!L(t))return 1===t||2===t?i=wt(n.operator,n.value1,n.value2,1===t):3===t?n.value?i=Dt(n.value):n.formula&&(i=St(n.formula)):4===t||5===t?(r=n.value1,e=n.value2,r&&"/OADate("===r.substr(0,8)&&(r=$.dJ(r)),e&&"/OADate("===e.substr(0,8)&&(e=$.dJ(e)),i=(5===t?kt:Ot)(n.operator,r,e)):6===t?i=Mt(n.operator,n.value1,n.value2):7===t&&void 0!==n.formula&&(i=Vt(n.formula)),i?i.condition():void 0}function pt(t,n,i,r,e,o){var a,u,s,f,c,l,h,v,o,o,s,f,u,d,v,n,r,i,e,e,l,a;return t.intersect(n,i,r,e)?(a=t.rowCount,u=t.colCount,s=b(0,t.row),f=b(0,t.col),h=l=c=!1,n=b(0,n),i=b(0,i),v=(o=o||[-1,-1])[0],o=o[1],-1===a&&(a=v-s,l=!0),-1===u&&(u=o-f,c=!0),-1===e&&(e=o-i,h=!0),s=(o=s)+a-1,u=(f=f)+u-1,v=(d=n)+(r=-1===r?v-n:r)-1,r=(n=i)+e-1,i=[],-1!==o&&-1!==f&&-1!==d&&-1!==n&&(0<n-f&&(e=m(o,f,l?-1:a,n-f),i.push(e)),0<u-r&&(e=m(o,1+r,l?-1:a,u-r),i.push(e)),0<d-o&&(l=m(o,b(n,f),d-o,c&&h?-1:p(r,u)-b(n,f)+1),i.push(l)),0<s-v)&&(a=m(1+v,b(n,f),s-v,c&&h?-1:p(r,u)-b(n,f)+1),i.push(a)),i.c6t=!0,i):[t]}function C(t,n){var n;if(!L(t))return"string"==typeof t&&(t=X(t)),t=3===n||!(t=4!==n&&5!==n||(n=parseFloat(t),isNaN(n))?t:_(t))||t instanceof Date?t:P(t)}function O(t){var n=this;n.id=O.f6t,O.f6t++,n.l6t=a(it),t&&(n.condition(t),n.condition().ignoreBlank(n.ignoreBlank())),n._S=[]}function bt(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMOSURBVHjaXJNdaJRHFIbfM7PfGremUTfkpxgpiheiBOmFtYUgRXNRqNnd75sEhBoIKhrwQpFUUSsihhIQ41+FNrUGqYhRY43STZqgARNRTIzRaFqz6xJTtals3K8xRQ3x7UV215+LB2bOxTNn3jMDs+mEIgmS+LwQiqSQ9JG03FHX54666pn7TLmJEZVIjCCRGMkYGxvNiI9FvaENZzLw/PmqtCDFV/4WkERw8TI03K6XqqrNWLBgPoafDmNwMCbd3TestpMDHpJAuIcWSZjSUrnS0SFOWamXJLpuDYAkAiYAkioYDCIej0+Lx12QrervFxOemjWfCvIyIcmTVeLVC1986OkUklhRtlgutLYrkpnOKlt1dl0BSfTHmnCnm5oTm0AS6I0xLaDLrK1PusTp/cb7/rUAyH8kSL+Vqt0ebpuGP699LCRROAdqf/suGforCpLi4DMpAOQQLAEgfE2sRDZIv5cknGxi74HDFnZ/32olk9f//vOTPIj05ZnKZpp14QlnfZgpTOXvNGsvjrvuH9MnOwAOYlhQ/UPYmxRkJVvzPHw8JF8EdrKoZEeapSt2cHDo4Sxn7R0hiV8/hEQe3Ad21jZNJQnbDklSBBas0ddvRj2Fi4qZIhaL+Q3ni8N0ZohGe4Dv6sKZfFP0kvkSWLZdGvLpiUTuTS9cVMxI5H5+fz+UfXyOto/Ns5bUL7dyjsBjTsKDbbVnM0iqYNHXYi9ZLiSlaRbFn089zlzvwN1IzkDlmDhfdiin5KgOBY5qO9iojX1K9+VRcOCXnlySsFkOkjj/WGschtR0Kt/Ga9D2aYj5DWKaIeYSxTlFMS2T66udBDbXHS94Z97ZUB8Ayt7+iVVddlkzl5LCvrklvQ9dr1fnF0IQbng5O/VQsmAJSfnxSLuqCG3Rxxpfz3xbXv0IEkzm5YR7lXOCGs6+PVNJYjaQnoKwSgBIDSqkjjPUuv3QLP9ImW+hG1/lKJtzp5jaCmW2nrNAUpOUkqrWrJUb23T5rhZf0eoWhbeEKX7O4eTPHe8DSTjF59T/AwCfnhbaDaIICgAAAABJRU5ErkJggg=="}function k(t){return o&&t&&"="===t[0]}function wt(t,n,i,r){var e,o,a,u,n,s,f,i,e=d,o=d,a=d,u=d;return k(n)?e=v(n,"="):o=n,k(i)?a=v(i,"="):u=i,n=d,6===t&&((s=h(1,3,o,e)).integerValue(r),(f=h(1,5,u,a)).integerValue(r),n=h(0,1,d,d,d,d,d,s,f)),7===t&&((s=h(1,4,o,e)).integerValue(r),(f=h(1,2,u,a)).integerValue(r),n=h(0,0,d,d,d,d,d,s,f)),0<=t&&t<=5&&(n=h(1,t,o,e)).integerValue(r),(i=new w(n)).type(r?1:2),i.comparisonOperator(t),i}function Ct(t,n,i,r,e){var o,a,u,s,n,f,c,l,i,o=d,a=d,u=d,s=d;if(k(n)?o=v(n,"="):a=n,k(i)?u=v(i,"="):s=i,n=d,6===t&&(f=h(r,5,a,o),c=h(r,3,s,u),n=h(0,1,d,d,d,d,d,f,c)),7===t&&(f=h(r,2,a,o),c=h(r,4,s,u),n=h(0,0,d,d,d,d,d,f,c)),0<=t&&t<=5){switch(t){case 0:l=0;break;case 1:l=1;break;case 2:l=4;break;case 3:l=5;break;case 4:l=2;break;case 5:l=3}n=h(r,l,a,o)}return(i=new w(n)).type(e),i.comparisonOperator(t),i}function Ot(t,n,i){return Ct(t,n,i,5,4)}function kt(t,n,i){return Ct(t,n,i,13,5)}function Mt(t,n,i){var r,e,o,a,n,u,s,i,r=d,e=d,o=d,a=d;return k(n)?r=v(n,"="):e=n,k(i)?o=v(i,"="):a=i,n=d,6===t&&(u=h(7,3,e,r),s=h(7,5,a,o),n=h(0,1,d,d,d,d,d,u,s)),7===t&&(u=h(7,4,e,r),s=h(7,2,a,o),n=h(0,0,d,d,d,d,d,u,s)),0<=t&&t<=5&&(n=h(7,t,e,r)),(i=new w(n)).type(6),i.comparisonOperator(t),i}function Vt(t){var t;return o?((t=new w(h(4,d,d,v(t,"="),4))).type(7),t):d}function St(t){var t;return o?((t=new w(r.Condition.fromFormula(t))).type(3),t):d}function Dt(t){var t=new w(r.Condition.fromSource(t));return t.type(3),t}function jt(t){return t&&t.getExpressions&&0<t.getExpressions().length}function yt(t){return this.JS(t)}function xt(t,n){if(t&&n&&n.length)return n.map(yt.bind(t))}function Ft(t,n,i){var r,e,o,r=t.rowCount,e=t.colCount,o=m(t.row,t.col,r,e);return 0===t.row&&r===n&&(o.row=-1),0===t.col&&e===i&&(o.col=-1),o}function Lt(t,n){var i=t.getRowCount(),r=t.getColumnCount();return n.map(function(t){return Ft(t,i,r)})}function Et(t,n){var i,t,i=t.cellCache;return i||(t.cellCache=i={}),(t=i[n])||(i[n]=t={}),t}function It(e,t,n,o,a,u,s){var f,c,l,h,v,i,r,d,g,A,m,p,b,w,C,f=o.h6t,c=e.row,l=e.col,h=e.rowCount,v=e.colCount,i=c+h,r=l+v;if(t<=i-1&&(h=t-c),n<=r-1&&(v=n-l),i===t)for(d=function(t,n){var i,r,i,i=f.colCache;i||(f.colCache=i={}),(r=i[n])||(i[n]=r={}),(i=r.dv)&&i!==a&&i.FX(e,o),r.dv=a,r.cacheStartRowIndex=c,(L(r.cacheRowCount)||!0===s&&a.smt().some(function(t){return t.intersect(u,n,1,1)}))&&(r.cacheRowCount=h)},g=0,A=l;g<v;g++,A++)d(g,A);else if(r===n)for(m=function(t,n){var i,r,i,i=f.rowCache;i||(f.rowCache=i={}),(r=i[n])||(i[n]=r={}),(i=r.dv)&&i!==a&&i.FX(e,o),r.dv=a,r.cacheStartColIndex=l,(L(r.cacheColCount)||!1===s&&a.smt().some(function(t){return t.intersect(n,u,1,1)}))&&(r.cacheColCount=v)},p=0,b=c;p<h;p++,b++)m(p,b);else for(p=0,b=c;p<h;p++,b++)for(w=Et(f,b),g=0,A=l;g<v;g++,A++)(C=w[A])&&C!==a&&C.FX(e,o),w[A]=a}function Bt(t,n){var i,r,e,o,a,u,s,f,c,l,h,v,d,g,A,m,p,b,g,A,w,C,O,k,M,V,O,k,S,D,j,y,i=n.h6t,r=t.row,e=t.col,o=t.rowCount,a=t.colCount,u=n.eJ,s=u.getRowCount(),f=u.getColumnCount(),c=i.colCache,l=i.rowCache,h=i.cellCache;if(c)for(v=e;v<e+a;v++)if(g=(d=c[v])&&d.cacheStartRowIndex,A=d&&d.cacheRowCount,d&&(g<=r&&r<g+A||g<=r+o&&r+o<=g+A)){if(m=!1,r<s){for(p=g;p<=r;p++)b=Et(i,p),p<r&&(b[v]=d.dv);(A=r+o)-(g=d.cacheStartRowIndex)===d.cacheRowCount?c[v]=E:(d.cacheStartRowIndex=A,d.cacheRowCount-=A-g),m=!0}else r+o===s&&(m=!(c[v]=E));m&&(w=d.dv)&&w.FX(t,n)}if(l)for(C=r;C<r+o;C++)if(O=(b=l[C])&&b.cacheStartColIndex,k=b&&b.cacheColCount,b&&(O<=e&&e<O+k||O<=e+a&&e+a<=O+k)){if(m=!1,e<f){for(M=O;M<=e;M++)V=Et(i,C),M<e&&(V[M]=b.dv);(k=e+a)-(O=b.cacheStartColIndex)===b.cacheColCount?l[C]=E:(b.cacheStartColIndex=k,b.cacheColCount-=k-O),m=!0}else e+a===f&&(m=!(l[C]=E));m&&(w=b.dv)&&w.FX(t,n)}if(h)for(C=0,S=r,D=o;C<D;C++,S++)if(b=h[S])for(v=0,j=e,y=a;v<y;v++,j++)(w=b[j])&&w.FX(t,n),b[j]=E}function Tt(t){switch(t){case"none":return l.anyValue;case"whole":return l.wholeNumber;case"decimal":return l.decimalValues;case"list":return l.list;case"date":return l.date;case"time":return l.time;case"textLength":return l.textLength;case"custom":return l.custom}}function Ut(t){var n,i,r,n=[];if(t)for(i in t)(r=t[i])&&n.push(r);return n}function qt(t,n,i){var r,e,o;if(t)for(e=(r=Object.keys(t)).length-1;0<=e&&n<=(o=+r[e]);e--)t[o+i]=t[o],delete t[o]}function M(t){this.eJ=t,this.YB={},this.h6t={},this.d6t=[]}function Rt(t){return t="string"==typeof t?'"'+t+'"':t}function Qt(t){var n=t.D5;return L(n)?(n=t.expected(),Rt(J(n))):n}function Yt(t){var n,i;return L(t)?d:0===(n=t.conType())?Jt(t):1===n||7===n?(i=t.formula(),{firstFormula:i=L(i)?t.expected():i}):4===n?{firstFormula:L(t.formula())?t.expected():t.formula()}:12===n||5===n||13===n?{firstFormula:Qt(t)}:{firstFormula:d}}function Jt(t){var n,i;return L(t)?d:(i=n=d,{firstFormula:n=t.item1()?(0===t.item1().conType()?Jt:Yt)(t.item1()).firstFormula:n,secondFormula:i=t.item2()?(0===t.item2.conType?Jt:Yt)(t.item2()).firstFormula:i})}function V(t,n){var i,n;if(!L(t))return i=t,n=+(i=n&&k(t)?t.substr(1):i),isNaN(n)?t:n}function Pt(t){var n=t.row,i=t.col,r=t.rowCount,t=t.colCount;return-1===n&&-1===i?i=0:(-1!==n&&-1!==r&&n+r>D.MAX_ROW_COUNT&&(r=D.MAX_ROW_COUNT-n),-1!==i&&-1!==t&&i+t>D.MAX_COLUMN_COUNT&&(t=D.MAX_COLUMN_COUNT-i)),m(n,i,r,t)}function Wt(t){var t=t.map(Pt);return g.rangesToFormula(t,0,0,15,!1).split(", ").join(" ")}Object.defineProperty(t,"__esModule",{value:!0}),t.createListValidator=t.createFormulaListValidator=t.createFormulaValidator=t.createTextLengthValidator=t.createTimeValidator=t.createDateValidator=t.createNumberValidator=t.kf=t.Hrt=t.DefaultDataValidator=t.HighlightPosition=t.HighlightType=t.ErrorStyle=t.DataValidationResult=t.CriteriaType=void 0,i=n("Common"),D=n("Core"),r=n("ConditionalFormatting"),g=n("SheetsCalc"),n=n("CalcEngine"),e=i.Common.ct,c=D.UsedRangeUtil.vh,U=D.UsedRangeUtil.hh,j=D.XFileConstants.Au,y=D.XFileConstants.Ou,x=D.XFileConstants.Ru,F="1",o=!!n,h=r.aJ,v=i.Common.zf.cJ,L=i.Common.lt.ht,a=i.Common.lt.tv,q=e.o0,s=D.GC$,d=null,E=void 0,n=(u=D.mt).p0,R=u.T1,Q=u.G0,Y=u.e1,J=u.i1,I=u.vo,A=u.n1,P=u.g1,W=u.p1,X=D.Util.mr,B=D.Util.addXLFNPrefix,G=D.Util.pr,Z=D.Util.io,T=u.xr,H=u.C1,N=u.Hue,K=u.c1,_=u.Eve,z=D.range_parser.Oc,m=D.Ec,p=Math.min,b=Math.max,$=i.Common.ct,f=".validator",it={type:0,color:e="red"},rt={type:tt=1,color:e,position:1},et={type:2,color:e,position:nt=5,image:null},(i=ot=ot||{})[i.none=0]="none",i[i.whole=1]="whole",i[i.decimal=2]="decimal",i[i.list=3]="list",i[i.date=4]="date",i[i.time=5]="time",i[i.textLength=6]="textLength",i[i.custom=7]="custom",(e=at=at||{})[e.stop=0]="stop",e[e.warning=1]="warning",e[e.information=2]="information",ut={0:"equal",1:"notEqual",2:"greaterThan",4:"lessThan",3:"greaterThanOrEqual",5:"lessThanOrEqual",6:"between",7:"notBetween"},st={equal:0,notEqual:1,greaterThan:2,greaterThanOrEqual:3,lessThan:4,lessThanOrEqual:5,between:6,notBetween:7},i=window,(e=l=t.CriteriaType||(t.CriteriaType={}))[e.anyValue=0]="anyValue",e[e.wholeNumber=1]="wholeNumber",e[e.decimalValues=2]="decimalValues",e[e.list=3]="list",e[e.date=4]="date",e[e.time=5]="time",e[e.textLength=6]="textLength",e[e.custom=7]="custom",(e=ft=t.DataValidationResult||(t.DataValidationResult={}))[e.forceApply=0]="forceApply",e[e.discard=1]="discard",e[e.retry=2]="retry",(e=ct=t.ErrorStyle||(t.ErrorStyle={}))[e.stop=0]="stop",e[e.warning=1]="warning",e[e.information=2]="information",(e=lt=t.HighlightType||(t.HighlightType={}))[e.circle=0]="circle",e[e.dogEar=1]="dogEar",e[e.icon=2]="icon",(e=ht=t.HighlightPosition||(t.HighlightPosition={}))[e.topLeft=0]="topLeft",e[e.topRight=1]="topRight",e[e.bottomRight=2]="bottomRight",e[e.bottomLeft=3]="bottomLeft",e[e.outsideLeft=4]="outsideLeft",e[e.outsideRight=5]="outsideRight",vt=["errorStyle","ignoreBlank","preciseCompareDate","inCellDropdown","showInputMessage","showErrorMessage","inputTitle","errorTitle","inputMessage","errorMessage","comparisonOperator","type","condition"],O.prototype.value1=function(t,n){var i,i,t,i=this.condition(),i=i&&i.item1()?i.item1():i;return i?(t=i.formula(t,n))&&0<t.length?"="+v(s.trim(t.toString()),"="):i.expected():d},O.prototype.value2=function(t,n){var i,i,t,i=this.condition(),i=i&&i.item2()?i.item2():i;return i?(t=i.formula(t,n))&&0<t.length?"="+v(s.trim(t.toString()),"="):i.expected():d},O.prototype.isValid=function(t,n,i,r,e){var o,a,u,s,f,e,o=this,a=o.condition(),u=L(e)||!0===e;if(a){if(o.ignoreBlank()&&(L(r)||""===r))return!0;if(f=void 0,!L(s=r))switch(o.type()){case 0:return!0;case 2:case 1:f=u?gt(r):r,L(f)||(s=f);break;case 4:case 5:f=u?_(r):r,L(f)||(s=f)}t&&(t.EJ=!0),e=void 0;try{e=a.evaluate(t,n,i,s,s)}catch(t){e=!0}finally{t&&(t.EJ=!1)}return e}return!0},O.prototype.reset=function(){var t=this;t.errorStyle(0),t.ignoreBlank(!0),t.preciseCompareDate(!1),t.inCellDropdown(!0),t.showInputMessage(!0),t.showErrorMessage(!0),t.inputTitle(""),t.errorTitle(""),t.inputMessage(""),t.errorMessage(""),t.comparisonOperator(6),t.type(0),t.condition(d),t._S.length=0},O.prototype.getValidList=function(t,n,i){var r=this.condition();return r!==d&&3===this.type()&&12===r.conType()?r.getValidList(t,n,i):d},O.prototype.highlightStyle=function(t){var n,i,r,e,n=this;if(0===arguments.length)return n.l6t;if(!L(t)){if(n.l6t.type!==t.type)switch(i=t.type){case 1:n.l6t=a(rt);break;case 2:n.l6t=a(et);break;default:n.l6t=a(it)}for(e in r=n.l6t)r.hasOwnProperty(e)&&t.hasOwnProperty(e)&&(r[e]=t[e]);return n.Mf&&n.Mf.repaint(),n}},O.prototype.toJSON=function(i){var r,e,t,r=this,e={};return vt.forEach(function(t){var n=r[t]();r[t].isDefault(n)||(e[t]=n&&n.toJSON?n.toJSON(i):n)}),t=r._S.map(Pt),e.ranges=g.rangesToFormula(t,0,0,15,!1),e.highlightStyle=JSON.stringify(r.l6t),s.isEmptyObject(e)?E:e},O.prototype.fromJSON=function(e,o,a){var u,t,n,i,t;e&&!s.isEmptyObject(e)&&(u=this,e.ranges&&(u._S=g.formulaToRanges(a,e.ranges,0,0,!0)[0].ranges),e.highlightStyle&&(u.l6t=JSON.parse(e.highlightStyle)),vt.forEach(function(t){var n,i,r,n=e[t];R(n)&&("condition"===t?((i=h()).fromJSON(e.condition,a,o),u.condition(i,!1),(r=i.ranges())&&r.length?u._S=r:i.ranges(u._S),i.context(a)):u[t](n,!1))}),t=e.validatorInfo)&&(n=a.Lp.useR1C1,i=mt(e.type,t),t=t.operator,i&&(i.ranges(u._S),i.ignoreBlank(u.ignoreBlank()),i.context(a),n&&Q(i),u.condition(i)),L(t)||u.comparisonOperator(t))},O.prototype.clone=function(t){var n,n;return this.ZB?((n=this.condition())&&n.initExpression(),this):((n=new O).fromJSON(this.toJSON(t),!1,t||this.Mf),n._S=[],n)},O.prototype.context=function(t){var n;return t&&(this.DJ=t,n=this.condition())&&(n.ranges(this._S),n.context(t)),this.DJ},O.prototype.v6t=function(t){var n,i;if(t){for(n=this._S,i=0;i<n.length;i++)if(n[i].containsRange(t))return;n.push(t)}},O.prototype.FX=function(t,n){var i,r,e,o,a,u,s,f,t,c,i=this,r=i._S;t&&r.length&&(e=t.row,o=t.col,a=t.rowCount,u=t.colCount,f=!(s=[]),t=i.Mf,c=t&&[t.getRowCount(),t.getColumnCount()],r.forEach(function(t){var t=pt(t,e,o,a,u,c);t.c6t&&(f=!0),s.push(t)}),i._S=[].concat.apply([],s),f)&&n.m6t(i)},O.prototype.smt=function(){return this._S},O.prototype.XJ=function(){var t=this;t.condition()&&t.condition().initExpression()},O.prototype.g6t=function(t){this.condition()&&this.condition().ranges(t)},O.prototype.qJ=function(t,n,i){var r,e,o,a,u,s,f,c,l,s,h,v,d,r=this,e=!1;for(r.XJ(),a=0,u=(o=r._S).length;a<u;a++)f=(s=o[a]).row,c=s.rowCount,l=s.col,s=s.colCount,h=f===t.row&&c===t.rowCount&&t.col<=l&&s<=t.colCount,v=f===n.row&&c===n.rowCount&&n.col<=l&&s<=n.colCount,(d=h||v)&&(o[a]=m(f,l,c+i,s),e=!0);return e&&r.g6t(o),e},O.prototype.JO=function(t,n,i,r){var e,o,a,u,s,f,c;if(!(t<0||n<=0)){for(this.condition()&&this.condition().initExpression(),e=0;e<this._S.length;e++)if(a=(o=this._S[e]).row,i&&0<i.length){for(u=!1,s=0,f=i.length;s<f;s++)if((c=i[s])&&(!0!==r||c.containsRange(o)))if(r){if(c.row===a&&c.row+c.rowCount-n===a+o.rowCount&&a+o.rowCount===t){o.rowCount+=n,u=!0;break}if(t+n===a&&t===c.row&&c.row+c.rowCount===a+o.rowCount){o.row-=n,o.rowCount+=n;break}}else{if(c.row===a&&c.row+c.rowCount-n===a+o.rowCount&&a===t){o.rowCount+=n,u=!0;break}if(t<=a){o.row+=n;break}if(t<=a+o.rowCount){o.rowCount+=n;break}}if(u)break}else t<=a?o.row+=n:t<=a+o.rowCount&&(o.rowCount+=n);this.condition()&&this.condition().ranges(this._S)}},O.prototype.xP=function(e,o){var a;e<0||o<=0||(this.condition()&&this.condition().initExpression(),a=[],this._S.forEach(function(t){var n,i,r,n=t.row,i=t.rowCount;e<n?((r=e+o-n)<=0?n-=o:(n-=1+r,t.rowCount-=r),t.row=n=n<0?e:n):n<=e&&e<n+i&&(t.rowCount-=p(o,n+i-e)),(0<t.rowCount||-1===t.row&&-1===t.rowCount)&&a.push(t)}),this._S=a,this.condition()&&this.condition().ranges(this._S))},O.prototype.qO=function(t,n,i,r){var e,o,a,u,s,f,c,l;if(!(t<0||n<=0)){for(this.condition()&&this.condition().initExpression(),e=0;e<this._S.length;e++){if(o=this._S[e],i&&0<i.length){for(u=a=!1,s=0,f=i.length;s<f;s++)if((c=i[s])&&!c.containsRange(o))a=!0;else{if(r&&c&&c.col===o.col-n&&c.col+c.colCount===o.col+o.colCount&&c.col===t){o.colCount+=n,o.col-=n,u=!0;break}if(c&&c.col===o.col&&c.col+c.colCount-n===o.col+o.colCount&&c.col===t){o.colCount+=n,u=!0;break}}if(a)continue;if(u)break}l=o.col,r?l<=t&&t<=l+o.colCount&&(o.colCount+=n):t<=l?o.col+=n:t<=l+o.colCount&&(o.colCount+=n)}this.condition()&&this.condition().ranges(this._S)}},O.prototype.NP=function(e,o){var a;e<0||o<=0||(this.condition()&&this.condition().initExpression(),a=[],this._S.forEach(function(t){var n,i,r,n=t.col,i=t.colCount;e<n?((r=e+o-n)<=0?n-=o:(n-=r,t.colCount-=r),n<0&&(t.colCount+=n,n=0),t.col=n):n<=e&&e<n+i&&(t.colCount-=p(o,n+i-e)),(0<t.colCount||-1===t.col&&-1===t.colCount)&&a.push(t)}),this._S=a,this.condition()&&this.condition().ranges(this._S))},O.prototype.rv=function(t,n,i,r,e,o){var a,u,s,f,u,s,c,l,h,o,e,a=this;i?((u=T(t,"sqref"))&&(s=g.formulaToRanges(n,u.c_[0],0,0,!0)[0].ranges),a._S=s):a._S=g.formulaToRanges(n,t.sqref,0,0,!0)[0].ranges,D.Util.Co(o)&&D.Util.Ao(n,a._S,!0,e),f=Tt(t.type),u=st[t.operator],L(f)||a.type(f),L(u)&&(u=6),a.comparisonOperator(u),t.allowBlank===F?a.ignoreBlank(!0):a.ignoreBlank(!1),L(t.error)||a.errorMessage(A(Z(t.error))),L(t.errorTitle)||a.errorTitle(A(t.errorTitle)),L(t.errorStyle)||a.errorStyle(ct[t.errorStyle]),L(t.prompt)||a.inputMessage(A(Z(t.prompt))),t.showDropDown===F&&a.inCellDropdown(!1),L(t.promptTitle)||a.inputTitle(A(t.promptTitle)),t.showErrorMessage!==F&&a.showErrorMessage(!1),t.showInputMessage!==F&&a.showInputMessage(!1),(s=t.c_)&&0<s.length&&(i?s.forEach(function(t){var n;t&&(n=T(t,"f"),h=A(n&&n.c_[0]),"formula1"===t.n_&&(c=C(h,f)),"formula2"===t.n_)&&(l=C(h,f))}):s.forEach(function(t){t&&(h=A(K(t)),"formula1"===t.n_&&(c=C(h,f)),"formula2"===t.n_)&&(l=C(h,f))})),L(f)||(o=void 0,1===f||2===f?o=wt(u,V(c,r),V(l,r),1===f):3===f?(h=c||l)&&(o='"'===h[0]&&'"'===h[h.length-1]?Dt(W(h)):St(P(h))):4===f||5===f?o=(5===f?kt:Ot)(u,c,l):6===f?o=Mt(u,V(c,r),V(l,r)):7===f&&void 0!==c&&(o=Vt(c)),o&&(e=o.condition())&&(e.ranges(a._S),e.ignoreBlank(a.ignoreBlank()),e.context(n),a.condition(e))),a.Mf=n,t.lossless&&t.lossless.highlightStyle&&(a.l6t=JSON.parse(t.lossless.highlightStyle))},O.f6t=1,w=O,t.DefaultDataValidator=w,e={errorStyle:n("errorStyle",0),ignoreBlank:n("ignoreBlank",!0,function(t){this.condition()&&this.condition().ignoreBlank(t)}),preciseCompareDate:n("preciseCompareDate",!1,function(t){this.condition()&&this.condition().preciseCompareDate(t)}),inCellDropdown:n("inCellDropdown",!0),showInputMessage:n("showInputMessage",!0),showErrorMessage:n("showErrorMessage",!0),inputTitle:n("inputTitle",""),errorTitle:n("errorTitle",""),inputMessage:n("inputMessage",""),errorMessage:n("errorMessage",""),comparisonOperator:n("comparisonOperator",6),condition:n("condition",d),type:n("type",0)},s.extend(w.prototype,e),t.Hrt=bt,t.kf=k,t.createNumberValidator=wt,t.createDateValidator=Ot,t.createTimeValidator=kt,t.createTextLengthValidator=Mt,t.createFormulaValidator=Vt,t.createFormulaListValidator=St,t.createListValidator=Dt,s.extend(D.Worksheet.prototype,{getDataValidator:function(t,n,i){var t=this.hG(t,n,i);return t?t[0]:E},hG:function(t,n,i){return 3===(i=L(i)?3:i)?this.b8.p6t(t,n):E},setDataValidator:function(t,n,i,r,e,o){var a,u,s,f,i,r,a=this,u=a.b8;arguments.length<5&&(e=i,o=r,i=-1===t?-1:1,r=-1===n?-1:1),3===(o=L(o)?3:o)&&(s=a.getDataValidator(t,n,o),(f=1===i&&1===r)&&s===e||(a.Ut.b6t(),i=m(t,n,i,r),u.y6t(i),e&&u.w6t(e,i),a.Ut.b6t(!0),r="validator",f&&(a.Rj(r,t,n,o,s,e),-1!==t&&-1===n?a.dj(t,o,r,e,s):-1===t&&-1!==n&&a.vj(n,o,r,e,s)),a.zw()))},isValid:function(t,n,i,r){var e,o,e=this;try{if(e.Ubt=t,e.Hbt=n,e.zbt=i,e.Gbt=!0,o=e.getDataValidator(t,n))return o.isValid(e,t,n,i,r)}finally{e.Ubt=-1,e.Hbt=-1,e.zbt=d,e.Gbt=!1}return!0},G1:function(){var t,n,i,n,n,t=this;return!(t.M6t||(t.M6t=!0,(n=t.KD)&&((i=n.parentNode)&&i.removeChild(n),t.KD=d),(n=t.a6t)&&(s(n).unbind("click"),(i=n.parentNode)&&i.removeChild(n),t.a6t=d),(n=t.gf)&&(s(n).unbind("keydown").unbind("blur").unbind("click").unbind("change"),(i=n.parentNode)&&i.removeChild(n),t.gf=d),t.M6t=!1))},xyt:function(){var t,n,i,r,e,o,a,t=this,n=[],i=t.b8,r=i&&i.YB;if(r)for(e in r)jt(a=(o=r[e])&&o.condition())&&n.push({validator:o,sheet:t});return n},Sge:function(t,n){var t=this.getDataValidator(t,n);return t&&jt(t.condition())}}),s.extend(D.Workbook.prototype,{xyt:function(){var n,t,i,n=[],t,i;return this.sheets.forEach(function(t){var t=t.xyt();t&&t.length&&t.forEach(function(t){n.push(t)})}),n}}),s.extend(D.CellRange.prototype,{validator:function(t){var n,i,r,e,o,a,u,n=this,i=n.sheet,r=n.sheetArea,e=n.row,o=n.col,a=n.rowCount,u=n.colCount;return 0===arguments.length?i.getDataValidator(e,o,r):(i.setDataValidator(e,o,a,u,t,r),n)}}),M.prototype.getUsedRange=function(){var t,n,i,r,e,o,a,u,s,f,t,n=this.p6t(),i={};if(n)for(r=void 0,e=0,o=n;e<o.length;e++)for(u=0,s=r=(a=o[e]).smt();u<s.length;u++)f=s[u],c(i,U(f));return i},M.prototype.L0=function(){this.eJ=d},M.prototype.GJ=function(t){return xt(this.eJ,t)},M.prototype.OX=function(t){return Lt(this.eJ,t)},M.prototype.C8=function(t,n,i){var r,e,o,a,r=this,e=r.YB;if(L(n)?r.h6t={}:r.h6t.cellCache={},e)for(o in e)(a=e[o])&&(t&&delete a.C6t,r.fE(a,!0,n,i));r.S6t()},M.prototype.m6t=function(t){var n=this.d6t;-1===n.indexOf(t)&&n.push(t)},M.prototype.fE=function(n,t,i,r){var e=this,o=e.GJ(n.smt()),a=e.eJ,u=a.getRowCount(),s=a.getColumnCount();o&&(e.d6t.length=0,o.forEach(function(t){It(t,u,s,e,n,i,r)}),t||e.S6t())},M.prototype.RX=function(t){var n=this,t=n.GJ(t.smt());n.d6t.length=0,t.forEach(function(t){Bt(t,n)}),n.S6t()},M.prototype.BX=function(t){var n=this;t&&Bt(n.eJ.JS(t),n),n.S6t()},M.prototype.S6t=function(){var t,n,t=this.d6t;t.length&&(n=this.YB,t.forEach(function(t){t.smt().length?t.condition()&&t.condition().ranges(t.smt()):(delete n[t.id],delete t.Mf)}),t.length=0)},M.prototype.w6t=function(t,n){var i=this,r=i.eJ;if(n&&((t=t.Mf&&r!==t.Mf?t.clone(r):t).Mf=r,t.v6t(n)),r)return t.context(r),i.YB[t.id]=t,i.fE(t),t},M.prototype.y6t=function(t){var n,i;t&&(i=(n=this).eJ,n.BX(t),i.zw())},M.prototype.d5=function(){var t=this,n;t.eJ&&(t.YB={},t.C8())},M.prototype.p6t=function(t,i){var n,r,e,n,o,r,r,r,r,r,n=this,r=n.YB;return 0===arguments.length||(e=[],n=n.h6t,i===E&&(i=-1),-1===(t=t===E?-1:t)&&-1===i)?Ut(r):((r=(r=n.colCache)&&r[i])&&(t>=r.cacheStartRowIndex&&t<r.cacheStartRowIndex+r.cacheRowCount||-1===t&&0===r.cacheStartRowIndex)?e.push(r.dv):(r=(r=n.rowCache)&&r[t])&&(i>=r.cacheStartColIndex&&i<r.cacheStartColIndex+r.cacheColCount||-1===i&&0===r.cacheStartColIndex)?e.push(r.dv):(r=n.cellCache)&&(-1!==t&&-1!==i?(o=r[t])&&o[i]&&e.push(o[i]):-1===t?s.each(r,function(t,n){var n=n[i];n&&-1===e.indexOf(n)&&e.push(n)}):(o=r[t])&&s.each(o,function(t,n){n&&-1===e.indexOf(n)&&e.push(n)})),e)},M.prototype.qJ=function(t,n,i){var r,e,o,a,u,s,f,r=this,e,o=r.eJ.Ut,a=r.YB,u=!1;if(!L(a)){for(s in o.b6t(),a)(f=a[s])&&f.qJ(t,n,i)&&(u=!0);u&&r.C8()}},M.prototype.jve=function(t,n,i){var r,e=this.h6t;e&&qt(i?e.rowCache:e.colCache,t,n)},M.prototype.$J=function(t,n,i,r,e){var o,a,u,s,o=this,a=o.YB;if(a)for(u in a)(s=a[u])&&(i?s.JO(t,n,r,e):s.qO(t,n,r,e));e?o.C8():(o.jve(t,n,i),o.C8(E,t,i))},M.prototype.JO=function(t,n,i,r){this.$J(t,n,!0,i,r)},M.prototype.qO=function(t,n,i,r){this.$J(t,n,!1,i,r)},M.prototype.tX=function(t,n,i){var r,e,o,a,r=this,e=r.YB;if(e)for(o in e)(a=e[o])&&(i?a.xP(t,n):a.NP(t,n),0===a._S.length)&&(e[o]=E);r.C8()},M.prototype.xP=function(t,n){this.tX(t,n,!0)},M.prototype.NP=function(t,n){this.tX(t,n,!1)},M.prototype.toJSON=function(t){var n,i,r,e,n=this.YB,i=[];for(r in n)(e=n[r])&&i.push(e.toJSON(t));return i},M.prototype.fromJSON=function(t,i,r){var e=this,o=e.eJ;e.YB={},t&&t.length&&(t.forEach(function(t){var n=new w;n.fromJSON(t,i,r),n.Mf=o,e.YB[n.id]=n}),e.C8())},M.prototype.y8=function(t,n,i){this.eJ.setDataValidator(t,n,i)},dt=M,s.extend(D.Y8.prototype,{b6t:function(t){var n,i,r,e,o,a,u,n=this,i=n.G8;if(i&&(t||!i.originalValidators)){for(o in e=[],r=n.b8.YB)(a=r[o])&&(u=a._S.map(function(t){return m(t.row,t.col,t.rowCount,t.colCount)}),e.push({validator:a,ranges:u}));t?i.currentValidators=e:i.originalValidators=e}},T6t:function(t){var r,n,e;t&&(r=this.Mf,n=this.b8,e={},t.forEach(function(t){var n,i,n=t.validator;"Object"===n.constructor.name&&((i=new w).fromJSON(n,!1,r),n=i),n._S=t.ranges,n.condition()&&n.condition().ranges(n._S),e[n.id]=n}),n.YB=e,n.C8(!1))},ATt:function(t,n,i,r){this.b6t(),this.b8.JO(t,n,i,r),this.b6t(!0)},A6t:function(t,n){this.b6t(),this.b8.xP(t,n),this.b6t(!0)},NTt:function(t,n,i,r){this.b6t(),this.b8.qO(t,n,i,r),this.b6t(!0)},kTt:function(t,n){this.b6t(),this.b8.NP(t,n),this.b6t(!0)},I6t:function(t){this.b6t(),this.b8.BX(t),this.b6t(!0)},x6t:function(){this.b6t(),this.b8.C8(),this.b6t(!0)}}),D.Y8.ch("validator",{init:function(){this.b8=new dt(this.Mf)},applyChanges:function(t){var n,t,t,n=t.changes,t=t.isUndo;n&&(t=t?n.originalValidators:n.currentValidators)&&this.T6t(t)},undo:function(t){var t=t.originalValidators;t&&this.T6t(t)},dispose:function(t){var n;!1!==(t&&t.clearCache)&&this.b8&&(this.b8.L0(),this.b8=d)}}),D.Worksheet.ch("validator",{getUsedRange:function(t){var n,i,r;t.type&D.UsedRangeType.dataValidation&&(r=(i=(n=this).b8).getUsedRange(),c(t.range,r))},init:function(){var i=this;i.b8=i.Ut.b8,i._3(D.Events.FloatingElementSelected+f),i.D3(D.Events.FloatingElementSelected+f,function(t,n){"worksheet"!==n.type&&i.G1()})},dispose:function(t){var n=this;n.G1(),t.clearCache&&n.b8.d5(),!1!==t.clearCache&&n._3(D.Events.FloatingElementSelected+f)},onLayoutChanged:function(t){var n,i,r,e,o,a,u,s,f,n=t.changeType,i=t.row,r=t.rowCount,e=t.col,o=t.colCount,a=t.sheetArea,u=L(a)||3===a,s=this.Ut,f=this.tables;"addRows"===n&&u?s.ATt(i,r,f&&f.AJ(i,-1,r,-1,!0)):"deleteRows"===n&&u?s.A6t(i,r):"addColumns"===n&&u?s.NTt(e,o,f&&f.AJ(-1,e,-1,o,!1)):"deleteColumns"===n&&u?s.kTt(e,o):"clear"===n?3===a&&2==(2&t.type)&&s.I6t(m(i,e,r,o)):"setColumnCount"!==n&&"setRowCount"!==n||3!==a&&1!==a||s.x6t()},toJson:function(t,n){var i,n,n,i=this.b8,n=n&&n.ignoreStyle;i&&!n&&(n=i.toJSON(this))&&n.length&&(t.validations=n)},fromJson:function(t,n,i){var i,i,i=i&&i.ignoreStyle;t&&t.validations&&!i&&(i=t.validations,this.b8.fromJSON(i,n,this))},wh:function(t,n,i){var r,e,o,a,u,i,s,f,c,l,h,v,d,g,A,m,p,b,w,C,O,k,M,g,A,m,p,b,w,C,O,V,S,r=this,e=r.b8,o=i&&!1===i.includeStyles,a=i&&i.fileType===D.OpenSaveFileType.excel;if(!o&&e&&!r.NMi){for(l in u=e.YB,s=(i={n_:y,c_:[]}).c_,f=0,c=[],u)if((h=u[l])&&h._S&&0<h._S.length){if(f++,d=!(v={n_:x}),g=h.comparisonOperator(),A=h.ignoreBlank(),m=h.errorMessage(),p=h.errorTitle(),b=h.errorStyle(),w=h.inputMessage(),C=h.inCellDropdown(),O=h.inputTitle(),k=h.showErrorMessage(),M=h.showInputMessage(),6!==g&&(v.operator=ut[g]),!1!==A&&(v.allowBlank=F),m&&(v.error=I(G(m))),p&&(v.errorTitle=I(p)),0!==b&&(v.errorStyle=at[b]),w&&(v.prompt=I(G(w))),!1===C&&(v.showDropDown=F),O&&(v.promptTitle=I(O)),!1!==k&&(v.showErrorMessage=F),!1!==M&&(v.showInputMessage=F),g=h.condition(),A=h._S,v.sqref=Wt(A),g){if(m=h.type(),v.type=ot[m],b=(p=Yt(g)).firstFormula,w=p.secondFormula,a&&(H(b)||H(w)))continue;v.c_=[],C=r.name(),O=r.parent&&r.parent.r4(),Y(b,C,O)||Y(w,C,O)?(v.n_=x,L(b)||v.c_.push({n_:"formula1",c_:[{n_:"f",c_:[I(B(b))]}]}),L(w)||v.c_.push({n_:"formula2",c_:[{n_:"f",c_:[I(B(w))]}]}),v.c_.push({n_:"sqref",c_:[z(A)]}),d=!0):(L(b)||(4===m||5===m?v.c_.push({n_:"formula1",c_:[At(b)+""]}):v.c_.push({n_:"formula1",c_:[I(B(b))]})),L(w)||(4===m||5===m?v.c_.push({n_:"formula2",c_:[At(w)+""]}):v.c_.push({n_:"formula2",c_:[I(B(w))]})))}h.l6t&&(v.lossless={highlightStyle:JSON.stringify(h.l6t)}),(d?c:s).push(v)}0<s.length&&(i.count=f,t.c_.push(i)),0<c.length&&(V=T(t,j)).c_.push(S={n_:"ext",r_:[1,9],c_:[{n_:y,c_:c,r_:[2],count:c.length}]})}},yh:function(t,n,i){var r,e,o,a,u,s,f,c,l,h,s,t,v,d,r=this,e=r.b8,o=e.YB,a;if(!(i&&!1===i.includeStyles)&&e&&g){if(u=D.Util.ko(i),(f=(s=T(t,y))&&s.c_)&&0<f.length)for(c=f.length-1;0<=c;c--)l=f[c],(h=new w).rv(l,r,E,u,n,i),o[h.id]=h;if(s=T(t,j),(t=N(s,"dataValidations"))&&t.c_&&0<t.c_.length)for(c=(v=t.c_).length-1;0<=c;c--)d=v[c],(h=new w).rv(d,r,!0,u,n,i),o[h.id]=h;e.C8()}}}),D.Style.ch("validator",{fromJson:function(t){var n;"validator"===t.p&&((n=new w).fromJSON(t.v,t.noSchema,t.context),this.validator=n,t.r=!0)}}),i.gcGlobal.wf.push(function(t,n){!n&&t.G1&&t.G1()})},Common:function(t){t.exports=GC.Spread},CalcEngine:function(t){t.exports=GC.Spread.CalcEngine},Core:function(t){t.exports=GC.Spread.Sheets},SheetsCalc:function(t){t.exports=GC.Spread.Sheets.CalcEngine},ConditionalFormatting:function(t){t.exports=GC.Spread.Sheets.ConditionalFormatting}},r={},n=t={},Object.defineProperty(n,"__esModule",{value:!0}),n.createListValidator=n.createFormulaListValidator=n.createFormulaValidator=n.createTextLengthValidator=n.createTimeValidator=n.createDateValidator=n.createNumberValidator=n.kf=n.Hrt=n.HighlightPosition=n.HighlightType=n.DefaultDataValidator=n.ErrorStyle=n.DataValidationResult=n.CriteriaType=void 0,o("./dist/plugins/validation/datavalidation-event.js"),e=o("./dist/plugins/validation/datavalidation.js"),Object.defineProperty(n,"CriteriaType",{enumerable:!0,get:function(){return e.CriteriaType}}),Object.defineProperty(n,"DataValidationResult",{enumerable:!0,get:function(){return e.DataValidationResult}}),Object.defineProperty(n,"ErrorStyle",{enumerable:!0,get:function(){return e.ErrorStyle}}),Object.defineProperty(n,"DefaultDataValidator",{enumerable:!0,get:function(){return e.DefaultDataValidator}}),Object.defineProperty(n,"HighlightType",{enumerable:!0,get:function(){return e.HighlightType}}),Object.defineProperty(n,"HighlightPosition",{enumerable:!0,get:function(){return e.HighlightPosition}}),Object.defineProperty(n,"Hrt",{enumerable:!0,get:function(){return e.Hrt}}),Object.defineProperty(n,"kf",{enumerable:!0,get:function(){return e.kf}}),Object.defineProperty(n,"createNumberValidator",{enumerable:!0,get:function(){return e.createNumberValidator}}),Object.defineProperty(n,"createDateValidator",{enumerable:!0,get:function(){return e.createDateValidator}}),Object.defineProperty(n,"createTimeValidator",{enumerable:!0,get:function(){return e.createTimeValidator}}),Object.defineProperty(n,"createTextLengthValidator",{enumerable:!0,get:function(){return e.createTextLengthValidator}}),Object.defineProperty(n,"createFormulaValidator",{enumerable:!0,get:function(){return e.createFormulaValidator}}),Object.defineProperty(n,"createFormulaListValidator",{enumerable:!0,get:function(){return e.createFormulaListValidator}}),Object.defineProperty(n,"createListValidator",{enumerable:!0,get:function(){return e.createListValidator}}),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).DataValidation=t}();
;var GC;!function(){"use strict";var i,r,t;function e(t){var n,n,n=r[t];return void 0!==n||(n=r[t]={exports:{}},i[t].call(n.exports,n,n.exports,e)),n.exports}i={"./dist/plugins/fill/drag-fill.js":function(F,t,n){var i,c,x,h,t,r,e,I,s,O,A,S,v,n,R,j,r,l,b,u,T,M,k,E,d,o,a,f,g,t,p,w,m,H,N,P,G,_,L,B,W;function $(t,n,i,r,e,o,u,s,a,l,f){var c=n?x.Events.DragDropBlock:x.Events.DragDropBlockCompleted,i={sheet:t,sheetName:t.name(),fromRow:i,fromCol:r,toRow:e,toCol:o,rowCount:u,colCount:s,copy:a,insert:l,copyOption:f};return n&&(i.cancel=!1),t.ki(c,i),i}function z(t,n,i,r){return t&&n&&n.containsRange(t)&&(!O(i)&&(1===i&&t.row===n.row&&(0,I.getRowCount)(t)===(0,I.getRowCount)(n)||0===i&&t.col===n.col&&(0,I.getColCount)(t)===(0,I.getColCount)(n))||!(O(r)||(2!==r&&3!==r||t.col!==n.col||(0,I.getColCount)(t)!==(0,I.getColCount)(n))&&(0!==r&&1!==r||t.row!==n.row||(0,I.getRowCount)(t)!==(0,I.getRowCount)(n))))}function C(t,n){var i,r,e,o,u,s,a,l,f,c,a,i=L.call(this)||this,r=i,e=n[E],o=0===e,u=o||1===e,s=n[M],a=n[T],l=a.row,f=a.col,c=(0,I.getRowCount)(a),a=(0,I.getColCount)(a);return r.Mf=t,4===(r.Ftt=n)[k]?r.Ptt=new x.Commands.JI(t,{ranges:[n[M]]}):r.Gtt=u?v(l,o?s.col:f,c,a+(0,I.getColCount)(s)):v(2===e?s.row:l,f,c+(0,I.getRowCount)(s),a),r.Utt=u?1:0,i}function y(t,n){var i,r,i=B.call(this)||this,r=i;return r.Mf=t,r.Htt=n,r.ztt=n[T],r.Vtt=n[M],r.Ytt=n[k],r.Ztt=n[E],i}function V(t,n,i,r,e,o){var u,r,e,n,u=t.getSelections();t.IA(),t.n4(n,i,r,e,!0),r=t.getSelections(),e=0<n?n:t.N9(),n=0<i?i:t.k9(),t.O6(e,n,t.R9,t.B9),t.jA(u),t.parent&&o._oldPosition&&t.parent.changeSelectionInCommandExecuting(o,null,null,r)}function q(t){var n;t.parent.repaint()}function D(t,n){var i,n,i=this;return(i=W.call(this,t,n)||this).MU=null!=(n=n.option)?n:t.lF,i}i=this&&this.__extends||(_=function(t,n){return(_=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}_(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(t,"__esModule",{value:!0}),c=n("Common"),x=n("Core"),h=n("./dist/plugins/fill/fill.js"),t=n("./dist/plugins/fill/fill.ns.js"),r=n("CalcEngine"),e=n("Touch"),I=n("./dist/plugins/fill/utils.js"),s=!!r,O=c.Common.lt.ht,A=null,S=void 0,v=x.Ec,n=x.GC$,R=Math.max,j=Math.floor,r=x.Commands.ActionBase,l=x.Commands.CI,b=x.Commands.SI,u=x.CopyToOptions.all,T="startRange",M="fillRange",k="autoFillType",E="fillDirection",d="cancel",o="fill",a="dragDrop",f=n.isEmptyObject,g="onLayoutChanged",t=new c.Common.ResourceManager(t.SR,"Fill"),p=t.getResource.bind(t),w="gc-drag-header-mask",m="gc-drag-header-indicator",n.extend(x.Worksheet.prototype,H={fillAuto:function(t,n,i){if(!n)throw new Error(p().Exp_RangeIsNull);var r=this,e=i.fillType,o=i.series,u=i.direction,s=i.step,a=i.stop,l=new h.Wtt(r),f=i.Qtt;if(z(t,n,u?A:o,u)){r.suspendPaint(),t&&(r.rt.Ktt=t);try{4===e?l.Jtt(n,o,!1,i.withTag,i.withoutStyle,f):0===e?l.Xtt(n,u):1===e||2===e?l.qtt(1===e,n,o,s,a):3===e&&l.$tt(n,o,3,s,O(a)?A:c.Common.ct.o0(a),i.unit)}finally{r.resumePaint()}}},TRe:function(){var t,t;return(null==(t=null==(t=null==this?void 0:this.parent)?void 0:t.options)?void 0:t.dragHeaderMaskBackColor)||x.I.fl(w).backgroundColor},IRe:function(){var t,t;return(null==(t=null==(t=null==this?void 0:this.parent)?void 0:t.options)?void 0:t.dragHeaderIndicatorColor)||x.I.fl(m).borderTopColor}}),x.Worksheet.ch(o,{init:function(){this.tnt=new h.nnt(this)},setHost:function(t){var t;t&&((t=this.Qy())[o]||t.register(o,x.Commands[o]),t[a]||t.register(a,x.Commands[a]),this.D3(x.Events.TopRowChanged+"."+o,function(t,n){var n=n.sheet.R_;n&&n.kRe()}),this.D3(x.Events.LeftColumnChanged+"."+o,function(t,n){var n=n.sheet.R_;n&&n.kRe()}),this.D3(x.Events.ViewZoomed+"."+o,function(t,n){var n=n.sheet.R_;n&&n.close()}),this.D3(x.Events.EditStarted+"."+o,function(t,n){var n=n.sheet.R_;n&&n.close()}),this.D3(x.Events.FloatingObjectSelectionChanged+"."+o,function(t,n){var n=n.sheet.R_;n&&n.close()}),this.D3(x.Events.ShapeSelectionChanged+"."+o,function(t,n){var n=n.sheet.R_;n&&n.close()}))},dispose:function(t){var t;!1!==t.clearCache&&(t=this).tnt&&(t.tnt.L0(),t.tnt=A),this._3(x.Events.TopRowChanged+"."+o),this._3(x.Events.LeftColumnChanged+"."+o),this._3(x.Events.ViewZoomed+"."+o),this._3(x.Events.EditStarted+"."+o),this._3(x.Events.FloatingObjectSelectionChanged+"."+o),this._3(x.Events.ShapeSelectionChanged+"."+o)},preProcessKeyDown:function(t){var n=this.R_;n&&n.close()},preProcessMouseDown:function(t){var n=this.R_;n&&n.close()},preProcessContextMenu:function(t){var n=this.R_;n&&n.close()}}),x.Workbook.ch(o,{onCultureChanged:function(){p()}}),x.Hv.ch(o,{preProcessMouseDown:function(t){var n,n,n=(0,x.jf)(this.Vv),n=n&&n.R_;n&&n.close()}}),x.Of.touch&&e.TouchEventHandler.ch(o,{preProcessManipulationStarted:function(t){var n=this.Mf.R_;n&&n.close()},preProcessTapped:function(t){var n=this.Mf.R_;n&&n.close()},preProcessDoubleTapped:function(t){var n=this.Mf.R_;n&&n.close()}}),window.gcGlobal.wf.push(function(t,n){var n;n&&!x.util.Kg(n,t)||null!=(n=t.R_)&&n.close()}),i(C,L=r),C.prototype.canExecute=function(){var t=this,n=t.Mf,t=t.Ftt,i=t[T],r=t[M];return!(!n.PT(r.row,r.col,(0,I.getRowCount)(r),(0,I.getColCount)(r),{isIgnoreFilterOutRow:!0,sheetArea:x.SheetArea.viewport})||4!==t[k]&&r.intersect(i.row,i.col,(0,I.getRowCount)(i),(0,I.getColCount)(i)))},C.prototype.execute=function(){var t,n,i,r,e,o,o,t=this;if(t.canExecute()){i=(n=t.Ftt)[M],e=(r=t.Mf).parent.i4(),x.Commands.II(e),t.X5(r,!0);try{s&&r.suspendCalcService(),o=r.getSelections(),r.isDirtySuspended()||(t.ent=new l(r,n[M],u)),4===n[k]?t.int(r):t.rnt(r),r.EA(o,r.getSelections())&&r.jA(o)}finally{t.q5(r,!0),s&&r.resumeCalcService(!1),x.Commands.xI(e,n),r.Q1i&&r.Q1i(i.row,i.col,(0,I.getRowCount)(i),(0,I.getColCount)(i)),o=[],r.isDirtySuspended()||(t.ont=new l(r,i,u),t.ont.yI(t.ent.bI()),o=t.ont.MI()),b(r,i.row,i.col,(0,I.getRowCount)(i),(0,I.getColCount)(i),o,1)}}},C.prototype.int=function(t){var n,i,r,i,n,e,o,e,o,n,n=this;n.Ptt.execute(t),r=(i=n.Ftt)[T],i=i[M],n=0===n.Utt,o=(0,I.getRowCount)(r),e=(0,I.getColCount)(r),o=n?R(1,o-(0,I.getRowCount)(i)):o,n=n?e:R(1,e-(0,I.getColCount)(i)),r.equals(i)||(e=v(r.row,r.col,o,n),t.O6(R(t.N9(),e.row),R(t.k9(),e.col),t.R9,t.B9),t.IA(),t.n4(e.row,e.col,(0,I.getRowCount)(e),(0,I.getColCount)(e)))},C.prototype.rnt=function(t){var n,i,r,e,o,u,s,a,l,f,c,h,v,d,g,p,w,m,_,C,y,D,r,F,b,n=this,i=n.Mf,r=n.Ftt,e=r[T],o=r[M],u=r[k],s=n.Gtt,f={fillType:4,series:n.Utt,withTag:!0,withoutStyle:!(i.lF&x.CopyToOptions.style)},c=i.tables,h=!1,v=new x.Range(s.row,s.col,s.rowCount,s.colCount);if(c)try{p=0===(d=r[E]),(g=2===d)&&(w=e.rowCount,m=0===c.AB(e.row,e.col,w,e.colCount).length)&&(h=!0,v.rowCount-=w),p&&(_=e.colCount,m=0===c.AB(e.row,e.col,e.rowCount,_).length)&&(h=!0,v.colCount-=_),C=[],y=[],c.yx(A,v,S,S,S,C,{applyDragFillAfterTableExpand:h,backupTableResizedArgs:y}),0<C.length&&(f.Qtt=C),n.lCe=y}catch(t){return i.jT(6,t.message),void i.resumePaint()}if(1===u){if(i.fillAuto(e,s,f),i.lF&x.CopyToOptions.style&&i.Ut.eE(e.row,e.col,e.rowCount,e.colCount))for(a=0;a<o.rowCount;a++)for(l=0;l<o.colCount;l++)(D=i.vI(e.row+j(a%e.rowCount),e.col+j(l%e.colCount)))&&D.clone&&(D=D.clone()),i.CL(o.row+a,o.col+l,D)}else 0===u?(r=i.lF&~x.CopyToOptions.comment,n.ant(e,o,r)):2===u?n.ant(e,o,4320):3===u&&((F=!(1!==(0,I.getRowCount)(e)||1!==(0,I.getColCount)(e)||-1===e.row&&-1!==e.col||-1===e.col&&-1!==e.row))?n.ant(e,o,b=4251):(f.withoutStyle=!0,i.fillAuto(e,s,f)));i.O6(R(t.N9(),s.row),R(t.k9(),s.col),t.R9,t.B9),t.IA&&t.IA(),i.n4(s.row,s.col,(0,I.getRowCount)(s),(0,I.getColCount)(s))},C.prototype.ant=function(t,n,i){var r,e,t,n,o,u,s,a,l,f,c,h,t,v,d,g,n,p,t,w,r,r,m,_,C,r=this,e=r.Mf,t=e.JS(t),n=e.JS(n),o=t.row,u=t.col,s=(0,I.getRowCount)(t),a=(0,I.getColCount)(t),l=n.row,f=n.col,c=(0,I.getRowCount)(n),h=(0,I.getColCount)(n),t=r.Ftt[E],v=3===t,d=1===t,g=j(c/s),n=c%s,p=j(h/a),t=h%a;if(e.HB=!0,C=function(t,n){return e.isActualProtected()&&e.getCell(t,n).hidden()},0===r.Utt){for(w=0;w<g;w++)m=v?l+w*s:l+c-(w+1)*s,C(o,u)&&(i&=~x.CopyToOptions.formula),e.vT(o,u,m,f,s,a,i,!0,!0);0!=n&&(m=v?l+s*g:l+c-g*s-n,C(r=v?o:o+(g+1)*s-c,u)&&(i&=~x.CopyToOptions.formula),e.vT(r,u,m,f,n,a,i,!0,!0))}else{for(w=0;w<p;w++)_=d?f+w*a:f+h-(w+1)*a,C(o,u)&&(i&=~x.CopyToOptions.formula),e.$He=_-u,e.vT(o,u,l,_,s,a,i,!0,!0),delete e.$He;0!=t&&(_=d?f+a*p:f+h-p*a-t,C(o,r=d?u:u+(p+1)*a-h)&&(i&=~x.CopyToOptions.formula),e.vT(o,r,l,_,s,t,i,!0,!0))}delete e.HB,e.recalcRange(l,f,c,h)},C.prototype.undo=function(){var t,n,i,r,e,o,u,t=this,n=t.Mf,i=!1;if(t.canUndo()){t.X5(n,!0);try{s&&n.suspendCalcService(),r=n.getSelections(),e=t.Ftt,o=n.R_,u=e[M],i=4===e[k]?t.unt(n):t.snt(n),!n.cnt&&o&&o.close(),b(n,u.row,u.col,(0,I.getRowCount)(u),(0,I.getColCount)(u),t.ont?t.ont.MI():[],1,S,!0),n.EA(r,n.getSelections())&&n.jA(r)}finally{t.q5(n,!0),s&&n.resumeCalcService(!1)}}return i},C.prototype.unt=function(t){var n,i,r,i,e,n=this,i=n.Ftt[T],r=i.row,i=i.col,e=x.Commands.TI(t.name());return t.Ut.undo(n.Ftt[e]),t.O6(R(t.N9(),r),R(t.k9(),i),t.R9,t.B9),!0},C.prototype.snt=function(t){var n,i,r,e,r,o,n,i=this.Ftt,r=i[T],e=r.row,r=r.col;s&&t.suspendCalcService();try{o=x.Commands.TI(t.name()),t.Ut.undo(i[o]),t.O6(R(t.N9(),e),R(t.k9(),r),t.R9,t.B9)}finally{s&&t.resumeCalcService(!1)}return t.invalidateLayout(),!0},N=C,i(y,B=r),y.prototype.execute=function(){var t,n,i,r,e,o,u,s,a,l,f,t=this,n=!1;if(t.canExecute()){r=(i=t.Mf).parent,e=t.Vtt,o=t.Htt,u=i.parent.i4(),x.Commands.II(u),t.XI(),t.X5(i,!0),i.QI=!0;try{s=i.getSelections(),a=void 0,l=i.rt,(f={sheet:i,sheetName:i.name(),cancel:!1})[M]=e,f[k]=t.Ytt,f[E]=t.Ztt,i.ki(x.Events.DragFillBlock,f),l.fnt=f[k],l.lnt=f[d],f[d]||(t.hnt(f),i.ki(x.Events.DragFillBlockCompleted,f)),n=!0,a=i.getSelections(),i.EA(s,a)&&i.jA(s),r&&o._oldPosition&&r.changeSelectionInCommandExecuting(o,null,null,a)}finally{t.q5(i,!0),i.QI=!1,t.dnt(i,e),x.Commands.xI(u,t.Htt)}}return n},y.prototype.hnt=function(t){var n,i,r,e,o,r,e,n=this,i=n.Mf,r=i.rt,e=n.Vtt,o=n.Ytt;r.fnt=o,r.lnt||((r={})[T]=n.ztt,r[M]=e,r[k]=5===t[k]?o:t[k],r[E]=n.Ztt,e=new N(i,r),i.suspendEvent(),e.execute(),i.resumeEvent(),n.Htt.vnt=e)},y.prototype.XI=function(){var t=this;t.Mf.isDirtySuspended()||(t.ent=new l(t.Mf,t.Vtt,u))},y.prototype.undo=function(){var t,n,i,r,e,o,u,s,a,n=this;if(n.canUndo()){i=n.Mf,r=n.Vtt,e=i.parent,o=n.Htt,n.XI(),n.X5(i,!0);try{u=i.getSelections(),i.suspendEvent(),i.Nj=!0,s=i.parent.i4(),x.Commands.NI(s,o),i.Nj=!1,i.resumeEvent(),a=o[T],i.EA(u,[a])&&i.jA(u),e&&o._oldPosition&&e.changeSelectionInCommandExecuting(o,null,null,[a]),(0,x.handleRestoredTableResizedArgs)(null==(t=o.vnt)?void 0:t.lCe)}finally{n.q5(i,!0),n.dnt(i,r,!0)}}return!0},y.prototype.dnt=function(t,n,i){var r,e,o,r=this,e=[];t.isDirtySuspended()||((o=new l(t,n,u)).yI(r.ent.bI()),e=o.MI()),b(t,n.row,n.col,(0,I.getRowCount)(n),(0,I.getColCount)(n),e,1,S,i)},P=y,i(D,W=r),D.prototype.Spn=function(){return this.MU},D.prototype.NRe=function(t){this.MU=t},D.prototype.canExecute=function(){var t,n,i,r,e,o,u,s,a,l,f,c,h,l,v,d,g,p,l,t=this,n=t.Mf,i=t.tT,r=i.fromRow,e=i.fromColumn,o=(0,I.getRowCount)(i),u=i.columnCount,s=i.toRow,a=i.toColumn,l=!i.copy,f,c;if(n.tables&&n.tables.mx(n,{row:r,col:e,rowCount:o,colCount:u},n,{row:s,col:a,rowCount:o,colCount:u},l))return!1;if(!n.zT(r,e,o,u,(0,I.getSheetRowCount)(n),(0,I.getSheetColumnCount)(n)))return!1;if(!i.insert&&!n.zT(s,a,o,u,(0,I.getSheetRowCount)(n),(0,I.getSheetColumnCount)(n)))return!1;if(i.cmd===x.RangeChangedAction[0]&&n.tables&&(h=!1,0<(l=n.tables.AB(r,e,o,u)).length)){for(d=(v=l[0].range()).row;d<v.row+v.rowCount;d++)if(n.isRowFilterOut(d)){h=!0;break}return!(h&&v.contains(i.mouseTargetRow,i.mouseTargetCol,1,1))}return l=t.mnt(g=0<=s&&a<0&&0<=r&&e<0&&0<o&&u<0,p=s<0&&0<=a&&r<0&&0<=e&&o<0&&0<u),n.PT(s,a,o,u,{isAllowDragInsert:l,sheetArea:x.SheetArea.viewport})&&n.PT(r,e,o,u,{isAllowDragInsert:l,sheetArea:x.SheetArea.viewport})},D.prototype.mnt=function(t,n){var i,r,i,r,e,i,e,i,i=this,r=i.tT,i=i.Mf,r=r.insert,e=i.isActualProtected(),i=i.options.protectionOptions;return!(!e||f(i)||(e=i.allowDragInsertRows,i=i.allowDragInsertColumns,!r)||!(e&&t||i&&n))},D.prototype.execute=function(){var t,n,i,r,e,o,u,s,a,l,f,c,h,v,d,g,p,w,m,_,C,y,D,F,b,R,j,T,M,k,t=this,n=!1;if(t.canExecute()){if(i=t.Mf,e=(r=t.tT).fromRow,o=r.fromColumn,u=r.toRow,s=r.toColumn,a=r.columnCount,l=r.insert,f=r.copy,(h=$(i,!0,e,o,u,s,c=r.rowCount,a,f,l,i.lF)).cancel)return;t.XI(),g=d=v=void 0,p=c,w=a,m=i.parent.i4(),(_=i.o5())&&(p+=i.lT(u,c,!0),w+=i.lT(s,a)),x.Commands.II(m),t.X5(i,!0),i.QI=!0,C=void 0;try{this.NRe(h.copyOption);try{y=[],C={shiftCells:r.insert&&r.shiftCells===x.InsertShiftCell.down,isCopy:r.copy,isFirst:!0},i.tables&&i.tables.yx(i,new x.Range(u,s,p,w),new x.Range(e,o,c,a),A,A,A,{shiftInfo:C,backupTableResizedArgs:y}),r.Kh.lCe=y}catch(t){return i.jT(6,t.message),void i.resumePaint()}r.insert?0<=o&&e<0?(v=o,g=a,D=d=s,this.rHe(i,v,d,g)&&(i.r9e(d,g,S,{ignoreExpand:!0}),r.copy?i.copyTo(-1,d<=v?v+g:v,-1,d,-1,g,this.Spn()):(i.moveTo(-1,d<=v?v+g:v,-1,d,-1,g,this.Spn(),void 0,i.getRowCount()<1),i.deleteColumns(d<=v?v+g:v,g),v<d&&(D=d-g)),V(i,-1,D,(0,I.getSheetRowCount)(i),g,r))):0<=e&&o<0?(v=e,g=c,F=d=u,this.oHe(i,v,d,g)&&(i.ffe(d,g,S,{ignoreExpand:!0}),r.copy?i.copyTo(d<=v?v+g:v,-1,d,-1,g,-1,this.Spn()):(i.moveTo(d<=v?v+g:v,-1,d,-1,g,-1,this.Spn(),void 0,i.getColumnCount()<1),i.deleteRows(d<=v?v+g:v,g),v<d&&(F=d-g)),V(i,F,-1,g,(0,I.getSheetColumnCount)(i),r))):0<=e&&0<=o&&(b=r.shiftCells,R=new x.Range(u,s,1,1),j=[new x.Range(e,o,c,a)],O(b)||(T={cmd:"clipboardPaste",sheetName:i.name(),clipboardHtml:"",clipboardImage:"",clipboardText:"",fromRanges:j,fromSheet:i,isCutting:!r.copy,pasteOption:0,pastedRanges:[new x.Range(u,s,c,a)],cA:R,fA:j,_shiftCells:b,bx:!0,px:C&&C.ignoreFooterShiftIndex},i.Qy().execute(T),M=i.getSelections()[0],b===x.InsertShiftCell.down&&e<u&&!r.copy&&o===s?i.setSelection(M.row-c,M.col,M.rowCount,M.colCount):b===x.InsertShiftCell.right&&o<s&&!r.copy&&e===u&&i.setSelection(M.row,M.col-a,M.rowCount,M.colCount))):(r.copy?i.copyTo(e,o,u,s,c,a,this.Spn()):i.moveTo(e,o,u,s,c,a,this.Spn()),i&&(V(i,u,s,p,w,r),k=r.Kh,r.copy||i.isDirtySuspended()||(k.wx=t.gnt(i,k.qI,e,o,c,a)),i.isDirtySuspended()||(k.Mx=t.gnt(i,k.$I,u,s,c,a)))),n=!0}finally{i.rt.q6={},t.q5(i,!0),i.QI=!1,$(i,!1,e,o,u,s,c,a,f,l,this.Spn()),x.Commands.xI(m,r)}q(i)}return n},D.prototype.gnt=function(t,n,i,r,e,o){var u,s,u=new l(t,v(i,r,e,o),this.Spn()),s=t.tables&&t.tables.WI&&t.tables.WI(i,r,e,o);return s&&0<s.length&&(this.tT.tableNamesObj={r:i,c:r,rc:e,cc:o,tableNames:s}),u.yI(n.bI()),b(t,i,r,e,o,u.MI(),0,s),u},D.prototype.XI=function(){var t,n,t,i,r,e,o,u,s,a,o,u,r,e,t=this,n=t.Mf,t=t.tT,i=t.Kh;i=i||(t.Kh={}),s=(r=t.fromRow)<0?0:r,a=(e=t.fromColumn)<0?0:e,o=(o=t.toRow)<0?0:o,u=(u=t.toColumn)<0?0:u,r=r<0?(0,I.getSheetRowCount)(n):(0,I.getRowCount)(t),e=e<0?(0,I.getSheetColumnCount)(n):t.columnCount,t.insert||n.isDirtySuspended()||(t.copy||(i.qI=new l(n,v(s,a,r,e),this.Spn())),i.$I=new l(n,v(o,u,r,e),this.Spn())),i.pnt=n.R9,i.bnt=n.B9,i.ynt=n.ui,i.wnt=n.ci},D.prototype.undo=function(){var t,n,i,r,e,o,u,s,a,l,f,c,h,v,d,g,p,w,m,_,C,y,D,F,t=this;if(t.canUndo()){if(n=t.Mf,r=(i=t.tT).fromRow,e=i.fromColumn,o=i.toRow,u=i.toColumn,s=(0,I.getRowCount)(i),a=i.columnCount,!n.zT(r,e,s,a,(0,I.getSheetRowCount)(n),(0,I.getSheetColumnCount)(n)))return!1;if(!i.insert&&!n.zT(o,u,s,a,(0,I.getSheetRowCount)(n),(0,I.getSheetColumnCount)(n)))return!1;f=i.Kh,t.X5(n,!(l=void 0)),c=n.parent.i4(),x.Commands.NI(c,i);try{i.insert?0<=e&&0<=r||(0<=e?(l=a,n&&V(n,-1,e,(0,I.getSheetRowCount)(n),l,i)):0<=r&&(l=s,n)&&V(n,r,-1,l,(0,I.getSheetColumnCount)(n),i)):(d=r<0?0:r,g=e<0?0:e,p=o<0?0:o,w=u<0?0:u,m=r<0?(0,I.getSheetRowCount)(n):s,_=e<0?(0,I.getSheetColumnCount)(n):a,n&&(V(n,r,e,s,a,i),C=i.tableNamesObj,y=[],D=[],C&&(C.r===p&&C.c===w&&C.rc===m&&C.cc===_?D=C.tableNames:y=C.tableNames),b(n,p,w,m,_,f.Mx?f.Mx.MI():[],0,y,!0),b(n,d,g,m,_,f.wx?f.wx.MI():[],0,D,!0))),n&&(-1!==f.ynt&&-1!==f.wnt&&((F=n.getSelections()[0]).contains(f.ynt,f.wnt)?n.XA(f.ynt,f.wnt):n.XA(F.row,F.col)),-2!==f.pnt&&-2!==f.bnt&&-1!==f.ynt&&-1!==f.wnt&&n.showCell(f.ynt,f.wnt,3,3),(0,x.handleRestoredTableResizedArgs)(f.lCe))}finally{t.q5(n,!0)}q(n)}return!0},D.prototype.rHe=function(t,n,i,r){var i={changeType:"addingColumns",col:i,colCount:r,canAdd:!0,onlyCheck:!0,sheetArea:x.SheetArea.viewport};return x.Worksheet.et(t,g,i),!!i.canAdd&&(i={changeType:"deletingColumns",col:n,colCount:r,canDelete:!0,onlyCheck:!0,sheetArea:x.SheetArea.viewport},x.Worksheet.et(t,g,i),i.canDelete)},D.prototype.oHe=function(t,n,i,r){var i={changeType:"addingRows",row:i,rowCount:r,canAdd:!0,onlyCheck:!0,sheetArea:x.SheetArea.viewport};return x.Worksheet.et(t,g,i),!!i.canAdd&&(i={changeType:"deletingRows",row:n,rowCount:r,canDelete:!0,onlyCheck:!0,sheetArea:x.SheetArea.viewport},x.Worksheet.et(t,g,i),i.canDelete)},G=D,x.Commands[o]={canUndo:!0,execute:function(t,n,i){return x.Commands.zA(t,P,n,i)}},x.Commands[a]={canUndo:!0,execute:function(t,n,i){return x.Commands.zA(t,G,n,i)}}},"./dist/plugins/fill/drag-header-to-move/event.js":function(t,n,i){var n,w,f,a,i,m,r,e;function _(t,n){var i,r,i=t.getColumnCount();if(0!==n.col||n.colCount!==i){for(r=0;r<n.col;r++)if(t.getColumnVisible(r))return;for(r=n.col+n.colCount;r<i;r++)if(t.getColumnVisible(r))return}return 1}function C(t){var t;return t&&(null==(t=t.NMi)?void 0:t._gi)!==w.SheetType.ganttSheet}Object.defineProperty(n,"__esModule",{value:!0}),n=i("Common"),w=i("Core"),f=i("./dist/plugins/fill/utils.js"),a=n.Common.zf,i=w.GC$,m=null,r=5,i.extend(w.nk.prototype,e={d9e:function(t,n,i){var r,r,r,e,o,u,s,r,u,r,a,l,f,c,h,v,d,g,p,r=this;if(!r.a_&&(1===t.hitTestType||2===t.hitTestType)&&C(e=r.Mf)&&(o=null==(r=null==(r=e.parent)?void 0:r.options)?void 0:r.allowDragHeaderToMove)&&(0,w.needPaintSelection)(e)&&(u=e.getSelections())&&1===u.length)if(s=u[0],u=(r=e.options).colHeaderVisible,r=r.rowHeaderVisible,(o&w.AllowDragHeaderToMove.column)===w.AllowDragHeaderToMove.column&&1===t.hitTestType&&s.row<0&&0<=s.col&&u&&t.row>=e.getFreeAreaRowCount(1)){if(_(e,s))return m;if(a=s.col+s.colCount,t.col<s.col||t.col>=a)return m;for(l=e.Yy(t.colViewportIndex,1),f=s.col;f<a;f++)if((c=null==l?void 0:l.findCol(f))&&(h=c.width,c.x<=n)&&n<=c.x+h)return{action:"dragHeader",dragColumn:!0,selectRange:s}}else if((o&w.AllowDragHeaderToMove.row)===w.AllowDragHeaderToMove.row&&2===t.hitTestType&&0<=s.row&&s.col<0&&r&&t.col>=e.getFreeAreaRowCount(2)){if(s.rowCount===e.getRowCount())return m;for(v=e._y(t.rowViewportIndex,2),d=s.row+s.rowCount,g=s.row;g<d;g++)if((p=null==v?void 0:v.findRow(g))&&p.y<=i&&i<=p.y+p.height)return{action:"dragHeader",dragColumn:!1,selectRange:s}}return m},FTe:function(t){var n,i,r,r,e,e,o,e,o,i,r,n=this;n.BTe||t&&t.dragHeaderToMoveInfo&&1===(r=(i=n.Mf).Ut.getSelections()).length&&(n.rb=!0,n.BTe=!0,n.cw(t),r=r[0],e=i.Fi(),e=i.options.rightToLeft?new w.Rect(e.Hy,e.T6,e.b6+e.F6,e.Ay+e.Iy):new w.Rect(e.b6,e.T6,e.Hy+e.zy,e.Ay+e.Iy),o=i.getRangeRect((0,f.getRowViewportIndex)(t),(0,f.getColViewportIndex)(t),r),t.dragHeaderToMoveInfo.dragColumn?o.height=(0,f.getHeight)(e):o.width=(0,f.getWidth)(e),t.dragHeaderToMoveInfo.selectionRect=o,(e=n.q6).x=o.x,e.y=o.y,e.width=o.width-1,e.height=o.height-1,e.row=r.row,e.col=r.col,e.rowCount=(0,f.getRowCount)(r),e.colCount=(0,f.getColCount)(r),o=i.JS(r),i=t.row,r=t.col,(i=i<o.row?o.row:i)>=o.row+(0,f.getRowCount)(o)&&(i=o.row+(0,f.getRowCount)(o)-1),(r=r<o.col?o.col:r)>=o.col+(0,f.getColCount)(o)&&(r=o.col+(0,f.getColCount)(o)-1),e.hitRow=i,e.hitCol=r,e.rowOffset=i-o.row,e.colOffset=r-o.col,n.Rk={e9:(0,f.getRowViewportIndex)(t),r9:(0,f.getColViewportIndex)(t),Bk:(0,f.getHitTestType)(t)},n.Ok())},LTe:function(){var t,n,i,i,r,e,o,u,o,e,s,e,u,s,t=this,n=t.Mf;t.BTe&&t.rb&&(i=t.jRe(),t.q6.hitTarget=t.fk,t.q6.x=i.x,t.q6.y=i.y,t.q6.width=i.width,t.q6.height=i.height,i=t.fk.x,r=t.fk.y,u=(o=(e=(0,f.getSheetVPortBoundary)(n)).minPoint).x,o=o.y,s=(e=e.maxPoint).x,e=e.y,t.fk.x<=u?t.fk.x=u+1:t.fk.x>=s&&(t.fk.x=s-1),t.fk.y<=o?t.fk.y=o+1:t.fk.y>=e&&(t.fk.y=e-1),u=(0,f.getHitColumnIndex)(n,t.fk.x),s=(0,f.getHitRowIndex)(n,t.fk.y),t.a9(),t._Re(s,u),t.fk.x=i,t.fk.y=r)},GTe:function(){var t,n,i,t=this,n=t.Mf;t.i_=!0,t.zk=!0,t.t_=!1,i=n.sw,(0,f.fixHitTestInfo)(i),t.kD&&t.kD(),t.BTe=!1,t.rb=!1,t.ab=!1,t.Rk=m,n.Uet=m,n.DRe=m,n.Pet=m,t.cw&&t.cw(n.sw)},_Re:function(t,n){var t,i,r,e,n,t,o,t,u,s,r,i=this;i.BTe&&(r=i.Mf,(e=i.q6).hitRow=t,e.hitCol=n,n=null!=(t=i.Int)?t:r.JS(e),i.xnt=n,t=r.Dn.ORe(),i.Int=n,o=r.parent)&&o.options.showDragDropTip&&(t?(t=r.Uet.x+r.Uet.width+5,u=r.Uet.y+r.Uet.height+5,s=r.sw,r=r.U5(),s.dragHeaderToMoveInfo.dragColumn?e.col>r.col?n.col=e.col-r.colCount:n.col=e.col:e.row>r.row?n.row=e.row-r.rowCount:n.row=e.row,o.Tw(a.j0(i.Nnt(n)),t,u)):o.iy())},jRe:function(){var t,n,i,t,r,n,e,o,e,n,u,n,s,a,l,s,t=this,n=t.Mf,i=n.sw,t=t.fk,r=i.dragHeaderToMoveInfo.selectionRect.clone(),n=(0,f.getSheetVPortBoundary)(n),e=n.minPoint,o=e.x,e=e.y,n=n.maxPoint,u=n.x,n=n.y;return i.dragHeaderToMoveInfo.dragColumn?(s=i.x-r.x,r.x=t.x-s,r.x<o?r.x=o:u<(a=(0,f.getEndX)(r))&&(r.x=u-r.width),n<(l=(0,f.getEndY)(r))&&(r.height=n-r.y)):(s=i.y-r.y,r.y=t.y-s,r.y<e?r.y=e:n<(l=(0,f.getEndY)(r))&&(r.y=n-r.height),u<(a=(0,f.getEndX)(r))&&(r.width=u-r.x)),r}})},"./dist/plugins/fill/drag-header-to-move/index.js":function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),i("./dist/plugins/fill/drag-header-to-move/event.js"),i("./dist/plugins/fill/drag-header-to-move/render.js")},"./dist/plugins/fill/drag-header-to-move/render.js":function(t,n,i){var p,w,n,r,e;Object.defineProperty(n,"__esModule",{value:!0}),p=i("Core"),w=i("./dist/plugins/fill/utils.js"),n=p.GC$,r="black",n.extend(p.g7.prototype,e={ERe:function(t,n,i){t.save(),t.fillStyle=i||r,t.fillRect(n.x,n.y,n.width,n.height),t.restore()},RRe:function(o,u){var t,s,n,a,l,f,c,h,v,d,g,n,n,n,t=this,s=t.Mf,n=s.rt,a=s.sw,l=n.q6,f=l.hitTarget;if(l&&f)return c=l.hitCol,h=l.hitRow,v=s.IRe(),d=(0,w.getLineStyle)(s),g=8,o.save(),(n=(0,w.mergeRect)(s.Pet,s.DRe))&&(n=new p.Rect(n.x-g,n.y-g,(0,w.getWidth)(n)+2*g,(0,w.getHeight)(n)+2*g),t.O1(n,u),t.E1(s.U5(),u)),r(),n=i(),o.beginPath(),o.restore(),n;function i(){var t,n,i,r,e,e,t,e,r,t=s.Yy(0).findCol(c)||s.Yy(1).findCol(c)||s.Yy(2).findCol(c),n=s._y(0).findRow(h)||s._y(1).findRow(h)||s._y(2).findRow(h),i=!1;return a.dragHeaderToMoveInfo.dragColumn?t&&(r=t.x,e=(0,w.getWidth)(t),l.col=c,f.x>r+e/2&&(r=t.x+(0,w.getWidth)(t),l.col++),l.col<a.dragHeaderToMoveInfo.selectRange.col||l.col>a.dragHeaderToMoveInfo.selectRange.col+a.dragHeaderToMoveInfo.selectRange.colCount)&&(s.Uet=new p.Rect(r,l.y,0,(0,w.getHeight)(l)),o.rect(u.x,u.y,(0,w.getWidth)(u),(0,w.getHeight)(u)),o.clip(),o.beginPath(),e=u.y+1,(0,w.paintDragLine)(o,r-g,e,r+g,e,v,d),(0,w.paintDragLine)(o,r,l.y,r,l.y+(0,w.getHeight)(l),v,d),(0,w.paintDragLine)(o,r-g,l.y+(0,w.getHeight)(l),r+g,l.y+(0,w.getHeight)(l),v,d),i=!0):n&&(t=n.y,e=(0,w.getHeight)(n),l.row=h,f.y>t+e/2&&(t=n.y+(0,w.getHeight)(n),l.row++),l.row<a.dragHeaderToMoveInfo.selectRange.row||l.row>a.dragHeaderToMoveInfo.selectRange.row+a.dragHeaderToMoveInfo.selectRange.rowCount)&&(s.Uet=new p.Rect(l.x,t,(0,w.getWidth)(l),0),o.rect(u.x,u.y,(0,w.getWidth)(u),(0,w.getHeight)(u)),o.clip(),o.beginPath(),r=u.x+1,(0,w.paintDragLine)(o,r,t-g,r,t+g,v,d),(0,w.paintDragLine)(o,l.x,t,l.x+(0,w.getWidth)(l),t,v,d),(0,w.paintDragLine)(o,l.x+(0,w.getWidth)(l),t-g,l.x+(0,w.getWidth)(l),t+g,v,d),i=!0),i}function r(){o.rect(u.x,u.y,(0,w.getWidth)(u),(0,w.getHeight)(u)),o.clip(),o.beginPath(),t.ERe(o,l,s.TRe())}},ORe:function(){var t,n,i,r,i,r,e,r,t,t=this,n=t.Mf,i=n.sw,r=n.rt.xnt;if(i&&i.dragHeaderToMoveInfo&&r)return i=t.J(),r=n.Fi(),e=n.rt.q6,r=n.options.rightToLeft?new p.Rect(r.Hy,r.T6,r.b6+r.F6,r.Ay+r.Iy):new p.Rect(r.b6,r.T6,r.Hy+r.zy,r.Ay+r.Iy),t=t.RRe(i,r),n.DRe=n.Uet,n.Pet=new p.Rect(e.x,e.y,(0,w.getWidth)(e),(0,w.getHeight)(e)),t}})},"./dist/plugins/fill/fill-event.js":function(t,n,i){var p,m,g,r,w,e,_,C,y,v,D,c,F,b,d,R,j,o,u,h,T,M,i,k,s,e;Object.defineProperty(n,"__esModule",{value:!0}),n.FillAction=void 0,p=i("Common"),m=i("Core"),g=i("SheetsCalc"),r=i("./dist/plugins/fill/fill-ui.js"),w=i("./dist/plugins/fill/fill.js"),e=i("./dist/plugins/fill/fill.ns.js"),_=i("CalcEngine"),C=i("./dist/plugins/fill/utils.js"),y=!!_,v=m.GC$,D=m.Ec,c=p.Common.lt.ht,F=null,b=void 0,d=Math.min,R=Math.abs,j=Math.max,o=5,u=3,h="drag",T="corner",M=p.Common.zf,i=new p.Common.ResourceManager(e.SR,"Fill"),k=i.getResource.bind(i),(e=s=n.FillAction||(n.FillAction={}))[e.smartMenuCopyCells=1]="smartMenuCopyCells",e[e.smartMenuFillSeries=2]="smartMenuFillSeries",e[e.smartMenuFillFormattingOnly=4]="smartMenuFillFormattingOnly",e[e.smartMenuFillWithoutFormatting=8]="smartMenuFillWithoutFormatting",e[e.all=1023]="all",v.extend(m.nk.prototype,{bk:function(t){var n,i,r,e,e,o,u,u,o,e,u,i,n=this;n.zk||(i=n.Mf,r=F,1===(e=i.Ut.getSelections()).length?r=e[0]:e.length<1&&(r=i.Ut.getSpan(i.ui,i.ci)),r&&(n.zk=!0,n.rb=!0,n.Mnt=r,(e=i.tables&&i.tables.find(r.row,r.col))&&(o=n.Cnt=!0,u=e.range(),o=!(e.showHeader()&&r.row===u.row||e.showFooter()&&r.row===u.row+u.rowCount-1||r.col!==u.col||r.colCount!==u.colCount)&&o)&&(n.Snt=!0,n.e_=!0,n.Tnt=e.name()),u=i.getRangeRect((0,C.getRowViewportIndex)(t),(0,C.getColViewportIndex)(t),r),(o=n.q6).x=u.x,o.y=u.y,o.width=u.width-1,o.height=u.height-1,o.row=r.row,o.col=r.col,o.rowCount=(0,C.getRowCount)(r),o.colCount=(0,C.getColCount)(r),e=i.JS(r),u=t.row,i=t.col,(u=u<e.row?e.row:u)>=e.row+(0,C.getRowCount)(e)&&(u=e.row+(0,C.getRowCount)(e)-1),(i=i<e.col?e.col:i)>=e.col+(0,C.getColCount)(e)&&(i=e.col+(0,C.getColCount)(e)-1),o.hitRow=u,o.hitCol=i,o.rowOffset=u-e.row,o.colOffset=i-e.col,n.Rk={e9:(0,C.getRowViewportIndex)(t),r9:(0,C.getColViewportIndex)(t),Bk:(0,C.getHitTestType)(t)},n.Ok()))},Vk:function(){var t,n,i,r,e,o,u,r,i,s,a,t=this;t.Rk&&t.rb&&t.zk&&t.Mnt&&(n=t.fk,i=t.q6,e=(r=t.Mf.getCellRect(i.hitRow,i.hitCol)).width/2,o=r.x+e,u=r.height/2,r=r.y+u,i.hitTarget={x:n.x,y:n.y},i=t.Q9(),s=t.K9(),a=!1,(R(o-n.x)>5+e||R(r-n.y)>5+u)&&(a=!0),0<=i&&0<=s&&a&&t.Ant(i,s),t.a9())},Ant:function(t,n){var i,r,e,o,u,s,a,l,f,c,h,c,u,f,l,c,u,t,n,o,i=this;i.zk&&i.Mnt&&(r=i.Mf,e=i.q6,o=r.o5(),u=r.U5(),s=(0,C.getSheetRowCount)(r),a=(0,C.getSheetColumnCount)(r),l=d(a-(0,C.getColCount)(e),n-e.colOffset),f=d(s-(0,C.getRowCount)(e),t-e.rowOffset),o&&(c=r.ox(n,e.colOffset+1),f-=h=r.ox(t,e.rowOffset+1,!0),0===r.getColumnWidth(l-=c)&&(l=r.r6(l)),0===r.getRowHeight(f))&&(f=r.nI(f)),-1===u.row&&-1!==u.col?(e.row=-1,e.col=j(0,l)):-1!==u.row&&-1===u.col?(e.row=j(0,f),e.col=-1):(e.row=e.row<0?-1:j(0,f),e.col=e.col<0?-1:j(0,l)),i.Snt&&(u=(c=r.tables&&r.tables.find(t,n))&&c.range(),!c||c.name()!==i.Tnt||t===u.row||c.showFooter()&&t===u.row+u.rowCount?i.e_=!1:i.e_=!0,i.e_?(e.col=u.col,i.i_=!i.isPressShiftKey):i.i_=i.isPressShiftKey),e.hitRow=t,e.hitCol=n,f=r.JS(e),o&&(l=r.lT(f.row,f.rowCount,!0),c=r.lT(f.col,f.colCount),f.rowCount+=l,f.colCount+=c,f.rowCount=d(s,f.rowCount),f.colCount=d(a,f.colCount),f.row+f.rowCount>s||f.col+f.colCount>a)||(u=i.Int)&&f.row===u.row&&f.col===u.col&&(0,C.getRowCount)(f)===(0,C.getRowCount)(u)&&(0,C.getColCount)(f)===(0,C.getColCount)(u)&&f.row>r.N9()&&f.col>r.k9()&&f.row+(0,C.getRowCount)(f)-1<r.P6()&&f.col+(0,C.getColCount)(f)-1<r.G6()||(i.xnt=f,r.Dn.o_(),i.Int=f,(t=r.parent)&&t.options.showDragDropTip&&(n=e.x+e.width+5,o=e.y+e.height+5,t.Tw(M.j0(i.Nnt(f)),n,o))))},Nnt:function(t){var n,i,r,e,o,u,s,a,l,f,c,h,v,d;return t&&y?(i=(n=this.Mf).U5(),r=(0,C.getRowCount)(i),e=(0,C.getColCount)(i),o=n.getActiveRowIndex(),u=n.getActiveColumnIndex(),s=void 0,a=n.o5(),o=o<0?0:o,u=u<0?0:u,s=1===r&&1===e?_.knt(F,F,t.row-o,t.col-u,!0,!0):(h=c=f=l=void 0,d=v=0,-1===i.row&&0<=i.col?(l=c=g.BAND_INDEX_CONST,f=t.col-u,h=t.col-u+e-1,d=e):-1===i.col&&0<=i.row?(f=h=g.BAND_INDEX_CONST,l=t.row-o,c=t.row-o+r-1,v=r):0<=i.row&&0<=i.col&&(l=t.row-o,c=t.row-o+r-1,f=t.col-u,h=t.col-u+e-1,v=r,d=e),a&&(c+=n.lT(t.row,v,!0),h+=n.lT(t.col,d)),_.lJ(F,F,l,f,c,h,!0,!0,!0,!0,o,u)),n.op().unparse(n.Uw(),s,o,u)):b},kD:function(t){var n,i,r,e,o,u,u,s,a,l,f,c,h,v,u,d,g,p,p,w,p,w,w,n=this,i=!1,r="",e=!1,o=n.Mf;n.Rk=F,n.l9(),u=o.U5(),s=n.q6.row,a=n.q6.col,l=n.q6.hitRow,f=n.q6.hitCol,n.i_&&u.contains(l,f)||(u=u&&(0<(0,C.getRowCount)(u)||0<(0,C.getColCount)(u))?{r:u.row,c:u.col,rc:(0,C.getRowCount)(u),cc:(0,C.getColCount)(u)}:{r:o.ui,c:o.ci,rc:1,cc:1},!0===n.zk&&!0===n.rb&&(c=u.r,h=u.c,v=u.rc,u=u.cc,d=o.options.protectionOptions,g=o.lF,n.shiftCells=null,n.i_&&(n.shiftCells=n.Dnt?m.InsertShiftCell.right:m.InsertShiftCell.down),p={fromRow:c,fromColumn:h,rowCount:v,columnCount:u,toRow:s,toColumn:a,isDragInsert:n.i_,isDragCopy:n.t_},o.ki(m.Events.BeforeDragDrop,p),(r=p.invalidMessage)&&0!==r.length?i=!0:!n.i_||-1!==c&&-1!==h?s===c&&a===h||(p=o.GT(c,h,v,u),w=o.GT(s,a,v,u),!p&&!w||(w=!1,w=!(p||n.shiftCells!==m.InsertShiftCell.right&&n.shiftCells!==m.InsertShiftCell.down)||w)||(i=!0,r=k().Exp_ChangeMergedCell),i||y&&(o.KT(c,h,v,u)||o.KT(s,a,v,u))&&(i=!0,r=k().Exp_ChangePartOfArray),!i&&o.isActualProtected()&&(!n.t_&&o.dA(D(c,h,v,u),!1,m.SheetArea.viewport)||o.dA(D(s,a,v,u),!1,m.SheetArea.viewport))&&(i=!0,r=o.FT()),i)||(n.i_&&(n.Dnt?a=n.q6.hitCol:s=n.q6.hitRow),e=o.Qy().execute({cmd:"dragDrop",sheetName:o.name(),fromRow:c,fromColumn:h,toRow:s,toColumn:a,rowCount:v,columnCount:u,copy:n.t_,insert:n.i_,shiftCells:n.shiftCells,option:g,mouseTargetRow:l,mouseTargetCol:f})):0<=h?(n.t_&&(a<=h||h+u<=a)||!n.t_&&(a<h||h+u<a))&&((o.GT(-1,h,-1,u)||o.GT(-1,a,-1,0))&&(i=!0,r=k().Exp_ChangeMergedCell),p=d&&d.allowDragInsertColumns,!i&&o.isActualProtected()&&!0!==p&&(i=!0,r=k().Exp_ColumnReadOnly),i||(e=o.Qy().execute({cmd:"dragDrop",sheetName:o.name(),fromRow:-1,fromColumn:h,toRow:-1,toColumn:a,rowCount:-1,columnCount:u,copy:n.t_,insert:!0,option:g,mouseTargetRow:l,mouseTargetCol:f}))):0<=c&&h<0&&(n.t_&&(s<=c||c+v<=s)||!n.t_&&(s<c||c+v<s))&&((o.GT(c,-1,v,-1)||o.GT(s,-1,0,-1))&&(i=!0,r=k().Exp_ChangeMergedCell),i||y&&(o.KT(c,-1,v,-1)||o.KT(s,-1,0,-1))&&(i=!0,r=k().Exp_ChangePartOfArray),w=d&&d.allowDragInsertRows,!i&&o.isActualProtected()&&!0!==w&&(i=!0,r=k().Exp_RowReadOnly),i||(e=o.Qy().execute({cmd:"dragDrop",sheetName:o.name(),fromRow:c,fromColumn:-1,toRow:s,toColumn:-1,rowCount:v,columnCount:-1,copy:n.t_,insert:!0,option:g,mouseTargetRow:l,mouseTargetCol:f}))))),n.rb=!1,n.zk=!1,n.Snt=!1,n.Cnt=!1,n.e_=!1,n.Tnt=F,n.Mnt=F,n.i_=!1,n.t_=!1,n.Int=F,n.xnt=F,n.iy(),e||(n.q6={},o.repaint()),i&&o.jT(3,r)},wk:function(t){var n=this;!0!==n.Yk&&!0!==n.rb&&(n._nt(),n.Ktt)&&(n.rb=!0,n.Yk=!0,n.hO=!0,n.Ent=t,n.jnt=(0,C.getColViewportIndex)(t),n.Ont=(0,C.getRowViewportIndex)(t),n.Rnt=(0,C.getColViewportIndex)(t),n.Bnt(),n.Rk={e9:(0,C.getRowViewportIndex)(t),r9:(0,C.getColViewportIndex)(t),Bk:(0,C.getHitTestType)(t)},n.Ok())},Bnt:function(){var t,n,i,r,n,t=this,n=(0,C.getFrozenRowCount)(t.Mf),i=(0,C.getFrozenColumnCount)(t.Mf),r=t.Lnt();0<=r&&r<n?t.Fnt=0:n<=r&&r<=(0,C.getSheetRowCount)(t.Mf)&&(t.Fnt=1),t.Pnt()?t.Gnt=1:t.Gnt=t.Ent,0<=(n=t.Unt())&&n<i?t.Hnt=0:i<=n&&n<=(0,C.getSheetColumnCount)(t.Mf)&&(t.Hnt=1),t.znt()?t.Vnt=1:t.Vnt=t.jnt},Zk:function(){var t,n,i,r,t=this;t.Rk&&t.Yk&&t.rb&&t.Ktt&&(t.Ont=t.nD(),t.Rnt=t.eD(),t.Ynt=t.Q9(),t.Znt=t.K9(),0<=t.Ynt&&0<=t.Znt&&(t.Wnt(),t.Qnt(),n=t.Mf.parent,i=!1,(r=t.Knt())&&(i=t.Jnt(t.Ktt,t.Xnt,!0)),n&&n.options.showDragFillTip&&i&&t.qnt(),t.$nt()),t.a9())},tet:function(){var t,n,i,r,e,e,o,u,s,s,a,u,l,f,c,h,v,h,v,d,g,t=this,n=t.Mf,i=t.Ktt,r=t.Xnt,e=n.parent.options.defaultDragFillType,e=t.net(3===e?5:e,3===e),o=t.eet(),u=t.Knt();return 1===e?(s=0===o||1===o?1:0,u=(a=new w.Wtt(n)).Jtt(u,s,!0),s=t.iet(o,r,i),f=(l=n.getActualStyle(s.row,s.col)).cellType||n.$f(),c=l.formatter||l._autoFormatter,h=p.Formatter&&p.Formatter.GeneralFormatter,u instanceof Date&&h&&(c=new h(p.Common.CultureManager.Fe().DateTimeFormat.shortDatePattern+" hh:mm:ss AM/PM;@","0")),h=3,(v=t.Rk)&&(h=v.Bk),v={sheet:n,row:s.row,col:s.col,sheetArea:h,quotePrefix:l.quotePrefix},f.format(u,c,d={},v)):0!==e||(s=t.iet(o,r,i),g=n.getFormula(s.row,s.col))?F:n.getText(s.row,s.col)},iet:function(t,n,i){var r,e,o,i,u,s,r=i.row,e=i.col,o=(0,C.getRowCount)(i),i=(0,C.getColCount)(i),u=D(r,e,1,1);return 3===t?(s=(0,C.getRowCount)(n)%o,u.row=s=0===s?r+o-1:r+s-1,u.col=e):1===t?(s=0===(s=(0,C.getColCount)(n)%i)?e+i-1:e+s-1,u.row=r,u.col=s):0===t?(s=0===(s=(0,C.getColCount)(n)%i)?e:e+i-s,u.row=r,u.col=s):2===t&&(s=(0,C.getRowCount)(n)%o,u.row=s=0===s?r:r+o-s,u.col=e),u},qnt:function(){var t,n,i,r,e,o,u,o,n,t=this,n=t.Mf,i;if(4===t.net()||t.znt()||t.Pnt())return t.iy(),F;u=t.eet(),o=t.Knt(),n=n.j1(o),o=t.tet(),3===u||1===u?(r=n.x+n.width+3,e=n.y+n.height+3):0===u?(r=n.x+3,e=n.y+n.height+3):2===u&&(r=n.x+n.width+3,e=n.y+3),t.Tw(o,r,e)},$nt:function(){var t=this;t.ret(),t.oet(),t.aet(),t.uet=t.Knt()},ret:function(){var t,n,t=this.Mf;this.uet&&((n=t.j1(this.uet)).x-=2,n.y-=2,n.width+=4,n.height+=4,t.Dn.O1(n))},oet:function(t){var n;this.Mf.Dn.E1(this.Ktt,F,t)},aet:function(){var t,n,i,r,i,e,t,t=this.Mf,n=t.Dn,i=this.Knt();i&&(r=n.J(),i=t.j1(i),e=t.getSelectionBorderColor(),t=(0,C.getLineStyle)(t),r.save(),r.beginPath(),n.cet(r,i,e,t),r.restore())},Qnt:function(){this.Xnt=this.dO()},znt:function(){return-1===this.Ktt.col&&-1!==this.Ktt.row},Pnt:function(){return-1===this.Ktt.row&&-1!==this.Ktt.col},lO:function(){return 4===this.bO||5===this.bO},dO:function(){var t,n,i,r,e,t=this,n=-1,i=-1,r=-1,e=-1;switch(t.bO){case 0:r=t.Pnt()?n=-1:(n=t.Lnt(),(0,C.getRowCount)(t.Ktt)),i=t.Znt,e=t.Unt()-i;break;case 1:r=t.Pnt()?n=-1:(n=t.Lnt(),(0,C.getRowCount)(t.Ktt)),i=t.fet()+1,e=t.Znt-i+1;break;case 2:n=t.Ynt,r=t.Lnt()-n,e=t.znt()?i=-1:(i=t.Unt(),(0,C.getColCount)(t.Ktt));break;case 3:n=t.let()+1,r=t.Ynt-n+1,e=t.znt()?i=-1:(i=t.Unt(),(0,C.getColCount)(t.Ktt));break;case 5:n=t.Ynt,r=t.let()-n+1,e=t.znt()?i=-1:(i=t.Unt(),(0,C.getColCount)(t.Ktt));break;case 4:r=t.Pnt()?n=-1:(n=t.Ktt.row,(0,C.getRowCount)(t.Ktt)),i=t.Znt,e=t.fet()-i+1}return D(n,i,r,e)},het:function(){var t=this.let();return-1!==t?this.Mf._y(this.Gnt).findRow(t):F},det:function(){return this.Mf._y(this.Ont).findRow(this.vet())},vet:function(){return this.Mf.getViewportBottomRow(this.Ont)},met:function(){var t=this.fet();return-1!==t?this.Mf.Yy(this.Vnt).findCol(t):F},pet:function(){return this.Mf.Yy(this.Rnt).findCol(this.bet())},bet:function(){return this.Mf.getViewportRightColumn(this.Rnt)},Wnt:function(){var t,n,i,r,e,o,u,s,e,r,a,l,f,c,o,u,c,f,o,u,a,l,f,o,u,a,f,u,l,h,t=this,n=t.znt(),i=t.Pnt(),r=v(t.Mf.Dg()).offset(),e=t.fk.e,o=t.fk.x,u=t.fk.y,s=e.pageX-r.left,e=e.pageY-r.top,r=!1;n||i?i?t.Znt>=t.Unt()&&t.Znt<=t.fet()?t.bO=4:t.Znt<t.Unt()?t.bO=0:t.Znt>t.fet()&&(t.bO=1):n&&(t.Ynt>=t.Lnt()&&t.Ynt<=t.let()?t.bO=5:t.Ynt<t.Lnt()?t.bO=2:t.Ynt>t.let()&&(t.bO=3)):t.Ynt>=t.Lnt()&&t.Ynt<=t.let()?t.Znt>=t.Unt()&&t.Znt<=t.fet()?(a=R(t.Znt-t.fet()))<(l=R(t.Ynt-t.let()))?t.bO=5:l<a?t.bO=4:(f=(f=t.het())||t.det())?u>f.y+f.height?t.bO=3:(o=(c=(c=t.met())||t.pet()).x+c.width-o,u=f.y+f.height-u,s>=c.x&&s<=c.x+c.width&&e>=f.y&&e<=f.y+f.height?t.bO=u<=o?4:5:r=!0):r=!0:t.Znt<t.Unt()?t.bO=0:t.Znt>t.fet()&&(t.bO=1):t.Ynt<t.Lnt()?t.Znt>=t.Unt()&&t.Znt<=t.fet()?t.bO=2:t.Znt<t.Unt()?(a=R(t.Znt-t.Unt()),l=R(t.Ynt-t.Lnt()),t.bO=a<=l?2:0):t.Znt>t.fet()&&(a=R(t.Znt-t.fet()),l=R(t.Ynt-t.Lnt()),t.bO=a<=l?2:1):t.Ynt>t.let()&&(t.Znt>=t.Unt()&&t.Znt<=t.fet()?t.bO=3:t.Znt<t.Unt()?(a=R(t.Znt-t.Unt()),l=R(t.Ynt-t.let()),t.bO=a<=l?3:0):t.Znt>t.fet()&&(a=R(t.Znt-t.fet()),l=R(t.Ynt-t.let()),t.bO=a<=l?3:1)),(c=t.Mf.Dn.yet)&&(u=(f=t.let())+1,a=(o=t.fet())+1,l=t.Mf.getRowHeight(f,3),f=t.Mf.getColumnWidth(o,3),o=t.Mf.getRowHeight(u,3),u=t.Mf.getColumnWidth(a,3),a=c.x+c.width/2-d(10,f/2),f=c.x+c.width/2+d(10,u/2),u=c.y+c.height/2-d(10,l/2),l=c.y+c.height/2+d(10,o/2),h=!1,(h=n||i?i?a<=s&&s<=f:u<=e&&e<=l:a<=s&&s<=f&&u<=e&&e<=l)||r?(t.hO=!0,t.bO=4):t.hO=!1)},Lnt:function(){return this.Ktt?-1===this.Ktt.row?0:this.Ktt.row:-1},let:function(){var t=this;return t.Ktt?-1===t.Ktt.row?(0,C.getSheetRowCount)(t.Mf)-1:t.Ktt.row+(0,C.getRowCount)(t.Ktt)-1:-1},Unt:function(){return this.Ktt?-1===this.Ktt.col?0:this.Ktt.col:-1},fet:function(){var t=this;return t.Ktt?-1===t.Ktt.col?(0,C.getSheetColumnCount)(t.Mf)-1:t.Ktt.col+(0,C.getColCount)(t.Ktt)-1:-1},wet:function(t,n){var n,i,r,e,e,r,e,t,n=D(n.row,n.col,n.rowCount,n.colCount),i=this.Mf;return i.Ut.findSpan(t.row,t.col)&&(r=t.rowCount,e=n.rowCount,0!==Math.floor(e%r)&&(e=Math.ceil(e/r)*r,n.row+e<=i.getRowCount())&&(n.rowCount=e),r=t.colCount,e=n.colCount,0!==Math.floor(e%r))&&(t=Math.ceil(e/r)*r,n.col+t<=i.getColumnCount())&&(n.colCount=t),n},DD:function(){var t,n,i,r,e,o,u,e,o,t=this,n=t.Mf;t.Rk=F,t.l9(),t.iy(),t.Yk&&t.rb?(t.Yk=!1,t.rb=!1,(i=t.Knt())&&(!(r=t.Jnt(t.Ktt,t.Xnt))||t.hO?(t.Met(),t.Ax(i)):(e=n.rt.Ktt,o=t.wet(e,t.Xnt),u=t.net(),n.Qy().execute({cmd:"fill",sheetName:n.name(),startRange:e,fillRange:o,autoFillType:u,fillDirection:n.rt.eet()}),e=t.lnt,o=n.getSelections(),!e&&t.Cet()&&n.parent.options.showDragFillSmartTag&&1===o.length&&o[0].equals(i)&&4!==t.fnt?t.Tet(t.fnt):t.Ax(i),t.Met()))):t.Met()},FRe:function(){var t,n,i,t=this.Mf,n=s.all,i=t.getCellType(t.getActiveRowIndex(),t.getActiveColumnIndex());return"19"===(null==i?void 0:i.typeName)&&(n&=~s.smartMenuFillSeries),n=t.NMi?(n&=~s.smartMenuFillFormattingOnly)&~s.smartMenuFillWithoutFormatting:n},Tet:function(t){var n,i,i,n=this.Mf,i=n.Dn.yet,i={x:i.x+i.width,y:i.y+i.height,fillType:t,availableFillAction:this.FRe()};n.R_=new r.Aet(n.parent.j2(),n,i),n.R_.rQ()},_nt:function(){var t,n,n,i,t=this.Mf,n=t.Ut.getSelections();1===n.length?(n=n[0],(i=t.Ut.getSpans(n))&&0<i.length&&(n=t.kR(i,n)),this.Ktt=n):0<=t.ui&&0<=t.ci&&(this.Ktt=D(t.ui,t.ci,1,1))},Met:function(){this.rb=!1,this.Yk=!1},Ax:function(t){this.Mf.Dn.E1(t)},net:function(t,n){var i,r,t,e,i=this,r=i.Mf,t=t!==b?t:r.parent.options.defaultDragFillType;return i.lO()?4:5!==t?t:(e=1===(0,C.getRowCount)(i.Ktt)&&1===(0,C.getColCount)(i.Ktt)&&!i.Pnt()&&!i.znt())?i.a_&&!n?1:0:i.a_&&!n?0:1},Knt:function(){var t,n,i,r,e,t=this;return t.Ktt?t.lO()?t.Ktt:t.Xnt?(e=r=i=n=0,e=t.Iet()?(n=(2===t.bO?t.Xnt:t.Ktt).row,i=(0,C.getRowCount)(t.Ktt)+(0,C.getRowCount)(t.Xnt),r=t.Ktt.col,(0,C.getColCount)(t.Ktt)):(n=t.Ktt.row,i=(0,C.getRowCount)(t.Ktt),r=(0===t.bO?t.Xnt:t.Ktt).col,(0,C.getColCount)(t.Ktt)+(0,C.getColCount)(t.Xnt)),D(n,r,i,e)):F:F},Jnt:function(t,n,i){var r,e,o,r=this.Mf,e=!0,o="";return r.Ut.eE(n.row,n.col,(0,C.getRowCount)(n),(0,C.getColCount)(n))&&!(0,C.canDragFillSpan)(r,t,n)&&(e=!1,o=k().Exp_FillRangeContainsMergedCell),e&&r.isActualProtected()&&r.dA(n,!0,m.SheetArea.viewport)&&(e=!1,o=r.FT()),e||i||r.ki(m.Events.InvalidOperation,{sheet:r,sheetName:r.name(),invalidType:m.InvalidOperationType.dragFill,message:o,fillRange:n}),e},Cet:function(){return this.xet()||this.Net()},xet:function(){return 3===this.bO||1===this.bO},Net:function(){return 0===this.bO||2===this.bO},Iet:function(){return 2===this.bO||3===this.bO||5===this.bO},eet:function(){var t=this.bO;return 0<=t&&t<=3?t:4===t?0:5===t?2:3},VL:function(t,n,i){var r,e,o,t,u,s,a,l,f,u,r=this,e=F,o=(0,C.getRowViewportIndex)(t),t=(0,C.getColViewportIndex)(t),u=r.Mf,s=u.parent,a=u.options.rightToLeft;if(!c(o)&&!c(t)&&(s.options.allowUserDragDrop||s.options.allowUserDragFill)&&(-1!==(l=u.U5()).row||-1!==l.col)){if(0<=o&&0<=t&&1===u.Ut.getSelections().length){if(r.yD(o,t,n,i))return e;a&&(f=r.Mf.Dn.yet)&&f.x<=n&&n<=f.x+f.width&&f.y<=i&&i<=f.y+f.height&&(e={action:h,side:T}),u=u.getRangeRect(o,t,l),e||u.x-4<n&&n<u.x+4&&u.y<=i&&i<u.y+u.height&&(e={action:h,side:"left"}),e||a||(f=r.Mf.Dn.yet)&&f.x<=n&&n<=f.x+f.width&&f.y<=i&&i<=f.y+f.height&&(e={action:h,side:T}),e||u.x+u.width-4<n&&n<u.x+u.width+4&&u.y<=i&&i<u.y+u.height&&(e={action:h,side:"right"}),e||u.y-4<i&&i<u.y+4&&u.x<=n&&n<u.x+u.width&&(e={action:h,side:"top"}),e||u.y+u.height-4<i&&i<u.y+u.height+4&&u.x<=n&&n<u.x+u.width&&(e={action:h,side:"bottom"}),e&&(n<u.x||n>u.x+u.width||i<u.y||i>u.y+u.height)&&(e.outside=!0)}s&&s.options.allowUserDragDrop||e&&e.side!==T&&(e.side=F),s&&s.options.allowUserDragFill||e&&e.side===T&&(e.side=F)}return e},ket:function(t,n){var i,r,e,i=this,r,e=i.Mf.getSpan(t,n,3);return e?!c(i.Mf.getValue(e.row,e.col,3,0)):!c(i.Mf.getValue(t,n,3,0))},Det:function(t,n){var i,r,e,e,i,r,e=this.Mf.tables;return!(!e||0===e.all().length)&&(e=e.AB(t,n,1,1)[0])&&e.footerIndex()===t},_et:function(t,n,i,r){for(var e,o,e=this,o=n;o<n+r;o++)if(!e.ket(t,o)||e.Det(t,o))return!1;return!0},Eet:function(t,n,i,r){for(var e,o,e=this,o=n;o<n+r;o++)if(e.ket(t,o))return!1;return!0},jet:function(t,n,i,r){var e,o,u,s,a,l,f,c,h,e=this,o=e.Mf;if("left"===r){for(u=0;u<n;u++)e.ket(t,u)&&(i.searchArray[u]=!0);for(s=n-1,a=1;i.searchArray[s];)s--,a++;i.searchLength=a}if("right"===r){for(l=o.getColumnCount(),f=n;f<l;f++)e.ket(t,f)&&(i.searchArray[f-n]=!0);for(c=0,h=1;i.searchArray[c];)c++,h++;i.searchLength=h}return i},Oet:function(t,n,i,r,e){for(var o,u,s,a,l,f,c,h,v,d,o=this,u=o.Mf,s=0,a={searchArray:new Array(r),searchLength:1},l={searchArray:new Array(u.getColumnCount()-e),searchLength:1},f=i-1;n<=f&&!o.Eet(f,t.col,1,t.colCount);f--)a=o.jet(f,t.col,a,"left"),l=o.jet(f,t.col+t.colCount-1,l,"right");for(;o.Eet(i+s,t.col,1,t.colCount);){for(h=!(c=!0),a=o.jet(i+s,r,a,"left"),l=o.jet(i+s,e,l,"right"),v=r-1;v>=r-a.searchLength;v--)if(o.ket(i+s,v)){s++,c=!1;break}if(c){for(d=e+1;d<=e+l.searchLength;d++)if(o.ket(i+s,d)){s++,h=!0;break}if(!h)return s}}return s},Ret:function(t){for(var n,i,n=this,i=0;n._et(t.row+t.rowCount+i,t.col,1,t.colCount);)i++;return i},Bet:function(t){var n,i,r,e,o,n=this;return n._et(t.row+t.rowCount,t.col,1,t.colCount)?n.Ret(t):(o=t.row+t.rowCount,r=1===t.colCount?i=t.col:(i=t.col,t.col+t.colCount-1),n.Oet(t,e=0,o,i,r))},H_:function(){var t,n,i,r,r,e,o,i,r,t=this,n=t.Mf,i=n.rt.Ktt,r=t.Bet(i);0!==r&&(r=D(i.row+i.rowCount,i.col,r,i.colCount),t.bO=3,t.Xnt=r,e=t.net(),o=t.lnt,n.Qy().execute({cmd:"fill",sheetName:n.name(),startRange:i,fillRange:r,autoFillType:e,fillDirection:t.bO}),i=t.Knt(),r=n.getSelections(),!o)&&n.parent.options.showDragFillSmartTag&&1===r.length&&r[0].equals(i)&&4!==t.fnt&&t.Tet(t.fnt)}})},"./dist/plugins/fill/fill-render.js":function(t,n,i){var D,F,n,b,v;Object.defineProperty(n,"__esModule",{value:!0}),D=i("Core"),F=i("./dist/plugins/fill/utils.js"),n=D.GC$,b=Math.min,v=Math.max,n.extend(D.g7.prototype,{Let:function(t,n){var i,r,e,o,u,t,s,i,a,l,n,i=this.Mf,r=i.options.rightToLeft,e=t.x,o=t.y,u=(0,F.getWidth)(t),t=(0,F.getHeight)(t),s=i.U5(),i=i.Fi(),a=4,l=-2.5;return 2007<n&&(a=5,l=-3),n=new D.Rect(-4,-4,a,a),-1===s.col?(n.x=r?i.BA+l:i.b6,n.y=o+t+l):-1===s.row?(n.x=r?e+l:e+u+l,n.y=i.T6):(n.x=r?e+l:e+u+l,n.y=o+t+l),n},yO:function(t,n,i,r,e){var o,u,s,a,a,r,l,f,c,h,s,n,i,o=this,u=o.Mf,s=u.Fi(),a=u.parent,a=a&&a.SC,r=o.Let(r,a),l=r.x,f=r.y,c=(0,F.getWidth)(r),h=(0,F.getHeight)(r),s=s.c9(n,i);e&&!r.intersectRect(e)||r.intersectRect(s)&&(n=-1.5,(i=new D.Rect(l+(n=2007<a?-1:n),f+n,c+2,h+2)).x<s.x&&(i.width-=s.x-i.x,i.x=s.x),i.y=v(i.y,s.y),o.O1(i),t.save(),e&&!e.containsRect(r)&&(t.rect(e.x,e.y,(0,F.getWidth)(e),(0,F.getHeight)(e)),t.clip()),t.beginPath(),t.fillStyle=D.Pf.vl(u,u.getSelectionBorderColor()),t.fillRect(l,f,c,h),o.yet=new D.Rect(r.x,r.y,4,4),t.beginPath(),t.restore())},cet:function(t,n,i,r){var e=n.x,o=n.y,u=e+(0,F.getWidth)(n),n=o+(0,F.getHeight)(n);(0,F.paintDragLine)(t,e-2,o,u+1,o,i,r),(0,F.paintDragLine)(t,e-1,n,u+1,n,i,r),(0,F.paintDragLine)(t,e,o-1,e,n+1,i,r),(0,F.paintDragLine)(t,u,o-1,u,n+1,i,r)},Fet:function(t,n){var i,r,e,o,u,s,a,l,f,c,h,v,d,g,p,c,w,m,_,C,_,u,_,f,l,y,i=this,r=i.Mf,e=r.rt,o=e.q6,u=o.hitTarget;o&&u&&(s=o.hitCol,a=o.hitRow,l=o.row,f=o.col,c=e.i_,h=r.Pet,d=r.getSelectionBorderColor(),g=(0,F.getLineStyle)(r),p=8,t.save(),!0===c?(c=r.Yy(0).findCol(s)||r.Yy(1).findCol(s)||r.Yy(2).findCol(s),w=r._y(0).findRow(a)||r._y(1).findRow(a)||r._y(2).findRow(a),-1===o.row&&-1!==o.col?c&&(m=c.x,_=(0,F.getWidth)(c),o.col=s,u.x>m+_/2&&(o.col<r.getLastFullyVisibleColumn()||o.col===r.G6())&&(m=c.x+(0,F.getWidth)(c),o.col++),(h=h&&0===(0,F.getWidth)(h)?h:e.q6)&&(v=new D.Rect(h.x-8,h.y-8,(0,F.getWidth)(h)+16,(0,F.getHeight)(h)+16),i.O1(v,n),i.E1(r.U5(),n)),r.Uet=new D.Rect(m,o.y,0,(0,F.getHeight)(o)),t.rect(n.x,n.y,(0,F.getWidth)(n),(0,F.getHeight)(n)),t.clip(),t.beginPath(),(0,F.paintDragLine)(t,m-8,o.y,m+8,o.y,d,g),(0,F.paintDragLine)(t,m,o.y,m,o.y+(0,F.getHeight)(o),d,g),(0,F.paintDragLine)(t,m-8,o.y+(0,F.getHeight)(o),m+8,o.y+(0,F.getHeight)(o),d,g)):-1!==o.row&&-1===o.col?w&&(C=w.y,_=(0,F.getHeight)(w),o.row=a,u.y>C+_/2&&(o.row<r.getLastFullyVisibleRow()||o.row===r.P6())&&(C=w.y+(0,F.getHeight)(w),o.row++),(h=h&&0===(0,F.getHeight)(h)?h:e.q6)&&(v=new D.Rect(h.x-8,h.y-8,(0,F.getWidth)(h)+16,(0,F.getHeight)(h)+16),i.O1(v,n),i.E1(r.U5(),n)),r.Uet=new D.Rect(o.x,C,(0,F.getWidth)(o),0),t.rect(n.x,n.y,(0,F.getWidth)(n),(0,F.getHeight)(n)),t.clip(),t.beginPath(),(0,F.paintDragLine)(t,o.x,C-8,o.x,C+8,d,g),(0,F.paintDragLine)(t,o.x,C,o.x+(0,F.getWidth)(o),C,d,g),(0,F.paintDragLine)(t,o.x+(0,F.getWidth)(o),C-8,o.x+(0,F.getWidth)(o),C+8,d,g)):-1!==o.row&&-1!==o.col&&(u=r.Yy(0).findCol(f)||r.Yy(1).findCol(f)||r.Yy(2).findCol(f),_=r._y(0).findRow(l)||r._y(1).findRow(l)||r._y(2).findRow(l),w)&&c&&_&&u&&(m=u.x,C=_.y,h&&(v=new D.Rect(h.x-8,h.y-8,(0,F.getWidth)(h)+16,(0,F.getHeight)(h)+16),i.O1(v,n),i.E1(r.U5(),n)),f=!1,l=r.getCellRect(a,s),(f=!e.Cnt&&l?(y=o.hitTarget.x-l.x)<b(16,r.nn(s)/4):f)?m=c.x:C=w.y,r.Uet=new D.Rect(m,C,(0,F.getWidth)(o),(0,F.getHeight)(o)),r.U5().contains(a,s)||(t.rect(n.x,n.y,(0,F.getWidth)(n),(0,F.getHeight)(n)),t.clip(),t.beginPath(),f?((0,F.paintDragLine)(t,m-8,C,m+8,C,d,g),(0,F.paintDragLine)(t,m,C,m,C+(0,F.getHeight)(o),d,g),(0,F.paintDragLine)(t,m-8,C+(0,F.getHeight)(o),m+8,C+(0,F.getHeight)(o),d,g),e.Dnt=!0):((0,F.paintDragLine)(t,m,C-8,m,C+8,d,g),(0,F.paintDragLine)(t,m,C,m+(0,F.getWidth)(o),C,d,g),(0,F.paintDragLine)(t,m+(0,F.getWidth)(o),C-8,m+(0,F.getWidth)(o),C+8,d,g),e.Dnt=!1)))):(h&&(v=new D.Rect(h.x-8,h.y-8,(0,F.getWidth)(h)+16,(0,F.getHeight)(h)+16),i.O1(v,n),i.E1(r.U5(),n)),t.rect(n.x,n.y,(0,F.getWidth)(n),(0,F.getHeight)(n)),t.clip(),t.beginPath(),i.cet(t,o,d,g)),t.beginPath(),t.restore())},o_:function(){var t,n,i,r,i,e,o,u,s,a,l,f,c,s,l,t=this,n=t.Mf,i=n.sw,r=n.rt.xnt;i&&i.dragInfo&&r&&(i=t.J(),e=n.Fi(),o=n.rt.q6,u=n.j1(r),s=n.frozenTrailingColumnCount(),a=n.frozenTrailingRowCount(),l=n.getColumnCount()-s,f=n.getRowCount()-a,c=e.c9(1,1),0<s&&r.col+r.colCount<=l&&u.x+(0,F.getWidth)(u)>c.x+(0,F.getWidth)(c)&&u.intersectRect(c)&&(u=u.getIntersectRect(c)),0<a&&r.row+r.rowCount<=f&&u.y+(0,F.getHeight)(u)>c.y+(0,F.getHeight)(c)&&u.intersectRect(c)&&(u=u.getIntersectRect(c)),s=n.options.rightToLeft?new D.Rect(e.Hy,e.T6,e.b6+e.F6,e.Ay+e.Iy):new D.Rect(e.b6,e.T6,e.Hy+e.zy,e.Ay+e.Iy),0<=(0,F.getWidth)(u)&&0<=(0,F.getHeight)(u)&&(o.x=u.x,o.y=u.y,o.width=(0,F.getWidth)(u),o.height=(0,F.getHeight)(u),t.Fet(i,s)),l=n.rt.i_,n.Pet=!0===l?n.Uet:new D.Rect(o.x,o.y,(0,F.getWidth)(o),(0,F.getHeight)(o)))}})},"./dist/plugins/fill/fill-ui.js":function(V,t,n){var i,H,u,N,e,s,a,o,r,l,n,f,c,h,v,d,g,p,w,m,_,C,y,P,G,D,F,b,R,j,T,M,k,L,n,x,B,W,$,I,O;function A(t,n,i,r,e,o){var t=t.Oi,u=t?"160px":"150px",t=t?"25px":"20px",u=s(a("div")).css([y,G,D,"padding",F],["block",u,t,0,0]).addClass("gc-smartMenu-item-default "+i+" ui-state-default"+l),t=s(a("div")).addClass(g).appendTo(u),i=s(a("div")).addClass("gc-menu-item-text").appendTo(u),n=s(a("input")).attr({id:n,value:e,type:"radio",name:"fill-group",style:"display:none"}).appendTo(t);return s(a("span")).text(r).appendTo(i),o?(t.addClass(d),n.prop("checked","checked")):n.prop("checked",""),u}function S(t,n,i){var t,r,t=I.call(this,t,o(n.parent.Ti),void 0,!0)||this;return t.jTe=u.DialogFeatureType.fill,t.Mf=n,t.Het=s("."+w),(r=t.g$=t.Xc()).addClass(c),i&e.FillAction.smartMenuCopyCells&&A(n,"smartMenuCopyCells",f,x().CopyCells,"0",!0).appendTo(r),i&e.FillAction.smartMenuFillSeries&&A(n,"smartMenuFillSeries",f,x().FillSeries,"1").appendTo(r),i&e.FillAction.smartMenuFillFormattingOnly&&A(n,"smartMenuFillFormattingOnly",f,x().FillFormattingOnly,"2").appendTo(r),i&e.FillAction.smartMenuFillWithoutFormatting&&A(n,"smartMenuFillWithoutFormatting",f,x().FillWithoutFormatting,"3").appendTo(r),t}function E(t,n,i){var t,n,t=O.call(this,t,o(n.parent.Ti),void 0,!0)||this;return t.Mf=n,t.zet=i,n=t.Vet=t.Xc().addClass("gc-smart-tag-default "+w+" gc-no-user-select ui-widget-header"+l),t.Yet=s(a("div")).attr("class","fillSmartTag").css(m,_).appendTo(n),t.Zet=s(a("div")).attr("class","fillSmartTagDown").css([m,y],[_,"none"]).appendTo(n),t}i=this&&this.__extends||($=function(t,n){return($=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}$(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(t,"__esModule",{value:!0}),t.Aet=void 0,H=n("Common"),u=n("Core"),N=n("./dist/plugins/fill/fill.ns.js"),e=n("./dist/plugins/fill/fill-event.js"),s=u.GC$,a=u.mt.En,o=u.mt.gi,r=s(document),l=" btn btn-default",f="gc-fill-type-item",c="gc-fill-menu-container",h=(n="ui-state-hover ")+"gc-smartMenu-item-hover",v=n+"gc-smart-tag-hover",d="ui-icon ui-icon-check gc-check-image",g="gc-menu-item-input",p="ui-state-active gc-smart-tag-active",w="gc-tag-container",m="float",_="left",C="top",y="display",P="width",G="min-width",D="height",F="margin",b="change",R="input[type=radio]",j="mouseover",T="mouseout",M="click",k="fillTypeChanged",L="keydown.ui-fill",n=new H.Common.ResourceManager(N.SR,"Fill"),x=n.getResource.bind(n),I=u.zc,i(S,I),S.prototype.$c=function(){I.prototype.$c.call(this)},S.prototype.aY=function(){var e,t,n,e=this,t;s("."+f).bind(j,function(){s(this).addClass(h)}).bind(T,function(){s(this).removeClass(h)}).bind(M,function(){var t,n,i,r,i,t=s(this),n=e.Het,i=t.find(R),r=i[0];r.checked=!0,i.trigger(b),n.trigger(M),n.trigger(T),t.removeClass(h),i=parseInt(s(r).attr("value"),10),e.Wet(i)}),(n=e.g$.find(R)).bind(b,function(){s("."+g).removeClass(d),s(this).parent().addClass(d)})},S.prototype.Qet=function(){s("."+f).unbind(j).unbind(T).unbind(M),this.g$.find(R).unbind(b)},S.prototype.Wet=function(t){var n=this,i=n.Mf,r=i.rt;if(n.Ket!==t){n.Ket=t,i.cnt=!0,i.suspendEvent();try{u.Commands.undo.execute(i.parent,{sheetName:i.name()})}finally{i.resumeEvent()}i.cnt=!1,i.Qy().execute({cmd:"fill",sheetName:i.name(),startRange:r.Ktt,fillRange:r.Xnt,autoFillType:t,fillDirection:r.bO}),n.Het.trigger(k,t)}},S.prototype.Jet=function(){return!!s("."+c).length},B=S,O=u.zc,i(E,O),E.prototype.Xet=function(t,n,i){var r=this,e=r.Mf.Oi,n=s(n),o=r.qet,r=r.Zet,u=e?"38px":"32px",e=e?"24px":"18px";o&&o.Jet()||(t?n.addClass(v):n.removeClass(v),n.css([P,D],[t?u:e,e]),i)||(t?r.show():r.hide())},E.prototype.$et=function(){var e=this,t=e.Vet,n=u.mt.pi(),o=u.mt.Tt.safari&&(n.ipad||n.iphone);t.bind(j,function(){e.Xet(!0,this,o)}).bind(T,function(){e.Xet(!1,this,o)}),t.bind(M,function(){var t,n,i,r,n,i,t=s(this),n=e.qet,i=e.Zet,r;n&&n.Jet()?(o&&i.hide(),t.removeClass(p),e.tit()):(o&&i.show(),t.addClass(p),e.nit(),(i=(n=e.g$)&&n.find(R)[e.zet.fillType])&&!i.checked&&(i.checked=!0,s(i).trigger(b)))}),r.bind(L,function(t){27===t.keyCode&&(e.qet&&e.qet.Jet()?e.tit():e.close(),u.mt.vi(t))})},E.prototype.rQ=function(){var t=this,n=t.Vet,i=t.zet,r=t.Mf.Oi,e=r?"3px":"0px",r=r?"24px":"18px";n&&(n.css([_,C],[i.x,i.y]),t.$c(),t.$et(),t.Yet.css(F,e),t.Zet.css(D,r),t.c5())},E.prototype.nit=function(){var t,n,n,i,r,r,e,o,u,t=this,n=t.Mf;t.qet||(t.qet=new B(n.parent.j2(),n,this.zet.availableFillAction),t.g$=t.qet.Xc()),i=(n=t.Vet).css(_),r=n.css(C),r=parseFloat(r),o=t.qet,u=t.zet,o.Ket=u.fillType,isNaN(r)||(e=r+n.height()+2),t.g$.css([_,C],[i,e]),o.$c(),o.aY(),o.Het.unbind(k).bind(k,function(t,n){u.fillType=n})},E.prototype.kRe=function(){var t,n,i,r,e,i,t,i,o,t,u,n;this.rf()&&(e=-1===(i=(n=this.Mf).U5()).col?(r=n.C0(i.row+i.rowCount-1),n.S0(0)):(r=-1===i.row?n.C0(0):n.C0(i.row+i.rowCount-1),n.S0(i.col+i.colCount-1)),i=n.getRangeRect(r,e,i),t=null==(t=n.parent)?void 0:t.SC,i=n.Dn.Let(i,t),t=(o=n.Fi()).c9(r,e),u=3,i.intersectRect(t)?this.Vet.css([_,C],[i.x+3,i.y+3]):this.Vet.css(y,"none"),this.Vet.removeClass(p),n=this.qet)&&n.rf()&&n.close()},E.prototype.tit=function(){var t=this.qet;t&&(t.Qet(),t.close())},E.prototype.c5=function(){var t=this,n=t.qet,t=t.Vet;n&&(n.Jet()&&t.trigger(M),t.trigger(T))},E.prototype.close=function(){var t,n,t,t=this,n=t.Mf;t.c5(),r.unbind(L),O.prototype.close.call(this),(t=n.fg)&&(t.style.cursor="default"),!n||n.il&&n.il.XD||n.Zg()},E.prototype.lf=function(t){var n;return!(!this.Wc||!O.prototype.hf.call(this,this.Wc.get(0),t))||this.g$&&O.prototype.hf.call(this,this.g$.get(0),t)},t.Aet=E},"./dist/plugins/fill/fill.entry.js":function(t,n,i){var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),i("./dist/plugins/fill/drag-fill.js"),i("./dist/plugins/fill/fill-event.js"),i("./dist/plugins/fill/fill-render.js"),i("./dist/plugins/fill/drag-header-to-move/index.js"),e(i("./dist/plugins/fill/fill-ui.js"),n),e(i("./dist/plugins/fill/fill.js"),n),e(i("./dist/plugins/fill/fill.ns.js"),n)},"./dist/plugins/fill/fill.js":function(j,t,n){var i,e,h,r,T,n,x,o,tt,C,y,D,nt,I,u,O,M,u,A,S,it,rt,et,E,u,k,V,H,N,P,G,L,ot,B,W,u,n,$,z,q,n,U,K,J,Q,X,Y,Z,at,lt,ft,ct,ht,n,u,n,u,n,vt,dt,gt,pt,wt,mt,_t,Ct,yt,s,a,Dt,Ft;function ut(t){return!st(t)&&o.q8(t)}function st(t){return"string"==typeof t}function bt(t,n){return-1!==t.lastIndexOf(n)}function Rt(t){var n=[t];return n.rowCount=1,n.colCount=M(t),n}function jt(t){return t}function Tt(t,n,i,r){var n=Rt(n),i=Rt(i),r=Rt([r]),t=t?e.Common.eit(n,i,r,!0,jt,tt,tt,tt):e.Common.iit(n,i,r,!0,tt,tt,tt),n=t&&t[0][0];return typeof n===it?e.Common.st.E8(n,13):n}function Mt(t){return t.toLowerCase()}function l(t){this.rit=[],this.oit=[],this.ait=[],this.uit=tt,this.sit=[],this.cit=tt,this.lit=nt(t)?-1:t}function f(t){this.hit=-1,this.dit=[],this.MV=-1,this.Mf=t}function kt(){this.vit="",this.mit="",this.MV=0,this.git=1,this._padding=""}function c(t){var n,i,r,e,n=t.length,i=1;if(1<n)for(i=t[1]-t[0],e=2;e<n;e++)if(i!==(r=t[e]-t[e-1])){i=0;break}return i}function v(t,n){return 0<t?(t-1)%n:n-Math.abs(t)%n-1}function d(t){for(var n="",i=0;i<t;)n+="0",i++;return n}function g(t,n){return 12*(n.getFullYear()-t.getFullYear())+(n.getMonth()-t.getMonth())}function xt(t){return t.every(function(t){var n;return 1===t.getDate()})}function It(t){return t.every(function(t){var n,i,r,e,n=t.getFullYear(),i=t.getMonth(),r,e;return t.getDate()===new Date(n,i+1,0).getDate()})}function Ot(t){var n,i,n=0,i;return t.every(function(t){var t=t.getDate();return(n=n||t)===t})?n:0}function At(t,n){for(var i,r,e,o,i=t.length,r=!0,o=2;o<i&&(r=n===(e=g(t[o-1],t[o])));o++);return r}function St(t){return t.every(function(t){var n=t.getHours(),i=t.getMinutes(),t=t.getSeconds();return 0!==n||0!==i||0!==t})}function Et(t,n){return new Date(t,n+1,0).getDate()}function p(t){return"0"===t[0]}function Vt(n,t,i){var r,e,o,e,o,u,s,u=i?1:2,s=i?2:1;return t.every(function(t){return!!(r=t.match(n.pit))&&(e=r[u],(o=e.length)>n.yit&&p(e)&&(n.yit=o),o=parseInt(e,10),e=r[s],nt(n.cit)&&(n.cit=e),e!==n.cit?(n.wit=!0,n.cit=tt,n.sit=[]):n.sit.push(o),!0)})}function w(){}function Ht(){var t=null!==vt&&vt.apply(this,arguments)||this;return t.Mit=0,t.uit=rt,t}function m(){return null!==dt&&dt.apply(this,arguments)||this}function _(){return null!==gt&&gt.apply(this,arguments)||this}function Nt(){return null!==pt&&pt.apply(this,arguments)||this}function Pt(){var t=wt.call(this)||this;return t.pit=tt,t.sit=[],t.cit=tt,t.wit=!1,t.yit=0,t.uit=et,t.Cit=!1,t.Sit=!1,t.Tit=new W,t}function F(t){var n=mt.call(this)||this;return n.Ait=new B(t),n}function Gt(){var t=null!==_t&&_t.apply(this,arguments)||this;return t.pit=/^\d+$/,t}function Lt(){var t=null!==Ct&&Ct.apply(this,arguments)||this;return t.pit=/^(.*\D+)(\d+)$/,t}function Bt(){var t=null!==yt&&yt.apply(this,arguments)||this;return t.pit=/^(\d+)(\D+.*)$/,t}function b(){var t=null!==s&&s.apply(this,arguments)||this;return t.pit=/^(.*\D+)(\d+)(\D+.*)$/,t}function Wt(){return null!==a&&a.apply(this,arguments)||this}function $t(){return null!==Dt&&Dt.apply(this,arguments)||this}function zt(){var t=null!==Ft&&Ft.apply(this,arguments)||this;return t.Cit=!0,t}function qt(t){var n,i,i,t,r,e,o,n=this;n.Iit=[new $,new z,new q],n.xit=new at,n.Nit=new lt,i=V.culture(),i=V.Fe(i).isJCKCulture,t=new U(t),r=new K,e=new J,o=new Q,n.kit=i?[t,r,new Z,e,o,new X]:[t,r,e,o]}function Ut(t){t.forEach(function(t){t&&t.dispose()})}function R(t){this.Mf=t,this.Dit=!1,this._it=[]}i=this&&this.__extends||(ht=function(t,n){return(ht=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}ht(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(t,"__esModule",{value:!0}),t.Wtt=t.nnt=t.FillDateUnit=t.FillType=t.FillSeries=t.FillDirection=t.AutoFillType=void 0,e=n("Common"),h=n("Core"),r=n("CalcEngine"),T=n("SheetsCalc"),n=n("./dist/plugins/fill/fill.ns.js"),x=!!r,o=e.Common.lt,tt=null,C=void 0,y=Math.floor,D=h.Ec,nt=o.ht,I=o.uJ,u=e.Common.Uf,O=u.Eit,M=u.tR,u=e.Common.ct,A=u.o0,S=u.Y0,it="number",rt="date",et="string",E="default",u=new e.Common.ResourceManager(n.SR,"Fill"),k=u.getResource.bind(u),V=e.Common.CultureManager,(n=H=t.AutoFillType||(t.AutoFillType={}))[n.copyCells=0]="copyCells",n[n.fillSeries=1]="fillSeries",n[n.fillFormattingOnly=2]="fillFormattingOnly",n[n.fillWithoutFormatting=3]="fillWithoutFormatting",n[n.clearValues=4]="clearValues",n[n.auto=5]="auto",(u=N=t.FillDirection||(t.FillDirection={}))[u.left=0]="left",u[u.right=1]="right",u[u.up=2]="up",u[u.down=3]="down",(n=P=t.FillSeries||(t.FillSeries={}))[n.column=0]="column",n[n.row=1]="row",(u=G=t.FillType||(t.FillType={}))[u.direction=0]="direction",u[u.linear=1]="linear",u[u.growth=2]="growth",u[u.date=3]="date",u[u.auto=4]="auto",(n=L=t.FillDateUnit||(t.FillDateUnit={}))[n.day=0]="day",n[n.weekday=1]="weekday",n[n.month=2]="month",n[n.year=3]="year",l.prototype.jit=function(){return M(this.rit)},l.prototype.Oit=function(){for(var t=this,n=[],i=t.oit,r,e,r=0;r<M(i);r++)e=i[r],n.push("object"===t.uit?t.r0(e):e);return n},l.prototype.Rit=function(){var t,n,i,r,e,t=this,n=t.rit;if(0<M(n)){for(r=[],e=void 0,-1===(i=t.lit)&&(i=n[0]),e=0;e<M(n);e++)r[e]=n[e]-i+1;return r}return tt},l.prototype.Bit=function(){var t=this.oit;return M(t)?t:tt},l.prototype.Eit=function(t,n,i){if(!ut(i))throw new Error(k().Exp_NumberOnly);var r=this;nt(r.uit)&&(r.uit=i instanceof Date?rt:it),O(r.rit,t,n),O(r.oit,t,I(i))},l.prototype.ZP=function(t,n){var i=this,r=nt(i.uit);ut(n)?(r&&(n instanceof Date?i.uit=rt:i.uit=it),i.oit.push(I(n))):r&&(i.uit=st(n)?et:E),i.rit.push(t),i.ait.push(n)},l.prototype.Lit=function(t){return this.uit===rt?this.r0(t):t},l.prototype.r0=function(n){var i=tt;if(n instanceof Date)i=n;else if(r)try{i=r.Convert.r0(n)}catch(t){i=n}return i},ot=l,f.prototype.L0=function(){this.Mf=tt},f.prototype.Fit=function(){var t=this.Mf;return t.parent&&t.parent.Ow()||[]},f.prototype.Pit=function(t){var n,i,r,e,o,u,s,a,l,f,c,h,v,d,g,p,n=t.length,i=!1;if(t&&0<n)for(r=Mt(t[0]),e=this.Fit(),f=l=a=s=u=o=void 0,o=0;o<e.length;o++)if(0<=(a=(s=(u=e[o]).map(Mt)).indexOf(r))){for(l=a,c=s.length,d=v=h=void 0,g=1;g<n;g++){if(v=Mt(t[g]),!(0<=(h=s.indexOf(v)))){i=!1;break}if(d=h-l+c,f){if(f!==d){i=!1;break}}else i=!0,f=d,l=h}if(p=1===n,i||p){i=!0,this.hit=a,this.dit=u,this.MV=p?1:f;break}}return i},f.prototype.Sl=function(t){var n=this.dit,i=this.hit,r=this.MV,e=n.length,o,u,u;return n[(i+r*v(t,e))%e]},B=f,kt.prototype.Sl=function(t){var t=this.MV*(t-1)+this.git,n=this._padding.length,t=""+Math.abs(t),i,r=this._padding+t,e=r.length,t=n<t.length?t:r.substr(e-n);return this.vit+t+this.mit},W=kt,w.prototype.match=function(t){return!1},w.prototype.getTargetValue=function(t,n,i,r,e){},w.prototype.resetProp=function(){},w.prototype.Git=function(t,n){return t.indexOf(n+1)},w.prototype.dispose=function(){},i(Ht,vt=u=w),i(m,dt=n=Ht),m.prototype.match=function(t){var n,i,r,e,n=this.Mit=g(t[0],t[1]),i=xt(t),r=t.length,e=!0;return i&&2<r&&(e=At(t,n)),i&&e},m.prototype.getTargetValue=function(t,n){var i,t=t.ait[0],r=t.getFullYear(),e,o,u,t=t.getMonth()+this.Mit*(n-1);return new Date(r+parseInt(t/12,10),t%12,1)},$=m,i(_,gt=n),_.prototype.match=function(t){var n,i,r,e,n=this.Mit=g(t[0],t[1]),i=It(t),r=t.length,e=!0;return i&&2<r&&(e=At(t,n)),i&&e},_.prototype.getTargetValue=function(t,n){var i,t=t.ait[0],r=t.getFullYear(),e,o,u,t=t.getMonth()+this.Mit*(n-1),n=r+parseInt(t/12,10),r=t%12;return new Date(n,r,Et(n,r))},z=_,i(Nt,pt=n),Nt.prototype.match=function(t){var n,i,r,e,o,u,n=!1;return St(t)||(i=this.Mit=g(t[0],t[1]),e=0<(r=Ot(t)),o=t.length,u=!0,this.Uit=r,e&&2<o&&(u=At(t,i)),n=e&&u),n},Nt.prototype.getTargetValue=function(t,n){var i,t=t.ait[0],r=t.getFullYear(),e,o,u,t=t.getMonth()+this.Mit*(n-1),n=r+parseInt(t/12,10),s;return new Date(n,t%12,this.Uit)},q=Nt,i(Pt,wt=u),Pt.prototype.resetProp=function(){this.sit=[],this.yit=0,this.cit=tt,this.wit=!1,this.Cit=!1,this.Sit=!1},Pt.prototype.getInternal=function(t){for(var n,i,r,e,n=!1,i=t[0],e=1;e<t.length;e++)if(r=t[e],1!==Math.abs(r-i)){n=!0;break}return n},i(F,mt=n=Pt),F.prototype.dispose=function(){var t=this;t.Ait&&(t.Ait.L0(),t.Ait=tt)},F.prototype.match=function(t){return this.Ait.Pit(t)},F.prototype.getTargetValue=function(t,n,i,r,e){var o,t=t.ait.length,i=this.Git(i,r),r=tt,u;return r=-1!==i?this.Ait.Sl(u=t*e+i+1):r},U=F,i(Gt,_t=n),Gt.prototype.match=function(t){var n=this,i,r,r;return t.every(function(t){return!!(i=t.match(n.pit))&&((r=t.length)>n.yit&&p(t)&&(n.yit=r),r=parseInt(t,10),n.sit.push(r),!0)})},Gt.prototype.getTargetValue=function(t,n,i,r,e){var o=t.ait,u=this.Tit,s=c(this.sit),o=o.length,a=0!==s,n=a?0:v(n,o),i=this.Git(i,r),r=tt,l;return this.Cit=a,this.Sit=this.getInternal(t.rit),-1!==i&&(u.MV=s,u.git=this.sit[n],u._padding=d(this.yit),r=u.Sl(l=o*e+i+1)),r},K=Gt,i(Lt,Ct=n),Lt.prototype.match=function(t){return Vt(this,t,!1)},Lt.prototype.getTargetValue=function(t,n,i,r,e){var o=t.ait,u=this.Tit,s=c(this.sit),o=o.length,a=0!==s,n=a?0:v(n,o),i=this.Git(i,r),r=tt,l;return this.Cit=a,this.Sit=this.getInternal(t.rit),-1!==i&&(u.vit=this.cit,u.MV=s,u.git=this.sit[n],u._padding=d(this.yit),r=u.Sl(l=o*e+i+1)),r},J=Lt,i(Bt,yt=n),Bt.prototype.match=function(t){return Vt(this,t,!0)},Bt.prototype.getTargetValue=function(t,n,i,r,e){var o=t.ait,u=this.Tit,s=c(this.sit),o=o.length,a=0!==s,n=a?0:v(n,o),i=this.Git(i,r),r=tt,l;return this.Cit=a,this.Sit=this.getInternal(t.rit),-1!==i&&(u.mit=this.cit,u.MV=s,u.git=this.sit[n],u._padding=d(this.yit),r=u.Sl(l=o*e+i+1)),r},Q=Bt,i(b,s=n),b.prototype.resetProp=function(){s.prototype.resetProp.call(this),this.Hit=tt},b.prototype.match=function(t){var n,i,r,i,n,r,e,e=this;return t.every(function(t){return!!(n=t.match(e.pit))&&(i=n[2],(r=i.length)>e.yit&&p(i)&&(e.yit=r),r=parseInt(i,10),i=n[1],nt(e.cit)&&(e.cit=i),n=n[3],nt(e.Hit)&&(e.Hit=n),i!==e.cit||n!==e.Hit?(e.wit=!0,e.cit=tt,e.Hit=tt,e.sit=[]):e.sit.push(r),!0)})},b.prototype.getTargetValue=function(t,n,i,r,e){var o=this,u=t.ait,s=o.Tit,a=c(o.sit),u=u.length,l=0!==a,n=l?0:v(n,u),i=o.Git(i,r),r=tt,f;return o.Cit=l,o.Sit=o.getInternal(t.rit),-1!==i&&(s.vit=o.cit,s.mit=o.Hit,s.MV=a,s.git=o.sit[n],s._padding=d(o.yit),r=s.Sl(f=u*e+i+1)),r},Y=["-","_",":",".",","],i(Wt,a=X=b),Wt.prototype.resetProp=function(){a.prototype.resetProp.call(this),this.zit=tt},Wt.prototype.match=function(t){var r,e,o,r,e,o,u,s,u=this;return t.every(function(n){var t,t,t,i,t=u.zit;if(s=nt(t)?Y.some(function(t){if(bt(n,t))return u.zit=t,!0}):bt(n,t)){if(t=u.zit,t=n.lastIndexOf(t),r=n.substring(0,t+1),nt(u.cit))u.cit=r;else if(u.cit!==r)return!1;if(t=n.substr(t+1),r=t.match(i=/^(\d+)(\D+.*)$/))return e=r[1],(o=e.length)>u.yit&&p(e)&&(u.yit=o),o=parseInt(e,10),e=r[2],nt(u.Hit)&&(u.Hit=e),e!==u.Hit?(u.cit=tt,u.Hit=tt,!(u.sit=[])):(u.sit.push(o),!0)}return!1})},Z=Wt,i($t,Dt=u),$t.prototype.getTargetValue=function(t,n,i){return Tt(!0,t.Bit(),i,n)},at=$t,i(zt,Ft=u),zt.prototype.getTargetValue=function(t,n,i,r){var t=t.ait,e,o;return t[v(n,t.length)]},lt=zt,qt.prototype.getRule=function(t,n){var i,r,e,o,u,i=[],r=this.Nit;for(t===rt?(i=this.Iit,r=this.xit):t===et?i=this.kit:t===it&&(r=this.xit),e=0;e<i.length;e++)if(u=void 0,(o=i[e]).resetProp(),o.match(n)){if(u=o.wit,nt(u)||!1===u)return o;if(!0===u)return r}return r},qt.prototype.L0=function(){var t=this;t.Iit&&(Ut(t.Iit),t.Iit=tt),t.kit&&(Ut(t.kit),t.kit=tt),t.xit&&(t.xit.dispose(),t.xit=tt),t.Nit&&(t.Nit.dispose(),t.Nit=tt)},t.nnt=qt,R.prototype.qtt=function(t,n,i,r,e){var o=this,t=t?1:2;nt(r)&&nt(e)?o.$tt(n,i,t):o.$tt(n,i,t,r,e,tt)},R.prototype.$tt=function(t,n,i,r,e,o){var u,s,t,a,l,f,c,h,v,d,g,p,w,m,_,C,y,D,F,t,b,R,p,j,T,u=this,s=u.Mf,t=s.JS(t),a=t.row,l=t.col,f=t.rowCount,c=t.colCount;if(s.Ut.eE(a,l,f,c))throw new Error(k().Exp_RangeContainsMergedCell);for(m=0,C=(_=1===n)?c:f,D=_?a+f:l+c,F=(w=3<arguments.length)?1:C,b=(t=this.Mf.rt.Ktt).row===a&&t.rowCount===f&&t.col>l||t.col===l&&t.colCount===c&&t.row>a,h=y=_?a:l;h<D;h++)if(p=b&&w?a+f-1:a,(j=_?u.Vit(h,R=b&&w?l+c-1:l,1,F,n):u.Vit(p,h,F,1,n))&&j.jit())for(g=j.rit[0],w?(p=b?j.oit[M(j.oit)-1]:j.oit[0],v=u.Yit(b,p,C,i,r,e,o),b&&(m=C-M(v),g=j.rit[M(j.rit)-1])):v=u.Zit(j,C,i),d=0;d<M(v);d++)T=j.Lit(v[d]),_?u.Wit(s,h,g,h,l+m+d,T,i):u.Wit(s,g,h,a+m+d,h,T,i)},R.prototype.Vit=function(t,n,i,r,e){for(var o=tt,u=this.Mf,s,a=1===e,l=a?n+r-1:t+i-1,f=a?n:t;f<=l;)ut(s=a?u.getValue(t,l):u.getValue(l,n))&&(o=o||new ot(f)).Eit(0,l,s),l--;return o},R.prototype.Yit=function(t,n,i,r,e,o,u){for(var s,a,l,f,c,h,v,s=[],a=n,f=0<=e,c=nt(o),l=0;l<i;l++)h=o<=a,v=a<=o,t&&(c||f&&h||!f&&v)?(s.unshift(a),1===r?a-=e:2===r?a/=e:3!==r||nt(u)||(a=this.Qit(!0,u,n,a,e,l+1))):!t&&(c||f&&v||!f&&h)&&(s.push(a),1===r?a+=e:2===r?a*=e:3!==r||nt(u)||(a=this.Qit(!1,u,n,a,e,l+1)));return s},R.prototype.Zit=function(t,n,i){var r=[],e,o=1===i;if(o||2===i){for(1===t.jit()&&t.ZP(t.rit[0]+1,o?t.Lit(t.oit[0]+1):t.Oit()[0]),e=0;e<n;e++)r.push(Tt(!!o,t.Bit(),t.Rit(),e+1));return r}return tt},R.prototype.Jtt=function(t,n,i,r,e,o){var u,s,a,t,l,f,c,t,s,h,v,a,u=this,s=u.Mf,a=s.Ut,t=s.JS(t),l=t.row,f=t.col,c=t.rowCount,t=t.colCount,s=s.JS(s.rt.Ktt),h=s.row,v=s.col;if(a.GT(h,v,s.rowCount,s.colCount)||a.GT(l,f,c,t))throw new Error(k().Exp_ChangeMergedCell);return a=u.Kit(s,c,t,n,i,!(l<h||f<v),r,e,o),u.Jit&&u.Jit.IB&&(u.Jit.IB.reFilter(),delete u.Jit),a},R.prototype.Kit=function(t,n,i,r,e,o,u,s,a){var l=this,f=o?1:-1,c,h,v,d,g=t.row,p=t.col,w=t.rowCount,m=t.colCount;if(1===r){if(c=y(i/m),h=i%m,!e)for(d=1;d<c;d++)l.Mf.$He=d*f,v=D(g,p+d*f*m,w,m),l.Tle(t,v,r,4,e,o,C,C,!0,u,s),l.Xit(t,v,r,4,e,o,C,C,!0,u,s),delete l.Mf.$He;if(e&&1<c&&0===h&&(c-=1,h=m),0<c&&0<h)return v=D(g,o?p+c*m:p-c*m+m-h,w,h),l.Tle(t,v,r,4,e,o,tt,o?0:m-h,C,u,s),l.Xit(t,v,r,4,e,o,tt,o?0:m-h,C,u,s)}else{if(c=y(n/w),h=n%w,l.Dit||(v=D(g+f*w,p,n-w,i),l.qit(t,v,f,a)),!e)for(d=1;d<c;d++)v=D(g+d*f*w,p,w,m),l.Tle(t,v,r,4,e,o,tt,tt,!0,u,s),l.Xit(t,v,r,4,e,o,tt,tt,!0,u,s);if(e&&1<c&&0===h&&(c-=1,h=w),0<c&&0<h)return v=D(o?g+c*w:g-c*w+w-h,p,h,m),l.Tle(t,v,r,4,e,o,o?0:w-h,tt,!0,u,s),l.Xit(t,v,r,4,e,o,o?0:w-h,tt,!0,u,s)}},R.prototype.Xit=function(t,n,V,i,r,e,H,N,o,u,s){for(var a,l,P,f,c,h,v,d,G,g,L,p,B,w,W,m,_,C,y,D,F,b,$,z,q,R,j,T,M,U,k,x,c,K,I,J,Q,X,O,A,Y,S,E,Z,a=this,l=a.Mf,P=l.Ut,f=1===V,G=f?t.row:t.col,g=f?t.col:t.row,L=f?n.row:n.col,p=f?n.col:n.row,B=f?t.rowCount:t.colCount,w=f?t.colCount:t.rowCount,W=f?n.colCount:n.rowCount,v=0;v<B;v++){for(C=0,F=y=G+v,b=D=L+v,$=(f?N:H)||0,z=f?0:$,q=f?tt:o,R=_=m=tt;C<w;)if(M=void 0,U=j=g+C,k=T=p+C-$,f||(y=j,j=F,D=T,T=b),h=P.findSpan(y,j),M=l.getValue(y,j),(x=a.Dit)&&nt(R)&&(R=!1===e?l.getValue(g+w-1,j):l.getValue(y,j)),x||4!==i||!ut(M)&&!st(M)||l.hasFormula(y,j)||(m=m||new ot,c=ut(M)?M instanceof Date?rt:it:et,(_=_||c)!==c))if(!x&&M&&m&&m.jit()){if(d=a.$it(f,t,n,F,b,m,r,e,z,q,u,s),r&&d)return d;_=m=tt}else{if(x||!h||h&&(f?h.row:h.col)===F)if(c=k===p+W-1,K=x?R:M,r){if(x)return K;if(h&&c||!h&&(c&&e||!e&&k===p))return M}else!(k<p+W&&p<=k)||!x&&!f&&(f||o&&l.XT&&l.XT(k))||x&&-1!==a._it.indexOf(D)||a.Wit(l,y,j,D,T,K,i,u,s);h?C+=f?h.colCount:h.rowCount:C++}else m.ZP(U,M),h?C+=f?h.colCount:h.rowCount:C++;if(a.Dit)for(I=t.row,J=t.col,Q=t.rowCount,X=t.colCount,A=O=void 0,Y=!1===e?-1:1,S=1;S<Q;S++)for(O=I+Y*S,E=0;E<X;)A=J+E,Z=!1===e?l.getValue(g+w-1,A):l.getValue(I,A),-1===a._it.indexOf(O)&&a.Wit(l,I,J,O,A,Z,i,u,s),E++;if(m&&m.jit()&&(d=a.$it(f,t,n,F,b,m,r,e,z,o,u,s),r)&&!nt(d))return d}return tt},R.prototype.Tle=function(t,n,V,i,r,e,H,N,P,o,u){var s,a,G,l,f,c,h,v,d,L,g,B,p,W,w,$,m,_,C,y,D,F,b,R,z,q,j,T,M,k,U,x,c,c,h,I,K,J,Q,O,A,X,S,E,Y;if(!r){for(l=(G=(a=(s=this).Mf).Ut).yle(),L=(f=1===V)?t.row:t.col,g=f?t.col:t.row,B=f?n.row:n.col,p=f?n.col:n.row,W=f?t.rowCount:t.colCount,w=f?t.colCount:t.rowCount,$=f?n.colCount:n.rowCount,d=0;d<W;d++){for(C=0,F=y=L+d,b=D=B+d,R=(f?N:H)||0,z=f?0:R,q=f?tt:P,j=_=m=tt;C<w;)k=tt,U=T=g+C,x=M=p+C-R,f||(y=T,T=F,D=M,M=b),v=G.findSpan(y,T),c=a.getValueIgnoreDefault(y,T),nt(c)?C++:((c=l.getFormula(y,T))&&""!==c||(k=l.getValue(y,T)),(c=s.Dit)&&nt(j)&&(j=!1===e?l.getValue(g+w-1,T):l.getValue(y,T)),c||4!==i||!ut(k)&&!st(k)||(m=m||new ot,h=ut(k)?k instanceof Date?rt:it:et,(_=_||h)!==h)?!c&&k&&m&&m.jit()?(s.$it(f,t,n,F,b,m,r,e,z,q,o,u,!0),_=m=tt):((c||!v||v&&(f?v.row:v.col)===F)&&(h=c?j:k,!(x<p+$&&p<=x)||!c&&!f&&(f||P&&a.XT&&a.XT(x))||c&&-1!==s._it.indexOf(D)||s.Wit(a,y,T,D,M,h,i,o,u,!0)),v?C+=f?v.colCount:v.rowCount:C++):(m.ZP(U,k),v?C+=f?v.colCount:v.rowCount:C++));if(s.Dit)for(I=t.row,K=t.col,J=t.rowCount,Q=t.colCount,A=O=void 0,X=!1===e?-1:1,S=1;S<J;S++)for(O=I+X*S,E=0;E<Q;)Y=!1===e?l.getValue(g+w-1,A):l.getValue(I,A),A=K+E,-1===s._it.indexOf(O)&&s.Wit(a,I,K,O,A,Y,i,o,u,!0),E++;m&&m.jit()&&s.$it(f,t,n,F,b,m,r,e,z,q,o,u,!0)}return tt}},R.prototype.qit=function(t,n,i,r){var e,o,u,n,s,a,n,l,f,t,c,h,v,d,g,p,w,m,_,C,y,D,F,b,R,e=this,o=e.Mf,u=o.tables,n=t.union(n),s=n.row,a=n.rowCount,n=t.row,l=t.col,f=t.rowCount,t=t.colCount;if(u)for(h=0,v=c=u.AB(n,l,f,t);h<v.length;h++){if(g=(d=v[h]).Ky,p=d.iw,w=a,r)for(m=0,_=r;m<_.length;m++)if((C=_[m]).row===g&&C.col===p){w=C.rowCount,e.Jit=d;break}if(y=d.IB,D=e._it,F=void 0,y&&y.isFiltered&&y.isFiltered()){for(b=0;b<w;b++)y.isRowFilteredOut(F=s+i*b)&&e._it.push(F);if(0<D.length){e.Dit=!0;break}}}if(R=o.IB,!0!==e.Dit&&R&&R.isFiltered&&R.isFiltered()){for(D=e._it,F=void 0,b=0;b<a;b++)R.isRowFilteredOut(F=s+i*b)&&e._it.push(F);0<D.length&&(e.Dit=!0)}},R.prototype.Wit=function(t,n,i,r,e,o,u,s,a,l){var f,c,c,c,u,f=t.Ut,c=t.isActualProtected()&&t.getCell(n,i).hidden();x&&!c&&(l?((c=f.yle().getExpression(n,i))&&t.hasFormula(n,i,3,!0)||!nt(t.getValueIgnoreDefault(n,i)))&&(0,h.copyDefaultFormula)(t,t,r,e,c):(t.hasFormula(n,i,3)||t.hasFormula(r,e,3))&&(t.setFormula(r,e,tt),0!==u&&4!==u||(t.getFormula(n,i)||f.getDefaultValue(n,i,tt,h.DefaultChangeValueType.Expression))&&T.CalcOperatorAdjustor.copyFormula(t,n,i,t,r,e,1,1,C,!0))),l||nt(t.getValueIgnoreDefault(n,i))&&!nt(f.getDefaultValue(n,i,tt,h.DefaultChangeValueType.Value))?f.getDefaultValue(n,i,tt,h.DefaultChangeValueType.Expression)||f.setDefaultValue(r,e,o,tt,h.DefaultChangeValueType.Value):t.setValue(r,e,o),l||(c=a?0:64,s&&(c|=4224),t.vT(n,i,r,e,1,1,c=c|1024|256,C,!0),a)||(t.removeSpan(r,e,3),(u=f.findSpan(n,i))&&n===u.row&&i===u.col&&t.EL(r,e,u.rowCount,u.colCount,3))},R.prototype.$it=function(t,n,i,r,e,o,u,s,a,l,f,c,h){var v,d,g,p,w,m,_,C,y,D,F,b,R,j,T,M,k,x,T,I,M,T,v=this,d=v.Mf,_=t?i.col:i.row,C=t?n.col:n.row,y=t?i.colCount:i.rowCount,D=t?n.colCount:n.rowCount;if(a=a||0,F=o.jit(),b=(_-C-a)/D,R=v.Cit(o.rit,o.oit),j=o.uit,R){for(w=[],p=0;p<F;p++)w[p]=p+1;g=F}else m=o.rit[0],g=o.rit[F-1]-m+1,1===F&&j!==et&&o.ZP(o.rit[0]+1,o.Lit(o.oit[0]+1)),w=o.Rit();for(p=0;p<g;p++)if(T=o.ait,x=k=M=void 0,I=_+y-1,T=(M=(x=(M=j!==rt&&j!==et?M:d.tnt&&d.tnt.getRule(j,T))?(k=M.getTargetValue(o,g*b+p+1,w,p,b),R=M.Cit||R,T=M.Sit||!1,R&&!T):(k=Tt(!0,o.Bit(),w,g*b+p+1),R))?o.rit[p]:m+p)+b*D,u){if(R&&(s&&T===I||!s&&T===_)||!R&&T+a===I)return o.Lit(k)}else T<_+y&&_<=T&&(t?l&&d.XT&&d.XT(r)||v.Wit(d,r,M,e,T,o.Lit(k),4,f,c,h):l&&d.XT&&d.XT(T)||v.Wit(d,M,r,T,e,o.Lit(k),4,f,c,h));return tt},R.prototype.Cit=function(t,n){var i,r,e,o,i=M(n);if(i<=1||M(t)!==i)return!1;for(r=t[1]-t[0],e=n[1]-n[0],o=2;o<i;o++)if(t[o]-t[o-1]!=r||n[o]-n[o-1]!=e)return!1;return!0},R.prototype.Xtt=function(t,n){var i=this,r=this.Mf,e=r.Ut.getSpans(),t=r.JS(t),o=t.row,u=t.col,s=t.rowCount,t=t.colCount,a,a=0===n?D(o,u+t-1,s,1):1===n?D(o,u,s,1):D(2===n?o+s-1:o,u,1,t);(a=r.nR(e,a))&&i.trt(a,o,u,s,t,n)},R.prototype.trt=function(t,n,i,r,e,o){var u=this,s=t.row,a=t.col,l=t.rowCount,f=t.colCount,c,h,v,d,g,p,w,m=u.Mf.Ut,_,g=0===o?(_=m.eE(n,i,r,e-f),p=0,w=-1*f,v=e,d=f,1):1===o?(_=m.eE(n,i+f,r,e-f),p=0,v=e,d=w=f,1):w=(d=2===o?(_=m.eE(n,i,r-l,e),p=-1*l,v=r,l):(_=m.eE(n+l,i,r-l,e),v=r,p=l),0);if(_)throw new Error(k().Exp_TargetContainsMergedCells);if(v%d!=0)throw new Error(k().Exp_MergedCellsIdentical);for(c=y(v/d),h=1;h<c;h++)u.Xit(t,D(s+h*p,a+h*w,l,f),g,0,C,C,C,C,!0)},R.prototype.Qit=function(t,n,i,r,e,o){var u,t,s,a,u=t?-1:1,t=y(o*e),s=Math.abs(e),a=S(1<n?i:r);if(0===n)a.setDate(a.getDate()+u*e);else if(1===n)for(;0<s;)a.setDate(a.getDate()+u*(0<e?1:-1)),6!==a.getDay()&&0!==a.getDay()&&s--;else 2===n?a.setMonth(a.getMonth()+u*t):a.setFullYear(a.getFullYear()+u*t);return A(a)},t.Wtt=R},"./dist/plugins/fill/fill.ns.js":function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var i=i("./dist/plugins/fill/fill.res.en.js");n.SR={en:i}},"./dist/plugins/fill/fill.res.en.js":function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_ChangePartOfArray=n.Exp_RangeIsNull=n.Exp_CellReadOnly=n.Exp_RowReadOnly=n.Exp_ColumnReadOnly=n.Exp_ChangeMergedCell=n.Exp_FillCellsReadOnly=n.Exp_FillRangeContainsMergedCell=n.Exp_MergedCellsIdentical=n.Exp_TargetContainsMergedCells=n.Exp_RangeContainsMergedCell=n.Exp_NumberOnly=n.FillWithoutFormatting=n.FillFormattingOnly=n.FillSeries=n.CopyCells=void 0,n.CopyCells="Copy Cells",n.FillSeries="Fill Series",n.FillFormattingOnly="Fill Formatting Only",n.FillWithoutFormatting="Fill Without Formatting",n.Exp_NumberOnly="Only works for Numbers",n.Exp_RangeContainsMergedCell="Range should not have merged cells.",n.Exp_TargetContainsMergedCells="Target range should not have merged cells.",n.Exp_MergedCellsIdentical="This operation requires the merged cells to be identically sized.",n.Exp_FillRangeContainsMergedCell="Cannot fill range that contains a merged cell.",n.Exp_FillCellsReadOnly="The cells you are trying to fill are protected and therefore read-only.",n.Exp_ChangeMergedCell="Cannot change part of merged cell.",n.Exp_ColumnReadOnly="The column you are trying to change is protected and therefore read-only.",n.Exp_RowReadOnly="The row you are trying to change is protected and therefore read-only.",n.Exp_CellReadOnly="The cell you are trying to change is protected and therefore read-only.",n.Exp_RangeIsNull="range is null",n.Exp_ChangePartOfArray="Cannot change part of an array."},"./dist/plugins/fill/utils.js":function(t,n,i){var f,o,u,c,s,h;function r(t){return t.rowViewportIndex}function e(t){return t.colViewportIndex}function a(t){return t.frozenRowCount()}function l(t){return t.frozenColumnCount()}function v(t){return t.hitTestType}function d(t,n){return t.getRowCount(n)}function g(t,n){return t.getColumnCount(n)}function p(t){return t.colCount}function w(t){return t.rowCount}function m(t){return t.height}function _(t){return t.width}function C(t){var n,t,n=7,t=t.parent;return n=t?2007<t.SC?2:7:n}function y(t,n,i,r,e,o,u){var s,a,l;t.save(),o=o||h,u=u||2,n===r?(t.rect(n-2,i,7,c(e-i)),t.clip(),t.beginPath(),i<e?(i-=3,e+=3):(i+=3,e-=3),s=(0,f.Zx)(n-1,i-1,r-1,e+1,o,u),a=(0,f.Zx)(n,i,r,e,o,u),l=(0,f.Zx)(n+1,i-1,r+1,e+1,o,u)):i===e&&(t.rect(n,i-2,c(r-n),7),t.clip(),t.beginPath(),n<r?(n-=3,r+=3):(n+=3,r-=3),s=(0,f.Zx)(n-1,i-1,r+1,e-1,o,u),a=(0,f.Zx)(n,i,r,e,o,u),l=(0,f.Zx)(n-1,i+1,r+1,e+1,o,u)),s&&s.qx(t),a&&a.qx(t),l&&l.qx(t),t.strokeStyle=o,t.stroke(),t.beginPath(),t.restore()}function D(t,n,i,r,e){for(var o,u,s,o=0;o<i.rowCount;o++){for(u=0;u<i.colCount;u++){if(!(s=t.getSpan(i.row+o,i.col+u))||s.rowCount!==n.rowCount||s.colCount!==n.colCount)return!1;r&&(u+=n.colCount)}e&&(o+=n.rowCount)}return!0}function F(t,n,i){var r,e,o,u,s,a,l,f,e,u,r,r=n.row,e=n.rowCount,o=n.col,u=n.colCount,s=i.row,a=i.rowCount,l=i.col,f=i.colCount,e=r===s&&e===a,u=o===l&&u===f;return(e||u)&&!(!(r=t.getSpan(r,o))||!D(t,r,n,e,u)||t.Ut.GT(s,l,a,f))&&D(t,r,i,e,u)}function b(t){return t.x+t.width}function R(t){return t.y+t.height}function j(t,n){var i,r,r,e,r,o,i=t.rt.eD(),r=t.Yy(i);return(r=r&&r.findNearX(n,t.options.rightToLeft))?(e=t.Fi(),r=r.col,1===i&&n<e.Py&&(o=t.Sw())<r&&t.O5(r-1)||r):-1}function T(t,n){var i,i,i,r,i,e,i=t.rt.nD(),i=t._y(i);return(i=i&&i.findNearY(n,t.options.rightToLeft))?(r=t.Fi(),i=i.row,n<r.Cy&&(e=t.pw())<i&&t.j5(i-1)||i):-1}function M(t){t.dragHeaderToMoveInfo&&(t.dragHeaderToMoveInfo.dragColumn?t.rowViewportIndex<0&&(t.rowViewportIndex=0):t.colViewportIndex<0&&(t.colViewportIndex=0),t.hitTestType=3)}function k(t,n){var i,r,e,t,i,r,e,t;return t||n?!t&&n?n:t&&!n?t:(i=t.x,r=t.y,e=b(t),t=R(t),i=u(i,n.x),r=u(r,n.y),e=s(e,b(n)),t=s(t,R(n)),new f.Rect(i,r,e-i,t-r)):o}function x(t){return t.frozenColumnCount()>=t.getColumnCount()?0:0<t.frozenTrailingColumnCount()?2:1}function I(t){return t.frozenRowCount()>=t.getRowCount()?0:0<t.frozenTrailingRowCount()?2:1}function O(t){var n,i,n,r,n,e,o,t,u,s,n=t.Fi(),i,n=t.options.rightToLeft?n.c9(0,2):n.c9(0,0),r=n.x,n=n.y,e=x(t),o=I(t),t=t.Dn.uO(o,e),u,s;return{minPoint:{x:r,y:n},maxPoint:{x:b(t),y:R(t)}}}Object.defineProperty(n,"__esModule",{value:!0}),n.getSheetVPortBoundary=n.mergeRect=n.fixHitTestInfo=n.getHitRowIndex=n.getHitColumnIndex=n.getEndY=n.getEndX=n.canDragFillSpan=n.hasSameSpan=n.paintDragLine=n.getLineStyle=n.getWidth=n.getHeight=n.getRowCount=n.getColCount=n.getSheetColumnCount=n.getSheetRowCount=n.getHitTestType=n.getFrozenColumnCount=n.getFrozenRowCount=n.getColViewportIndex=n.getRowViewportIndex=void 0,f=i("Core"),o=null,u=Math.min,c=Math.abs,s=Math.max,h="black",n.getRowViewportIndex=r,n.getColViewportIndex=e,n.getFrozenRowCount=a,n.getFrozenColumnCount=l,n.getHitTestType=v,n.getSheetRowCount=d,n.getSheetColumnCount=g,n.getColCount=p,n.getRowCount=w,n.getHeight=m,n.getWidth=_,n.getLineStyle=C,n.paintDragLine=y,n.hasSameSpan=D,n.canDragFillSpan=F,n.getEndX=b,n.getEndY=R,n.getHitColumnIndex=j,n.getHitRowIndex=T,n.fixHitTestInfo=M,n.mergeRect=k,n.getSheetVPortBoundary=O},Common:function(t){t.exports=GC.Spread},CalcEngine:function(t){t.exports=GC.Spread.CalcEngine},Core:function(t){t.exports=GC.Spread.Sheets},SheetsCalc:function(t){t.exports=GC.Spread.Sheets.CalcEngine},Touch:function(t){t.exports=GC.Spread.Sheets.Touch}},r={},t=e("./dist/plugins/fill/fill.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Fill=t}();
;var GC;!function(){"use strict";var i,r,n;function e(n){var t,t,t=r[n];return void 0!==t||(t=r[n]={exports:{}},i[n].call(t.exports,t,t.exports,e)),t.exports}i={"./dist/plugins/touch/touch.entry.js":function(n,t,i){var r,e,r=this&&this.__createBinding||(Object.create?function(n,t,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(t,i);e&&("get"in e?t.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,r,e)}:function(n,t,i,r){n[r=void 0===r?i:r]=t[i]}),e=this&&this.__exportStar||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),e(i("./dist/plugins/touch/touch.js"),t)},"./dist/plugins/touch/touch.js":function(P,n,y){var Y,S,F,y,I,y,O,_,Z,c,a,D,Q,L,G,r,b,p,H,N,z,J,K,o,X,V,W,q,$,nn,h,tn,rn,en,on,un,fn,sn,cn,an,hn,v,u,vn,An,ln,B,wn,w,dn,j,L,f,pn,gn,mn,Cn,Mn,bn,M,xn,En,kn,Pn,yn,Fn,In,On,Bn,Yn,Sn,Hn,Nn,jn,Un,Tn,Rn,U,_n,Zn,Dn,Qn,Ln,Gn,zn,Jn,Kn,Xn,Vn,A,Wn,qn,$n,nt,tt,it,rt,et,ot,ut,ft,st,ct,at,ht;function T(n){return n.height}function R(n){return n.width}function vt(n){clearInterval(n)}function l(){return(new Date).valueOf()}function At(n,t){var i,r,e,o,u,f,s,n;return n&&t&&(o=e=i=13,f=u=r=15,s=n.X-t.X,n=n.Y-t.Y,H(s)<13)&&H(n)<13&&V(s*s+n*n)<N(15,15)}function d(n){var n=n.jg();return n instanceof F.Worksheet?n:n&&n.Mf}function m(n){return n.getSelections()}function lt(n){return n.frozenTrailingColumnCount()}function wt(n){return n.frozenTrailingRowCount()}function dt(n,t){return n.getColumnCount(t)}function pt(n,t){return n.getRowCount(t)}function gt(n){var n=O(n).offset(),t=B.body,i=0,r=0;return n&&(i=n.top+t.clientTop||0,r=n.left+t.clientLeft||0),{A0:i,I0:r}}function t(){var n=this;n.j0t=[],n.WTt={length:0},n.QTt=new Mn,n.KTt=new bn}function mt(n,t){var t=K(t.Y,t.X)-K(n.Y,n.X);return o<t?t-=2*o:t<-o&&(t+=2*o),t}function Ct(n,t){return V((t.X-n.X)*(t.X-n.X)+(t.Y-n.Y)*(t.Y-n.Y))}function Mt(n,t,i){var r,e,n,t,r,r=new M(i._Center.X,i._Center.Y),e=new M(t.X-r.X,t.Y-r.Y),n=new M(n.X-r.X,n.Y-r.Y),t=N(1,J(Ct(t,r)/i._Radius,4)),r=mt(e,n);return u(r)?0:r*t}function bt(n){return H(n)<=2220446049250313e-31}function xt(n,t){var i=!1,r=!1,e;return{JTt:i=0!==n&&(e=W(t/n)/o*180)<20?!0:i,XTt:r=0===n||75<(e=W(t/n)/o*180)&&e<105?!0:r}}function i(){var n=this;n.qTt=0,n.$Tt=0,n.tAt=1,n.nAt=0,n.eAt=0,n._process=0,n.rAt=511,n.oAt=new In,n.aAt=20,n.uAt=new xn}function Et(){}function kt(n,t){this.X=n,this.Y=t}function Pt(n){return new M(n?X(n.X):-1,n?X(n.Y):-1)}function e(){var n=this;n.DU=0,n.ak=0,n.sAt=10,n.cAt=[]}function yt(n,t,i,r,e){var o=this;n?o.cAt=n:(o.fAt=new M(t,i),o.lAt=r,o.hAt=e)}function Ft(n){this.dAt=n,this.vAt=0}function It(n){this.dAt=n,this.vAt=0}function Ot(n,t){var i=this;i.mAt=n,i.gAt=t,i.pAt=0,i.bAt=0,i.vAt=0,i.yAt=V(n*n+t*t)}function Bt(){var n=this;n.wAt=new M(0,0),n.tW=0,n.MAt=0,n.CAt=0}function Yt(){this.wY=[]}function St(n,t,i){var r=this;r.nW=n,r.SAt=t,r.TAt=i}function Ht(n,t,i,r,e){var o=this;o.qZ=n,o.nW=t,o.AAt=i,o.JZ=r,o.TAt=e}function Nt(n,t,i,r,e,o){var u=this;u.qZ=n,u.nW=t,u.SAt=i,u.AAt=r,u.JZ=e,u.TAt=o}function jt(n,t,i,r,e,o,u){var f=this;f.qZ=n,f.nW=t,f.SAt=i,f.TAt=r,f.IAt=e,f.xAt=o,f.NAt=u}function Ut(n,t,i,r){var e=this;e.qZ=n,e.kAt=t,e.nW=i,e.JZ=r}function Tt(n,t,i,r){var e=this;e.qZ=n,e.KZ=t,e.DAt=i,e.JZ=r}function Rt(n){this.JZ=n}function _t(n){this.JZ=n}function Zt(n){this.JZ=n}function Dt(n,t){var n=n*t;return 4<n?n=4:n<.5&&(n=.5),n}function Qt(n){this.Mf=n}function Lt(n,t,i,r){var e,o,i,u,f,s,c,a,h,v,v,A,l,w,d,c,e=i,o=0,i=0,u=n.Jt,c=n.Fi(),a=c.Cy,h=n.dw(1).findRow(e),v=n.parent,v=v&&v.options.scrollByPixel&&v.options.scrollbarMaxAlign;if(h)if(0<t){for(f=n.vw(-1),o=a-h.y;f<e&&o<t;)o+=u.Gt(--e);i=t-o}else if(t<0){if(A=0,l=r,v){if(w=n.frozenRowCount(),d=n.getRowCount()-n.frozenTrailingRowCount()-1,s=(c=n.gw(n.Sy(c),w,d)).Ky,A=c.Xy,l=r+t,s<e||e===s&&l<A)return b}else s=n.mw().Ky;for(o=-(h.y+T(h)-a);e<s&&t<o;)o-=u.Gt(++e);i=t-o,v&&e===s&&l<A&&(t=(i=A+u.Gt(e))+o)}return{Ky:e,Xy:i,_At:t}}function Gt(n,t,i,r){var e,o,i,u,f,s,c,a,h,v,A,v,A,l,w,d,c,e=i,o=0,i=0,s=n.Jt,c=n.Fi(),a=c.Py,h=n.yw(1).findCol(e),v=n.parent,A=n.options.rightToLeft,v=v&&v.options.scrollByPixel&&v.options.scrollbarMaxAlign;if(h)if(A){if(0<t){for(f=n.Mw().iw,o=c.b6-h.x;e<f&&o<t;)o+=s.Kt(++e);i=t-o}else if(t<0){for(u=n.ww(-1),o=-(h.x+h.width-c.b6);u<e&&t<o;)o-=s.Kt(--e);i=t-o}}else if(0<t){for(u=n.ww(-1),o=a-h.x;u<e&&o<t;)o+=s.Kt(--e);i=t-o}else if(t<0){if(A=0,l=r,v){if(w=n.frozenColumnCount(),d=n.getColumnCount()-n.frozenTrailingColumnCount()-1,f=(c=n.Cw(n.Gy(c),w,d)).iw,A=c.Xy,l=r+t,f<e||e===f&&l<A)return b}else f=n.Mw().iw;for(o=-(h.x+R(h)-a);e<f&&t<o;)o-=s.Kt(++e);i=t-o,v&&e===f&&l<A&&(t=(i=A+s.Kt(e))+o)}return{iw:e,Xy:i,EAt:t}}function zt(n,t){return vn(-t/(n/t+1)+t+"")}function Jt(n,t){return vn(t*(-t/(n-t)-1)+"")}function C(n,t,i,r,e,o){n.fillStyle=t,n.fillRect(i,r,e,o)}function Kt(n,t,i,r,e){var o,u,f,u,s,c,a,h,u=F.I.He(0,"gc-columnHeader-normal"),f=u&&u.backgroundImage,u=u&&u.backgroundColor;if(f&&-1!==f.indexOf("linear-gradient"))for(s=F.mt.ri(f),o=n.createLinearGradient(t+r/2,i,t+r/2,i+e),c=0,a=s.length;c<a;c++)h=s[c],o.addColorStop(h.point,h.color);else u&&(o=u);return o}function Xt(){var n=F.I.He(0,"gc-rowHeader-normal");return n&&n.backgroundColor}function Vt(n,t){var i,r,e,o,e,u,e,f,s,r,c,a,h,v,A,l,w,d,p,g,u,e,m,A,m,A,A,m,A,m,g,e,p,i=n.Fi(),r=n.Dn,e=n.options,o=n.options.rightToLeft,e=e.sheetAreaOffset,u=e.left,e=e.top,f=r.R7(!1),s=r.J(),r=r._7(),A=n.dw(1),l=qt(n),w=i.J7,d=i.Uy,p=i.X7,g=i.Ty,c=i.BA,u=1<=u?1:0,e=1<=e?1:0,h=R(i);s.save(),r.save(),m=n.vw(-1),(A=A.findRow(m))&&(a=i.Cy,0<(v=A.y-a-1-e))&&(t?(m=i.XC,C(s,A=Xt(),c,a,m-1,v+1),C(r,A,c,a,m-1,v+1),C(s,f,A=o?i.x:c+m,a,m=o?h-m:h-m-l.width,v),C(r,f,A,a,m,v)):(C(s,f,c,a,h,v),C(r,f,c,a,h,v))),j<g&&(C(s,f,c,p,h,v=g-j-e),C(r,f,c,p,h,v)),A=n.yw(1),a=i.LA,v=T(i),m=n.ww(-1),(g=A.findCol(m))&&(o?(c=i.b6,c-=h=c-(g.x+g.width)):(c=i.Py,h=g.x-c-1-u),0<h)&&(t?(C(s,p=Kt(s,c,a,h+1,(e=i.qC)-1),c,a,h+1,e-1),C(r,p,c,a,h+1,e-1),C(s,f,c,a+e,h,v-e-l.height),C(r,f,c,a+e,h,v-e-l.height)):(C(s,f,c,a,h,v),C(r,f,c,a,h,v))),j<d&&(h=d-j-u,C(s,f,w,a,h=o&&w+h>=i.b6?i.b6-w:h,v),C(r,f,w,a,h,v)),r.restore(),s.restore()}function Wt(n,t,i,r,e,o){n.beginPath(),n.strokeStyle=t,n.moveTo(i,r),n.lineTo(e,o),n.stroke()}function qt(n){var t,i=n.options.sheetAreaOffset;return n.gj&&n.gj()||{x:i.left,y:i.top,width:0,height:0}}function $t(n,t){var i,r,e,o,u,f,s,u,s,c,a,h,c,u,n,c,i=n.Fi(),r,e=n.Dn.J(),o=n.options.rightToLeft,u=n.dw(1),f=qt(n),s=n.vw(-1),u=u.findRow(s),s=Q("gc-group").color;u&&(c=i.Cy,0<(a=u.y-c))&&t&&0<f.width&&0===i.XC&&Wt(e,s,h=o?i.BA-.5:i.b6-.5,c,h,u.y),c=n.yw(1),u=n.ww(-1),(n=c.findCol(u))&&(c=h=void 0,o?(h=i.b6,h-=c=h-(n.x+n.width)):(h=i.Py,c=n.x-h),0<c)&&t&&0<f.height&&0===i.qC&&Wt(e,s,h,i.T6-.5,h+c,i.T6-.5)}function ni(n,t){var i,r,e,o,u,u,r,f,s,c,a,h,v,A,h,A,A,h,n,i=n.Fi(),r=n.Dn,e=n.options.rightToLeft,o=n.options.gridline.color,u=F.I.He(0,"gc-columnHeader-normal"),u=u&&u.borderBottomColor,r=r.J(),h=n.dw(1),v=qt(n),f=i.BA,c=R(i),A=n.vw(-1),h=h.findRow(A);h&&(s=i.Cy,0<(a=h.y-s))&&(Wt(r,o,f,h.y-.5,f+c-v.width,h.y-.5),t)&&(0===v.width&&Wt(r,o,i.BA-.5,s,i.BA-.5,h.y),Wt(r,u,A=e?i.BA+i.XC-.5:i.b6-.5,s,A,h.y)),A=n.yw(1),s=i.LA,a=T(i),h=n.ww(-1),(n=A.findCol(h))&&(e?(f=i.b6,f-=c=f-(n.x+n.width)):(f=i.Py,c=n.x-f),0<c)&&(Wt(r,o,n.x-.5,s,n.x-.5,s+a-v.height),t)&&(0===v.height&&Wt(r,o,f,i.LA-.5,f+c,i.LA-.5),Wt(r,u,f,i.T6-.5,f+c,i.T6-.5))}function ti(n,t){var i=0;return n||(i|=1),t||(i|=2),i}function ii(n,t){var i=0;return i=i|(0!==n?1:0)|(0!==t?2:0)}function s(n){this.Mf=n}function ri(n,t,i,r,e){var o,u,f,s,c,a,h,a,v,A,l,a,o=n.parent,u=n.rt,f=n.options,s=t.rowViewportIndex,c=t.colViewportIndex,a=m(n),h=b;return n.Oi&&0<a.length&&(v=(a=a[a.length-1]).row,A=a.row+a.rowCount-1,l=a.col,a=a.col+a.colCount-1,o&&!o.options.allowUserResize||(-1!==v&&-1===l&&0<=s&&c<0&&f.rowHeaderVisible?!(h=u.cD(n,t,e,2,r))||"sizeRow"!==h.action&&"sizeHiddenRow"!==h.action||2!==h.sheetArea||h.index===A||(h=b):-1===v&&-1!==l&&s<0&&0<=c&&f.colHeaderVisible&&(!(h=u.dD(n,t,e,1,i))||"sizeCol"!==h.action&&"sizeHiddenCol"!==h.action||1!==h.sheetArea||h.index===a||(h=b)))),h}function ei(n,t,i,r){var e,o,u,f,u,s,c,c,c;if(0===n.selectionPolicy())return b;for(e=t.hitTestType,o=Pi(n),u=m(n),f=3,n.Oi&&0<u.length&&(-1!==(u=u[u.length-1]).row&&-1===u.col?f=2:-1!==u.col&&-1===u.row&&(f=1)),s=0;s<o.length;s++)if((c=o[s])&&(c.x-=R(c),c.y-=T(c),c.width*=3,c.height*=3,c.contains(i,r)))return I(t.row)&&(c=n.dw(1))&&0<c.length&&(t.row=c[c.length-1].row),I(t.col)&&(c=n.yw(1))&&0<c.length&&(t.col=c[c.length-1].col),{x:i,y:r,type:f,isHeader:!1,isFirstIndicator:0===s};return 1===e&&n.JA(-1,t.col)?{x:i,y:r,type:1,isHeader:!0}:2===e&&n.JA(t.row,-1)?{x:i,y:r,type:2,isHeader:!0}:b}function oi(n,t,i,r){var e,o,t,u,f,f,s,c,a,h,s,a,t,s,a,e=b,o=t.rowViewportIndex,t=t.colViewportIndex;if(!I(o)&&!I(t)){if(u=n.parent,f=n.U5(),0<=o&&0<=t&&1===n.Ut.getSelections().length){if(f=n.JS(f),s=lt(n),c=wt(n),a=dt(n)-s,h=pt(n)-c,1===t&&0<s&&f.col<a&&f.col+f.colCount>a&&(s=n.Yy(t))&&0<s.length&&i>(a=s[s.length-1]).x+R(a))return e;if(1===o&&0<c&&f.row<h&&f.row+f.rowCount>h&&(t=n._y(o))&&0<t.length&&r>(s=t[t.length-1]).y+T(s))return e}(a=xi(n))&&(e||(a.x-=R(a),a.y-=T(a),a.width*=3,a.height*=3,a.contains(i,r)&&(e={action:"drag",side:"corner"})),u&&u.options.allowUserDragFill||e&&"corner"===e.side&&(e.side=b))}return e}function ui(n,t,i,r){for(var e,o,u,f,s,c,a,h,v,s,e=!1,o=n.Ut.getSelections(),u=0,f=o.length;u<f;u++){if(s=o[u],a=(s=(c=3===r||I(r))?n.JS(s):s).row,h=s.col,v=s.rowCount,s=s.colCount,c)e=a<=t&&t<a+v&&h<=i&&i<h+s;else if(2===r)e=-1===h&&a<=t&&t<a+v;else if(1===r)e=-1===a&&h<=i&&i<h+s;else if(0===r)return e;if(e)break}return e}function fi(n,t,i,r,e){t===r&&i===e||(n.Ut.setCellState(t,i,F.CellStatesType.active,!1,F.SheetArea.viewport),n.k_&&n.k_(F.CellStatesType.active,t,i,F.SheetArea.viewport),n.Ut.setCellState(r,e,F.CellStatesType.active,!0,F.SheetArea.viewport),n.k_&&n.k_(F.CellStatesType.active,r,e,F.SheetArea.viewport))}function si(n,t,i,r){var t,t,e,o;t||(t=(t=m(n))[t.length-1],e=n.ui,o=n.ci,i?3===r?(n.ui=t.row+t.rowCount-1,n.ci=t.col+t.colCount-1):2===r?(n.ui=t.row+t.rowCount-1,n.ci=0):1===r&&(n.ui=0,n.ci=t.col+t.colCount-1):3===r?(n.ui=t.row,n.ci=t.col):2===r?(n.ui=t.row,n.ci=0):1===r&&(n.ui=0,n.ci=t.col),fi(n,e,o,n.ui,n.ci))}function ci(n,t,i,r){var t,t,e,o;t||(t=(t=m(n))[t.length-1],e=n.ui,o=n.ci,i&&(3===r?(n.ui=t.row,n.ci=t.col):2===r?(n.ui=t.row,n.ci=0):1===r&&(n.ui=0,n.ci=t.col)),fi(n,e,o,n.ui,n.ci))}function ai(n){return n.hitTestType}function hi(n,t,i){var r;return r=t.addRowColumnButtonHitInfo?n.$Ae(ai(i)):r}function vi(n,t,i){var r=hi(n,t,i);return I(r)&&(r=n.getCellType(t.row,t.col,ai(i),{rowSpacingIndex:i.rowSpacingIndex,isAfterRowSpacing:i.isAfterRowSpacing})),t.sheet||(t.sheet=n),r}function g(n){var t=this;t.jAt=!1,t.YZ=new Rn(n),t.OAt=new Zn(n),t.Mf=n}function Ai(n,t,i){var r=this;r.kZ=i,r.AZ=new tt(t),r.DZ=new Dn(t),r.xZ=new it(n,"sheet",r.AZ,100,10),r.kZ.aW(r.xZ,!0)}function x(n,t){var t,i,n,t=ht.call(this,t,F.mt.gi(n.Ti))||this;return t.jTe=F.DialogFeatureType.touch,(i=t).RAt=32,i.BAt=45,i.f$={},i.Jet=!1,i.Vv=n,n=i.Xc(),(i.LAt=n).addClass("gc-toolstrip-default ui-state-default well"),n.appendTo(i.qc()),n.hide(),i.FAt(),i.PAt(),i.aY(),t}function li(n){var n=n.WL,t=!1;return n&&n.QP().forEach(function(n){n&&n.isSelected()&&(t=!0)}),t}function wi(n,t,i){var r,e,i,r=c("span"),e=B.body;return r.className=i,r.style.font=n,r.style.cssFloat="left",r.textContent=t,e.insertBefore(r,b),i=O(r).width(),e.removeChild(r),i}function di(n,t,i,r,e){this._font="normal 12px Arial";var o=this;o.Zc=n,o._text=t,o.GAt=i,r&&(o.tT=r),e&&(o.UAt=e)}function pi(n){function t(){for(var n,t,i,n="separator",t=0,i=n+t.toString();B.getElementById(i);)i=n+(++t).toString();return i}this.Zc=t(),n&&(this.UAt=n)}function E(n){this.jS=n}function gi(n,t,i,r,e){var o=this;o.RS=n,o.HAt=i,o.zAt=t,o.VAt=r,o.YAt=e}function mi(){}function k(n){this.w2=n}function Ci(n,t,i){var r,e,n,r=this;r.AZ=new tt(r),r.xZ=new it(n,"tabStrip",r.AZ,1,-1),r.kZ=i,r.DZ=new ft(t),e=r.DZ,(n=r.xZ).RZ=function(n){return e.BZ(n)},n.LZ=function(n){return e.FZ(n)},n.PZ=function(n){return e.GZ(n)},n.UZ=function(n){return e.HZ(n)},n.ZAt=function(n){return e.WAt(n)}}function Mi(n,t,i,r){var n=n.BO();n.getState(t)?i.drawImage(n.getImage(t),r.x,r.y,R(r),T(r)):n.addImage(t)}function bi(n,t){var i,r,e,o,u,f,f,s,c,a,f,h,v,A,h,h,l,h,s,i=n.Fi(),e=16,f=m(n);n.Oi&&0<f.length&&(s=(f=f[f.length-1]).row,c=f.row+f.rowCount-1,a=f.col,f=f.col+f.colCount-1,h=n.parent,v=n.options.rightToLeft,A="AAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADs",h&&!h.options.allowUserResize||(-1!==s&&-1===a&&n.getRowResizable(c)?(h=n.C0(c),r=w+A+"MAAA7DAcdvqGQAAABaSURBVDhPY/z//z8DLsDIyAiWBKphBAtgAUxQGgPANIMAMhsdYDUAmwZchtDOC8SCgTcA5DfcgUAEoNwFo7GAPQxwJVtsYYHVBdgU4gpInF5A1oBLMwMDAwMApuAtD6Z7YxQAAAAASUVORK5CYII=",h=T(o=n.getCellRect(c,dt(n,2)-1,h,-1)),l=v?i.BA:i.b6-16,ki(n,c,f,o.x,o.y+h,{rowCheck:!0})&&(u=new F.Rect(l,o.y+h-8,16,16))):-1===s&&-1!==a&&n.getColumnResizable(f)&&(h=n.S0(f),r=w+A+"IAAA7CARUoSoAAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAE1JREFUOE/ljtEKACAIA/v/nzZ9mFhsJPRocLEuGS4zk/iJyyP/D6gE0wrYoCqoLoUafPl8fEBln3ulSscfErk65TMjMFRBhUowosDWBoHpba8+C7w0"+dn,s=R(o=n.getCellRect(pt(n,1)-1,f,-1,h)),l=v?o.x-8:o.x+s-8,ki(n,c,f,o.x+s,o.y,{colCheck:!0}))&&(u=new F.Rect(l,i.T6-16,16,16)),r&&u&&Mi(n,r,t,u)))}function xi(n){var t,i,r,i,r,e,o,t=b,i=m(n),r=i.length;return n.Oi&&0<r&&(i=i[r-1],r=n.j1(i),t=new F.Rect(r.x+R(r)-(e=17),r.y+T(r),17,o=20)),t}function Ei(n,t,i){var t,i,t,n,i,r,e,o,t=n.C0(t),i=n.S0(i),t=n.dw(t),n=n.yw(i),i=0,r=0,e=0,o=0;return 0<t.length&&(i=t[0].row,r=t[t.length-1].row),0<n.length&&(e=n[0].col,o=n[n.length-1].col),(0,F.Ec)(i,e,r-i+1,o-e+1)}function ki(n,t,i,r,e,o){var u,f,s,u,f,n,t,u=n.C0(t),f=n.S0(i),s,u=n.Fi().c9(u,f),f=Ei(n,t,i),n=f.row<=t&&t<=f.row+f.rowCount-1&&u.y<=e&&e<=u.y+T(u),t=f.col<=i&&i<=f.col+f.colCount-1&&u.x<=r&&r<=u.x+R(u);return o&&o.colCheck?t:(o&&o.rowCheck||t)&&n}function Pi(n){var t,i,t,r,e,o,u,f,s,c,a,h,v,A,l,A,w,l,A,l,v,t,d,o,p,g,t=m(n),i=[];if(n.Oi&&0<t.length)for(t=t[t.length-1],r=n.j1(t),e=8,o=n.Fi(),u=t.row,f=t.row+t.rowCount-1,s=t.col,c=t.col+t.colCount-1,-1!==t.row&&-1!==t.col?(ki(n,u,s,r.x,r.y)&&(i[0]=new F.Rect(r.x-8,r.y-8,16,16)),ki(n,f,c,r.x+R(r),r.y+T(r))&&(i[1]=new F.Rect(r.x+R(r)-8,r.y+T(r)-8,16,16))):-1!==t.row?(a=o.c9(1,0),h=o.c9(1,1),v=a.x+(R(a)+R(h))/2-8,A=dt(n)-1-lt(n),(A=(l=n.yw(1)).findCol(A))&&(l=(w=n.yw(0))[0]||l[0])&&(v=l.x+(A.x+R(A)-l.x)/2-8),ki(n,u,s,v+8,r.y,{rowCheck:!0})&&(i[0]=new F.Rect(v,r.y-8,16,16)),ki(n,f,c,v+8,r.y+T(r),{rowCheck:!0})&&(i[1]=new F.Rect(v,r.y+T(r)-8,16,16))):-1!==t.col&&(a=o.c9(0,1),h=o.c9(1,1),A=a.y+(T(a)+T(h))/2-8,l=pt(n)-1-wt(n),(t=(v=n.dw(1)).findRow(l))&&(o=(d=n.dw(0))[0]||v[0])&&(A=o.y+(t.y+T(t)-o.y)/2-8),ki(n,u,s,r.x,A+8,{colCheck:!0})&&(i[0]=new F.Rect(r.x-8,A,16,16)),ki(n,f,c,r.x+R(r),A+8,{colCheck:!0}))&&(i[1]=new F.Rect(r.x+R(r)-8,A,16,16)),p=void 0,g=i.length-1;0<=g;g--)(!(p=i[g])||p.x<0||p.y<0)&&(i[g]=b);return i}function yi(n,t,i){var r,e,o,u;if((0,F.needPaintSelection)(n)&&!n.isEditing()&&t&&0!==n.selectionPolicy()&&(o=void 0,0<(e=(r=Pi(n)).length))){for(i.save(),i.fillStyle=n.aR()||"white",i.strokeStyle=n.getSelectionBorderColor(),u=0;u<e;u++)(o=r[u])&&(i.beginPath(),i.arc(o.x+R(o)/2,o.y+T(o)/2,R(o)/2,0,2*Math.PI,!1),i.fill(),i.stroke());i.restore()}}function Fi(n,t){var i,r,i=xi(n);i&&Mi(n,r=w+"EAAAATCAIAAAD5x3GmAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAGhJREFUOE / djkEOwCAIBHk6P98u1lKo1diEU + dggOyAAkC + YPl / Onx3WDmiytm4aulQoKba + 4uiO77YhHDH5SqnRa0If / Nhq0fnjPob2h5oVXJI0rJA3h1ya1kgU4f4nQfVzozk7APgAIEqATZbalz1"+dn,t,i)}Y=this&&this.__extends||(at=function(n,t){return(at=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}at(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.QAt=n.NZ=n.IZ=n.TouchToolStripSeparator=n.TouchToolStripItem=n.TouchToolStrip=n.TouchEventHandler=n.ZZ=n.ManipulationStartingEventArgs=n.ManipulationStartedEventArgs=n.ManipulationDeltaEventArgs=n.ManipulationCompletedEventArgs=n.QZ=n.TouchEventProvider=n.SR=void 0,S=y("Common"),F=y("Core"),y=y("./dist/plugins/touch/touch.res.en.js"),n.SR={en:y},I=S.Common.lt.ht,y=F.zc,_=(O=F.GC$).extend,Z=O.isEmptyObject,c=F.mt.En,a=F.mt.vi,D=F.mt.Tt.mozilla,Q=F.I.fl,L=F.mt.pi(),G=L.ipad,r=G||L.iphone,b=null,p=void 0,H=Math.abs,N=Math.min,z=Math.max,J=Math.pow,K=Math.atan2,o=Math.PI,X=Math.round,V=Math.sqrt,W=Math.atan,q=Math.log,$=Math.floor,nn=100,h="touch",tn="none",rn="MSPointerDown",en="MSPointerMove",on="MSPointerUp",un="pointerdown",fn="pointermove",sn="pointerup",cn="touchstart",an="touchmove",hn="touchend",v="MSPOINTER_TYPE_TOUCH",u=isNaN,vn=parseInt,An=parseFloat,ln=window,B=document,wn=ln.gcGlobal,w="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB",dn="AAAAAElFTkSuQmCC",j=1,F.Of.touch=!0,L=new S.Common.ResourceManager(n.SR,"Touch"),f=L.getResource.bind(L),pn=400,gn=1e3,mn=20,t.prototype.KAt=function(n){this.QTt.KAt=n},t.prototype.JAt=function(n){this.QTt.JAt=n},t.prototype.XAt=function(t){var i=this;i.QTt.XAt=function(n){var n;t&&(t(n),n=i.AZ)&&n.qAt()}},t.prototype.$At=function(n){this.QTt.$At=n},t.prototype.tIt=function(n){this.QTt.tIt=n},t.prototype.nIt=function(n){this.KTt.nIt=n},t.prototype.eIt=function(n){this.KTt.eIt=n},t.prototype.iIt=function(n){this.KTt.iIt=n},t.prototype.rIt=function(n){this.oIt=n},t.prototype.aIt=function(n){this.uIt=n},t.prototype.sIt=function(n,t){var t=(t||this.cIt).RS;return F.mt.T0(n,t)},t.prototype.fIt=function(n,t){var i,r,e,o,u,r,f,r,s,n,e,i=this,r=t.pointerType,e=t.target,o=t.offsetX,u=t.offsetY;r!==t[v]&&r!==h||(f=(r=i.sIt(e,n)).I0,r=r.A0,(s=i.lIt(n,e,t.pointerId,new M(o+f,u+r),t.timeStamp))&&a(t),"sheet"===i.cIt.zAt&&(n=t.pageX-(o+f),e=t.pageY-(u+r),i.cIt.RS.canvasOffset={top:e,left:n}))},t.prototype.hIt=function(n){var t,i,r,i,e,t=this,i=n.pointerType,r=n.pointerId;if(i===n[v]||i===h){if(t.WTt[r]===p)return!1;i=t.sIt(n.target),(e=t.iE(r,new M(n.offsetX+i.I0,n.offsetY+i.A0),n.timeStamp))&&a(n)}},t.prototype.dIt=function(n){var t,i,r,i,e,t=this,i=n.pointerType,r=n.pointerId;if(i===n[v]||i===h){if(t.WTt[r]===p)return!1;i=t.sIt(n.target),(e=t._up(r,new M(n.offsetX+i.I0,n.offsetY+i.A0)))&&a(n)}},t.prototype.mIt=function(n){var t,i,r,i,e,t=this,i=n.pointerType,r=n.pointerId;if(i===n[v]||i===h){if(t.WTt[r]===p)return!1;i=t.sIt(n.target),(e=t.gIt(r,new M(n.offsetX+i.I0,n.offsetY+i.A0)))&&a(n)}},t.prototype.pIt=function(n,t){for(var i,r,e,o,u,f,i=gt(n.RS),r=t.changedTouches,e=!1,o=0;o<r.length;o++)u=r[o],f=D?l():t.timeStamp,e=this.lIt(n,t.target,u.identifier,new M(u.pageX-i.I0,u.pageY-i.A0),f)||e;e&&a(t)},t.prototype.bIt=function(n){for(var t,i,r,e,o,u,f,t=this,i=gt(t.cIt.RS),r=n.changedTouches,e=!1,o=0;o<r.length;o++)u=r[o],f=D?l():n.timeStamp,e=t.iE(u.identifier,new M(u.pageX-i.I0,u.pageY-i.A0),f)||e;e&&a(n)},t.prototype.yIt=function(n){for(var t,i,r,e,o,u,t=this,i=gt(t.cIt.RS),r=n.changedTouches,e=!1,o=0;o<r.length;o++)u=r[o],e=t._up(u.identifier,new M(u.pageX-i.I0,u.pageY-i.A0))||e;e&&a(n)},t.prototype.wIt=function(n){for(var t,i,r,e,o,u,t=this,i=gt(t.cIt.RS),r=n.changedTouches,e=!1,o=0;o<r.length;o++)u=r[o],e=t.gIt(u.identifier,new M(u.pageX-i.I0,u.pageY-i.A0))||e;e&&a(n)},t.prototype.MIt=function(n){var t,i,t,i,t,t=this,i=t.cIt,t=t.CIt;i!==t&&(i=O(i.RS).offset(),t=O(t.RS).offset(),n.X+=i.left-t.left,n.Y+=i.top-t.top)},t.prototype.SIt=function(n,t){var i,r,e,o,u,f,s,i=this,r=i.j0t;for(i.CIt=b,i.AZ=b,o=0;o<r.length;o++)if(r[o]===n){if(u=r[o],s=f=b,u._Z&&!u._Z()){for(o=0;o<r.length;o++)if((e=r[o])!==u&&0<=e.YAt&&e.YAt<u.YAt&&(!e._Z||e._Z())){f=e;break}if(f===b)return!1}if(u.EZ&&!u.EZ()){for(o=0;o<r.length;o++)if((e=r[o])!==u&&0<=e.YAt&&e.YAt<u.YAt&&(!e.EZ||e.EZ())){s=e;break}if(s===b)return!1}f===b&&(f=u),s===b&&(s=u),i.cIt=u,i.CIt=f,i.TIt=s,i.KAt(s.jZ||b),i.JAt(f.RZ||b),i.tIt(f.LZ||b),i.$At(f.AIt||b),i.XAt(f.PZ||b),i.nIt(s.UZ||b),i.eIt(s.ZAt||b),i.iIt(s.IIt||b),i.rIt(f.oIt||b),i.aIt(f.uIt||b),f.HAt&&(i.AZ=u.HAt);break}return!0},t.prototype.lIt=function(n,t,i,r,e){var o=this;if(o.WTt[i]!==p)return!1;if(0===o.WTt.length&&!o.SIt(n,t))return!1;if(!o.CIt)return!1;if(!(o.WTt.length>=o.CIt.VAt)){if(o.AZ&&o.AZ.xIt())return!1;o.MIt(r),o.AZ&&0===o.WTt.length&&o.AZ.NIt(),o.WTt[i]={id:i,time:l(),position:r},o.WTt.length++,o.QTt.kIt(t,i,r,e),o.QTt.DIt(i,r,o.WTt.length,e),1===o.WTt.length&&o.KTt.DIt(r),1===o.WTt.length&&o.oIt&&o.oIt({JZ:r})}return!0},t.prototype.iE=function(n,t,i){var r=this;return r.WTt[n]!==p&&!(r.AZ&&r.AZ._It()||(r.MIt(t),r.WTt[n]={id:n,time:l(),position:t},r.QTt.EIt(n,t,i),0))},t.prototype._up=function(n,t){var i=this;return i.WTt[n]!==p&&(delete i.WTt[n],i.WTt.length--,!(i.AZ&&i.AZ.jIt()||(i.MIt(t),i.QTt.OIt(n),i.QTt.RIt(),0===i.WTt.length&&(i.KTt.OIt(t),i.KTt.RIt()),0===i.WTt.length&&i.uIt&&i.uIt({JZ:t}),i.AZ&&0===i.WTt.length&&0===i.QTt._process&&i.AZ.qAt(),0)))},t.prototype.gIt=function(n,t){return this._up(n,t)},t.prototype.aW=function(t,n){var i,r,e,o,u,f,s,c,a,h,v,A,l,r,w,d,e,p,g,m,C,M;function b(){O(B).bind(u,k).bind(f,P).bind(h,k).bind(v,P).bind(s,y).bind(c,y).bind(A,y).bind(l,y)}function x(){O(B).unbind(u).unbind(h).unbind(f).unbind(v).unbind(s).unbind(l).unbind(c).unbind(A)}function E(n){b(),i.fIt(t,n)}function k(n){i.hIt(n)}function P(n){i.dIt(n),0===i.WTt.length&&x()}function y(n){i.mIt(n),0===i.WTt.length&&x()}i=this,r="."+t.zAt,o=rn+(e=".gcSheet"),u=en+e+r,f=on+e+r,s="MSPointerCancel"+e+r,c="MSLostPointerCapture"+e+r,a=un+e,h=fn+e+r,v=sn+e+r,A="LostPointerCapture"+e+r,l="pointercancel"+e+r,r=cn+e,w=an+e,d=hn+e,e="touchcancel"+e,p=t.RS,g=i.j0t,0<=(m=S.Common.Uf.hD(g,t))&&n||m<0&&!n||(C=F.mt.m0(),n?C?(M=p.style,I(M.msTouchAction)||(M.msTouchAction=tn),I(M.touchAction)||(M.touchAction=tn),O(p).bind(o,E).bind(a,E)):(O(p).bind(r,function(n){i.pIt(t,n)}),O(p).bind(w,function(n){i.bIt(n)}).bind(d,function(n){i.yIt(n)}).bind(e,function(n){i.wIt(n)})):C?O(p).unbind(o).unbind(a):O(p).unbind(r).unbind(w).unbind(d).unbind(e),n?g.push(t):g.splice(m,1))},t.prototype.L0=function(){for(var n,t,i,n=this,t=n.j0t,i=t.length-1;0<=i;i--)n.aW(t[i],!1)},Cn=t,n.TouchEventProvider=Cn,i.prototype.kIt=function(n,t,i,r){var e,n,e=this;3===e._process&&e.BIt(!0),e.jAt=2===e._process&&1===e.oAt.LIt(),e.FIt=n,(n={})._ID=t,n.PIt=i,n.GIt=i,e.oAt.UIt(n),e.HIt=r,1<e.oAt.LIt()&&(e.zIt=!1,e.VIt=!1,1===e._process)&&e.YIt()},i.prototype.DIt=function(n,t,i,r){0===this._process&&1===i&&this.ZIt(this.oAt.WIt(0).GIt)},i.prototype.EIt=function(n,t,i){var r,e,e,o,e,u,f,s,r=this;if(0!==r.rAt&&r.oAt.QIt(n)){if(1===r._process&&1===r.oAt.LIt()){if(e=r.KIt(),!r.JIt(1)&&!r.JIt(2)&&!e)return;if(At(t,e=r.oAt.XIt(n).GIt))return;o=H(t.X-e.X),e=H(t.Y-e.Y),r.qIt(o,e)}if(!(i-r.HIt<20)){if(r.oAt.XIt(n).$It=t,1<(u=r.oAt.LIt()))for(f=0;f<u;f++)if(!(s=r.oAt.WIt(f)).$It)return;for(r.txt(i),r.HIt=i,u=r.oAt.LIt(),f=0;f<u;f++)(s=r.oAt.WIt(f)).PIt=s.$It,s.$It=b}}},i.prototype.RIt=function(){var n=this;n.nxt&&(n.ixt(n.nxt),n.nxt=b)},i.prototype.OIt=function(n){var t=this;t.oAt.QIt(n)&&(t.oAt.rxt(n),2===t._process?0===t.oAt.LIt()&&(t.JIt(64)||t.JIt(256)||t.JIt(128)?t.oxt():t.BIt(!0)):3===t._process?t.BIt(!0):1===t._process&&t.BIt(!1))},i.prototype.txt=function(n){var t,i,r,e,o,u,f,f,e,s,c,n,s,e,t=this,f=t.axt(),i=f.uxt,r=f.sxt,f=f.u_,e=t.cxt(),u=e.L0t,o=e.fxt,e=e.hAt;t.qTt+=i,t.$Tt+=r,t.tAt*=o,t.nAt+=u,t.eAt+=e,(s={}).hAt=e,s.L0t=u,s.lxt=n-t.HIt,s.uxt=i,s.sxt=r,t.uAt.hxt(s),t.dxt=f,1!==t._process&&2!==t._process||1===t._process&&(c=t.YIt())||((n=new Fn).CAt=e,n.MAt=u,n.tW=o,n.wAt=new M(i,r),s=new En(t.uAt),e=new Yn(t.FIt,t.vxt(),n,!1,f,s),t.mxt(e),e.gxt&&t.BIt(!0))},i.prototype.YIt=function(){var n,t,n=this;return n._process=2,t=new Hn(n.FIt,n.oAt.LIt(),n.vxt(),n.oAt.WIt(0).GIt),n.pxt(t),!!t.gxt&&(n.BIt(!0),!0)},i.prototype.qIt=function(n,t){var n=xt(n,t);this.zIt=n.JTt,this.VIt=n.XTt},i.prototype.axt=function(){var n,t,i,r,i,e,n=0,t=0,i=this.bxt(),r=i.yxt,i=i.wxt,e=new M(r.X,r.Y);return{uxt:n=r.X-i.X,sxt:t=r.Y-i.Y,u_:e}},i.prototype.cxt=function(){var n,t,i,r,n,n=this,t=0,i=1,r=0;return n.JIt(16)&&1===n.oAt.LIt()&&n.KIt()&&(t=Mt(n.oAt.WIt(0).$It,n.oAt.WIt(0).PIt,n.fMt)),1<n.oAt.LIt()&&(t=(n=n.Mxt()).L0t,i=n.fxt,r=n.hAt),{L0t:t=t/o*180,fxt:i,hAt:r}},i.prototype.Mxt=function(){for(var n,t,i,r,e,o,u,t,f,s,c,a,h,v,A,l,w,l,d,p,g,m,l,w,C,n=this,t=n.bxt(),i=t.yxt,r=t.wxt,e=n.KIt(),o=e?n.fMt._Center:new M(0,0),u=0,t=1,f=0,s=0,c=0,a=0,h=0,v=n.oAt.LIt(),A=0;A<v;A++)w=(l=n.oAt.WIt(A)).$It,l=l.PIt,d=Ct(w,i),p=Ct(l,r),g=e?new M(l.X-o.X,l.Y-o.Y):new M(l.X-r.X,l.Y-r.Y),m=e?new M(w.X-o.X,w.Y-o.Y):new M(w.X-i.X,w.Y-i.Y),l=Ct(l,o),w=Ct(w,o),p>=n.aAt&&d>=n.aAt&&(c++,a+=d,h+=p,!e||l>=n.aAt)&&w>=n.aAt&&(u+=C=mt(g,m),s++);return 0<s&&n.JIt(16)?u/=s:u=0,0<c&&n.JIt(32)?(n.jAt||(t=a/h),f=(a-h)/c,n.Cxt=a/c):n.Cxt=0,{L0t:u,fxt:t,hAt:f}},i.prototype.JIt=function(n){return 0!=(this.rAt&n)},i.prototype.bxt=function(){for(var n,t,i,r,e,o,u,f,s,f,c,a,n=0,t=0,i=0,r=0,e=this.oAt,o=e.LIt(),u=0;u<o;u++)s=(f=e.WIt(u)).PIt,f=f.$It,n+=s.X,t+=s.Y,i+=f.X,r+=f.Y;return c=new M(n/o,t/o),{yxt:a=new M(i/o,r/o),wxt:c}},i.prototype.KIt=function(){var n=this.fMt;return n&&!u(n._Radius)},i.prototype.ZIt=function(n){var t,n,t=this,n=new Nn(t.FIt,t.rAt,b,n);return n.KZ=511,t.Sxt(n),t.Txt=n.KZ,0===n.KZ?(t.BIt(!1),!1):(t.rAt=n.KZ,t.fMt=n.DAt,t._process=1,!0)},i.prototype.BIt=function(n){var t,i,n,t=this,i=3===t._process;t._process=0,t.Axt&&(vt(t.Axt),t.Axt=b),n&&(n=new Bn(t.FIt,t.vxt(),i,Pt(t.dxt),new En(t.uAt)),3===t._process?t.nxt=n:t.ixt(n)),t.uAt.Ixt(),t.oAt.Ixt(),t.fMt=b,t.qTt=0,t.$Tt=0,t.tAt=1,t.nAt=0,t.eAt=0,t.zIt=!1,t.VIt=!1,t.rAt=0},i.prototype.oxt=function(){var n,t,i,i,i,n=this,t={},i=new En(n.uAt);t.xxt=n.JIt(64)?i.Nxt().X:0,t.kxt=n.JIt(64)?i.Nxt().Y:0,t.Dxt=n.JIt(256)?i.CAt():0,t._xt=n.JIt(128)?i.Ext():0,0===t.xxt&&0===t.kxt&&0===t.Dxt&&0===t._xt?n.BIt(!0):(t.jxt=new yn(t.xxt,t.kxt),t.IAt=new kn(t.Dxt),t.xAt=new Pn(t._xt),i=new En(b,t.xxt,t.kxt,t._xt,t.Dxt),i=new Sn(n.FIt,n.vxt(),new Fn,i,t.IAt,t.xAt,t.jxt),n.Oxt(i),t.jxt=i.NAt,t.IAt=i.IAt,t.xAt=i.xAt,t.jxt.pAt<=0&&t.jxt.bAt<=0&&t.jxt.Rxt(.003),t.IAt.Bxt()<=0&&t.IAt.Rxt(.002),t.xAt.Bxt()<=0&&t.xAt.Rxt(.003),i=l(),t.Lxt=i,t.Fxt=i,t.Pxt=0,t.Gxt=0,n._process=3,n.Axt=ln.setInterval(function(){try{n.Uxt(t)}catch(n){}},20))},i.prototype.Uxt=function(n){var t,i,r,e,o,u,f,i,e,o,u,r,f,s,e,o,t=this,i=l(),r=i-n.Fxt;if(0!=r){if(e=n.xxt,o=n.kxt,u=n.Dxt,f=n._xt,n.xxt=t.Hxt(r,n.jxt.pAt,n.xxt),n.kxt=t.Hxt(r,n.jxt.bAt,n.kxt),n.Dxt=t.Hxt(r,n.IAt.Bxt(),n.Dxt),n._xt=t.Hxt(r,n.xAt.Bxt(),n._xt),e=(e+n.xxt)/2,o=(o+n.kxt)/2,u=(u+n.Dxt)/2,f=(f+n._xt)/2,n.Fxt=i,i=!1,bt(e)&&bt(o)&&bt(u)&&bt(f)&&(i=!0),e=r*e,o=r*o,u=r*u,r=r*f,f=1,0<t.Cxt&&(t.Cxt+2*u<0&&(u=-t.Cxt/2+1),0!==t.Cxt)&&(f=(t.Cxt+2*u)/t.Cxt),t.eAt+=u,t.nAt+=r,t.qTt+=e,t.$Tt+=o,t.tAt*=f,t.Cxt+=u,t.dxt=new M(t.dxt.X+e,t.dxt.Y+o),n.Pxt+=e,n.Gxt+=o,i){if(e=X(n.Pxt),o=X(n.Gxt),bt(e)&&bt(o))return void t.BIt(!0)}else 1<=H(n.Pxt)&&(e=n.Pxt,n.Pxt-=e),1<=H(n.Gxt)&&(o=n.Gxt,n.Gxt-=o);(s=new Fn).wAt=new M(e,o),s.tW=f,s.CAt=u,s.MAt=r,e=new En(b,n.xxt,n.kxt,n._xt,n.Dxt),o=new Yn(t.FIt,t.vxt(),s,!0,Pt(t.dxt),e),t.mxt(o),(o.gxt||i)&&t.BIt(!0)}},i.prototype.Hxt=function(n,t,i){var t,t;return bt(i)||(t=i<0?i+t*n:i-t*n)<0&&0<i||0<t&&i<0?0:t},i.prototype.vxt=function(){var n,t,n=this,t=new Fn;return t.CAt=n.eAt,t.MAt=n.nAt,t.tW=n.tAt,t.wAt=new M(n.qTt,n.$Tt),t},i.prototype.zxt=function(n,t,i,r){var e,o,u,f,s,c,a,h,v,v,e=this,o=new Fn,u=new Fn,f=0,s=0,c=0,a=0,h=e.JIt(4)&&e.zIt,v=e.JIt(8)&&e.VIt;return!e.JIt(1)||v||n&&!e.JIt(64)||(o.wAt.X=t.wAt.X,u.wAt.X=i.wAt.X,f=r.Nxt().X),!e.JIt(2)||h||n&&!e.JIt(64)||(o.wAt.Y=t.wAt.Y,u.wAt.Y=i.wAt.Y,s=r.Nxt().Y),!e.JIt(32)||n&&!e.JIt(256)?(o.tW=t.tW,u.tW=1):(o.tW=t.tW,o.CAt=t.CAt,u.tW=i.tW,u.CAt=i.CAt,a=r.CAt()),!e.JIt(16)||n&&!e.JIt(128)||(o.MAt=t.MAt,u.MAt=i.MAt,c=r.Ext()),v=new En(b,f,s,c,a),new On(o,u,v)},i.prototype.Sxt=function(n){this.KAt&&n&&this.KAt(n)},i.prototype.pxt=function(n){this.JAt&&n&&this.JAt(n)},i.prototype.ixt=function(n){var t,i,t=this;t.XAt&&n&&(i=t.zxt(!1,n.nW,n.nW,n.TAt),n.nW=i.nW,n.TAt=i.TAt,t.XAt(n))},i.prototype.Oxt=function(n){var t,i,t=this;t.$At&&n&&(i=t.zxt(!1,n.nW,n.SAt,n.TAt),n.nW=i.nW,n.SAt=i.SAt,n.TAt=i.TAt,t.$At(n))},i.prototype.mxt=function(n){var t,i,t=this;t.tIt&&n&&(i=t.zxt(n.AAt,n.nW,n.SAt,n.TAt),n.nW=i.nW,n.SAt=i.SAt,n.TAt=i.TAt,t.tIt(n))},Mn=i,Et.prototype.DIt=function(n){var t,i,t=this;t.Vxt++,1<t.Vxt||(i=l(),t.Yxt&&At(n,t.Yxt)&&i-t.Zxt<pn?t.DU++:(t.Yxt=n,t.DU=1),t.Wxt=n,t.Zxt=i)},Et.prototype.RIt=function(){var n=this;n.nxt&&(n.nxt instanceof jn?n.Qxt(n.nxt):n.nxt instanceof Un&&n.Kxt(n.nxt),n.nxt=b)},Et.prototype.OIt=function(n){var t,i,t=this;t.Vxt--,0<t.Vxt||(i=l(),At(n,t.Wxt)?i-t.Zxt>gn?t.nxt=new Un(t.Wxt):1<t.DU?(t.DU=0,t.Jxt(new Tn(t.Yxt)),t.Yxt=b):t.nxt=new jn(t.Wxt):t.Yxt=b)},Et.prototype.Xxt=function(){this.Yxt=b},Et.prototype.Qxt=function(n){this.nIt&&n&&this.nIt(n)},Et.prototype.Jxt=function(n){this.eIt&&n&&this.eIt(n)},Et.prototype.Kxt=function(n){this.iIt&&n&&this.iIt(n)},bn=Et,M=kt,n.QZ=M,e.prototype.qxt=function(n){var t,i,r,e,o,u,o,t=this;if(0===t.DU)return 0;for(i=0,r=(1+t.DU)*t.DU/2,e=t.DU-1;0<=e;e--)o=0,u=t.$xt(e),0===n?o=u.uxt:1===n?o=u.sxt:2===n?o=u.hAt:3===n&&(o=u.L0t),o=t.tNt(o,u.lxt),i+=o*=e+1;return i/r},e.prototype.tNt=function(n,t){return n/t},e.prototype.$xt=function(n){return this.cAt[this.nNt(n)]},e.prototype.eNt=function(){return this.cAt[this.DU-1]},e.prototype.hxt=function(n){var t,i,r,t=this;for(10===t.DU&&t.iNt(),t.DU++,t.cAt[t.nNt(t.DU-1)]=n,i=20*t.sAt,r=0;r<t.DU;r++)n.lxt-t.cAt[r].lxt>i&&(t.iNt(),r--)},e.prototype.iNt=function(){var n=this;n.ak++,n.ak===n.sAt&&(n.ak=0),n.DU--},e.prototype.Ixt=function(){this.DU=0},e.prototype.nNt=function(n){return(this.ak+n)%this.sAt},xn=e,yt.prototype.Nxt=function(){var n=this;return n.fAt||(n.fAt=new M(n.cAt.qxt(0),n.cAt.qxt(1))),n.fAt},yt.prototype.Ext=function(){var n=this;return I(n.lAt)&&(n.lAt=n.cAt.qxt(3)),n.lAt},yt.prototype.CAt=function(){var n=this;return I(n.hAt)&&(n.hAt=n.cAt.qxt(2)),n.hAt},En=yt,Ft.prototype.Bxt=function(){var n=this,t=n._DesiredExpansion,i=n._DesiredDeceleration,r=n.dAt;return u(t)||0===t?u(i)?n.vAt:i:.5*r*r/t},Ft.prototype.Rxt=function(n){this.vAt=n},kn=Ft,It.prototype.Bxt=function(){var n=this,t=n._DesiredRotation,i=n._DesiredDeceleration,r=n.dAt;return u(t)||0===t?u(i)?n.vAt:i:.5*r*r/t},It.prototype.Rxt=function(n){this.vAt=n},Pn=It,Ot.prototype.rNt=function(){var n=this,t=n._DesiredDisplacement,i=n.yAt,r=n.mAt,e=n.gAt,o=n.Bxt();u(t)||0===t?u(o)||0===o?(n.pAt=0,n.bAt=0):(n.pAt=o*H(r)/i,n.bAt=o*H(e)/i):(n.pAt=.5*i*H(r)/t,n.bAt=.5*i*H(e)/t)},Ot.prototype.Bxt=function(){var n=this,t=n._DesiredDeceleration;return u(t)&&u(n._DesiredDisplacement)?n.vAt:t},Ot.prototype.Rxt=function(n){this.vAt=n,this.rNt()},yn=Ot,Fn=Bt,Yt.prototype.QIt=function(n){for(var t,i,r,t=this.wY,i=0;i<t.length;i++)if((r=t[i])._ID===n)return!0;return!1},Yt.prototype.UIt=function(n){this.wY.push(n)},Yt.prototype.rxt=function(n){for(var t,i,t=this.wY,i=0;i<t.length;i++)if(t[i]._ID===n){t.splice(i,1);break}},Yt.prototype.LIt=function(){return this.wY.length},Yt.prototype.WIt=function(n){return this.wY[n]},Yt.prototype.XIt=function(n){for(var t,i,r,t=this.wY,i=0;i<t.length;i++)if((r=t[i])._ID===n)return r;return b},Yt.prototype.Ixt=function(){var n=this.wY;n.splice(0,n.length)},In=Yt,On=St,Bn=Ht,n.ManipulationCompletedEventArgs=Bn,Yn=Nt,n.ManipulationDeltaEventArgs=Yn,Sn=jt,Hn=Ut,n.ManipulationStartedEventArgs=Hn,Nn=Tt,n.ManipulationStartingEventArgs=Nn,jn=Rt,Un=_t,Tn=Zt,Qt.prototype.oNt=function(n,t){var i=this.fg;return i?n===F.Bf.Xl(i)&&t===F.Bf.ql(i)||F.Bf.$l(i,n,t):(i=c("canvas"),F.Bf.Wl(i,b,this.Mf),F.Bf.$l(i,n,t)),i},Qt.prototype.aNt=function(n,t,i,r){var e,o,u,o,u,f,s,e=this,o=F.Bf.Xl(n),u=F.Bf.ql(n),o=e.oNt(o,u),u=o.getContext("2d"),f=F.Bf.Kl(o),s=F.Bf.Jl(o);F.Lf.Vl(u,1,1),u.drawImage(n,0,0,R(o),T(o),0,0,R(o),T(o)),F.Lf.Vl(u,f,s),e.fg=o,e.uNt=t,e.sNt=i,e.cNt=r},Qt.prototype.fNt=function(n,t,i){var r,e,o,u,f,s,c,i,a,e,h,a,c,v,A,l,w,d,p,g,m,t,C,M,n,r,i,a,r=this,e=r.Mf,h=e.options.rightToLeft,a=F.Bf.Xl(n),c=F.Bf.ql(n),v=lt(e),A=wt(e),l=0<v?1:0,w=0<A?1:0,d=r.sNt,p=qt(e),g=r.uNt,m=e.Fi(),t=t/r.cNt,C=n.getContext("2d"),M=F.Bf.Kl(n),n=F.Bf.Jl(n),r=r.fg;C.save(),C.fillStyle=i,C.fillRect(0,0,a,c),i=e.rowOutlines,a=e.columnOutlines,i&&i._e(e,C,b,!0),a&&a._e(e,C,b,!1),e=(a=(i=(c=h?(o=g.Hy+g.zy,u=d.y+T(d),f=d.x-o-l,s=g.Ay-u-w,p.x-f*t):(o=d.x+R(d),u=d.y+T(d),f=g.Hy-o-l,s=g.Ay-u-w,p.x+R(p)),p.y+T(p)),f*t),s*t),o*=M,u*=n,f*=M,s*=n,c*=M,i*=n,a*=M,e*=n,F.Lf.Vl(C,1,1),C.drawImage(r,o,u,f,s,c,i,a,e),0<v&&(o=g.Hy-l,u=d.y+T(d),f=g.zy+l,s=g.Ay-u-w,c=m.Hy-l,i=p.y+T(p),a=m.zy+l,e=s*t,C.drawImage(r,o*=M,u*=n,f*=M,s*=n,c*=M,i*=n,a*=M,e*=n)),0<A&&(e=(a=(i=(c=h?(o=g.Hy+g.zy,u=g.Ay-w,f=d.x-o-l,s=g.Iy+w,p.x-f*t):(o=d.x+R(d),u=g.Ay-w,f=g.Hy-o-l,s=g.Iy+w,p.x+R(p)),m.Ay-w),f*t),m.Iy+w),C.drawImage(r,o*=M,u*=n,f*=M,s*=n,c*=M,i*=n,a*=M,e*=n)),0<v&&0<A&&(o=g.Hy-l,u=g.Ay-w,f=g.zy+l,s=g.Iy+w,c=m.Hy-l,i=m.Ay-w,a=m.zy+l,e=m.Iy+w,C.drawImage(r,o*=M,u*=n,f*=M,s*=n,c*=M,i*=n,a*=M,e*=n)),F.Lf.Vl(C,M,n),C.restore()},Qt.prototype.$Z=function(){var n,t,i,r,n=this,t=n.Mf,i=t.zoom(),r=t.Dn._7();r&&n.aNt(r.canvas,t.Fi(),qt(t),i)},Qt.prototype.iW=function(n){var t,i,n,r,e,o,o,e,t=this,i=t.Mf;i.endEdit()&&(n=Dt(n,t.cNt),r=i.zoom(),e=i.name(),r!==n)&&(i.ki(F.Events.ViewZooming,o={sheet:i,sheetName:e,oldZoomFactor:r,newZoomFactor:n,cancel:!1}),!0!==o.cancel)&&(i.g8(n=o.newZoomFactor),i.ki(F.Events.UserZooming,{sheet:i,sheetName:e,oldZoomFactor:r,newZoomFactor:n}),i.ki(F.Events.ViewZoomed,{sheet:i,sheetName:e,oldZoomFactor:r,newZoomFactor:n}),i.invalidateLayout(),(e=(o=i.Dn).J())&&t.fNt(e.canvas,n,o.R7(!1)),i.oht&&i.oht(b,n),i.CW)&&i.CW(b)},Qt.prototype.rW=function(n){var t,i,r,n,t,e,t=this,i=t.Mf,r=i.name(),n=Dt(n,t.cNt),t=i.zoom();if(n!==t){if(i.ki(F.Events.ViewZooming,e={sheet:i,sheetName:r,oldZoomFactor:t,newZoomFactor:n,cancel:!1}),!0===e.cancel)return;i.g8(n=e.newZoomFactor),i.ki(F.Events.UserZooming,{sheet:i,sheetName:r,oldZoomFactor:t,newZoomFactor:n}),i.ki(F.Events.ViewZoomed,{sheet:i,sheetName:r,oldZoomFactor:t,newZoomFactor:n})}i.Zw=!0,i.Ww=!0,i.zw()},Rn=Qt,n.ZZ=Rn,U=200,_n=20,s.prototype.lNt=function(n){var t;this.Mf.my=n,this.tbe=!0},s.prototype.hNt=function(n){var t;this.Mf.ly=n,this.nbe=!0},s.prototype.dNt=function(){var n;this.Mf.invalidateLayout()},s.prototype.yy=function(n,t,i,r,e){var o,u,f,s,c,a,h,v,a,A,l,w,d,p,g,m,A,C,M,b,f,x,E,k,P,P,k,E,P,y,F,h,o=this,u=o.Mf,f=u.options,s,c,a=Lt(u,n,u.Tb,u.ly);if(a&&(h=a.Ky,v=a.Xy,n=a._At,u.Tb=h,!(0<u.My)))if(a=u.ot(),l=(A=u.Fi()).Cy,w=u.Sy(A),d=A.Iy,p=A.Ay,g=A.Ty,m=(a||A).x,A=R(A),f=f.sheetAreaOffset,x=u.Ny,A+=f.left,n<0)o.vNt=0,k=E=void(o.mNt=0),(E=(P=u.dw(1))&&0<P.length?P.findRow(h):E)&&(k=P[P.length-1]).row>=h&&(C=2+f.top,M=l+H(n),0<=(b=N(l+w,k.y+T(k))-M))&&(b-=C,o.hNt(v-T(E)),i.x=m,i.y=M,i.width=A,i.height=b,i.tx=m,i.ty=l,P=x?w:w+d+g,r.x=m,r.y=l+b,r.width=A,r.height=P-b);else if(0<n){if(k=u.vw(-1),P=E=void 0,(y=u.parent&&u.parent.options.scrollByPixel)&&0<v&&(n-=v,v=0),h===k&&0<v){if(0<o.vNt&&0<o.mNt){if(v=P=zt(E=o.vNt+n,U),(n=P-o.mNt)<=0)return t;if(t&&20<=P)return!0}else{if(U<=v&&(n-=v-199,v=199,n<=0))return t;if(E=Jt(v,U),P=v,t&&20<=P)return!0}o.vNt=E,o.mNt=P}else o.vNt=0,o.mNt=0;n<(F=x?w:w+d)&&(C=2+f.top,M=l,b=w-n,0<wt(u)&&(b-=j),o.hNt(v),!x&&0<g&&(h=N(a.height-d-j,p-j+n),e.x=m,e.y=p-j,e.width=A,e.height=d+j,e.tx=m,e.ty=h),i.x=m,i.y=M,i.width=A,i.height=b+(x?0:N(n,g)-j),i.tx=m,i.ty=M+n,r.x=m,r.y=M,r.width=A,r.height=n+C)}return!1},s.prototype.wy=function(n,t,i,r,e){var o,u,f,s,c,a,h,c,v,A,l,w,d,p,g,m,C,M,b,x,E,k,P,y,F,I,O,B,O,I,Y,S,F,O,o=this,u=o.Mf,f,s,c=Gt(u,n,u.Ab,u.my);if(c&&(a=c.iw,h=c.Xy,n=c.EAt,u.Ab=a,!(0<u.My)))if(c=u.ot(),A=(v=u.Fi()).Py,l=u.Gy(v),w=v.zy,d=v.Hy,p=v.Uy,g=(c||v).y,m=T(v),k=u.options.rightToLeft,P=u.options.sheetAreaOffset,y=u.Vy,m+=P.top,n<0)o.gNt=0,I=F=void(o.pNt=0),((F=(O=u.yw(1))&&0<O.length?O.findCol(a):F)||k&&O&&0<O.length)&&(I=O[O.length-1]).col>=a&&(C=2+P.left,M=A+H(n),0<=(b=N(A+l,I.x+R(I))-M))&&(b-=C,B=k?-h:h-(F?R(F):u.nn(a)),o.lNt(B),i.x=M,i.y=g,i.width=b,i.height=m,i.tx=A,i.ty=g,O=y?l:l+w+p,r.x=A+b,r.y=g,r.width=O-b,r.height=m);else if(0<n){if(I=u.ww(-1),(Y=u.parent&&u.parent.options.scrollByPixel)&&0<h&&(n-=h,h=0),a===I&&0<h){if(0<o.gNt&&0<o.pNt){if(h=E=zt(x=o.gNt+n,U),(n=E-o.pNt)<=0)return t;if(t&&20<=E)return!0}else{if(U<=h&&(n-=h-199,h=199,n<=0))return t;if(x=Jt(h,U),E=h,t&&20<=E)return!0}o.gNt=x,o.pNt=E}else o.gNt=0,o.pNt=0;n<(S=y?l:l+w)&&(C=2+P.left,M=A,k&&(M-=v.Uy),b=l-n,0<lt(u)&&(b-=j),B=k?-(h+u.nn(a)):h,o.lNt(B),F=0,!y&&0<p&&(O=N(c.width-(F=w)-j,d-j+n),e.x=d-j,e.y=g,e.width=F+j,e.height=m,e.tx=O,e.ty=g),i.x=M,i.y=g,i.width=b+(y?0:N(n,p)-j),i.height=m,i.tx=M+n,i.ty=g,r.x=M,r.y=g,r.width=n+C,r.height=m)}return!1},s.prototype.bNt=function(n,t,i,r){var e,o,u,f,s,c,t,a,h,v,A,i,h,l,w,d,p,g,w,d,h,m,C,M,b,x,t,m,C,M,b,x,n,r,l,t,m,C,M,b,x,e=this,o=e.Mf,u=!0,f=!0,s=o.Dn,c=s.J(),A=0!=(2&i),i=0!=(1&i);if(i||A)return h={},l={},w=o.ot(),d=o.Fi(),p=(w||d).y,g=T(d),w=(w||d).x,d=R(d),A&&(u=e.yy(t,r,t={},a={},h),m=h.y,C=R(h),M=T(h),b=h.tx,x=h.ty,I(h=h.x)||s.Ey(h,m,C,M,b,x),s.Ey(t.x,t.y,R(t),T(t),t.tx,t.ty)),i&&(f=e.wy(n,r,h={},v={},l),m=l.y,C=R(l),M=T(l),b=l.tx,x=l.ty,I(t=l.x)||s.Ey(t,m,C,M,b,x),s.Ey(h.x,h.y,R(h),T(h),h.tx,h.ty),A||(a=v)),(n=o.parent)&&!n.options.scrollbarShowMax&&(i&&(o.Zw=!0),A)&&(o.Ww=!0),e.dNt(),r=o.rowOutlines&&!o.rowOutlines.Oy()?1:0,l=o.columnOutlines&&!o.columnOutlines.Oy()?1:0,i&&A?s.D1(c,new F.Rect(a.x,a.y,R(a),T(a)+r),new F.Rect(v.x,v.y,R(v)+l,T(v))):s.D1(c,new F.Rect(a.x,a.y,R(a)+l,T(a)+r)),t=new F.Rect(w,p,d,g),(m=o.getSelections())&&0<m.length&&(C=o.getRangeRect(1,1,m[0]),M=z(t.x+t.width,C.x+C.width),b=z(t.y+t.height,C.y+C.height),t.x=N(t.x,C.x),t.y=N(t.y,C.y),t.width=M-t.x+1,t.height=b-t.y+1),s.O1(t),s.jy(c,t),ni(o,!0),Vt(o,!0),e.yNt(i,A),$t(o,!0),x=o.options.sheetAreaOffset,o.options.rowHeaderVisible||s.q7(c,new F.Rect(w,p,2,g+x.top)),o.options.colHeaderVisible||s.q7(c,new F.Rect(w,p,d+x.left,2)),u&&f},s.prototype.yNt=function(n,t){var i=this.Mf;t&&i.tw(),n&&i.ow(),i.rt.By()},s.prototype.wNt=function(e,o,u){function f(n,t,i,r){return J(.75,n/=i)*r*(t?1:-1)}function n(n,t,i){return n=H(n),q(n/=i)/q(.75)*t}var s=this,c=s.Mf,a=U,t=10,i=20,h=100,v=n(e,10,a),A=n(o,10,a),l=e,w=o,d=0,p=0,g=!1,m=!1;s.H6=ln.setInterval(function(){var n,n,t,i,r;g&&m?(c.Jt.Rl(),(n=c.parent)&&!n.options.scrollbarShowMax&&(c.Zw=!0,c.Ww=!0),c.Jt.Bl(),c.ly=0,c.my=0,c.zw(),c.ow(),c.tw(),vt(s.H6),s.H6=b):(A+=20,h<(v+=20)&&h<A?(s.bNt(e-d,o-p,ti(g,m),u),m=g=!0):(h<v&&!g&&(s.bNt(e-d,0,1,u),g=!0),h<A&&!m&&(s.bNt(0,o-p,2,u),m=!0),n=f(v,0<e,10,a),t=f(A,0<o,10,a),i=$(l-n),r=$(w-t),s.bNt(i,r,ti(g,m),u),l=n,w=t,d+=i,p+=r))},20)},s.prototype.Ok=function(n){var t=this,i=t.Mf,r=i.Jt;t.H6&&(r.Bl(),vt(t.H6),t.H6=b),t.tbe=!1,t.nbe=!1,t.ebe=i.my,t.ibe=i.ly,t.gNt=0,t.pNt=0,t.vNt=0,t.mNt=0,t.MNt=i.Tb,t.CNt=i.Ab,n&&r.jl()},s.prototype.a9=function(n,t){var i,r,e,o,u,f,e,s,n,c,i,r,e=this.Mf.parent,o=e.options.scrollbarAppearance===F.ScrollbarAppearance.mobile,u=e.Xb,f=e.zb,e=e.ib,s=vn(n.X+""),n=vn(n.Y+""),c=ii(s,n);return o&&(0!==n&&(u.qy(F.ScrollbarState.show),e.$y(!0)),0!==s)&&(f.qy(F.ScrollbarState.show),e.$y(!1)),this.bNt(s,n,c,t)},s.prototype.SNt=function(n){var t,i,r,e,o,u,f,s,c,a,h,c,v,A,l,w,l,d,p,g,p,m,t=this,i=t.Mf,r=i.options.rightToLeft,e=t.MNt,o=i.Tb,u=t.CNt,f=i.Ab,s;i.parent&&i.parent.options.scrollByPixel?(i.Jt.Bl(),i.zw(),t.TNt(),t.tbe=b,t.nbe=b,t.ebe=b,t.ibe=b):(a=(c=i.Fi()).Py,h=c.b6,c=c.Cy,v=i.yw(1),l=i.Mw().iw,w=1,v&&0<v.length&&(A=v.findCol(f),f<l&&A&&!r&&A.x+R(A)-a<R(A)/2||r&&h-A.x<R(A)/2?f++:w=-1),l=i.dw(1),p=i.mw().Ky,g=1,l&&0<l.length&&(d=l.findRow(o),o<p&&d&&d.y+T(d)-c<T(d)/2?o++:g=-1),m=p=0,v&&0<v.length&&(A=v.findCol(f))&&(p=r?h-(A.x+A.width):a-A.x),l&&0<l.length&&(m=c-(d=l.findRow(o)).y),o!==e&&i.$A(o,0,e),f!==u&&i.o9(f,0,u),t.wNt(p*=w,m*=g,n))},s.prototype.TNt=function(){var n,t,i,r,e,o,u,n=this,t=n.Mf,i=n.MNt,r=t.Tb,e=n.CNt,o=t.Ab,u=t.zoom();i===r&&!n.nbe||t.ki(F.Events.TopRowChanged,{sheet:t,sheetName:t.name(),oldTopRow:i,newTopRow:r,oldOffset:H(n.ibe/u),newOffset:H(t.ly/u)}),e===o&&!n.tbe||t.ki(F.Events.LeftColumnChanged,{sheet:t,sheetName:t.name(),oldLeftCol:e,newLeftCol:o,oldOffset:H(n.ebe/u),newOffset:H(t.my/u)})},Zn=s,g.prototype.OZ=function(n){var t,i,r,e,o,u,f,s,c,a,h,r,v,A,l,w,t,v,d,p,t=this,i=t.Mf,r=i.Fi(),e=i.options.rightToLeft,o=r.Py,u=r.Cy,f=r.J7,s=r.Uy,c=r.X7,a=r.b6,h=r.Hy,r=r.Ay,v=n.JZ,A=i.Ny,l=i.Vy,w=0,t=t.ANt(v.X,v.Y),v=t.dragInfo,d=t.x,p=t.y;t&&(t.resizeInfo||v&&"corner"===v.side||t.selectionHitInfo)?w|=3:(u<=p&&(A&&p<r||!A&&p<c)&&(w|=2),o<=d&&(l&&(e?d<a:d<h)||!l&&(e?f+s<d:d<f))&&(w|=1),w|=96,i.parent&&(w|=12)),n.KZ=w},g.prototype.BZ=function(n){var t,i,i,r,e,o,u,i,f,s,f,c,s,a,t=this,i={e:n,r:b};g.et(t,"preProcessManipulationStarted",i),i.r||(i=n.JZ,e=(r=t.Mf).parent,o=r.rt,u=r.Dn,f=(i=t.ANt(i.X,i.Y)).dragInfo,s=i.selectionHitInfo,(r.sw=i).resizeInfo?r.endEdit()&&o.gk(i):f&&"corner"===f.side?o.wk&&o.wk(i):s?r.endEdit()&&(f=s.isHeader,c=s.isFirstIndicator,s=s.type,f&&o.A9(i,!0),a=i.hitTestType,i.hitTestType=s,o.F9(i),i.hitTestType=a,si(r,f,c,s),r.INt=!1,u.PD()):(r.pW&&(r.pW().VW=!1),r.INt=!1,u.PD(),1<n.kAt&&e&&e.options.allowUserZoom?(t.jAt=!1,t.YZ.$Z()):(t.jAt=!0,t.OAt.Ok(1===n.kAt))))},g.prototype.FZ=function(n){var t,i,i,r,e,r,o,i,u,f,r,u,t=this,i={e:n,r:b};g.et(t,"preProcessManipulationDelta",i),i.r||(i=n.JZ,e=(r=t.Mf).rt,r=r.sw,o=i.X,i=i.Y,r&&(u=r.dragInfo,f=r.selectionHitInfo,r.resizeInfo?(e.fk={e:n,x:o,y:i},e.y9()):u&&"corner"===u.side?(e.fk={e:n,x:o,y:i},e.Zk&&e.Zk()):f||e.ob?f&&e.Rk&&e.rb&&!0!==e.FI&&(r=f.type,e.fk={e:n,x:o,y:i},3===r?e.Y9():2===r?e.Z9():1===r&&e.W9()):t.jAt?n.gxt=t.OAt.a9(n.SAt.wAt,n.AAt):(u=n.nW.tW,t.YZ.iW(u))))},g.prototype.GZ=function(n){var t,i,i,r,e,o,e,t=this,i={e:n,r:b};g.et(t,"preProcessManipulationCompleted",i),i.r||(r=(i=t.Mf).rt,i.INt=!0,o=(e=i.sw).selectionHitInfo,e.resizeInfo?r.C9():e.dragInfo&&r.Yk?(r.DD&&r.DD(),i.parent.touchToolStrip.xNt()):o||r.ob?(r.X9(),o&&ci(i,o.isHeader,o.isFirstIndicator,o.type),i.Dn.E1()):(i.pW&&(i.pW().VW=!0),t.jAt?t.OAt.SNt(n.AAt):(e=n.nW.tW,t.YZ.rW(e))))},g.prototype.HZ=function(n){var i,t,t,r,e,n,o,o,u,t,f,s,c,a,h,v,A,v,h,A,a,v,t,t,t,l,l,l,l,w,d,l,t,i=this,t={e:n,r:b};if(g.et(i,"preProcessTapped",t),t.r)i.Mf.repaint();else if(t=n.JZ,r=i.Mf,e=r.parent,n=!1,r.Nk=p,i.NNt(),r.Olt&&r.Olt(),(o=r.Ut.pI)&&o.CZ(),o=r.rt,t=(u=i.ANt(t.X,t.Y,!0)).filterButtonHitInfo,f=u.hitTestType,s=u.row,c=u.col,a=u.outlineHitInfo)r.isEditing()||(h=a.what,v=r.rowOutlines,A=r.columnOutlines,"rg"===h||"rgh"===h?v&&v.rpt(r,a):"cg"!==h&&"cgh"!==h||A&&A.rpt(r,a));else if(r.sw=u,t)r.endEdit()&&(v=t.rowFilter)&&v.openFilterDialog(t);else if(!u.resizeInfo)if(r.JA(u.rowViewportIndex<0?-1:s,u.colViewportIndex<0?-1:c)){if(r.kNt&&!o.Yk&&e.touchToolStrip.xNt(),h=r.getActiveRowIndex(),A=r.getActiveColumnIndex(),a=u.cellTypeHitInfo){if(v=vi(r,a,u),a.sheet||(a.sheet=r),i.xk(v,a))if(t=a.sheetArea,!I(t)&&3!==t||s===h&&c===A)r.Dn.PD();else{if(r.suspendPaint(),!r.endEdit())return;if(t={sheet:r,sheetName:r.name(),row:h,col:A,cancel:!1},r.ki(F.Events.LeaveCell,t),!0===t.cancel)return;t=r.Ut.getSelections(),l=r.Ut.getSpan(s,c),l=[(0,F.Ec)(l.row,l.col,l.rowCount,l.colCount)],r.EA(t,l),r.ki(F.Events.FloatingElementSelected,{type:"worksheet"}),l=a.isReservedLocation&&a.isFocusAware,r.t4(s,c,p,p,l?0:1),l={sheet:r,sheetName:r.name(),row:s,col:c},r.ki(F.Events.EnterCell,l),r.ki(F.Events.EnterCellInternal,l),r.jA(t),r.Nk=!0,o.PA&&o.PA(s,c),r.resumePaint(),n=!0}v.processCellAndPaddingMouseDown(a),v.Ve(a)}if(a&&a.isReservedLocation)return!0;a&&(a.cellButtonHitInfo||a.outlineColumnHitInfo)&&(n=!0),r.ki(F.Events.CellClick,{sheet:r,sheetName:r.name(),sheetArea:f,row:u.row,col:u.col});try{if(o.Dk=u,w=r.isEditing(),d=r.endEdit(),r.Oi&&G&&w&&d&&(o.shift=!1),w&&h===r.getActiveRowIndex()&&A===r.getActiveColumnIndex()&&!d)return}finally{o.Dk=b}I(s)||I(c)||(3===f&&o.PA&&o.PA(s,c),ui(r,s,c,f)&&!n?i.DNt=ln.setTimeout(function(){var n,t,n={x:u.x,y:u.y,handled:!1},t=e.touchToolStrip;r.ki(F.Events.TouchToolStripOpening,n),n.handled||t.open(u.x,u.y-nn),i.NNt()},420):(r.ki(F.Events.FloatingElementSelected,{type:"worksheet"}),l=r.Ut.getSelections(),o.A9(u),t=r.Ut.getSelections(),r.EA(l,t),o.X9()))}else r.ki(F.Events.CellClick,{sheet:r,sheetName:r.name(),sheetArea:f,row:u.row,col:u.col})},g.prototype.xk=function(n,t){return!(n&&n.activeOnClick&&!n.activeOnClick()&&t.isReservedLocation)},g.prototype._Nt=function(n,t){var i,r,i,n,t,e,o,i=this,r=i.Mf,i=i.ANt(n,t,!0);i&&0<=i.row&&0<=i.col&&0<=i.rowViewportIndex&&0<=i.colViewportIndex&&!i.resizeInfo&&r.JA(i.row,i.col)&&((n=r.isCtrlPressed(i.hitTestType))||r.IA(),t=r.C0(i.row),e=r.S0(i.col),o=!0,r.ui===i.row&&r.ci===i.col||(o=!1),r.O6(i.row,i.col,t,e,o),n?r.zw():r.n4(i.row,i.col,1,1),r.rt.S_(!1,!0),r.f6(r.Dg(),i.row,i.col))},g.prototype.WAt=function(n){var t,i,i,n,r,e,t=this,i={e:n,r:b};g.et(t,"preProcessDoubleTapped",i),!i.r&&(i=t.Mf,n=n.JZ,t.NNt(),r=i.sw)&&(e=!1,3===r.hitTestType?t._Nt(n.X,n.Y):e=i.rt.j_(r),e||i.ki(F.Events.CellDoubleClick,{sheet:i,sheetName:i.name(),sheetArea:r.hitTestType,row:r.row,col:r.col}))},g.prototype.ENt=function(n){var t,i,n,r,r,t=this,i=t.Mf,n=n.JZ,r=t.ANt(n.X,n.Y);i.isEditing()?r.row===i.ui&&r.col===i.ci||i.rt.C_(r):(t._target=r,(r=t.ANt(n.X,n.Y,!0))&&r.cellTypeHitInfo&&r.cellTypeHitInfo.isEditing||i.rt.C_(r))},g.prototype.jNt=function(n){var t,i,t,r,e,e,t=this,i=t.Mf;!i.isEditing()&&(r=!0,r=(!(t=t._target)||!((e=t.cellTypeHitInfo)&&e.isReservedLocation||(e=i.getCellType(t.row,t.col))&&e.isEditing()))&&r)&&i.rt.S_(!0)},g.prototype.ANt=function(n,t,i){var r,e,o,u,f,s,u,f,s,s,u,f,c,a,f,f,f,r,e=this.Mf;return e.Fi(),o={x:n,y:t,rowViewportIndex:b,colViewportIndex:b,row:-1,col:-1,resizeInfo:b,hitTestType:b,outlineHitInfo:b,filterButtonHitInfo:b,dragInfo:b,cellTypeHitInfo:b,selectionHitInfo:b},u=e.rowOutlines,f=e.columnOutlines,(s=!(s=u?u.hitTest(e,n,t):s)&&f?f.hitTest(e,n,t):s)?o.outlineHitInfo=s:(f=u=void 0,u=e.FL(t),f=e.PL(n),o.rowViewportIndex=u,o.colViewportIndex=f,o.row=e.GL(t,u),o.col=e.UL(n,f,t,u,o.row),0<=u&&u<=2&&0<=f&&(s=e.O_(u,f,p,o.row,o.col))&&(o.row=s.row,o.col=s.col),o.hitTestType=e.C6(u,f),a=c=f=u=s=void 0,s=ri(e,o,n,t,10),c=(c=(f=e.IB)&&f.hitTest(o,n,t))||(f=(f=(f=e.tables)&&f.find(o.row,o.col))&&f.IB)&&f.hitTest(o,n,t),e.kNt?(u=oi(e,o,n,t),o.dragInfo=u):s?o.resizeInfo=s:c?o.filterButtonHitInfo=c:i?o.cellTypeHitInfo=e.JL(o,n,t):(a=ei(e,o,n,t),o.selectionHitInfo=a)),o},g.prototype.NNt=function(){var n=this,t=n.DNt;t&&(clearTimeout(t),n.DNt=b)},Dn=g,n.TouchEventHandler=Dn,(0,F.$e)(Dn),Ai.prototype.oW=function(){var n,t,n,n=this,t=n.DZ,n=n.xZ;n.jZ=function(n){return t.OZ(n)},n.RZ=function(n){return t.BZ(n)},n.LZ=function(n){return t.FZ(n)},n.PZ=function(n){return t.GZ(n)},n.UZ=function(n){return t.HZ(n)},n.ZAt=function(n){return t.WAt(n)},n.oIt=function(n){return t.ENt(n)},n.uIt=function(n){return t.jNt(n)}},Ai.prototype.uW=function(){var n=this,t=n.xZ;t&&(n.kZ.aW(t,!1),t.jZ=b,t.RZ=b,t.LZ=b,t.AIt=b,t.PZ=b,t.UZ=b,t.ZAt=b,t.IIt=b,t.oIt=b,t.uIt=b,n.xZ=b)},Ai.prototype.sW=function(n){return this.AZ.sW()},Ai.prototype.cW=function(n){return this.AZ.cW()},Ai.prototype.fW=function(n){return this.AZ.fW()},Qn=Ai,Ln="gc-toolstrip-button",Gn="gc-toolstrip-text",zn="gc-toolstrip-image",Jn="gc-toolstrip-item",Kn="gc-touch-sperate-line",Xn="height",Vn="width",A="px",Wn="button",Y(x,ht=y),x.prototype.open=function(n,t){var i,r,e,o,u,f,i=this,r=d(i.Vv);if(r&&(F.hi.F1(b,!0),i.LAt.css({left:n,top:t}),i.$c(),i.Jet=!0,i.if(),!Z(i.f$)))for(o in e=i.f$)e.hasOwnProperty(o)&&((f=!(u=e[o]).UAt||u.UAt.call(i))?O("#"+o).show():O("#"+o).hide())},x.prototype.add=function(n){var t,i,r,r;n&&(i=(t=this).f$,n instanceof nt?(r=n.name())&&(i[r]=n,t.ONt(n.RNt(Kn,t.BAt+A))):n instanceof $n&&(r=n.name(),t.getItem(r)||(i[r]=n,t.ONt(n.RNt(zn,t.RAt+A,Gn,Ln)))))},x.prototype.getItem=function(n){return this.f$[n]},x.prototype.getItems=function(){var n,t,i,r,n,t=[],i=this.f$;if(Z(i))return b;for(r in i)i.hasOwnProperty(r)&&t.push(i[r]);return t},x.prototype.remove=function(n){var t,i,t=this;return t.getItem(n)?(O("#"+n).parent().remove(),i=t.f$[n],delete t.f$[n],i):b},x.prototype.clear=function(){var n=this;n.LAt&&(n.LAt.find("td."+Jn).remove(),n.f$={})},x.prototype.close=function(){var n,n,t,n=this;wn.cf(),n.LAt&&n.LAt.hide(),n.Jet=!1,n.uf(),(n=d(n.Vv))&&(n.Zg(),0<(t=m(n)).length)&&!n.kNt&&-1===t[0].row&&-1===t[0].col&&n.IA()},x.prototype.imageAreaHeight=function(n){var t=this;return 0===arguments.length?t.RAt:(0<n&&(t.RAt=n,t.LAt.find("span."+zn).css(Xn,n+A)),t)},x.prototype.itemHeight=function(n){var t=this,i=t.LAt.find("button."+Ln);return 0===arguments.length?An(i.css(Xn)):(0<n&&i.css(Xn,n+A),t)},x.prototype.itemWidth=function(n){var t,i,r,e,t=this,i=t.LAt.find("button."+Ln);return 0===arguments.length?An(i.css(Vn)):(0<n&&(n<(e=An(i.css(r="min-width")))&&i.css(r,n+A),i.css(Vn,n+A)),t)},x.prototype.separatorHeight=function(n){var t=this;return 0===arguments.length?t.BAt:(0<n&&(t.BAt=n,t.LAt.find("div."+Kn).css(Xn,n+A)),t)},x.prototype.FAt=function(){var n,t,n,n="table",t=this,n=O(c(n)).css({padding:0,display:n}).attr({cellspacing:0,cellpadding:0});t.BNt=O(c("tr")).appendTo(n),n.appendTo(t.LAt)},x.prototype.L0=function(){var n=this,t=n.LAt;t&&(n.Jet&&(wn.cf(),n.uf()),t.unbind("click"),t.remove(),n.LAt=b)},x.prototype.aY=function(){var r=this;r.LAt.bind("click",function(n){var n,t,i,n,n,n=n.target,t;n.tagName.toLowerCase()===Wn?i=n.id:(n=n.parentElement)&&n.tagName.toLowerCase()===Wn&&(i=n.id),n=r.f$[i],i&&n&&n.tT.call(r)})},x.prototype.ONt=function(n){this.LAt&&n&&O(c("td")).append(n).appendTo(this.BNt).addClass(Jn)},x.prototype.PAt=function(){var n,n,t,i,r,e,n;function o(n){for(var t,i,t=0,i=n+t;B.getElementById(i);)i=n+ ++t;return i}i=(n={0:w+(n="gAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAA")+"A8ElEQVRIS92VwQ3CMAxFe+qZERiHY8dgDI4cYYNOhDhwY4ayQviW4q/Eddu0KRe+9CQ72P8rEpAmhPBT3ENLd76EiPv5HO5hSmK+KYTFsz+04A4G9NZ0hAizn7jTos2MFRYYugFZQlscoFzRZsYKCwwNulAqnZddtJmxwiIZ3oT6WFh4S2tQHwsLb2kN6mNh4S2tQX0sLLwly4IyY4WFZ2gReV/ZhBOQH2ddgKcYwBAc7R/weL0ZgqO6gGPXE1E0JlBdwJx2CUhvkCL63xvw33QKUc0N+B5MIaq5gb5o8kotBszJDShFlkvQ+ZHBvoTmC+fiVfoq/m86"+dn,1:w+n+"BkklEQVRIS7WTUXECQRBEcYCFOIiESAAH/OYPCcQBEogDJCABCUhAwqXf1QzVM0cojko+Xt3ObG/33t7eYhiGf6UU68+vneD5Mu4HpZDgKja+YCYH94NSSHAUg3glZC9k8zgAYwLmhuS6o/tBKUJ8CTGsoveIsin3g1LEAkxzAd/kXbihwxwatGys+EEpEAT5LR6FuDmMb+t+UAoEwVL44h7CvB8lGxrn3A9KkaLAj8pDMD9HL/v0ZgfAQfSAk/WgXAT3g1K4MPCj2AoPhNvRJO4HpejigF1jxtjNy9Ek7gel6GIjfzoP+Ihewf2gFPcWNNL817/c/aAUKXpbfy/FXlzFIM6gOYy3Gp+iz/xBPHeLQGLAMI2PNmYOw1uojZfdCyYNCXexiGcGpiljdp9hsBGjvnvBpCHhRbgBZChjAgj0eXrX7gWThoR992lAMGOOLMfJuIHuBZMGQuE75KN66Cpq14xH2L1g0kixyLNm3I8sNbwJulHfvWDSkJArmou4hlxXeh4AvBEBuZnnbtHfMix+AHqkr6wgQ4Q7"+dn,2:w+n+"A3UlEQVRIS72PwQ3CMAxFOwrjcOyZCTgyAjfWYCJO3JiCCVL/iFSO9W0MDTzpqYob+ztTKeWn0uJIadE6H8/ljXsR96q6tzt4YogH/olPcQ2R8mp3CHRBwO3+6EKkvNodcDkSgyyoAx0iRz/AA/8Op0sdtJuv1Va3Ct8FYHgL8dgUAGxIe41+kRAH6CbdaGW86nFAhnaXLSLEAbqJCbxlUgEZ2DIgFaCbmMBbJhWQgS0DUgG6iQm8ZVIBGTYFsK21oN3F1yrEARnsIM/u8JeAT9S9nrQ4UlocKS2Os0wLtkPMdu9POt0AAAAASUVORK5CYII=",3:w+"UAAAAXCAIAAABrvZPKAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAIdJREFUOE/tzEEKgCAQheEOWLdx351adYc8Qgs3rbuAUC9nkkF0BKNN9CMy0Xx25llf8Edr7d57j/tlP4wTHf4W/b7gsT0vLs7Sz9bFWfM9nrDXE9ITphlVPO512wkkM++FNF86vBfKeKR43rjLe5QwOvxPVPSoipHmkY5RxSMFo7rXY9+eMSdet07b6c/bnwAAAABJRU5ErkJggg=="})[0],r=n[1],e=n[2],n=n[3],(t=this).LNt=new $n(o("wijspread_toolstrip_paste"),f().ToolStrip_PasteText,i,t.FNt),t.PNt=new $n(o("wijspread_toolstrip_cut"),f().ToolStrip_CutText,r,t.GNt),t.UNt=new $n(o("wijspread_toolstrip_copy"),f().ToolStrip_CopyText,e,t.HNt),t.zNt=new $n(o("wijspread_toolstrip_autofill"),f().ToolStrip_AutoFillText,n,t.VNt,t.YNt),t.add(t.LNt),t.add(t.PNt),t.add(t.UNt),t.add(new nt(t.YNt)),t.add(t.zNt)},x.prototype.YNt=function(){var n,t,i,r,n=d(this.Vv);if(!n)return!1;if(0===(t=m(n)).length)return!1;for(i=0;i<t.length;i++)if(-1===(r=t[i]).row&&-1===r.col)return!1;return!0},x.prototype.VNt=function(){var n,t;this.close(),(n=d(this.Vv))&&(t=m(n).length)<=1&&(n.kNt=!0,n.Dn.E1())},x.prototype.xNt=function(){var n=d(this.Vv);n&&(n.kNt=!1,n.Dn.E1())},x.prototype.HNt=function(){var n,t,n=d(this.Vv);n&&(t=li(n),this.ZNt=t?n.Qy().execute({cmd:"copyFloatingObjects",sheetName:n.name()}):n.eA(!0)),this.close()},x.prototype.GNt=function(){var n,t,n=d(this.Vv);n&&(t=li(n),this.ZNt=t?n.Qy().execute({cmd:"cutFloatingObjects",sheetName:n.name()}):n.tA(!0)),this.close()},x.prototype.FNt=function(){var n,t,i,n=this,t=n.ZNt,i=d(n.Vv);i&&!I(t)&&(i.isPasteFloatingObject&&i.isPasteFloatingObject()?i.Qy().execute({cmd:"pasteFloatingObjects",sheetName:i.name()}):i.rA({pasteHtml:t.copyHtml,pasteText:t.copyText})),n.close()},x.prototype.WNt=function(){var n=this,t="span."+Gn;O("#"+n.LNt.Zc).find(t).text(f().ToolStrip_PasteText),O("#"+n.PNt.Zc).find(t).text(f().ToolStrip_CutText),O("#"+n.UNt.Zc).find(t).text(f().ToolStrip_CopyText),O("#"+n.zNt.Zc).find(t).text(f().ToolStrip_AutoFillText)},qn=x,n.TouchToolStrip=qn,di.prototype.name=function(n){var t=this;return 0===arguments.length?t.Zc:(O("#"+t.Zc).attr("id",n),O("#"+t.Zc+"Text").attr("id",n+"Text"),O("#"+t.Zc+"Image").attr("id",n+"Image"),t.Zc=n,t)},di.prototype.text=function(n){var t=this;return 0===arguments.length?t._text:(t._text=n,O("#"+t.name()+"Text").text(n),t)},di.prototype.font=function(n){var t,i,t=this,i=O("#"+t.name()+"Text");return 0===arguments.length?t._font:(t._font=n,i.css("font",n),t)},di.prototype.foreColor=function(n){var t,i,t=this,i=O("#"+t.name()+"Text");return 0===arguments.length?t.Oft||i.css("color"):(i.css("color",n),t)},di.prototype.image=function(n){var t=this;return 0===arguments.length?t.GAt:(t.GAt=n,O("#"+t.name()+"Image").css("background-image","url("+n+")"),t)},di.prototype.RNt=function(n,t,i,r){var e,o,u,f,s,n,t,e,u,e=this,o=e.name(),u=e.font(),f=e.text(),s=O(c("span"));return s.attr("id",o+"Image"),s.addClass(n),s.css({"background-image":"url("+e.image()+")","background-repeat":"no-repeat",display:"block",height:t,"background-position-x":"50%"}),(n=O(c("span"))).attr("id",o+"Text"),n.addClass(i),n.css("font",u),n.text(f),(e=60)<(t=wi(u,f,i))&&(e=t),(u=O(c(Wn))).attr("type",Wn),u.attr("id",o),u.addClass(r+" gc-toolstrip-button-style ui-state-default ui-widget btn btn-default"),u.css({"box-sizing":"content-box",border:"0px",padding:"4px",margin:"3px",width:e+A}),u.append(s),u.append(n),u[0]},$n=di,n.TouchToolStripItem=$n,pi.prototype.name=function(){return this.Zc},pi.prototype.RNt=function(n,t){var i=O(c("div"));return i.attr("id",this.name()),i.addClass(n),i.css({width:"1px",height:t,display:"inline-block;","background-color":"#CCC","margin-left":"5px","margin-right":"5px",opacity:.6}),i[0]},nt=pi,n.TouchToolStripSeparator=nt,E.prototype.NIt=function(){this.QNt=2,this.jS.Oi=!0},E.prototype.qAt=function(){this.QNt=0,this.KNt=l()},E.prototype.xIt=function(){return 1===this.QNt},E.prototype.jIt=function(){return 1===this.QNt},E.prototype._It=function(){return 1===this.QNt},E.prototype.sW=function(){var n=this;if(2===n.QNt)return!0;if(n.KNt){if(l()-n.KNt<=200)return n.JNt++,!0;n.KNt=0,n.JNt=0}return n.QNt=1,n.jS.Oi=!1},E.prototype.cW=function(){var n=this;return n.JNt?(n.JNt--,!0):2===n.QNt||(n.QNt=0,!1)},E.prototype.fW=function(){return 2===this.QNt},tt=E,n.IZ=tt,it=gi,n.NZ=it,mi.prototype.XNt=function(n,t){var i,r,e,o,r,e,i=n,r=i.touches,e=i.targetTouches,o=i.changedTouches;!1===i.isPrimary||r&&1<=r.length&&e&&1<=e.length&&(r[0].clientX!==e[0].clientX||r[0].clientY!==e[0].clientY)||(a(n),r=I(o)?i:o[0],(e=B.createEvent("MouseEvents")).initMouseEvent(t,!0,!0,ln,1,r.screenX,r.screenY,r.clientX,r.clientY,!1,!1,!1,!1,0,b),n.target.dispatchEvent(e))},mi.prototype.lIt=function(n){var t,t,t=n.pointerType;t&&t!==n[v]&&t!==h||(t=n.data).Vb||(t.Vb=!0,t.qNt=!1,t.XNt(n,"mouseover"),t.XNt(n,"mousemove"),t.XNt(n,"mousedown"))},mi.prototype.iE=function(n){var t,t,t=n.pointerType;t&&t!==n[v]&&t!==h||(t=n.data).Vb&&(t.qNt=!0,t.XNt(n,"mousemove"))},mi.prototype._up=function(n){var t,t,t=n.pointerType;t&&t!==n[v]&&t!==h||(t=n.data).Vb&&(t.XNt(n,"mouseup"),t.XNt(n,"mouseout"),t.qNt||t.XNt(n,"click"),t.Vb=!1)},mi.prototype.$Nt=function(n,t,i){var r,e,e,o,u,f,s,c,a,h,i,v,t,r=this,e=i.charAt(0),e=rn+(i="."!==e?"."+i:i),o=en+i,u=on+i,f=un+i,s=fn+i,c=sn+i,a=cn+i,h=an+i,i=hn+i,v=F.mt.m0();t?v?(t=n.style,I(t.msTouchAction)||(t.msTouchAction=tn),I(t.touchAction)||(t.touchAction=tn),O(n).bind(e,r,r.lIt).bind(f,r,r.lIt),O(B).bind(o,r,r.iE).bind(s,r,r.iE).bind(u,r,r._up).bind(c,r,r._up)):O(n).bind(a,r,r.lIt).bind(h,r,r.iE).bind(i,r,r._up):v?(O(n).unbind(e).unbind(f),O(B).unbind(o).unbind(s).unbind(u).unbind(c)):O(n).unbind(a).unbind(h).unbind(i)},rt=mi,n.QAt=rt,et="newSheet",ot="tab",ut="allSheets",k.prototype.BZ=function(n){var t,n,i,r,e,e,o,u,e,n,u,n,u,f,s,e,c,u,t=this,n=n.JZ,i=t.w2,r=i.im(),e=d(i.Vv);i.Og&&i.Rg(e,!1),e="resize",(u=(o=i.hitTest(n.X,n.Y)).element)===e?(i.Bg=!0,i.Lg=n.X):u!==ot&&u!==et&&""!==u||(e=i.fg,n=F.Bf.Xl(e),u=F.Bf.ql(e),u=(n=t.oNt(n,u)).getContext("2d"),f=F.Bf.Kl(n),s=F.Bf.Jl(n),F.Lf.Vl(u,1,1),u.drawImage(e,0,0,R(n),T(n),0,0,R(n),T(n)),F.Lf.Vl(u,f,s),t.fg=n,t.t6t=i.om,t.n6t=i.tm(),t.e6t=i.Xv(),t.Rv=i.Jv()),t.i6t=i.N2(-1),e=i.Ym(i.Zm()),t.r6t=-1===e?i.om:e,u=(c=r?i.$v:i.M2e).slice(0,t.t6t),t.uTe=0<u.length?u.reduce(function(n,t){return n+t}):0},k.prototype.FZ=function(n){var t,i,r,e,o,u,t,f,s,c,f,a,f,u,s,a,c,r,h,n,v,v,s,u,a,c,s,A,l,w,d,o,t,o,p,g,t,i,i=this,r=n.JZ.X,e=i.w2,o=e.im(),u=e.Vv,t=null==(t=(0,F.jf)(u))?void 0:t.options.rightToLeft;e.Bg?(f=r-e.Lg,s=u.options,c=u._vp.clientWidth,s.tabStripRatio=u.Jg()+f/c,f=t?0:e.rm()/c,a=t?1-e.rm()/c:1,u.Jg()<f?(s.tabStripRatio=f,e.Lg=e.rm()):u.Jg()>=a?(s.tabStripRatio=a,e.Lg=c):e.Lg=r):(f=i.fg,u=i.t6t,f&&!I(u)&&(s=i.i6t,a=i.r6t,c=i.Rv,r=i.n6t,h=i.e6t,n=o?n.nW.wAt.X:n.nW.wAt.Y,v=i.o6t(n,u),e.om=v.om,v=v.Eft,(0<n&&u===s&&e.om===s||n<0&&u===a&&e.om===a)&&(v=0),0<n&&v+c<n?n=v+c:n<0&&n<v-c&&(n=v-c),0!==n)&&(u=(s=e.fg).getContext("2d"),a=F.Bf.Kl(s),c=F.Bf.Jl(s),u.save(),u.clearRect(0,0,F.Bf.Xl(s),F.Bf.ql(s)),s=e.ot(),e.wm(u,s),o?(d=w=l=A=void 0,t?(d=T(s),t=o=void(l=0),0<n?(0<(w=h-(o=(A=r)+n))&&(F.Lf.Vl(u,1,1),u.drawImage(f,A*a,l,w*a,d*c,o*a,l,w*a,d*c),F.Lf.Vl(u,a,c)),t=h-r<=n?0:n-v,A=r,0<(w=v)&&(F.Lf.Yl(u,t,0),e.Z2(u,new F.Rect(A,l,w,d)),F.Lf.Yl(u,-t,0))):n<0&&(0<(w=h-(A=(o=r)+H(n)))&&(F.Lf.Vl(u,1,1),u.drawImage(f,A*a,l,w*a,d*c,o*a,l,w*a,d*c),F.Lf.Vl(u,a,c)),t=n-v,h-r<=H(n)&&(t=0),A=h-(w=H(v)),0<w)&&(F.Lf.Yl(u,t,0),e.Z2(u,new F.Rect(A,l,w,d)),F.Lf.Yl(u,-t,0)),F.Lf.Vl(u,1,1),A=0,w=r):(o=r-i.uTe+n,F.Lf.Yl(u,o,0),e.Z2(u,void 0,!0),F.Lf.Yl(u,-o,0),F.Lf.Vl(u,1,1),l=A=0,w=r,d=T(s)),u.drawImage(f,A*a,l,w*a,d*c,A*a,l,w*a,d*c),p=F.I.fl(""),2007<(g=vn(p.zIndex))&&(A=h,w=s.x+R(s)-e.rm()-A,u.drawImage(f,A*a,l,w*a,d*c,A*a,l,w*a,d*c)),A=R(s)-e.rm(),w=e.rm(),u.drawImage(f,A*a,l,w*a,d*c,A*a,l,w*a,d*c)):(w=R(s),i=t=d=l=void(A=0),0<n?(0<(d=h-(t=(l=r)+n))&&(F.Lf.Vl(u,1,1),u.drawImage(f,A*a,l*c,w*a,d*c,A*a,t*c,w*a,d*c),F.Lf.Vl(u,a,c)),i=h-r<=n?0:n-v,l=r,0<(d=v)&&(F.Lf.Yl(u,0,i),e.Z2(u,new F.Rect(A,l,w,d)),F.Lf.Yl(u,0,-i))):n<0&&(0<(d=h-(l=(t=r)+H(n)))&&(F.Lf.Vl(u,1,1),u.drawImage(f,A*a,l*c,w*a,d*c,A*a,t*c,w*a,d*c),F.Lf.Vl(u,a,c)),i=n-v,h-r<=H(n)&&(i=0),l=h-(d=H(v)),0<d)&&(F.Lf.Yl(u,0,i),e.Z2(u,new F.Rect(A,l,w,d)),F.Lf.Yl(u,0,-i)),F.Lf.Vl(u,1,1),u.drawImage(f,A*a,(l=0)*c,w*a,(d=r)*c,A*a,l*c,w*a,d*c),p=F.I.fl(""),2007<(g=vn(p.zIndex))&&(l=h,d=s.y+T(s)-e.rm()-l,u.drawImage(f,A*a,l*c,w*a,d*c,A*a,l*c,w*a,d*c)),l=T(s)-e.rm(),d=e.rm(),u.drawImage(f,A*a,l*c,w*a,d*c,A*a,l*c,w*a,d*c)),F.Lf.Vl(u,a,c),u.restore()))},k.prototype.GZ=function(n){var t=this.w2;t.Bg?(t.Bg=!1,t.Vv.Xg()):t.repaint()},k.prototype.HZ=function(n){var t,i,r,e,o,r,u,o,t=this.w2,i=t.Vv,r=n.JZ,e=d(i);t.Og&&t.Rg(e,!1),o=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],u=(r=t.hitTest(r.X,r.Y)).element,i.Bp=!0;try{0<=o.indexOf(u)?t.Pg(r.index,!0):u===ot?t.Gg(r.index,r.position):u===et?t.Hg(r.position):u===ut&&this.zg(n)}finally{i.Bp=!1,(o=d(i))!==e&&(o.Oi=!0,o.Zg())}},k.prototype.WAt=function(n){return this.w2.E2(n.JZ.X,n.JZ.Y)},k.prototype.oNt=function(n,t){var i=this.fg;return i?n===F.Bf.Xl(i)&&t===F.Bf.ql(i)||F.Bf.$l(i,n,t):(i=c("canvas"),F.Bf.Wl(i,this.w2.Vv),F.Bf.$l(i,n,t)),i},k.prototype.o6t=function(n,t){var i,r,e,o,u,f,s,c,i,a,h,v,i=this,r=i.w2,e=r.$v,o=r.M2e,u=i.i6t,f=i.r6t,s=r.im(),c,i=d(r.Vv),a,h=t,v=0;if((null==i?void 0:i.options.rightToLeft)&&s){if(0<n){for(;h<=f&&!(n<v);)v+=e[h],h++;f<h&&(h=f)}else if(n<0&&-1!==f){for(;u<=h&&!(v<n);)v-=e[h],h--;h<u&&(h=u)}}else if(0<n){for(;u<=h&&!(n<v);)v+=(s?e:o)[h],h--;h<u&&(h=u)}else if(n<0&&-1!==f){for(;h<=f&&!(v<n);)v-=(s?e:o)[h],h++;f<h&&(h=f)}return{om:h,Eft:v}},k.prototype.zg=function(n){var t,i,t=this.w2,i=gt(t.getCanvas());t.zg({pageX:n.JZ.X+i.I0,pageY:n.JZ.Y+i.A0})},ft=k,Ci.prototype.oW=function(){var n=this,t=n.kZ;t&&t.aW(n.xZ,!0)},Ci.prototype.uW=function(){var n=this,t=n.kZ;t&&t.aW(n.xZ,!1)},Ci.prototype.sW=function(n){return this.AZ.sW()},Ci.prototype.cW=function(n){return this.AZ.cW()},Ci.prototype.fW=function(n){return this.AZ.fW()},st=Ci,F.g7.prototype.PD=function(){var n,t,i,r,n=this,t=n.Mf,i=m(t),r=i.length;t.My<=0&&0<r&&n.E1(i[r-1],p,p,!0)},F.Worksheet.ch(h,{init:function(){this.kNt=!1,this.INt=!0},setHost:function(n){var t,i,i,n,t=this,i=t.parent,i=i&&i.kZ||new Cn,n=new Qn(n[0],t,i);n.oW(),t.dW=n},dispose:function(n){var t=this;t.dW&&t.dW.uW(),!1!==n.clearCache&&(t.dW=b)},startEdit:function(){this.Oi&&this.Dn.PD()},paintAdornment:function(n){var t,n,t=this,n=n.ctx;t.Oi&&(t.isActualProtected()||bi(t,n),t.kNt?Fi(t,n):yi(t,t.INt,n))},preProcessMouseDown:function(n){var t,i,t=n.e,i=this.dW;(r||i.sW(t))&&(a(t),n.r=!0)},preProcessMouseMove:function(n){var t,i,t=n.e,i=this.dW;(r||i.fW(t))&&(a(t),n.r=!0)},preProcessMouseUp:function(n){var t,i,t=n.e,i=this.dW;(r||i.cW(t))&&(a(t),n.r=!0)},preProcessMouseDbClick:function(n){(r||this.Oi)&&(n.r=!0)},preProcessMouseOut:function(n){r&&(n.r=!0)},preProcessMouseWheel:function(n){r&&(n.r=!0)}}),F.Workbook.ch(h,{init:function(){this.kZ=new Cn},setHost:function(){var n=this;n.touchToolStrip=new qn(n,n.j2())},dispose:function(){var n=this,t=n.kZ,i=n.touchToolStrip;t&&t.L0(),i&&(i.L0(),n.touchToolStrip=b)},onCultureChanged:function(){var n=this.touchToolStrip;n&&n.WNt()}}),F.Hv.ch(h,{setHost:function(){var n,t,n=this,t=new st(n.fg,n,n.Vv.kZ);t.oW(),n.dW=t},dispose:function(){var n=this,t=n.dW;t&&(t.uW(),n.dW=b)},preProcessMouseDown:function(n){var t=this.dW,i=n.e;(r||t.sW(i))&&(a(i),n.r=!1)},preProcessMouseMove:function(n){var t=this.dW,i=n.e;(r||t.fW(i))&&(a(i),n.r=!1)},preProcessMouseUp:function(n){var t=this.dW,i=n.e;(r||t.cW(i))&&(a(i),n.r=!1)},preProcessMouseDbClick:function(n){var t=d(this.Vv);(r||t&&t.Oi)&&(n.r=!1)},preProcessMouseOut:function(n){r&&(n.r=!1)}}),ct=".gcScrollbar",F.YM.ch(h,{initEvents:function(n){var t;(this.Hb=new rt).$Nt(n,!0,ct)},dispose:function(n){var t=this.Hb;t&&t.$Nt(n,!1,ct)}})},"./dist/plugins/touch/touch.res.en.js":function(n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ToolStrip_AutoFillText=t.ToolStrip_CopyText=t.ToolStrip_CutText=t.ToolStrip_PasteText=void 0,t.ToolStrip_PasteText="Paste",t.ToolStrip_CutText="Cut",t.ToolStrip_CopyText="Copy",t.ToolStrip_AutoFillText="AutoFill"},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets}},r={},n=e("./dist/plugins/touch/touch.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Touch=n}();
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},Forguncy;(function(n){var i=function(i){function r(t,r,u,f,e){var o=i.call(this,t,r,u,f)||this;return o._loadedOnDemandCriticalRowIndex=0,o._rangeChangedManager=new n.ListViewHelper.RangeChangedManager(o),o._isMouseIn=!1,o._colHeaderCellIDDic={},o._conditionFormatDependenceListviews=[],o._getMultiComboBindingOptionsRequestID=0,o._getMultiComboBindingOptionsRequestList={},o._suspenPaintCountWhenResetData=0,o._columnAutoWidths=[],o._dirtyCellColor=null,o._allowDirtyColumns=null,o._tabIndex=0,o._cancelInput=!1,o._newRowIndex=-1,o.layout=e,o.row=e.Row,o.column=e.Column,o.evenRowBackcolor=o.listviewData.getAlternativeBackcolor(!0),o.oddRowBackcolor=o.listviewData.getAlternativeBackcolor(!1),o.listViewStyleTemplate=o.listviewData.getListViewStyleTemplate(),o.initStretchInfo(),new n.ListViewHelper.AutoScrollHelper(o).apply(),o}return __extends(r,i),r.prototype.isMouseInListView=function(){return this._isMouseIn},Object.defineProperty(r.prototype,"totalRowIndex",{get:function(){return this.listviewData.allowShowTotalRow()?this.listviewData.getIsTotalRowAtFirstRow()?0:this._sheet.getRowCount()-1:-1},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"firstDataRowIndexInView",{get:function(){return this.listviewData.allowShowTotalRow()&&this.listviewData.getIsTotalRowAtFirstRow()?1:0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"lastDataRowIndexInView",{get:function(){return this.listviewData.allowShowTotalRow()&&this.listviewData.getIsTotalRowAtFirstRow()?this.getListDataCount():this.getListDataCount()-1},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"activeRowIndexInDataArea",{get:function(){return this.listviewData.allowShowTotalRow()&&this.listviewData.getIsTotalRowAtFirstRow()?this._sheet.getActiveRowIndex()-1:this._sheet.getActiveRowIndex()},enumerable:!1,configurable:!0}),r.prototype.mappedRowIndexFromData=function(n){return this.listviewData.allowShowTotalRow()&&this.listviewData.getIsTotalRowAtFirstRow()?n+1:n},r.prototype.mappedRowIndexFrowView=function(n){return this.listviewData.allowShowTotalRow()&&this.listviewData.getIsTotalRowAtFirstRow()?n-1:n},r.prototype.isNewLineRow=function(n){return n===this.lastDataRowIndexInView+1?!0:!1},r.prototype.isComboboxRequestCompleted=function(){for(var n in this._getMultiComboBindingOptionsRequestList)if(this._getMultiComboBindingOptionsRequestList[n])return!1;return!0},r.prototype.getContainer=function(){return this._divContainer},r.prototype.getSheet=function(){return this._sheet},r.prototype.getSpread=function(){return this._spread},r.prototype.suspendPaintWhenResetData=function(){var n;this._suspenPaintCountWhenResetData===0&&((n=this._spread)===null||n===void 0?void 0:n.suspendPaint());this._suspenPaintCountWhenResetData++},r.prototype.resumePaintAndTriggerEventWhenResetData=function(){var n;(n=this._spread)===null||n===void 0?void 0:n.resumePaint();this._suspenPaintCountWhenResetData=0;this.trigger("listviewDataChanged")},r.prototype.resetListviewData=function(t,r){var u=this,f;r===void 0&&(r=!1);this.suspendPaintWhenResetData();this.hideActiveCellValidationTooltip();i.prototype.resetListviewData.call(this,t,r);this.initConditionFormatFormula();this.handleDefaultFormulaDependenceCells();this.handleTotalRowFormulaDependenceCells();this.handleComboboxDependenceCells();this.evenRowBackcolor=this.listviewData.getAlternativeBackcolor(!0);this.oddRowBackcolor=this.listviewData.getAlternativeBackcolor(!1);this._stretchHelper.cacheWidth();this.resetSpreadSetting();this.resetSheetSetting();this.tryCreateDeleteButton();this.bindDeleteButtonEvents();this.listviewData.visibleColumns.length>0&&(this._stretchHelper.stretch(!1),this.refresh());r?(n.ListViewHelper.RequestHelper.updateSortInfoInColumn(this,(f=n.ForguncyData.pageInfo.sortInfoCache[this.getLocationString()])===null||f===void 0?void 0:f.sortInfo),this.refreshUI(),n.DelayRefresh.Push(this,function(){u.resumePaintAndTriggerEventWhenResetData()},"resetListviewData_"+this.getCalcSheetName())):this.fillData(null,!1,!0,function(t){t||u.refreshUI();n.DelayRefresh.Push(u,function(){u.resumePaintAndTriggerEventWhenResetData()},"resetListviewData_"+u.getCalcSheetName())},function(){u.resumePaintAndTriggerEventWhenResetData()},function(){u.resumePaintAndTriggerEventWhenResetData()})},r.prototype.onLoad=function(){var t=this,n=this.getContainerDiv();n.length>0&&(this.initSpread(n[0]),this.modifyInternalMethod(),this.bindSpreadEvent());n.on("mouseenter",function(){t._isMouseIn=!0});n.on("mouseleave",function(){t._isMouseIn=!1});i.prototype.onLoad.call(this);this.bindDeleteButtonEvents();this.handleDefaultFormulaDependenceCells();this.handleTotalRowFormulaDependenceCells();this.handleComboboxDependenceCells()},r.prototype.bindDeleteButtonEvents=function(){var n=this;this._deleteButton&&(this._deleteButton.bind("mouseenter",function(){n._isMouseIn=!0}),this._deleteButton.bind("mouseleave",function(){n._isMouseIn=!1}))},r.prototype.handleDefaultFormulaDependenceCells=function(){var t=this,r,f,e,i,u,o;if(this.canAddRow())for(f=function(i){var u=(r=i.columnInfo)===null||r===void 0?void 0:r.DefaultFormulaDependenceCells;if(!u)return"continue";n.DependenceCellValueChangeHelper.listenFormulaRefChanged(u,function(){if(t._newRowIndex>=0){var n=i.getDefaultValue(t.getCalcSheetName(),t.runTimePageName,t._listData.getRowCount()),r=t.listviewData.visibleColumns.indexOf(i);t._sheet.setValue(t._newRowIndex,r,n)}},e.runTimePageName)},e=this,i=0,u=this.listviewData.visibleColumns;i<u.length;i++)o=u[i],f(o)},r.prototype.handleComboboxDependenceCells=function(){for(var s,t,h=this,i,r,u,f,e=0,o=this.listviewData.visibleColumns;e<o.length;e++)(s=o[e],t=(r=(i=s.columnInfo)===null||i===void 0?void 0:i.TemplateCell)===null||r===void 0?void 0:r.Element,((u=t===null||t===void 0?void 0:t.CellType)===null||u===void 0?void 0:u.$type)==="Forguncy.DropDownListCellType, ServerDesignerCommon")&&n.DependenceCellValueChangeHelper.listenFormulaRefChanged((f=t===null||t===void 0?void 0:t.CellType)===null||f===void 0?void 0:f.QueryConditionDependenceFormulas,function(){h.cacheComboboxText()},this.runTimePageName)},r.prototype.onWindowResized=function(t){var e,s,f,r,c,h,l;if(t===void 0&&(t=!1),this._stretchHelper.cacheWidth(),t){var i=this.listviewData.metadata,u=!1,o=n.ForguncyData.getPageLayout(this.locatedPageID,this.runTimePageName);if(i.Columns.forEach(function(n){var r=n.TemplateCell.Element,i=r.Layout,t;i&&(n.IsHiddenByColumnOptions||n.IsHiddenByJavaScriptAPI||(t=o.getColumnWidth(i.Column,i.ColumnSpan),n.OriginalWidth!==t&&(n.IgnoreHidden||(n.Width=t,n.IsHiddenByLayout=t<=0,n.OriginalWidth=t,u=!0))))}),s=o.getRowHeight(i.TemplateRowIndex,1),s!==i.TemplateRowHeight&&(i.TemplateRowHeight=s,u=!0),f=(e=i.ColumnHeaderHeights)===null||e===void 0?void 0:e.length,f)for(r=0;r<f;r++)c=i.TemplateRowIndex-f+r,h=o.getRowHeight(c,1),h!==i.ColumnHeaderHeights[r]&&(i.ColumnHeaderHeights[r]=h,u=!0);if(u){n.ColumnOptionsListviewMetadataHelper.recalcHeaderCellsColumnSpan(i);l=new n.ListviewData(i,this.runTimePageName,this.designerPageName,this.listviewData.uniqueIndex,!0);this.resetListviewData(l,!0);this.cacheListviewStatusWhenColumnWidthChanged();return}}this.listviewData.visibleColumns.length>0&&this._stretchHelper.stretch(!0)},r.prototype.updateRowHeaderWidth=function(n){this._rowHeaderWidth=n},r.prototype.updateRowHeaderCheckBoxWidth=function(n){this._rowHeaderCheckBoxWidth=n},r.prototype.modifyInternalMethod=function(){var t="";t="Command_CLIPBOARD_PASTE_execute";r.OriginalSpreadJSMethod[t]||(r.OriginalSpreadJSMethod[t]=GC.Spread.Sheets.Commands.clipboardPaste.execute,function(t){GC.Spread.Sheets.Commands.clipboardPaste.execute=function(){for(var o,e,i,u=[],f=0;f<arguments.length;f++)u[f]=arguments[f];o=u[0];e=u[1];r.isListviewWorkbook(o)&&(i=n.ListviewBase.getListviewByCalcSheetName(o.name),i&&(i._rangeChangedManager.isPasteInternal=!!(e.fromSheet&&e.fromRanges)),e.pasteOption=GC.Spread.Sheets.ClipboardPasteOptions.values);try{r.OriginalSpreadJSMethod[t].apply(this,u)}finally{i===null||i===void 0?void 0:i._rangeChangedManager.resumeCalc()}}}(t));t="Command_EDIT_CELL_execute";r.OriginalSpreadJSMethod[t]||(r.OriginalSpreadJSMethod[t]=GC.Spread.Sheets.Commands.editCell.execute,function(t){GC.Spread.Sheets.Commands.editCell.execute=function(){for(var e,i,o,s,u=[],f=0;f<arguments.length;f++)u[f]=arguments[f];e=u[0];i=u[1];r.isListviewWorkbook(e)&&(i.autoFormat=!1,e instanceof GC.Spread.Sheets.Workbook&&(o=e.getActiveSheet(),o&&(s=o.getCellType(i.row,i.col),s instanceof n.CheckBoxCellTypeListView&&(i.newValue=n.CheckBoxCellTypeListView.convertValue(i.newValue)))));r.OriginalSpreadJSMethod[t].apply(this,u)}}(t));t="Command_CLEAR_execute";r.OriginalSpreadJSMethod[t]||(r.OriginalSpreadJSMethod[t]=GC.Spread.Sheets.Commands.clear.execute,function(t){GC.Spread.Sheets.Commands.clear.execute=function(){for(var e,i,f=[],u=0;u<arguments.length;u++)f[u]=arguments[u];if(e=f[0],i=r.isListviewWorkbook(e)?n.ListviewBase.getListviewByCalcSheetName(e.name):null,i&&!i._sheet.isEditing())i._rangeChangedManager.onRangeChangeOperationBegin(GC.Spread.Sheets.RangeChangedAction.clear);if(r.OriginalSpreadJSMethod[t].apply(this,f),i&&!i._sheet.isEditing())i._rangeChangedManager.onRangeChangeOperationCompleted(!1)}}(t));t="Command_CANCEL_INPUT_execute";r.OriginalSpreadJSMethod[t]||(r.OriginalSpreadJSMethod[t]=GC.Spread.Sheets.Commands.cancelInput.execute,function(t){GC.Spread.Sheets.Commands.cancelInput.execute=function(){for(var e,i,f=[],u=0;u<arguments.length;u++)f[u]=arguments[u];e=f[0];i=r.isListviewWorkbook(e)?n.ListviewBase.getListviewByCalcSheetName(e.name):null;i&&(i._cancelInput=!0);r.OriginalSpreadJSMethod[t].apply(this,f);i&&(i._cancelInput=!1)}}(t))},r.prototype.initSpread=function(t){this._divContainer=this._initDIVContainer(t);GC.Spread.Sheets.CellTypes.Corner=n.MutiCheckCornerCellType;this._spread=new GC.Spread.Sheets.Workbook(this._divContainer.childNodes[0],{sheetCount:1});this._spread.suspendPaint();this.intSpreadSettings(this._spread);this._sheet=this._spread.getActiveSheet();this.initSheetSettings(this._sheet);this.onColumnWidthOrColumnCountChanged();this._stretchHelper.stretchWithoutSuspendPaint(!1);this.refreshUI();this.initFocusBehavior();this._spread.resumePaint()},r.prototype.getFormulaListRowInfo=function(){var n;return n={},n[this.getCalcSheetName()]=this.activeRowIndexInDataArea,n},r.prototype.initStretchInfo=function(){this.canHorizontallyStretch=!1;this.canVerticallyStretch=!1;var t=this._getPageStretchInfo(),i=this._getPageLayout();t&&(this.canHorizontallyStretch=n.Presentation.StretchCommon.canHorizontallyStretch(t.StretchMode)||i.possibleStretchInColumns(this.layout),this.canVerticallyStretch=n.Presentation.StretchCommon.canVerticallyStretch(t.StretchMode)||i.possibleStretchInRows(this.layout));this._stretchHelper=new n.ListViewHelper.StretchHelper(this);this._stretchHelper.cacheWidth()},Object.defineProperty(r.prototype,"canStretch",{get:function(){return this.canHorizontallyStretch||this.canVerticallyStretch},enumerable:!1,configurable:!0}),r.prototype.onStretch=function(n,i){this.hideDeleteButton();this.canVerticallyStretch&&this.updateLoadedOnDemandCriticalRowIndex();this.changeHorizontalBarVisible(n.showHScrollBar);this.changeVerticalBarVisible(n.showVScrollbar);i&&(this.refresh(),this.refreshUI(new t(-1,-1,!1)))},Object.defineProperty(r.prototype,"hasVisibleColumn",{get:function(){var n=this.listviewData.visibleColumns;return n&&n.length>0},enumerable:!1,configurable:!0}),r.prototype._generateSpreadDiv=function(){var i="100%",r="100%",t=$("<div class='spreadDiv'/>"),n;return t.css("width",i),t.css("height",r),t.css("position","absolute"),n=$("<div class='spreadDiv'/>"),n.css("width",i),n.css("height",r),n.css("position","absolute"),n.css("top","0.5px"),n.css("left","0.5px"),t.append(n),t},r.prototype._initDIVContainer=function(n){if(this.hasVisibleColumn){var t=this._generateSpreadDiv();n.appendChild(t[0]);n=t[0]}return n},r.prototype.intSpreadSettings=function(n){n.name=this.getCalcSheetName();n.options.allowUserEditFormula=!1;n.options.scrollbarMaxAlign=!0;n.options.backColor="transparent";n.options.grayAreaBackColor=this.getGrayAreaBackColor();n.options.tabStripVisible=!1;n.options.allowUserDragDrop=this.listviewData.canUserDragDrop();n.options.allowUserDragFill=this.listviewData.canUserDragFill();n.options.showHorizontalScrollbar=!1;n.options.showVerticalScrollbar=!1;n.options.showDragFillSmartTag=!1;n.options.autoFitType=GC.Spread.Sheets.AutoFitType.cellWithHeader;n.options.hideSelection=this.listviewData.hideSelectionWhenLostFocus();n.options.defaultDragFillType=GC.Spread.Sheets.Fill.AutoFillType.fillWithoutFormatting;n.options.allowUserZoom=!1;n.options.allowExtendPasteRange=!0;n.options.copyPasteHeaderOptions=GC.Spread.Sheets.CopyPasteHeaderOptions.noHeaders;n.options.allowCopyPasteExcelStyle=!1;n.options.allowUndo=!1;n.options.allowAutoCreateHyperlink=!1;n.options.scrollbarAppearance=this.getScrollbarAppearance();n.options.numbersFitMode=1;n.options.allowDragHeaderToMove=this.allowDragHeaderToMove();n.options.showDragDropTip=!1;this.initTouchToolStripItems();this.initSpreadContextMenu()},r.prototype.allowDragHeaderToMove=function(){return this.listviewData.metadata.AllowDragHeaderToMoveColumn?GC.Spread.Sheets.AllowDragHeaderToMove.column:GC.Spread.Sheets.AllowDragHeaderToMove.none},r.prototype.getScrollbarAppearance=function(){return this.listviewData.metadata.UseSimpleBar?GC.Spread.Sheets.ScrollbarAppearance.mobile:GC.Spread.Sheets.ScrollbarAppearance.skin},r.prototype.initSpreadContextMenu=function(){this.listviewData.isRowHeaderContextMenuVisible()?this._spread.contextMenu=new n.SpreadContextMenu(this,r.getCanvas(this.getCalcSheetName())):this._spread.options.allowContextMenu=!1},r.prototype.initSheetSettings=function(){var t,i,r,u,f;this._sheet.frozenColumnCount(this.listviewData.getFrozenIndex());this._sheet.frozenTrailingColumnCount(this.listviewData.getFrozenIndexEnd());this._sheet.options.frozenlineColor=this.listviewData.getFrozenLineColor();this._sheet.options.allowCellOverflow=!1;this._sheet.selectionUnit(this.getSelecionUnit());this._sheet.options.selectionBackColor=this.getSelectionBackColor();this._sheet.options.selectionBorderColor=this.getSelectionBorderColor();this._sheet.defaults.rowHeight=this.getDefaultRowHeight();this._sheet.options.gridline.showHorizontalGridline=!!((t=this.listViewStyleTemplate)===null||t===void 0?void 0:t.ShowHorizontalGridLine);this._sheet.options.gridline.showVerticalGridline=!!((i=this.listViewStyleTemplate)===null||i===void 0?void 0:i.ShowVerticalGridLine);this._sheet.options.gridline.color=(u=n.ColorHelper.Convert((r=this.listViewStyleTemplate)===null||r===void 0?void 0:r.GridLineColor))!==null&&u!==void 0?u:"#d4d4d4";this._sheet.options.clipBoardOptions=GC.Spread.Sheets.ClipboardPasteOptions.values;this._sheet.autoGenerateColumns=!1;this.listviewData.isSingleSelection()?this._sheet.selectionPolicy(GC.Spread.Sheets.SelectionPolicy.single):this.initSheetSettings_isCtrlPressed();this._initSheetCommand();f=this.listviewData.visibleColumns.length;this._sheet.setColumnCount(f);this._sheet.setRowCount(0);this.clearSelectionIfDisableAutoSelectRow();this.allowShowTotalRow()&&(this.listviewData.getIsTotalRowAtFirstRow()?this._sheet.frozenRowCount(1):this._sheet.frozenTrailingRowCount(1));this._initRowHeader();this._initColumnHeader();this.initColumnsBindingInfo();this.initColumnsStyle();this.setSheetTag()},r.prototype.initSheetSettings_isCtrlPressed=function(){this._orginal_isCtrlPressed=this._sheet.isCtrlPressed;this._orginal_deselectIgnoreSpan=this._sheet.deselectIgnoreSpan;this.shouldCtrlPressed()?(this._sheet.isCtrlPressed=function(n){return n===GC.Spread.Sheets.SheetArea.rowHeader||n===GC.Spread.Sheets.SheetArea.viewport},this._sheet.deselectIgnoreSpan=function(){return!0}):(this._sheet.isCtrlPressed=this._orginal_isCtrlPressed,this._sheet.deselectIgnoreSpan=this._orginal_deselectIgnoreSpan)},r.prototype.shouldCtrlPressed=function(){return this.listviewData.getSelectionMode()===1&&!this.listviewData.canEdit()&&this.listviewData.isRowHeaderCheckBoxVisible()},r.prototype.getSelectionBackColor=function(){var t=this.listviewData.getSelectionBackColor();return!!t&&t!=="rgba(20,20,20,0.2)"?t:this.listViewStyleTemplate?this.listViewStyleTemplate.SelectBack?n.ColorHelper.Convert(this.listViewStyleTemplate.SelectBack):"transparent":null},r.prototype.getDefaultRowHeight=function(){return this.listviewData.getTemplateRowHeight()},r.prototype.getColumnHeaderHeight=function(){return this.listviewData.getColumnHeaderHeight()},r.prototype.getSelectionBorderColor=function(){var t=this.listviewData.getSelectionBorderColor();return!!t&&t!=="#217346"?t:this.listViewStyleTemplate?this.listViewStyleTemplate.SelectBorder?n.ColorHelper.Convert(this.listViewStyleTemplate.SelectBorder):"transparent":null},r.prototype.getGrayAreaBackColor=function(){var t,i=this.listviewData.getGrayAreaBackColor();return!!i&&i!=="transparent"?i:((t=this.listViewStyleTemplate)===null||t===void 0?void 0:t.GrayAreaBack)?n.ColorHelper.Convert(this.listViewStyleTemplate.GrayAreaBack):"transparent"},r.prototype.setSheetTag=function(){this._sheet.tag({ListviewCalcSheetName:this.getCalcSheetName(),ListViewStyleTemplate:this.listViewStyleTemplate})},r.isListviewWorkbook=function(n){var t,i=(t=n===null||n===void 0?void 0:n.getActiveSheet())===null||t===void 0?void 0:t.tag();return!!(i===null||i===void 0?void 0:i.ListviewCalcSheetName)},r.prototype.resetSpreadSetting=function(){this._spread.options.allowUserDragDrop=this.listviewData.canUserDragDrop();this._spread.options.allowUserDragFill=this.listviewData.canUserDragFill()},r.prototype.resetSheetSetting=function(){this._sheet=this._spread.getActiveSheet();this._sheet.defaults.rowHeight=this.listviewData.getTemplateRowHeight();this._sheet.setRowCount(0);this.initSheetSettings_isCtrlPressed();this._initSheetCommand_ShortcutKey();var n=this.listviewData.visibleColumns.length;this._sheet.setColumnCount(n);this._initRowHeader();this._initColumnHeader();this.initColumnsBindingInfo();this.clearColumnHeaderSpans();this.initColumnsStyle();this.onColumnWidthOrColumnCountChanged()},r.prototype._initColumnHeader=function(){var i=this,u=GC.Spread.Sheets.SheetArea.colHeader,r,f,t;if(this.listviewData.isColumnHeaderVisible()){for(r=this.getColumnHeaderHeight(),f=r.length,this._sheet.setRowCount(f,u),this._colHeaderHeight=0,t=0;t<f;t++)this._colHeaderHeight+=r[t],this._sheet.setRowHeight(t,r[t],u),this._sheet.setRowResizable(t,!1,u);this._colHeaderCellIDDic=this.getcolHeaderCellIDDic();this._onNormalCellValueChangedEventHandler=function(t,r){i._colHeaderCellIDDic[r.id]&&n.DelayRefresh.Push(i,function(){i.hasDestroyed()||i.resetColumnHeaderText()},"repaintColHeader"+i.getCalcSheetName())};n.ForguncyData.pageInfo.dataModel.normalCellDataModel.bind("valuechanged",null,this._onNormalCellValueChangedEventHandler);this.resetColumnHeaderText()}else this._colHeaderHeight=0,this._sheet.options.colHeaderVisible=!1;this._sheet.options.colHeaderAutoText=GC.Spread.Sheets.HeaderAutoText.blank},r.prototype.getColHeaderHeight=function(){return this._colHeaderHeight},r.prototype.getcolHeaderCellIDDic=function(){var u={},i=this.listviewData.visibleColumns,r,t,e,o;if(!i||i.length<=0)return u;var f=this.getRangeInfo(),s=GC.Spread.Sheets.SheetArea.colHeader,h=this._sheet.getRowCount(s);for(r=0;r<h;r++)for(t=0;t<i.length;t++)e=this.getHeaderCellIDSuffix(i[t].columnInfo.IsExternal),o=n.Common.getIdStr(f.Row+r,f.Column+i[t].getColumnIndex(),e),u[o]={Row:r,Column:t};return u},r.prototype.resetColumnHeaderText=function(){var i,t,r;this._sheet.suspendPaint();for(i in this._colHeaderCellIDDic)t=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(i),t=n.Common.IsEmpty(t)?"":t,r=this._colHeaderCellIDDic[i],this._sheet.setValue(r.Row,r.Column,t,GC.Spread.Sheets.SheetArea.colHeader);this._sheet.resumePaint()},r.prototype.autoFitRowHeight=function(){for(var t=this._sheet.getRowCount(GC.Spread.Sheets.SheetArea.viewport),n=0;n<t;n++)this._sheet.autoFitRow(n);this._restartEdit()},r.prototype.autoFitColumnWidth=function(){for(var t=this._sheet.getColumnCount(GC.Spread.Sheets.SheetArea.viewport),n=0;n<t;n++)this._sheet.autoFitColumn(n),this._columnAutoWidths[n]=this._sheet.getColumnWidth(n);this._restartEdit()},r.prototype._restartEdit=function(){var t=this;n.DelayRefresh.setTimeout(function(){t._sheet.isEditing()&&(t._sheet.endEdit(),t._sheet.startEdit())})},r.prototype._initRowHeader=function(){var i=GC.Spread.Sheets.SheetArea.rowHeader,u=0,f,t,e,r;for(this.listviewData.isRowHeaderVisible()?(++u,this._rowHeaderWidth=this.listviewData.rowHeaderColumnInfo.columnInfo.Width,this._sheet.setColumnWidth(0,this._rowHeaderWidth,i),t=this.initRowHeaderStyle(),this._sheet.setCellType(-1,0,new n.SpreadJSRowHeaderCellType(this,this.getCalcSheetName(),t===null||t===void 0?void 0:t.foreColor),i)):this._rowHeaderWidth=0,this.listviewData.isRowHeaderCheckBoxVisible()?(++u,this._sheet.setColumnCount(u,i),r=this.listviewData.rowHeaderCheckBoxColumnIndex,f=this.listviewData.rowHeaderCheckBoxColumnInfo.columnInfo.Width,this._sheet.setColumnWidth(r,f,i),this._rowHeaderCheckBoxWidth=f,t=this.createHeaderStyle(this.listviewData.rowHeaderCheckBoxColumnInfo.columnInfo.TemplateCell,n.HeaderType.CheckBoxRowHeader),t&&(t.hAlign=GC.Spread.Sheets.HorizontalAlign.center,t.vAlign=GC.Spread.Sheets.VerticalAlign.center,t.textDecoration=GC.Spread.Sheets.TextDecorationType.none,this._sheet.setStyle(-1,r,t,i)),this._sheet.setCellType(-1,r,new n.CheckBoxRowHeader(this,this.getCalcSheetName()),i),this._sheet.options.rowHeaderAutoTextIndex=0):this._rowHeaderCheckBoxWidth=0,u===0&&(this._sheet.options.rowHeaderVisible=!1),this._sheet.options.rowHeaderAutoText=this.listviewData.isRowHeaderFillNumber()?GC.Spread.Sheets.HeaderAutoText.numbers:GC.Spread.Sheets.HeaderAutoText.blank,e=this._sheet.getColumnCount(i),r=0;r<e;r++)this._sheet.setColumnResizable(r,!1,i)},r.prototype._initSheetCommand=function(){var t=this,i=this._spread.commandManager();i.register("SelectAll",function(){t._sheet.isEditing()||(n.ListViewHelper.SelectionHelper.selectAllRows(t),t.onSelectionChanged())},GC.Spread.Commands.Key.a,!0,!1,!1,!1);i.register("PressF2EnterEditMode",{execute:function(){return t.listviewData.canEdit()&&t._sheet.startEdit()}},113);this._initSheetCommand_ShortcutKey();this.supportMoveActiveCellHorizontallyByEnter();this.supportMoveFocusByEnter()},r.prototype._initSheetCommand_ShortcutKey=function(){var t=n.Platform.isMac(),i=!t,r=t;this.listviewData.canEdit()?(this._spread.commandManager().setShortcutKey("clear",GC.Spread.Commands.Key.del,!1,!1,!1,!1),this._spread.commandManager().setShortcutKey("paste",GC.Spread.Commands.Key.v,i,!1,!1,r)):(this._spread.commandManager().setShortcutKey(null,GC.Spread.Commands.Key.del,!1,!1,!1,!1),this._spread.commandManager().setShortcutKey(null,GC.Spread.Commands.Key.v,i,!1,!1,r))},r.prototype.supportMoveFocusByEnter=function(){var t=this;n.ForguncyData.pageInfo.moveFocusByEnter&&(this._spread.commandManager().register("EnterHit",function(){var i=t._sheet,r;if(!i.isEditing()&&(r=t.listviewData.getMoveFocusHorizontally()?i.getActiveRowIndex()===i.getRowCount()-1&&i.getActiveColumnIndex()===i.getColumnCount()-1:i.getActiveRowIndex()===i.getRowCount()-1,r))return i.getParent().focus(!1),n.FocusMoveHelper.MoveFocusToNextControl(t.getGcSheetFocusElementForTab()),!0},GC.Spread.Commands.Key.enter,!1,!1,!1,!1),this._spread.commandManager().register("ShiftEnterHit",function(){var i=t._sheet,r;return r=t.listviewData.getMoveFocusHorizontally()?i.getActiveRowIndex()===0&&i.getActiveColumnIndex()===0:i.getActiveRowIndex()===0,r?(i.getParent().focus(!1),n.FocusMoveHelper.MoveFocusToPreviousControl(t.getGcSheetFocusElementForTab()),!0):void 0},GC.Spread.Commands.Key.enter,!1,!0,!1,!1))},r.prototype.supportMoveActiveCellHorizontallyByEnter=function(){this.listviewData.getMoveFocusHorizontally()&&(this._spread.commandManager().setShortcutKey("moveToNextCell",GC.Spread.Commands.Key.enter,!1,!1,!1,!1),this._spread.commandManager().setShortcutKey("moveToPreviousCell",GC.Spread.Commands.Key.enter,!1,!0,!1,!1))},r.prototype.getGcSheetFocusElementForTab=function(){return this.getContainerDiv().find("[gcuielement=gcSheetFocusElementForTab]")[0]},r.prototype.initTouchToolStripItems=function(){var t;if(n.Platform.isMobile()&&this._spread.bind(GC.Spread.Sheets.Events.TouchToolStripOpening,function(n,t){t.handled=!0}),t=this._spread.touchToolStrip,t)this.listviewData.canUserDragFill()||(t.remove("wijspread_toolstrip_autofill0"),t.remove("separator0")),this.listviewData.canEdit()||(t.remove("wijspread_toolstrip_cut0"),t.remove("wijspread_toolstrip_paste0"))},r.prototype.initColumnsStyle=function(){for(var n,i,r,u,f=this.listviewData.visibleColumns,e=f.length,t=0;t<e;t++){if(n=f[t],n.columnInfo.HeaderCell)for(i=0,r=n.columnInfo.HeaderCell;i<r.length;i++)u=r[i],this.initColumnHeaderStyle(u.Row,t,u);this.initColumnStyle(t,n.columnInfo.TemplateCell,n.canEnterEditMode);this.initCellType(t,n,n.getTemplateCell())}},r.prototype.initColumnsBindingInfo=function(){var n=this;this.listviewData.visibleColumns.forEach(function(t,i){n._sheet.bindColumn(i,{name:t.getUniqueName(),size:t.columnInfo.Width})})},r.prototype.initFocusBehavior=function(){this._spread.commandManager().setShortcutKey("moveToNextCellThenControl",GC.Spread.Commands.Key.tab,!1,!1,!1,!1);this._spread.commandManager().setShortcutKey("moveToPreviousCellThenControl",GC.Spread.Commands.Key.tab,!1,!0,!1,!1);this.listviewData.getAllowGetFocus()||this.setTabIndex(-1)},r.prototype.getSelecionUnit=function(){return this.listviewData.getSelectionMode()===1?GC.Spread.Sheets.SelectionUnit.row:GC.Spread.Sheets.SelectionUnit.cell},r.prototype.initColumnStyle=function(n,t,i){var f,e,o,u;i===void 0&&(i=!1);u=(f=r.createStyleByCell(t,i))!==null&&f!==void 0?f:new GC.Spread.Sheets.Style;((o=(e=t===null||t===void 0?void 0:t.Element)===null||e===void 0?void 0:e.CellType)===null||o===void 0?void 0:o.$type)==="Forguncy.MultilineTextBox, ServerDesignerCommon"&&i&&(u.formatter="@");u.showEllipsis=this.showEllipsis(t);this.listviewData.canEdit()&&this.listviewData.getMoveFocusOnlyEditableCell()&&(u.tabStop=i);this._sheet.setStyle(-1,n,u)},r.prototype.showEllipsis=function(t){var r,i=(r=t===null||t===void 0?void 0:t.Element)===null||r===void 0?void 0:r.CellType;return(i===null||i===void 0?void 0:i.$type)==="Forguncy.ImageCellType, ServerDesignerCommon"&&!n.Common.IsEmpty(i.ToolTip)?!1:!0},r.prototype.initColumnInputMessageFromDataValidation=function(){var t=this,r=this.mappedRowIndexFromData(0),i=this.getEditorRowCount();i!==0&&this.listviewData.visibleColumns.forEach(function(u,f){var s,h,e=(h=(s=u.columnInfo.TemplateCell)===null||s===void 0?void 0:s.Element)===null||h===void 0?void 0:h.DataValidation,o;(e===null||e===void 0?void 0:e.ShowInputMessageWhenCellIsSelected)&&(o=GC.Spread.Sheets.DataValidation.createNumberValidator(GC.Spread.Sheets.ConditionalFormatting.ComparisonOperators.equalsTo,null,null,!0),o.showInputMessage(!0),o.inputMessage(n.Common.IsEmpty(e.InputMessage)?"":n.Common.getMultiLanguageWord(e.InputMessage)),o.inputTitle(n.Common.IsEmpty(e.InputMessageTitle)?"":n.Common.getMultiLanguageWord(e.InputMessageTitle)),o.type(GC.Spread.Sheets.DataValidation.CriteriaType.anyValue),t._sheet.setDataValidator(-1,f,null),t._sheet.setDataValidator(r,f,i,1,o))})},r.prototype.initColumnHeaderStyle=function(t,i,r){var o,s,e=this.createHeaderStyle(r,n.HeaderType.ColumnHeader),u,f;e&&(i>0&&(u=this._sheet.getStyle(t,i-1,GC.Spread.Sheets.SheetArea.colHeader),((o=u===null||u===void 0?void 0:u.borderRight)===null||o===void 0?void 0:o.color)&&!n.ColorHelper.isTransparent(u.borderRight.color)&&delete e.borderLeft),t>0&&(f=this._sheet.getStyle(t-1,i,GC.Spread.Sheets.SheetArea.colHeader),((s=f===null||f===void 0?void 0:f.borderBottom)===null||s===void 0?void 0:s.color)&&!n.ColorHelper.isTransparent(f.borderBottom.color)&&delete e.borderTop),this._sheet.setStyle(t,i,e,GC.Spread.Sheets.SheetArea.colHeader));r&&(r.RowSpan>1||r.ColumnSpan>1)&&this._sheet.addSpan(t,i,r.RowSpan,r.ColumnSpan,GC.Spread.Sheets.SheetArea.colHeader)},r.prototype.clearColumnHeaderSpans=function(){var n=this,t=this._sheet.getSpans(new GC.Spread.Sheets.Range(-1,-1,-1,-1),GC.Spread.Sheets.SheetArea.colHeader);t.forEach(function(t){n._sheet.removeSpan(t.row,t.col,GC.Spread.Sheets.SheetArea.colHeader)})},r.createStyleByCell=function(t,i){var f,u,r;return(i===void 0&&(i=!1),!t)?null:(u=((f=t.Element)===null||f===void 0?void 0:f.StyleInfo)?n.Common.clone(t.Element.StyleInfo):{},u.BorderBottom=t.BorderBottom,u.BorderRight=t.BorderRight,r=n.ListViewHelper.SpreadJSStyleHelper.generateStyleObject(u),!n.Common.IsEmpty(r.formatter)&&r.formatter!=="@"&&i&&(r.formatter=null),r)},r.prototype.initCellType=function(t,i,r){var u=n.SpreadJSCellTypeHelper.getColumnCellType(this,i,r);this._sheet.setCellType(-1,t,u);this.initCellTypeOfColumnHeader(t,i)},r.prototype.initCellTypeOfColumnHeader=function(t,i){for(var r,e,f,s=this.listviewData.getColumnOperation(),h=s===1,c=this.shouldUseFilterHeaderCellType(i),o=[],l=this._sheet.getRowCount(GC.Spread.Sheets.SheetArea.colHeader),u=l-1;u>=0;u--)(r=this._sheet.getSpans(new GC.Spread.Sheets.Range(u,t,1,1),GC.Spread.Sheets.SheetArea.colHeader),r.length!==1||r[0].row===u&&r[0].col===t)&&(e=!r||r.length===0||r[0].colCount===1,f=null,h&&e?f=new n.SpreadJSSortHeaderCellType(this,this.getCalcSheetName(),i.getColumnIndex()):c&&e&&o[t]!==!0?(o[t]=!0,f=new n.SpreadJSFilterHeaderCellType(this,this.getCalcSheetName(),i.getColumnIndex())):f=new n.SpreadJSColumnHeaderCellType(this,this.getCalcSheetName(),i.getColumnIndex()),this._sheet.setCellType(u,t,f,GC.Spread.Sheets.SheetArea.colHeader))},r.prototype.shouldUseFilterHeaderCellType=function(t){var i,r;return!t.allowFieldSort()&&!t.allowNoFieldSort()?!1:(i=this.listviewData.getColumnOperation(),i!==2)?!1:t.allowFieldSort()?(r=t.columnInfo.BindingColumnDataType,!n.Common.IsEmpty(t.getFilterActualBindingInfo())&&n.SpreadJSFilterHeaderCellType.supportedTypes.indexOf(r)>=0):this.allowNoFieldSortFilter(t)?!0:!1},r.prototype.onDataLoaded=function(){this._sheet.suspendPaint();try{this.resetColumnHeaderCellType()}finally{this._sheet.resumePaint()}},r.prototype.resetColumnHeaderCellType=function(){var n=this;this.listviewData.getColumnOperation()===2&&this.listviewData.visibleColumns.forEach(function(t,i){return n.initCellTypeOfColumnHeader(i,t)})},r.prototype.onCurrentRowChanged=function(n,t){t===void 0&&(t=!0);i.prototype.onCurrentRowChanged.call(this,n,t);this.onSelectionChanged(!1)},r.prototype.onSelectionChanged=function(n){var t;if(n===void 0&&(n=!0),((t=this._rangeChangedManager.rangeChangedInfo)===null||t===void 0?void 0:t.handled)!==!1){if(n)this.onCurrentRowChanged(this.getMappedEditorSelectedRowIndex());this.operationTypeWhenValueChanged===0&&(this.getAlwaysReservedSelections()&&this.cacheManager.save(this.getSelectedRowsIndexes()),this.triggerSelectedRowsChangedEvent())}},r.prototype.clearSelectedRowByDataID=function(n){var t=this;this.getAlwaysReservedSelections()?this.cacheManager.clearByDataID(n,function(){return t.afterClearSelectInCache()}):this.getSelectedRowsIndexes().forEach(function(i){t._listData.getDataID(i)===n&&t.clearSelectedRow(i)})},r.prototype.clearSelectedRowByQuery=function(t){var i=this;this.getAlwaysReservedSelections()?this.cacheManager.clearByQuery(t,function(){return i.afterClearSelectInCache()}):this.getSelectedRowsIndexes().forEach(function(r){n.Common.isQueryEqual(i._listData.getRowQuery(r),t)&&i.clearSelectedRow(r)})},r.prototype.afterClearSelectInCache=function(){var i=this,t;this.listviewData.getSelectionMode()===1&&this.getSelectedRowsIndexes().length<=1&&(this.cacheManager.reset(),this.listviewData.getDisableAutoSelectRow()||(t=this._listData.getCurrentRowIndex(),t>=0&&t<this._listData.getRowCount()?this.cacheManager.save([t]):this.cacheManager.save([])));n.DelayRefresh.Push(this,function(){i.hasDestroyed()||(i.selectInEditorFromCache(),i.delayTriggerEvent(n.ListViewEvents.SelectedRowsChanged,{}))},"selectInEditorFromCache"+this.getCalcSheetName())},r.prototype.beforeRefeshUIWhenQueryDataFromServer=function(){if(this.getAlwaysReservedSelections()){if(this.cacheManager.reset(),this.listviewData.getSelectionMode()===1)if(this.listviewData.getDisableAutoSelectRow())this._sheet.clearSelection();else{var n=this._listData.getCurrentRowIndex();n>=0&&n<this._listData.getRowCount()?this.cacheManager.save([n]):this.cacheManager.save([])}}else this.clearSelectionIfDisableAutoSelectRow()},r.prototype.clearSelectionIfDisableAutoSelectRow=function(){this.listviewData.getDisableAutoSelectRow()&&this._sheet.clearSelection()},r.prototype.selectInEditorFromCache=function(){var t,i;for(this._sheet.suspendPaint(),t=0;t<this._listData.getRowCount();t++)i=this.mappedRowIndexFromData(t),this.cacheManager.exists(this.getCachedRowData(t))?n.ListViewHelper.SelectionHelper.addSelectedRow(this,i):n.ListViewHelper.SelectionHelper.clearSelectedRow(this,i);this._sheet.resumePaint();this.onSelectionChanged()},r.prototype.isSelectMultipleRows=function(n){return n.some(function(n){return n.colCount>1||n.rowCount>1||n.row===-1})},r.prototype.updateSelectedRowsAfterDeleteRow=function(){this.getAlwaysReservedSelections()&&(this.cacheManager.save(this.getSelectedRowsIndexes()),this.delayTriggerEvent(n.ListViewEvents.SelectedRowsChanged,{}))},r.prototype.bindSpreadEvent=function(){var i=this,t=this;t.listviewData.isDoubleClickCommandsExists()&&t._sheet.bind(GC.Spread.Sheets.Events.CellDoubleClick,function(r,u){var f;if(!t.listviewData.canEdit()){var e=u.row!==undefined&&u.row>=i.firstDataRowIndexInView&&u.row<=i.lastDataRowIndexInView,o=u.sheetArea===GC.Spread.Sheets.SheetArea.rowHeader,s=u.sheetArea===GC.Spread.Sheets.SheetArea.viewport;e&&(o||s)&&(f=t.listviewData.getDoubleClickCommands(),n.ForguncyData.commandExecutor.executeCommand(f,{runTimePageName:t.runTimePageName,commandTrigger:t,commandID:t.getListviewName(),eventType:"click",locationString:n.FormulaHelper.getListviewCellLogLocationString(u.row,null,null,i.getListviewName(),i.runTimePageName)}))}});t._sheet.bind(GC.Spread.Sheets.Events.SelectionChanging,function(n,i){if(t._sheet.selectionPolicy()===GC.Spread.Sheets.SelectionPolicy.single){var r=t.isSelectMultipleRows(i.newSelections);r&&(i.oldSelections.length>0?i.oldSelections.forEach(function(n){t._sheet.setSelection(n.row,n.col,n.rowCount,n.colCount)}):t._sheet.clearSelection())}});t._sheet.bind(GC.Spread.Sheets.Events.SelectionChanged,function(){t.onSelectionChanged()});t._sheet.bind(GC.Spread.Sheets.Events.EnterCell,function(i,r){t._rangeChangedManager.clearRangeChangedInfo();t.canEditInListview()&&t.getAlwaysInEditMode()&&t._sheet.startEdit(!0);t.repaintDropDownCell(r);n.DelayRefresh.setTimeout(function(){if(!t.hasDestroyed()){var n=t.operationTypeWhenValueChanged;try{t.operationTypeWhenValueChanged=1;t.onCurrentRowChanged(t.getMappedEditorSelectedRowIndex())}finally{t.operationTypeWhenValueChanged=n}}},200)});t._sheet.bind(GC.Spread.Sheets.Events.LeaveCell,function(n,i){if(t._rangeChangedManager.isSuspend){i.cancel=!0;return}t._rangeChangedManager.clearRangeChangedInfo();t.repaintDropDownCell(i)});t._sheet.bind(GC.Spread.Sheets.Events.ValueChanged,function(n,i){t.onValueChanged(i.row,i.col)});t._sheet.bind(GC.Spread.Sheets.Events.TopRowChanged,function(n,i){t.onTopRowChanged(i)});t._sheet.bind(GC.Spread.Sheets.Events.RowHeightChanged,function(){t.onRowHeightOrRowCountChanged()});t._sheet.bind(GC.Spread.Sheets.Events.ColumnWidthChanged,function(){t.onColumnWidthOrColumnCountChanged();t.cacheListviewStatusWhenColumnWidthChanged()});t._sheet.bind(GC.Spread.Sheets.Events.CellClick,function(i,r){if(r.sheetArea===GC.Spread.Sheets.SheetArea.viewport){n.ListViewHelper.SelectionHelper.isSelectAllRows(t._sheet)&&t._sheet.repaint();t.onCellClick(r.row,r.col);t.getAlwaysInEditMode()&&(n.Platform.isIpad()&&(t._cellClickCellLocation={Row:r.row,Column:r.col},setTimeout(function(){delete t._cellClickCellLocation})),t._sheet.startEdit())}});t._spread.bind(GC.Spread.Sheets.Events.ButtonClicked,function(n,i){t.onCellTypeClicked(i)});t._sheet.bind(GC.Spread.Sheets.Events.EditStarting,function(n,i){t.listviewData.canEdit()&&t.canCellEnterEditMode(i.row,i.col)||(i.cancel=!0)});t._sheet.bind(GC.Spread.Sheets.Events.EditEnding,function(i,r){var u,f,e;t._cancelInput||(e=t._sheet.getCellType(r.row,r.col),t.getAlwaysInEditMode()&&((u=t._cellClickCellLocation)===null||u===void 0?void 0:u.Row)===r.row&&((f=t._cellClickCellLocation)===null||f===void 0?void 0:f.Column)===r.col&&(r.cancel=!0),t.isNewLineRow(r.row)&&n.Common.IsEmpty(r.editingText))||e.validate&&!e.validate(r.row,r.col)&&(r.cancel=!0)});t._sheet.bind(GC.Spread.Sheets.Events.RangeChanged,function(n,i){t._rangeChangedManager.onRangeChanged(i)});t._sheet.bind(GC.Spread.Sheets.Events.ClipboardPasting,function(i,r){if(!t.listviewData.canEdit()){r.cancel=!0;return}if(!t.isValidPasteRange(r)){alert(n.RS.InvalidCopyPasteSize);r.cancel=!0;return}if(t.isRangeContainsTotalRow(r.cellRange.row,r.cellRange.row+1)){alert(n.RS.RangeOperationCannotInvolveTotalRow);r.cancel=!0;return}t.clearTotalRowCellTypeAndStyle();t._rangeChangedManager.onRangeChangeOperationBegin(GC.Spread.Sheets.RangeChangedAction.paste,!0)});t._sheet.bind(GC.Spread.Sheets.Events.ClipboardPasted,function(n,i){t.resetStyle(i.cellRange);t._rangeChangedManager.onRangeChangeOperationCompleted(i.cellRange.row===-1||i.cellRange.rowCount===-1)});t._sheet.bind(GC.Spread.Sheets.Events.DragDropBlock,function(i,r){if(r.insert){r.rowCount!==-1&&(r.cancel=!0);return}if(t.isRangeContainsTotalRow(r.fromRow,r.fromRow+r.rowCount)||t.isRangeContainsTotalRow(r.toRow,r.toRow+r.rowCount)){alert(n.RS.RangeOperationCannotInvolveTotalRow);r.cancel=!0;return}r.copyOption=GC.Spread.Sheets.CopyToOptions.value;t._rangeChangedManager.onRangeChangeOperationBegin(GC.Spread.Sheets.RangeChangedAction.dragDrop)});t._sheet.bind(GC.Spread.Sheets.Events.DragDropBlockCompleted,function(n,i){if(i.insert&&i.rowCount===-1)t.moveColumn(i.fromCol,i.toCol,i.colCount);else t._rangeChangedManager.onRangeChangeOperationCompleted(i.fromRow===-1||i.toRow===-1||i.rowCount===-1)});t._sheet.bind(GC.Spread.Sheets.Events.DragFillBlock,function(i,r){if(t.isRangeContainsTotalRow(r.fillRange.row,r.fillRange.row+r.fillRange.rowCount)){alert(n.RS.RangeOperationCannotInvolveTotalRow);r.cancel=!0;return}if(r.autoFillType!==GC.Spread.Sheets.Fill.AutoFillType.copyCells){var u=t._sheet.getSelections()[0],f=t.getCellIndexesBySelection(u),e=f.some(function(i){var r=t._sheet.getValue(i[0],i[1],GC.Spread.Sheets.SheetArea.viewport);return typeof r!="string"?!1:t.isForguncyUrl(r)?!0:n.Common.isForguncyFile(r)?t.isNumeric(r[0])||t.isNumeric(r[r.length-1]):void 0});e&&(r.autoFillType=GC.Spread.Sheets.Fill.AutoFillType.copyCells)}t._rangeChangedManager.onRangeChangeOperationBegin(GC.Spread.Sheets.RangeChangedAction.dragFill)});t._sheet.bind(GC.Spread.Sheets.Events.InvalidOperation,function(n,t){t.invalidType===GC.Spread.Sheets.InvalidOperationType.dragDrop&&alert(t.message)})},r.prototype.moveColumn=function(t,i,r){this.listviewData.moveColumn(t,i,r);this.listviewData.metadata.CacheListviewStatus?n.ListviewStatusCacheHelper.autoSaveMetadataCacheDataAsync(this,{columns:n.ListviewStatusCacheHelper.getCacheDataFromListviewMatadata(this.listviewData.metadata)}):n.ListviewMetadataHelper.save(this.listviewData.metadata,this.getLocationString());this._stretchHelper.cacheWidth();this._columnAutoWidths.length>0&&n.Common.moveItemInArray(t,i,r,this._columnAutoWidths);this.refreshAutoMerge(-1,-1)},r.prototype.isNumeric=function(n){return!isNaN(~~n)&&isFinite(n)},r.prototype.isForguncyUrl=function(t){if(t===null||t===void 0?void 0:t.startsWith(n.Helper.SpecialPath.getBaseUrl()))return!0},r.prototype.getCellIndexesBySelection=function(n){for(var t,r=[],i=Math.max(n.row,0);i<n.row+n.rowCount;i++)for(t=Math.max(n.col,0);t<n.col+n.colCount;t++)r.push([i,t]);return r},r.prototype.repaintDropDownCell=function(t){n.DelayRefresh.setTimeout(function(){var i=t.sheet.getCellType(t.row,t.col);i instanceof n.DropDownEditorCellType&&i.showDropdownButton===2&&t.sheet.repaint(t.sheet.getCellRect(t.row,t.col))})},r.prototype.resetStyle=function(n){for(var i,r=n.row===-1?0:n.row,f=n.rowCount===-1?this._sheet.getRowCount():n.rowCount,u=n.col===-1?0:n.col,e=n.colCount===-1?this._sheet.getColumnCount():n.colCount,t=r;t<r+f;t++)if(t!==this.totalRowIndex)for(i=u;i<u+e;i++)this._sheet.setStyle(t,i,null)},r.prototype.onCellTypeClicked=function(t){var u=this,i,r;if(!this.isProtected())if(i=this._sheet.getCellType(t.row,t.col,t.sheetArea),t.sheetArea===GC.Spread.Sheets.SheetArea.viewport){this.onCellClick(t.row,t.col);r=this.mappedRowIndexFrowView(t.row);this.triggerClickCommand(r,t.col)}else t.sheetArea===GC.Spread.Sheets.SheetArea.colHeader?i instanceof n.SpreadJSFilterHeaderCellType?this.tryCommitEdit()&&n.ColumnFilterHelper.showContextMenu(this,t):n.DelayRefresh.setTimeout(function(){u.sortByColumn(t.col)}):t.sheetArea===GC.Spread.Sheets.SheetArea.rowHeader&&i instanceof n.CheckBoxRowHeader?(this._rangeChangedManager.clearRangeChangedInfo(),this.changeSelectedRowsInRowHeader(t.row,t.col)):t.sheetArea===GC.Spread.Sheets.SheetArea.corner&&i instanceof GC.Spread.Sheets.CellTypes.Corner&&this.selectAllByCornerCell()},r.prototype.triggerClickCommand=function(t,i){var r=i,s=n.Common.getIdStr(t,r,this.getCalcSheetName()),h=this._listData.getRowCount(),c=this._listData.getColumnCount(),u,f,e,o;return t<0||t>=h||r<0||r>=c?!1:(u=this.listviewData.visibleColumns[r],f=u.getClickCommandsMetaData(),!f||f.length===0)?!1:(e=this._listData.getCurrentRowIndex(),e!==t&&this.selectRow(t),o=n.FormulaHelper.getListviewCellLogLocationString(t,r,u.getName(),this.getListviewName(),this.runTimePageName),n.ForguncyData.commandExecutor.executeCommand(f,{runTimePageName:this.runTimePageName,commandTrigger:this,commandID:s,eventType:"click",locationString:o,listViewInfo:{rowIndex:t,colIndex:r,columnName:u.getName(),listViewName:this.getListviewName(),pageName:this.runTimePageName}}),!0)},r.prototype.onCellClick=function(t,r){var u=this;i.prototype.onCellClick.call(this,t,r);this.shouldCancelSelectionOnCellClick(t)&&n.DelayRefresh.Push(null,function(){var n=u._sheet.getColumnCount(GC.Spread.Sheets.SheetArea.rowHeader)-1;u.changeSelectedRowsInRowHeader(t,n)},this.getCalcSheetName()+"_changeSelection")},r.prototype.shouldCancelSelectionOnCellClick=function(t){return this.shouldCtrlPressed()&&n.Platform.isMobile(!0)&&n.ListViewHelper.SelectionHelper.isRowSelected(this._sheet,t)},r.prototype.isValidPasteRange=function(n){return n.sheet.getColumnCount()<n.cellRange.col+n.cellRange.colCount?!1:!this.allowAddRow()&&n.cellRange.row+n.cellRange.rowCount>this.lastDataRowIndexInView+1?!1:!0},r.prototype.isRangeContainsTotalRow=function(n,t){if(this.allowShowTotalRow()){var i=this.totalRowIndex;if(i>=n&&i<t)return!0}return!1},r.prototype.onValueChanged=function(t,i){var f,o,s,h,c,l,a;if(this.canCellBeEdited(t,i)){var u=this.mappedRowIndexFrowView(t),e=this._listData.getRowCount(),r=this._sheet.getValue(t,i);if(this._sheet.getCellType(t,i)instanceof n.SpreadJSViewUploadImageCellType&&(o=n.ForguncyData.ForguncyRoot+"Upload/",n.Common.IsEmpty(r)||r.toString().indexOf(o)===-1||(s=r.toString(),h=s.lastIndexOf("?"),r=s.slice(o.length,h===-1?undefined:h))),((f=this._rangeChangedManager.rangeChangedInfo)===null||f===void 0?void 0:f.handled)===!1){if(u>=e){if(!this.allowAddRow())return;for(c=e;c<=u;c++)this.addNewRow([],!0,!0)}if(l=this.listviewData.getColIndexByVisibleColIndex(i),l===-1)return;if(this._rangeChangedManager.rangeChangedInfo.addChangedCell(t,i,this._listData.getValue(u,l)),this._rangeChangedManager.rangeChangedInfo.needParseValue){if(r instanceof Date&&(r=n.Convertor.fromDateToOADate(r)),a=n.ListviewEditorHelper.getCell(this.listviewData.visibleColumns[i].getTemplateCell(),this.runTimePageName,this.designerPageName,this.listviewData.getListviewName()),!a)return;r=a.cellType.getValueFromListviewText(r,!0);this._sheet.setValue(t,i,r)}}else if(u===e){this.onValueChangedInNewRow(t,i,r);return}this._onCellValueChanged(u,i,r,!0)}},r.prototype.canCellEnterEditMode=function(n,t){var r=this.mappedRowIndexFrowView(n),i;if(!(this.listviewData.visibleColumns[t].canEnterEditMode&&this._commitingRows.indexOf(r)===-1))return!1;if(this.listviewData.allowShowTotalRow())if(this.listviewData.getIsTotalRowAtFirstRow()){if(n===0)return!1}else if(n===this._sheet.getRowCount()-1)return!1;return(i=this._sheet.getSpans(new GC.Spread.Sheets.Range(n,t,1,1)),i&&i.length>0)?!1:!0},r.prototype.canCellBeEdited=function(n,t){return this.listviewData.visibleColumns[t].canEditInForguncy&&this._commitingRows.indexOf(this.mappedRowIndexFrowView(n))===-1},r.prototype.onValueChangedInNewRow=function(n,t,i){var u=this.listviewData.getColIndexByVisibleColIndex(t),r;if(u!==-1){if(this.shouldIgnoreValueChangedInNewRow(t,i)){this.setDataToSpreadJSNow();return}r=[];r[u]=i;this.addNewRow(r,!0,!0,6)}},r.prototype.shouldIgnoreValueChangedInNewRow=function(t,i){var r=this.listviewData.visibleColumns[t],u;if(r.cellType.constructor===n.PasswordCellType){if(u=r.getDefaultValue(this.getCalcSheetName(),this.runTimePageName,this._listData.getRowCount()),u===i)return!0}else if(r.cellType.constructor===n.CheckBoxCellType&&(u=r.getDefaultValue(this.getCalcSheetName(),this.runTimePageName,this._listData.getRowCount()),u===null&&i===0))return!0;return!1},r.prototype.hideSelection=function(n){if(arguments.length===0)return this._spread.options.hideSelection;this._spread.options.hideSelection=!!n},r.prototype.refresh=function(){this._spread.refresh()},r.prototype.getAllSelectedRowsOfView=function(){for(var n,l,t,r,u,a=this,s={},v=this._sheet.getSelections(),i=[],f=this.firstDataRowIndexInView,e=this.lastDataRowIndexInView,h=!1,o=0,c=v;o<c.length;o++)if(n=c[o],n.col===-1||n.colCount===-1){if(n.row===-1||n.rowCount===-1){h=!0;break}for(l=n.row+n.rowCount,t=n.row;t<l;t++)if(t<f||t>e)continue;else s[t]!==!0&&(i.push(t),s[t]=!0)}if(h)for(i=[],r=f;r<=e;r++)i.push(r);else i.length!==0||this.listviewData.isRowHeaderCheckBoxVisible()||this.listviewData.getDisableAutoSelectRow()||(u=this.mappedRowIndexFromData(this.getCurrentRowIndex()),u>=f&&u<=e&&i.push(u));return i.map(function(n){return a.mappedRowIndexFrowView(n)})},r.prototype.changeSelectedRowsInRowHeader=function(t,i){this.listviewData.isRowHeaderCheckBoxVisible()&&this.stopEditingActiveCell()&&(n.Common.IsEmpty(t)||n.Common.IsEmpty(i)||(n.ListViewHelper.SelectionHelper.isRowSelected(this._sheet,t)?n.ListViewHelper.SelectionHelper.clearSelectedRow(this,t):n.ListViewHelper.SelectionHelper.addSelectedRow(this,t),this.onSelectionChanged()))},r.prototype.selectAllByCornerCell=function(){this.listviewData.isRowHeaderCheckBoxVisible()&&this._sheet.getRowCount()!==0&&(n.ListViewHelper.SelectionHelper.isSelectAllRows(this._sheet)?n.ListViewHelper.SelectionHelper.clearAllSelectedRows(this):n.ListViewHelper.SelectionHelper.selectAllRows(this),this.onSelectionChanged())},r.prototype.onTopRowChanged=function(n){(this.hideDeleteButton(),this._loadedOnDemandCriticalRowIndex!==-1)&&n.newTopRow>=this._loadedOnDemandCriticalRowIndex&&this.loadOnDemand()},r.prototype.onRowHeightOrRowCountChanged=function(){this.updateLoadedOnDemandCriticalRowIndex();this.updateScrollbarVisibility()},r.prototype.updateLoadedOnDemandCriticalRowIndex=function(){var t,i,n;for(this._loadedOnDemandCriticalRowIndex=-1,t=this.viewportHeight,i=this._sheet.getRowCount(),n=i-1;n>=0;n--)if(t-=this._sheet.getRowHeight(n),t<0){this._loadedOnDemandCriticalRowIndex=n;break}},r.prototype.onColumnWidthOrColumnCountChanged=function(){this.updateScrollbarVisibility()},r.prototype.cacheListviewStatusWhenColumnWidthChanged=function(){var i=this,t=this.listviewData.metadata;t.CacheListviewStatus&&(t.AutoFitColumnWidth||(t.Columns.forEach(function(n){i.changeColumnMetadataWidthInfo(n)}),n.ListviewStatusCacheHelper.autoSaveMetadataCacheDataAsync(this,{columns:n.ListviewStatusCacheHelper.getCacheDataFromListviewMatadata(t)})))},r.prototype.getClonedListviewMetadataAfterAdjustColumnWidth=function(){var t=this,n=i.prototype.getClonedListviewMetadataAfterAdjustColumnWidth.call(this);return n.Columns.forEach(function(n){t.changeColumnMetadataWidthInfo(n)}),n},r.prototype.changeColumnMetadataWidthInfo=function(n){var r=this.listviewData.rowHeaderColumnInfo,t,i,u;if(r&&r.getColumnIndex()===n.Index){this.changeColumnMetadataWidthInfoInternal(n,this._rowHeaderWidth);return}if(t=this.listviewData.rowHeaderCheckBoxColumnInfo,t&&t.getColumnIndex()===n.Index){this.changeColumnMetadataWidthInfoInternal(n,this._rowHeaderCheckBoxWidth);return}(i=this.getVisibleColumnIndexInListViewByDataIndex(n.Index),i!==-1)&&(u=this.getColumnWidth(i),this.changeColumnMetadataWidthInfoInternal(n,u))},r.prototype.changeColumnMetadataWidthInfoInternal=function(n,t){t!=n.Width&&(n.Width=t);n.IsHiddenByUIResizeColumn=t<=0},r.prototype.updateScrollbarVisibility=function(){var t;t=this.canStretch?this._stretchHelper.getCurrntScrollbarVisibility():n.ListViewHelper.SpreadJSStyleHelper.needShowScrollbar(this._sheet,this.viewportWidth,this.viewportHeight);this.changeHorizontalBarVisible(t.showHScrollBar);this.changeVerticalBarVisible(t.showVScrollbar)},r.prototype.changeHorizontalBarVisible=function(n){this._spread.options.showHorizontalScrollbar=this.forceHideHorizontalScrollBar?!1:n},r.prototype.changeVerticalBarVisible=function(n){this._spread.options.showVerticalScrollbar=this.forceHideVerticalScrollBar?!1:n},Object.defineProperty(r.prototype,"viewportWidth",{get:function(){return $(this._divContainer).width()-this._rowHeaderWidth-this._rowHeaderCheckBoxWidth},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"viewportHeight",{get:function(){return $(this._divContainer).height()-this._colHeaderHeight},enumerable:!1,configurable:!0}),r.prototype._onValueChangedInDataModel=function(t){var f=this,i,r,u;if((n.FormulaColumnSortFilterHelper.updateDataCacheOnValueChanged(this,t),this.operationTypeWhenValueChanged!==1)&&((t.cellRange.ColumnCount!==1||t.cellRange.RowCount!==1)&&this.cacheComboboxText(),t.actionType===2&&n.Common.remove(this._waitValidateRows,t.deleteRow),this.triggerAPIValueChangedEvent([__assign({},t.cellRange)],t.newRowCount,t.oldRowCount),this.operationTypeWhenValueChanged!==2)&&(this.updateSelectedRowsCache(),n.DelayRefresh.NeedDelayRun===!0&&this.isFocused?(this.isWaitForRefresh=!0,n.DelayRefresh.setTimeout(function(){(f.isWaitForRefresh=!1,f.hasDestroyed())||f.refreshUI()},200)):this.refreshUI(),i=t.cellRange,t.uiAction&&i))for(r=i.Row;r<i.Row+i.RowCount;r++)for(u=i.Column;u<i.Column+i.ColumnCount;u++)this.updateValuesWhenItemQueryWithColumnCell(r,u)},r.prototype.cacheComboboxText=function(t){var u=this,r=this.createMultiComboBindingOptionsParam(),i;if(!r){t===null||t===void 0?void 0:t();return}i="GetMultiComboBindingOptions_"+this.getCalcSheetName()+"_"+this._getMultiComboBindingOptionsRequestID++;this._getMultiComboBindingOptionsRequestList[i]=!0;n.TableColumnsCacheManager.cacheComboboxText(r,function(){delete u._getMultiComboBindingOptionsRequestList[i];t===null||t===void 0?void 0:t()})},r.prototype.createMultiComboBindingOptionsParam=function(){var r,s=this.listviewData.visibleColumns,i,f,a,o;if(!s)return null;var h=this.getListDataCount(),u=[],c=[];for(i=0,f=s;i<f.length;i++){var e=f[i],v=e.getColumnIndex(),l=(r=e.getTemplateCell())===null||r===void 0?void 0:r.CellType,t=n.TableColumnsCacheManager.getBindingValueCacheKey(l);t&&(a=e.getDefaultValue(this.getCalcSheetName(),this.runTimePageName,h),o=this.getQueryAndValuesOfCombobox(h,v,l,t,a),o.length!==0)&&(u.push({lookupColumnBindingInfo:t.lookupColumnBindingInfo.GUID,resultColumnBindingInfo:t.resultColumnBindingInfo.GUID,queryAndValues:o}),c.push(t))}return u.length===0?null:{pageName:this.designerPageName,data:u,cacheKeys:c}},r.prototype.getQueryAndValuesOfCombobox=function(t,i,r,u,f){for(var v,o,s,h,c,y=this.getCalcSheetName(),l=[],a=[],e=0;e<t;e++)(o=(h={},h[y]=e,h),v=this._listData.getValue(e,i),v instanceof n.WrongParseResult)||(s=n.ConditionHelper.getComputedSqlConditionFormula(r.ItemsQuery,this.runTimePageName,r.NullFormulaValueQueryPolicy,0,0,o),l.push(v),a.push(s));return n.Common.IsEmpty(f)||(l.push(f),o=(c={},c[y]=t,c),s=n.ConditionHelper.getComputedSqlConditionFormula(r.ItemsQuery,this.runTimePageName,r.NullFormulaValueQueryPolicy,0,0,o),a.push(s)),n.TableColumnsCacheManager.getQueryAndValuesOfCombobox(l,a,r,u)},r.prototype.cacheComboboxForValidateText=function(t,i){var r=this.createParamForComboboxValidate(t);if(!r){i();return}n.TableColumnsCacheManager.cacheComboboxText(r,function(){i()})},r.prototype.createParamForComboboxValidate=function(t){var h,y=this.listviewData.visibleColumns,i,f,e,c,a,v,u,b,o,s;if(!y)return null;for(i=[],f=[],e=0,c=y;e<c.length;e++){var p=c[e],w=p.getColumnIndex(),l=(h=p.getTemplateCell())===null||h===void 0?void 0:h.CellType,r=n.TableColumnsCacheManager.getBindingValueCacheKey(l,!1);if(r){for(a=[],v=[],u=0;u<t.length;u++)b=t[u][w],n.Common.IsEmpty(b)||(a.push(t[u][w]),v.push(null));(o=n.TableColumnsCacheManager.getQueryAndValuesOfCombobox(a,v,l,r),o.length!==0)&&(i.push({lookupColumnBindingInfo:r.lookupColumnBindingInfo.GUID,resultColumnBindingInfo:r.resultColumnBindingInfo.GUID,queryAndValues:o}),f.push(r),s=n.TableColumnsCacheManager.getBindingValueCacheKey(l,!0),i.push({lookupColumnBindingInfo:s.lookupColumnBindingInfo.GUID,resultColumnBindingInfo:s.resultColumnBindingInfo.GUID,queryAndValues:n.Common.clone(o)}),f.push(s))}}return i.length===0?null:{pageName:this.designerPageName,data:i,cacheKeys:f}},r.prototype.updateValuesWhenItemQueryWithColumnCell=function(n,t){for(var u,f,e,i=0,r=this.listviewData.visibleColumns;i<r.length;i++)u=r[i],f=u.dependenceColumnsIndex,f&&f.indexOf(t)!==-1&&(e=u.getColumnIndex(),this._listData.setValue(n,e,null,7,!0))},r.prototype.onDependenceCellValueChanged=function(){this.stopEditingActiveCell()||this.hideActiveCellValidationTooltip();i.prototype.onDependenceCellValueChanged.call(this)},r.prototype.hideActiveCellValidationTooltip=function(){var n=this._sheet.getCellType(this._sheet.getActiveRowIndex(),this._sheet.getActiveColumnIndex());(n===null||n===void 0?void 0:n.hideValidationTooltip)&&n.hideValidationTooltip()},r.prototype.refreshUI=function(r){var u=this;this._refreshUIParam=t.merge(this._refreshUIParam,r);n.DelayRefresh.Push(this,function(){var t,r=u._refreshUIParam;if(delete u._refreshUIParam,!u.hasDestroyed()){if(!((t=n.ListViewHelper.PreviewHelper)===null||t===void 0?void 0:t.ForPreview)&&(u.cacheComboboxText(),!u.isComboboxRequestCompleted())){n.DelayRefresh.setTimeout(function(){u.refreshUI(r)},100);return}u.setDataToSpreadJSNow(r);u.selectInEditor(u._listData.getCurrentRowIndex(),undefined,function(){u.clearSelectionIfDisableAutoSelectRow()});u.getAlwaysReservedSelections()&&u.selectInEditorFromCache();u.triggerSelectedRowsChangedEvent();i.prototype.refreshUI.call(u)}},"setDataToSpreadJs"+this.getCalcSheetName())},r.prototype.autoFit=function(){this.listviewData.getAutoFitColumnWidth()&&this.autoFitColumnWidth();this.listviewData.getAutoFitRowHeight()&&this.autoFitRowHeight()},r.prototype.refreshTotalRowIndexInListViewStyleTemplate=function(){this.listviewData.allowShowTotalRow()&&this.listViewStyleTemplate&&this.listviewData.getIsTotalRowAtFirstRow()&&(this.listViewStyleTemplate.ShowTotalRowAtFirstRow=!0)},r.prototype.setTotalRowCellTypeAndStyle=function(){var t=this,i=this.totalRowIndex;i>=0&&this.listviewData.visibleColumns.forEach(function(r,u){var f=new n.SpreadJSViewTotalRowCellType(t,t.getCalcSheetName(),r.getColumnIndex()),o=t.getTotalRowStyleMetaData(r),e=n.ListViewHelper.SpreadJSStyleHelper.generateStyleObject(o);t.handleTotalRowCellTypeStyle(f,e);t._sheet.setStyle(t.totalRowIndex,u,e,GC.Spread.Sheets.SheetArea.viewport);t._sheet.setCellType(i,u,f,GC.Spread.Sheets.SheetArea.viewport)})},r.prototype.getTotalRowStyleMetaData=function(t){var f=t.totalRowSetting,i={HorizontalAlignment:n.CellHorizontalAlignment.General,VerticalAlignment:n.CellVerticalAlignment.Center,Formatter:null,WordWrap:!1,FontFamily:n.LocaleFonts.default,FontStyle:n.StaticValues.Font_Normal,FontWeight:n.StaticValues.Font_Normal,TextIndent:1},r=f===null||f===void 0?void 0:f.StyleMetaData,u;if(r)for(u in r)r[u]!==undefined&&(i[u]=r[u]);return(n.Common.IsEmpty(i.FontSize)||i.FontSize<=0)&&(i.FontSize=n.StaticValues.DefaultFontSizeInPx),i},r.prototype.handleTotalRowCellTypeStyle=function(t,i){var r,u;t.forceBackColor=i.backColor||n.ColorHelper.Convert((r=this.listViewStyleTemplate)===null||r===void 0?void 0:r.TotalRowBack)||"transparent";i.backColor=undefined;i.foreColor=i.foreColor||n.ColorHelper.Convert((u=this.listViewStyleTemplate)===null||u===void 0?void 0:u.TotalRowFore)||"#000000"},r.prototype.clearTotalRowCellTypeAndStyle=function(){var t=this,n=this.totalRowIndex;n>=0&&this.listviewData.visibleColumns.forEach(function(i,r){t._sheet.setStyle(n,r,null,GC.Spread.Sheets.SheetArea.viewport);t._sheet.setCellType(n,r,undefined,GC.Spread.Sheets.SheetArea.viewport)})},r.prototype.setDataToSpreadJSNow=function(n){if(this._sheet){n=n!==null&&n!==void 0?n:new t;this._sheet.suspendPaint();this.clearTotalRowCellTypeAndStyle();this._newRowIndex!==-1&&this.processNoneEditCellTypeInNewRow(!1);var i=this.getBindingDataSource();this._sheet.setDataSource(i);this.setTotalRowCellTypeAndStyle();this.refreshTotalRowIndexInListViewStyleTemplate();this.initColumnInputMessageFromDataValidation();this.allowAddRow()?(this._newRowIndex=this.lastDataRowIndexInView+1,this.processNoneEditCellTypeInNewRow(!0)):this._newRowIndex=-1;this.refreshConditionFormat();n.resetAutoMerge&&this.refreshAutoMerge(n.addRowStartIndex,n.addRowCount);this.autoFit();this._sheet.resumePaint();this.onRowHeightOrRowCountChanged();this.repaintConditionFormatDepenceListview();this.updateNodata()}},r.prototype.repaintConditionFormatDepenceListview=function(){var t=this;n.ForguncyData.pageInfo.pageElementManager.listviewCollection.listviews.filter(function(n){return n._conditionFormatDependenceListviews&&n._conditionFormatDependenceListviews.indexOf(t.getCalcSheetName())>=0}).forEach(function(n){return n.repaint()})},r.prototype.initConditionFormatCalc=function(){n.ForguncyData.pageInfo.formulaManager.addCalcSource(new n.ConditionFormatCalcSource(n.ForguncyData.pageInfo.formulaManager.getCalcService(),this.getConditionFormatCalcSourceName(),this.getListDataModel(),this));this.setCalcService(n.ForguncyData.pageInfo.formulaManager.getCalcService())},r.prototype.initConditionFormatFormula=function(){for(var o,t,i,u=this,f=new n.ConditionFormatFormulaHelper(u.runTimePageName),s=function(r){var u=r.getTemplateCell(),e,h,o,s,c;if(u.IsContainSpecificFormulaRule&&(!((t=u===null||u===void 0?void 0:u.ConditionalFormattingMetadata)===null||t===void 0?void 0:t.Rules)||u.ConditionalFormattingMetadata.handledRules)||!u.IsContainSpecificFormulaRule&&(!u.ConditionalFormattingGuids||((i=u.ConditionalFormattingMetadata)===null||i===void 0?void 0:i.handledRules)))return"continue";for(e=[],u.IsContainSpecificFormulaRule?e=u.ConditionalFormattingMetadata.handledRules=n.Common.clone(u.ConditionalFormattingMetadata.Rules):(h=n.ForguncyData.pageInfo.ConditionalFormattingMetadata,u.ConditionalFormattingGuids&&(u.ConditionalFormattingMetadata=new n.ConditionalFormattingMetadata,e=u.ConditionalFormattingGuids.map(function(t){return n.Common.clone(h.Rules.find(function(n){return n.GUID===t}))}),u.ConditionalFormattingMetadata.handledRules=e)),o=0,s=e;o<s.length;o++)c=s[o],f.HandleFormulaInConditionFormat(c)},r=0,e=u.listviewData.visibleColumns;r<e.length;r++)o=e[r],s(o);this.addDependenceHandler(f)},r.prototype.addDependenceHandler=function(t){var i=this,r=t.getDependences();r&&r.length>0&&n.DependenceCellValueChangeHelper.listenFormulaRefChanged(r,function(){i.repaint()},i.runTimePageName);t.dependenceListviews.filter(function(n){return n!==i.getCalcSheetName()&&i._conditionFormatDependenceListviews.indexOf(n)===-1}).forEach(function(n){return i._conditionFormatDependenceListviews.push(n)})},r.prototype.getConditionFormatCalcSourceName=function(){return this.getCalcSheetName()+"c"},r.prototype.getSheetRowCount=function(){return this._sheet.getRowCount()},r.prototype.getListViewRules=function(){for(var u,n,r,t=[],i=0;i<this.listviewData.visibleColumns.length;i++)(u=this.listviewData.visibleColumns[i],n=u.getTemplateCell(),n===null||n===void 0?void 0:n.ConditionalFormattingMetadata)&&(r=n.ConditionalFormattingMetadata.handledRules,r&&r.forEach(function(n){t.find(function(t){return t.GUID===n.GUID})||t.push(n)}));return t.sort(function(n,t){return n.Priority-t.Priority}),t},r.prototype.checkRuleIsInRange=function(n){return n.RuleType===10?!1:!0},r.prototype.addSettedRangeConditionRules=function(){var u=this.firstDataRowIndexInView,r=this._listData.getRowCount(),f=this.getListViewRules(),i;if(!(r<=0)){var e=new n.ConditionFormatRuleHelper,o=function(n){for(var v,o,l,a,y,p,h=f[n],c=[],w=h.GUID,i=null,s=0;s<t.listviewData.visibleColumns.length;s++)(v=t.listviewData.visibleColumns[s],o=v.getTemplateCell(),o===null||o===void 0?void 0:o.ConditionalFormattingMetadata)&&(l=o.ConditionalFormattingMetadata.handledRules,a=l.find(function(n){return n.GUID===w}),l&&a&&(i==null&&(i=o.StyleInfo),t.checkRuleIsInRange(h)?c.push(new GC.Spread.Sheets.Range(u,s,r,1)):(y=e.ConvertConditionRuleToSpreadJSByRanges(i,a,[new GC.Spread.Sheets.Range(u,s,r,1)]),t._sheet.conditionalFormats.addRule(y),i=null)));c.length>0&&(p=e.ConvertConditionRuleToSpreadJSByRanges(i,h,c),t._sheet.conditionalFormats.addRule(p),i=null)},t=this;for(i=0;i<f.length;i++)o(i)}},r.prototype.refreshConditionFormat=function(){var o=this.firstDataRowIndexInView,u=this._listData.getRowCount(),t,r,i,f,e;if(this._sheet.conditionalFormats.clearRule(),!(u<=0))for(this.listViewStyleTemplate&&((this.listViewStyleTemplate.RowHoverBack||this.listViewStyleTemplate.RowHoverFore)&&(t=new GC.Spread.Sheets.Style,this.listViewStyleTemplate.RowHoverBack&&(t.backColor=n.ColorHelper.Convert(this.listViewStyleTemplate.RowHoverBack)),this.listViewStyleTemplate.RowHoverFore&&(t.foreColor=n.ColorHelper.Convert(this.listViewStyleTemplate.RowHoverFore)),r=[new GC.Spread.Sheets.Range(-1,-1,-1,-1)],this._sheet.conditionalFormats.addRowStateRule(GC.Spread.Sheets.RowColumnStates.hover,t,r)),(this.listViewStyleTemplate.RowSelectBack||this.listViewStyleTemplate.RowSelectFore)&&(t=new GC.Spread.Sheets.Style,this.listViewStyleTemplate.RowSelectBack&&(t.backColor=n.ColorHelper.Convert(this.listViewStyleTemplate.RowSelectBack)),this.listViewStyleTemplate.RowSelectFore&&(t.foreColor=n.ColorHelper.Convert(this.listViewStyleTemplate.RowSelectFore)),r=[new GC.Spread.Sheets.Range(-1,-1,-1,-1)],this._sheet.conditionalFormats.addRowStateRule(GC.Spread.Sheets.RowColumnStates.selected,t,r))),this.addSettedRangeConditionRules(),i=0;i<this.listviewData.visibleColumns.length;i++)f=this.listviewData.visibleColumns[i],e=new GC.Spread.Sheets.Range(o,i,u,1),this.addDirtyConditionRule(f,e)},r.prototype.addDirtyConditionRule=function(t,i){var u=t.columnInfo.Index,r,f,e;this.shouldAddDirtyConditionRule(u)&&(r=new GC.Spread.Sheets.Style,r.borderBottom=new GC.Spread.Sheets.LineBorder(this.getDirtyCellMarkColor(),GC.Spread.Sheets.LineStyle.thick),f=n.Common.format('=ISDIRTY({0},"{1}",ROW()-{2},{3})',this.locatedPageID,this.getCalcSheetName(),i.row+1,u),e=new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(GC.Spread.Sheets.ConditionalFormatting.RuleType.formulaRule,[i],r,null,null,null,null,f),this._sheet.conditionalFormats.addRule(e))},r.prototype.getDirtyCellMarkColor=function(){var i,t;return this._dirtyCellColor||(t=n.ColorHelper.Convert((i=this.listViewStyleTemplate)===null||i===void 0?void 0:i.DirtyCellColor),n.Common.IsEmpty(t)?t="#F3DB92":this.isTransparent(t)&&(t="transparent"),this._dirtyCellColor=t),this._dirtyCellColor},r.prototype.isTransparent=function(n){if(!(n===null||n===void 0?void 0:n.startsWith("rgba(")))return!1;var t=n.lastIndexOf(",")+1,i=n.substring(t,n.length-1);return Number(i)===0},r.prototype.shouldAddDirtyConditionRule=function(n){return n>=0&&this.listviewData.ShowEditStatusIcon()&&this.getDirtyCellMarkColor()!=="transparent"&&this.getAllowDirtyColumns().indexOf(n)>=0},r.prototype.getAllowDirtyColumns=function(){var t,n;if(!this._allowDirtyColumns)for(this._allowDirtyColumns=[],t=this._listData.getColumnCount(),n=0;n<t;n++)this.getAllowEditedBindingInfo(n)&&this._allowDirtyColumns.push(n);return this._allowDirtyColumns},r.prototype.getRowState=function(n){var t,r,i;if(!this.listviewData.ShowEditStatusIcon()||this.isGroupMode()||(t=this.mappedRowIndexFrowView(n),t<0||t>=this._listData.getRowCount()))return 0;if(!this._listData.getRowQuery(t))return 2;for(r=this.getAllowDirtyColumns(),i=0;i<this._listData.getColumnCount();i++)if(this._listData.isDirty(t,i)&&r.indexOf(i)>=0)return 1;return 0},r.prototype.refreshAutoMerge=function(t,i){for(var u,f,e,o=[],r=0;r<this.listviewData.visibleColumns.length;r++)this.listviewData.visibleColumns[r].columnInfo.AllowAutoMerge&&o.push(r);u=this.allowShowTotalRow();f=0;u&&this.listviewData.getIsTotalRowAtFirstRow()&&(f=1);e=this._sheet.getRowCount();u&&this.listviewData.getIsTotalRowAtLastRow()&&(e-=1);t>=0&&(t=this.mappedRowIndexFromData(t));n.ListViewHelper.AutoMergeHelper.autoMerge(this._sheet,o,t,i,f,e)},r.prototype.setCalcService=function(n){this._sheet.setCalc(n,null)},r.prototype.repaint=function(){this._sheet.repaint()},r.prototype.processNoneEditCellTypeInNewRow=function(t){var f,i,r,u,e,o;if(!(this._sheet.getRowCount()<=this._newRowIndex)&&this.listviewData.visibleColumns)for(f=this.listviewData.visibleColumns.length,i=0;i<f;i++){if(r=this.listviewData.visibleColumns[i],u=void 0,!r.cellType.shouldDisplayInListviewNewRow()&&t)u=new n.SpreadJSViewTextCellType(this,this.getCalcSheetName(),r.getColumnIndex());else if(e=this._sheet.getCellType(-1,i).typeName,o=this._sheet.getCellType(this._newRowIndex,i).typeName,e===o)continue;this._sheet.setCellType(this._newRowIndex,i,u)}},r.prototype.getBindingDataSource=function(){var n=[],t=this._listData.getRowCount();return this.fillDataSource(n,0,t),this.allowAddRow()&&n.push(this.getBindingDataSourceOfNewRow()),this.allowShowTotalRow()&&(this.listviewData.getIsTotalRowAtFirstRow()?n.unshift(this.getTotalRowDataSource()):n.push(this.getTotalRowDataSource())),n},r.prototype.getBindingDataSourceOfNewRow=function(){for(var t,i,f=this._listData.getRowCount(),e=this.listviewData.visibleColumns.length,u={},r=0;r<e;r++)t=this.listviewData.visibleColumns[r],i=t===null||t===void 0?void 0:t.getDefaultValue(this.getCalcSheetName(),this.runTimePageName,f),i=n.Common.IsEmpty(i)?null:this.adjustValue(i,t),u[t.getUniqueName()]=i;return u},r.prototype.fillDataSource=function(n,t,i){for(var o,s,u,f,e,h=this.listviewData.visibleColumns.length,r=t;r<t+i;r++){for(o={},s=this._listData.getRowValue(r),u=0;u<h;u++)f=this.listviewData.visibleColumns[u],e=s[f.getColumnIndex()],e=this.adjustValue(e,f),o[f.getUniqueName()]=e;n[r]=o}},r.prototype.adjustValue=function(t,i){var u=i.cellType.constructor,r,f,e;if(u===n.ImageCellType||u===n.UploadImageCellType){r=i.getTemplateCell();f=r.Value;try{return r.Value=t,n.ImageHelper.getImageSrcFromCellContentElement(r,!1,!1)}finally{r.Value=f}}else if(i.cellType.constructor===n.PasswordCellType)return e=n.ListviewEditorHelper.getCell(i.getTemplateCell(),this.runTimePageName,this.designerPageName,this.listviewData.getListviewName()),e.cellType.getListviewNoneEditModeText(t);return t===undefined?null:t},r.prototype.getTotalRowDataSource=function(){var t=this,n={};return this.listviewData.visibleColumns.forEach(function(i){var r=i.columnInfo.TotalRowCell;n[i.getUniqueName()]=t.getTotalRowStaticValue(r)}),n},r.prototype.getTotalRowStaticValue=function(t){var r,u,i,f;return t&&t.FormulaType===0&&t.StatisticFormula?((r=n.ListViewHelper.PreviewHelper)===null||r===void 0?void 0:r.ForPreview)?n.Common.getMultiLanguageWord(t.StatisticFormula):(i=t.StatisticFormula,f=(u=i===null||i===void 0?void 0:i.startsWith("="))!==null&&u!==void 0?u:!1,f)?n.ForguncyData.pageInfo.formulaManager.evaluateFormula(i,{runTimePageName:this.runTimePageName}):n.Common.getMultiLanguageWord(t.StatisticFormula):t&&t.FormulaType!==0?t.Value:null},r.prototype.handleTotalRowFormulaDependenceCells=function(){for(var u,t=this,f=function(i){var r=i.columnInfo,u=r===null||r===void 0?void 0:r.TotalRowFormulaDependenceCells;if(!u)return"continue";n.DependenceCellValueChangeHelper.listenFormulaRefChanged(u,function(){var n=t.getTotalRowStaticValue(r.TotalRowCell),i=t.getVisibleColumnIndexInListViewByDataIndex(r.Index);t.allowShowTotalRow()&&(t.listviewData.getIsTotalRowAtFirstRow()?t._sheet.setValue(0,i,n):t._sheet.setValue(t._sheet.getRowCount()-1,i,n))},e.runTimePageName)},e=this,i=0,r=this.listviewData.visibleColumns;i<r.length;i++)u=r[i],f(u)},r.prototype.initRowHeaderStyle=function(){var t=this.createHeaderStyle(this.listviewData.rowHeaderColumnInfo.columnInfo.TemplateCell,n.HeaderType.RowHeader);return t&&this._sheet.setStyle(-1,0,t,GC.Spread.Sheets.SheetArea.rowHeader),t},r.prototype.createHeaderStyle=function(n,t){var i=r.createStyleByCell(n);return this.adjustHeaderStyleByTemplate(i,t)},r.prototype.adjustHeaderStyleByTemplate=function(t,i){var o,s,r,u,e;if(!this.listViewStyleTemplate)return t;t=t||new GC.Spread.Sheets.Style;t.backColor==="#E1E1E1"&&(t.backColor=n.ColorHelper.Convert(this.listViewStyleTemplate.ColumnHeaderBack));t.foreColor==="#262626"&&(t.foreColor=n.ColorHelper.Convert(this.listViewStyleTemplate.ColumnHeaderFore));var f="#C8C8C8",h=!1,c=!1,l=!1,a=!1,v=this.listViewStyleTemplate.ColumnHeaderBorder;return i===n.HeaderType.ColumnHeader?(f=(o=n.ColorHelper.Convert(this.listViewStyleTemplate.ColumnHeaderGridLineColor))!==null&&o!==void 0?o:f,h=this.listViewStyleTemplate.ShowColumnHeaderHorizontalGridLine,c=this.listViewStyleTemplate.ShowColumnHeaderVerticalGridLine):(i===n.HeaderType.RowHeader||i===n.HeaderType.CheckBoxRowHeader)&&(f=(s=n.ColorHelper.Convert(this.listViewStyleTemplate.RowHeaderGridLineColor))!==null&&s!==void 0?s:f,h=this.listViewStyleTemplate.ShowRowHeaderHorizontalGridLine,c=this.listViewStyleTemplate.ShowRowHeaderVerticalGridLine),r=v,u=v,h&&!r&&(r=f,l=!0),c&&!u&&(u=f,a=!0),u=u!==null&&u!==void 0?u:"transparent",r=r!==null&&r!==void 0?r:"transparent",e=new GC.Spread.Sheets.LineBorder(n.ColorHelper.Convert(r),GC.Spread.Sheets.LineStyle.thin),n.Common.IsEmpty(t.borderTop)&&!l&&(t.borderTop=e),n.Common.IsEmpty(t.borderBottom)&&(t.borderBottom=e),e=new GC.Spread.Sheets.LineBorder(n.ColorHelper.Convert(u),GC.Spread.Sheets.LineStyle.thin),n.Common.IsEmpty(t.borderLeft)&&!a&&(t.borderLeft=e),n.Common.IsEmpty(t.borderRight)&&(t.borderRight=e),t},r.prototype.selectInEditor=function(n,t,i){var r=this.mappedRowIndexFromData(n);r>=0&&r<this._sheet.getRowCount()&&(t===undefined&&(t=this._sheet.getActiveColumnIndex()),(r!==this._sheet.getActiveRowIndex()||t!==this._sheet.getActiveColumnIndex())&&(this.cancelEdit(),this._sheet.setActiveCell(r,t),this._sheet.showCell(r,t,GC.Spread.Sheets.VerticalPosition.nearest,GC.Spread.Sheets.HorizontalPosition.nearest),i===null||i===void 0?void 0:i()))},r.prototype.cancelInput=function(){GC.Spread.Sheets.Commands.cancelInput.execute(this._spread,{sheetName:this._sheet.name()},!1)},r.prototype.editAndValidateCell=function(t,i,r){var u,e,f;if(this._waitValidateRows.indexOf(t)>=0)n.Common.remove(this._waitValidateRows,t);else return;if(u=this.mappedRowIndexFromData(t),(this._sheet.getActiveRowIndex()!==u||this._sheet.getActiveColumnIndex()!==i)&&(this._sheet.isEditing()&&this.cancelInput(),this._sheet.setActiveCell(u,i),this.onSelectionChanged()),!this._sheet.isEditing()){if(e=this.getGlobalActiveSheet(),!n.Common.IsEmpty(e)&&e!==this._sheet)return;this._sheet.showCell(u,i,GC.Spread.Sheets.VerticalPosition.nearest,GC.Spread.Sheets.HorizontalPosition.nearest);this._sheet.startEdit();f=this._sheet.getCell(u,i).cellType();(f===null||f===void 0?void 0:f.validate)&&f.validate(u,i,r)}},r.prototype.getGlobalActiveSheet=function(){var n=window.gcGlobal;return n?n.activeElement:null},r.prototype.getCurrentRowCenterY=function(){var r=this._listData.getCurrentRowIndex(),u=this._sheet.getActiveColumnIndex(),t,i;return r<0||u<0?-1:(t=this.mappedRowIndexFromData(r),t<0)?-1:(i=this._sheet.getCellRect(t,u).y,n.Common.IsEmpty(i))?-1:i+this._sheet.getRowHeight(t)/2},r.prototype.getMappedEditorSelectedRowIndex=function(){var i=this.getEditorRowCount(),t;return this._sheet&&i>0&&(t=this._sheet.getActiveRowIndex(),!n.Common.IsEmpty(t))?this.mappedRowIndexFrowView(t):undefined},r.prototype.endEdit=function(n,t){!this.hasDestroyed()&&this._sheet.getActiveRowIndex()===n&&this._sheet.getActiveColumnIndex()===t&&this._sheet.isEditing()&&this._sheet.endEdit()},r.prototype.stopEditingActiveCell=function(n){n===void 0&&(n=!1);var t=!!this._sheet.endEdit();return t===!1&&n&&this.scrollToView(),t},r.prototype.cancelEdit=function(){this._spread.commandManager().execute({cmd:"cancelInput",sheetName:this._sheet.name()})},r.prototype.getListviewControl=function(){return this._spread},r.prototype.getNewRowIndex=function(){return this._newRowIndex},r.prototype.protectListview=function(n){i.prototype.protectListview.call(this,n);this._sheet.options.isProtected=n},r.prototype.getValidateHelpInfoByViewIndex=function(n,t){var i=this.mappedRowIndexFrowView(n),r=this.listviewData.visibleColumns[t].getColumnIndex();return this.getValidateHelpInfo(i,r)},r.prototype.getCurrentColIndex=function(){var n=this._sheet.getActiveColumnIndex();return n<0||n>=this.listviewData.visibleColumns.length?-1:this.listviewData.visibleColumns[n].columnInfo.Index},r.prototype.isCurrentRowSameWithActiveCellRow=function(){return this.listviewData.allowShowTotalRow()&&this.listviewData.getIsTotalRowAtFirstRow()?this._sheet.getActiveRowIndex()===this._listData.getCurrentRowIndex()+1:this._sheet.getActiveRowIndex()===this._listData.getCurrentRowIndex()},r.prototype.showHorizontalScrollBar=function(n){if(n===undefined)return this._spread.options.showHorizontalScrollbar;this._spread.options.showHorizontalScrollbar=n},r.prototype.showVerticalScrollBar=function(n){if(n===undefined)return this._spread.options.showVerticalScrollbar;this._spread.options.showVerticalScrollbar=n},r.prototype.isEditing=function(){return this._sheet.isEditing()},r.prototype.getEditingValue=function(){var n=this._sheet.getActiveRowIndex(),t=this._sheet.getActiveColumnIndex();return this._sheet.getCellType(n,t).getEditorValue(null)},r.prototype._destroy=function(){this._onNormalCellValueChangedEventHandler&&n.ForguncyData.pageInfo.dataModel.normalCellDataModel.unbind("valuechanged",this._onNormalCellValueChangedEventHandler);var t=n.ForguncyData.pageInfo.formulaManager.getCalcSource(this.getConditionFormatCalcSourceName());t&&n.ForguncyData.pageInfo.formulaManager.removeCalcSourceByName(this.getConditionFormatCalcSourceName());this.removeSheetSource();this.setCalcService(new GC.Spread.CalcEngine.CalcService);this.destroySpread();this._stretchHelper&&this._stretchHelper.destroy()},r.prototype.removeSheetSource=function(){var i=n.ForguncyData.pageInfo.formulaManager.getCalcService(),r=i.getAllSourceModels(),u,t;for(u in r)if(t=r[u].getSource(),t.getSheet&&t.getSheet()===this._sheet){i.removeSource(t);break}},r.prototype.destroySpread=function(){var r,u,t,i;if(this._sheet){for(r=this._sheet.getColumnCount(),u=this._sheet.getActiveRowIndex(),t=0;t<r;t++)i=this._sheet.getCellType(u,t),i instanceof n.SpreadJSEditCellType&&i.destroy();this._sheet.unbindAll();this._sheet=null}if(this._spread){this._spread.unbindAll();try{this._spread.focus(!1)}catch(f){}this._spread.destroy();this._spread=null}},r.prototype.getControl=function(){return this._spread},r.prototype.clearSelectionOutOfCurrentRow=function(){var t=this;n.DelayRefresh.Push(this,function(){var n,i;if(!t.hasDestroyed()&&(n=t.getCurrentRowIndex(),n!==-1&&t._listData.getRowCount()>0)){i=t.mappedRowIndexFromData(n);t._sheet.setActiveCell(i,t._sheet.getActiveColumnIndex());t.clearSelectionIfDisableAutoSelectRow();t.onSelectionChanged(!1)}},"clearSelectionOutOfCurrentRow"+this.getCalcSheetName())},r.prototype.addSelectedRow=function(t){t=this.mappedRowIndexFromData(t);n.ListViewHelper.SelectionHelper.addSelectedRow(this,t);this.onSelectionChanged()},r.prototype.setSelectedRows=function(t){var i=this,r=t.filter(function(n){return n!==-1}).map(function(n){return i.mappedRowIndexFromData(n)});n.ListViewHelper.SelectionHelper.setSelectedRows(this,r);this.onSelectionChanged()},r.prototype.clearSelectedRow=function(t){t=this.mappedRowIndexFromData(t);n.ListViewHelper.SelectionHelper.clearSelectedRow(this,t);this.onSelectionChanged()},r.prototype.selectAllRows=function(){n.ListViewHelper.SelectionHelper.selectAllRows(this);this.onSelectionChanged()},r.prototype.clearAllSelectedRows=function(t){n.ListViewHelper.SelectionHelper.clearAllSelectedRows(this);i.prototype.clearAllSelectedRows.call(this,t)},r.getCanvas=function(t){var i=n.ListviewBase.getListviewByCalcSheetName(t);return i instanceof r?i.getContainerDiv().find("canvas")[0]:null},r.getCanvasPosition=function(n){var t=$(r.getCanvas(n)).position();return t||(t={top:0,left:0}),t},r.getBounds=function(t){var i=n.ListviewBase.getListviewByCalcSheetName(t);return i instanceof r?new GC.Spread.Sheets.Rect(0,0,$(i._divContainer).width(),$(i._divContainer).height()):new GC.Spread.Sheets.Rect(0,0,0,0)},r.getWorkBookByHost=function(n){return n.data("workbook")},r.prototype.setSelectionWithEvent=function(n,t,i,r){n=this.mappedRowIndexFromData(n);this._sheet.setSelection(n,t,i,r);this.onSelectionChanged()},r.prototype.isRowHeaderVisible=function(){return this.listviewData.isRowHeaderVisible()},r.prototype.isRowHeaderCheckBoxVisible=function(){return this.listviewData.isRowHeaderCheckBoxVisible()},r.prototype.getText=function(t,r){var u=this.mappedRowIndexFromData(t),e,o,f,h,s;return u<0||u>=this._sheet.getRowCount()?"":(e=this.listviewData.rowHeaderColumnInfo,e&&e.getColumnIndex()===r)?this._sheet.getText(u,0,GC.Spread.Sheets.SheetArea.rowHeader):(o=this.listviewData.getColumnMetaData(r),o&&o.Width===0)?i.prototype.getText.call(this,t,r):(f=this.getVisibleColumnIndexInListViewByDataIndex(r),f===-1)?"":(h=this.listviewData.visibleColumns[f],s=h.cellType.constructor,s===n.ImageCellType||s===n.UploadImageCellType)?i.prototype.getText.call(this,t,r):this._sheet.getText(u,f)},r.prototype.focus=function(n){this._spread.focus(n)},r.prototype.getActualStyle=function(t,i){if(t=this.mappedRowIndexFromData(t),t<0||t>=this._sheet.getRowCount()||i<0||i>=this._sheet.getColumnCount())return null;var r=this._sheet.getActualStyle(t,i,GC.Spread.Sheets.SheetArea.viewport),u=new GC.Spread.Sheets.Style(r.backColor,r.foreColor);return u.textIndent=r.textIndent,n.CommandCellTypeHelper.setAlternativeRowColor(t,this.oddRowBackcolor,this.evenRowBackcolor,u,this.listViewStyleTemplate),u},r.prototype.getCellRect=function(n,t){return this._sheet.getCellRect(n,t)},r.prototype.getExportColmnMetadatas=function(){return this.listviewData.visibleColumns.map(function(n){return n.columnInfo})},r.prototype.getColumnWidth=function(n){return this._sheet.getColumnWidth(n)},r.prototype.getAutoFitWidth=function(n){return this._columnAutoWidths[n]},r.prototype.allowSortByColumn=function(n){var r=this.listviewData.getColumnOperation(),i,t;return r!==1&&r!==2?!1:this.tryCommitValueBeforeQueryOrSort(!0)?(i=this.listviewData.visibleColumns,!i)?!1:(t=i[n],t.getIsFilterListCompareType())?!1:t.allowFieldSort()?!0:this.allowNoFieldSortFilter(t)?!0:!1:!1},r.prototype.allowNoFieldSortFilter=function(t){if(this.getDataTableName()&&this.listviewData.getColumnOperation()!==2||!t.allowNoFieldSort())return!1;var i=n.ForguncyData.pageingInfoList.IsPageing(this.getLocationString());return i||this._isAllDataLoaded},r.prototype.sortByColumn=function(t,i){var l=this.allowSortByColumn(t),o,u,s,h,c;if(l){for(o=this.listviewData.visibleColumns,u=0;u<o.length;u++)s=this.listviewData.visibleColumns[u],h=null,t===u&&(h=n.Common.IsEmpty(i)?s.sortInfo===0?1:0:i),s.sortInfo=h;var f=n.ForguncyData,e=this.getLocationString(),r=o[t];f.pageInfo.sortInfoCache[e]||(f.pageInfo.sortInfoCache[e]={});c={ColumnName:n.ColumnInfoHelper.getColumnUniqueLocationKey(r.columnInfo),ColumnIndex:r.columnInfo.Index,ColumnBindingInfo:r.allowFieldSort()?r.getBindingInfo():null,Order:r.sortInfo};f.pageInfo.sortInfoCache[e].sortInfo=[c];this.listviewData.metadata.CacheColumnFilterAndSort&&n.ListviewStatusCacheHelper.autoSaveMetadataCacheDataAsync(this,{sort:f.pageInfo.sortInfoCache[e]});this.getListDataCount()<=0&&this.deletedRowQuerys.length<=0?this.refreshUI():r.allowFieldSort()||this.containUncommitedValue()?this.fillData():r.allowNoFieldSort()&&n.FormulaColumnSortFilterHelper.sortByColumn(this)}},r.prototype.resetDataAfterFilter=function(t){var i;this.listviewData.metadata.CacheColumnFilterAndSort&&n.ListviewStatusCacheHelper.autoSaveMetadataCacheDataAsync(this,{columnFilter:(i=n.ForguncyData.pageInfo.columnFilterQueryCache[this.getLocationString()])!==null&&i!==void 0?i:[]});t.allowFieldSort()||this.containUncommitedValue()?(this.resetToFirstPage(),this.fillData()):this.allowNoFieldSortFilter(t)&&n.FormulaColumnSortFilterHelper.filterByColumn(this)},r.prototype.onInitAllData=function(){var t=n.FormulaColumnSortFilterHelper.getFilteredAndSortData(this);t!==this.dataCache&&this._listData.setData(t,!1,!0)},r.prototype.allowSetTabOrder=function(){return!0},r.prototype.setTabIndex=function(t){this._tabIndex!==t&&(this._tabIndex=t,n.DomUtilities.setTabIndex($(this.getGcSheetFocusElementForTab()),t))},r.prototype.isDisableTabOrder=function(){return!this.listviewData.getAllowGetFocus()},r.prototype.getSettedTabIndex=function(){return this.listviewData.getTabIndex()},r.prototype.getDirectRunTimePageNames=function(){return null},r.OriginalSpreadJSMethod={},r}(n.UIListviewBase),t;n.SpreadJSView=i;t=function(){function n(n,t,i){n===void 0&&(n=-1);t===void 0&&(t=-1);i===void 0&&(i=!0);this.addRowStartIndex=n;this.addRowCount=t;this.resetAutoMerge=i}return n.merge=function(t,i){return(i=i!==null&&i!==void 0?i:new n,!t)?i:((t.addRowStartIndex===-1||t.addRowCount===-1||i.addRowStartIndex===-1||i.addRowCount===-1)&&(t.addRowStartIndex=-1,t.addRowCount=-1),t.resetAutoMerge||(t.resetAutoMerge=i.resetAutoMerge),t)},n}();n.RefreshUIParam=t})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},Forguncy;(function(n){var e,t=function(){function t(){}return t.getColumnCellType=function(n,i,r){for(var f,s=t.columnCellTypeInfos,e=y,u=0,o=s;u<o.length;u++)if(f=o[u],f.shouldUse(n,i,r)){e=f.cellTypeCtor;break}return new e(n,n.getCalcSheetName(),i.getColumnIndex())},t.register=function(n,i){t.columnCellTypeInfos.push({shouldUse:n,cellTypeCtor:i})},t.executeEditCommand=function(n,t,i,r){var u={cmd:"editCell",sheetName:n.name(),row:t,col:i,newValue:r,autoFormat:!1};n.getParent().commandManager().execute(u)},t.renderTextDecoration=function(n,t,i,r,u,f,e){n.strokeStyle=n.fillStyle;var o=0,h=0,s=.5,c=f<=12?12:f;h=Math.floor((c-12)/21+1);n.lineWidth=h;(h&1)==0&&(s=0);n.textAlign==="center"?i=i-u/2:n.textAlign==="right"&&(i=i-u);n.beginPath();(t&GC.Spread.Sheets.TextDecorationType.overline)===GC.Spread.Sheets.TextDecorationType.overline&&(o=Math.ceil(r+e-f-1)-s,n.moveTo(i,o),n.lineTo(i+u,o));(t&GC.Spread.Sheets.TextDecorationType.lineThrough)===GC.Spread.Sheets.TextDecorationType.lineThrough&&(o=Math.ceil(r+e-f/2)-s,n.moveTo(i,o),n.lineTo(i+u,o));(t&GC.Spread.Sheets.TextDecorationType.underline)===GC.Spread.Sheets.TextDecorationType.underline&&(o=Math.ceil(r+e-1)-s,n.moveTo(i,o),n.lineTo(i+u,o));n.stroke()},t.getStringWidthByCanvas=function(n,t,i){var r=new GC.Spread.Sheets.Style,u;return r.font=t,u={sheet:i,row:0,col:0,sheetArea:GC.Spread.Sheets.SheetArea.viewport},GC.Spread.Sheets.CellTypes.Base.prototype.getAutoFitWidth(n,n,r,1,u)},t.getTextHeight=function(n,t){var i=new GC.Spread.Sheets.Style,r;return i.font=n,r={sheet:t,row:0,col:0,sheetArea:GC.Spread.Sheets.SheetArea.viewport},GC.Spread.Sheets.CellTypes.Base.prototype.getAutoFitHeight("text","text",i,1,r)},t.getVisualStateName=function(n){for(var t in GC.Spread.Sheets.VisualState)if(GC.Spread.Sheets.VisualState[t]===n)return t.toLowerCase();return null},t.getCustomStyle=function(t,i,r,u){var f=t||new GC.Spread.Sheets.Style,e={};return r&&(u===GC.Spread.Sheets.VisualState.normal?e[GC.Spread.Sheets.VisualState.normal]={backColor:r.ColumnHeaderBack,foreColor:r.ColumnHeaderFore}:u===GC.Spread.Sheets.VisualState.selected?e[GC.Spread.Sheets.VisualState.selected]={backColor:r.ColumnHeaderSelectBack,foreColor:r.ColumnHeaderSelectFore}:u===GC.Spread.Sheets.VisualState.hover?e[GC.Spread.Sheets.VisualState.hover]={backColor:r.ColumnHeaderHoverBack,foreColor:r.ColumnHeaderHoverFore}:u===GC.Spread.Sheets.VisualState.highlight&&(e[GC.Spread.Sheets.VisualState.highlight]={backColor:r.ColumnHeaderHighlightBack,foreColor:r.ColumnHeaderHighlightFore})),u===GC.Spread.Sheets.VisualState.normal?(f.backColor||(f.backColor=r?n.ColorHelper.Convert(e[u].backColor):i.backgroundColor),n.Common.IsEmpty(f.foreColor)&&(f.foreColor=r?n.ColorHelper.Convert(e[u].foreColor):i.color)):(r&&e[u].backColor&&(f.backColor=n.ColorHelper.Convert(e[u].backColor)),r&&e[u].foreColor&&(f.foreColor=n.ColorHelper.Convert(e[u].foreColor))),f.backColor||(f.backColor=i.backgroundColor),f.foreColor||(f.foreColor=i.color),f},t.changeCursorAsPointer=function(t){var r=t.getParent(),i=n.SpreadJSView.getCanvas(r.name);i&&(i.style.cursor="pointer")},t.getJSONKey=function(n,t,i){return!t||i===undefined?null:"".concat(t,"_").concat(i,"_").concat(n.typeName)},t.toJSON=function(i,r,u){var e=t.getJSONKey(i,r,u),o,f;if(e&&t._jsonCache[e])return t._jsonCache[e];o={};for(f in i)i.hasOwnProperty(f)&&!f.startsWith("__")&&typeof i[f]!="object"&&(o[f]=i[f]);return e&&(t._jsonCache[e]=o,n.DelayRefresh.setTimeout(function(){t._jsonCache={}})),o},t.fromJSON=function(t,i){if(t)for(var r in t)n.Common.IsEmpty(t[r])||(i[r]=t[r])},t.columnCellTypeInfos=[],t._jsonCache={},t}(),i,a,r,v,y,ot,s,p,w,b,k,d,g,h,o,c,ft,st,u,l,ht,nt,ct,lt,tt,et,at,it,rt,ut,f;n.SpreadJSCellTypeHelper=t;i=function(){function i(){}return i.processMouseMove=function(n){if(n){var i=n.sheet;i&&(i.isEditing()&&i.getActiveRowIndex()===n.row&&i.getActiveColumnIndex()===n.col||t.changeCursorAsPointer(i))}},i.processMouseLeave=function(t){var r=t.sheet,u,i;r&&(u=r.getParent(),i=n.SpreadJSView.getCanvas(u.name),i&&(i.style.cursor="default"))},i.shouldUsePointerCursor=function(n){return n&&n.length>0},i.setAlternativeRowColor=function(t,i,r,u,f){var e,o;return u=u||new GC.Spread.Sheets.Style,e=t,(f===null||f===void 0?void 0:f.ShowTotalRowAtFirstRow)&&(e-=1),u.backColor||(o=e%2==0?r:i,o&&o!=="transparent"?u.backColor=n.ColorHelper.Convert(o):this.setStyleTemplateBackColor(u,f,e)),u.foreColor||this.setStyleTemplateForeColor(u,f,e),u},i.setStyleTemplateBackColor=function(t,i,r){if(i){var u=r%2==0?i.EvenRowBack:i.OddRowBack;u&&(t.backColor=n.ColorHelper.Convert(u))}},i.setStyleTemplateForeColor=function(t,i,r){if(i){var u=r%2==0?i.EvenRowFore:i.OddRowFore;u&&(t.foreColor=n.ColorHelper.Convert(u))}},i.getHitInfo=function(n,t,i,r,u,f){var e,o;return f?(e=f.sheetArea,(e===null||e===undefined||e===u)&&r)?(o={x:n,y:t,row:f.row,col:f.col,cellRect:r,sheetArea:e,sheet:f.sheet},r.x<=n&&n<r.x+r.width&&r.y<=t&&t<r.y+r.height&&(o.isReservedLocation=!0),o):null:null},i.processMouseDown=function(n,t){if(!t)return!1;var i=t.sheet;return i&&t.isReservedLocation&&!n.isMouseDownReservedLocation?(n.isMouseDownReservedLocation=!0,!0):!1},i.processMouseUp=function(n,t,r,u,f,e){if(!t)return!1;var o=t.sheet;return n.isMouseDownReservedLocation&&o&&t.isReservedLocation&&(n.isMouseDownReservedLocation=!1,i.triggerButtonClicked(o,r,u,t.sheetArea,f,t),e&&e.apply(n,[t])),!1},i.triggerButtonClicked=function(t,i,r,u,f,e){var o,s;if(u===f&&i!==undefined&&r!==undefined&&(o=t.getParent(),o)&&(s=n.ListviewBase.getListviewByCalcSheetName(o.name),s))s.onCellTypeClicked({row:i,col:r,sheetArea:u,x:e===null||e===void 0?void 0:e.x,y:e===null||e===void 0?void 0:e.y})},i}();n.CommandCellTypeHelper=i;a=function(u){function e(n,t,i){var r=u.call(this)||this,f;return(r.calcSheetName=t,r.dataColIndex=i,r.__useNormalStyleFontColorReplaceForeColor=!1,r.__useNormalStyleBackColorReplaceBackColor=!1,r.__hoveredY=-100,r.typeName="Forguncy.SpreadJSViewButtonCellType",!r.calcSheetName)?r:(r.initListviewInfo(n),f=r.listviewInfo.cellMetaData.StyleInfo.Background,f&&r.buttonBackColor(f),r._updateMargin(),r)}return __extends(e,u),Object.defineProperty(e.prototype,"listviewInfo",{get:function(){return this.__listviewInfo},enumerable:!1,configurable:!0}),e.prototype.initListviewInfo=function(n){n===void 0&&(n=null);this.__listviewInfo=new f(n,this.calcSheetName,this.dataColIndex)},e.shouldUse=function(t,i){return i.cellType.constructor===n.ButtonCellType},e.prototype._updateMargin=function(){var t=this.getTemplateStyle(r.Normal),n;t&&(n=this.getMargin(t),this.marginLeft(2+n.left),this.marginRight(2+n.right),this.marginTop(2+n.top),this.marginBottom(2+n.bottom))},e.prototype.paint=function(t,r,f,e,o,s,h,c){var a,v,y,p,w,b,k,l=n.CellTypeStyleTemplateUtils.GetStyleTemplateByKey(this.listviewInfo.cellMetaData.CellType.$type.split(",")[0],this.listviewInfo.cellMetaData.CellType.TemplateKey,n.ForguncyData.GlobalSettings.CellTypeStyleTemplates);this.__useNormalStyleFontColorReplaceForeColor=!h.foreColor&&((y=(v=(a=l===null||l===void 0?void 0:l.Styles)===null||a===void 0?void 0:a.BUTTON)===null||v===void 0?void 0:v.NormalStyle)===null||y===void 0?void 0:y.FontColor)?!0:!1;this.__useNormalStyleBackColorReplaceBackColor=!h.backColor&&((b=(w=(p=l===null||l===void 0?void 0:l.Styles)===null||p===void 0?void 0:p.BUTTON)===null||w===void 0?void 0:w.NormalStyle)===null||b===void 0?void 0:b.Background)?!0:!1;this.__backcolorInfo={row:c.row,col:c.col,backColor:(k=h.backColor)===null||k===void 0?void 0:k.toLocaleLowerCase()};h=i.setAlternativeRowColor(c.row,this.listviewInfo.oddRowBackcolor,this.listviewInfo.evenRowBackcolor,h,this.listviewInfo.listViewStyleTemplate);u.prototype.paint.call(this,t,r,f,e,o,s,h,c)},e.prototype.getButtonState=function(n,t,i){return n.getActiveRowIndex()!==t||n.getActiveColumnIndex()!==i?r.Normal:this.buttonState()},e.prototype.setRoundRectBackground=function(n,t,i,r,u,f){var c,h,l,w,b;if(t.indexOf("gradient")>-1){if(c=t.slice(0,t.indexOf("(")),h=t.slice(t.indexOf("(")+1),c==="linear-gradient"){var v=h.substring(0,h.length-2).split(", "),y=v[0],p=v.slice(1),a=isNaN(parseInt(y))?0:parseInt(y);a=(a+180+90)%360/360;var e=a*2*Math.PI,o=void 0,s=void 0;e<=Math.PI/2?(o=(i*(3+Math.cos(2*e))+r*Math.sin(2*e))/4,s=(r*(3-Math.cos(2*e))+i*Math.sin(2*e))/4):e<=Math.PI?(e=e-Math.PI/2,o=(i*(1+Math.cos(2*e))-r*Math.sin(2*e))/4,s=(r*(3+Math.cos(2*e))+i*Math.sin(2*e))/4):e<=3*Math.PI/2?(e=e-Math.PI,o=(i*(1-Math.cos(2*e))-r*Math.sin(2*e))/4,s=(r*(1+Math.cos(2*e))-i*Math.sin(2*e))/4):(e=e-3*Math.PI/2,o=(i*(3-Math.cos(2*e))+r*Math.sin(2*e))/4,s=(r*(1-Math.cos(2*e))-i*Math.sin(2*e))/4);w=i-o;b=r-s;l=n.createLinearGradient(u+w,f+b,u+o,f+s);p.forEach(function(n){var t=n.trim().split(" ").map(function(n){return n.trim()}),r=t[0],u=t[1],i=parseFloat(u)/100;isNaN(i)||l.addColorStop(i,r)})}else if(c==="radial-gradient"){var p=h.substring(0,h.length-2).split(", "),nt=Math.max(i,r)/2*1.1,k=u+i/2,d=f+r/2,g=n.createRadialGradient(k,d,0,k,d,nt);p.forEach(function(n){var t=n.trim().split(" ").map(function(n){return n.trim()}),r=t[0],u=t[1],i=parseFloat(u)/100;isNaN(i)||g.addColorStop(i,r)});n.fillStyle=g}n.fillStyle=l}else n.fillStyle=t},e.prototype.drawBackGround=function(n,t,i,r,u,f,e){var a=0,s=n,h=t,c=i,l=r,o={tr:u.tr,tl:u.tl,bl:u.bl,br:u.br};Object.keys(e).forEach(function(n){var t=e[n];t.width===1&&a++});a===4&&(s=s+.75,h=h+.75,c=c-.75,l=l-.75);o=this.updateRadius(o,c,l);f.beginPath();f.moveTo(s+o.tl,h);f.lineTo(s+c-o.tr,h);f.arc(s+c-o.tr,h+o.tr,o.tr,Math.PI/180*270,0,!1);f.lineTo(s+c,h+l-o.br);f.arc(s+c-o.br,h+l-o.br,o.br,0,Math.PI/2,!1);f.lineTo(s+o.bl,h+l);f.arc(s+o.bl,h+l-o.bl,o.bl,Math.PI/2,Math.PI*1,!1);f.lineTo(s,h+o.tl);f.arc(s+o.tl,h+o.tl,o.tl,Math.PI*1,Math.PI/180*270,!1);f.closePath();f.fill()},e.prototype.drawBorder=function(n,t,i,r,u,f,e){var c,o;f=this.updateRadius(f,r,u);var s=function(t,i,r,u,f){n.beginPath();n.moveTo(t,i);n.lineTo(r,u);n.setLineDash&&n.setLineDash(f.lineDash||[]);n.lineWidth=f.width;n.strokeStyle=f.color;n.stroke()},l=function(n,t,i,r,u,f){if(f[u].width!==1)return[n,t,i,r];switch(u){case"bottom":return[n,t-.5,i,r-.5];case"left":return[n+.5,t,i+.5,r];case"right":return[n-.5,t,i-.5,r];case"top":return[n,t+.5,i,r+.5]}},h=function(n,t,i,r,u,f,e){var y=l(n,t,i,r,f,u),h=y[0],c=y[1],a=y[2],v=y[3],o=u[f];if(o.width!==0&&o.type!==0)if(o.type===1)s(h,c,a,v,o);else if(o.type===2){s(h,c,a,v,__assign(__assign({},o),{width:1}));var p=Math.max(2.5-e.tl,0),w=Math.max(2.5-e.tr,0),b=Math.max(2.5-e.br,0),k=Math.max(2.5-e.bl,0);switch(f){case"top":return s(h-w,c+2.5,a+p,v+2.5,__assign(__assign({},o),{width:1}));case"right":return s(h-2.5,c+w,a-2.5,v-b,__assign(__assign({},o),{width:1}));case"left":return s(h+2.5,c+p,a+2.5,v-k,__assign(__assign({},o),{width:1}));case"bottom":return s(h-b,c-2.5,a+k,v-2.5,__assign(__assign({},o),{width:1}))}}};h(t+r-f.br,i+u,t+f.bl,i+u,e,"bottom",f);h(t+r-f.tr,i,t+f.tl,i,e,"top",f);h(t,i+f.tl,t,i+u-f.bl,e,"left",f);h(t+r,i+f.tr,t+r,i+u-f.br,e,"right",f);c=function(t,i,r,u,f,e){var o=e;(r.width===1&&(o=o-.5,o=Math.max(o,0)),o<=0)||(n.beginPath(),n.setLineDash&&n.setLineDash(r.lineDash||[]),n.lineWidth=r.width,n.strokeStyle=r.color,n.arc(t,i,o,u,f),n.stroke())};o=function(n,t,i,r,u,f,e){var o=f[e];if(o!==0&&i.width!==0&&i.type!==0){if(i.type===1)return c(n,t,i,r,u,o);i.type===2&&(c(n,t,__assign(__assign({},i),{width:1}),r,u,o),c(n,t,__assign(__assign({},i),{width:1}),r,u,Math.max(o-2.5,0)))}};o(t+f.tl,i+f.tl,e.left,1*Math.PI,1.25*Math.PI,f,"tl");o(t+f.tl,i+f.tl,e.top,1.25*Math.PI,1.5*Math.PI,f,"tl");o(t+r-f.tr,i+f.tr,e.top,1.5*Math.PI,1.75*Math.PI,f,"tr");o(t+r-f.tr,i+f.tr,e.right,1.75*Math.PI,2*Math.PI,f,"tr");o(t+r-f.br,i+u-f.br,e.right,0,.25*Math.PI,f,"br");o(t+r-f.br,i+u-f.br,e.bottom,.25*Math.PI,.5*Math.PI,f,"br");o(t+f.bl,i+u-f.bl,e.bottom,.5*Math.PI,.75*Math.PI,f,"bl");o(t+f.bl,i+u-f.bl,e.left,.75*Math.PI,1*Math.PI,f,"bl")},e.prototype.parseBorderString=function(t){var i={type:1,width:0,color:"#000000",lineDash:undefined};if(!t)return i;var r=n.ColorHelper.ConvertBorder(t).split(" "),u=r[0],f=r[1],e=r[2];i.width=parseFloat(u);isNaN(i.width)&&(i.width=0);i.color=n.ColorHelper.Convert(e);switch(f){case"dotted":i.lineDash=[3,3];break;case"dashed":i.lineDash=[5,2];break;case"double":return i.type=2,i}return i},e.prototype.getBroderSetting=function(n){return{top:this.parseBorderString(n.BorderTopString||n.BorderString),left:this.parseBorderString(n.BorderLeftString||n.BorderString),right:this.parseBorderString(n.BorderRightString||n.BorderString),bottom:this.parseBorderString(n.BorderBottomString||n.BorderString)}},e.prototype.getRadius=function(n){if(n){var t=n.split(" ").map(function(n){return parseInt(n)}).map(function(n){return isNaN(n)?0:n});return{tl:t[0],tr:t[1],br:t[2],bl:t[3]}}},e.prototype.updateRadius=function(n,t,i){var u;if(n){var f=Math.max(n.tl+n.tr,n.bl+n.br),e=Math.max(n.tl+n.bl,n.tr+n.br),r=1;if(f>t&&(r=f/t),e>i&&(r=Math.max(r,e/i)),r>1)return u={},u.tl=n.tl/r,u.tr=n.tr/r,u.bl=n.bl/r,u.br=n.br/r,u}return n},e.prototype.getPadding=function(n){return{top:n.PaddingTop||0,right:n.PaddingRight||0,bottom:n.PaddingBottom||0,left:n.PaddingLeft||0}},e.prototype.getMargin=function(n){return{top:n.MarginTop||0,right:n.MarginRight||0,bottom:n.MarginBottom||0,left:n.MarginLeft||0}},e.prototype.drawRoundRect=function(n,t,i,r,u,f,e,o){this.setRoundRectBackground(n,f,r,u,t,i);this.drawBackGround(t,i,r,u,e,n,o);this.drawBorder(n,t,i,r,u,e,o)},e.prototype.isHover=function(n,t){return n<this.__hoveredY&&this.__hoveredY<n+t},e.prototype.paintValue=function(t,i,u,f,e,o,s,h){var ut,ft,et,ot,st,ht,ct,p,w,k,y,at,rt,tt,b,vt;if(t&&h.sheet){p=h.row===((ut=this.__backcolorInfo)===null||ut===void 0?void 0:ut.row)&&h.col===((ft=this.__backcolorInfo)===null||ft===void 0?void 0:ft.col)?this.__backcolorInfo.backColor:undefined;w=this.listviewInfo.listViewStyleTemplate;(p===((et=n.ColorHelper.Convert(w===null||w===void 0?void 0:w.RowHoverBack))===null||et===void 0?void 0:et.toLocaleLowerCase())||p===((ot=n.ColorHelper.Convert(w===null||w===void 0?void 0:w.RowSelectBack))===null||ot===void 0?void 0:ot.toLocaleLowerCase()))&&(p=undefined);k=(st=s.foreColor)===null||st===void 0?void 0:st.toLocaleLowerCase();(k===((ht=n.ColorHelper.Convert(w===null||w===void 0?void 0:w.RowHoverFore))===null||ht===void 0?void 0:ht.toLocaleLowerCase())||k===((ct=n.ColorHelper.Convert(w===null||w===void 0?void 0:w.RowSelectFore))===null||ct===void 0?void 0:ct.toLocaleLowerCase()))&&(k=undefined);var lt={bl:0,br:0,tl:0,tr:0},it,d=this.getPadding({}),g=this.getMargin({}),nt=this.getButtonState(h.sheet,h.row,h.col);this.isHover(f,o)&&nt===r.Normal&&(nt=r.Hover);y=this.getTemplateStyle(nt);y&&(at=this.getTemplateStyle(r.Normal),k=this.__useNormalStyleFontColorReplaceForeColor?n.ColorHelper.Convert(y.FontColor||at.FontColor):n.ColorHelper.Convert(k||y.FontColor),p=this.__useNormalStyleBackColorReplaceBackColor?n.ColorHelper.Convert(y.Background||at.Background):n.ColorHelper.Convert(p||y.Background),rt=n.CSSHelper.getCssFontInfoFromCssFontString(s.font),y.Bold&&(rt.fontWeight="bold"),y.Italic&&(rt.fontStyle="italic"),y.Underline&&(s.textDecoration=1),s.font=n.CSSHelper.getCssFontStringFromCssFontInfo(rt),it=this.getBroderSetting(y),lt=this.getRadius(y.BorderRadiusString)||lt,d=this.getPadding(y),g=this.getMargin(y));var c=u+2+g.left,l=f+2+g.top,a=e-4-g.left-g.right,v=o-4-g.top-g.bottom,wt=c+a>u&&c<u+e&&l+v>f&&l<f+o;if(a-2>0&&v-2>0&&wt){t.save();(c<u||c+a>u+e||l<f||l+v>f+o)&&(t.rect(u,f,e,o),t.clip());t.beginPath();p=n.ColorHelper.Convert(p);p=p||(nt===r.Pressed?n.ColorHelper.Convert("Accent 1"):"linear-gradient(180deg, #ECECEC 0.00%, #D5D5D5 100.00%)");tt={color:"#707070",width:1,type:1};it=it||{top:tt,left:tt,right:tt,bottom:tt};this.drawRoundRect(t,c,l,a,v,p,lt,it);!y&&s.backColor&&(b=nt===r.Pressed,t.strokeStyle="#646464",t.strokeRect(c+.5,l+.5,a-1,v-1),t.beginPath(),t.strokeStyle=b?"#ffffff":"#696969",t.moveTo(c+1.5,l+v-1.5),t.lineTo(c+a-1.5,l+v-1.5),t.stroke(),t.beginPath(),t.strokeStyle=b?"#ffffff":"#696969",t.moveTo(c+a-1.5,l+1.5),t.lineTo(c+a-1.5,l+v-1.5),t.stroke(),t.beginPath(),t.strokeStyle=b?"#696969":"#ffffff",t.moveTo(c+1.5,l+1.5),t.lineTo(c+a-1.5,l+1.5),t.stroke(),t.beginPath(),t.strokeStyle=b?"#696969":"#ffffff",t.moveTo(c+1.5,l+1.5),t.lineTo(c+1.5,l+v-1.5),t.stroke(),t.beginPath(),t.strokeStyle=b?"#f0f0f0":"#a0a0a0",t.moveTo(c+2.5,l+v-2.5),t.lineTo(c+a-2.5,l+v-2.5),t.stroke(),t.beginPath(),t.strokeStyle=b?"#f0f0f0":"#a0a0a0",t.moveTo(c+a-2.5,l+2.5),t.lineTo(c+a-2.5,l+v-2.5),t.stroke(),t.beginPath(),t.strokeStyle=b?"#a0a0a0":"#f0f0f0",t.moveTo(c+2.5,l+2.5),t.lineTo(c+a-2.5,l+2.5),t.stroke(),t.beginPath(),t.strokeStyle=b?"#a0a0a0":"#f0f0f0",t.moveTo(c+2.5,l+2.5),t.lineTo(c+2.5,l+v-2.5),t.stroke(),t.fillStyle!==p&&(t.fillStyle=p),t.fillRect(c+3,l+3,a-6,v-6));t.restore();var bt=c+d.left,kt=l+d.top,yt=a-d.left-d.right,pt=v-d.top-d.bottom;pt>0&&yt>0&&(vt=this.cloneStyle(s),vt.foreColor=k,GC.Spread.Sheets.CellTypes.Text.prototype.paintValue.call(this,t,i,bt,kt,yt,pt,vt,h))}}},e.prototype.cloneStyle=function(n){var i=n.cellType,t=null;try{n.cellType=undefined;t=n.clone();t.cellType=i}finally{n.cellType=i}return t},e.prototype.getTemplateStyle=function(t){var u=n.CellTypeStyleTemplateUtils.GetStyleTemplateByKey(this.listviewInfo.cellMetaData.CellType.$type.split(",")[0],this.listviewInfo.cellMetaData.CellType.TemplateKey,n.ForguncyData.GlobalSettings.CellTypeStyleTemplates),i;if(u){i=u.Styles.BUTTON.NormalStyle;switch(t){case r.Hover:i=__assign(__assign({},i),u.Styles.BUTTON.HoverStyle);break;case r.Pressed:i=__assign(__assign({},i),u.Styles.BUTTON.ActiveStyle)}return i}return null},e.prototype.overflow=function(n,t,i,r,u,f,e){return GC.Spread.Sheets.CellTypes.Text.prototype.overflow.call(this,n,t,i,r,u,f,e)},e.prototype.getAutoFitWidth=function(n,t,i,r,f){return this.text(t),u.prototype.getAutoFitWidth.call(this,n,t,i,r,f)},e.prototype.getAutoFitHeight=function(n,t,i,r,f){return this.text(t),u.prototype.getAutoFitHeight.call(this,n,t,i,r,f)},e.prototype.processMouseEnter=function(n){return n&&(this.__hoveredY=n.cellRect.y,n.sheet.repaint(n.cellRect)),u.prototype.processMouseEnter.call(this,n)},e.prototype.processMouseMove=function(n){var f=this.__hoveredY,r=!1,t;return(n===null||n===void 0?void 0:n.isReservedLocation)?(this.__hoveredY=n.cellRect.y,r=f===-100):(this.__hoveredY=-100,r=f!==-100),r&&n.sheet.repaint(n.cellRect),t=this.listviewInfo.cellMetaData.CellType,(t===null||t===void 0?void 0:t.CommandList)&&i.shouldUsePointerCursor(t.CommandList)&&i.processMouseMove(n),u.prototype.processMouseMove.call(this,n)},e.prototype.processMouseLeave=function(n){n&&(this.__hoveredY=-100,n.sheet.repaint(n.cellRect));var t=this.listviewInfo.cellMetaData.CellType;return(t===null||t===void 0?void 0:t.CommandList)&&i.shouldUsePointerCursor(t.CommandList)&&i.processMouseLeave(n),u.prototype.processMouseLeave.call(this,n)},e.prototype.toJSON=function(){return t.toJSON(this,this.calcSheetName,this.dataColIndex)},e.prototype.fromJSON=function(n){t.fromJSON(n,this);this.initListviewInfo()},e}(GC.Spread.Sheets.CellTypes.Button);n.SpreadJSViewButtonCellType=a;t.register(a.shouldUse,a),function(n){n[n.Normal=0]="Normal";n[n.Hover=1]="Hover";n[n.Pressed=2]="Pressed"}(r||(r={}));v=function(n){function r(t,i,r){var u=n.call(this)||this;return(u.calcSheetName=i,u.dataColIndex=r,!u.calcSheetName)?u:(u.initListviewInfo(t),u)}return __extends(r,n),Object.defineProperty(r.prototype,"listviewInfo",{get:function(){return this.__listviewInfo},enumerable:!1,configurable:!0}),r.prototype.initListviewInfo=function(n){n===void 0&&(n=null);this.__listviewInfo=new f(n,this.calcSheetName,this.dataColIndex,this.isNormalCell())},r.prototype.isNormalCell=function(){return!0},r.prototype.paint=function(t,r,u,f,e,o,s,h){s=i.setAlternativeRowColor(h.row,this.listviewInfo.oddRowBackcolor,this.listviewInfo.evenRowBackcolor,s,this.listviewInfo.listViewStyleTemplate);n.prototype.paint.call(this,t,r,u,f,e,o,s,h)},r.prototype.toJSON=function(){return t.toJSON(this,this.calcSheetName,this.dataColIndex)},r.prototype.fromJSON=function(t){n.prototype.fromJSON.call(this,t);this.initListviewInfo()},r}(GC.Spread.Sheets.CellTypes.Text);n.SpreadJSViewCellTypeBase=v;y=function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u.__textCache={},u.typeName="Forguncy.SpreadJSViewTextCellType",u}return __extends(t,n),t.prototype.isTransformText=function(){var t,i,r,u,n=(t=this.listviewInfo)===null||t===void 0?void 0:t.cellMetaData;return((i=n===null||n===void 0?void 0:n.CellType)===null||i===void 0?void 0:i.$type)==="Forguncy.DropDownListCellType, ServerDesignerCommon"||((r=n===null||n===void 0?void 0:n.CellType)===null||r===void 0?void 0:r.$type)==="Forguncy.RadioGroupCellType, ServerDesignerCommon"||((u=n===null||n===void 0?void 0:n.CellType)===null||u===void 0?void 0:u.$type)==="Forguncy.CheckBoxGroupCellType, ServerDesignerCommon"?!0:!1},t.prototype.getText=function(n,t){return this.isTransformText()?this.format(n,null,null,t):n},t.prototype.format=function(t,i,r,f){var e,o,h,s;if(!((e=this.listviewInfo)===null||e===void 0?void 0:e.cellMetaData))return n.prototype.format.call(this,t,i,r);this.isTransformText()&&(t=f.sheet.getValue(f.row,f.col));try{return h=u.getFormulaListRowInfo(f,this.listviewInfo.listview),s=u.getDisplayText(t,this.listviewInfo.visibleColumnInfo.cellType,i,h,r),this.__textCache[t+""]=s,s}catch(c){return(o=this.__textCache[t+""])!==null&&o!==void 0?o:t+""}},t}(v);n.SpreadJSViewTextCellType=y;ot=function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u.typeName="Forguncy.SpreadJSViewTotalRowCellType",u}return __extends(t,n),t.prototype.paint=function(t,i,r,u,f,e,o,s){this.forceBackColor&&(o.backColor=this.forceBackColor);n.prototype.paint.call(this,t,i,r,u,f,e,o,s)},t.prototype.isNormalCell=function(){return!1},t}(y);n.SpreadJSViewTotalRowCellType=ot;s=function(r){function u(n,t,i){var u=r.call(this)||this;return(u.calcSheetName=t,u.dataColIndex=i,u.__isMouseDownReservedLocation=!1,!u.calcSheetName)?u:(u.initListviewInfo(n),u)}return __extends(u,r),Object.defineProperty(u.prototype,"listviewInfo",{get:function(){return this.__listviewInfo},enumerable:!1,configurable:!0}),u.prototype.initListviewInfo=function(n){n===void 0&&(n=null);this.__listviewInfo=new f(n,this.calcSheetName,this.dataColIndex)},Object.defineProperty(u.prototype,"isMouseDownReservedLocation",{get:function(){return this.__isMouseDownReservedLocation},set:function(n){this.__isMouseDownReservedLocation=n},enumerable:!1,configurable:!0}),u.prototype.getHitInfo=function(n,t,r,u,f){return this.allowTriggerCommand(f.sheet,f.row,f.col)?i.getHitInfo(n,t,r,u,GC.Spread.Sheets.SheetArea.viewport,f):null},u.prototype.activateEditor=function(n,t,u,f){r.prototype.activateEditor.call(this,n,t,u,f);var e=n&&f&&f.sheet;if(e)$(n).on("click",function(){i.triggerButtonClicked(e,e.getActiveRowIndex(),e.getActiveColumnIndex(),f.sheetArea,GC.Spread.Sheets.SheetArea.viewport)})},u.prototype.processMouseDown=function(n){return i.processMouseDown(this,n)},u.prototype.processMouseUp=function(n){if(!n)return!1;var t=n.sheet;return i.processMouseUp(this,n,t.getActiveRowIndex(),t.getActiveColumnIndex(),GC.Spread.Sheets.SheetArea.viewport,this.onClick)},u.prototype.onClick=function(){},u.prototype.processMouseMove=function(n){if(n){var t=n.sheet;t&&n.isReservedLocation&&this.allowTriggerCommand(t,n.row,n.col)&&i.processMouseMove(n)}},u.prototype.processMouseLeave=function(n){if(n){var t=n.sheet;t&&n.isReservedLocation&&(this.isMouseDownReservedLocation=!1,this.allowTriggerCommand(t,n.row,n.col)&&i.processMouseLeave(n))}},u.prototype.allowTriggerCommand=function(){return!0},u.prototype.toJSON=function(){return t.toJSON(this,this.calcSheetName,this.dataColIndex)},u.prototype.fromJSON=function(n){r.prototype.fromJSON.call(this,n);this.initListviewInfo()},u.prototype.evaluateFormula=function(t,i){var r,u=this.listviewInfo.listview,f=(r={},r[this.calcSheetName]=u.mappedRowIndexFrowView(i),r);return n.ForguncyData.pageInfo.formulaManager.evaluateFormula(t,{runTimePageName:u.runTimePageName,nullAsException:!1,listInfo:f,rowOffset:0,columnOffset:0})},u}(GC.Spread.Sheets.CellTypes.Base);n.SpreadJSCommandCellTypeBase=s;p=function(t){function r(n,i,r){var u=t.call(this,n,i,r)||this;return u.typeName="Forguncy.SpreadJSViewHyperLinkCellType",u}return __extends(r,t),r.shouldUse=function(t,i){return i.cellType.constructor===n.HyperlinkCellType},r.prototype.paint=function(n,r,u,f,e,o,s,h){s=i.setAlternativeRowColor(h.row,this.listviewInfo.oddRowBackcolor,this.listviewInfo.evenRowBackcolor,s,this.listviewInfo.listViewStyleTemplate);t.prototype.paint.call(this,n,r,u,f,e,o,s,h)},r.prototype.allowTriggerCommand=function(t,i,r){var u=t.getText(i,r);return!n.Common.IsEmpty(u)},r}(s);n.SpreadJSViewHyperLinkCellType=p;t.register(p.shouldUse,p);w=function(t){function u(n,i,r){var f=t.call(this,n,i,r)||this,u;return(f.__hoveredY=-100,f.__pressY=-100,!i)?f:(u=f.listviewInfo.cellMetaData.CellType,u.ImageSizeMode===undefined&&(u.ImageSizeMode=0),u.HorizontalAlignment===undefined&&(u.HorizontalAlignment=1),u.VerticalAlignment===undefined&&(u.VerticalAlignment=1),f)}return __extends(u,t),u.prototype.getAutoFitWidth=function(){return this.listviewInfo.visibleColumnInfo.columnInfo.Width},u.shouldUse=function(t,i){return i.cellType.constructor===n.ImageCellType},u.prototype.paint=function(u,f,e,o,s,h,c,l){var p,w,b,k=this.listviewInfo.cellMetaData.CellType,d=(p=c.foreColor)===null||p===void 0?void 0:p.toLocaleLowerCase(),y=n.CellTypeStyleTemplateUtils.GetStyleTemplateByKey(k.$type.split(",")[0],k.TemplateKey,n.ForguncyData.GlobalSettings.CellTypeStyleTemplates),g=r.Normal,a,v;if(this.isPress(o,h)?g=r.Pressed:this.isHover(o,h)&&(g=r.Hover),y){a=y.Styles.CONTAINER.NormalStyle;switch(g){case r.Hover:a=__assign(__assign({},a),y.Styles.CONTAINER.HoverStyle);break;case r.Pressed:a=__assign(__assign({},a),y.Styles.CONTAINER.ActiveStyle)}}v=this.listviewInfo.listViewStyleTemplate;c=i.setAlternativeRowColor(l.row,this.listviewInfo.oddRowBackcolor,this.listviewInfo.evenRowBackcolor,c,v);(a===null||a===void 0?void 0:a.FontColor)&&(d&&d!==((w=n.ColorHelper.Convert(v===null||v===void 0?void 0:v.RowHoverFore))===null||w===void 0?void 0:w.toLocaleLowerCase())&&d!==((b=n.ColorHelper.Convert(v===null||v===void 0?void 0:v.RowSelectFore))===null||b===void 0?void 0:b.toLocaleLowerCase())||(c.foreColor=n.ColorHelper.Convert(a.FontColor)));n.ImageDataHelper.IsBase64Svg(f)||(f=n.ImageHelper.encodeImageUrlAndUpdateQuery(f,s,h));this.paintBackground(u,f,e,o,s,h,c.backColor,c.foreColor,l,a);c.backColor=undefined;t.prototype.paint.call(this,u,n.Common.getMultiLanguageWord(k.Text),e,o,s,h,c,l)},u.prototype.paintBackground=function(t,i,r,u,f,e,o,s,h,c){var tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,nt,l,dt;if(t){var k=this.listviewInfo.cellMetaData.CellType,d=i,g=GC.Spread.Sheets.ImageLayout.none,y=r,p=u,a=f,v=e,wt=0,bt=0,kt=k.ImageSizeMode,w=k.HorizontalAlignment,b=k.VerticalAlignment;n.ImageDataHelper.IsSvg(d)&&(k&&(pt=k.Color,k.UseCellForeColor&&(pt=s),nt=n.ImageDataHelper.GetColoredSvgRectInfo(d,pt),nt&&(d=nt.value,wt=nt.width,bt=nt.height),c||(a>10&&(a-=6,y+=3),v>10&&(v-=6,p+=3))),kt=1,w=n.CellHorizontalAlignment.Center,b=n.CellVerticalAlignment.Center);c&&(v=v-((tt=c.MarginTop)!==null&&tt!==void 0?tt:0)-((it=c.MarginBottom)!==null&&it!==void 0?it:0),a=a-((rt=c.MarginLeft)!==null&&rt!==void 0?rt:0)-((ut=c.MarginRight)!==null&&ut!==void 0?ut:0),y+=(ft=c.MarginLeft)!==null&&ft!==void 0?ft:0,p+=(et=c.MarginTop)!==null&&et!==void 0?et:0);v<=0&&(v=0);a<=0&&(a=0);switch(kt){case 2:g=GC.Spread.Sheets.ImageLayout.stretch;break;case 1:if(g=GC.Spread.Sheets.ImageLayout.zoom,l=this.getImageSize(d,h),l===null)break;if(v>0&&l.height>0&&a/v>l.width/l.height){if(w===n.CellHorizontalAlignment.Center)break;a=l.width/l.height*v;w===n.CellHorizontalAlignment.Right&&(y=y+f-a-((ot=c===null||c===void 0?void 0:c.MarginRight)!==null&&ot!==void 0?ot:0)-((st=c===null||c===void 0?void 0:c.MarginLeft)!==null&&st!==void 0?st:0))}else if(a>0&&l.width>0&&v/a>l.height/l.width){if(b===n.CellVerticalAlignment.Center)break;v=l.height/l.width*a;b===n.CellVerticalAlignment.Bottom&&(p=p+e-v-((ht=c===null||c===void 0?void 0:c.MarginBottom)!==null&&ht!==void 0?ht:0)-((ct=c===null||c===void 0?void 0:c.MarginTop)!==null&&ct!==void 0?ct:0))}break;case 0:if(w===n.CellHorizontalAlignment.Left&&b===n.CellVerticalAlignment.Top)g=GC.Spread.Sheets.ImageLayout.none;else if(w===n.CellHorizontalAlignment.Center&&b===n.CellVerticalAlignment.Center)g=GC.Spread.Sheets.ImageLayout.center;else{if(g=GC.Spread.Sheets.ImageLayout.none,l=this.getImageSize(d,h),l===null)break;l.width<a&&(a=l.width,w===n.CellHorizontalAlignment.Center?y=y+f/2-a/2:w===n.CellHorizontalAlignment.Right&&(y=y+f-a-((lt=c===null||c===void 0?void 0:c.MarginRight)!==null&&lt!==void 0?lt:0)-((at=c===null||c===void 0?void 0:c.MarginLeft)!==null&&at!==void 0?at:0)));l.height<v&&(v=l.height,b===n.CellVerticalAlignment.Center?p=p+e/2-v/2:b===n.CellVerticalAlignment.Bottom&&(p=p+e-v-((vt=c===null||c===void 0?void 0:c.MarginBottom)!==null&&vt!==void 0?vt:0)-((yt=c===null||c===void 0?void 0:c.MarginTop)!==null&&yt!==void 0?yt:0)))}}dt={x:y,y:p,width:a,height:v};n.SpreadJSHelpMethods.CellTypeContext.paintBackground(t,r,u,f,e,o,d,g,h.imageLoader,wt,bt,dt)}},u.prototype.getImageSize=function(t,i){var r=null,u={drawImage:function(n){r=n}};return n.SpreadJSHelpMethods.CellTypeContext.paintBackgroundImage(u,0,0,0,0,t,1,i.imageLoader),r===null?null:{width:r.width,height:r.height}},u.prototype.getHitInfo=function(n,t,r,u,f){return i.getHitInfo(n,t,r,u,GC.Spread.Sheets.SheetArea.viewport,f)},u.prototype.allowTriggerCommand=function(){var n=this.listviewInfo.cellMetaData.CellType;return(n===null||n===void 0?void 0:n.CommandList)?i.shouldUsePointerCursor(n.CommandList):!1},u.prototype.isHover=function(n,t){return n<this.__hoveredY&&this.__hoveredY<n+t},u.prototype.isPress=function(n,t){return n<this.__pressY&&this.__pressY<n+t},u.prototype.processMouseMove=function(n){if(n){this.__hoveredY===-100&&(this.__hoveredY=n.cellRect.y,n.sheet.repaint(n.cellRect));var i=n.sheet;return i&&n.isReservedLocation&&this.showTooltip(n),t.prototype.processMouseMove.call(this,n)}},u.prototype.processMouseLeave=function(n){if(n){this.__hoveredY=-100;this.__pressY=-100;n.sheet.repaint(n.cellRect);var i=n.sheet;return i&&n.isReservedLocation&&this.hideTooltip(),t.prototype.processMouseLeave.call(this,n)}},u.prototype.showTooltip=function(t){var f=t.sheet,r=f.tag(),u=this.getTooltipContent(r.ListviewCalcSheetName,t.row),i;if(n.Common.IsEmpty(u)){this.hideTooltip();return}this.__tooltipElment||(i=this.getTooltipElement(),i.text(u),$("body").append(i),this.refreshTooltipLocation(i,t.cellRect.x+t.cellRect.width+5,t.cellRect.y+t.cellRect.height+5,r.ListviewCalcSheetName))},u.prototype.refreshTooltipLocation=function(n,t,i,r){var u=$("#"+r),f=u.offset();i=Math.min(i,u.outerHeight()-n.outerHeight());t=Math.min(t,u.outerWidth()-n.outerWidth());i=Math.max(0,i+f.top);t=Math.max(0,t+f.left);n.css("top",i).css("left",t)},u.prototype.hideTooltip=function(){this.__tooltipElment&&(this.__tooltipElment.remove(),this.__tooltipElment=null)},u.prototype.getTooltipContent=function(n,t){return this.evaluateFormula(this.listviewInfo.cellMetaData.CellType.ToolTip,t)},u.prototype.getTooltipElement=function(){if(!this.__tooltipElment){var t=n.DomUtilities.createJqueryDomElement("div");t.addClass("gc-spread-toolTip ui-state-default ui-widget-content btn-default").css("position","absolute").css("padding","0px 3px 0px 3px").css("font","11pt calibri").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css("white-space","pre-wrap").css("z-index",100).width("auto").height("auto");this.__tooltipElment=t}return this.__tooltipElment},u.prototype.processMouseDown=function(n){return n&&this.__pressY===-100&&(this.__pressY=n.cellRect.y,n.sheet.repaint(n.cellRect)),t.prototype.processMouseDown.call(this,n)},u.prototype.processMouseUp=function(n){return this.__pressY!==-100&&(this.__pressY=-100,n.sheet.repaint(n.cellRect)),t.prototype.processMouseUp.call(this,n)},u}(s);n.SpreadJSViewImageCellTypeBase=w;b=function(t){function i(n,i,r){var u=t.call(this,n,i,r)||this;return u.typeName="Forguncy.SpreadJSViewImageCellType",u}return __extends(i,t),i.prototype.paintBackground=function(t,i,r,u,f,e,o,s,h,c){var rt,w,ut,ft,et,ot,st,ht,at,g,p,it;if(t){var l=this.listviewInfo.cellMetaData.CellType,a=i,d=GC.Spread.Sheets.ImageLayout.none,b=r,k=u,v=f,y=e;c?(y=y-((ut=c.MarginTop)!==null&&ut!==void 0?ut:0)-((ft=c.MarginBottom)!==null&&ft!==void 0?ft:0),v=v-((et=c.MarginLeft)!==null&&et!==void 0?et:0)-((ot=c.MarginRight)!==null&&ot!==void 0?ot:0),b+=(st=c.MarginLeft)!==null&&st!==void 0?st:0,k+=(ht=c.MarginTop)!==null&&ht!==void 0?ht:0):n.ImageDataHelper.IsSvg(a)&&(l.Size||(v>10&&(v-=6,b+=3),y>10&&(y-=6,k+=3)));var ct=0,lt=0,vt=l.ImageSizeMode,nt=l.HorizontalAlignment,tt=l.VerticalAlignment;if(n.ImageDataHelper.IsSvg(a)&&(l?(at=l.Color,l.UseCellForeColor&&(at=s),p=n.ImageDataHelper.GetColoredSvgRectInfo(a,at),p&&(a=p.value,ct=p.width,lt=p.height),nt=l.HorizontalAlignment,tt=l.VerticalAlignment):(nt=n.CellHorizontalAlignment.Center,tt=n.CellVerticalAlignment.Center),vt=1),y<=0&&(y=0),v<=0&&(v=0),n.ImageDataHelper.IsSvg(a))g={width:0,height:0},p=n.ImageDataHelper.GetColoredSvgRectInfo(a,""),p&&(g=this.getSvgImageSize(v,y,l,p)),d=GC.Spread.Sheets.ImageLayout.zoom,rt=this.svgSizeHandle(g,y,v,nt,b,tt,k),b=rt.availableX,k=rt.availableY,it={x:b,y:k,width:g.width,height:g.height},n.SpreadJSHelpMethods.CellTypeContext.paintBackground(t,r,u,f,e,o,a,d,h.imageLoader,ct,lt,it);else{var yt=0,pt=0,wt=0,bt=0;w=this.imageSizeModeHandle(vt,d,a,h,y,v,nt,b,f,c,tt,k,e);d=w.backgroundImageLayout;yt=w.realHeight;pt=w.realWidth;wt=w.realX;bt=w.realY;it={x:wt,y:bt,width:pt,height:yt};n.SpreadJSHelpMethods.CellTypeContext.paintBackground(t,r,u,f,e,o,a,d,h.imageLoader,ct,lt,it)}}},i.prototype.svgSizeHandle=function(t,i,r,u,f,e,o){return u===n.CellHorizontalAlignment.Center?f=f+r/2-t.width/2:u===n.CellHorizontalAlignment.Right&&(f=f+r-t.width),e===n.CellVerticalAlignment.Center?o=o+i/2-t.height/2:e===n.CellVerticalAlignment.Bottom&&(o=o+i-t.height),{availableX:f,availableY:o}},i.prototype.imageSizeModeHandle=function(t,i,r,u,f,e,o,s,h,c,l,a,v){var p,w,b,k,d,g,nt,tt,y;switch(t){case 2:i=GC.Spread.Sheets.ImageLayout.stretch;break;case 1:if(i=GC.Spread.Sheets.ImageLayout.zoom,y=this.getImageSize(r,u),y===null)break;if(f>0&&y.height>0&&e/f>y.width/y.height){if(o===n.CellHorizontalAlignment.Center)break;e=y.width/y.height*f;o===n.CellHorizontalAlignment.Right&&(s=s+h-e-((p=c===null||c===void 0?void 0:c.MarginRight)!==null&&p!==void 0?p:0)-((w=c===null||c===void 0?void 0:c.MarginLeft)!==null&&w!==void 0?w:0))}else if(e>0&&y.width>0&&f/e>y.height/y.width){if(l===n.CellVerticalAlignment.Center)break;f=y.height/y.width*e;l===n.CellVerticalAlignment.Bottom&&(a=a+v-f-((b=c===null||c===void 0?void 0:c.MarginBottom)!==null&&b!==void 0?b:0)-((k=c===null||c===void 0?void 0:c.MarginTop)!==null&&k!==void 0?k:0))}break;case 0:if(o===n.CellHorizontalAlignment.Left&&l===n.CellVerticalAlignment.Top)i=GC.Spread.Sheets.ImageLayout.none;else if(o===n.CellHorizontalAlignment.Center&&l===n.CellVerticalAlignment.Center)i=GC.Spread.Sheets.ImageLayout.center;else{if(i=GC.Spread.Sheets.ImageLayout.none,y=this.getImageSize(r,u),y===null)break;y.width<e&&(e=y.width,o===n.CellHorizontalAlignment.Center?s=s+h/2-e/2:o===n.CellHorizontalAlignment.Right&&(s=s+h-e-((d=c===null||c===void 0?void 0:c.MarginRight)!==null&&d!==void 0?d:0)-((g=c===null||c===void 0?void 0:c.MarginLeft)!==null&&g!==void 0?g:0)));y.height<f&&(f=y.height,l===n.CellVerticalAlignment.Center?a=a+v/2-f/2:l===n.CellVerticalAlignment.Bottom&&(a=a+v-f-((nt=c===null||c===void 0?void 0:c.MarginBottom)!==null&&nt!==void 0?nt:0)-((tt=c===null||c===void 0?void 0:c.MarginTop)!==null&&tt!==void 0?tt:0)))}}return{backgroundImageLayout:i,realHeight:f,realWidth:e,realX:s,realY:a}},i.prototype.shinkToFit=function(n,t){var i=0;return n.width<=t.width&&n.height<=t.height?n:(i=n.width/n.height>t.width/t.height?t.width/n.width:t.height/n.height,{width:n.width*i,height:n.height*i})},i.prototype.getSvgImageSize=function(n,t,i){function f(n,t){var i=n.Size||0;return{Width:Math.min(t.width,i),Height:Math.min(t.height,i)}}var u={width:n,height:t},r;return i.Size?(r=f(i,u),this.shinkToFit({width:r.Width,height:r.Height},{width:n,height:t})):u},i}(w);n.SpreadJSViewImageCellType=b;t.register(b.shouldUse,b);k=function(i){function r(t,r,u){var f=i.call(this,t,r,u)||this,e,o;if(f._uploadImageList=[],f.typeName="Forguncy.SpreadJSViewUploadImageCellType",!r)return f;e=f.listviewInfo.cellMetaData;o=e.Value;try{e.Value=null;f._defaultImagePath=n.ImageHelper.getImageSrcFromCellContentElement(e)}finally{e.Value=o}return f}return __extends(r,i),r.shouldUse=function(t,i){return i.cellType.constructor===n.UploadImageCellType},r.prototype.paint=function(t,r,u,f,e,o,s,h){n.Common.IsEmpty(r)&&(r=this._defaultImagePath);i.prototype.paint.call(this,t,r,u,f,e,o,s,h)},r.prototype.paintValue=function(){},r.prototype._canUpLoadImage=function(){return this.listviewInfo.visibleColumnInfo.canEditInForguncy&&!n.Platform.isMobile()},r.prototype.onClick=function(i){var h=this,u,s;if(this._canUpLoadImage()){var f=this.listviewInfo.cellMetaData,e=f.CellType,r=e.UploadImageLimit,o;f.ServerPropertiesId&&(o=f.ServerPropertiesId.UploadLimit);s=(u=this.evaluateFormula(e.UploadFolder,i.row))===null||u===void 0?void 0:u.toString();n.Common.uploadImageByFileSelector(r,r===null||r===void 0?void 0:r.AllowExtensions,function(r){var u=n.ForguncyData.ForguncyRoot+"Upload/"+n.Common.convertToRealPath(r),f=n.Common.getFileName(r).slice(0,36);h._uploadImageList.push(f);t.executeEditCommand(i.sheet,i.row,i.col,u)},o,s,function(t,i){n.Common.showJQueyXHRErrorMessage(t,i)},null,!0)}},r.prototype.paintBackground=function(t,r,u,f,e,o,s,h,c,l){if(this._uploadImageList&&this._uploadImageList.indexOf(n.Common.getFileGUIDFromPath(r))!=-1){var a=n.Common.getFileName(r);r=n.ForguncyData.ForguncyRoot+"Upload/"+a}i.prototype.paintBackground.call(this,t,r,u,f,e,o,s,h,c,l)},r.prototype.allowTriggerCommand=function(){return this._canUpLoadImage()?!0:!1},r}(w);n.SpreadJSViewUploadImageCellType=k;t.register(k.shouldUse,k);d=function(r){function u(t,i,u){var f=r.call(this,t,i,u)||this,e;return(f.typeName="Forguncy.SpreadJSViewAttachmentCellType",!f.calcSheetName)?f:(e=f.listviewInfo.cellMetaData.StyleInfo,f._font=n.ListViewHelper.SpreadJSStyleHelper.generateFontText(e),f)}return __extends(u,r),Object.defineProperty(u.prototype,"fileLimit",{get:function(){return this.listviewInfo.cellMetaData.CellType.UploadLimit},enumerable:!1,configurable:!0}),u.prototype._canModifyFile=function(){return this.listviewInfo.visibleColumnInfo.canEditInForguncy&&!n.Platform.isMobile()},u.shouldUse=function(t,i){return i.cellType.constructor===n.AttachmentCellType},u.prototype.paint=function(t,r,u,f,e,o,s,h){t&&(s=i.setAlternativeRowColor(h.row,this.listviewInfo.oddRowBackcolor,this.listviewInfo.evenRowBackcolor,s,this.listviewInfo.listViewStyleTemplate),(h===null||h===void 0?void 0:h.parentBackColor)&&h.parentBackColor===s.backColor||n.SpreadJSHelpMethods.CellTypeContext.paintBackground(t,u,f,e,o,s.backColor,s.backgroundImage,s.backgroundImageLayout,h.imageLoader),this.paintValue(t,r,u,f,e,o,s,h))},u.prototype.getIndent=function(t){var i=0,r=t.textIndent;return r>0&&(i=r*n.ListViewHelper.SpreadJSStyleHelper.textIndentToPixel),i},u.prototype.paintValue=function(n,t,i,r,f,e,o,s){var c,l,b,a,v,k,y,h,p;if(n)try{if(n.save(),n.rect(i,r,f,e),n.clip(),n.beginPath(),c=this,l=s.sheet,l){var d=c._getFileNames(t),g=u._startX+i,w=r;for(n.font=o.font,n.textAlign="left",n.fillStyle=o.foreColor,b=c._getActualFileCount(t),b===0&&c.paintText(n,null,g,w,1,1,o,s,"",{value:null}),a=0;a<b;a++)v=c._getTextWidth(d[a],l),c._canModifyFile()&&(k=f-u._addFileButtonWidth-u._addFileButtonPadding*2-u._startX,v>k&&(v=k)),c.paintText(n,t,g,w,v+5+this.getIndent(o),c._getTextHeight(l)+3,o,s,d[a],{value:null}),w+=c._getTextHeight(l)+u._fileVerticalSpace;this._canModifyFile()&&(y=new GC.Spread.Sheets.Rect(i,r,f,e),h=this._getAddFileButtonRect(y),h.x+=y.x,h.y+=y.y,p=n.createLinearGradient(h.x+h.width/2,h.y,h.x+h.width/2,h.y+h.height),p.addColorStop(0,"#ECECEC"),p.addColorStop(1,"#D5D5D5"),n.shadowBlur=2,n.shadowColor="black",n.fillStyle=p,n.fillRect(h.x,h.y,h.width,h.height),c._paintUploadIcon(n,h))}}finally{n.restore()}},u.prototype._paintUploadIcon=function(n,t){try{n.save();var i=5,c=10,e=5,l=4,s=2,h=3,a=16,o=2,f=a,v=i+e+s+o,r=t.y+(t.height-v)/2,u=t.x+(t.width-f)/2;n.fillStyle="#4F4F4F";n.shadowBlur=0;n.fillRect(u,r+i+e+s,a,o);n.fillRect(u,r+i+e+s-h,o,h);n.fillRect(u+f-o,r+i+e+s-h,o,h);n.fillRect(u+(f-l)/2,r+i,l,e);n.moveTo(u+f/2,r);n.lineTo(u+(f-c)/2,r+i);n.lineTo(u+(f-c)/2+c,r+i);n.fill()}finally{n.restore()}},u.prototype.onClick=function(t){var i=t.sheet.getValue(t.row,t.col,t.sheetArea),r=n.Common.IsEmpty(i)?"":i.toString();this._doFileCommand(r,this._getFileCommand(r,t),t)},u.prototype._getFileCommand=function(n,t){var r=this._getFileNames(n),o=t.x-t.cellRect.x,f=t.y-t.cellRect.y,e=this._getAddFileButtonRect(t.cellRect),i;return o>=e.x&&o<=e.x+e.width&&f>=e.y&&f<=e.y+e.height?{command:0}:r.length===0||!this._isHitFileRange(r,o,f,t.sheet)?{command:2}:(i=Math.ceil(f/this._getFileItemHeight(r,t.sheet)),f>=this._getFileItemHeight(r,t.sheet)*i-u._fileVerticalSpace&&f<=this._getFileItemHeight(r,t.sheet)*i)?{command:2}:i>this._getActualFileCount(n)?{command:2}:(--i,o>=u._startX&&o<=u._startX+this._getTextWidth(r[i],t.sheet)?{command:1,fileIndex:i}:{command:2})},u.prototype._isHitFileRange=function(n,t,i,r){var f=this._getFileNameMaxWidth(n,r),e=this._getFileItemHeight(n,r)*n.length;return t>=u._startX&&t<=u._startX+f&&i>=0&&i<=e?!0:!1},u.prototype._doFileCommand=function(n,t,i){switch(t.command){case 0:this._addAttachment(n,i);return;case 1:this._downloadAttachment(this._getFileFullNames(n,!0)[t.fileIndex]);return;case 2:default:return}},u.prototype._addAttachment=function(t,i){var c=this,e,o,l;if(this._canModifyFile()){if(this._isOverMaxUploadCount(t)){alert(n.RS.uploadFileBiggerThanMaxFileCount);return}this.fileLimit&&(l=this.fileLimit.ExtensionFilter);var s=this.listviewInfo.listview,u=-1,f=0,h=[],a=this.listviewInfo.cellMetaData,v=(e=a.ServerPropertiesId)===null||e===void 0?void 0:e.UploadLimit,r=(o=this.evaluateFormula(a.CellType.UploadFolder,i.row))===null||o===void 0?void 0:o.toString();r=n.Common.convertToRealUploadFolder(r!==null&&r!==void 0?r:"");n.Common.updateFile(l,!0,function(e){if(h.push(e),f++,u===f){var l=t.split("|").filter(function(n){return n&&n.trim()!=""}),o=[];l.forEach(function(t){var i=n.Common.getFileName(t),u=n.Common.getFilePath(r,i);o.push(u)});c.onAttachmentsAdded(s,h,i,o.join("|")+"|")}},function(r,e){if(n.Common.showJQueyXHRErrorMessage(r,e),f++,u===f)c.onAttachmentsAdded(s,h,i,t)},this.fileLimit,v,function(n){u===-1&&(u=n);s.showLoadingIndicator()},!0,r)}},u.prototype.onAttachmentsAdded=function(i,r,u,f){var s,h,e,o,c,l;if(i.hiddenLoadingIndicator(),!(r.length<=0)){if(s=this._getFileLimit()===1&&this.fileLimit.ReplaceWhenOneFile,h=this._getFileCount(f),s)r=r.slice(0,1);else if(e=r.length,o=h+e-this._getFileLimit(),o>0){if(alert(n.RS.uploadFileBiggerThanMaxFileCount),e<=o)return;r=r.slice(0,e-o)}c=r.join("|")+"|";l=h===0||s?c:f+c;t.executeEditCommand(u.sheet,u.row,u.col,l)}},u.prototype._downloadAttachment=function(t){var i=n.DomUtilities.createJqueryDomElement("a");i.append(n.DomUtilities.createJqueryDomElement("p"));i.attr("href",n.Helper.SpecialPath.getFileDownloadUrl(t));(t===null||t===void 0?void 0:t.toLowerCase().endsWith(".pdf"))&&i.attr("target","_blank");i.children("p").trigger("click");i=null},u.prototype.getAutoFitWidth=function(n,t,i,f,e){if(e){var o=this;return o._canModifyFile()?u._startX+o._getFileNameMaxWidth(o._getFileNames(n),e.sheet)+u._addFileButtonPadding*2+u._addFileButtonWidth:u._startX+o._getFileNameMaxWidth(o._getFileNames(n),e.sheet)}return r.prototype.getAutoFitWidth.call(this,n,t,i,f,e)},u.prototype.getAutoFitHeight=function(n,t,i,u,f){if(f){var e=this,o=e._getFileNames(n);return e._getFileItemHeight(o,f.sheet)*o.length}return r.prototype.getAutoFitHeight.call(this,n,t,i,u,f)},u.prototype._isOverMaxUploadCount=function(n){return this._getFileCount(n)>=this._getFileLimit()&&(this._getFileLimit()!==1||!this.fileLimit.ReplaceWhenOneFile)},u.prototype._getFileCount=function(n){return this._getFileNames(n).length},u.prototype._getFileLimit=function(){var n;return((n=this.fileLimit)===null||n===void 0?void 0:n.MaxUploadFileCount)?this.fileLimit.MaxUploadFileCount:Number.MAX_VALUE},u.prototype._getActualFileCount=function(n){var t=this,i=t._getFileNames(n);return t._isOverMaxUploadCount(n)?t.fileLimit.MaxUploadFileCount:i.length},u.prototype._getAddFileButtonRect=function(n){var e=this,t=n.width-u._addFileButtonWidth-u._addFileButtonPadding,i=u._addFileButtonPadding,r=u._addFileButtonWidth,f=n.height-u._addFileButtonPadding*2;return new GC.Spread.Sheets.Rect(t,i,r,f)},u.prototype._getFileFullNames=function(t,i){if(i===void 0&&(i=!1),n.Common.IsEmpty(t)||typeof t!="string")return[];return t.split("|").filter(function(t){var i=n.Common.getFileName(t);return!n.Common.IsEmpty(i)&&i.length>37&&i.charAt(36)==="_"&&n.Common.isForguncyFile(i)&&t.indexOf("<")<0}).map(function(t){return i?t:n.Common.getFileName(t)})},u.prototype._getFileNames=function(n){return this._getFileFullNames(n).map(function(n){return n.substring(37)})},u.prototype._getFileNameMaxWidth=function(n,t){var i=this;return Math.max.apply(i,n.map(function(n){return i._getTextWidth(n,t)}))},u.prototype._getFileItemHeight=function(n,t){if(n.length===0)return 0;var i=this;return i._getTextHeight(t)+u._fileVerticalSpace},u.prototype._getTextWidth=function(n,i){return t.getStringWidthByCanvas(n,this._font,i)},u.prototype._getTextHeight=function(n){return t.getTextHeight(this._font,n)},u.prototype.getFileItemPosition=function(t,i,r,f){var e=this,c=f.getValue(t,i),s=f.getCellRect(t,i),o,l,h;if(n.Common.IsEmpty(c))throw new Error("There are no files to select");if(o=e._getFileNames(c.toString()),r<0||r>=o.length)throw new Error("Invalid file index");l=s.x+u._startX;h=s.y;r>0&&(h+=e._getFileItemHeight(o,f)*r);var a=e._getTextWidth(o[r],f),v=s.width-u._addFileButtonWidth-u._addFileButtonPadding*2-u._startX,y=a>v?v:a,p=e._getTextHeight(f);return{x:l,y:h,width:y,height:p}},u.prototype.getAddFileButtonPosition=function(n,t,i){var f=this,u,r;if(!f._canModifyFile())throw Error("There is no Button to add file");return u=i.getCellRect(n,t),r=f._getAddFileButtonRect(u),r.x+=u.x,r.y+=u.y,{x:r.x,y:r.y,width:r.width,height:r.height}},u.prototype.allowTriggerCommand=function(n,t,i){return this._canModifyFile()||n.getValue(t,i)?!0:!1},u._startX=10,u._fileVerticalSpace=5,u._addFileButtonPadding=1,u._addFileButtonWidth=20,u}(s);n.SpreadJSViewAttachmentCellType=d;t.register(d.shouldUse,d);g=function(r){function u(n,t,i){var u=r.call(this)||this;return(u.calcSheetName=t,u.dataColIndex=i,u.typeName="Forguncy.SpreadJSViewBarcodeCellType",!u.calcSheetName)?u:(u.initListviewInfo(n),u)}return __extends(u,r),Object.defineProperty(u.prototype,"listviewInfo",{get:function(){return this.__listviewInfo},enumerable:!1,configurable:!0}),u.prototype.initListviewInfo=function(n){n===void 0&&(n=null);this.__listviewInfo=new f(n,this.calcSheetName,this.dataColIndex)},u.shouldUse=function(t,i){return i.cellType.constructor===n.BarcodeCellType},u.prototype.paint=function(n,t,u,f,e,o,s,h){s=i.setAlternativeRowColor(h.row,this.listviewInfo.oddRowBackcolor,this.listviewInfo.evenRowBackcolor,s,this.listviewInfo.listViewStyleTemplate);this.paintBackground(n,t,u,f,e,o,s.backColor,s.foreColor,h);s.backColor=undefined;r.prototype.paint.call(this,n,null,u,f,e,o,s,h)},u.prototype.paintBackground=function(t,i,r,u,f,e,o,s,h){if(t){var c=GC.Spread.Sheets.ImageLayout.zoom,l=this.listviewInfo.cellMetaData.CellType,a=n.BarcodeCellType.GetRequestParam(i,l,f,e,o,s,this),v=n.ForguncyData.ForguncyRoot+"Barcode/GetBarcodeImage?data="+encodeURIComponent(JSON.stringify(a));n.SpreadJSHelpMethods.CellTypeContext.paintBackground(t,r,u,f,e,o,v,c,h.imageLoader)}},u.prototype.toJSON=function(){return t.toJSON(this,this.calcSheetName,this.dataColIndex)},u.prototype.fromJSON=function(n){r.prototype.fromJSON.call(this,n);this.initListviewInfo()},u}(GC.Spread.Sheets.CellTypes.Base);n.SpreadJSViewBarcodeCellType=g;t.register(g.shouldUse,g);h=function(t){function i(n,i,r){var u=t.call(this,n,i,r)||this;return u.__isEditorVisible=!1,u.__textCache={},u.__ignoreValidate=!1,u.typeName="Forguncy.SpreadJSEditCellType",u}return __extends(i,t),Object.defineProperty(i.prototype,"isUnboundListview",{get:function(){return!this.listviewInfo.listview.getDataTableName()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isAlwaysInEditMode",{get:function(){return this.listviewInfo.listview.listviewData.getAlwaysInEditMode()},enumerable:!1,configurable:!0}),i.shouldUse=function(n,t,i){return t.canEnterEditMode?o.shouldUse(n,t,i)||c.shouldUse(n,t,i)?!1:!0:!1},i.prototype.paint=function(i,r,f,e,o,s,h,c){var l,y,a,v;n.Common.IsEmpty(h.formatter)&&(y=u.getCell(this.listviewInfo.cellMetaData,this.listviewInfo.listview.runTimePageName,this.listviewInfo.listview.designerPageName,this.listviewInfo.listviewName).cellType,a=y.getFormatString(),n.Common.IsEmpty(a)||(v=(l=n.FormatHelper.format(a,r))===null||l===void 0?void 0:l.color,n.Common.IsEmpty(v)||(h.foreColor=v)));t.prototype.paint.call(this,i,r,f,e,o,s,h,c)},i.prototype.format=function(n,i,r,f){var e,o,h,s;if(!((e=this.listviewInfo)===null||e===void 0?void 0:e.cellMetaData))return t.prototype.format.call(this,n,i,r);this.isTransformText()&&(n=f.sheet.getValue(f.row,f.col));try{return h=u.getFormulaListRowInfo(f,this.listviewInfo.listview),s=u.getDisplayText(n,this.listviewInfo.visibleColumnInfo.cellType,i,h,r),this.__textCache[n+""]=s,s}catch(c){return(o=this.__textCache[n+""])!==null&&o!==void 0?o:n+""}},i.prototype.isTransformText=function(){var t,i,r,n=this.listviewInfo.cellMetaData;return((t=n===null||n===void 0?void 0:n.CellType)===null||t===void 0?void 0:t.$type)==="Forguncy.DropDownListCellType, ServerDesignerCommon"||((i=n===null||n===void 0?void 0:n.CellType)===null||i===void 0?void 0:i.$type)==="Forguncy.RadioGroupCellType, ServerDesignerCommon"||((r=n===null||n===void 0?void 0:n.CellType)===null||r===void 0?void 0:r.$type)==="Forguncy.CheckBoxGroupCellType, ServerDesignerCommon"?!0:!1},i.prototype.getText=function(n,t){return this.isTransformText()?this.format(n,null,null,t):n},i.prototype.createEditorElement=function(t,i){var e,o,s,r,h,c,f;this.destroy();this.__isEditorVisible=!1;e=u.getCell(this.listviewInfo.cellMetaData,this.listviewInfo.listview.runTimePageName,this.listviewInfo.listview.designerPageName,this.listviewInfo.listviewName);this.__cellType=e.cellType;o=this.listviewInfo.visibleColumnInfo.columnInfo.BindingColumnDataType;s=[n.ColumnDataType.Other,n.ColumnDataType.String,n.ColumnDataType.User,n.ColumnDataType.Image,n.ColumnDataType.Attachment];!this.isUnboundListview&&s.indexOf(o)>=0&&this.__cellType.constructor===n.TextBoxCellType&&(r=this.__cellType.getFormatString(),(n.Common.IsEmpty(r)||r.toLowerCase()==="general")&&this.__cellType.setFormatString("@"));h=this.__cellType.createContent();c=this.__cellType.getCellTypeInfo();t&&(f=this.listviewInfo.listview,this.__cellType.listviewCalcName=this.calcSheetName,this.__cellType.listviewRowIndex=f.mappedRowIndexFrowView(t.row),this.__cellType.listviewColIndex=f.getDataIndexByVisibleColumnIndexInListView(t.col));this.__cellType.onPageLoaded(c);var l=this.__cellType,a=document.createElement("div"),v=this.getHost(),y=n.SpreadJSHelpMethods.util.getPreferredZIndex(v)+1e3,p=n.Common.getIdStr(t.row,t.col,this.listviewInfo.visibleColumnInfo.idSuffix);return $(a).attr(n.StaticValues.InnerID,p).attr("cellTypeID",l.ID).css("position","absolute").css("z-index",y).attr("gcuielement","gcEditingInput").append(h),$(i).attr("id",l.ID+"_div"),$(i).css("overflow",""),n.ValidationTooltipHelper.setTooltipAttr($(i),!0),a},i.prototype.getHost=function(n){if(!(n===null||n===void 0?void 0:n.sheet))return null;var t=n.sheet.getParent();return t?t.getHost():null},i.prototype.destroy=function(){this.__cellType&&(u.destroyEditor(this.__cellType),this.__cellType=null)},i.prototype.deactivateEditor=function(n,i){this.__isEditorVisible=!1;n&&this.destroyTooltip($(n));t.prototype.deactivateEditor.call(this,n,i)},i.prototype.destroyTooltip=function(t){var i,r,u,f;((u=(r=(i=this.__cellType)===null||i===void 0?void 0:i.CellElement)===null||r===void 0?void 0:r.DataValidation)===null||u===void 0?void 0:u.ErrorTo)===1&&((f=this.__cellType.CellElement)===null||f===void 0?void 0:f.DataValidation.ErrorToTargetCell)?n.FormulaHelper.setValueToCellLocation(null,this.__cellType.CellElement.DataValidation.ErrorToTargetCell,7,this.__cellType.getDefaultFormulaCalcInfo(),!1):n.ValidationTooltipHelper.destroyTooltip(t)},i.prototype.getEditorValue=function(){var t,i;if(this.__cellType)return t=!0,this.isUnboundListview||(i=[n.ColumnDataType.Other,n.ColumnDataType.String,n.ColumnDataType.User,n.ColumnDataType.Image,n.ColumnDataType.Attachment],t=i.indexOf(this.listviewInfo.visibleColumnInfo.columnInfo.BindingColumnDataType)===-1),this.__cellType.getValue(!t)},i.prototype.setEditorValue=function(t,i,r){var u,o;if(this.__cellType&&(!this.__isEditorVisible||!n.Platform.isIpad())&&$(t).attr("cellTypeID")===this.__cellType.ID){var s=this.listviewInfo.listview,f=s.mappedRowIndexFrowView(r.row),e=this.listviewInfo.dataModel;i=e?e.getValue(f,this.listviewInfo.visibleColumnInfo.getColumnIndex()):null;this.shouldUseDefaultValue(i,r)&&(u=this.getDefaultValue(f),n.Common.IsEmpty(u)||(i=u));this.__cellType.canInputChars()&&(o=(!GC.Spread.Sheets.util.browser.msie||parseFloat(GC.Spread.Sheets.util.browser.version)<11)&&((r===null||r===void 0?void 0:r.sheet)&&this.isStartEditByKeydown(r)?!0:!1),o&&(i=null));this.__cellType.setValueToElement($(t).find("#"+this.__cellType.ID),i)}},i.prototype.isStartEditByKeydown=function(t){var i={value:null};return GC.Spread.Sheets.CellTypes.Text.prototype.setEditorValue(i,"text",t),n.Common.IsEmpty(i.value)},i.prototype.shouldUseDefaultValue=function(t,i){var r;if(!n.Common.IsEmpty(t)||!n.ForguncyData.pageInfo.dataModel||!i||!this.calcSheetName||(r=this.listviewInfo.dataModel,!r))return!1;var u=this.listviewInfo.listview,f=u.mappedRowIndexFrowView(i.row),e=r.getRowInfo(f);return n.Common.IsEmpty(e)?!0:!1},i.prototype.selectAll=function(){this.__cellType&&this.__cellType.selectAll()},i.prototype.focus=function(t,i){var r;if(this.__cellType&&t){if(n.Platform.isIpad()&&!this.__isEditorVisible&&i&&i.sheet){if(r=i.sheet.getValue(i.row,i.col),this.shouldUseDefaultValue(r,i)){var f=this.listviewInfo.listview,e=f.mappedRowIndexFrowView(i.row),u=this.getDefaultValue(e);n.Common.IsEmpty(u)||(r=u)}this.__cellType.setValueToElement($(t).find("#"+this.__cellType.ID),r)}this.__cellType.focus();this.isAlwaysInEditMode||this.__cellType.setCaretAtLast()}},i.prototype.getDefaultValue=function(n){var t=this.listviewInfo.dataModel;return t?this.listviewInfo.visibleColumnInfo.getDefaultValue(t.name,this.listviewInfo.listview.runTimePageName,n):null},i.prototype.activateEditor=function(n,t,i,r){if(this.__cellType){this.__isEditorVisible=!0;var u=n&&r&&r.sheet;u&&(this.__editorRect=new GC.Spread.Sheets.Rect(null,null,null,null),this.updateEditorRect(n,i,r),this.setSelectionForNumberCell(),this.upadateEditorStyle(n,t,u),this.attachAttrToDropDown())}},i.prototype.setSelectionForNumberCell=function(){if(this.__shouldSetSelection===undefined&&(this.__shouldSetSelection=this.isAlwaysInEditMode&&n.Platform.isIpad()&&this.listviewInfo.cellMetaData.CellType.$type==="Forguncy.NumberCellType, ServerDesignerCommon"),this.__shouldSetSelection){var t=this.__cellType.getControl();t.getUIInputElement().setSelectionRange(0,0)}},i.prototype.upadateEditorStyle=function(t,i){var r,u,f,e,o,s;t&&i&&(r=!1,u=!1,i.font&&typeof i.font=="string"&&(f=i.font.toLowerCase(),r=f.indexOf("italic")!==-1,u=f.indexOf("bold")!==-1),e=!1,o=!1,i.textDecoration&&(e=(i.textDecoration&GC.Spread.Sheets.TextDecorationType.lineThrough)===GC.Spread.Sheets.TextDecorationType.lineThrough,o=(i.textDecoration&GC.Spread.Sheets.TextDecorationType.underline)===GC.Spread.Sheets.TextDecorationType.underline),s=i.backColor?"rgb(".concat(n.ColorHelper.GetRGBNumberString(i.backColor),")"):"white",$(t).css("background-color",n.ColorHelper.Convert(s)),this.__cellType.setStyle(i.backColor,i.foreColor,this.listviewInfo.cellMetaData.StyleInfo.FontSize,r,u,o,e))},i.prototype.attachAttrToDropDown=function(){var n=this.__cellType.getDropDownObj();n&&$(n).attr("gcuielement","fgcDropDownWindow")},i.prototype.updateEditor=function(n,t,i,r){if(this.__cellType){var u=this.updateEditorRect(n,i,r);u&&this.destroyTooltip($(n))}},i.prototype.updateEditorRect=function(t,i,r){var f=!1,s=t&&r&&r.sheet,u,o;if(s&&!this.isRectInvalid(i)){var h=s.getParent(),c=n.SpreadJSView.getBounds(h.name),e=void 0;e=r.canvasOffset?r.canvasOffset:n.SpreadJSView.getCanvasPosition(h.name);u=new GC.Spread.Sheets.Rect(e.left+c.x+i.x,e.top+c.y+i.y,i.width-1,i.height-1);o=$(t);(this.__editorRect.x!==u.x||this.__editorRect.y!==u.y)&&(f=!0);this.__editorRect.width!==u.width&&(o.width(u.width),f=!0);this.__editorRect.height!==u.height&&(o.height(u.height),f=!0);this.__editorRect=u}return f},i.prototype.isRectInvalid=function(n){return!n||n.x===undefined||n.y===undefined||n.width===undefined||n.height===undefined},i.prototype.isReservedKey=function(n,t){var r=n.srcElement||n.target,i;return r&&t&&t.isEditing&&(i=this.listviewInfo.visibleColumnInfo.cellType.getIgnoreKeysInListview(),i&&i.indexOf(n.keyCode)>=0||n.keyCode===GC.Spread.Commands.Key.z&&n.ctrlKey&&!n.altKey||n.keyCode===GC.Spread.Commands.Key.y&&n.ctrlKey&&!n.altKey||n.keyCode===GC.Spread.Commands.Key.c&&n.ctrlKey&&!n.altKey||n.keyCode===GC.Spread.Commands.Key.x&&n.ctrlKey&&!n.altKey||n.keyCode===GC.Spread.Commands.Key.v&&n.ctrlKey&&!n.altKey)?!0:!1},i.prototype.isEditingValueChanged=function(n,t){return!u.equals(n,t)},i.prototype.isImeAware=function(){return!0},i.prototype.validate=function(t,i,r){var f=this,e,u,o;return!this.__cellType||this.__ignoreValidate?!0:r?(n.Common.IsEmpty(r.message)||n.ValidationTooltipHelper.showTooltip(this.__cellType.getContainer()[0],r.message),!1):(e=this.listviewInfo.listview,u=n.ValidationMananger.validateCell(this.__cellType,e.getValidateHelpInfoByViewIndex(t,i)),u===0?!0:u instanceof Promise?(u.then(function(n){if(!n.obsolete&&n.status===0){var r=f.listviewInfo.listview;if(r)try{f.__ignoreValidate=!0;r.endEdit(t,i)}finally{f.__ignoreValidate=!1}}}),!1):(o=n.InputManCellTypeBase&&this.__cellType instanceof n.InputManCellTypeBase&&this.__cellType.canInput(),o&&this.__cellType.focus(),!1))},i.prototype.hideValidationTooltip=function(){var n,t;this.__cellType&&(n=this.listviewInfo.listview,n)&&(t=n.getContainerDiv().find("[name='"+this.__cellType.ID+"']"),t.length>0&&this.destroyTooltip(t))},i}(v);n.SpreadJSEditCellType=h;t.register(h.shouldUse,h);o=function(r){function u(n,t,i){var u=r.call(this,n,t,i)||this;return u.__hoveredY=-100,u.typeName="Forguncy.DropDownEditorCellType",u}return __extends(u,r),Object.defineProperty(u.prototype,"showDropdownButton",{get:function(){return this.listviewInfo.visibleColumnInfo.cellType.CellElement.CellType.DropdownButtonModeInListview},enumerable:!1,configurable:!0}),u.shouldUse=function(t,i){return i.canEnterEditMode?i.cellType.constructor===n.DateTimeCellType_InputMan:!1},u.prototype.paintValue=function(n,t,i,u,f,e,o,s){n&&(r.prototype.paintValue.call(this,n,t,i,u,f-this.getIconWidth(s,!0),e,o,s),this.paintDropdownIcon(n,i,u,f,e,s))},u.prototype.paintDropdownIcon=function(n,t,i,r,f,e){var o=this.getIconRect(t,i,r,f,e),c,l,s,h;if(o)try{n.save();c="#000000";l="#DDDDDD";this.isDropDownIconHovered(i,f)&&(n.fillStyle=l,n.fillRect(o.x,o.y,o.width,o.height));s=i+(f-u._iconSideLength)/2;h=o.x+u._iconPadding;n.fillStyle=c;n.beginPath();n.moveTo(h,s);n.lineTo(h+u._iconSideLength,s);n.lineTo(h+u._iconSideLength/2,s+u._iconSideLength);n.closePath();n.fill()}finally{n.restore()}},u.prototype.isDropDownIconHovered=function(n,t){return n<=this.__hoveredY&&this.__hoveredY<=n+t},u.prototype.showDropDown=function(n){var t,r=(t=this.__cellType)===null||t===void 0?void 0:t.getControl(),i;r instanceof GC.InputMan.GcDateTime&&(i=r.getDropDownCalendar(),n=this.getDate(n),n!==null&&i.setValue(n),i.open())},u.prototype.getDate=function(t){return t instanceof Date?t:typeof t=="number"?n.Convertor.fromOADateToDate(t):null},u.prototype.processMouseDown=function(n){(n===null||n===void 0?void 0:n.isReservedLocation)&&n.sheet&&n.sheet.getParent().focus(!0)},u.prototype.processMouseUp=function(t){if(!(t===null||t===void 0?void 0:t.isReservedLocation)||!t.sheet)return!1;var i=t.sheet,r=t.row,u=t.col;n.DelayRefresh.setTimeout(function(){if(i.getActiveRowIndex()===r&&i.getActiveColumnIndex()===u){var n=i.getCellType(r,u);(n===null||n===void 0?void 0:n.showDropDown)&&(i.startEdit(),n.showDropDown(i.getValue(r,u)))}})},u.prototype.processMouseMove=function(n){var i=this.__hoveredY;(n===null||n===void 0?void 0:n.isReservedLocation)?(this.__hoveredY=n.cellRect.y,t.changeCursorAsPointer(n.sheet)):this.__hoveredY=-100;this.__hoveredY!==i&&n.sheet.repaint(n.cellRect)},u.prototype.processMouseLeave=function(n){n&&(this.__hoveredY=-100,n.sheet.repaint(n.cellRect))},u.prototype.getHitInfo=function(n,t,r,u,f){var e=this.getIconRect(u.x,u.y,u.width,u.height,f);return i.getHitInfo(n,t,r,e,GC.Spread.Sheets.SheetArea.viewport,f)},u.prototype.getIconWidth=function(n,t){return t===void 0&&(t=!1),this.shouldDisplayDropDownIcon(n)?u._iconPadding*2+u._iconSideLength+(t?2:0):0},u.prototype.shouldDisplayDropDownIcon=function(n){switch(this.showDropdownButton){case 1:case 3:return!1;case 0:return!0;case 2:if(!n)return!1;var t=n.sheet;return t.getActiveRowIndex()===n.row&&t.getActiveColumnIndex()===n.col}},u.prototype.getIconRect=function(n,t,i,r,u){var f=this.getIconWidth(u);return f===0?null:new GC.Spread.Sheets.Rect(n+i-(f+2),t+1,f,r-3)},u.prototype.getAutoFitWidth=function(n,t,i,u,f){var e=r.prototype.getAutoFitWidth.call(this,n,t,i,u,f);return e+this.getIconWidth(f,!0)},u._iconPadding=7,u._iconSideLength=8,u}(h);n.DropDownEditorCellType=o;t.register(o.shouldUse,o);c=function(t){function i(n,i,r){var u=t.call(this,n,i,r)||this;return u.typeName="Forguncy.ComboboxEditorCellType",u}return __extends(i,t),i.shouldUse=function(t,i){return i.canEnterEditMode?i.cellType.constructor===n.ComboBoxCellType_InputMan||i.cellType.constructor===n.UserSelectorCellType_InputMan||i.cellType.constructor===n.TimeCellType_InputMan:!1},i.prototype.createEditorElement=function(i,r){var e=t.prototype.createEditorElement.call(this,i,r),u=this.getGcCombobox(),f;return u&&(f=this,this.__onDropDownOpenedCallBack=function(){f.onDropDownOpen()},u.addEventListener(GC.InputMan.GcComboBoxEvent.DropDownOpened,this.__onDropDownOpenedCallBack),this.__onDropDownClosedCallBack=function(){n.DelayRefresh.setTimeout(function(){f.onDropDownClose(i.sheet)})},u.addEventListener(GC.InputMan.GcComboBoxEvent.DropDownClosed,this.__onDropDownClosedCallBack)),e},i.prototype.onDropDownOpen=function(){var n=this.getGcCombobox();this.__cachedSelectedIndex=n?n.getSelectedIndex():-1},i.prototype.onDropDownClose=function(n){var t,i;n.isEditing()&&this.__isEditorVisible&&(t=this.getGcCombobox(),t)&&(i=t.getSelectedIndex(),i!==-1&&i!==this.__cachedSelectedIndex)&&n.endEdit()},Object.defineProperty(i.prototype,"_gcComboBox",{get:function(){return this.__cellType?this.__cellType.getControl():null},enumerable:!1,configurable:!0}),i.prototype.getGcCombobox=function(){return this.__cellType?this.__cellType.getControl():null},i.prototype.showDropDown=function(){var n=this.getGcCombobox();n&&n.getDropDown().open()},i.prototype.activateEditor=function(n,i,r,u){var e,f;if(t.prototype.activateEditor.call(this,n,i,r,u),this.__cachedSelectedIndex=-1,e=n&&u&&u.sheet,e){if(f=this.getGcCombobox(),!f)return;this.__cachedSelectedIndex=f.getSelectedIndex()}},i.prototype.isReservedKey=function(n,i){return t.prototype.isReservedKey.call(this,n,i)?!0:this._gcComboBox&&(n.srcElement||n.target)&&i&&i.isEditing&&this.__cellType.isDropDownOpened()&&n.keyCode===GC.Spread.Commands.Key.enter?!0:!1},i.prototype.getAutoFitHeight=function(n,i,r,u,f){return t.prototype.getAutoFitHeight.call(this,i,i,r,u,f)},i.prototype.destroy=function(){var n=this.getGcCombobox();n&&(this.__onDropDownOpenedCallBack&&(n.removeEventListener(GC.InputMan.GcComboBoxEvent.DropDownOpened,this.__onDropDownOpenedCallBack),this.__onDropDownOpenedCallBack=null),this.__onDropDownClosedCallBack&&(n.removeEventListener(GC.InputMan.GcComboBoxEvent.DropDownClosed,this.__onDropDownClosedCallBack),this.__onDropDownClosedCallBack=null));t.prototype.destroy.call(this)},i}(o);n.ComboboxEditorCellType=c;t.register(c.shouldUse,c);ft=function(){function n(){}return n}();n.SpreadJSCellTypeContextArg=ft;st=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(ft);n.IsReservedKeyContextArg=st;u=function(){function t(){}return t.equals=function(t,i){return t===0&&i===""||t===""&&i===0?!1:t===null&&i===""||t===""&&i===null?!0:n.Common.isFuzzyEquals(t,i)?!0:t instanceof Date&&i instanceof Date&&t.valueOf()===i.valueOf()?!0:!1},t.getEditorID=function(){return t.editorIDPrefix+n.Common.getUniqueNumber().toString()},t.getCell=function(i,r,u,f){if(!i)return null;var o=t.getEditorID(),e=n.Common.clone(i);return e.Value=null,new n.NormalCell(e,1,o,r,u,f)},t.destroyEditor=function(n){n&&n.destroy()},t.getDisplayText=function(t,i,r,u,f){var o=i.getFormatString(),e;return e=typeof r=="string"?r:r instanceof GC.Spread.Formatter.GeneralFormatter?!n.Common.IsEmpty(o)&&r.isAuto?null:r.formatString():null,i.getListviewNoneEditModeText(t,f,e,u)},t.getFormulaListRowInfo=function(n,t){var i;return i={},i[t.getCalcSheetName()]=t.mappedRowIndexFrowView(n.row),i},t.editorIDPrefix="a",t}();n.ListviewEditorHelper=u;l=function(){function t(){}return t._getIconStr=function(n){switch(n){case 2:return"data:image/svg+xml,%3Csvg width='16' height='16' viewBox='0 0 64 64' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M32 64C14.4 64 0 49.6 0 32S14.4 0 32 0s32 14.4 32 32-14.4 32-32 32zm-2.133-29.867v13.382c0 .931 1.202 1.552 2.133 1.552.93 0 2.133-.62 2.133-1.552V34.133h13.382c.931 0 1.552-1.202 1.552-2.133 0-.93-.62-2.133-1.552-2.133H34.133V16.485c0-.931-1.202-1.552-2.133-1.552-.93 0-2.133.62-2.133 1.552v13.382H16.485c-.931 0-1.552 1.202-1.552 2.133 0 .93.62 2.133 1.552 2.133h13.382z' fill-rule='evenodd' fill='{0}'/%3E%3C/svg%3E";case 1:return"data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 64 64' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24.2 48.52l-9.335-9.185L9 55l15.2-6.48zm22.28-21.707l-9.63-9.935-20.252 19.897 10.005 10.388 19.877-20.35zm7.937-7.62c1.311-1.476 0-4.294 0-4.294a41.74 41.74 0 0 0-5.485-4.944c-2.933-2.147-5.194 0-5.194 0l-4.962 4.971L48.856 24.98s4.251-4.293 5.56-5.788v.002z' fill-rule='nonzero' fill='{0}'/%3E%3C/svg%3E"}},t.addIconCache=function(t){if(!n.Common.IsEmpty(t)){var i=encodeURIComponent(t);this._addIconCacheByRowSate(2,i,t);this._addIconCacheByRowSate(1,i,t)}},t._addIconCacheByRowSate=function(i,r,u){var f=this._getKey(i,u),e,o;t._iconsCache[f]||(e=t._getIconStr(i),o=n.Common.format(e,r),t._iconsCache[f]=t.createImage(o))},t.getIconCache=function(i,r){if(i===0||n.Common.IsEmpty(r))return null;var u=this._getKey(i,r);return t._iconsCache[u]},t._getKey=function(n,t){return n+"_"+t},t.createImage=function(n){var t=new Image;return t.src=n,t},t._iconsCache={},t}();ht=function(i){function r(n,t,r){var u=i.call(this)||this;return(u.calcSheetName=t,u.typeName="Forguncy.SpreadJSRowHeaderCellType",!u.calcSheetName)?u:(u.initListviewInfo(n),u._initIconsCache(r),u)}return __extends(r,i),Object.defineProperty(r.prototype,"listviewInfo",{get:function(){return this.__listviewInfo},enumerable:!1,configurable:!0}),r.prototype.initListviewInfo=function(n){n===void 0&&(n=null);this.__listviewInfo=new f(n,this.calcSheetName,-1)},r.prototype._initIconsCache=function(n){var t=this._getPossibleForeColors(n);t.forEach(function(n){return l.addIconCache(n)})},r.prototype._getPossibleForeColors=function(t){var u,i=[],e,f,o,r;if(n.Common.IsEmpty(t))for(e in GC.Spread.Sheets.VisualState)f=Number(e),isNaN(f)||(o=this._getThemeStyle(f),i.push(o.color));else i.push(t);return r=(u=this.listviewInfo)===null||u===void 0?void 0:u.listViewStyleTemplate,r&&(i.push(n.ColorHelper.Convert(r.ColumnHeaderFore)),i.push(n.ColorHelper.Convert(r.ColumnHeaderHighlightFore)),i.push(n.ColorHelper.Convert(r.ColumnHeaderHoverFore)),i.push(n.ColorHelper.Convert(r.ColumnHeaderSelectFore))),i.filter(function(n){return!!n})},r.prototype._getThemeStyle=function(t){return this.getThemeStyle(t,"gc-rowHeader-"+n.SpreadJSHelpMethods.HelpMethods.getVisualStateName(t))},r.prototype.paint=function(n,u,f,e,o,s,h,c){var v=this._getThemeStyle(c.visualState),l,a;h=t.getCustomStyle(h,v,this.listviewInfo.listViewStyleTemplate,c.visualState);l=c.visualState;c.visualState=GC.Spread.Sheets.VisualState.normal;a=r.getValue(c.row,c.sheet,this.listviewInfo.dataModel,this.listviewInfo.hasTotalRow,this.listviewInfo.isTotalRowAtFirst);i.prototype.paint.call(this,n,a,f,e,o,s,h,c);c.visualState=l;this.paintIcon(n,f,e,o,s,h,c)},r.getRowHeaderText=function(t,i){var o=n.ForguncyData.pageInfo.dataModel.getListDataByCalcSheetName(i),u=n.ListviewBase.getListviewByCalcSheetName(i),f,e;return(u instanceof n.SpreadJSView)?(f=u.allowShowTotalRow(),e=f&&u.listviewData.getIsTotalRowAtFirstRow(),r.getValue(t,u.getSheet(),o,f,e)):""},r.getValue=function(n,t,i,r,u){var f=n,o,e;if(r)if(u){if(n===0)return"∑";f=n-1}else if(n===t.getRowCount()-1)return"∑";return(o=i.getRowCount(),f<o)?(e=i.getValue(f,0),e===undefined||e===null?f+1:e):""},r.prototype._getForeColor=function(t,i){if(i.visualState!==GC.Spread.Sheets.VisualState.hover)return t.foreColor;var r=this.getThemeStyle(i.visualState,"gc-rowHeader-"+n.SpreadJSHelpMethods.HelpMethods.getVisualStateName(GC.Spread.Sheets.VisualState.hover));return r.color},r.prototype.paintIcon=function(n,t,i,r,u,f,e){var c=this.listviewInfo.listview,h,o,v,a,s;c&&(h=c.getRowState(e.row),h!==0)&&((o=h===1?20:16,v=h===1?1:4,r<o||u<o)||(a=l.getIconCache(c.getRowState(e.row),f.foreColor),a)&&(s=new GC.Spread.Sheets.Rect(t+v,i+u/2-o/2,o,o),n.drawImage(a,0,0,o,o,Math.floor(s.x),Math.floor(s.y),Math.floor(s.width),Math.floor(s.height))))},r.prototype.toJSON=function(){return t.toJSON(this,this.calcSheetName,-1)},r.prototype.fromJSON=function(n){i.prototype.fromJSON.call(this,n);this.initListviewInfo()},r}(GC.Spread.Sheets.CellTypes.RowHeader);n.SpreadJSRowHeaderCellType=ht;nt=function(i){function r(n,t,r){var u=i.call(this)||this;return(u.calcSheetName=t,u.dataColIndex=r,u.__isMouseDownReservedLocation=!1,u.typeName="Forguncy.SpreadJSColumnHeaderCellType",!u.calcSheetName)?u:(u.initListviewInfo(n),u)}return __extends(r,i),Object.defineProperty(r.prototype,"listviewInfo",{get:function(){return this.__listviewInfo},enumerable:!1,configurable:!0}),r.prototype.initListviewInfo=function(n){n===void 0&&(n=null);this.__listviewInfo=new f(n,this.calcSheetName,this.dataColIndex)},Object.defineProperty(r.prototype,"isMouseDownReservedLocation",{get:function(){return this.__isMouseDownReservedLocation},set:function(n){this.__isMouseDownReservedLocation=n},enumerable:!1,configurable:!0}),r.prototype.paint=function(r,u,f,e,o,s,h,c){var a=this.getThemeStyle(this._getVisualState(c),"gc-columnHeader-"+n.SpreadJSHelpMethods.HelpMethods.getVisualStateName(c.visualState)),l;h=t.getCustomStyle(h,a,this.listviewInfo.listViewStyleTemplate,c.visualState);l=c.visualState;c.visualState=GC.Spread.Sheets.VisualState.normal;i.prototype.paint.call(this,r,u,f,e,o,s,h,c);c.visualState=l},r.prototype._getForeColor=function(t,i){var r=this._getVisualState(i),u;return r===GC.Spread.Sheets.VisualState.normal&&t.foreColor?t.foreColor:(u=this.getThemeStyle(i.visualState,"gc-columnHeader-"+n.SpreadJSHelpMethods.HelpMethods.getVisualStateName(r)),u.color)},r.prototype._getVisualState=function(n){var t=n.visualState===undefined?GC.Spread.Sheets.VisualState.normal:n.visualState;return t!==GC.Spread.Sheets.VisualState.normal&&this._isActiveColumn(n.sheet,n.col)&&(t=this._isSelectedColumn(n.sheet,n.col)?GC.Spread.Sheets.VisualState.selected:GC.Spread.Sheets.VisualState.highlight),t},r.prototype._isActiveColumn=function(n,t){for(var i,f=n.getSelections(),r=0,u=f;r<u.length;r++)if((i=u[r],i.col===-1||i.colCount===-1)||i.col<=t&&i.col+i.colCount>t)return!0;return!1},r.prototype._isSelectedColumn=function(n,t){for(var i,f=n.getSelections(),r=0,u=f;r<u.length;r++)if((i=u[r],i.row===-1||i.rowCount===-1)&&i.col<=t&&i.col+i.colCount>t)return!0;return!1},r.prototype.toJSON=function(){return t.toJSON(this,this.calcSheetName,this.dataColIndex)},r.prototype.fromJSON=function(n){i.prototype.fromJSON.call(this,n);this.initListviewInfo()},r}(GC.Spread.Sheets.CellTypes.ColumnHeader);n.SpreadJSColumnHeaderCellType=nt;ct=function(t){function r(n,i,r){var u=t.call(this,n,i,r)||this;return u.typeName="Forguncy.SpreadJSSortHeaderCellType",u}return __extends(r,t),r.prototype.paint=function(n,i,r,u,f,e,o,s){t.prototype.paint.call(this,n,i,r,u,f,e,o,s);this._paintSortIcon(n,r,u,f,e,o,s)},r.prototype._paintSortIcon=function(n,t,i,r,u,f){if(this.isSortIconShow()){var e=this.listviewInfo.visibleColumnInfo.sortInfo;n.save();n.beginPath();e===0?this._paintASCIcon(n,t,i,r,u):this._paintDESCIcon(n,t,i,r,u);n.fillStyle!==f.foreColor&&(n.fillStyle=f.foreColor);n.fill();n.restore()}},r.prototype._paintASCIcon=function(n,t,i,u,f){var e=t+u-r.SPACE-r.WIDTH/2,o=i+f/2-r.HEIGHT/2;n.moveTo(e,o);n.lineTo(e-r.WIDTH/2,o+r.HEIGHT);n.lineTo(e+r.WIDTH/2,o+r.HEIGHT);n.lineTo(e,o)},r.prototype._paintDESCIcon=function(n,t,i,u,f){var e=t+u-r.SPACE-r.WIDTH,o=i+f/2-r.HEIGHT/2;n.moveTo(e,o);n.lineTo(e+r.WIDTH/2,o+r.HEIGHT);n.lineTo(e+r.WIDTH,o);n.lineTo(e,o)},r.prototype.getAutoFitWidth=function(n,i,u,f,e){var o=t.prototype.getAutoFitWidth.call(this,n,i,u,f,e);return o+r.WIDTH+r.SPACE*2},r.prototype.isSortIconShow=function(){if(n.PrintCommand.IsPrinting)return!1;var t=this.listviewInfo.visibleColumnInfo.sortInfo;return t===0||t===1},r.prototype.paintContent=function(n,i,r,u,f,e,o,s){f=this._adjustTextAreaWidth(f);t.prototype.paintContent.call(this,n,i,r,u,f,e,o,s)},r.prototype._adjustTextAreaWidth=function(n){return this.isSortIconShow()&&(n=n-r.WIDTH-r.SPACE*2),n},r.prototype.getHitInfo=function(n,t,r,u,f){return i.getHitInfo(n,t,r,u,GC.Spread.Sheets.SheetArea.colHeader,f)},r.prototype.processMouseDown=function(n){return i.processMouseDown(this,n)},r.prototype.processMouseUp=function(n){return i.processMouseUp(this,n,n.row,n.col,GC.Spread.Sheets.SheetArea.colHeader)},r.WIDTH=10,r.HEIGHT=8,r.SPACE=5,r}(nt);n.SpreadJSSortHeaderCellType=ct;lt=function(t){function r(n,i,r){var u=t.call(this,n,i,r)||this;return u.typeName="Forguncy.SpreadJSFilterHeaderCellType",u}return __extends(r,t),Object.defineProperty(r,"supportedTypes",{get:function(){return[n.ColumnDataType.Bool,n.ColumnDataType.Number,n.ColumnDataType.Date,n.ColumnDataType.Time,n.ColumnDataType.String,n.ColumnDataType.User]},enumerable:!1,configurable:!0}),r.getIcon=function(t,i,r,u){var c=this,f=t,o,e,s,h;return i=i!==null&&i!==void 0?i:0,i===1&&(f=f+r),this.iconsImageCache[f]||(o=this.iconsCache[t],i===0?(s="%23666",h="white",e=l.createImage(n.Common.format(o,s,s,h))):(r=r!==null&&r!==void 0?r:"#666",r=n.ColorHelper.Convert(r),r=encodeURIComponent(r),e=l.createImage(n.Common.format(o,"transparent",r,"transparent"))),e.onload=function(){c.iconsImageCache[f]=e;u()}),this.iconsImageCache[f]},r.prototype.paint=function(n,i,r,u,f,e,o,s){t.prototype.paint.call(this,n,i,r,u,f,e,o,s);this.paintFilterIcon(n,r,u,f,e,o,s)},r.prototype.paintContent=function(n,i,u,f,e,o,s,h){var c=e-r.imageSize;t.prototype.paintContent.call(this,n,i,u,f,c,o,s,h)},r.prototype.getAutoFitWidth=function(n,i,u,f,e){var o=t.prototype.getAutoFitWidth.call(this,n,i,u,f,e);return o+r.imageSize+r.spaceWidth*2},r.prototype.getHitInfo=function(n,r,u,f,e){var s,o=i.getHitInfo(n,r,u,f,GC.Spread.Sheets.SheetArea.colHeader,e);return o&&((s=this.__destRect)===null||s===void 0?void 0:s.contains(o.x,o.y))?o:t.prototype.getHitInfo.call(this,n,r,u,f,e)},r.prototype.processMouseDown=function(n){var r;return n&&((r=this.__destRect)===null||r===void 0?void 0:r.contains(n.x,n.y))?i.processMouseDown(this,n):t.prototype.processMouseDown.call(this,n)},r.prototype.processMouseUp=function(n){var r;return n&&((r=this.__destRect)===null||r===void 0?void 0:r.contains(n.x,n.y))?i.processMouseUp(this,n,n.row,n.col,GC.Spread.Sheets.SheetArea.colHeader):t.prototype.processMouseUp.call(this,n)},r.prototype.processMouseMove=function(n){var t;return n&&((t=this.__destRect)===null||t===void 0?void 0:t.contains(n.x,n.y))?i.processMouseMove(n):i.processMouseLeave(n)},r.prototype.processMouseLeave=function(n){return i.processMouseLeave(n)},r.prototype.paintFilterIcon=function(t,i,u,f,e,o,s){var v,y,p,w=r.imageSize,b=-2,c=w,l=w,d;f<w-b&&(c=f+b);this.__destRect=new GC.Spread.Sheets.Rect(i+f-c+b,u+e/2-l/2,c,l);var k=this.listviewInfo.visibleColumnInfo,a=(v=this.listviewInfo.listview)===null||v===void 0?void 0:v.getColumnFilterHelper(k),nt=n.Common.IsEmpty(k.sortInfo)?"null":k.sortInfo.toString(),tt=(a===null||a===void 0?void 0:a.isColumnFilterValid(a.columnFilterQuery))?"filter":"null",g=(y=this.listviewInfo.listViewStyleTemplate)===null||y===void 0?void 0:y.ColumnFilterIconColor,h=this.listviewInfo.listViewStyleTemplate;(((h===null||h===void 0?void 0:h.IconColorUseCellForground)||(h===null||h===void 0?void 0:h.IconColorUseCellForground)===undefined)&&(g=(p=o.foreColor)!==null&&p!==void 0?p:"black"),d=r.getIcon(nt+tt,h===null||h===void 0?void 0:h.ColumnFilterButtonStyle,g,function(){var n;((n=s===null||s===void 0?void 0:s.sheet)===null||n===void 0?void 0:n.repaint)&&s.sheet.repaint(new GC.Spread.Sheets.Rect(i,u,f,e))}),d)&&(c<=0||l<=0||Math.floor(this.__destRect.width)<=0||Math.floor(this.__destRect.height)<=0||t.drawImage(d,0,0,c,l,Math.floor(this.__destRect.x),Math.floor(this.__destRect.y),Math.floor(this.__destRect.width),Math.floor(this.__destRect.height)))},r.iconsImageCache={},r.iconsCache=(e={},e.nullnull="data:image/svg+xml,%3Csvg width='16' height='16' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill-rule='evenodd'%3E%3Crect width='100%25' height='100%25' fill='{2}'/%3E%3Cpath d='M1 1v14h14V1H1zM0 0h16v16H0V0z'  fill='{0}' fill-rule='nonzero'/%3E%3Cpath d='M8 10L5 7h6z' fill='{1}'/%3E%3C/g%3E%3C/svg%3E",e.nullfilter="data:image/svg+xml,%3Csvg width='16' height='16' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill-rule='evenodd'%3E%3Crect width='100%25' height='100%25' fill='{2}'/%3E%3Cpath d='M1 1v14h14V1H1zM0 0h16v16H0V0z'  fill='{0}' fill-rule='nonzero'/%3E%3Cpath d='M5 13l-2-2h4z' fill='{1}'/%3E%3Cpath fill-rule='nonzero' d='M9.429 7.408L6 3h8l-3.429 4.408v2.449L9.429 11V7.408z' fill='{1}'/%3E%3C/g%3E%3C/svg%3E",e[0..toString()+"null"]="data:image/svg+xml,%3Csvg width='16' height='16' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill-rule='evenodd'%3E%3Crect width='100%25' height='100%25' fill='{2}'/%3E%3Cpath d='M1 1v14h14V1H1zM0 0h16v16H0V0z'  fill='{0}' fill-rule='nonzero'/%3E%3Cpath d='M5 13l-2-2h4zM10.5 3L13 6H8zM10 6h1v7h-1z' fill='{1}'/%3E%3C/g%3E%3C/svg%3E",e[1..toString()+"null"]="data:image/svg+xml,%3Csvg width='16' height='16' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill-rule='evenodd'%3E%3Crect width='100%25' height='100%25' fill='{2}'/%3E%3Cpath d='M1 1v14h14V1H1zM0 0h16v16H0V0z'  fill='{0}' fill-rule='nonzero'/%3E%3Cpath d='M5 13l-2-2h4zM10.5 13L8 10h5zM10 3h1v7h-1z' fill='{1}'/%3E%3C/g%3E%3C/svg%3E",e[0..toString()+"filter"]="data:image/svg+xml,%3Csvg width='16' height='16' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill-rule='evenodd'%3E%3Crect width='100%25' height='100%25' fill='{2}'/%3E%3Cpath d='M1 1v14h14V1H1zM0 0h16v16H0V0z' fill='{0}' fill-rule='nonzero'/%3E%3Cpath fill-rule='nonzero' d='M9.429 7.408L6 3h8l-3.429 4.408v2.449L9.429 11V7.408z' fill='{1}'/%3E%3Cpath d='M4.5 5L7 8H2zM4 8h1v5H4z' fill='{1}'/%3E%3C/g%3E%3C/svg%3E",e[1..toString()+"filter"]="data:image/svg+xml,%3Csvg width='16' height='16' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill-rule='evenodd'%3E%3Crect width='100%25' height='100%25' fill='{2}'/%3E%3Cpath d='M1 1v14h14V1H1zM0 0h16v16H0V0z' fill='{0}' fill-rule='nonzero'/%3E%3Cpath fill-rule='nonzero' d='M9.429 7.408L6 3h8l-3.429 4.408v2.449L9.429 11V7.408z' fill='{1}'/%3E%3Cpath d='M4.5 13L2 10h5zM4 5h1v5H4z' fill='{1}'/%3E%3C/g%3E%3C/svg%3E",e),r.imageSize=16,r.spaceWidth=1,r}(nt);n.SpreadJSFilterHeaderCellType=lt;tt=function(r){function u(t,i,u){var f=r.call(this)||this,e;return(f.calcSheetName=i,f.dataColIndex=u,f.typeName="Forguncy.CheckBoxCellTypeListView",!f.calcSheetName)?f:(f.initListviewInfo(t),e=n.Common.getMultiLanguageWord(f.listviewInfo.cellMetaData.CellType.Caption),n.Common.IsEmpty(e)||f.caption(e),f)}return __extends(u,r),Object.defineProperty(u.prototype,"listviewInfo",{get:function(){return this.__listviewInfo},enumerable:!1,configurable:!0}),u.prototype.initListviewInfo=function(n){n===void 0&&(n=null);this.__listviewInfo=new f(n,this.calcSheetName,this.dataColIndex)},u.shouldUse=function(t,i){return i.cellType.constructor===n.CheckBoxCellType&&!i.cellType.cellTypeData.canEnterEditModeInListview()},u.prototype.getHitInfo=function(n,t,i,u,f){return!f||!this.allowChecked(f.row)?null:r.prototype.getHitInfo.call(this,n,t,i,u,f)},u.prototype.paint=function(n,t,u,f,e,o,s,h){s=i.setAlternativeRowColor(h.row,this.listviewInfo.oddRowBackcolor,this.listviewInfo.evenRowBackcolor,s,this.listviewInfo.listViewStyleTemplate);r.prototype.paint.call(this,n,t,u,f,e,o,s,h)},u.prototype.paintValue=function(n,t,i,f,e,o,s,h){t=u.convertValue(t);r.prototype.paintValue.call(this,n,t,i,f,e,o,s,h)},u.prototype.allowChecked=function(t){return this.listviewInfo.visibleColumnInfo.canEditInForguncy&&!this.isReadOnly()&&!n.Platform.isMobile()&&!this.listviewInfo.listview.isCommiting(t)},u.prototype.isReadOnly=function(){var t=this.listviewInfo.cellMetaData.CellType.ReadOnly;return n.Common.IsEmpty(t)===!0?!1:t},u.prototype.processMouseDown=function(n){return(n===null||n===void 0?void 0:n.isReservedLocation)&&(this.__isMouseDownReservedLocation=!0),r.prototype.processMouseDown.call(this,n)},u.prototype.processMouseUp=function(n){if(!n)return!1;var i=this,t=n.sheet,u=this.listviewInfo.listview,f=u.mappedRowIndexFrowView(n.row);return i.__isMouseDownReservedLocation&&t&&n.isReservedLocation&&(t.getActiveRowIndex()!==n.row||t.getActiveColumnIndex()!==n.col||u.getCurrentRowIndex()!==f)?(i.__isMouseDownReservedLocation=!1,!1):this.allowChecked(f)?r.prototype.processMouseUp.call(this,n):!1},u.prototype.processMouseLeave=function(n){return n&&(this.__isMouseDownReservedLocation=!1),r.prototype.processMouseLeave.call(this,n)},u.convertValue=function(t){return n.CheckBoxCellType.isChecked(t)?1:0},u.prototype.isReservedKey=function(n,t){return this.allowChecked(t.row)&&r.prototype.isReservedKey.call(this,n,t)},u.prototype.toJSON=function(){return t.toJSON(this,this.calcSheetName,this.dataColIndex)},u.prototype.fromJSON=function(n){t.fromJSON(n,this);this.initListviewInfo()},u}(GC.Spread.Sheets.CellTypes.CheckBox);n.CheckBoxCellTypeListView=tt;t.register(tt.shouldUse,tt);et=function(r){function u(n,t){var i=r.call(this)||this;return(i.calcSheetName=t,i.__isMouseDownReservedLocation=!1,i.typeName="Forguncy.CheckBoxRowHeader",!i.calcSheetName)?i:(i.initListviewInfo(n),i)}return __extends(u,r),Object.defineProperty(u.prototype,"listviewInfo",{get:function(){return this.__listviewInfo},enumerable:!1,configurable:!0}),u.prototype.initListviewInfo=function(n){n===void 0&&(n=null);this.__listviewInfo=new f(n,this.calcSheetName,-1)},Object.defineProperty(u.prototype,"isMouseDownReservedLocation",{get:function(){return this.__isMouseDownReservedLocation},set:function(n){this.__isMouseDownReservedLocation=n},enumerable:!1,configurable:!0}),u.prototype.paint=function(i,u,f,e,o,s,h,c){var l=this.getThemeStyle(c.visualState,"gc-rowHeader-"+n.SpreadJSHelpMethods.HelpMethods.getVisualStateName(c.visualState));h=t.getCustomStyle(h,l,this.listviewInfo.listViewStyleTemplate,c.visualState);r.prototype.paint.call(this,i,u,f,e,o,s,h,c)},u.prototype.paintValue=function(t,i,u,f,e,o,s,h){var c=!1,l=h.sheet,a=h.row;n.ListViewHelper.SelectionHelper.isRowSelected(l,a)&&(c=!0);r.prototype.paintValue.call(this,t,c,u,f,e,o,s,h)},u.prototype.getHitInfo=function(n,t,r,u,f){return i.getHitInfo(n,t,r,u,GC.Spread.Sheets.SheetArea.rowHeader,f)},u.prototype.processMouseDown=function(n){return i.processMouseDown(this,n)},u.prototype.processMouseUp=function(n){return i.processMouseUp(this,n,n.row,n.col,GC.Spread.Sheets.SheetArea.rowHeader)},u.prototype.toJSON=function(){return t.toJSON(this,this.calcSheetName,-1)},u.prototype.fromJSON=function(n){t.fromJSON(n,this);this.initListviewInfo()},u}(GC.Spread.Sheets.CellTypes.CheckBox);n.CheckBoxRowHeader=et;at=function(r){function u(){var n=r!==null&&r.apply(this,arguments)||this;return n.__isMouseDownReservedLocation=!1,n.__isRowHeaderVisible=null,n.__isRowHeaderCheckBoxVisible=null,n}return __extends(u,r),Object.defineProperty(u.prototype,"isMouseDownReservedLocation",{get:function(){return this.__isMouseDownReservedLocation},set:function(n){this.__isMouseDownReservedLocation=n},enumerable:!1,configurable:!0}),u.prototype.getCheckBoxColumnWidth=function(n){var t=n.getColumnCount(GC.Spread.Sheets.SheetArea.rowHeader)===1?0:1;return n.getColumnWidth(t,GC.Spread.Sheets.SheetArea.rowHeader)-2},u.prototype.getCornerColumnWidth=function(n){return n.getColumnWidth(0,GC.Spread.Sheets.SheetArea.rowHeader)},u.prototype.getHitInfo=function(n,t,u,f,e){var o=e.sheet,s=this._getIsRowHeaderCheckBoxVisible(o);return s?(f.x=0,f.y=0,f.width=this.getCornerColumnWidth(o)+this.getCheckBoxColumnWidth(o),f.height=this._getColHeaderHeight(o),i.getHitInfo(n,t,u,f,GC.Spread.Sheets.SheetArea.corner,e)):r.prototype.getHitInfo.call(this,n,t,u,f,e)},u.prototype.processMouseDown=function(n){var u=this._getIsRowHeaderCheckBoxVisible(n.sheet),t;if(!u)return r.prototype.processMouseDown.call(this,n);t=i.processMouseDown(this,n);t||n.isReservedLocation&&(t=!0)},u.prototype.processMouseUp=function(n){var f=this._getIsRowHeaderCheckBoxVisible(n.sheet),u,t;if(!f)return r.prototype.processMouseUp.call(this,n);u=n.sheet;t=new GC.Spread.Sheets.Rect(0,0,0,0);t.x=0;u.getColumnCount(GC.Spread.Sheets.SheetArea.rowHeader)===2&&(t.x+=u.getColumnWidth(0,GC.Spread.Sheets.SheetArea.rowHeader));t.y=0;t.width=this.getCheckBoxColumnWidth(u);t.height=this._getColHeaderHeight(u);t.x<=n.x&&n.x<t.x+t.width&&t.y<=n.y&&n.y<t.y+t.height&&(n.isReservedLocation=!0,i.triggerButtonClicked(u,n.row,n.col,GC.Spread.Sheets.SheetArea.corner,GC.Spread.Sheets.SheetArea.corner))},u.prototype._getColHeaderHeight=function(n){for(var i=GC.Spread.Sheets.SheetArea.colHeader,u=n.getRowCount(i),r=0,t=0;t<u;t++)r+=n.getRowHeight(t,i);return r},u.prototype._getIsRowHeaderVisible=function(n){return this.__isRowHeaderVisible===null&&(this.__isRowHeaderVisible=n.getColumnCount(GC.Spread.Sheets.SheetArea.rowHeader)===1?!this._getIsRowHeaderCheckBoxVisible(n):!0),this.__isRowHeaderVisible},u.prototype._getIsRowHeaderCheckBoxVisible=function(n){var i,t;return(this.__isRowHeaderCheckBoxVisible===null&&(n.getColumnCount(GC.Spread.Sheets.SheetArea.rowHeader)===1?(i=n.getCellType(0,0,GC.Spread.Sheets.SheetArea.rowHeader),this.__isRowHeaderCheckBoxVisible=i instanceof et,this.__rowHeaderCheckBoxColumnIndex=0):(this.__isRowHeaderCheckBoxVisible=!0,this.__rowHeaderCheckBoxColumnIndex=1)),this.__isRowHeaderCheckBoxVisible&&(i=n.getCellType(0,this.__rowHeaderCheckBoxColumnIndex,GC.Spread.Sheets.SheetArea.rowHeader),t=i.listviewInfo.listview.listviewData.metadata.Columns[this.__rowHeaderCheckBoxColumnIndex],t&&!t.IsHiddenByLayout&&!t.IsHiddenByJavaScriptAPI&&!t.IsHiddenByColumnOptions))?!0:!1},u.prototype.paint=function(i,r,f,e,o,s,h,c){var kt,dt,y=c.sheet,gt=y.tag(),w=gt===null||gt===void 0?void 0:gt.ListViewStyleTemplate,pi=this._getIsRowHeaderVisible(y),ei=this._getIsRowHeaderCheckBoxVisible(y),st,b,it,ii,rt,ui,yt,ci,fi,li,vi,d,wt;if(n.ListViewHelper.SelectionHelper.isSelectAllRows(y)&&(r=!0),h.hAlign=GC.Spread.Sheets.HorizontalAlign.center,h.vAlign=GC.Spread.Sheets.VerticalAlign.center,st=ei?this.getCheckBoxColumnWidth(y)-1:0,i){i.save();i.rect(f,e,o,s);i.clip();i.beginPath();var ni=w?n.ColorHelper.Convert(w.ColumnHeaderBorder):null,oi="#C8C8C8",ht=ni,ct=ni;if(w&&!ni&&(ht=w.ShowColumnHeaderHorizontalGridLine?(kt=n.ColorHelper.Convert(w.ColumnHeaderGridLineColor))!==null&&kt!==void 0?kt:oi:"rgba(0,0,0,0)",ct=w.ShowColumnHeaderVerticalGridLine?(dt=n.ColorHelper.Convert(w.ColumnHeaderGridLineColor))!==null&&dt!==void 0?dt:oi:"rgba(0,0,0,0)"),b=GC.Spread.Sheets.VisualState.normal,it={},c.visualState!==undefined&&(b=c.visualState,it=this.getThemeStyle(GC.Spread.Sheets.VisualState.hover,"gc-corner-triangle-"+n.SpreadJSHelpMethods.HelpMethods.getVisualStateName(b))),pi){if(b!==undefined){try{var si=this.getThemeStyle(c.visualState,"gc-corner-"+n.SpreadJSHelpMethods.HelpMethods.getVisualStateName(b)),k=t.getCustomStyle(null,si,w,GC.Spread.Sheets.VisualState.normal),vt=k===null||k===void 0?void 0:k.backColor,ti=k===null||k===void 0?void 0:k.backgroundImage;vt?(i.fillStyle=vt,i.fillRect(f,e,o,s)):ti&&ti!=="none"&&(ii=new Image,rt=ti,rt=rt.replace('url("',""),rt=rt.replace('")',""),ii.src=rt,i.drawImage(ii,f,e,o,s))}catch(wi){}var lt=this.getThemeStyle(GC.Spread.Sheets.VisualState.hover,"gc-corner-triangle-"+n.SpreadJSHelpMethods.HelpMethods.getVisualStateName(b)),ut=t.getCustomStyle(null,lt,w,b),ri=ut===null||ut===void 0?void 0:ut.backgroundImage,hi=ut===null||ut===void 0?void 0:ut.backColor,at=i.createLinearGradient(f+o/2,e,f+o/2,e+s);if(ri&&ri.indexOf("linear-gradient")!==-1){for(ui=n.SpreadJSHelpMethods.util.getLinearGradientColors(ri),yt=0,ci=ui.length;yt<ci;yt++)fi=ui[yt],at.addColorStop(fi.point,fi.color);i.fillStyle=at}else hi&&(li="#f6fafb",at.addColorStop(.125,li),at.addColorStop(1,hi),i.fillStyle=at);this.paintRightBottomBorder(i,f,e,o,s,ct||lt.borderLeftColor,ct||lt.borderRightColor,ht||lt.borderTopColor,ht||lt.borderBottomColor,st)}i.restore()}else{if(b!==undefined)try{var si=this.getThemeStyle(c.visualState,"gc-corner-"+n.SpreadJSHelpMethods.HelpMethods.getVisualStateName(b)),k=t.getCustomStyle(h,si,w,b),vt=k===null||k===void 0?void 0:k.backColor;vt&&(i.fillStyle=vt,i.fillRect(f,e,o,s))}catch(wi){}this.paintRightBottomBorder(i,f,e,o,s,ct||it.borderLeftColor,ct||it.borderRightColor,ht||it.borderTopColor,ht||it.borderBottomColor,st);i.restore()}if(ei&&y.selectionPolicy()!==GC.Spread.Sheets.SelectionPolicy.single&&i){i.save();i.rect(f,e,o,s);i.clip();i.beginPath();var ai=this,tt="",ft=0,p=0;y&&(ft=t.getStringWidthByCanvas(tt,h.font,y),p=t.getTextHeight(h.font,y),tt&&(vi=tt.split(/\r\n|\r|\n/),p*=vi.length));d=new GC.Spread.Sheets.CellTypes.CheckBox;f=f+o-st;o=st;var l=u._checkboxSize/2,yi=new GC.Spread.Sheets.Rect(++f,++e,--o,--s),a=parseInt((e+ai._getCheckBoxTop(d,h,yi,p,y.zoom())).toString()),v=parseInt((f+ai._getCheckBoxLeft(d,h,yi,ft,y.zoom())).toString()),pt="left",et=v+1;h.hAlign===GC.Spread.Sheets.HorizontalAlign.center?(pt="center",et+=l):h.hAlign===GC.Spread.Sheets.HorizontalAlign.right&&(pt="right",et+=l*2);wt=h.font;wt&&i.font!==wt&&(i.font=wt);h.foreColor&&(i.fillStyle=h.foreColor);var g=h.textDecoration,ot=c.fontInfo.fontSize,bt=ot>8?Math.floor((ot-8)/5+2):1,nt=p/2-ot/2+bt-1;i.textBaseline!=="alphabetic"&&(i.textBaseline="alphabetic");d.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.left?(i.textAlign="right",i.fillText(tt,v+1-2,a+l+p/2-nt),g&&t.renderTextDecoration(i,g,v+1-2,a+l+p/2-nt,ft,ot,bt)):d.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.top&&(i.textAlign=pt,i.fillText(tt,et,a-2-nt),g&&t.renderTextDecoration(i,g,et,a-2-nt,ft,p));i.save();i.strokeStyle="black";v-=2;i.strokeRect(v+.5,a+.5,l*2+.05,l*2+.05);i.fillStyle="white";i.fillRect(v+1,a+1,l*2-1,l*2-1);d.isThreeState()&&(r===null||r===undefined)?(i.beginPath(),i.fillStyle="green",i.rect(v+3,a+3,(l-2.5)*2,(l-2.5)*2),i.fill()):!!r==!0&&(i.beginPath(),i.lineWidth=2.5,i.moveTo(v+3,a+l),i.lineTo(v+l,a+l*2-3.5),i.lineTo(v+l*2-1.5,a+3),i.stroke());i.restore();h.foreColor&&(i.fillStyle=h.foreColor);d.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.right?(i.textAlign="left",i.fillText(tt,v+1+l*2+2,a+l+p/2-nt),g&&t.renderTextDecoration(i,g,v+1+l*2+2,a+l+p/2-nt,ft,ot,bt)):d.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.bottom&&(i.textAlign=pt,i.fillText(tt,et,a+l*2+2+p-nt),g&&t.renderTextDecoration(i,g,et,a+l*2+2+p-nt,ft,ot,bt));i.restore()}}},u.prototype._getCheckBoxLeft=function(n,t,i,r,f){var e=i.x-1,s=i.width+1,h=0,o=0,c=5*f;return n.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.top||n.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.bottom?(o=e+c,t.hAlign===GC.Spread.Sheets.HorizontalAlign.center?o=e+s/2-u._checkboxSize/2:t.hAlign===GC.Spread.Sheets.HorizontalAlign.right&&(o=e+s-c-u._checkboxSize)):n.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.left?(h=u._checkboxSize+r,o=e+c+r,t.hAlign===GC.Spread.Sheets.HorizontalAlign.center?o=e+s/2-h/2+r:t.hAlign===GC.Spread.Sheets.HorizontalAlign.right&&(o=e+s-c-h+r)):(h=u._checkboxSize+r,o=e+c,t.hAlign===GC.Spread.Sheets.HorizontalAlign.center?o=e+s/2-h/2:t.hAlign===GC.Spread.Sheets.HorizontalAlign.right&&(o=e+s-c-h)),o-e},u.prototype._getCheckBoxTop=function(n,t,i,r,f){var e=i.y-1,s=i.height+1,h=0,o=0,c=5*f;return n.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.top?(h=u._checkboxSize+r,o=e+c+r,t.vAlign===GC.Spread.Sheets.VerticalAlign.center?o=e+s/2-h/2+r:t.vAlign===GC.Spread.Sheets.VerticalAlign.bottom&&(o=e+s-c-h+r)):n.textAlign()===GC.Spread.Sheets.CellTypes.CheckBoxTextAlign.bottom?(h=u._checkboxSize+r,o=e+c,t.vAlign===GC.Spread.Sheets.VerticalAlign.center?o=e+s/2-h/2:t.vAlign===GC.Spread.Sheets.VerticalAlign.bottom&&(o=e+s-c-h)):(o=e+c,t.vAlign===GC.Spread.Sheets.VerticalAlign.center?o=e+s/2-u._checkboxSize/2:t.vAlign===GC.Spread.Sheets.VerticalAlign.bottom&&(o=e+s-c-u._checkboxSize)),o-e},u.prototype.paintRightBottomBorder=function(n,t,i,r,u,f,e,o,s,h){var y=n.createLinearGradient(t+r,i+1,t+r,i+u-2),l,c,a,v;y.addColorStop(0,f);y.addColorStop(1,e);n.beginPath();n.strokeStyle=y;n.moveTo(t+r-.5,i);n.lineTo(t+r-.5,i+u);n.stroke();l=n.createLinearGradient(t,i,t+r-2,i);l.addColorStop(0,o);l.addColorStop(1,s);n.beginPath();n.strokeStyle=l;n.moveTo(t,i+u-.5);n.lineTo(t+r,i+u-.5);n.stroke();n.beginPath();c=3;a=u;r-h<u&&(a=r-h);v=h;n.moveTo(t+r-a+c-v,i+u-c);n.lineTo(t+r-c-v,i+u-c);n.lineTo(t+r-c-v,i+u-a+c);n.fill()},u._checkboxSize=12,u}(GC.Spread.Sheets.CellTypes.Corner);n.MutiCheckCornerCellType=at;it=function(r){function u(n,t,i){var u=r.call(this)||this,f;return(u.calcSheetName=t,u.dataColIndex=i,u._nodes=[],!u.calcSheetName)?u:(u.initListviewInfo(n),f=u.listviewInfo.listview.getSheet(),u._currentZoomFactor=f.zoom(),u.listviewInfo.cellMetaData.CellType.hasInitItemsInfo=!1,u._tryInitItemsInfo(f),u)}return __extends(u,r),Object.defineProperty(u.prototype,"listviewInfo",{get:function(){return this.__listviewInfo},enumerable:!1,configurable:!0}),u.prototype.initListviewInfo=function(n){n===void 0&&(n=null);this.__listviewInfo=new f(n,this.calcSheetName,this.dataColIndex)},Object.defineProperty(u.prototype,"cellStyle",{get:function(){return this.__cellStyle||(this.__cellStyle=n.SpreadJSView.createStyleByCell(this.listviewInfo.visibleColumnInfo.columnInfo.TemplateCell)),this.__cellStyle},enumerable:!1,configurable:!0}),u.prototype._tryInitItemsInfo=function(n){var i,t=this.listviewInfo.cellMetaData.CellType;!t.hasInitItemsInfo&&t.haveLoadItems&&(this._initItemsInfo(n,t),t.hasInitItemsInfo=!0,(i=t.initItemsInfoCallback)===null||i===void 0?void 0:i.call(t))},u.prototype._initItemsInfo=function(i,r){var u=this,e,f,o,s,h,c,a,l,v;for(u.itemsMargin=n.Common.IsEmpty(r.ItemSpace)===!0?5:r.ItemSpace,u.itemsDisplayText=[],u.itemsValueText=[],u.itemsTextWidth=[],u.totalTextWidth=0,u.itemsTextHeight=[],u.itemsTextFormatFontColor=[],e=r.ItemsInfo.Items,u.itemsCount=e.length,f=0;f<u.itemsCount;f++)o=void 0,o=e[f].DisplayValue===undefined||e[f].DisplayValue===null?r.AddNullItemWhenBinding?r.AddOtherItem:"":n.Common.getMultiLanguageWord(e[f].DisplayValue.toString()),s=this.listviewInfo.cellMetaData.StyleInfo,s.Formatter&&(h=n.FormatHelper.format(s.Formatter,o),o=h.text,u.itemsTextFormatFontColor[f]=h.color),u.itemsDisplayText[f]=o,u.itemsValueText[f]=n.Common.IsEmpty(e[f].Value)?"":e[f].Value.toString(),c=n.ListViewHelper.SpreadJSStyleHelper.generateFontText(s),u.itemsTextWidth[f]=t.getStringWidthByCanvas(u.itemsDisplayText[f],c,i),u.totalTextWidth+=u.itemsTextWidth[f],u.itemsTextHeight[f]=t.getTextHeight(c,i),u.itemsDisplayText[f]&&(a=u.itemsDisplayText[f].split(/\r\n|\r|\n/),u.itemsTextHeight[f]*=a.length);l=this.listviewInfo.listview;v=l.listviewData.getAutoFitColumnWidth();v&&n.DelayRefresh.setTimeout(function(){l.autoFitColumnWidth()})},u.prototype.getItemLeftPosition=function(n,t,i,r,f){for(var l=t.width,s=0,o=0,e=this,a=e._getItemsGroupMargin(r),h=0,c=0;c<f;c++)h+=i[c];return h+=e.itemsMargin*f,s=e.itemsCount*(u.itemsSize+e.itemsMargin)+e.totalTextWidth,n.hAlign===GC.Spread.Sheets.HorizontalAlign.left?o=a:n.hAlign===GC.Spread.Sheets.HorizontalAlign.center?o=l/2-s/2:n.hAlign===GC.Spread.Sheets.HorizontalAlign.right&&(o=l-a-s),o+u.itemsSize*f+h},u.prototype.getItemTopPosition=function(n,t,i){var f=t.height,o=this,e=o._getItemsGroupMargin(i),r=e;return n.vAlign===GC.Spread.Sheets.VerticalAlign.center?r=f/2-u.itemsSize/2:n.vAlign===GC.Spread.Sheets.VerticalAlign.bottom&&(r=f-e-u.itemsSize),r},u.prototype._getItemsGroupMargin=function(n){return 5*n},u.prototype._isHitCurrentItem=function(n,t){var i=this,o=parseInt(i.getItemLeftPosition(i.cellStyle,n.cellRect,i.itemsTextWidth,n.sheet.zoom(),t).toString()),s=parseInt(i.getItemTopPosition(i.cellStyle,n.cellRect,n.sheet.zoom()).toString()),r=o+n.cellRect.x+u.itemsSize/2,f=s+n.cellRect.y+u.itemsSize/2,h=u.itemsSize/2,c=u.itemsSize/2+i.itemsTextWidth[t],e=i.itemsTextHeight[t]/2;if(r-h<=n.x&&n.x<=r+c&&f-e<=n.y&&n.y<=f+e)return!0},u.prototype.updateItemsGroupValue=function(n,t){var e=this,i=n.toString().split(","),o=i.indexOf(this.itemsValueText[t]),r,u,s,f;if(o===-1){for(i.push(this.itemsValueText[t]),r=[],u=0;u<i.length;u++)s=e.itemsValueText.indexOf(i[u]),s!==-1&&r.push(e.itemsValueText.indexOf(i[u]));for(r.sort(function(n,t){return n-t}),i=[],f=0;f<r.length;f++)i[f]=e.itemsValueText[r[f]]}else i.splice(o,1);return i.join(",")},u.prototype._allowChecked=function(t){var i=this.listviewInfo.cellMetaData.CellType;return this.listviewInfo.visibleColumnInfo.canEditInForguncy&&!i.ReadOnly&&!n.Platform.isMobile()&&!this.listviewInfo.listview.isCommiting(t)},u.prototype.getHitInfo=function(n,t,i,r,u){if(u&&this._allowChecked(u.row)){var f=u.sheetArea;if(f===null||f===undefined||f===GC.Spread.Sheets.SheetArea.viewport)return{x:n,y:t,row:u.row,col:u.col,cellRect:r,sheetArea:f,isReservedLocation:!0,sheet:u.sheet}}return null},u.prototype.processMouseDown=function(n){if(!n)return!1;n.isReservedLocation&&(this.__isMouseDownReservedLocation=!0)},u.prototype.getNode=function(t){return n.Common.IsEmpty(this._nodes[t])&&(this._nodes[t]={}),this._nodes[t]},u.prototype.deleteNode=function(n){this._nodes[n]=undefined},u.prototype.processMouseUp=function(i){var u=this,f,h,o;if(u._allowChecked(i.row)){if(f=i.sheet,u.__isMouseDownReservedLocation&&f&&i.isReservedLocation){u.__isMouseDownReservedLocation=!1;var e=i.row,c=i.col,s=i.sheetArea,r=u.getNode(e);if(r.isFirstMouseUp)delete r.isFirstMouseUp,r.mouseupToken&&(window.clearTimeout(r.mouseupToken),delete r.mouseupToken),u.deleteNode(e);else{if(s===null||s===undefined||s===GC.Spread.Sheets.SheetArea.viewport){h=f.getValue(e,c,s);n.Common.IsEmpty(h)&&(h="");var l="",a=u.listviewInfo.listview,v=a.mappedRowIndexFrowView(e);for(o=0;o<u.itemsCount;o++)if(u._isHitCurrentItem(i,o)){f.getActiveRowIndex()===e&&f.getActiveColumnIndex()===c&&a.getCurrentRowIndex()===v&&(l=u.updateItemsGroupValue(h.toString(),o),t.executeEditCommand(f,e,c,l));break}}return r.isFirstMouseUp=!0,r.mouseupToken=window.setTimeout(function(){delete r.isFirstMouseUp;r.mouseupToken&&(window.clearTimeout(r.mouseupToken),delete r.mouseupToken)},250),!0}}return!1}},u.prototype.paint=function(t,r,u,f,e,o,s,h){t&&(this._currentZoomFactor=h.sheet.zoom(),this._tryInitItemsInfo(h.sheet),s=i.setAlternativeRowColor(h.row,this.listviewInfo.oddRowBackcolor,this.listviewInfo.evenRowBackcolor,s,this.listviewInfo.listViewStyleTemplate),(h===null||h===void 0?void 0:h.parentBackColor)&&h.parentBackColor===s.backColor||n.SpreadJSHelpMethods.CellTypeContext.paintBackground(t,u,f,e,o,s.backColor,s.backgroundImage,s.backgroundImageLayout,h.imageLoader),this.paintValue(t,r,u,f,e,o,s,h))},u.prototype.paintValue=function(i,r,f,e,o,s,h,c){var l,y,v,w,a;if(i)try{if(i.save(),i.rect(f,e,o,s),i.clip(),i.beginPath(),l=this,y=c.sheet,y)for(v=u.itemsSize/2,w=new GC.Spread.Sheets.Rect(++f,++e,--o,--s),a=0;a<l.itemsCount;a++){var b=parseInt((f+l.getItemLeftPosition(h,w,l.itemsTextWidth,y.zoom(),a)).toString()),k=parseInt((e+l.getItemTopPosition(h,w,y.zoom())).toString()),d=h.font;d&&i.font!==d&&(i.font=d);h.foreColor&&(i.fillStyle=h.foreColor);var g=h.textDecoration,p=c.fontInfo.fontSize,nt=p>8?Math.floor((p-8)/5+2):1,tt=l.itemsTextHeight[a]/2-p/2+nt-1;i.textBaseline!=="alphabetic"&&(i.textBaseline="alphabetic");l.paintIcon(i,r,b,k,v,a);n.Common.IsEmpty(l.itemsTextFormatFontColor[a])?h.foreColor&&(i.fillStyle=h.foreColor):i.fillStyle=l.itemsTextFormatFontColor[a];i.textAlign="left";i.fillText(l.itemsDisplayText[a],b+1+v*2+2,k+v+l.itemsTextHeight[a]/2-tt);g&&t.renderTextDecoration(i,g,b+1+v*2+2,k+v+l.itemsTextHeight[a]/2-tt,l.itemsTextWidth[a],p,nt)}}finally{i.restore()}},u.prototype.paintIcon=function(){},u.prototype.getAutoFitWidth=function(){var n=this;return n.itemsCount*(u.itemsSize+n.itemsMargin)+n.totalTextWidth},u.prototype.getAutoFitHeight=function(){var n=this,t=0;return n.itemsTextHeight&&n.itemsTextHeight.length>0&&n.itemsTextHeight.forEach(function(n){n>t&&(t=n)}),Math.max(u.itemsSize,t)},u.prototype.getCurrentItemInfo=function(n,t){if(t<0||t>=this.itemsCount)return null;var i={};return i["width"]=this.itemsTextWidth[t]+u.itemsSize,i["height"]=this.itemsTextHeight[t],i["startX"]=this.getItemLeftPosition(this.cellStyle,n,this.itemsTextWidth,this._currentZoomFactor,t),i["startY"]=this.getItemTopPosition(this.cellStyle,n,this._currentZoomFactor),i["displayText"]=this.itemsDisplayText[t],i},u.prototype.toJSON=function(){var n=t.toJSON(this,this.calcSheetName,this.dataColIndex);return n._nodes=this._nodes,n.itemsDisplayText=this.itemsDisplayText,n.itemsValueText=this.itemsValueText,n.itemsTextWidth=this.itemsTextWidth,n.itemsTextHeight=this.itemsTextHeight,n.itemsTextFormatFontColor=this.itemsTextFormatFontColor,n},u.prototype.fromJSON=function(n){r.prototype.fromJSON.call(this,n);this.initListviewInfo()},u.itemsSize=12,u}(GC.Spread.Sheets.CellTypes.Base);n.SpreadJSItemsGroupCellTypeBase=it;rt=function(t){function i(n,i,r){var u=t.call(this,n,i,r)||this;return u.typeName="Forguncy.SpreadJSCheckBoxGroupCellType",u}return __extends(i,t),i.shouldUse=function(t,i){return i.cellType.constructor===n.CheckBoxGroupCellType&&!i.cellType.cellTypeData.canEnterEditModeInListview()},i.prototype.paintIcon=function(n,t,i,r,u,f){try{if(n.save(),n.strokeStyle="Black",n.strokeRect(i+.5,r+.5,u*2+.05,u*2+.05),n.fillStyle="White",n.fillRect(i+1,r+1,u*2-1,u*2-1),t!==undefined){t===null&&(t="");var e=t.toString().split(",");e.indexOf(this.itemsValueText[f])!==-1&&(n.beginPath(),n.strokeStyle="Black",n.lineWidth=2.5,n.moveTo(i+3,r+u),n.lineTo(i+u,r+u*2-3.5),n.lineTo(i+u*2-1.5,r+3),n.stroke())}}finally{n.restore()}},i}(it);n.SpreadJSCheckBoxGroupCellType=rt;t.register(rt.shouldUse,rt);ut=function(t){function i(n,i,r){var u=t.call(this,n,i,r)||this;return u.typeName="Forguncy.SpreadJSRadioGroupCellType",u}return __extends(i,t),i.shouldUse=function(t,i){return i.cellType.constructor===n.RadioGroupCellType&&!i.cellType.cellTypeData.canEnterEditModeInListview()},i.prototype.paintIcon=function(n,t,i,r,u,f){try{if(n.save(),n.beginPath(),n.arc(i+u,r+u,u,0,2*Math.PI),n.closePath(),n.strokeStyle="Black",n.stroke(),n.beginPath(),n.arc(i+u,r+u,u-.5,0,2*Math.PI),n.closePath(),n.fillStyle="White",n.fill(),t!==undefined){t===null&&(t="");var e=t.toString();e===this.itemsValueText[f]&&(n.beginPath(),n.arc(i+u,r+u,u-2.8,0,2*Math.PI),n.closePath(),n.fillStyle="Black",n.fill())}}finally{n.restore()}},i.prototype.updateItemsGroupValue=function(n,t){return n!==this.itemsValueText[t]?this.itemsValueText[t]:n},i}(it);n.SpreadJSRadioGroupCellType=ut;t.register(ut.shouldUse,ut);f=function(){function t(t,i,r,u){u===void 0&&(u=!0);this.calcSheetName=i;this.dataColIndex=r;this._useTemplateCell=u;t?this._listview=t:this.calcSheetName&&(this._listview=n.ListviewBase.getListviewByCalcSheetName(i))}return Object.defineProperty(t.prototype,"listview",{get:function(){return this._listview},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"visibleColumnInfo",{get:function(){if(this._visibleColumnInfo)return this._visibleColumnInfo;var n=this.listview.getVisibleColumnIndexInListViewByDataIndex(this.dataColIndex);return n===-1?null:(this._visibleColumnInfo=this.listview.listviewData.visibleColumns[n],this._visibleColumnInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cellMetaData",{get:function(){var n;return this._useTemplateCell?(n=this.visibleColumnInfo)===null||n===void 0?void 0:n.getTemplateCell():null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"listViewStyleTemplate",{get:function(){return this.listview.listViewStyleTemplate},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataModel",{get:function(){var n;if((n=this.listview)!==null&&n!==void 0)return n.getListDataModel()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasTotalRow",{get:function(){return this.listview.allowShowTotalRow()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isTotalRowAtFirst",{get:function(){return this.hasTotalRow&&this.listview.listviewData.getIsTotalRowAtFirstRow()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oddRowBackcolor",{get:function(){return this.listview.oddRowBackcolor},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"evenRowBackcolor",{get:function(){return this.listview.evenRowBackcolor},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"listviewName",{get:function(){return this.listview.listviewData.getListviewName()},enumerable:!1,configurable:!0}),t}()})(Forguncy||(Forguncy={}))
;var __spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var t={SortAsc:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M7 7H5.906L5.47 5.864H3.48L3.067 7H2l1.94-5h1.065L7 7zM5.148 5.022L4.46 3.166l-.673 1.856h1.36z" fill="#418FCF"/><path fill="#C74444" d="M2 14v-.91l3.233-3.244H2.365V9H6.87v.784l-3.371 3.374H7V14z"/><g fill="#666"><path d="M11.5 13L9 10h5zM11 3h1v7h-1z"/><\/g><\/g><\/svg>',SortDesc:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M7 14H5.906l-.436-1.136H3.48L3.067 14H2l1.94-5h1.065L7 14zm-1.852-1.978l-.687-1.856-.673 1.856h1.36z" fill="#418FCF"/><path fill="#C74444" d="M2 7v-.91l3.233-3.244H2.365V2H6.87v.784L3.499 6.158H7V7z"/><g fill="#666"><path d="M11.5 13L9 10h5zM11 3h1v7h-1z"/><\/g><\/g><\/svg>',SortAsc_Checked:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M7 7H5.906L5.47 5.864H3.48L3.067 7H2l1.94-5h1.065L7 7zM5.148 5.022L4.46 3.166l-.673 1.856h1.36z" fill="#418FCF"/><path fill="#C74444" d="M2 14v-.91l3.233-3.244H2.365V9H6.87v.784l-3.371 3.374H7V14z"/><g fill="#666"><path d="M11.5 13L9 10h5zM11 3h1v7h-1z"/><\/g><path stroke="#EA7044" d="M.5.5h15v15H.5z"/><\/g><\/svg>',SortDesc_Checked:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M7 14H5.906l-.436-1.136H3.48L3.067 14H2l1.94-5h1.065L7 14zm-1.852-1.978l-.687-1.856-.673 1.856h1.36z" fill="#418FCF"/><path fill="#C74444" d="M2 7v-.91l3.233-3.244H2.365V2H6.87v.784L3.499 6.158H7V7z"/><g fill="#666"><path d="M11.5 13L9 10h5zM11 3h1v7h-1z"/><\/g><path stroke="#EA7044" d="M.5.5h15v15H.5z"/><\/g><\/svg>',FilterClear:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="a" d="M0 0h12v12H0z"/><\/defs><g fill="none" fill-rule="evenodd"><path d="M7.302 6.528c0-.026-.005-.054-.001-.079-.004.025 0 .053 0 .08M7.329 6.684c.01.033.027.066.044.102a1.047 1.047 0 0 1-.044-.102M7.361 6.305c.01-.013.012-.03.022-.042-.01.012-.013.03-.022.042" fill="#419AE5"/><path d="M15.7 13.868c-.45-1.072-1.792-2.812-3.062-4.322 1.632-1.426 2.98-2.34 2.98-2.34s1.135-.887-.562-.323c-.75.25-1.92 1.008-3.099 1.863a63.838 63.838 0 0 0-1.567-1.749c-1.398-1.675-4.92-1.127-1.93.8.82.497 1.627 1.117 2.388 1.775a65.873 65.873 0 0 0-2.575 2.084c-1.672 1.278-1.834 5.243.336 2.251.891-1.293 2.026-2.506 3.123-3.538a37.099 37.099 0 0 1 3.776 4.2s.964 1.133.192-.7" fill="#D65836"/><g transform="translate(0 1)"><mask id="b" fill="#fff"><use xlink:href="#a"/><\/mask><path d="M6.857 10.286v-3.53a2.587 2.587 0 0 1-.38-.527 1.473 1.473 0 0 1-.164-.922c0-.008 0-.013.002-.02.01-.056.015-.11.03-.167.207-.7.902-1.12 1.858-1.12.193 0 .409.021.638.062L12 0H0l5.143 6.612V12l1.714-1.714z" fill="#666" mask="url(#b)"/><\/g><\/g><\/svg>'},r=function(){function t(){}return t.getFieldColumnFilterQueries=function(t,i){i===void 0&&(i=[]);var r=n.ForguncyData.pageInfo.columnFilterQueryCache[t];return r?r.filter(function(n){return n.ColumnBindingInfoID&&i.filter(function(t){return t.GUID===n.ColumnBindingInfoID}).length===0}):null},t.clearColumnFilterCache=function(t){var i=t.getLocationString();n.ForguncyData.pageInfo.columnFilterQueryCache[i]=undefined},t.showContextMenu=function(t,r){var f=r.col,u=(new n.UI.ContextMenu).identify("fgc-columnfilter-contextmenu"),s=i.createSortMenuItems(t,f,u),h=i.createClearFilterMenuItem(t,f,u),c=i.createAdvancedFilterMenuItem(t,f,u),l=i.createBasicFilterMenuItem(t,f,u),o,e;u.add.apply(u,__spreadArray(__spreadArray([],s,!1),[new n.UI.ContextMenuItem(new n.UI.ContextMenuSpliter),h,new n.UI.ContextMenuItem(new n.UI.ContextMenuSpliter),c,l],!1));n.ForguncyData.pageInfo.appendExtralPopup(u);n.PageBuilder.pagesContainer.append(u.createUI().container);o=$(n.SpreadJSView.getCanvas(t.getCalcSheetName()));e=o.offset();u.location=new n.Numerics.Vector2(e.left+r.x||0,e.top+r.y||0);u.show()},t}(),i;n.ColumnFilterHelper=r;i=function(){function i(){}return i.createSortMenuItems=function(r,u,f){var e=r.listviewData.visibleColumns[u],h=i.isFilterCurrentPage(r,e)?n.RS.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage:"",o=new n.UI.ContextMenuButton(n.RS.ColumnFilter_ContextMenu_SortAscending+h,t.SortAsc_Checked,t.SortAsc).on("Clicked",function(){r.sortByColumn(u,0);f.dispose()}).identify("fgc-columnfilter-sortasc"),s=new n.UI.ContextMenuButton(n.RS.ColumnFilter_ContextMenu_SortDesending+h,t.SortDesc_Checked,t.SortDesc).on("Clicked",function(){r.sortByColumn(u,1);f.dispose()}).identify("fgc-columnfilter-sortdesc"),c=e.sortInfo;return o.isChecked=c===0,s.isChecked=c===1,e.getIsFilterListCompareType()&&(o.enabled=!1,s.enabled=!1),[o,s].map(function(t){return new n.UI.ContextMenuItem(t)})},i.createClearFilterMenuItem=function(r,u,f){var e=r.listviewData.visibleColumns[u],o=r.getColumnFilterHelper(e),h=i.isFilterCurrentPage(r,e)?n.RS.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage:"",s=new n.UI.ContextMenuButton(n.RS.ColumnFilter_ContextMenu_ClearFilter+h,t.FilterClear,t.FilterClear).on("Clicked",function(){r.tryCommitValueBeforeQueryOrSort()&&(o.clearColumnFilter(),r.resetDataAfterFilter(e));f.dispose()}).identify("fgc-columnfilter-clear");return s.enabled=o.isColumnFilterValid(o.columnFilterQuery),new n.UI.ContextMenuItem(s)},i.createAdvancedFilterMenuItem=function(t,r,u){var f=t.listviewData.visibleColumns[r],c=this.getColumnDataType(f,t),s=n.AdvancedFilterFactory.create(c,i.isFilterCurrentPage(t,f)),e,h,o;if(s&&(e=new n.UI.ContextMenuButton(s.title),h=t.getColumnFilterHelper(f).columnFilterQuery,e.isChecked=!n.Common.IsEmpty(h.Conditions)),e){o=new n.UI.ContextMenuItem(e).identify("fgc-columnfilter-advanced");o.child=s.createContextMenu(t,f);o.child.on("Dispose",function(){u.dispose()})}return o},i.getColumnDataType=function(t,i){if(t.allowFieldSort()){if(t.getIsFilterListCompareType())return 4;var r=t.getFilterColumnDataType();return this.convertFilterDataType(r)}return n.Common.IsEmpty(t.filterColumnDataType)&&(t.filterColumnDataType=this.getDataTypeOfNoFieldColumn(i,t)),t.filterColumnDataType},i.getDataTypeOfNoFieldColumn=function(n,t){var i=this.getValueTypeByFormatString(t);return i!==null?i:this.getDataTypeOfFirstValue(n,t)},i.getValueTypeByFormatString=function(t){var i=t.getOriginalFormatter();return n.FormatHelper.isFormatSetted(i)?i==="@"?1:n.FormatHelper.isDateOrTimeFormat(i)?n.FormatHelper.isTimeFormat(i)?3:2:null:null},i.getDataTypeOfFirstValue=function(t,i){for(var r,e,u=t.getListDataModel(),o=i.getColumnIndex(),s=u.getRowCount(),f=0;f<s;f++){r=u.getValue(0,o);e=typeof r;switch(e){case"number":return 0;case"string":return 1;case"object":if(n.DateHelper.isValidDate(r))return this.isTime(n.Convertor.fromDateToOADate(r))?3:2}}return null},i.isTime=function(n){return n<=1},i.createBasicFilterMenuItem=function(t,r,u){var f=t.listviewData.visibleColumns[r],s=i.isFilterCurrentPage(t,f)?n.RS.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage:"",e=new n.UI.ContextMenuButton(n.RS.ColumnFilter_ContextMenu_Filter+s).on("Clicked",function(){u.dispose();var i=new n.BasicFilterDialog(t,f);n.ForguncyData.pageInfo.appendExtralPopup(i);n.PageBuilder.pagesContainer.append(i.createUI().container);i.show()}).identify("fgc-columnfilter-basic"),o=t.getColumnFilterHelper(f).columnFilterQuery;return e.isChecked=n.Common.IsEmpty(o.Conditions)&&!n.Common.IsEmpty(o.Values),e.enabled=!f.getIsFilterStatisticColumn(),new n.UI.ContextMenuItem(e)},i.convertFilterDataType=function(t){switch(t){case n.ColumnDataType.String:case n.ColumnDataType.User:return 1;case n.ColumnDataType.Number:return 0;case n.ColumnDataType.Date:return 2;case n.ColumnDataType.Time:return 3;default:return null}},i.isFilterCurrentPage=function(t,i){return i.allowNoFieldSort()&&n.ForguncyData.pageingInfoList.IsPageing(t.getLocationString())},i}();n.ContextMenuBuilder=i})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var r='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><title>Admonition<\/title><g fill="none" fill-rule="evenodd"><path d="M8.933 1.557l6.878 11.5c.344.574.205 1.35-.31 1.733-.185.137-.401.21-.623.21H1.122C.502 15 0 14.44 0 13.75c0-.247.066-.488.188-.694l6.879-11.5C7.41.983 8.107.828 8.622 1.21c.123.092.23.21.311.347z" fill="#F8BB59"/><path d="M7 5h2l-.37 6H7.37L7 5zm.994 7c.283 0 .529.093.722.278.18.186.284.424.284.715 0 .292-.103.543-.284.729a1.032 1.032 0 0 1-.722.278.94.94 0 0 1-.697-.291C7.09 13.523 7 13.285 7 12.993c0-.291.09-.53.297-.715A.93.93 0 0 1 7.994 12z" fill="#666"/><\/g><\/svg>',u=function(i){function u(u,f){var e=i.call(this)||this;return e.id="fgc-basicfilter-dialog",e.defaultUI=t,e.treeView=(new n.UI.TreeView).identify("fgc-basicfilter-treeview"),e.textBlock=new n.UI.IconText(n.RS.ColumnFilter_TreeView_TooManyItems,r).identify("fgc-basicfilter-overflow"),e.progress=new n.UI.Progress,e.isShowAllItems=!0,e.listview=u,e.visibleColumn=f,e.columnFilterHelper=u.getColumnFilterHelper(f),e.title=n.RS.ColumnFilter_Dialog_Title+(n.ContextMenuBuilder.isFilterCurrentPage(u,f)?n.RS.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage:""),e.textBlock.visibility=!1,e.progress.show(),n.DelayRefresh.setTimeout(function(){e.initializeEvents();e.initializeData();n.DelayRefresh.setTimeout(function(){e.progress.hide()},0)},0),e}return __extends(u,i),u.prototype.initializeEvents=function(){var n=this;this.on("Confirm",function(){if(n.listview.tryCommitValueBeforeQueryOrSort()){if(n.treeView.nodes[0].isChecked&&!n.treeView.nodes[0].indeterminate)n.columnFilterHelper.clearColumnFilter();else{n.columnFilterHelper.clearColumnFilterConditions();var t=n.treeView.nodes[0].leafs,r=t.filter(function(n){return n.isChecked}),u=!1,i=null;r.length<t.length/2||!n.isShowAllItems?i=r.map(function(n){return n.userData.DisplayValue}):(u=!0,i=t.filter(function(n){return!n.isChecked}).map(function(n){return n.userData.DisplayValue}));n.columnFilterHelper.setBasicFilter(u,i)}n.listview.resetDataAfterFilter(n.visibleColumn)}})},u.prototype.initializeData=function(){var t=this,i=function(i,r){var e=i||[],c=r||__spreadArray([],e,!0),o=e.map(function(n,t){return{Value:e[t],DisplayValue:c[t]}}),f=o.filter(function(n){return n.Value!==null&&n.DisplayValue!==null}),s,h,u;f.length<o.length&&f.push({Value:null,DisplayValue:"%Null%"});h=n.ContextMenuBuilder.getColumnDataType(t.visibleColumn,t.listview);s=h===2?t.generateDateNodes(f):t.generateNormalNodes(f,t.visibleColumn,t.listview);u=new n.UI.TreeViewNode(n.RS.ColumnFilter_TreeView_SelectAll);u.isExpand=!0;u.addChildren(s);t.initRootCheckedState(u);u.refreshNodes();t.treeView.add(u);t.isShowAllItems=u.leafs.length<500;t.textBlock.visibility=!t.isShowAllItems;t.footerButtonGroup.items[0].enabled=u.isChecked||u.indeterminate;u.on("PropertyChanged",function(n,i){(i==="isChecked"||i==="indeterminate")&&(t.footerButtonGroup.items[0].enabled=u.isChecked||u.indeterminate)})},r=function(){t.footerButtonGroup.items[0].enabled=!1};this.visibleColumn.allowFieldSort()?this.queryRowsForFieldColumn(i,r):this.queryRowsForNoFieldColumn(i,r)},u.prototype.initRootCheckedState=function(n){var u,t=this.columnFilterHelper.columnFilterQuery,r=t.IsNotInMode,i=t.Values,f;if(((u=t.Conditions)===null||u===void 0?void 0:u.length)>0)switch(t.filterComapreType){case 1:r=!1;i=[t.Conditions[0].Value];break;case 2:r=!0;i=[t.Conditions[0].Value];break;case 15:r=!1;i=t.Conditions[0].Value.split(",").map(function(n){return n.trim()});break;case 16:r=!0;i=t.Conditions[0].Value.split(",").map(function(n){return n.trim()});break;default:n.leafs.forEach(function(n){return n.isChecked=!1});return}(i===null||i===void 0?void 0:i.length)>0?n.leafs.forEach(function(n){n.isChecked=r!==i.some(function(t){return t===n.userData.DisplayValue})}):(f=this.listview.getListDataCount()>0,n.leafs.forEach(function(n){return n.isChecked=f}))},u.prototype.queryRowsForFieldColumn=function(t,i){var f=this.visibleColumn.getFilterBindingInfo(),e=this.visibleColumn.getFilterDisplayBindingInfo(),r=[f,e].filter(function(t){return!n.Common.IsEmpty(t)}),u=this.listview.getLocationString(),o={columnBindingInfos:r===null||r===void 0?void 0:r.map(function(n){return n.GUID}),rowInfo:this.listview.getRowInfo(),queryData:n.ForguncyData.pageInfo.commandQuerys[this.listview.getDataTableName()],sortCommandID:null,sortInfo:n.ForguncyData.pageInfo.getSortInfoWithBinding(u),columnFilterQueries:n.ColumnFilterHelper.getFieldColumnFilterQueries(u,r),pageName:n.PageManager.getDesignerPageName(this.listview.runTimePageName,!1),runtimeQueryConditionData:n.ForguncyData.pageInfo.runtimeQueryConditionDataCache[u]};n.HomeController.GetRowsDataForColumnFilter(o,function(n){if(!n){i();return}if(n.errorMessage){alert(n.errorMessage);i();return}n.rows&&t(n.rows,n.displayRows)},this.listview.getCalcSheetName())},u.prototype.queryRowsForNoFieldColumn=function(t,i){var r=n.FormulaColumnSortFilterHelper.getFilteredValuesOfColumn(this.listview,this.visibleColumn);r.length>0?t(r,null):i()},u.prototype.generateNormalNodes=function(t,i,r){return t.map(function(t){var u,f;if(n.Common.IsEmpty(t.Value))u=n.RS.ColumnFilter_TreeView_Blanks;else{var o=i.columnInfo.TemplateCell.Element,s=r.runTimePageName,e=n.ListviewEditorHelper.getCell(o,s,r.designerPageName,r.getListviewName()).cellType,h=e?e.getFormatString():"";u=n.FormatHelper.formatValue(t.DisplayValue,h)}return f=new n.UI.TreeViewNode(u),f.userData=t,f})},u.prototype.generateDateNodes=function(t){var i=this,r=[],u=t.some(function(t){var r=t.Value,i;return!n.Common.IsEmpty(r)&&(i=n.ConvertOADateToDate(r),i&&!isNaN(i.getTime())&&(i.getHours()!==0||i.getMinutes()!==0||i.getSeconds()!==0))?!0:!1});return t.forEach(function(t){var o=t.Value,e,f;if(n.Common.IsEmpty(o))f=new n.UI.TreeViewNode(n.RS.ColumnFilter_TreeView_Blanks).identify("fgc-columnfilter-blank-datetime"),f.userData=t,r.push(f);else if(e=n.ConvertOADateToDate(o),e)if(isNaN(e.getTime()))f=new n.UI.TreeViewNode(o),f.userData=t,r.push(f);else{var s=e.getFullYear(),h=e.getMonth(),c=e.getDate(),f=void 0,y=n.RS.MonthNames.split(",");if(f=i.createChild(null,r,s,s+n.RS.ColumnFilter_YearName),f=i.createChild(f,f.children,h,y[h]),f=i.createChild(f,f.children,c,c+n.RS.ColumnFilter_DayName),u){var l=e.getHours(),a=e.getMinutes(),v=e.getSeconds();f=i.createChild(f,f.children,l,l);f=i.createChild(f,f.children,a,":"+a);f=i.createChild(f,f.children,v,":"+v)}f.userData=t}}),r},u.prototype.createChild=function(t,i,r,u){return i[r]||(i[r]=new n.UI.TreeViewNode(u.toString()),i[r].parent=t),i[r]},u}(n.UI.Dialog),t,i;n.BasicFilterDialog=u;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"content",{get:function(){return new i(this.target)},enumerable:!1,configurable:!0}),t}(n.UI.DialogUI);i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createChildren=function(){this.addChild(this.target.treeView.createUI());this.addChild(this.target.textBlock.createUI());this.addChild(this.target.progress.createUI())},t}(n.UI.DialogContentUI)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t,i,s=(t={},Object.defineProperty(t,1,{get:function(){return n.RS.CompareType_Equals},enumerable:!1,configurable:!0}),Object.defineProperty(t,2,{get:function(){return n.RS.CompareType_DoesNotEqual},enumerable:!1,configurable:!0}),Object.defineProperty(t,3,{get:function(){return n.RS.CompareType_BeginsWith},enumerable:!1,configurable:!0}),Object.defineProperty(t,4,{get:function(){return n.RS.CompareType_DoesNotBeginWith},enumerable:!1,configurable:!0}),Object.defineProperty(t,5,{get:function(){return n.RS.CompareType_EndsWith},enumerable:!1,configurable:!0}),Object.defineProperty(t,6,{get:function(){return n.RS.CompareType_DoesNotEndWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t,7,{get:function(){return n.RS.CompareType_Contains},enumerable:!1,configurable:!0}),Object.defineProperty(t,8,{get:function(){return n.RS.CompareType_DoesNotContain},enumerable:!1,configurable:!0}),Object.defineProperty(t,9,{get:function(){return n.RS.CompareType_IsGreaterThan},enumerable:!1,configurable:!0}),Object.defineProperty(t,10,{get:function(){return n.RS.CompareType_IsGreaterThanOrEqualTo},enumerable:!1,configurable:!0}),Object.defineProperty(t,11,{get:function(){return n.RS.CompareType_IsLessThan},enumerable:!1,configurable:!0}),Object.defineProperty(t,12,{get:function(){return n.RS.CompareType_IsLessThanOrEqualTo},enumerable:!1,configurable:!0}),Object.defineProperty(t,13,{get:function(){return n.RS.CompareType_IsBetween},enumerable:!1,configurable:!0}),Object.defineProperty(t,14,{get:function(){return n.RS.CompareType_IsNotBetween},enumerable:!1,configurable:!0}),Object.defineProperty(t,15,{get:function(){return n.RS.CompareType_In},enumerable:!1,configurable:!0}),Object.defineProperty(t,16,{get:function(){return n.RS.CompareType_NotIn},enumerable:!1,configurable:!0}),Object.defineProperty(t,17,{get:function(){return n.RS.CompareType_ListContains},enumerable:!1,configurable:!0}),Object.defineProperty(t,18,{get:function(){return n.RS.CompareType_ListIsContainedBy},enumerable:!1,configurable:!0}),Object.defineProperty(t,19,{get:function(){return n.RS.CompareType_ListIntersects},enumerable:!1,configurable:!0}),Object.defineProperty(t,20,{get:function(){return n.RS.CompareType_ListNoIntersection},enumerable:!1,configurable:!0}),Object.defineProperty(t,21,{get:function(){return n.RS.CompareType_ListEquals},enumerable:!1,configurable:!0}),t),h=(i={},Object.defineProperty(i,1,{get:function(){return n.RS.CompareType_Equals},enumerable:!1,configurable:!0}),Object.defineProperty(i,2,{get:function(){return n.RS.CompareType_DoesNotEqual},enumerable:!1,configurable:!0}),Object.defineProperty(i,3,{get:function(){return n.RS.CompareType_BeginsWith},enumerable:!1,configurable:!0}),Object.defineProperty(i,4,{get:function(){return n.RS.CompareType_DoesNotBeginWith},enumerable:!1,configurable:!0}),Object.defineProperty(i,5,{get:function(){return n.RS.CompareType_EndsWith},enumerable:!1,configurable:!0}),Object.defineProperty(i,6,{get:function(){return n.RS.CompareType_DoesNotEndWidth},enumerable:!1,configurable:!0}),Object.defineProperty(i,7,{get:function(){return n.RS.CompareType_Contains},enumerable:!1,configurable:!0}),Object.defineProperty(i,8,{get:function(){return n.RS.CompareType_DoesNotContain},enumerable:!1,configurable:!0}),Object.defineProperty(i,9,{get:function(){return n.RS.CompareType_IsGreaterThan},enumerable:!1,configurable:!0}),Object.defineProperty(i,10,{get:function(){return n.RS.CompareType_IsGreaterThanOrEqualTo},enumerable:!1,configurable:!0}),Object.defineProperty(i,11,{get:function(){return n.RS.CompareType_IsLessThan},enumerable:!1,configurable:!0}),Object.defineProperty(i,12,{get:function(){return n.RS.CompareType_IsLessThanOrEqualTo},enumerable:!1,configurable:!0}),Object.defineProperty(i,13,{get:function(){return n.RS.CompareType_IsBetween},enumerable:!1,configurable:!0}),Object.defineProperty(i,14,{get:function(){return n.RS.CompareType_IsNotBetween},enumerable:!1,configurable:!0}),Object.defineProperty(i,15,{get:function(){return n.RS.CompareType_In},enumerable:!1,configurable:!0}),Object.defineProperty(i,16,{get:function(){return n.RS.CompareType_NotIn},enumerable:!1,configurable:!0}),Object.defineProperty(i,17,{get:function(){return n.RS.CompareType_ListContains},enumerable:!1,configurable:!0}),Object.defineProperty(i,18,{get:function(){return n.RS.CompareType_ListIsContainedBy},enumerable:!1,configurable:!0}),Object.defineProperty(i,19,{get:function(){return n.RS.CompareType_ListIntersects},enumerable:!1,configurable:!0}),Object.defineProperty(i,20,{get:function(){return n.RS.CompareType_ListNoIntersection},enumerable:!1,configurable:!0}),Object.defineProperty(i,21,{get:function(){return n.RS.CompareType_ListEquals},enumerable:!1,configurable:!0}),i),c=function(){function t(n){this._isFilterCurrentPage=n}return t.prototype.createContextMenu=function(t,i){var o=this,r=t.getColumnFilterHelper(i),f=null,u=[],e;return this.contextMenuCompareTypes.forEach(function(e){e.forEach(function(e){var h=new n.UI.ContextMenuButton(s[e]+"...").on("Clicked",function(){f.dispose();o.openCustomFilterDialog(t,i,e)}),c=r.columnFilterQuery;h.isChecked=!n.Common.IsEmpty(c.Conditions)&&e===c.filterComapreType;u.push(new n.UI.ContextMenuItem(h))});u.push(new n.UI.ContextMenuItem(new n.UI.ContextMenuSpliter))}),e=new n.UI.ContextMenuButton(n.RS.ColumnFilter_ContextMenu_CustomFilter+"...").on("Clicked",function(){f.dispose();var n=r.getActualCompareType(r.columnFilterQuery);o.openCustomFilterDialog(t,i,n)}),e.isChecked=this.getCustomFilterIsChecked(r.columnFilterQuery),u.push(new n.UI.ContextMenuItem(e)),f=new n.UI.ContextMenu(u)},t.prototype.openCustomFilterDialog=function(t,i,e){var c=this,s,l;e===void 0&&(e=this.supportedCompareTypes[0]);var h=t.getColumnFilterHelper(i),o=new u,a=n.ContextMenuBuilder.isFilterCurrentPage(t,i)?n.RS.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage:"";o.title=n.RS.ColumnFilter_ContextMenu_CustomFilter+a;o.targetName=n.Common.getMultiLanguageWord(i.getName())||"";e===null||e===undefined||e===0?o.selectModel=new r(this.supportedCompareTypes[0]):(o.selectModel=new r(e),s=h.columnFilterQuery,l=h.getActualCompareType(s),s.Conditions&&e===l&&(n.Common.IsEmpty(s.Conditions[0])||(o.value1=this.convertConditionToString(s.Conditions[0])),n.Common.IsEmpty(s.Conditions[1])||(o.value2=this.convertConditionToString(s.Conditions[1]))));o.prefabModels=this.supportedCompareTypes.map(function(n){return new r(n)});o.on("Confirm",function(r,u){var f,e;if(t.tryCommitValueBeforeQueryOrSort()){h.clearColumnFilterValues();try{f=c.generate(o.selectModel.type,[o.value1,o.value2])}catch(s){alert(n.RS.ColumnFilter_Alert_IncorrectValue);u.cancel=!0;return}e=o.selectModel.type===14;h.setConditionFilter(o.selectModel.type,e,f);t.resetDataAfterFilter(i)}});this.updateExampleText(o);o.on("PropertyChanged",function(n,t){t==="selectModel"&&c.updateExampleText(o)});n.ForguncyData.pageInfo.appendExtralPopup(o);n.PageBuilder.pagesContainer.append(o.createUI(f).container);o.show()},t.prototype.convertConditionToString=function(t){return t.Value===n.KeyWords.Null?"":t.Value},t.prototype.convertValueToReal=function(t){return t.trim()===""?n.KeyWords.Null:t},t.prototype.getCustomFilterIsChecked=function(t){if(!n.Common.IsEmpty(t.Conditions)){var i=this.contextMenuCompareTypes.reduce(function(n,t){return n.concat(t)});return i.indexOf(t.filterComapreType)<0}return!1},t.prototype.updateExampleText=function(t){var i=this.getExampleText(t.selectModel.type);n.Common.IsEmpty(i)?t.exampleTextBlock.visibility=!1:(t.exampleTextBlock.visibility=!0,t.exampleTextBlock.text=i)},t}(),e,r,u,f,o;n.AdvancedFilter=c;e=function(){function t(){}return t.create=function(t,i){switch(t){case 0:return new n.NumberFilter(i);case 1:return new n.TextFilter(i);case 2:return new n.DateFilter(i);case 3:return new n.TimeFilter(i);case 4:return new n.ListFilter(i);default:return null}},t}();n.AdvancedFilterFactory=e;r=function(){function n(n){this.type=n}return Object.defineProperty(n.prototype,"title",{get:function(){return h[this.type]},enumerable:!1,configurable:!0}),n}();u=function(t){function i(){var i=t.call(this)||this;i.value1="";i.value2="";i.titleTextBlock=new n.UI.TextBlock(i.whereTitle);i.targetNameTextBlock=new n.UI.TextBlock("").identify("fgc-advancedfilter-targetname");i.comboBox=(new n.UI.ComboBox).identify("fgc-advancedfilter-combobox");i.textBox1=(new n.UI.TextBox).identify("fgc-advancedfilter-leftinput");i.textBox2=(new n.UI.TextBox).identify("fgc-advancedfilter-rightinput");i.modeTextBlock=new n.UI.TextBlock(n.RS.ColumnFilter_TextBlock_And);i.exampleTextBlock=(new n.UI.TextBlock).identify("fgc-advancedfilter-example");i.outerFlex=new n.UI.FlexLayout(1).identify("fgc-advancedfilter-outerflex");i.innerFlex1=new n.UI.FlexLayout(0).identify("fgc-advancedfilter-titleflex");i.innerFlex2=new n.UI.FlexLayout(0).identify("fgc-advancedfilter-contentflex");i.id="fgc-advancedfilter-dialog";i.bindProperty(i.targetNameTextBlock,"text","targetName");i.bindProperty(i.comboBox,"value","selectModel");i.bindProperty(i.comboBox,"items","prefabModels");i.bindProperty(i.textBox1,"text","value1");i.bindProperty(i.textBox2,"text","value2");i.on("PropertyChanged",function(t,r){r==="selectModel"&&(i.selectModel.type===13||i.selectModel.type===14?(i.textBox2.show(),i.modeTextBlock.show()):(i.textBox2.hide(),i.modeTextBlock.hide()),n.DelayRefresh.setTimeout(function(){i.textBox1.focus()},50))});i.textBox1.on("Confirm",function(){i.confirm()});i.textBox2.on("Confirm",function(){i.confirm()});return i.comboBox.displayName="title",i.initializeFlexLayout(),i}return __extends(i,t),Object.defineProperty(i.prototype,"whereTitle",{get:function(){return n.RS.ColumnFilter_TextBlock_Where},enumerable:!1,configurable:!0}),i.prototype.initializeFlexLayout=function(){this.outerFlex.add(this.innerFlex1);this.outerFlex.add(this.innerFlex2);this.outerFlex.add(this.exampleTextBlock);this.innerFlex1.add(this.titleTextBlock);this.innerFlex1.add(this.targetNameTextBlock);this.innerFlex2.add(this.comboBox);this.innerFlex2.add(this.textBox1);this.innerFlex2.add(this.modeTextBlock);this.innerFlex2.add(this.textBox2)},i}(n.UI.Dialog);n.AdvancedFilterDialog=u;f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"content",{get:function(){return new o(this.target)},enumerable:!1,configurable:!0}),t}(n.UI.DialogUI);n.AdvancedFilterDialogUI=f;o=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createChildren=function(){this.addChild(this.target.outerFlex.createUI())},t}(n.UI.DialogContentUI)})(Forguncy||(Forguncy={}))
;var __spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var t=function(){function t(){}return t.sortByColumn=function(n){var t=n.getListDataModel().getData(!1),i=this.sortData(n,t);this.resetListviewData(n,i)},t.resetListviewData=function(i,r){var f;i.operationTypeWhenValueChanged=2;try{var u=i.getListDataModel(),e=u.getCurrentRowIndex(),o=u.getData(!1).map(function(n){return n.uniqueIndex});u.select();i.hideDeleteButton();u.setData(r,!0,!0);f=t.adjustRowIndex(e,o,r);i.initSelectionAfterInitData(f===-1?e:f);i.hideDeleteButton();i.trigger(n.ListViewEvents.Reloaded,{})}finally{i.operationTypeWhenValueChanged=0}i.refreshUI()},t.sortData=function(n,t){var u=this,i=this.getSortedFormulaColumnIndex(n),f,r;return i===-1?n.getDataTableName()?t:__spreadArray([],t,!0).sort(function(n,t){return u.compareValue(n.uniqueIndex,t.uniqueIndex,0)}):(f=n.listviewData.visibleColumns[i],r=n.listviewData.getColIndexByVisibleColIndex(i),__spreadArray([],t,!0).sort(function(n,t){return u.compareValueItem(n.data[r],t.data[r],f.sortInfo)}))},t.compareValueItem=function(t,i,r){var u=n.ListDataModel.getValueFromItem(t),f=n.ListDataModel.getValueFromItem(i);return this.compareValue(u,f,r)},t.compareValue=function(n,t,i){if(n===t)return 0;var r=0;return r=n===null?-1:t===null?1:n>t?1:-1,i===1?r*-1:r},t.adjustRowIndex=function(n,t,i){var u=t[n],r;if(u>=0)for(r=0;r<i.length;r++)if(i[r].uniqueIndex===u)return r;return-1},t.getSortedFormulaColumnIndex=function(t){var r=t.listviewData.visibleColumns,i,u;if(!r)return-1;for(i=0;i<r.length;i++)if(u=r[i],u.allowNoFieldSort()&&!n.Common.IsEmpty(u.sortInfo))return i;return-1},t.filterByColumn=function(n){var t=this.getFilteredAndSortData(n);this.resetListviewData(n,t)},t.getFilteredAndSortData=function(n){var t=this.getFilteredData(n);return this.sortData(n,t)},t.getFilteredData=function(t,r){var u,f,e;return(r===void 0&&(r=null),t.dataCache||(t.dataCache=t.getListDataModel().getData(!1)),u=this.getFilterCondition(t,r),!u)?t.dataCache:(f=new i(t.dataCache),e=t.dataCache.filter(function(t,i){return f.rowIndex=i,n.ConditionHelper.getConditionResult(u,null,f)}),e)},t.getFilterCondition=function(t,i){var f=this,r=t.listviewData.visibleColumns,u;return!r||r.length===0?null:(u=r.map(function(r){return n.Common.IsEmpty(i)||r!==i?f.getConditionOfColumn(r,t.getColumnFilterHelper(r).columnFilterQuery):null}).filter(function(n){return!!n}),this.combinConditions(u,0))},t.combinConditions=function(n,t){return n.length===0?null:{SubConditions:n,RelationType:t}},t.getConditionOfColumn=function(n,t){var i;return n.allowNoFieldSort()?t.Conditions?this.convertFilterConditions(n,t,(i=n.columnInfo)===null||i===void 0?void 0:i.HaveFormula):t.Values?this.createConditionByFilterValues(n,t):null:null},t.createConditionByFilterValues=function(n,i){var r=i.Values.map(function(n){return t.convertValueForInCondition(n)});return{colIndex:n.getColumnIndex(),value:r,compareType:i.IsNotInMode?13:12}},t.convertValueForInCondition=function(t){return n.Common.IsEmpty(t)?n.KeyWords.Null:t instanceof Date?t.valueOf():typeof t=="object"?t+"":t},t.convertFilterConditions=function(n,t,i){var r=this,u=n.getColumnIndex(),f=t.IsOrMode?1:0,e=t.Conditions.map(function(n){return r.convertToFilterCondition(n,u,i)});return this.combinConditions(e,f)},t.convertToFilterCondition=function(n,t,i){return{colIndex:t,value:this.convertValue(n.Value,i),compareType:this.convertCompareType(n)}},t.convertValue=function(t,i){return i?n.FormulaHelper.adjustNumberPrecision(t):t},t.convertCompareType=function(n){switch(n.ConditionType){case 0:return this.convertGeneralCompareType(n.CompareType);case 1:return this.convertTextCompareType(n.CompareType)}},t.convertGeneralCompareType=function(n){return n},t.convertTextCompareType=function(n){switch(n){case 0:return 0;case 1:return 1;case 2:return 6;case 3:return 7;case 4:return 8;case 5:return 9;case 6:return 10;case 7:return 11;case 8:return 12;case 9:return 13}},t.getFilteredValuesOfColumn=function(i,r){var u=this.getFilteredData(i,r),f=r.getColumnIndex(),e=u.map(function(t){var i=t.data[f];return n.ListDataModel.getValueFromItem(i)});return this.unique(e).sort(function(n,i){return t.compareValue(n,i,0)}).slice(0,500)},t.unique=function(n){for(var t,r=[],u={},i=0,f=n;i<f.length;i++)t=f[i],u[t]||(u[t]=1,r.push(t));return r},t.updateDataCacheOnValueChanged=function(n,t){if(n.dataCache&&!t.isFilterOrSort)switch(t.actionType){case 0:this.updateDataCacheAfterResetData(n);break;case 4:case 1:this.updateDataCacheAfterAddRows(n,t.cellRange.Row,t.cellRange.RowCount);break;case 2:this.updateDataCacheAfterDeleteRow(n,t.deletedRowUniqueIndex)}},t.updateDataCacheAfterResetData=function(n){n.dataCache=null},t.updateDataCacheAfterAddRows=function(n,t,i){var u=n.getListDataModel().getData(!1),r;if(!n.dataCache.some(function(n){return n.uniqueIndex===u[t].uniqueIndex}))for(r=0;r<i;r++)n.dataCache.push(u[t+r])},t.updateDataCacheAfterDeleteRow=function(t,i){var u,r;if(!n.Common.IsEmpty(i)){for(u=-1,r=0;r<t.dataCache.length;r++)if(t.dataCache[r].uniqueIndex===i){u=r;break}u>=0&&t.dataCache.splice(u,1)}},t}(),i;n.FormulaColumnSortFilterHelper=t;i=function(){function i(n){this._data=n;this.rowIndex=0}return i.prototype.calc=function(i){var u=i,f=this._data[this.rowIndex].data[u.colIndex],r=n.ListDataModel.getValueFromItem(f);return i.value instanceof Array&&(i.compareType===12||i.compareType===13)?t.convertValueForInCondition(r):r},i.prototype.needUnparseValue2=function(){return!1},i.prototype.equals=function(n,t){return n+""==t+""},i}()})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var i=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n.contextMenuCompareTypes=[[1,2],[3,5,],[7,8,]],n.supportedCompareTypes=[1,2,3,4,5,6,7,8,15,16],n}return __extends(i,t),Object.defineProperty(i.prototype,"title",{get:function(){var t=this._isFilterCurrentPage?n.RS.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage:"";return n.RS.ColumnFilter_ContextMenu_TextFilter+t},enumerable:!1,configurable:!0}),i.prototype.getExampleText=function(t){return t===15||t===16?n.RS.ColumnFilter_TextBlock_TextExample_In:""},i.prototype.generate=function(n,t){var i=this.convertValueToReal(t[0]);switch(n){case 1:return[{ConditionType:1,CompareType:0,Value:i}];case 2:return[{ConditionType:1,CompareType:1,Value:i}];case 3:return[{ConditionType:1,CompareType:2,Value:i}];case 4:return[{ConditionType:1,CompareType:3,Value:i}];case 5:return[{ConditionType:1,CompareType:4,Value:i}];case 6:return[{ConditionType:1,CompareType:5,Value:i}];case 7:return[{ConditionType:1,CompareType:6,Value:i}];case 8:return[{ConditionType:1,CompareType:7,Value:i}];case 15:return[{ConditionType:1,CompareType:8,Value:i}];case 16:return[{ConditionType:1,CompareType:9,Value:i}];default:return[]}},i}(n.AdvancedFilter),t;n.TextFilter=i;t=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n.contextMenuCompareTypes=[[17,18],[19,20,],[21,]],n.supportedCompareTypes=[17,18,19,20,21,],n}return __extends(i,t),Object.defineProperty(i.prototype,"title",{get:function(){var t=this._isFilterCurrentPage?n.RS.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage:"";return"集合筛选"+t},enumerable:!1,configurable:!0}),i.prototype.getExampleText=function(){return n.RS.ColumnFilter_TextBlock_TextExample_In},i.prototype.generate=function(n,t){var i=this.convertValueToReal(t[0]);switch(n){case 17:return[{ConditionType:2,CompareType:0,Value:i}];case 18:return[{ConditionType:2,CompareType:1,Value:i}];case 19:return[{ConditionType:2,CompareType:2,Value:i}];case 20:return[{ConditionType:2,CompareType:3,Value:i}];case 21:return[{ConditionType:2,CompareType:4,Value:i}];default:return[]}},i}(n.AdvancedFilter);n.ListFilter=t})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n.contextMenuCompareTypes=[[1,2],[9,11,13]],n.supportedCompareTypes=[1,2,9,10,11,12,13,14,],n}return __extends(i,t),Object.defineProperty(i.prototype,"title",{get:function(){var t=this._isFilterCurrentPage?n.RS.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage:"";return n.RS.ColumnFilter_ContextMenu_NumberFilter+t},enumerable:!1,configurable:!0}),i.prototype.getExampleText=function(){return""},i.prototype.generate=function(n,t){var i=this.convertValueToReal(t[0]),r;switch(n){case 1:return[{ConditionType:0,CompareType:0,Value:i}];case 2:return[{ConditionType:0,CompareType:1,Value:i}];case 9:return[{ConditionType:0,CompareType:2,Value:i}];case 10:return[{ConditionType:0,CompareType:3,Value:i}];case 11:return[{ConditionType:0,CompareType:4,Value:i}];case 12:return[{ConditionType:0,CompareType:5,Value:i}];case 13:return r=this.convertValueToReal(t[1]),[{ConditionType:0,CompareType:3,Value:i},{ConditionType:0,CompareType:5,Value:r}];case 14:return r=this.convertValueToReal(t[1]),[{ConditionType:0,CompareType:4,Value:i},{ConditionType:0,CompareType:2,Value:r}];default:return[]}},i.prototype.convertValueToReal=function(t){if(typeof t=="number")return t;if(typeof t=="string"&&t.trim()==="")return n.KeyWords.Null;var i=Number(t);if(isNaN(i))throw new Error;else return i},i}(n.AdvancedFilter);n.NumberFilter=t})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.getExampleText=function(t){return t===13||t===14?n.RS.ColumnFilter_TextBlock_TimeExample_Between:n.RS.ColumnFilter_TextBlock_TimeExample},i.prototype.convertValueToReal=function(t){var i,r;if(typeof t=="number")return t;if(t.trim()==="")return n.KeyWords.Null;if(i=n.FormatHelper.getValueFromText(t),i instanceof Date)return n.ConvertDateToOADate(i);if(r=Number(i),isNaN(r))throw new Error;else return r},i.prototype.convertConditionToString=function(t){return t.Value===n.KeyWords.Null?"":n.FormatHelper.formatValue(t.Value,"hh:mm:ss")},i}(n.NumberFilter);n.TimeFilter=t})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var t,i,u=(t={},Object.defineProperty(t,100,{get:function(){return n.RS.DateCompareType_Tomorrow},enumerable:!1,configurable:!0}),Object.defineProperty(t,101,{get:function(){return n.RS.DateCompareType_Today},enumerable:!1,configurable:!0}),Object.defineProperty(t,102,{get:function(){return n.RS.DateCompareType_Yesterday},enumerable:!1,configurable:!0}),Object.defineProperty(t,103,{get:function(){return n.RS.DateCompareType_NextWeek},enumerable:!1,configurable:!0}),Object.defineProperty(t,104,{get:function(){return n.RS.DateCompareType_ThisWeek},enumerable:!1,configurable:!0}),Object.defineProperty(t,105,{get:function(){return n.RS.DateCompareType_LastWeek},enumerable:!1,configurable:!0}),Object.defineProperty(t,106,{get:function(){return n.RS.DateCompareType_NextMonth},enumerable:!1,configurable:!0}),Object.defineProperty(t,107,{get:function(){return n.RS.DateCompareType_ThisMonth},enumerable:!1,configurable:!0}),Object.defineProperty(t,108,{get:function(){return n.RS.DateCompareType_LastMonth},enumerable:!1,configurable:!0}),Object.defineProperty(t,109,{get:function(){return n.RS.DateCompareType_NextYear},enumerable:!1,configurable:!0}),Object.defineProperty(t,110,{get:function(){return n.RS.DateCompareType_ThisYear},enumerable:!1,configurable:!0}),Object.defineProperty(t,111,{get:function(){return n.RS.DateCompareType_LastYear},enumerable:!1,configurable:!0}),t),r=(i={},Object.defineProperty(i,11,{get:function(){return n.RS.CompareType_IsLessThan_Date},enumerable:!1,configurable:!0}),Object.defineProperty(i,9,{get:function(){return n.RS.CompareType_IsGreaterThan_Date},enumerable:!1,configurable:!0}),i),f=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n.contextMenuCompareTypes=[[1,],[11,9,13]],n.contextMenuDateCompareTypes=[[100,101,102,],[103,104,105,],[106,107,108,],[109,110,111]],n}return __extends(i,t),Object.defineProperty(i.prototype,"title",{get:function(){var t=this._isFilterCurrentPage?n.RS.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage:"";return n.RS.ColumnFilter_ContextMenu_DateFilter+t},enumerable:!1,configurable:!0}),i.prototype.getExampleText=function(t){return t===13||t===14?n.RS.ColumnFilter_TextBlock_DateExample_Between:n.RS.ColumnFilter_TextBlock_DateExample},i.prototype.createContextMenu=function(i,f){var s=this,e=t.prototype.createContextMenu.call(this,i,f),o=[];return o.push(new n.UI.ContextMenuItem(new n.UI.ContextMenuSpliter)),this.contextMenuDateCompareTypes.forEach(function(t){t.forEach(function(t){var r=new n.UI.ContextMenuButton(u[t]).on("Clicked",function(){var n,r;e.dispose();n=i.getColumnFilterHelper(f);n.clearColumnFilterValues();r=s.generateByDateCompareType(t);n.setConditionFilter(t,!1,r);i.resetDataAfterFilter(f)}),h=i.getColumnFilterHelper(f).columnFilterQuery;r.isChecked=!n.Common.IsEmpty(h.Conditions)&&t===h.filterComapreType;o.push(new n.UI.ContextMenuItem(r))});o.push(new n.UI.ContextMenuItem(new n.UI.ContextMenuSpliter))}),e.items[2].inner.text=r[11]+"...",e.items[3].inner.text=r[9]+"...",e.items=__spreadArray(__spreadArray(__spreadArray([],e.items.slice(0,e.items.length-2),!0),o,!0),e.items.slice(-1),!0),e},i.prototype.convertValueToReal=function(t){var i,r;if(typeof t=="number")return t;if(t.trim()==="")return n.KeyWords.Null;if(i=n.FormatHelper.getValueFromText(t),i instanceof Date)return n.ConvertDateToOADate(i);if(r=Number(i),isNaN(r))throw new Error;else return r},i.prototype.convertConditionToString=function(t){return t.Value===n.KeyWords.Null?"":n.FormatHelper.getTextFromValue(n.ConvertOADateToDate(t.Value))},i.prototype.getCustomFilterIsChecked=function(t){if(!n.Common.IsEmpty(t.Conditions)){var i=this.contextMenuCompareTypes.reduce(function(n,t){return n.concat(t)}),r=this.contextMenuDateCompareTypes.reduce(function(n,t){return n.concat(t)});return i.indexOf(t.filterComapreType)<0&&r.indexOf(t.filterComapreType)<0}return!1},i.prototype.generateByDateCompareType=function(t){var i=new Date,r,u,f,e;switch(t){case 100:r=new Date(i.getFullYear(),i.getMonth(),i.getDate()+1);u=new Date(i.getFullYear(),i.getMonth(),i.getDate()+2);break;case 101:r=new Date(i.getFullYear(),i.getMonth(),i.getDate());u=new Date(i.getFullYear(),i.getMonth(),i.getDate()+1);break;case 102:r=new Date(i.getFullYear(),i.getMonth(),i.getDate()-1);u=new Date(i.getFullYear(),i.getMonth(),i.getDate());break;case 103:r=new Date(i.getFullYear(),i.getMonth(),i.getDate()+(7-i.getDay()));u=new Date(i.getFullYear(),i.getMonth(),i.getDate()+(7-i.getDay())+7);break;case 104:r=new Date(i.getFullYear(),i.getMonth(),i.getDate()-i.getDay());u=new Date(i.getFullYear(),i.getMonth(),i.getDate()+(7-i.getDay()));break;case 105:r=new Date(i.getFullYear(),i.getMonth(),i.getDate()-i.getDay()-7);u=new Date(i.getFullYear(),i.getMonth(),i.getDate()-i.getDay());break;case 106:r=new Date(i.getFullYear(),i.getMonth()+1);u=new Date(i.getFullYear(),i.getMonth()+2);break;case 107:r=new Date(i.getFullYear(),i.getMonth());u=new Date(i.getFullYear(),i.getMonth()+1);break;case 108:r=new Date(i.getFullYear(),i.getMonth()-1);u=new Date(i.getFullYear(),i.getMonth());break;case 109:r=new Date(i.getFullYear()+1,0);u=new Date(i.getFullYear()+2,0);break;case 110:r=new Date(i.getFullYear(),0);u=new Date(i.getFullYear()+1,0);break;case 111:r=new Date(i.getFullYear()-1,0);u=new Date(i.getFullYear(),0);break;default:return null}return f=n.ConvertDateToOADate(r),e=n.ConvertDateToOADate(u),[{ConditionType:0,CompareType:3,Value:f},{ConditionType:0,CompareType:4,Value:e}]},i}(n.NumberFilter);n.DateFilter=f})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function r(r){var u=t.call(this)||this,f;return u.defaultUI=i,u.id="fgc-rowheader-contextmenu",u.insertButton=(new n.UI.ContextMenuButton).identify("fgc-rowheader-insert"),u.deleteButton=(new n.UI.ContextMenuButton).identify("fgc-rowheader-delete"),u.duplicateButton=(new n.UI.ContextMenuButton).identify("fgc-rowheader-duplicate"),f=r.listviewData.getRowHeaderContextMenuData(),f.ContextMenuItems.forEach(function(t){if(t===null||t===void 0?void 0:t.Visible)if(t.OperationType===n.ContextMenuOperationType.Insert){u.insertButton.text=n.RS.Listview_RowHeaderContextMenu_Insert;u.insertButton.enabled=r.allowInsertRow();u.insertButton.on("Clicked",function(){r.insertRowBySelection(!0);u.dispose()});u.items.push(new n.UI.ContextMenuItem(u.insertButton))}else if(t.OperationType===n.ContextMenuOperationType.Delete){r.listviewData.metadata.forceDisableDeleteMenuItem&&(u.deleteButton.enabled=!1);u.deleteButton.text=n.RS.Listview_RowHeaderContextMenu_Delete;u.deleteButton.on("Clicked",function(){r.deleteOnUIClick(!0);u.dispose()});u.items.push(new n.UI.ContextMenuItem(u.deleteButton))}else if(t.OperationType===n.ContextMenuOperationType.Duplicate){u.duplicateButton.text=n.RS.Listview_RowHeaderContextMenu_Duplicate;u.duplicateButton.enabled=r.allowDuplicateRow();u.duplicateButton.on("Clicked",function(){r.duplicateRowBySelection(!0);u.dispose()});u.items.push(new n.UI.ContextMenuItem(u.duplicateButton))}}),u}return __extends(r,t),r}(n.UI.ContextMenu),i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.shouldDisposeOnEsc=function(){return!0},t}(n.UI.ContextMenuUI),r=function(i){function r(n,t){var r=i.call(this)||this;r.listview=n;r.canvas=t;$(t).on("contextmenu",function(n){n.preventDefault()});return r}return __extends(r,i),r.prototype.onOpenMenu=function(i,r,u){var f,e;if(u.worksheetHitInfo.hitTestType===GC.Spread.Sheets.SheetArea.rowHeader){if(!this.listview.tryCommitEdit())return!0;if(this.listview.allowShowTotalRow())if(this.listview.listviewData.getIsTotalRowAtFirstRow()){if(u.worksheetHitInfo.row===0)return!0}else if(u.worksheetHitInfo.row===this.listview.getSheet().getRowCount()-1)return!0;f=new t(this.listview);n.ForguncyData.pageInfo.appendExtralPopup(f);n.PageBuilder.pagesContainer.append(f.createUI().container);e=$(this.canvas).offset();f.location=new n.Numerics.Vector2(e.left+u.x||0,e.top+u.y||0);f.show()}return!0},r}(GC.Spread.Sheets.ContextMenu.ContextMenu);n.SpreadContextMenu=r})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t;(function(t){var i=function(){function t(){}return t.autoMerge=function(i,r,u,f,e,o){var c,v,l,a,s,y,h;if(u===void 0&&(u=-1),f===void 0&&(f=-1),e===void 0&&(e=0),o===void 0&&(o=-1),!n.Common.IsEmpty(r)&&!(r.length<=0))for(c=t.getOriginalSpanInfos(i,r,u,f,e,o),t.clearOldSpans(i,c,u,f),v=i.getColumnCount(),l=[],s=0;s<v;s++)if(a=n.Common.IsEmpty(c[s])?l:[c[s]],l=[],r.indexOf(s)!==-1)for(y=a.length,h=0;h<y;h++)t.setSpan(i,a[h].row,s,a[h].span,l)},t.getOriginalSpanInfos=function(n,i,r,u,f,e){var l,c,o,s,h;for(f===void 0&&(f=0),e===void 0&&(e=-1),l=n.getColumnCount(),c=[],o=0;o<l;o++)t.isMergeAreaFirstColumn(i,o)&&(s=void 0,h=void 0,s=r===-1?f:t.getMergeAreaStartRow(n,r,o,f),h=u===-1?n.getRowCount():u+(r-s),e!==-1&&(h=Math.min(e,n.getRowCount())),c[o]={row:s,span:h});return c},t.isMergeAreaFirstColumn=function(n,t){return n.indexOf(t)!==-1&&n.indexOf(t-1)===-1},t.getMergeAreaStartRow=function(n,i,r,u){var e,f;for(u===void 0&&(u=0),e=n.getValue(i,r),f=i-1;f>=u;f--)if(!t.shouldAutoMerge(e,n.getValue(f,r)))return f+1;return u},t.clearOldSpans=function(n,i,r,u){var e=t.getOldSpans(n,i,r,u),f;if(e)for(f=0;f<e.length;f++)n.removeSpan(e[f].row,e[f].col)},t.getOldSpans=function(n,i,r,u){var f,o,e;if(r===-1||u===-1)return n.getSpans(new GC.Spread.Sheets.Range(-1,-1,-1,-1));for(f=[],o=t.getCrossArea(n,i,r,u),e=0;e<o.length;e++)f=f.concat(n.getSpans(o[e]));return f},t.getCrossArea=function(t,i,r){for(var f,e,c,o,s=[],h=t.getColumnCount(),u=0;u<h;u++)if(!n.Common.IsEmpty(i[u])&&(f=i[u].row,e=r-f,!(e<=0))){for(c=u,o=1,u++;u<h;u++)if(n.Common.IsEmpty(i[u]))o++;else{u--;break}s.push(new GC.Spread.Sheets.Range(f,c,e,o))}return s},t.setSpan=function(n,i,r,u,f){for(var s,c,e,h,o=i;o<i+u;)for(s=o,c=n.getValue(s,r),e=o+1;;e++)if(e===i+u||!t.shouldAutoMerge(c,n.getValue(e,r))){h=e-s;h>1&&(n.addSpan(s,r,h,1),f.push({row:s,span:h}));o=e;break}},t.shouldAutoMerge=function(t,i){return n.Common.IsEmpty(t)&&n.Common.IsEmpty(i)?!1:(t instanceof Date&&i instanceof Date&&(t=n.Convertor.fromDateToOADate(t),i=n.Convertor.fromDateToOADate(i)),t===i)},t}();t.AutoMergeHelper=i})(t=n.ListViewHelper||(n.ListViewHelper={}))})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t;(function(n){var t=function(){function n(n){var t;this._scrollSpeedIntervals=(t={},t[0]=150,t[1]=100,t[2]=50,t);this._rearchBottomCount=0;this.listview=n}return Object.defineProperty(n.prototype,"sheet",{get:function(){return this.listview.getSheet()},enumerable:!1,configurable:!0}),n.prototype.apply=function(){var n=this,i,t,r;this.listview.listviewData.getIsAutoScroll()&&(i=this.listview.listviewData.getAutoScrollSpeed(),t=this._scrollSpeedIntervals[i],t>0&&(r=setInterval(function(){n.listview.hasDestroyed()?clearInterval(r):n.listview.isInCurrentPage()&&!n.listview.isMouseInListView()&&n._scrollListView()},t),this.listview.forceHideVerticalScrollBar=!0))},n.prototype._scrollListView=function(){var r,n,t,i;if(this._rearchBottomCount<0){this._rearchBottomCount++;return}if(this.listview.getSpread().options.scrollByPixel=!0,r=this.listview.getListDataCount(),r>0)if(n=this.sheet.getViewportBottomRow(1),n>=this.listview.lastDataRowIndexInView-1)try{t=this.sheet.getCellRect(n,this.sheet.getViewportLeftColumn(1));this.sheet.scroll(1,0);i=this.sheet.getCellRect(n,this.sheet.getViewportLeftColumn(1));t.y===i.y&&t.height===i.height&&(this._rearchBottomCount<10?this._rearchBottomCount++:(this._rearchBottomCount=-5,this.sheet.showRow(this.listview.firstDataRowIndexInView,GC.Spread.Sheets.VerticalPosition.top),this.sheet.scroll(-1e5,0)))}catch(u){}else this.sheet.scroll(1,0),window.devicePixelRatio%1!=0&&this.sheet.repaint()},n}();n.AutoScrollHelper=t})(t=n.ListViewHelper||(n.ListViewHelper={}))})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t;(function(n){var t=function(){function n(){}return n.isSelectAllRows=function(n){var i=n.getSelections(),e=[],t,r,u;if(i.length!==0&&n.getRowCount()!==0){for(t=0;t<i.length;t++){var f=i[t].row,o=i[t].rowCount,s=i[t].col,h=i[t].colCount;if(s===-1||h===-1){if(f===-1||o===-1)return!0;for(r=f;r<f+o;r++)e[r]=!0}}for(u=0;u<n.getRowCount();u++)if(!e[u])return!1;return!0}return!1},n.isRowSelected=function(n,t){var r=n.getSelections(),i;if(r.length!==0&&n.getRowCount()!==0)for(i=0;i<r.length;i++){var u=r[i].row,f=r[i].rowCount,e=r[i].col,o=r[i].colCount;if((e===-1||o===-1)&&(u===-1||f===-1||t>=u&&t<u+f))return!0}return!1},n.existingRowSelected=function(n){var i=n.getSelections(),t,r,u;if(i.length!==0&&n.getRowCount()!==0)for(t=0;t<i.length;t++)if(r=i[t].col,u=i[t].colCount,r===-1||u===-1)return!0;return!1},n.getOldSelection=function(n){for(var h,c,e,u,o,f,i=n.getSelections(),r=[],s=n.getRowCount(),t=0;t<i.length;t++)if(h=i[t].col,c=i[t].colCount,h===-1||c===-1){if(i[t].row===-1){for(e=0;e<s;e++)jQuery.inArray(e,r)===-1&&r.push(e);break}if(u=i[t].row,o=i[t].row+i[t].rowCount-1,u===o)jQuery.inArray(u,r)===-1&&u<s&&r.push(u);else if(u<o)for(f=u;f<=o;f++)jQuery.inArray(f,r)===-1&&f<s&&r.push(f)}return r},n.mergeSelection=function(n,t,i){var r={},u,f,e,o;if(i&&n.indexOf(t)===-1?n.push(t):i||n.indexOf(t)===-1||n.splice(n.indexOf(t),1),n.length===0)return r;if(n.length===1)return r[n[0]]=1,r;for(n.sort(function(n,t){return n-t}),u=n[0],f=n[0],e=0;e<n.length;e++)e!==0&&(o=n[e],o===f+1?(++f,e===n.length-1&&(r[u]=f-u+1)):o>f+1&&(r[u]=f-u+1,u=o,f=o,e===n.length-1&&(r[u]=1)));return r},n.clearSelectedRow=function(t,i){var r=t.getSheet(),e,f,o,u;if(n.isRowSelected(r,i)){if(e=n.getOldSelection(r),r.suspendPaint(),r.clearSelection(),e.length===1)r.setActiveCell(i,r.getActiveColumnIndex()),t.clearSelectionIfDisableAutoSelectRow();else{f=n.mergeSelection(e,i,!1);o=n.existingRowSelected(r);for(u in f)o?r.addSelection(Number(u),-1,f[u],-1):(r.setSelection(Number(u),-1,f[u],-1),o=!0)}r.resumePaint()}},n.addRowSelection=function(t,i){var r=t.getSheet(),e=n.getOldSelection(r),u,f;r.suspendPaint();r.clearSelection();u=[];r.selectionPolicy()===GC.Spread.Sheets.SelectionPolicy.single?u[i]=1:u=n.mergeSelection(e,i,!0);for(f in u)n.existingRowSelected(r)?r.addSelection(Number(f),-1,u[f],-1):r.setSelection(Number(f),-1,u[f],-1);r.resumePaint()},n.addSelectedRow=function(t,i){var r=t.getSheet();n.isRowSelected(r,i)||(r.suspendPaint(),n.existingRowSelected(r)?n.addRowSelection(t,i):r.setSelection(i,-1,1,-1),r.resumePaint())},n.setSelectedRows=function(t,i){var r=t.getSheet();r.suspendPaint();i&&i.length!==0?i.forEach(function(n,t){t===0?r.setSelection(n,-1,1,-1):r.addSelection(n,-1,1,-1)}):n.clearAllSelectedRows(t);r.resumePaint()},n.selectAllRows=function(n){var t=n.getSheet();t.selectionPolicy()!==GC.Spread.Sheets.SelectionPolicy.single&&(t.clearSelection(),t.addSelection(-1,-1,t.getRowCount(GC.Spread.Sheets.SheetArea.viewport),t.getColumnCount(GC.Spread.Sheets.SheetArea.viewport)))},n.clearAllSelectedRows=function(n){var t=n.getSheet();t.clearSelection();t.setActiveCell(0,0);n.clearSelectionIfDisableAutoSelectRow()},n}();n.SelectionHelper=t})(t=n.ListViewHelper||(n.ListViewHelper={}))})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t;(function(t){var i=function(){function t(){}return t.generateStyleObject=function(i){var r=new GC.Spread.Sheets.Style,u,f,e,o,s,h,c;return i?(u=n.ColorHelper.Convert(i.Background),u!==undefined&&(r.backColor=u),f=n.ColorHelper.Convert(i.Foreground),f!==undefined&&(r.foreColor=f),r.hAlign=t.convertHorizontalAlignment(i.HorizontalAlignment),r.vAlign=i.VerticalAlignment,e=t.generateFontText(i),e&&(r.font=e),r.textDecoration=t.generateTextDecorationType(i),r.textIndent=t.generateTextIndent(i.TextIndent),i.WordWrap!==undefined&&(r.wordWrap=i.WordWrap),i.ShrinkToFit!==undefined&&(r.shrinkToFit=i.ShrinkToFit),i.Formatter!==undefined&&(r.formatter=i.Formatter),o=t.generateLineBorderObject(i.BorderBottom),o!==undefined&&(r.borderBottom=o),s=t.generateLineBorderObject(i.BorderRight),s!==undefined&&(r.borderRight=s),h=t.generateLineBorderObject(i.BorderLeft),h!==undefined&&(r.borderLeft=h),c=t.generateLineBorderObject(i.BorderTop),c!==undefined&&(r.borderTop=c),r):r},t.convertHorizontalAlignment=function(t){switch(t){case n.CellHorizontalAlignment.Left:return GC.Spread.Sheets.HorizontalAlign.left;case n.CellHorizontalAlignment.Center:return GC.Spread.Sheets.HorizontalAlign.center;case n.CellHorizontalAlignment.Right:return GC.Spread.Sheets.HorizontalAlign.right;case n.CellHorizontalAlignment.General:return GC.Spread.Sheets.HorizontalAlign.general;case n.CellHorizontalAlignment.Distributed:return GC.Spread.Sheets.HorizontalAlign.distributed}},t.generateFontText=function(t){var i=[];return t.FontStyle!==undefined&&i.push(n.DomUtilities.getFontStyleText(t.FontStyle)),t.FontWeight!==undefined&&i.push(n.DomUtilities.getFontWeightText(t.FontWeight)),t.FontSize>0&&i.push(t.FontSize+"px"),t.FontFamily?i.push('"'+t.FontFamily+'"'):i.push('"'+n.LocaleFonts.default+'"'),i.length>0?i.join(" "):null},t.generateTextIndent=function(n){return n>0?n/this.textIndentToPixel:this.defaultTextIndent},t.generateTextDecorationType=function(n){var t=GC.Spread.Sheets.TextDecorationType.none;return n.Strikethrough&&(t|=GC.Spread.Sheets.TextDecorationType.lineThrough),n.Underline&&(t|=GC.Spread.Sheets.TextDecorationType.underline),t},t.generateLineBorderObject=function(t){return n.Common.IsEmpty(t)?undefined:new GC.Spread.Sheets.LineBorder(n.ColorHelper.Convert(t.Color),t.Style)},t.needShowScrollbar=function(n,i,r){var e,o,u=!t.canDisplayAllColumnsInViewport(n,i),f=!t.canDisplayAllRowsInViewport(n,r),s=((o=(e=n.getParent())===null||e===void 0?void 0:e.options)===null||o===void 0?void 0:o.scrollbarAppearance)===GC.Spread.Sheets.ScrollbarAppearance.mobile,h,c;return u&&!f?(h=s?0:t.hScrollbarHeight,f=!t.canDisplayAllRowsInViewport(n,r-h)):f&&!u&&(c=s?0:t.vScrollbarWidth,u=!t.canDisplayAllColumnsInViewport(n,i-c)),{showHScrollBar:u,showVScrollbar:f}},t.canDisplayAllRowsInViewport=function(n,t){for(var r=n.getRowCount(),i=0;i<r;i++)if(t-=n.getRowHeight(i),t<0)return!1;return!0},t.canDisplayAllColumnsInViewport=function(n,t){for(var r=n.getColumnCount(),i=0;i<r;i++)if(t-=n.getColumnWidth(i),t<0)return!1;return!0},t.vScrollbarWidth=22,t.hScrollbarHeight=28,t.defaultTextIndent=.125,t.textIndentToPixel=8,t}();t.SpreadJSStyleHelper=i})(t=n.ListViewHelper||(n.ListViewHelper={}))})(Forguncy||(Forguncy={}))
;var __awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},Forguncy;(function(n){var t;(function(t){var i=function(){function n(n,t,i,r){this.oldRowCount=n;this.oldSelections=t;this.oldActiveRowIndex=i;this.oldActiveColIndex=r;this.changedCells=[];this.handled=!1;this.needParseValue=!1;this._changedCellsCount=0}return n.prototype.addChangedCell=function(n,t,i){if(this.changedCells[t]){for(var r=0;r<this.changedCells[t].length;r++)if(this.changedCells[t][r].row===n)return}else this.changedCells[t]=[];this._changedCellsCount++;this.changedCells[t].push({row:n,value:i})},n.prototype.getChangedCellCount=function(){return this._changedCellsCount},n}(),r=function(){function t(n){this._needWait=!1;this._completeAfterWait=!1;this._needResetColumns=!1;this._isSuspend=!1;this.listview=n}return Object.defineProperty(t.prototype,"_sheet",{get:function(){return this.listview.getSheet()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_listData",{get:function(){return this.listview.getListDataModel()},enumerable:!1,configurable:!0}),t.prototype.getData=function(n){for(var i,t,o,r=[],u=[],f=0,e=n.changedCells;f<e.length;f++)i=e[f],t=u.indexOf(i.row),t===-1&&(t=u.length,u.push(t),r[t]=[]),o=this.listview.listviewData.visibleColumns[i.col].getColumnIndex(),r[t][o]=n.sheet.getValue(i.row,i.col);return r},t.prototype.onRangeChanged=function(t){var i=this,r,u;t.changedCells&&t.changedCells.length!==0&&(r=function(){i.listview.operationTypeWhenValueChanged=1;try{n.ForguncyData.pageInfo.formulaManager.suspend();i.listview.getSheet().suspendPaint();for(var r=0;r<t.changedCells.length;r++)i.listview.onValueChanged(t.changedCells[r].row,t.changedCells[r].col)}finally{n.ForguncyData.pageInfo.formulaManager.resume(!0);i.listview.getSheet().resumePaint()}if(i.listview.operationTypeWhenValueChanged=0,t.action===GC.Spread.Sheets.RangeChangedAction.dragFill)i.onRangeChangeOperationCompleted(!1)},this.rangeChangedInfo.needParseValue?(u=this.getData(t),this._needWait=!0,this.listview.cacheComboboxForValidateText(u,function(){if(i._needWait=!1,r(),i._completeAfterWait)i.onRangeChangeOperationCompleted(i._needResetColumns)})):r())},Object.defineProperty(t.prototype,"isSuspend",{get:function(){return this._isSuspend},enumerable:!1,configurable:!0}),t.prototype.suspend=function(){this._isSuspend=!0;this.listview.showLoadingIndicator(!1)},t.prototype.resume=function(){this._isSuspend&&(this._isSuspend=!1,this.listview.hiddenLoadingIndicator())},t.prototype.clearRangeChangedInfo=function(){this.isSuspend||(this.resumeCalc(),this.rangeChangedInfo=null)},t.prototype.resumeCalc=function(){var t;((t=this.rangeChangedInfo)===null||t===void 0?void 0:t.suspendCalc)&&(this.rangeChangedInfo.suspendCalc=!1,n.ForguncyData.pageInfo.formulaManager.resume(!0))},t.prototype.onRangeChangeOperationBegin=function(t,r){r===void 0&&(r=!1);this.rangeChangedInfo=new i(this._listData.getRowCount(),this._sheet.getSelections(),this._sheet.getActiveRowIndex(),this._sheet.getActiveColumnIndex());this.rangeChangedInfo.needParseValue=t===GC.Spread.Sheets.RangeChangedAction.paste?!this.isPasteInternal:!1;r&&(this.rangeChangedInfo.suspendCalc=!0,n.ForguncyData.pageInfo.formulaManager.suspend())},t.prototype.onRangeChangeOperationCompleted=function(n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.suspend(),[4,this.onRangeChangeOperationCompletedAsync(n)];case 1:return t.sent(),this.resume(),[2]}})})},t.prototype.onRangeChangeOperationCompletedAsync=function(t){return __awaiter(this,void 0,void 0,function(){var i,r,u,f;return __generator(this,function(e){switch(e.label){case 0:if(this._needWait)return this._completeAfterWait=!0,this._needResetColumns=t,[2];if(this._completeAfterWait=!1,t&&this.restoreColumnsOnRangeChangeOperationCompleted(),!this.rangeChangedInfo||this.rangeChangedInfo.handled||this.rangeChangedInfo.getChangedCellCount()===0){this.rollBackRangeChange();this.listview.setDataToSpreadJSNow();this.listview.onCurrentRowChanged(this.listview.getMappedEditorSelectedRowIndex());return this.rangeChangedInfo.handled=!0,[2]}return this.resumeCalc(),[4,this.cacheComboboxText()];case 1:return e.sent(),this.rangeChangedInfo.handled=!0,this.listview.setDataToSpreadJSNow(),[4,this.validateRangeChangedCells()];case 2:return(i=e.sent(),u=this.isRangeChangedInCurrentRow(),u||i.status!==0||(r=this.listview.buildDetailListviewValues(!1),r&&(f=n.UpdateDataTableCommand.checkCalcErrorValue(null,null,[r]),n.Common.IsEmpty(f)||(i={status:1,message:f}))),!(i.status===1&&this.listview.GetDataValidationTime()===0))?[3,4]:[4,this.showErrorMessageAndRollBackRangeChange(i.message)];case 3:return e.sent(),[2];case 4:return(this.listview.triggerAPIValueChangedEvent(this._getRangeChangedCellRanges(),this._listData.getRowCount(),this.rangeChangedInfo.oldRowCount),u)?[2]:(this.clearRangeChangedInfo(),this.listview.GetDataCommitMode()!==0)?(this.listview.onSelectionChanged(),[2]):(r&&this.updateOnRangeChanged(r),this.listview.onSelectionChanged(),[2])}})})},t.prototype.cacheComboboxText=function(){return __awaiter(this,void 0,void 0,function(){var n=this;return __generator(this,function(){return[2,new Promise(function(t){n.listview.cacheComboboxText(function(){t()})})]})})},t.prototype._getRangeChangedCellRanges=function(){var t=this,n=[];return this.rangeChangedInfo.changedCells.forEach(function(i,r){i.forEach(function(i){n.push({Row:i.row,Column:t.listview.listviewData.getColIndexByVisibleColIndex(r),RowCount:1,ColumnCount:1})})}),n},t.prototype.restoreColumnsOnRangeChangeOperationCompleted=function(){for(var t=this._sheet.getColumnCount(),i=[],n=0;n<t;n++)i[n]=this._sheet.getColumnWidth(n);for(this.listview.initColumnsBindingInfo(),this.listview.resetColumnHeaderText(),n=0;n<t;n++)this._sheet.setColumnWidth(n,i[n]);this.listview.onColumnWidthOrColumnCountChanged()},t.prototype.isRangeChangedInCurrentRow=function(){for(var n,t,r=this.rangeChangedInfo.changedCells,i=0;i<r.length;i++)if(n=r[i],n)for(t=0;t<n.length;t++)if(n[t].row!==this.rangeChangedInfo.oldActiveRowIndex)return!1;return!0},t.prototype.getEditRowsInRangeChange=function(n){return n.EditValues?n.EditValues.map(function(n){return{rowIndex:n.rowIndex,updateType:"edit",query:n.query,values:n.values}}):[]},t.prototype.getAddRowsInRangeChange=function(n){return n.AddValues?n.AddValues.map(function(n){return{rowIndex:n.rowIndex,updateType:"add",query:null,values:n.values}}):[]},t.prototype.updateOnRangeChanged=function(t){var f=this,r=this.getEditRowsInRangeChange(t),u=this.getAddRowsInRangeChange(t),e=r.concat(u),i;e.some(function(n){return!f.listview.commitChangeRealTime(n.rowIndex,n.updateType)})||(e.forEach(function(n){return f.listview.pushToCommitingRow(n.rowIndex)}),this.listview.showLoadingIndicator(),i=this,this.listview.updateMultiRows(t,function(t){var o,s,e,f;if(!i.listview.hasDestroyed()){if(t.ReloadData){i.listview.fillData();return}i._sheet.suspendPaint();((o=t.UpdatedRowResults)===null||o===void 0?void 0:o.length)?(s=t.UpdatedRowResults,e=[],i.updateQueryIfPrimaryKeyChanged(r),s.forEach(function(t){for(var f=!0,u=0;u<r.length;u++)if(t.JustInsertedRowInfo&&n.Common.isQueryEqual(r[u].query,t.JustInsertedRowInfo.query)){f=!1;i.listview.handleAfterUpdateDataChange(r[u].rowIndex,r[u].updateType,t);break}f&&e.push(t)}),e.length===u.length&&e.forEach(function(n,t){return i.listview.handleAfterUpdateDataChange(u[t].rowIndex,u[t].updateType,n)})):(f=t,f.Message&&alert(f.Message),f.Success=!1,f.Message=null,f.ConcurrentError=!1,u.sort(function(n,t){return t.rowIndex-n.rowIndex}),r.concat(u).forEach(function(n){return i.listview.handleAfterUpdateDataChange(n.rowIndex,n.updateType,f)}));i._sheet.resumePaint();i.listview.refreshOtherListViewsBindingToSameTable();i.listview.hiddenLoadingIndicator()}},function(){alert(n.RS.Commit_FailMessage)}))},t.prototype.updateQueryIfPrimaryKeyChanged=function(n){var i,r,e,u,f,o,t;if(n&&!(n.length<=0)){if(i=[],n[0].query)for(t in n[0].query)i.push(t);if(!(i.length<=0))for(r=0,e=n;r<e.length;r++)for(u=e[r],f=0,o=i;f<o.length;f++)t=o[f],u.values[t]!==undefined&&(u.query[t]=u.values[t])}},t.prototype.validateRangeChangedCells=function(){return __awaiter(this,void 0,void 0,function(){var e,s,h,r,f,u,t,o,i;return __generator(this,function(c){switch(c.label){case 0:if(this.listview.GetDataValidationTime()===1)return[2,{status:0}];e=this.listview.listviewData.visibleColumns;s=this.rangeChangedInfo.changedCells;h=this._listData.getRowCount();r=0;c.label=1;case 1:if(!(r<e.length))return[3,10];if(f=n.ListviewEditorHelper.getCell(e[r].getTemplateCell(),this.listview.runTimePageName,this.listview.designerPageName,this.listview.getListviewName()),!f)return[3,9];if(u=s[r],!u)return[3,5];t=0;c.label=2;case 2:return(t<u.length)?this.listview.mappedRowIndexFrowView(u[t].row)>=this.rangeChangedInfo.oldRowCount?[3,4]:[4,this.validateRangeChangedCell(u[t].row,r,f.cellType)]:[3,5];case 3:if(i=c.sent(),i.status===1)return i.message=this.generateValidateErrorMessage(u[t].row,r,i.message),[2,i];c.label=4;case 4:return t++,[3,2];case 5:t=this.rangeChangedInfo.oldRowCount;c.label=6;case 6:return(t<h)?(o=this.listview.mappedRowIndexFromData(t),[4,this.validateRangeChangedCell(o,r,f.cellType)]):[3,9];case 7:if(i=c.sent(),i.status===1)return i.message=this.generateValidateErrorMessage(o,r,i.message),[2,i];c.label=8;case 8:return t++,[3,6];case 9:return r++,[3,1];case 10:return[2,{status:0}]}})})},t.prototype.validateRangeChangedCell=function(n,t,i){return __awaiter(this,void 0,void 0,function(){var u,r;return __generator(this,function(f){switch(f.label){case 0:return(u=this._sheet.getValue(n,t),this.listview.allowShowTotalRow()&&n===this.listview.totalRowIndex)?[2,null]:(r=i.validateValue(u,this.listview.getValidateHelpInfoByViewIndex(n,t)),!(r instanceof Promise))?[3,2]:[4,r];case 1:return[2,f.sent()];case 2:return[2,r]}})})},t.prototype.generateValidateErrorMessage=function(t,i,r){var u;if(n.Common.IsEmpty(r))return r;var e=this._sheet.getValue(t,i),o=n.FormatHelper.getTextFromValue(e),f="";return this._sheet.options.colHeaderVisible&&(f=this._sheet.getText(0,i,GC.Spread.Sheets.SheetArea.colHeader)),n.Common.IsEmpty(f)&&(f=i+1+""),u="",this._sheet.options.rowHeaderVisible&&(u=this._sheet.getText(t,0,GC.Spread.Sheets.SheetArea.rowHeader)),n.Common.IsEmpty(u)&&(u=this.listview.mappedRowIndexFrowView(t)+1+""),n.Common.format(n.RS.ValidateErrorMessage,o,u,f,r)},t.prototype.showErrorMessageAndRollBackRangeChange=function(t){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(){return(this.rollBackRangeChange(),i=this,n.DelayRefresh.NeedDelayRun===!0)?[2,new Promise(function(r){n.DelayRefresh.setTimeout(function(){if(i.listview.hasDestroyed()){r();return}i.showErrorMessageAndRepaint(t);r()},100)})]:(i.showErrorMessageAndRepaint(t),[2])})})},t.prototype.rollBackRangeChange=function(){var u,f,n,t,e,i,o,s,r;for(this.listview.operationTypeWhenValueChanged=1,u=this.rangeChangedInfo.changedCells,f=this.listview.listviewData.visibleColumns,n=0;n<f.length;n++)if((t=u[n],t)&&(e=this.listview.listviewData.getColIndexByVisibleColIndex(n),e!==-1))for(i=0;i<t.length;i++)t[i].row>=this.rangeChangedInfo.oldRowCount||(o=this.listview.mappedRowIndexFrowView(t[i].row),this.listview._onCellValueChanged(o,n,t[i].value));for(s=this._listData.getRowCount()-this.rangeChangedInfo.oldRowCount,r=0;r<s;r++)this.listview.deleteRowInDataModel(this.rangeChangedInfo.oldRowCount);this.listview.operationTypeWhenValueChanged=0},t.prototype.showErrorMessageAndRepaint=function(t){var r,i;for(n.Common.IsEmpty(t)||alert(t),this._sheet.suspendPaint(),this.listview.setDataToSpreadJSNow(),r=this.rangeChangedInfo.oldSelections,i=0;i<r.length;i++)i===0?this._sheet.setSelection(r[i].row,r[i].col,r[i].rowCount,r[i].colCount):this._sheet.addSelection(r[i].row,r[i].col,r[i].rowCount,r[i].colCount);this._sheet.resumePaint()},t}();t.RangeChangedManager=r})(t=n.ListViewHelper||(n.ListViewHelper={}))})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t;(function(t){var i=function(){function i(t){this._spreadJSView=t;this._pageStretchInfo=n.PageManager.getPageStretchInfo(t.runTimePageName)}return i.prototype.cacheWidth=function(){this._clearCachedWidth();var n=this._calcColumnsWidth(!0);this._originalColumnsWidth=n.widths.slice();this._originalSolidColumnsWidth=n.solidWidth;this._originalTotalColumnsWidth=n.totalWidth},i.prototype.isListviewUseSimpleBar=function(){var n=this._spreadJSView.getSpread();return n?n.options.scrollbarAppearance===GC.Spread.Sheets.ScrollbarAppearance.mobile:!1},i.prototype.stretch=function(n){var t=this._spreadJSView.getSpread();t&&(t.suspendPaint(),this.redraw(),this.stretchWithoutSuspendPaint(n),t.resumePaint())},i.prototype.stretchWithoutSuspendPaint=function(n){this._updateInnerContainerWidth();this._updateInnerContainerHeight();var t=this._getScrollStatus(this._originalTotalColumnsWidth,this._originalSolidColumnsWidth,this._getSolidRowsHeight(),!0,this.isListviewUseSimpleBar());this._stretchColumns(t.availableWidth);this._stretchContainer(this._innerContainerWidth);this._spreadJSView.onStretch(t,n)},i.prototype.getCurrntScrollbarVisibility=function(){var n=this._calcColumnsWidth(!1),i=this._calcCurrentSolidRowsHeight(),t=this._getScrollStatus(n.totalWidth,n.solidWidth,i,!1,this.isListviewUseSimpleBar());return{showHScrollBar:t.showHScrollBar,showVScrollbar:t.showVScrollbar}},i.prototype.destroy=function(){this._clearCachedWidth();this._spreadJSView=null},i.prototype._canDisplayAllSolidColumns=function(n,t){return t=Math.ceil(t),t>=n},i.prototype._canDisplayAllRows=function(n,t){return t=Math.ceil(t),t>=n},i.prototype._getSolidRowsHeight=function(){var n=this._spreadJSView.getSheet(),t=n.getRowCount(),i=n.getRowHeight(0);return t*i+this._spreadJSView.getColHeaderHeight()},i.prototype._getEmptyColumnWidthAfterStretch=function(n,t,i){if(!i)return n;var r=t/this._originalTotalColumnsWidth;return n*r},i.prototype._getScrollStatus=function(n,i,r,u,f){var h=this._innerContainerWidth,e=!this._canDisplayAllSolidColumns(n,h),o=!this._canDisplayAllRows(r,this._innerContainerHeight),c,s,l;return this._spreadJSView.forceHideVerticalScrollBar&&(o=!1),this._spreadJSView.forceHideHorizontalScrollBar&&(e=!1),e&&!o?(c=f?0:t.SpreadJSStyleHelper.hScrollbarHeight,o=!this._canDisplayAllRows(r,this._innerContainerHeight-c)):o&&!e&&(s=this._getEmptyColumnWidthAfterStretch(n-i,h,u),s=Math.round(s),l=f?0:t.SpreadJSStyleHelper.vScrollbarWidth,e=s<l),{showHScrollBar:e,showVScrollbar:o,availableHeight:this._innerContainerHeight,availableWidth:h}},i.prototype._calcCurrentSolidRowsHeight=function(){for(var t=this._spreadJSView.getSheet(),r=t.getRowCount(),i=0,n=0;n<r;n++)i+=t.getRowHeight(n);return i+this._spreadJSView.getColHeaderHeight()},i.prototype._calcOriginalColumnsWidth=function(n,t){for(var e,o,f=n.visibleColumns,h=n.isRowHeaderCheckBoxVisible(),c=n.isRowHeaderVisible(),r=[],i=0,s=0,u=0;u<f.length;u++)r[u]=f[u].columnInfo.Width,i+=r[u];return h&&(e=n.rowHeaderCheckBoxColumnInfo.columnInfo.Width,r.unshift(e),i+=e),c&&(o=n.rowHeaderColumnInfo.columnInfo.Width,r.unshift(o),i+=o),s=i,f.length>0&&i<t&&(i=t,r.push(t-i)),{widths:r,totalWidth:i,solidWidth:s}},i.prototype._calcCurrentColumnsWidth=function(n,t){var u=this._spreadJSView.getSheet(),l=n.isRowHeaderCheckBoxVisible(),a=n.isRowHeaderVisible(),y=this._originalColumnsWidth.length,e=0,r=[],i=0,v=0,o,s,h,f,c;for(a&&l?(o=u.getColumnWidth(0,GC.Spread.Sheets.SheetArea.rowHeader),s=u.getColumnWidth(1,GC.Spread.Sheets.SheetArea.rowHeader),i+=o+s,e=2,r.unshift(o,s)):(a||l)&&(h=u.getColumnWidth(0,GC.Spread.Sheets.SheetArea.rowHeader),i+=h,r.unshift(h),e=1),f=0;f<y-e;f++)c=u.getColumnWidth(f,GC.Spread.Sheets.SheetArea.viewport),i+=c,r.push(c);return v=i,i<t&&(i=t,r.push(t-i)),{widths:r,totalWidth:i,solidWidth:v}},i.prototype._calcColumnsWidth=function(t){var i=this._spreadJSView.listviewData,r,u,f;return t?(r=n.ForguncyData.getPageLayout(this._spreadJSView.locatedPageID,this._spreadJSView.runTimePageName),r?(u=this._spreadJSView.layout,f=r.getColumnWidth(u.Column,u.ColumnSpan),this._calcOriginalColumnsWidth(i,f)):this._calcOriginalColumnsWidth(i,100)):this._calcCurrentColumnsWidth(i,this._innerContainerWidth)},i.prototype._stretchColumns=function(n){var c=this._spreadJSView.listviewData,h,i,f,t,a;if(!c.getAutoFitColumnWidth()){var e=0,o=this._spreadJSView.getSheet(),l=c.isRowHeaderCheckBoxVisible(),s=c.isRowHeaderVisible(),r=this._originalColumnsWidth.slice(),u=[];if(this._originalTotalColumnsWidth<=Math.ceil(n)){if(h=n/this._originalTotalColumnsWidth,s&&l)for(u=r.splice(0,2),i=0,f=u.length;i<f;i++)t=u[i]*h,t=Math.round(t),e+=t,o.setColumnWidth(i,t,GC.Spread.Sheets.SheetArea.rowHeader),i===0?this._spreadJSView.updateRowHeaderWidth(t):this._spreadJSView.updateRowHeaderCheckBoxWidth(t);else(s||l)&&(u=r.splice(0,1),t=u[0]*h,t=Math.round(t),e+=t,o.setColumnWidth(0,t,GC.Spread.Sheets.SheetArea.rowHeader),s?this._spreadJSView.updateRowHeaderWidth(t):this._spreadJSView.updateRowHeaderCheckBoxWidth(t));for(i=0,f=r.length;i<f;i++)t=r[i]*h,t=Math.round(t),e+=t,i===f-1&&(a=n-e,t+=a,t=Math.floor(t)),o.setColumnWidth(i,t)}else this._resetAllColmnsWidth(o,r,s,l)}},i.prototype._resetAllColmnsWidth=function(n,t,i,r){var f=[],u,e;if(i&&r)for(f=t.splice(0,2),u=0,e=f.length;u<e;u++)n.setColumnWidth(u,f[u],GC.Spread.Sheets.SheetArea.rowHeader);else(i||r)&&(f=t.splice(0,1),n.setColumnWidth(0,f[0],GC.Spread.Sheets.SheetArea.rowHeader));for(u=0,e=t.length;u<e;u++)n.setColumnWidth(u,t[u])},i.prototype._stretchContainer=function(n){$(this._spreadJSView.getContainer()).width(n)},i.prototype._clearCachedWidth=function(){this._originalTotalColumnsWidth=0;this._originalSolidColumnsWidth=0;this._originalColumnsWidth=[]},i.prototype._updateInnerContainerWidth=function(){var n=this._spreadJSView.getContainerDiv(),t;n.css("overflow","hidden");t=n.width();this._innerContainerWidth=t;n.css("overflow","")},i.prototype._updateInnerContainerHeight=function(){var n=this._spreadJSView.getContainerDiv(),t;n.css("overflow","hidden");t=n.height();this._innerContainerHeight=t;n.css("overflow","")},i.prototype.redraw=function(){if(this._pageStretchInfo.StretchMode===4){var n=this._spreadJSView.getContainer();n.style.display="none";n.offsetHeight;n.style.display=""}},i}();t.StretchHelper=i})(t=n.ListViewHelper||(n.ListViewHelper={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(n){var i=t.call(this)||this,r;return(i._deleteButton=undefined,r=n,!r||r.length===0)?i:(i._deleteButton=i.create(),i.bindEvents(),r.append(i._deleteButton),i)}return __extends(i,t),i.prototype.create=function(){var t=$("<div/>"),u,r;return t.addClass(i.className),t.css("display","none"),t.css("position","absolute"),t.css("zIndex",999),t.css("width",21),t.css("height",16),u=-21,t.css("left",u),r=$("<img/>"),r.addClass("deleteButton"),r.css("position","absolute"),r.css("width",16),r.css("height","100%"),r.css("cursor","pointer"),r.attr("src",n.ForguncyData.ForguncyRoot+"Resources/Images/SiteBuiltInImages/delete.png"),t.append(r),t},i.prototype.bindEvents=function(){var n=this;this._deleteButton.on("click",function(){n.trigger("click");n.hide()});this._deleteButton.on("mouseenter",function(){n.trigger("mouseenter")});this._deleteButton.on("mouseleave",function(){n.trigger("mouseleave")})},i.prototype.show=function(n){if(this._deleteButton){var t=n-8;this._deleteButton.css("top",t);this._deleteButton.show()}},i.prototype.hide=function(){this._deleteButton&&this._deleteButton.hide()},i.prototype.isVisible=function(){return this._deleteButton?this._deleteButton.css("display")==="block":!1},i.prototype.isPointIn=function(t){return n.ListviewBase.isPointInElement(t,this._deleteButton)},i.prototype.getButtonCenterY=function(){return parseFloat(this._deleteButton.css("top").slice(0,-2))+8},i.className="deleteButton",i}(n.EventClassBase);n.ListviewDeleteButton=t})(Forguncy||(Forguncy={}))
;